var tde=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var hje=tde((la,ua)=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function a(l){if(l.ep)return;l.ep=!0;const d=s(l);fetch(l.href,d)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function sN(t){const o=Object.create(null);for(const s of t.split(","))o[s]=1;return s=>s in o}const po={},Ap=[],pr=()=>{},nde=()=>!1,KS=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),iN=t=>t.startsWith("onUpdate:"),us=Object.assign,aN=(t,o)=>{const s=t.indexOf(o);s>-1&&t.splice(s,1)},rde=Object.prototype.hasOwnProperty,zn=(t,o)=>rde.call(t,o),st=Array.isArray,Op=t=>Qg(t)==="[object Map]",GS=t=>Qg(t)==="[object Set]",id=t=>Qg(t)==="[object Date]",Ft=t=>typeof t=="function",Mt=t=>typeof t=="string",yc=t=>typeof t=="symbol",fn=t=>t!==null&&typeof t=="object",Tg=t=>(fn(t)||Ft(t))&&Ft(t.then)&&Ft(t.catch),M8=Object.prototype.toString,Qg=t=>M8.call(t),ode=t=>Qg(t).slice(8,-1),Cg=t=>Qg(t)==="[object Object]",cN=t=>Mt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ag=sN(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zS=t=>{const o=Object.create(null);return s=>o[s]||(o[s]=t(s))},sde=/-(\w)/g,gi=zS(t=>t.replace(sde,(o,s)=>s?s.toUpperCase():"")),ide=/\B([A-Z])/g,ou=zS(t=>t.replace(ide,"-$1").toLowerCase()),e_=zS(t=>t.charAt(0).toUpperCase()+t.slice(1)),cg=zS(t=>t?`on${e_(t)}`:""),rd=(t,o)=>!Object.is(t,o),Fb=(t,...o)=>{for(let s=0;s<t.length;s++)t[s](...o)},x8=(t,o,s,a=!1)=>{Object.defineProperty(t,o,{configurable:!0,enumerable:!1,writable:a,value:s})},OA=t=>{const o=parseFloat(t);return isNaN(o)?t:o},ade=t=>{const o=Mt(t)?Number(t):NaN;return isNaN(o)?t:o};let Xj;const YS=()=>Xj||(Xj=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function jt(t){if(st(t)){const o={};for(let s=0;s<t.length;s++){const a=t[s],l=Mt(a)?dde(a):jt(a);if(l)for(const d in l)o[d]=l[d]}return o}else if(Mt(t)||fn(t))return t}const cde=/;(?![^(]*\))/g,lde=/:([^]+)/,ude=/\/\*[^]*?\*\//g;function dde(t){const o={};return t.replace(ude,"").split(cde).forEach(s=>{if(s){const a=s.split(lde);a.length>1&&(o[a[0].trim()]=a[1].trim())}}),o}function K(t){let o="";if(Mt(t))o=t;else if(st(t))for(let s=0;s<t.length;s++){const a=K(t[s]);a&&(o+=a+" ")}else if(fn(t))for(const s in t)t[s]&&(o+=s+" ");return o.trim()}function sa(t){if(!t)return null;let{class:o,style:s}=t;return o&&!Mt(o)&&(t.class=K(o)),s&&(t.style=jt(s)),t}const hde="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",fde=sN(hde);function U8(t){return!!t||t===""}function pde(t,o){if(t.length!==o.length)return!1;let s=!0;for(let a=0;s&&a<t.length;a++)s=Bp(t[a],o[a]);return s}function Bp(t,o){if(t===o)return!0;let s=id(t),a=id(o);if(s||a)return s&&a?t.getTime()===o.getTime():!1;if(s=yc(t),a=yc(o),s||a)return t===o;if(s=st(t),a=st(o),s||a)return s&&a?pde(t,o):!1;if(s=fn(t),a=fn(o),s||a){if(!s||!a)return!1;const l=Object.keys(t).length,d=Object.keys(o).length;if(l!==d)return!1;for(const h in t){const v=t.hasOwnProperty(h),g=o.hasOwnProperty(h);if(v&&!g||!v&&g||!Bp(t[h],o[h]))return!1}}return String(t)===String(o)}function V8(t,o){return t.findIndex(s=>Bp(s,o))}const F8=t=>!!(t&&t.__v_isRef===!0),ot=t=>Mt(t)?t:t==null?"":st(t)||fn(t)&&(t.toString===M8||!Ft(t.toString))?F8(t)?ot(t.value):JSON.stringify(t,B8,2):String(t),B8=(t,o)=>F8(o)?B8(t,o.value):Op(o)?{[`Map(${o.size})`]:[...o.entries()].reduce((s,[a,l],d)=>(s[BI(a,d)+" =>"]=l,s),{})}:GS(o)?{[`Set(${o.size})`]:[...o.values()].map(s=>BI(s))}:yc(o)?BI(o):fn(o)&&!st(o)&&!Cg(o)?String(o):o,BI=(t,o="")=>{var s;return yc(t)?`Symbol(${(s=t.description)!=null?s:o})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let di;class j8{constructor(o=!1){this.detached=o,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=di,!o&&di&&(this.index=(di.scopes||(di.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let o,s;if(this.scopes)for(o=0,s=this.scopes.length;o<s;o++)this.scopes[o].pause();for(o=0,s=this.effects.length;o<s;o++)this.effects[o].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let o,s;if(this.scopes)for(o=0,s=this.scopes.length;o<s;o++)this.scopes[o].resume();for(o=0,s=this.effects.length;o<s;o++)this.effects[o].resume()}}run(o){if(this._active){const s=di;try{return di=this,o()}finally{di=s}}}on(){di=this}off(){di=this.parent}stop(o){if(this._active){this._active=!1;let s,a;for(s=0,a=this.effects.length;s<a;s++)this.effects[s].stop();for(this.effects.length=0,s=0,a=this.cleanups.length;s<a;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,a=this.scopes.length;s<a;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!o){const l=this.parent.scopes.pop();l&&l!==this&&(this.parent.scopes[this.index]=l,l.index=this.index)}this.parent=void 0}}}function mde(t){return new j8(t)}function $8(){return di}function H8(t,o=!1){di&&di.cleanups.push(t)}let _o;const jI=new WeakSet;class W8{constructor(o){this.fn=o,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,di&&di.active&&di.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,jI.has(this)&&(jI.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||G8(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jj(this),z8(this);const o=_o,s=gc;_o=this,gc=!0;try{return this.fn()}finally{Y8(this),_o=o,gc=s,this.flags&=-3}}stop(){if(this.flags&1){for(let o=this.deps;o;o=o.nextDep)dN(o);this.deps=this.depsTail=void 0,Jj(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?jI.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){NA(this)&&this.run()}get dirty(){return NA(this)}}let K8=0,lg,ug;function G8(t,o=!1){if(t.flags|=8,o){t.next=ug,ug=t;return}t.next=lg,lg=t}function lN(){K8++}function uN(){if(--K8>0)return;if(ug){let o=ug;for(ug=void 0;o;){const s=o.next;o.next=void 0,o.flags&=-9,o=s}}let t;for(;lg;){let o=lg;for(lg=void 0;o;){const s=o.next;if(o.next=void 0,o.flags&=-9,o.flags&1)try{o.trigger()}catch(a){t||(t=a)}o=s}}if(t)throw t}function z8(t){for(let o=t.deps;o;o=o.nextDep)o.version=-1,o.prevActiveLink=o.dep.activeLink,o.dep.activeLink=o}function Y8(t){let o,s=t.depsTail,a=s;for(;a;){const l=a.prevDep;a.version===-1?(a===s&&(s=l),dN(a),vde(a)):o=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=l}t.deps=o,t.depsTail=s}function NA(t){for(let o=t.deps;o;o=o.nextDep)if(o.dep.version!==o.version||o.dep.computed&&(q8(o.dep.computed)||o.dep.version!==o.version))return!0;return!!t._dirty}function q8(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===wg))return;t.globalVersion=wg;const o=t.dep;if(t.flags|=2,o.version>0&&!t.isSSR&&t.deps&&!NA(t)){t.flags&=-3;return}const s=_o,a=gc;_o=t,gc=!0;try{z8(t);const l=t.fn(t._value);(o.version===0||rd(l,t._value))&&(t._value=l,o.version++)}catch(l){throw o.version++,l}finally{_o=s,gc=a,Y8(t),t.flags&=-3}}function dN(t,o=!1){const{dep:s,prevSub:a,nextSub:l}=t;if(a&&(a.nextSub=l,t.prevSub=void 0),l&&(l.prevSub=a,t.nextSub=void 0),s.subs===t&&(s.subs=a,!a&&s.computed)){s.computed.flags&=-5;for(let d=s.computed.deps;d;d=d.nextDep)dN(d,!0)}!o&&!--s.sc&&s.map&&s.map.delete(s.key)}function vde(t){const{prevDep:o,nextDep:s}=t;o&&(o.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=o,t.nextDep=void 0)}let gc=!0;const X8=[];function md(){X8.push(gc),gc=!1}function vd(){const t=X8.pop();gc=t===void 0?!0:t}function Jj(t){const{cleanup:o}=t;if(t.cleanup=void 0,o){const s=_o;_o=void 0;try{o()}finally{_o=s}}}let wg=0,gde=class{constructor(o,s){this.sub=o,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class qS{constructor(o){this.computed=o,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(o){if(!_o||!gc||_o===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==_o)s=this.activeLink=new gde(_o,this),_o.deps?(s.prevDep=_o.depsTail,_o.depsTail.nextDep=s,_o.depsTail=s):_o.deps=_o.depsTail=s,J8(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const a=s.nextDep;a.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=a),s.prevDep=_o.depsTail,s.nextDep=void 0,_o.depsTail.nextDep=s,_o.depsTail=s,_o.deps===s&&(_o.deps=a)}return s}trigger(o){this.version++,wg++,this.notify(o)}notify(o){lN();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{uN()}}}function J8(t){if(t.dep.sc++,t.sub.flags&4){const o=t.dep.computed;if(o&&!t.dep.subs){o.flags|=20;for(let a=o.deps;a;a=a.nextDep)J8(a)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const cS=new WeakMap,Rh=Symbol(""),kA=Symbol(""),Rg=Symbol("");function qs(t,o,s){if(gc&&_o){let a=cS.get(t);a||cS.set(t,a=new Map);let l=a.get(s);l||(a.set(s,l=new qS),l.map=a,l.key=s),l.track()}}function zl(t,o,s,a,l,d){const h=cS.get(t);if(!h){wg++;return}const v=g=>{g&&g.trigger()};if(lN(),o==="clear")h.forEach(v);else{const g=st(t),E=g&&cN(s);if(g&&s==="length"){const b=Number(a);h.forEach((S,C)=>{(C==="length"||C===Rg||!yc(C)&&C>=b)&&v(S)})}else switch((s!==void 0||h.has(void 0))&&v(h.get(s)),E&&v(h.get(Rg)),o){case"add":g?E&&v(h.get("length")):(v(h.get(Rh)),Op(t)&&v(h.get(kA)));break;case"delete":g||(v(h.get(Rh)),Op(t)&&v(h.get(kA)));break;case"set":Op(t)&&v(h.get(Rh));break}}uN()}function _de(t,o){const s=cS.get(t);return s&&s.get(o)}function hp(t){const o=Tr(t);return o===t?o:(qs(o,"iterate",Rg),Fa(t)?o:o.map(Xs))}function XS(t){return qs(t=Tr(t),"iterate",Rg),t}const Ede={__proto__:null,[Symbol.iterator](){return $I(this,Symbol.iterator,Xs)},concat(...t){return hp(this).concat(...t.map(o=>st(o)?hp(o):o))},entries(){return $I(this,"entries",t=>(t[1]=Xs(t[1]),t))},every(t,o){return $l(this,"every",t,o,void 0,arguments)},filter(t,o){return $l(this,"filter",t,o,s=>s.map(Xs),arguments)},find(t,o){return $l(this,"find",t,o,Xs,arguments)},findIndex(t,o){return $l(this,"findIndex",t,o,void 0,arguments)},findLast(t,o){return $l(this,"findLast",t,o,Xs,arguments)},findLastIndex(t,o){return $l(this,"findLastIndex",t,o,void 0,arguments)},forEach(t,o){return $l(this,"forEach",t,o,void 0,arguments)},includes(...t){return HI(this,"includes",t)},indexOf(...t){return HI(this,"indexOf",t)},join(t){return hp(this).join(t)},lastIndexOf(...t){return HI(this,"lastIndexOf",t)},map(t,o){return $l(this,"map",t,o,void 0,arguments)},pop(){return zv(this,"pop")},push(...t){return zv(this,"push",t)},reduce(t,...o){return Zj(this,"reduce",t,o)},reduceRight(t,...o){return Zj(this,"reduceRight",t,o)},shift(){return zv(this,"shift")},some(t,o){return $l(this,"some",t,o,void 0,arguments)},splice(...t){return zv(this,"splice",t)},toReversed(){return hp(this).toReversed()},toSorted(t){return hp(this).toSorted(t)},toSpliced(...t){return hp(this).toSpliced(...t)},unshift(...t){return zv(this,"unshift",t)},values(){return $I(this,"values",Xs)}};function $I(t,o,s){const a=XS(t),l=a[o]();return a!==t&&!Fa(t)&&(l._next=l.next,l.next=()=>{const d=l._next();return d.value&&(d.value=s(d.value)),d}),l}const yde=Array.prototype;function $l(t,o,s,a,l,d){const h=XS(t),v=h!==t&&!Fa(t),g=h[o];if(g!==yde[o]){const S=g.apply(t,d);return v?Xs(S):S}let E=s;h!==t&&(v?E=function(S,C){return s.call(this,Xs(S),C,t)}:s.length>2&&(E=function(S,C){return s.call(this,S,C,t)}));const b=g.call(h,E,a);return v&&l?l(b):b}function Zj(t,o,s,a){const l=XS(t);let d=s;return l!==t&&(Fa(t)?s.length>3&&(d=function(h,v,g){return s.call(this,h,v,g,t)}):d=function(h,v,g){return s.call(this,h,Xs(v),g,t)}),l[o](d,...a)}function HI(t,o,s){const a=Tr(t);qs(a,"iterate",Rg);const l=a[o](...s);return(l===-1||l===!1)&&pN(s[0])?(s[0]=Tr(s[0]),a[o](...s)):l}function zv(t,o,s=[]){md(),lN();const a=Tr(t)[o].apply(t,s);return uN(),vd(),a}const bde=sN("__proto__,__v_isRef,__isVue"),Z8=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(yc));function Sde(t){yc(t)||(t=String(t));const o=Tr(this);return qs(o,"has",t),o.hasOwnProperty(t)}class Q8{constructor(o=!1,s=!1){this._isReadonly=o,this._isShallow=s}get(o,s,a){if(s==="__v_skip")return o.__v_skip;const l=this._isReadonly,d=this._isShallow;if(s==="__v_isReactive")return!l;if(s==="__v_isReadonly")return l;if(s==="__v_isShallow")return d;if(s==="__v_raw")return a===(l?d?Pde:r5:d?n5:t5).get(o)||Object.getPrototypeOf(o)===Object.getPrototypeOf(a)?o:void 0;const h=st(o);if(!l){let g;if(h&&(g=Ede[s]))return g;if(s==="hasOwnProperty")return Sde}const v=Reflect.get(o,s,xr(o)?o:a);return(yc(s)?Z8.has(s):bde(s))||(l||qs(o,"get",s),d)?v:xr(v)?h&&cN(s)?v:v.value:fn(v)?l?am(v):er(v):v}}class e5 extends Q8{constructor(o=!1){super(!1,o)}set(o,s,a,l){let d=o[s];if(!this._isShallow){const g=Ph(d);if(!Fa(a)&&!Ph(a)&&(d=Tr(d),a=Tr(a)),!st(o)&&xr(d)&&!xr(a))return g?!1:(d.value=a,!0)}const h=st(o)&&cN(s)?Number(s)<o.length:zn(o,s),v=Reflect.set(o,s,a,xr(o)?o:l);return o===Tr(l)&&(h?rd(a,d)&&zl(o,"set",s,a):zl(o,"add",s,a)),v}deleteProperty(o,s){const a=zn(o,s);o[s];const l=Reflect.deleteProperty(o,s);return l&&a&&zl(o,"delete",s,void 0),l}has(o,s){const a=Reflect.has(o,s);return(!yc(s)||!Z8.has(s))&&qs(o,"has",s),a}ownKeys(o){return qs(o,"iterate",st(o)?"length":Rh),Reflect.ownKeys(o)}}class Tde extends Q8{constructor(o=!1){super(!0,o)}set(o,s){return!0}deleteProperty(o,s){return!0}}const Cde=new e5,wde=new Tde,Rde=new e5(!0),PA=t=>t,vb=t=>Reflect.getPrototypeOf(t);function Ide(t,o,s){return function(...a){const l=this.__v_raw,d=Tr(l),h=Op(d),v=t==="entries"||t===Symbol.iterator&&h,g=t==="keys"&&h,E=l[t](...a),b=s?PA:o?DA:Xs;return!o&&qs(d,"iterate",g?kA:Rh),{next(){const{value:S,done:C}=E.next();return C?{value:S,done:C}:{value:v?[b(S[0]),b(S[1])]:b(S),done:C}},[Symbol.iterator](){return this}}}}function gb(t){return function(...o){return t==="delete"?!1:t==="clear"?void 0:this}}function Ade(t,o){const s={get(l){const d=this.__v_raw,h=Tr(d),v=Tr(l);t||(rd(l,v)&&qs(h,"get",l),qs(h,"get",v));const{has:g}=vb(h),E=o?PA:t?DA:Xs;if(g.call(h,l))return E(d.get(l));if(g.call(h,v))return E(d.get(v));d!==h&&d.get(l)},get size(){const l=this.__v_raw;return!t&&qs(Tr(l),"iterate",Rh),Reflect.get(l,"size",l)},has(l){const d=this.__v_raw,h=Tr(d),v=Tr(l);return t||(rd(l,v)&&qs(h,"has",l),qs(h,"has",v)),l===v?d.has(l):d.has(l)||d.has(v)},forEach(l,d){const h=this,v=h.__v_raw,g=Tr(v),E=o?PA:t?DA:Xs;return!t&&qs(g,"iterate",Rh),v.forEach((b,S)=>l.call(d,E(b),E(S),h))}};return us(s,t?{add:gb("add"),set:gb("set"),delete:gb("delete"),clear:gb("clear")}:{add(l){!o&&!Fa(l)&&!Ph(l)&&(l=Tr(l));const d=Tr(this);return vb(d).has.call(d,l)||(d.add(l),zl(d,"add",l,l)),this},set(l,d){!o&&!Fa(d)&&!Ph(d)&&(d=Tr(d));const h=Tr(this),{has:v,get:g}=vb(h);let E=v.call(h,l);E||(l=Tr(l),E=v.call(h,l));const b=g.call(h,l);return h.set(l,d),E?rd(d,b)&&zl(h,"set",l,d):zl(h,"add",l,d),this},delete(l){const d=Tr(this),{has:h,get:v}=vb(d);let g=h.call(d,l);g||(l=Tr(l),g=h.call(d,l)),v&&v.call(d,l);const E=d.delete(l);return g&&zl(d,"delete",l,void 0),E},clear(){const l=Tr(this),d=l.size!==0,h=l.clear();return d&&zl(l,"clear",void 0,void 0),h}}),["keys","values","entries",Symbol.iterator].forEach(l=>{s[l]=Ide(l,t,o)}),s}function hN(t,o){const s=Ade(t,o);return(a,l,d)=>l==="__v_isReactive"?!t:l==="__v_isReadonly"?t:l==="__v_raw"?a:Reflect.get(zn(s,l)&&l in a?s:a,l,d)}const Ode={get:hN(!1,!1)},Nde={get:hN(!1,!0)},kde={get:hN(!0,!1)},t5=new WeakMap,n5=new WeakMap,r5=new WeakMap,Pde=new WeakMap;function Dde(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Lde(t){return t.__v_skip||!Object.isExtensible(t)?0:Dde(ode(t))}function er(t){return Ph(t)?t:fN(t,!1,Cde,Ode,t5)}function o5(t){return fN(t,!1,Rde,Nde,n5)}function am(t){return fN(t,!0,wde,kde,r5)}function fN(t,o,s,a,l){if(!fn(t)||t.__v_raw&&!(o&&t.__v_isReactive))return t;const d=l.get(t);if(d)return d;const h=Lde(t);if(h===0)return t;const v=new Proxy(t,h===2?a:s);return l.set(t,v),v}function Np(t){return Ph(t)?Np(t.__v_raw):!!(t&&t.__v_isReactive)}function Ph(t){return!!(t&&t.__v_isReadonly)}function Fa(t){return!!(t&&t.__v_isShallow)}function pN(t){return t?!!t.__v_raw:!1}function Tr(t){const o=t&&t.__v_raw;return o?Tr(o):t}function Zl(t){return!zn(t,"__v_skip")&&Object.isExtensible(t)&&x8(t,"__v_skip",!0),t}const Xs=t=>fn(t)?er(t):t,DA=t=>fn(t)?am(t):t;function xr(t){return t?t.__v_isRef===!0:!1}function ee(t){return s5(t,!1)}function Mr(t){return s5(t,!0)}function s5(t,o){return xr(t)?t:new Mde(t,o)}class Mde{constructor(o,s){this.dep=new qS,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?o:Tr(o),this._value=s?o:Xs(o),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(o){const s=this._rawValue,a=this.__v_isShallow||Fa(o)||Ph(o);o=a?o:Tr(o),rd(o,s)&&(this._rawValue=o,this._value=a?o:Xs(o),this.dep.trigger())}}function p(t){return xr(t)?t.value:t}const xde={get:(t,o,s)=>o==="__v_raw"?t:p(Reflect.get(t,o,s)),set:(t,o,s,a)=>{const l=t[o];return xr(l)&&!xr(s)?(l.value=s,!0):Reflect.set(t,o,s,a)}};function i5(t){return Np(t)?t:new Proxy(t,xde)}class Ude{constructor(o){this.__v_isRef=!0,this._value=void 0;const s=this.dep=new qS,{get:a,set:l}=o(s.track.bind(s),s.trigger.bind(s));this._get=a,this._set=l}get value(){return this._value=this._get()}set value(o){this._set(o)}}function Vde(t){return new Ude(t)}function ds(t){const o=st(t)?new Array(t.length):{};for(const s in t)o[s]=a5(t,s);return o}class Fde{constructor(o,s,a){this._object=o,this._key=s,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0}get value(){const o=this._object[this._key];return this._value=o===void 0?this._defaultValue:o}set value(o){this._object[this._key]=o}get dep(){return _de(Tr(this._object),this._key)}}class Bde{constructor(o){this._getter=o,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function lr(t,o,s){return xr(t)?t:Ft(t)?new Bde(t):fn(t)&&arguments.length>1?a5(t,o,s):ee(t)}function a5(t,o,s){const a=t[o];return xr(a)?a:new Fde(t,o,s)}class jde{constructor(o,s,a){this.fn=o,this.setter=s,this._value=void 0,this.dep=new qS(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wg-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&_o!==this)return G8(this,!0),!0}get value(){const o=this.dep.track();return q8(this),o&&(o.version=this.dep.version),this._value}set value(o){this.setter&&this.setter(o)}}function $de(t,o,s=!1){let a,l;return Ft(t)?a=t:(a=t.get,l=t.set),new jde(a,l,s)}const _b={},lS=new WeakMap;let mh;function Hde(t,o=!1,s=mh){if(s){let a=lS.get(s);a||lS.set(s,a=[]),a.push(t)}}function Wde(t,o,s=po){const{immediate:a,deep:l,once:d,scheduler:h,augmentJob:v,call:g}=s,E=D=>l?D:Fa(D)||l===!1||l===0?Yl(D,1):Yl(D);let b,S,C,w,I=!1,R=!1;if(xr(t)?(S=()=>t.value,I=Fa(t)):Np(t)?(S=()=>E(t),I=!0):st(t)?(R=!0,I=t.some(D=>Np(D)||Fa(D)),S=()=>t.map(D=>{if(xr(D))return D.value;if(Np(D))return E(D);if(Ft(D))return g?g(D,2):D()})):Ft(t)?o?S=g?()=>g(t,2):t:S=()=>{if(C){md();try{C()}finally{vd()}}const D=mh;mh=b;try{return g?g(t,3,[w]):t(w)}finally{mh=D}}:S=pr,o&&l){const D=S,M=l===!0?1/0:l;S=()=>Yl(D(),M)}const N=$8(),O=()=>{b.stop(),N&&N.active&&aN(N.effects,b)};if(d&&o){const D=o;o=(...M)=>{D(...M),O()}}let V=R?new Array(t.length).fill(_b):_b;const L=D=>{if(!(!(b.flags&1)||!b.dirty&&!D))if(o){const M=b.run();if(l||I||(R?M.some((F,W)=>rd(F,V[W])):rd(M,V))){C&&C();const F=mh;mh=b;try{const W=[M,V===_b?void 0:R&&V[0]===_b?[]:V,w];g?g(o,3,W):o(...W),V=M}finally{mh=F}}}else b.run()};return v&&v(L),b=new W8(S),b.scheduler=h?()=>h(L,!1):L,w=D=>Hde(D,!1,b),C=b.onStop=()=>{const D=lS.get(b);if(D){if(g)g(D,4);else for(const M of D)M();lS.delete(b)}},o?a?L(!0):V=b.run():h?h(L.bind(null,!0),!0):b.run(),O.pause=b.pause.bind(b),O.resume=b.resume.bind(b),O.stop=O,O}function Yl(t,o=1/0,s){if(o<=0||!fn(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),o--,xr(t))Yl(t.value,o,s);else if(st(t))for(let a=0;a<t.length;a++)Yl(t[a],o,s);else if(GS(t)||Op(t))t.forEach(a=>{Yl(a,o,s)});else if(Cg(t)){for(const a in t)Yl(t[a],o,s);for(const a of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,a)&&Yl(t[a],o,s)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function t_(t,o,s,a){try{return a?t(...a):t()}catch(l){JS(l,o,s)}}function bc(t,o,s,a){if(Ft(t)){const l=t_(t,o,s,a);return l&&Tg(l)&&l.catch(d=>{JS(d,o,s)}),l}if(st(t)){const l=[];for(let d=0;d<t.length;d++)l.push(bc(t[d],o,s,a));return l}}function JS(t,o,s,a=!0){const l=o?o.vnode:null,{errorHandler:d,throwUnhandledErrorInProduction:h}=o&&o.appContext.config||po;if(o){let v=o.parent;const g=o.proxy,E=`https://vuejs.org/error-reference/#runtime-${s}`;for(;v;){const b=v.ec;if(b){for(let S=0;S<b.length;S++)if(b[S](t,g,E)===!1)return}v=v.parent}if(d){md(),t_(d,null,10,[t,g,E]),vd();return}}Kde(t,s,l,a,h)}function Kde(t,o,s,a=!0,l=!1){if(l)throw t;console.error(t)}const hi=[];let ol=-1;const kp=[];let Ju=null,Ep=0;const c5=Promise.resolve();let uS=null;function Vt(t){const o=uS||c5;return t?o.then(this?t.bind(this):t):o}function Gde(t){let o=ol+1,s=hi.length;for(;o<s;){const a=o+s>>>1,l=hi[a],d=Ig(l);d<t||d===t&&l.flags&2?o=a+1:s=a}return o}function mN(t){if(!(t.flags&1)){const o=Ig(t),s=hi[hi.length-1];!s||!(t.flags&2)&&o>=Ig(s)?hi.push(t):hi.splice(Gde(o),0,t),t.flags|=1,l5()}}function l5(){uS||(uS=c5.then(d5))}function zde(t){st(t)?kp.push(...t):Ju&&t.id===-1?Ju.splice(Ep+1,0,t):t.flags&1||(kp.push(t),t.flags|=1),l5()}function Qj(t,o,s=ol+1){for(;s<hi.length;s++){const a=hi[s];if(a&&a.flags&2){if(t&&a.id!==t.uid)continue;hi.splice(s,1),s--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function u5(t){if(kp.length){const o=[...new Set(kp)].sort((s,a)=>Ig(s)-Ig(a));if(kp.length=0,Ju){Ju.push(...o);return}for(Ju=o,Ep=0;Ep<Ju.length;Ep++){const s=Ju[Ep];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}Ju=null,Ep=0}}const Ig=t=>t.id==null?t.flags&2?-1:1/0:t.id;function d5(t){try{for(ol=0;ol<hi.length;ol++){const o=hi[ol];o&&!(o.flags&8)&&(o.flags&4&&(o.flags&=-2),t_(o,o.i,o.i?15:14),o.flags&4||(o.flags&=-2))}}finally{for(;ol<hi.length;ol++){const o=hi[ol];o&&(o.flags&=-2)}ol=-1,hi.length=0,u5(),uS=null,(hi.length||kp.length)&&d5()}}let Ss=null,h5=null;function dS(t){const o=Ss;return Ss=t,h5=t&&t.type.__scopeId||null,o}function Ce(t,o=Ss,s){if(!o||t._n)return t;const a=(...l)=>{a._d&&f6(-1);const d=dS(o);let h;try{h=t(...l)}finally{dS(d),a._d&&f6(1)}return h};return a._n=!0,a._c=!0,a._d=!0,a}function ln(t,o){if(Ss===null)return t;const s=r0(Ss),a=t.dirs||(t.dirs=[]);for(let l=0;l<o.length;l++){let[d,h,v,g=po]=o[l];d&&(Ft(d)&&(d={mounted:d,updated:d}),d.deep&&Yl(h),a.push({dir:d,instance:s,value:h,oldValue:void 0,arg:v,modifiers:g}))}return t}function uh(t,o,s,a){const l=t.dirs,d=o&&o.dirs;for(let h=0;h<l.length;h++){const v=l[h];d&&(v.oldValue=d[h].value);let g=v.dir[a];g&&(md(),bc(g,s,8,[t.el,v,t,o]),vd())}}const f5=Symbol("_vte"),p5=t=>t.__isTeleport,dg=t=>t&&(t.disabled||t.disabled===""),e6=t=>t&&(t.defer||t.defer===""),t6=t=>typeof SVGElement<"u"&&t instanceof SVGElement,n6=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,LA=(t,o)=>{const s=t&&t.to;return Mt(s)?o?o(s):null:s},m5={name:"Teleport",__isTeleport:!0,process(t,o,s,a,l,d,h,v,g,E){const{mc:b,pc:S,pbc:C,o:{insert:w,querySelector:I,createText:R,createComment:N}}=E,O=dg(o.props);let{shapeFlag:V,children:L,dynamicChildren:D}=o;if(t==null){const M=o.el=R(""),F=o.anchor=R("");w(M,s,a),w(F,s,a);const W=(G,Y)=>{V&16&&(l&&l.isCE&&(l.ce._teleportTarget=G),b(L,G,Y,l,d,h,v,g))},z=()=>{const G=o.target=LA(o.props,I),Y=v5(G,o,R,w);G&&(h!=="svg"&&t6(G)?h="svg":h!=="mathml"&&n6(G)&&(h="mathml"),O||(W(G,Y),Bb(o,!1)))};O&&(W(s,F),Bb(o,!0)),e6(o.props)?ui(()=>{z(),o.el.__isMounted=!0},d):z()}else{if(e6(o.props)&&!t.el.__isMounted){ui(()=>{m5.process(t,o,s,a,l,d,h,v,g,E),delete t.el.__isMounted},d);return}o.el=t.el,o.targetStart=t.targetStart;const M=o.anchor=t.anchor,F=o.target=t.target,W=o.targetAnchor=t.targetAnchor,z=dg(t.props),G=z?s:F,Y=z?M:W;if(h==="svg"||t6(F)?h="svg":(h==="mathml"||n6(F))&&(h="mathml"),D?(C(t.dynamicChildren,D,G,l,d,h,v),bN(t,o,!0)):g||S(t,o,G,Y,l,d,h,v,!1),O)z?o.props&&t.props&&o.props.to!==t.props.to&&(o.props.to=t.props.to):Eb(o,s,M,E,1);else if((o.props&&o.props.to)!==(t.props&&t.props.to)){const te=o.target=LA(o.props,I);te&&Eb(o,te,null,E,0)}else z&&Eb(o,F,W,E,1);Bb(o,O)}},remove(t,o,s,{um:a,o:{remove:l}},d){const{shapeFlag:h,children:v,anchor:g,targetStart:E,targetAnchor:b,target:S,props:C}=t;if(S&&(l(E),l(b)),d&&l(g),h&16){const w=d||!dg(C);for(let I=0;I<v.length;I++){const R=v[I];a(R,o,s,w,!!R.dynamicChildren)}}},move:Eb,hydrate:Yde};function Eb(t,o,s,{o:{insert:a},m:l},d=2){d===0&&a(t.targetAnchor,o,s);const{el:h,anchor:v,shapeFlag:g,children:E,props:b}=t,S=d===2;if(S&&a(h,o,s),(!S||dg(b))&&g&16)for(let C=0;C<E.length;C++)l(E[C],o,s,2);S&&a(v,o,s)}function Yde(t,o,s,a,l,d,{o:{nextSibling:h,parentNode:v,querySelector:g,insert:E,createText:b}},S){const C=o.target=LA(o.props,g);if(C){const w=dg(o.props),I=C._lpa||C.firstChild;if(o.shapeFlag&16)if(w)o.anchor=S(h(t),o,v(t),s,a,l,d),o.targetStart=I,o.targetAnchor=I&&h(I);else{o.anchor=h(t);let R=I;for(;R;){if(R&&R.nodeType===8){if(R.data==="teleport start anchor")o.targetStart=R;else if(R.data==="teleport anchor"){o.targetAnchor=R,C._lpa=o.targetAnchor&&h(o.targetAnchor);break}}R=h(R)}o.targetAnchor||v5(C,o,b,E),S(I&&h(I),o,C,s,a,l,d)}Bb(o,w)}return o.anchor&&h(o.anchor)}const qde=m5;function Bb(t,o){const s=t.ctx;if(s&&s.ut){let a,l;for(o?(a=t.el,l=t.anchor):(a=t.targetStart,l=t.targetAnchor);a&&a!==l;)a.nodeType===1&&a.setAttribute("data-v-owner",s.uid),a=a.nextSibling;s.ut()}}function v5(t,o,s,a){const l=o.targetStart=s(""),d=o.targetAnchor=s("");return l[f5]=d,t&&(a(l,t),a(d,t)),d}const Zu=Symbol("_leaveCb"),yb=Symbol("_enterCb");function g5(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return dn(()=>{t.isMounted=!0}),Rr(()=>{t.isUnmounting=!0}),t}const La=[Function,Array],_5={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:La,onEnter:La,onAfterEnter:La,onEnterCancelled:La,onBeforeLeave:La,onLeave:La,onAfterLeave:La,onLeaveCancelled:La,onBeforeAppear:La,onAppear:La,onAfterAppear:La,onAppearCancelled:La},E5=t=>{const o=t.subTree;return o.component?E5(o.component):o},Xde={name:"BaseTransition",props:_5,setup(t,{slots:o}){const s=mn(),a=g5();return()=>{const l=o.default&&vN(o.default(),!0);if(!l||!l.length)return;const d=y5(l),h=Tr(t),{mode:v}=h;if(a.isLeaving)return WI(d);const g=r6(d);if(!g)return WI(d);let E=Ag(g,h,a,s,S=>E=S);g.type!==is&&Dh(g,E);let b=s.subTree&&r6(s.subTree);if(b&&b.type!==is&&!gh(g,b)&&E5(s).type!==is){let S=Ag(b,h,a,s);if(Dh(b,S),v==="out-in"&&g.type!==is)return a.isLeaving=!0,S.afterLeave=()=>{a.isLeaving=!1,s.job.flags&8||s.update(),delete S.afterLeave,b=void 0},WI(d);v==="in-out"&&g.type!==is?S.delayLeave=(C,w,I)=>{const R=b5(a,b);R[String(b.key)]=b,C[Zu]=()=>{w(),C[Zu]=void 0,delete E.delayedLeave,b=void 0},E.delayedLeave=()=>{I(),delete E.delayedLeave,b=void 0}}:b=void 0}else b&&(b=void 0);return d}}};function y5(t){let o=t[0];if(t.length>1){for(const s of t)if(s.type!==is){o=s;break}}return o}const Jde=Xde;function b5(t,o){const{leavingVNodes:s}=t;let a=s.get(o.type);return a||(a=Object.create(null),s.set(o.type,a)),a}function Ag(t,o,s,a,l){const{appear:d,mode:h,persisted:v=!1,onBeforeEnter:g,onEnter:E,onAfterEnter:b,onEnterCancelled:S,onBeforeLeave:C,onLeave:w,onAfterLeave:I,onLeaveCancelled:R,onBeforeAppear:N,onAppear:O,onAfterAppear:V,onAppearCancelled:L}=o,D=String(t.key),M=b5(s,t),F=(G,Y)=>{G&&bc(G,a,9,Y)},W=(G,Y)=>{const te=Y[1];F(G,Y),st(G)?G.every(Z=>Z.length<=1)&&te():G.length<=1&&te()},z={mode:h,persisted:v,beforeEnter(G){let Y=g;if(!s.isMounted)if(d)Y=N||g;else return;G[Zu]&&G[Zu](!0);const te=M[D];te&&gh(t,te)&&te.el[Zu]&&te.el[Zu](),F(Y,[G])},enter(G){let Y=E,te=b,Z=S;if(!s.isMounted)if(d)Y=O||E,te=V||b,Z=L||S;else return;let fe=!1;const Ee=G[yb]=ae=>{fe||(fe=!0,ae?F(Z,[G]):F(te,[G]),z.delayedLeave&&z.delayedLeave(),G[yb]=void 0)};Y?W(Y,[G,Ee]):Ee()},leave(G,Y){const te=String(t.key);if(G[yb]&&G[yb](!0),s.isUnmounting)return Y();F(C,[G]);let Z=!1;const fe=G[Zu]=Ee=>{Z||(Z=!0,Y(),Ee?F(R,[G]):F(I,[G]),G[Zu]=void 0,M[te]===t&&delete M[te])};M[te]=t,w?W(w,[G,fe]):fe()},clone(G){const Y=Ag(G,o,s,a,l);return l&&l(Y),Y}};return z}function WI(t){if(ZS(t))return t=eu(t),t.children=null,t}function r6(t){if(!ZS(t))return p5(t.type)&&t.children?y5(t.children):t;const{shapeFlag:o,children:s}=t;if(s){if(o&16)return s[0];if(o&32&&Ft(s.default))return s.default()}}function Dh(t,o){t.shapeFlag&6&&t.component?(t.transition=o,Dh(t.component.subTree,o)):t.shapeFlag&128?(t.ssContent.transition=o.clone(t.ssContent),t.ssFallback.transition=o.clone(t.ssFallback)):t.transition=o}function vN(t,o=!1,s){let a=[],l=0;for(let d=0;d<t.length;d++){let h=t[d];const v=s==null?h.key:String(s)+String(h.key!=null?h.key:d);h.type===Ut?(h.patchFlag&128&&l++,a=a.concat(vN(h.children,o,v))):(o||h.type!==is)&&a.push(v!=null?eu(h,{key:v}):h)}if(l>1)for(let d=0;d<a.length;d++)a[d].patchFlag=-2;return a}/*! #__NO_SIDE_EFFECTS__ */function me(t,o){return Ft(t)?us({name:t.name},o,{setup:t}):t}function S5(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function hS(t,o,s,a,l=!1){if(st(t)){t.forEach((I,R)=>hS(I,o&&(st(o)?o[R]:o),s,a,l));return}if(Pp(a)&&!l){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&hS(t,o,s,a.component.subTree);return}const d=a.shapeFlag&4?r0(a.component):a.el,h=l?null:d,{i:v,r:g}=t,E=o&&o.r,b=v.refs===po?v.refs={}:v.refs,S=v.setupState,C=Tr(S),w=S===po?()=>!1:I=>zn(C,I);if(E!=null&&E!==g&&(Mt(E)?(b[E]=null,w(E)&&(S[E]=null)):xr(E)&&(E.value=null)),Ft(g))t_(g,v,12,[h,b]);else{const I=Mt(g),R=xr(g);if(I||R){const N=()=>{if(t.f){const O=I?w(g)?S[g]:b[g]:g.value;l?st(O)&&aN(O,d):st(O)?O.includes(d)||O.push(d):I?(b[g]=[d],w(g)&&(S[g]=b[g])):(g.value=[d],t.k&&(b[t.k]=g.value))}else I?(b[g]=h,w(g)&&(S[g]=h)):R&&(g.value=h,t.k&&(b[t.k]=h))};h?(N.id=-1,ui(N,s)):N()}}}YS().requestIdleCallback;YS().cancelIdleCallback;const Pp=t=>!!t.type.__asyncLoader,ZS=t=>t.type.__isKeepAlive;function gN(t,o){C5(t,"a",o)}function T5(t,o){C5(t,"da",o)}function C5(t,o,s=Ls){const a=t.__wdc||(t.__wdc=()=>{let l=s;for(;l;){if(l.isDeactivated)return;l=l.parent}return t()});if(QS(o,a,s),s){let l=s.parent;for(;l&&l.parent;)ZS(l.parent.vnode)&&Zde(a,o,s,l),l=l.parent}}function Zde(t,o,s,a){const l=QS(o,t,a,!0);iu(()=>{aN(a[o],l)},s)}function QS(t,o,s=Ls,a=!1){if(s){const l=s[t]||(s[t]=[]),d=o.__weh||(o.__weh=(...h)=>{md();const v=n_(s),g=bc(o,s,t,h);return v(),vd(),g});return a?l.unshift(d):l.push(d),d}}const su=t=>(o,s=Ls)=>{(!Ng||t==="sp")&&QS(t,(...a)=>o(...a),s)},e0=su("bm"),dn=su("m"),w5=su("bu"),wc=su("u"),Rr=su("bum"),iu=su("um"),Qde=su("sp"),ehe=su("rtg"),the=su("rtc");function nhe(t,o=Ls){QS("ec",t,o)}const _N="components",rhe="directives";function _n(t,o){return EN(_N,t,!0,o)||t}const R5=Symbol.for("v-ndc");function gn(t){return Mt(t)?EN(_N,t,!1)||t:t||R5}function t0(t){return EN(rhe,t)}function EN(t,o,s=!0,a=!1){const l=Ss||Ls;if(l){const d=l.type;if(t===_N){const v=jhe(d,!1);if(v&&(v===o||v===gi(o)||v===e_(gi(o))))return d}const h=o6(l[t]||d[t],o)||o6(l.appContext[t],o);return!h&&a?d:h}}function o6(t,o){return t&&(t[o]||t[gi(o)]||t[e_(gi(o))])}function Cn(t,o,s,a){let l;const d=s,h=st(t);if(h||Mt(t)){const v=h&&Np(t);let g=!1;v&&(g=!Fa(t),t=XS(t)),l=new Array(t.length);for(let E=0,b=t.length;E<b;E++)l[E]=o(g?Xs(t[E]):t[E],E,void 0,d)}else if(typeof t=="number"){l=new Array(t);for(let v=0;v<t;v++)l[v]=o(v+1,v,void 0,d)}else if(fn(t))if(t[Symbol.iterator])l=Array.from(t,(v,g)=>o(v,g,void 0,d));else{const v=Object.keys(t);l=new Array(v.length);for(let g=0,E=v.length;g<E;g++){const b=v[g];l[g]=o(t[b],b,g,d)}}else l=[];return l}function fa(t,o){for(let s=0;s<o.length;s++){const a=o[s];if(st(a))for(let l=0;l<a.length;l++)t[a[l].name]=a[l].fn;else a&&(t[a.name]=a.key?(...l)=>{const d=a.fn(...l);return d&&(d.key=a.key),d}:a.fn)}return t}function Ne(t,o,s={},a,l){if(Ss.ce||Ss.parent&&Pp(Ss.parent)&&Ss.parent.ce)return o!=="default"&&(s.name=o),$(),Ve(Ut,null,[ge("slot",s,a&&a())],64);let d=t[o];d&&d._c&&(d._d=!1),$();const h=d&&I5(d(s)),v=s.key||h&&h.key,g=Ve(Ut,{key:(v&&!yc(v)?v:`_${o}`)+(!h&&a?"_fb":"")},h||(a?a():[]),h&&t._===1?64:-2);return g.scopeId&&(g.slotScopeIds=[g.scopeId+"-s"]),d&&d._c&&(d._d=!0),g}function I5(t){return t.some(o=>Kr(o)?!(o.type===is||o.type===Ut&&!I5(o.children)):!0)?t:null}function ohe(t,o){const s={};for(const a in t)s[cg(a)]=t[a];return s}const MA=t=>t?z5(t)?r0(t):MA(t.parent):null,hg=us(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>MA(t.parent),$root:t=>MA(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>N5(t),$forceUpdate:t=>t.f||(t.f=()=>{mN(t.update)}),$nextTick:t=>t.n||(t.n=Vt.bind(t.proxy)),$watch:t=>whe.bind(t)}),KI=(t,o)=>t!==po&&!t.__isScriptSetup&&zn(t,o),she={get({_:t},o){if(o==="__v_skip")return!0;const{ctx:s,setupState:a,data:l,props:d,accessCache:h,type:v,appContext:g}=t;let E;if(o[0]!=="$"){const w=h[o];if(w!==void 0)switch(w){case 1:return a[o];case 2:return l[o];case 4:return s[o];case 3:return d[o]}else{if(KI(a,o))return h[o]=1,a[o];if(l!==po&&zn(l,o))return h[o]=2,l[o];if((E=t.propsOptions[0])&&zn(E,o))return h[o]=3,d[o];if(s!==po&&zn(s,o))return h[o]=4,s[o];xA&&(h[o]=0)}}const b=hg[o];let S,C;if(b)return o==="$attrs"&&qs(t.attrs,"get",""),b(t);if((S=v.__cssModules)&&(S=S[o]))return S;if(s!==po&&zn(s,o))return h[o]=4,s[o];if(C=g.config.globalProperties,zn(C,o))return C[o]},set({_:t},o,s){const{data:a,setupState:l,ctx:d}=t;return KI(l,o)?(l[o]=s,!0):a!==po&&zn(a,o)?(a[o]=s,!0):zn(t.props,o)||o[0]==="$"&&o.slice(1)in t?!1:(d[o]=s,!0)},has({_:{data:t,setupState:o,accessCache:s,ctx:a,appContext:l,propsOptions:d}},h){let v;return!!s[h]||t!==po&&zn(t,h)||KI(o,h)||(v=d[0])&&zn(v,h)||zn(a,h)||zn(hg,h)||zn(l.config.globalProperties,h)},defineProperty(t,o,s){return s.get!=null?t._.accessCache[o]=0:zn(s,"value")&&this.set(t,o,s.value,null),Reflect.defineProperty(t,o,s)}};function Jo(){return A5().slots}function au(){return A5().attrs}function A5(){const t=mn();return t.setupContext||(t.setupContext=q5(t))}function s6(t){return st(t)?t.reduce((o,s)=>(o[s]=null,o),{}):t}let xA=!0;function ihe(t){const o=N5(t),s=t.proxy,a=t.ctx;xA=!1,o.beforeCreate&&i6(o.beforeCreate,t,"bc");const{data:l,computed:d,methods:h,watch:v,provide:g,inject:E,created:b,beforeMount:S,mounted:C,beforeUpdate:w,updated:I,activated:R,deactivated:N,beforeDestroy:O,beforeUnmount:V,destroyed:L,unmounted:D,render:M,renderTracked:F,renderTriggered:W,errorCaptured:z,serverPrefetch:G,expose:Y,inheritAttrs:te,components:Z,directives:fe,filters:Ee}=o;if(E&&ahe(E,a,null),h)for(const ie in h){const se=h[ie];Ft(se)&&(a[ie]=se.bind(s))}if(l){const ie=l.call(s,s);fn(ie)&&(t.data=er(ie))}if(xA=!0,d)for(const ie in d){const se=d[ie],J=Ft(se)?se.bind(s,s):Ft(se.get)?se.get.bind(s,s):pr,pe=!Ft(se)&&Ft(se.set)?se.set.bind(s):pr,be=U({get:J,set:pe});Object.defineProperty(a,ie,{enumerable:!0,configurable:!0,get:()=>be.value,set:Ae=>be.value=Ae})}if(v)for(const ie in v)O5(v[ie],a,s,ie);if(g){const ie=Ft(g)?g.call(s):g;Reflect.ownKeys(ie).forEach(se=>{wn(se,ie[se])})}b&&i6(b,t,"c");function X(ie,se){st(se)?se.forEach(J=>ie(J.bind(s))):se&&ie(se.bind(s))}if(X(e0,S),X(dn,C),X(w5,w),X(wc,I),X(gN,R),X(T5,N),X(nhe,z),X(the,F),X(ehe,W),X(Rr,V),X(iu,D),X(Qde,G),st(Y))if(Y.length){const ie=t.exposed||(t.exposed={});Y.forEach(se=>{Object.defineProperty(ie,se,{get:()=>s[se],set:J=>s[se]=J})})}else t.exposed||(t.exposed={});M&&t.render===pr&&(t.render=M),te!=null&&(t.inheritAttrs=te),Z&&(t.components=Z),fe&&(t.directives=fe),G&&S5(t)}function ahe(t,o,s=pr){st(t)&&(t=UA(t));for(const a in t){const l=t[a];let d;fn(l)?"default"in l?d=It(l.from||a,l.default,!0):d=It(l.from||a):d=It(l),xr(d)?Object.defineProperty(o,a,{enumerable:!0,configurable:!0,get:()=>d.value,set:h=>d.value=h}):o[a]=d}}function i6(t,o,s){bc(st(t)?t.map(a=>a.bind(o.proxy)):t.bind(o.proxy),o,s)}function O5(t,o,s,a){let l=a.includes(".")?$5(s,a):()=>s[a];if(Mt(t)){const d=o[t];Ft(d)&&ze(l,d)}else if(Ft(t))ze(l,t.bind(s));else if(fn(t))if(st(t))t.forEach(d=>O5(d,o,s,a));else{const d=Ft(t.handler)?t.handler.bind(s):o[t.handler];Ft(d)&&ze(l,d,t)}}function N5(t){const o=t.type,{mixins:s,extends:a}=o,{mixins:l,optionsCache:d,config:{optionMergeStrategies:h}}=t.appContext,v=d.get(o);let g;return v?g=v:!l.length&&!s&&!a?g=o:(g={},l.length&&l.forEach(E=>fS(g,E,h,!0)),fS(g,o,h)),fn(o)&&d.set(o,g),g}function fS(t,o,s,a=!1){const{mixins:l,extends:d}=o;d&&fS(t,d,s,!0),l&&l.forEach(h=>fS(t,h,s,!0));for(const h in o)if(!(a&&h==="expose")){const v=che[h]||s&&s[h];t[h]=v?v(t[h],o[h]):o[h]}return t}const che={data:a6,props:c6,emits:c6,methods:ng,computed:ng,beforeCreate:li,created:li,beforeMount:li,mounted:li,beforeUpdate:li,updated:li,beforeDestroy:li,beforeUnmount:li,destroyed:li,unmounted:li,activated:li,deactivated:li,errorCaptured:li,serverPrefetch:li,components:ng,directives:ng,watch:uhe,provide:a6,inject:lhe};function a6(t,o){return o?t?function(){return us(Ft(t)?t.call(this,this):t,Ft(o)?o.call(this,this):o)}:o:t}function lhe(t,o){return ng(UA(t),UA(o))}function UA(t){if(st(t)){const o={};for(let s=0;s<t.length;s++)o[t[s]]=t[s];return o}return t}function li(t,o){return t?[...new Set([].concat(t,o))]:o}function ng(t,o){return t?us(Object.create(null),t,o):o}function c6(t,o){return t?st(t)&&st(o)?[...new Set([...t,...o])]:us(Object.create(null),s6(t),s6(o??{})):o}function uhe(t,o){if(!t)return o;if(!o)return t;const s=us(Object.create(null),t);for(const a in o)s[a]=li(t[a],o[a]);return s}function k5(){return{app:null,config:{isNativeTag:nde,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let dhe=0;function hhe(t,o){return function(a,l=null){Ft(a)||(a=us({},a)),l!=null&&!fn(l)&&(l=null);const d=k5(),h=new WeakSet,v=[];let g=!1;const E=d.app={_uid:dhe++,_component:a,_props:l,_container:null,_context:d,_instance:null,version:Hhe,get config(){return d.config},set config(b){},use(b,...S){return h.has(b)||(b&&Ft(b.install)?(h.add(b),b.install(E,...S)):Ft(b)&&(h.add(b),b(E,...S))),E},mixin(b){return d.mixins.includes(b)||d.mixins.push(b),E},component(b,S){return S?(d.components[b]=S,E):d.components[b]},directive(b,S){return S?(d.directives[b]=S,E):d.directives[b]},mount(b,S,C){if(!g){const w=E._ceVNode||ge(a,l);return w.appContext=d,C===!0?C="svg":C===!1&&(C=void 0),t(w,b,C),g=!0,E._container=b,b.__vue_app__=E,r0(w.component)}},onUnmount(b){v.push(b)},unmount(){g&&(bc(v,E._instance,16),t(null,E._container),delete E._container.__vue_app__)},provide(b,S){return d.provides[b]=S,E},runWithContext(b){const S=Dp;Dp=E;try{return b()}finally{Dp=S}}};return E}}let Dp=null;function wn(t,o){if(Ls){let s=Ls.provides;const a=Ls.parent&&Ls.parent.provides;a===s&&(s=Ls.provides=Object.create(a)),s[t]=o}}function It(t,o,s=!1){const a=Ls||Ss;if(a||Dp){const l=Dp?Dp._context.provides:a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(l&&t in l)return l[t];if(arguments.length>1)return s&&Ft(o)?o.call(a&&a.proxy):o}}const P5={},D5=()=>Object.create(P5),L5=t=>Object.getPrototypeOf(t)===P5;function fhe(t,o,s,a=!1){const l={},d=D5();t.propsDefaults=Object.create(null),M5(t,o,l,d);for(const h in t.propsOptions[0])h in l||(l[h]=void 0);s?t.props=a?l:o5(l):t.type.props?t.props=l:t.props=d,t.attrs=d}function phe(t,o,s,a){const{props:l,attrs:d,vnode:{patchFlag:h}}=t,v=Tr(l),[g]=t.propsOptions;let E=!1;if((a||h>0)&&!(h&16)){if(h&8){const b=t.vnode.dynamicProps;for(let S=0;S<b.length;S++){let C=b[S];if(n0(t.emitsOptions,C))continue;const w=o[C];if(g)if(zn(d,C))w!==d[C]&&(d[C]=w,E=!0);else{const I=gi(C);l[I]=VA(g,v,I,w,t,!1)}else w!==d[C]&&(d[C]=w,E=!0)}}}else{M5(t,o,l,d)&&(E=!0);let b;for(const S in v)(!o||!zn(o,S)&&((b=ou(S))===S||!zn(o,b)))&&(g?s&&(s[S]!==void 0||s[b]!==void 0)&&(l[S]=VA(g,v,S,void 0,t,!0)):delete l[S]);if(d!==v)for(const S in d)(!o||!zn(o,S))&&(delete d[S],E=!0)}E&&zl(t.attrs,"set","")}function M5(t,o,s,a){const[l,d]=t.propsOptions;let h=!1,v;if(o)for(let g in o){if(ag(g))continue;const E=o[g];let b;l&&zn(l,b=gi(g))?!d||!d.includes(b)?s[b]=E:(v||(v={}))[b]=E:n0(t.emitsOptions,g)||(!(g in a)||E!==a[g])&&(a[g]=E,h=!0)}if(d){const g=Tr(s),E=v||po;for(let b=0;b<d.length;b++){const S=d[b];s[S]=VA(l,g,S,E[S],t,!zn(E,S))}}return h}function VA(t,o,s,a,l,d){const h=t[s];if(h!=null){const v=zn(h,"default");if(v&&a===void 0){const g=h.default;if(h.type!==Function&&!h.skipFactory&&Ft(g)){const{propsDefaults:E}=l;if(s in E)a=E[s];else{const b=n_(l);a=E[s]=g.call(null,o),b()}}else a=g;l.ce&&l.ce._setProp(s,a)}h[0]&&(d&&!v?a=!1:h[1]&&(a===""||a===ou(s))&&(a=!0))}return a}const mhe=new WeakMap;function x5(t,o,s=!1){const a=s?mhe:o.propsCache,l=a.get(t);if(l)return l;const d=t.props,h={},v=[];let g=!1;if(!Ft(t)){const b=S=>{g=!0;const[C,w]=x5(S,o,!0);us(h,C),w&&v.push(...w)};!s&&o.mixins.length&&o.mixins.forEach(b),t.extends&&b(t.extends),t.mixins&&t.mixins.forEach(b)}if(!d&&!g)return fn(t)&&a.set(t,Ap),Ap;if(st(d))for(let b=0;b<d.length;b++){const S=gi(d[b]);l6(S)&&(h[S]=po)}else if(d)for(const b in d){const S=gi(b);if(l6(S)){const C=d[b],w=h[S]=st(C)||Ft(C)?{type:C}:us({},C),I=w.type;let R=!1,N=!0;if(st(I))for(let O=0;O<I.length;++O){const V=I[O],L=Ft(V)&&V.name;if(L==="Boolean"){R=!0;break}else L==="String"&&(N=!1)}else R=Ft(I)&&I.name==="Boolean";w[0]=R,w[1]=N,(R||zn(w,"default"))&&v.push(S)}}const E=[h,v];return fn(t)&&a.set(t,E),E}function l6(t){return t[0]!=="$"&&!ag(t)}const U5=t=>t[0]==="_"||t==="$stable",yN=t=>st(t)?t.map(sl):[sl(t)],vhe=(t,o,s)=>{if(o._n)return o;const a=Ce((...l)=>yN(o(...l)),s);return a._c=!1,a},V5=(t,o,s)=>{const a=t._ctx;for(const l in t){if(U5(l))continue;const d=t[l];if(Ft(d))o[l]=vhe(l,d,a);else if(d!=null){const h=yN(d);o[l]=()=>h}}},F5=(t,o)=>{const s=yN(o);t.slots.default=()=>s},B5=(t,o,s)=>{for(const a in o)(s||a!=="_")&&(t[a]=o[a])},ghe=(t,o,s)=>{const a=t.slots=D5();if(t.vnode.shapeFlag&32){const l=o._;l?(B5(a,o,s),s&&x8(a,"_",l,!0)):V5(o,a)}else o&&F5(t,o)},_he=(t,o,s)=>{const{vnode:a,slots:l}=t;let d=!0,h=po;if(a.shapeFlag&32){const v=o._;v?s&&v===1?d=!1:B5(l,o,s):(d=!o.$stable,V5(o,l)),h=o}else o&&(F5(t,o),h={default:1});if(d)for(const v in l)!U5(v)&&h[v]==null&&delete l[v]},ui=Phe;function Ehe(t){return yhe(t)}function yhe(t,o){const s=YS();s.__VUE__=!0;const{insert:a,remove:l,patchProp:d,createElement:h,createText:v,createComment:g,setText:E,setElementText:b,parentNode:S,nextSibling:C,setScopeId:w=pr,insertStaticContent:I}=t,R=(ce,Se,je,tt=null,et=null,Ge=null,Xe=void 0,Ye=null,ct=!!Se.dynamicChildren)=>{if(ce===Se)return;ce&&!gh(ce,Se)&&(tt=Pe(ce),Ae(ce,et,Ge,!0),ce=null),Se.patchFlag===-2&&(ct=!1,Se.dynamicChildren=null);const{type:nt,ref:Ot,shapeFlag:_t}=Se;switch(nt){case cm:N(ce,Se,je,tt);break;case is:O(ce,Se,je,tt);break;case zI:ce==null&&V(Se,je,tt,Xe);break;case Ut:Z(ce,Se,je,tt,et,Ge,Xe,Ye,ct);break;default:_t&1?M(ce,Se,je,tt,et,Ge,Xe,Ye,ct):_t&6?fe(ce,Se,je,tt,et,Ge,Xe,Ye,ct):(_t&64||_t&128)&&nt.process(ce,Se,je,tt,et,Ge,Xe,Ye,ct,yt)}Ot!=null&&et&&hS(Ot,ce&&ce.ref,Ge,Se||ce,!Se)},N=(ce,Se,je,tt)=>{if(ce==null)a(Se.el=v(Se.children),je,tt);else{const et=Se.el=ce.el;Se.children!==ce.children&&E(et,Se.children)}},O=(ce,Se,je,tt)=>{ce==null?a(Se.el=g(Se.children||""),je,tt):Se.el=ce.el},V=(ce,Se,je,tt)=>{[ce.el,ce.anchor]=I(ce.children,Se,je,tt,ce.el,ce.anchor)},L=({el:ce,anchor:Se},je,tt)=>{let et;for(;ce&&ce!==Se;)et=C(ce),a(ce,je,tt),ce=et;a(Se,je,tt)},D=({el:ce,anchor:Se})=>{let je;for(;ce&&ce!==Se;)je=C(ce),l(ce),ce=je;l(Se)},M=(ce,Se,je,tt,et,Ge,Xe,Ye,ct)=>{Se.type==="svg"?Xe="svg":Se.type==="math"&&(Xe="mathml"),ce==null?F(Se,je,tt,et,Ge,Xe,Ye,ct):G(ce,Se,et,Ge,Xe,Ye,ct)},F=(ce,Se,je,tt,et,Ge,Xe,Ye)=>{let ct,nt;const{props:Ot,shapeFlag:_t,transition:qe,dirs:wt}=ce;if(ct=ce.el=h(ce.type,Ge,Ot&&Ot.is,Ot),_t&8?b(ct,ce.children):_t&16&&z(ce.children,ct,null,tt,et,GI(ce,Ge),Xe,Ye),wt&&uh(ce,null,tt,"created"),W(ct,ce,ce.scopeId,Xe,tt),Ot){for(const sn in Ot)sn!=="value"&&!ag(sn)&&d(ct,sn,null,Ot[sn],Ge,tt);"value"in Ot&&d(ct,"value",null,Ot.value,Ge),(nt=Ot.onVnodeBeforeMount)&&tl(nt,tt,ce)}wt&&uh(ce,null,tt,"beforeMount");const qt=bhe(et,qe);qt&&qe.beforeEnter(ct),a(ct,Se,je),((nt=Ot&&Ot.onVnodeMounted)||qt||wt)&&ui(()=>{nt&&tl(nt,tt,ce),qt&&qe.enter(ct),wt&&uh(ce,null,tt,"mounted")},et)},W=(ce,Se,je,tt,et)=>{if(je&&w(ce,je),tt)for(let Ge=0;Ge<tt.length;Ge++)w(ce,tt[Ge]);if(et){let Ge=et.subTree;if(Se===Ge||W5(Ge.type)&&(Ge.ssContent===Se||Ge.ssFallback===Se)){const Xe=et.vnode;W(ce,Xe,Xe.scopeId,Xe.slotScopeIds,et.parent)}}},z=(ce,Se,je,tt,et,Ge,Xe,Ye,ct=0)=>{for(let nt=ct;nt<ce.length;nt++){const Ot=ce[nt]=Ye?Qu(ce[nt]):sl(ce[nt]);R(null,Ot,Se,je,tt,et,Ge,Xe,Ye)}},G=(ce,Se,je,tt,et,Ge,Xe)=>{const Ye=Se.el=ce.el;let{patchFlag:ct,dynamicChildren:nt,dirs:Ot}=Se;ct|=ce.patchFlag&16;const _t=ce.props||po,qe=Se.props||po;let wt;if(je&&dh(je,!1),(wt=qe.onVnodeBeforeUpdate)&&tl(wt,je,Se,ce),Ot&&uh(Se,ce,je,"beforeUpdate"),je&&dh(je,!0),(_t.innerHTML&&qe.innerHTML==null||_t.textContent&&qe.textContent==null)&&b(Ye,""),nt?Y(ce.dynamicChildren,nt,Ye,je,tt,GI(Se,et),Ge):Xe||se(ce,Se,Ye,null,je,tt,GI(Se,et),Ge,!1),ct>0){if(ct&16)te(Ye,_t,qe,je,et);else if(ct&2&&_t.class!==qe.class&&d(Ye,"class",null,qe.class,et),ct&4&&d(Ye,"style",_t.style,qe.style,et),ct&8){const qt=Se.dynamicProps;for(let sn=0;sn<qt.length;sn++){const tn=qt[sn],Kn=_t[tn],Sn=qe[tn];(Sn!==Kn||tn==="value")&&d(Ye,tn,Kn,Sn,et,je)}}ct&1&&ce.children!==Se.children&&b(Ye,Se.children)}else!Xe&&nt==null&&te(Ye,_t,qe,je,et);((wt=qe.onVnodeUpdated)||Ot)&&ui(()=>{wt&&tl(wt,je,Se,ce),Ot&&uh(Se,ce,je,"updated")},tt)},Y=(ce,Se,je,tt,et,Ge,Xe)=>{for(let Ye=0;Ye<Se.length;Ye++){const ct=ce[Ye],nt=Se[Ye],Ot=ct.el&&(ct.type===Ut||!gh(ct,nt)||ct.shapeFlag&70)?S(ct.el):je;R(ct,nt,Ot,null,tt,et,Ge,Xe,!0)}},te=(ce,Se,je,tt,et)=>{if(Se!==je){if(Se!==po)for(const Ge in Se)!ag(Ge)&&!(Ge in je)&&d(ce,Ge,Se[Ge],null,et,tt);for(const Ge in je){if(ag(Ge))continue;const Xe=je[Ge],Ye=Se[Ge];Xe!==Ye&&Ge!=="value"&&d(ce,Ge,Ye,Xe,et,tt)}"value"in je&&d(ce,"value",Se.value,je.value,et)}},Z=(ce,Se,je,tt,et,Ge,Xe,Ye,ct)=>{const nt=Se.el=ce?ce.el:v(""),Ot=Se.anchor=ce?ce.anchor:v("");let{patchFlag:_t,dynamicChildren:qe,slotScopeIds:wt}=Se;wt&&(Ye=Ye?Ye.concat(wt):wt),ce==null?(a(nt,je,tt),a(Ot,je,tt),z(Se.children||[],je,Ot,et,Ge,Xe,Ye,ct)):_t>0&&_t&64&&qe&&ce.dynamicChildren?(Y(ce.dynamicChildren,qe,je,et,Ge,Xe,Ye),(Se.key!=null||et&&Se===et.subTree)&&bN(ce,Se,!0)):se(ce,Se,je,Ot,et,Ge,Xe,Ye,ct)},fe=(ce,Se,je,tt,et,Ge,Xe,Ye,ct)=>{Se.slotScopeIds=Ye,ce==null?Se.shapeFlag&512?et.ctx.activate(Se,je,tt,Xe,ct):Ee(Se,je,tt,et,Ge,Xe,ct):ae(ce,Se,ct)},Ee=(ce,Se,je,tt,et,Ge,Xe)=>{const Ye=ce.component=Uhe(ce,tt,et);if(ZS(ce)&&(Ye.ctx.renderer=yt),Vhe(Ye,!1,Xe),Ye.asyncDep){if(et&&et.registerDep(Ye,X,Xe),!ce.el){const ct=Ye.subTree=ge(is);O(null,ct,Se,je)}}else X(Ye,ce,Se,je,et,Ge,Xe)},ae=(ce,Se,je)=>{const tt=Se.component=ce.component;if(Nhe(ce,Se,je))if(tt.asyncDep&&!tt.asyncResolved){ie(tt,Se,je);return}else tt.next=Se,tt.update();else Se.el=ce.el,tt.vnode=Se},X=(ce,Se,je,tt,et,Ge,Xe)=>{const Ye=()=>{if(ce.isMounted){let{next:_t,bu:qe,u:wt,parent:qt,vnode:sn}=ce;{const Wt=j5(ce);if(Wt){_t&&(_t.el=sn.el,ie(ce,_t,Xe)),Wt.asyncDep.then(()=>{ce.isUnmounted||Ye()});return}}let tn=_t,Kn;dh(ce,!1),_t?(_t.el=sn.el,ie(ce,_t,Xe)):_t=sn,qe&&Fb(qe),(Kn=_t.props&&_t.props.onVnodeBeforeUpdate)&&tl(Kn,qt,_t,sn),dh(ce,!0);const Sn=d6(ce),zr=ce.subTree;ce.subTree=Sn,R(zr,Sn,S(zr.el),Pe(zr),ce,et,Ge),_t.el=Sn.el,tn===null&&khe(ce,Sn.el),wt&&ui(wt,et),(Kn=_t.props&&_t.props.onVnodeUpdated)&&ui(()=>tl(Kn,qt,_t,sn),et)}else{let _t;const{el:qe,props:wt}=Se,{bm:qt,m:sn,parent:tn,root:Kn,type:Sn}=ce,zr=Pp(Se);dh(ce,!1),qt&&Fb(qt),!zr&&(_t=wt&&wt.onVnodeBeforeMount)&&tl(_t,tn,Se),dh(ce,!0);{Kn.ce&&Kn.ce._injectChildStyle(Sn);const Wt=ce.subTree=d6(ce);R(null,Wt,je,tt,ce,et,Ge),Se.el=Wt.el}if(sn&&ui(sn,et),!zr&&(_t=wt&&wt.onVnodeMounted)){const Wt=Se;ui(()=>tl(_t,tn,Wt),et)}(Se.shapeFlag&256||tn&&Pp(tn.vnode)&&tn.vnode.shapeFlag&256)&&ce.a&&ui(ce.a,et),ce.isMounted=!0,Se=je=tt=null}};ce.scope.on();const ct=ce.effect=new W8(Ye);ce.scope.off();const nt=ce.update=ct.run.bind(ct),Ot=ce.job=ct.runIfDirty.bind(ct);Ot.i=ce,Ot.id=ce.uid,ct.scheduler=()=>mN(Ot),dh(ce,!0),nt()},ie=(ce,Se,je)=>{Se.component=ce;const tt=ce.vnode.props;ce.vnode=Se,ce.next=null,phe(ce,Se.props,tt,je),_he(ce,Se.children,je),md(),Qj(ce),vd()},se=(ce,Se,je,tt,et,Ge,Xe,Ye,ct=!1)=>{const nt=ce&&ce.children,Ot=ce?ce.shapeFlag:0,_t=Se.children,{patchFlag:qe,shapeFlag:wt}=Se;if(qe>0){if(qe&128){pe(nt,_t,je,tt,et,Ge,Xe,Ye,ct);return}else if(qe&256){J(nt,_t,je,tt,et,Ge,Xe,Ye,ct);return}}wt&8?(Ot&16&&Le(nt,et,Ge),_t!==nt&&b(je,_t)):Ot&16?wt&16?pe(nt,_t,je,tt,et,Ge,Xe,Ye,ct):Le(nt,et,Ge,!0):(Ot&8&&b(je,""),wt&16&&z(_t,je,tt,et,Ge,Xe,Ye,ct))},J=(ce,Se,je,tt,et,Ge,Xe,Ye,ct)=>{ce=ce||Ap,Se=Se||Ap;const nt=ce.length,Ot=Se.length,_t=Math.min(nt,Ot);let qe;for(qe=0;qe<_t;qe++){const wt=Se[qe]=ct?Qu(Se[qe]):sl(Se[qe]);R(ce[qe],wt,je,null,et,Ge,Xe,Ye,ct)}nt>Ot?Le(ce,et,Ge,!0,!1,_t):z(Se,je,tt,et,Ge,Xe,Ye,ct,_t)},pe=(ce,Se,je,tt,et,Ge,Xe,Ye,ct)=>{let nt=0;const Ot=Se.length;let _t=ce.length-1,qe=Ot-1;for(;nt<=_t&&nt<=qe;){const wt=ce[nt],qt=Se[nt]=ct?Qu(Se[nt]):sl(Se[nt]);if(gh(wt,qt))R(wt,qt,je,null,et,Ge,Xe,Ye,ct);else break;nt++}for(;nt<=_t&&nt<=qe;){const wt=ce[_t],qt=Se[qe]=ct?Qu(Se[qe]):sl(Se[qe]);if(gh(wt,qt))R(wt,qt,je,null,et,Ge,Xe,Ye,ct);else break;_t--,qe--}if(nt>_t){if(nt<=qe){const wt=qe+1,qt=wt<Ot?Se[wt].el:tt;for(;nt<=qe;)R(null,Se[nt]=ct?Qu(Se[nt]):sl(Se[nt]),je,qt,et,Ge,Xe,Ye,ct),nt++}}else if(nt>qe)for(;nt<=_t;)Ae(ce[nt],et,Ge,!0),nt++;else{const wt=nt,qt=nt,sn=new Map;for(nt=qt;nt<=qe;nt++){const Ke=Se[nt]=ct?Qu(Se[nt]):sl(Se[nt]);Ke.key!=null&&sn.set(Ke.key,nt)}let tn,Kn=0;const Sn=qe-qt+1;let zr=!1,Wt=0;const Je=new Array(Sn);for(nt=0;nt<Sn;nt++)Je[nt]=0;for(nt=wt;nt<=_t;nt++){const Ke=ce[nt];if(Kn>=Sn){Ae(Ke,et,Ge,!0);continue}let Te;if(Ke.key!=null)Te=sn.get(Ke.key);else for(tn=qt;tn<=qe;tn++)if(Je[tn-qt]===0&&gh(Ke,Se[tn])){Te=tn;break}Te===void 0?Ae(Ke,et,Ge,!0):(Je[Te-qt]=nt+1,Te>=Wt?Wt=Te:zr=!0,R(Ke,Se[Te],je,null,et,Ge,Xe,Ye,ct),Kn++)}const Ie=zr?She(Je):Ap;for(tn=Ie.length-1,nt=Sn-1;nt>=0;nt--){const Ke=qt+nt,Te=Se[Ke],vt=Ke+1<Ot?Se[Ke+1].el:tt;Je[nt]===0?R(null,Te,je,vt,et,Ge,Xe,Ye,ct):zr&&(tn<0||nt!==Ie[tn]?be(Te,je,vt,2):tn--)}}},be=(ce,Se,je,tt,et=null)=>{const{el:Ge,type:Xe,transition:Ye,children:ct,shapeFlag:nt}=ce;if(nt&6){be(ce.component.subTree,Se,je,tt);return}if(nt&128){ce.suspense.move(Se,je,tt);return}if(nt&64){Xe.move(ce,Se,je,yt);return}if(Xe===Ut){a(Ge,Se,je);for(let _t=0;_t<ct.length;_t++)be(ct[_t],Se,je,tt);a(ce.anchor,Se,je);return}if(Xe===zI){L(ce,Se,je);return}if(tt!==2&&nt&1&&Ye)if(tt===0)Ye.beforeEnter(Ge),a(Ge,Se,je),ui(()=>Ye.enter(Ge),et);else{const{leave:_t,delayLeave:qe,afterLeave:wt}=Ye,qt=()=>a(Ge,Se,je),sn=()=>{_t(Ge,()=>{qt(),wt&&wt()})};qe?qe(Ge,qt,sn):sn()}else a(Ge,Se,je)},Ae=(ce,Se,je,tt=!1,et=!1)=>{const{type:Ge,props:Xe,ref:Ye,children:ct,dynamicChildren:nt,shapeFlag:Ot,patchFlag:_t,dirs:qe,cacheIndex:wt}=ce;if(_t===-2&&(et=!1),Ye!=null&&hS(Ye,null,je,ce,!0),wt!=null&&(Se.renderCache[wt]=void 0),Ot&256){Se.ctx.deactivate(ce);return}const qt=Ot&1&&qe,sn=!Pp(ce);let tn;if(sn&&(tn=Xe&&Xe.onVnodeBeforeUnmount)&&tl(tn,Se,ce),Ot&6)Fe(ce.component,je,tt);else{if(Ot&128){ce.suspense.unmount(je,tt);return}qt&&uh(ce,null,Se,"beforeUnmount"),Ot&64?ce.type.remove(ce,Se,je,yt,tt):nt&&!nt.hasOnce&&(Ge!==Ut||_t>0&&_t&64)?Le(nt,Se,je,!1,!0):(Ge===Ut&&_t&384||!et&&Ot&16)&&Le(ct,Se,je),tt&&_e(ce)}(sn&&(tn=Xe&&Xe.onVnodeUnmounted)||qt)&&ui(()=>{tn&&tl(tn,Se,ce),qt&&uh(ce,null,Se,"unmounted")},je)},_e=ce=>{const{type:Se,el:je,anchor:tt,transition:et}=ce;if(Se===Ut){Me(je,tt);return}if(Se===zI){D(ce);return}const Ge=()=>{l(je),et&&!et.persisted&&et.afterLeave&&et.afterLeave()};if(ce.shapeFlag&1&&et&&!et.persisted){const{leave:Xe,delayLeave:Ye}=et,ct=()=>Xe(je,Ge);Ye?Ye(ce.el,Ge,ct):ct()}else Ge()},Me=(ce,Se)=>{let je;for(;ce!==Se;)je=C(ce),l(ce),ce=je;l(Se)},Fe=(ce,Se,je)=>{const{bum:tt,scope:et,job:Ge,subTree:Xe,um:Ye,m:ct,a:nt}=ce;u6(ct),u6(nt),tt&&Fb(tt),et.stop(),Ge&&(Ge.flags|=8,Ae(Xe,ce,Se,je)),Ye&&ui(Ye,Se),ui(()=>{ce.isUnmounted=!0},Se),Se&&Se.pendingBranch&&!Se.isUnmounted&&ce.asyncDep&&!ce.asyncResolved&&ce.suspenseId===Se.pendingId&&(Se.deps--,Se.deps===0&&Se.resolve())},Le=(ce,Se,je,tt=!1,et=!1,Ge=0)=>{for(let Xe=Ge;Xe<ce.length;Xe++)Ae(ce[Xe],Se,je,tt,et)},Pe=ce=>{if(ce.shapeFlag&6)return Pe(ce.component.subTree);if(ce.shapeFlag&128)return ce.suspense.next();const Se=C(ce.anchor||ce.el),je=Se&&Se[f5];return je?C(je):Se};let He=!1;const We=(ce,Se,je)=>{ce==null?Se._vnode&&Ae(Se._vnode,null,null,!0):R(Se._vnode||null,ce,Se,null,null,null,je),Se._vnode=ce,He||(He=!0,Qj(),u5(),He=!1)},yt={p:R,um:Ae,m:be,r:_e,mt:Ee,mc:z,pc:se,pbc:Y,n:Pe,o:t};return{render:We,hydrate:void 0,createApp:hhe(We)}}function GI({type:t,props:o},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&o&&o.encoding&&o.encoding.includes("html")?void 0:s}function dh({effect:t,job:o},s){s?(t.flags|=32,o.flags|=4):(t.flags&=-33,o.flags&=-5)}function bhe(t,o){return(!t||t&&!t.pendingBranch)&&o&&!o.persisted}function bN(t,o,s=!1){const a=t.children,l=o.children;if(st(a)&&st(l))for(let d=0;d<a.length;d++){const h=a[d];let v=l[d];v.shapeFlag&1&&!v.dynamicChildren&&((v.patchFlag<=0||v.patchFlag===32)&&(v=l[d]=Qu(l[d]),v.el=h.el),!s&&v.patchFlag!==-2&&bN(h,v)),v.type===cm&&(v.el=h.el)}}function She(t){const o=t.slice(),s=[0];let a,l,d,h,v;const g=t.length;for(a=0;a<g;a++){const E=t[a];if(E!==0){if(l=s[s.length-1],t[l]<E){o[a]=l,s.push(a);continue}for(d=0,h=s.length-1;d<h;)v=d+h>>1,t[s[v]]<E?d=v+1:h=v;E<t[s[d]]&&(d>0&&(o[a]=s[d-1]),s[d]=a)}}for(d=s.length,h=s[d-1];d-- >0;)s[d]=h,h=o[h];return s}function j5(t){const o=t.subTree.component;if(o)return o.asyncDep&&!o.asyncResolved?o:j5(o)}function u6(t){if(t)for(let o=0;o<t.length;o++)t[o].flags|=8}const The=Symbol.for("v-scx"),Che=()=>It(The);function Ms(t,o){return SN(t,null,o)}function ze(t,o,s){return SN(t,o,s)}function SN(t,o,s=po){const{immediate:a,deep:l,flush:d,once:h}=s,v=us({},s),g=o&&a||!o&&d!=="post";let E;if(Ng){if(d==="sync"){const w=Che();E=w.__watcherHandles||(w.__watcherHandles=[])}else if(!g){const w=()=>{};return w.stop=pr,w.resume=pr,w.pause=pr,w}}const b=Ls;v.call=(w,I,R)=>bc(w,b,I,R);let S=!1;d==="post"?v.scheduler=w=>{ui(w,b&&b.suspense)}:d!=="sync"&&(S=!0,v.scheduler=(w,I)=>{I?w():mN(w)}),v.augmentJob=w=>{o&&(w.flags|=4),S&&(w.flags|=2,b&&(w.id=b.uid,w.i=b))};const C=Wde(t,o,v);return Ng&&(E?E.push(C):g&&C()),C}function whe(t,o,s){const a=this.proxy,l=Mt(t)?t.includes(".")?$5(a,t):()=>a[t]:t.bind(a,a);let d;Ft(o)?d=o:(d=o.handler,s=o);const h=n_(this),v=SN(l,d.bind(a),s);return h(),v}function $5(t,o){const s=o.split(".");return()=>{let a=t;for(let l=0;l<s.length&&a;l++)a=a[s[l]];return a}}const Rhe=(t,o)=>o==="modelValue"||o==="model-value"?t.modelModifiers:t[`${o}Modifiers`]||t[`${gi(o)}Modifiers`]||t[`${ou(o)}Modifiers`];function Ihe(t,o,...s){if(t.isUnmounted)return;const a=t.vnode.props||po;let l=s;const d=o.startsWith("update:"),h=d&&Rhe(a,o.slice(7));h&&(h.trim&&(l=s.map(b=>Mt(b)?b.trim():b)),h.number&&(l=s.map(OA)));let v,g=a[v=cg(o)]||a[v=cg(gi(o))];!g&&d&&(g=a[v=cg(ou(o))]),g&&bc(g,t,6,l);const E=a[v+"Once"];if(E){if(!t.emitted)t.emitted={};else if(t.emitted[v])return;t.emitted[v]=!0,bc(E,t,6,l)}}function H5(t,o,s=!1){const a=o.emitsCache,l=a.get(t);if(l!==void 0)return l;const d=t.emits;let h={},v=!1;if(!Ft(t)){const g=E=>{const b=H5(E,o,!0);b&&(v=!0,us(h,b))};!s&&o.mixins.length&&o.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}return!d&&!v?(fn(t)&&a.set(t,null),null):(st(d)?d.forEach(g=>h[g]=null):us(h,d),fn(t)&&a.set(t,h),h)}function n0(t,o){return!t||!KS(o)?!1:(o=o.slice(2).replace(/Once$/,""),zn(t,o[0].toLowerCase()+o.slice(1))||zn(t,ou(o))||zn(t,o))}function d6(t){const{type:o,vnode:s,proxy:a,withProxy:l,propsOptions:[d],slots:h,attrs:v,emit:g,render:E,renderCache:b,props:S,data:C,setupState:w,ctx:I,inheritAttrs:R}=t,N=dS(t);let O,V;try{if(s.shapeFlag&4){const D=l||a,M=D;O=sl(E.call(M,D,b,S,w,C,I)),V=v}else{const D=o;O=sl(D.length>1?D(S,{attrs:v,slots:h,emit:g}):D(S,null)),V=o.props?v:Ahe(v)}}catch(D){fg.length=0,JS(D,t,1),O=ge(is)}let L=O;if(V&&R!==!1){const D=Object.keys(V),{shapeFlag:M}=L;D.length&&M&7&&(d&&D.some(iN)&&(V=Ohe(V,d)),L=eu(L,V,!1,!0))}return s.dirs&&(L=eu(L,null,!1,!0),L.dirs=L.dirs?L.dirs.concat(s.dirs):s.dirs),s.transition&&Dh(L,s.transition),O=L,dS(N),O}const Ahe=t=>{let o;for(const s in t)(s==="class"||s==="style"||KS(s))&&((o||(o={}))[s]=t[s]);return o},Ohe=(t,o)=>{const s={};for(const a in t)(!iN(a)||!(a.slice(9)in o))&&(s[a]=t[a]);return s};function Nhe(t,o,s){const{props:a,children:l,component:d}=t,{props:h,children:v,patchFlag:g}=o,E=d.emitsOptions;if(o.dirs||o.transition)return!0;if(s&&g>=0){if(g&1024)return!0;if(g&16)return a?h6(a,h,E):!!h;if(g&8){const b=o.dynamicProps;for(let S=0;S<b.length;S++){const C=b[S];if(h[C]!==a[C]&&!n0(E,C))return!0}}}else return(l||v)&&(!v||!v.$stable)?!0:a===h?!1:a?h?h6(a,h,E):!0:!!h;return!1}function h6(t,o,s){const a=Object.keys(o);if(a.length!==Object.keys(t).length)return!0;for(let l=0;l<a.length;l++){const d=a[l];if(o[d]!==t[d]&&!n0(s,d))return!0}return!1}function khe({vnode:t,parent:o},s){for(;o;){const a=o.subTree;if(a.suspense&&a.suspense.activeBranch===t&&(a.el=t.el),a===t)(t=o.vnode).el=s,o=o.parent;else break}}const W5=t=>t.__isSuspense;function Phe(t,o){o&&o.pendingBranch?st(t)?o.effects.push(...t):o.effects.push(t):zde(t)}const Ut=Symbol.for("v-fgt"),cm=Symbol.for("v-txt"),is=Symbol.for("v-cmt"),zI=Symbol.for("v-stc"),fg=[];let ia=null;function $(t=!1){fg.push(ia=t?null:[])}function Dhe(){fg.pop(),ia=fg[fg.length-1]||null}let Og=1;function f6(t,o=!1){Og+=t,t<0&&ia&&o&&(ia.hasOnce=!0)}function K5(t){return t.dynamicChildren=Og>0?ia||Ap:null,Dhe(),Og>0&&ia&&ia.push(t),t}function le(t,o,s,a,l,d){return K5(ue(t,o,s,a,l,d,!0))}function Ve(t,o,s,a,l){return K5(ge(t,o,s,a,l,!0))}function Kr(t){return t?t.__v_isVNode===!0:!1}function gh(t,o){return t.type===o.type&&t.key===o.key}const G5=({key:t})=>t??null,jb=({ref:t,ref_key:o,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?Mt(t)||xr(t)||Ft(t)?{i:Ss,r:t,k:o,f:!!s}:t:null);function ue(t,o=null,s=null,a=0,l=null,d=t===Ut?0:1,h=!1,v=!1){const g={__v_isVNode:!0,__v_skip:!0,type:t,props:o,key:o&&G5(o),ref:o&&jb(o),scopeId:h5,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:a,dynamicProps:l,dynamicChildren:null,appContext:null,ctx:Ss};return v?(TN(g,s),d&128&&t.normalize(g)):s&&(g.shapeFlag|=Mt(s)?8:16),Og>0&&!h&&ia&&(g.patchFlag>0||d&6)&&g.patchFlag!==32&&ia.push(g),g}const ge=Lhe;function Lhe(t,o=null,s=null,a=0,l=null,d=!1){if((!t||t===R5)&&(t=is),Kr(t)){const v=eu(t,o,!0);return s&&TN(v,s),Og>0&&!d&&ia&&(v.shapeFlag&6?ia[ia.indexOf(t)]=v:ia.push(v)),v.patchFlag=-2,v}if($he(t)&&(t=t.__vccOpts),o){o=ul(o);let{class:v,style:g}=o;v&&!Mt(v)&&(o.class=K(v)),fn(g)&&(pN(g)&&!st(g)&&(g=us({},g)),o.style=jt(g))}const h=Mt(t)?1:W5(t)?128:p5(t)?64:fn(t)?4:Ft(t)?2:0;return ue(t,o,s,a,l,h,d,!0)}function ul(t){return t?pN(t)||L5(t)?us({},t):t:null}function eu(t,o,s=!1,a=!1){const{props:l,ref:d,patchFlag:h,children:v,transition:g}=t,E=o?En(l||{},o):l,b={__v_isVNode:!0,__v_skip:!0,type:t.type,props:E,key:E&&G5(E),ref:o&&o.ref?s&&d?st(d)?d.concat(jb(o)):[d,jb(o)]:jb(o):d,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:v,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:o&&t.type!==Ut?h===-1?16:h|16:h,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:g,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&eu(t.ssContent),ssFallback:t.ssFallback&&eu(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return g&&a&&Dh(b,g.clone(b)),b}function bn(t=" ",o=0){return ge(cm,null,t,o)}function De(t="",o=!1){return o?($(),Ve(is,null,t)):ge(is,null,t)}function sl(t){return t==null||typeof t=="boolean"?ge(is):st(t)?ge(Ut,null,t.slice()):Kr(t)?Qu(t):ge(cm,null,String(t))}function Qu(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:eu(t)}function TN(t,o){let s=0;const{shapeFlag:a}=t;if(o==null)o=null;else if(st(o))s=16;else if(typeof o=="object")if(a&65){const l=o.default;l&&(l._c&&(l._d=!1),TN(t,l()),l._c&&(l._d=!0));return}else{s=32;const l=o._;!l&&!L5(o)?o._ctx=Ss:l===3&&Ss&&(Ss.slots._===1?o._=1:(o._=2,t.patchFlag|=1024))}else Ft(o)?(o={default:o,_ctx:Ss},s=32):(o=String(o),a&64?(s=16,o=[bn(o)]):s=8);t.children=o,t.shapeFlag|=s}function En(...t){const o={};for(let s=0;s<t.length;s++){const a=t[s];for(const l in a)if(l==="class")o.class!==a.class&&(o.class=K([o.class,a.class]));else if(l==="style")o.style=jt([o.style,a.style]);else if(KS(l)){const d=o[l],h=a[l];h&&d!==h&&!(st(d)&&d.includes(h))&&(o[l]=d?[].concat(d,h):h)}else l!==""&&(o[l]=a[l])}return o}function tl(t,o,s,a=null){bc(t,o,7,[s,a])}const Mhe=k5();let xhe=0;function Uhe(t,o,s){const a=t.type,l=(o?o.appContext:t.appContext)||Mhe,d={uid:xhe++,vnode:t,type:a,parent:o,appContext:l,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new j8(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:o?o.provides:Object.create(l.provides),ids:o?o.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:x5(a,l),emitsOptions:H5(a,l),emit:null,emitted:null,propsDefaults:po,inheritAttrs:a.inheritAttrs,ctx:po,data:po,props:po,attrs:po,slots:po,refs:po,setupState:po,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=o?o.root:d,d.emit=Ihe.bind(null,d),t.ce&&t.ce(d),d}let Ls=null;const mn=()=>Ls||Ss;let pS,FA;{const t=YS(),o=(s,a)=>{let l;return(l=t[s])||(l=t[s]=[]),l.push(a),d=>{l.length>1?l.forEach(h=>h(d)):l[0](d)}};pS=o("__VUE_INSTANCE_SETTERS__",s=>Ls=s),FA=o("__VUE_SSR_SETTERS__",s=>Ng=s)}const n_=t=>{const o=Ls;return pS(t),t.scope.on(),()=>{t.scope.off(),pS(o)}},p6=()=>{Ls&&Ls.scope.off(),pS(null)};function z5(t){return t.vnode.shapeFlag&4}let Ng=!1;function Vhe(t,o=!1,s=!1){o&&FA(o);const{props:a,children:l}=t.vnode,d=z5(t);fhe(t,a,d,o),ghe(t,l,s);const h=d?Fhe(t,o):void 0;return o&&FA(!1),h}function Fhe(t,o){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,she);const{setup:a}=s;if(a){md();const l=t.setupContext=a.length>1?q5(t):null,d=n_(t),h=t_(a,t,0,[t.props,l]),v=Tg(h);if(vd(),d(),(v||t.sp)&&!Pp(t)&&S5(t),v){if(h.then(p6,p6),o)return h.then(g=>{m6(t,g)}).catch(g=>{JS(g,t,0)});t.asyncDep=h}else m6(t,h)}else Y5(t)}function m6(t,o,s){Ft(o)?t.type.__ssrInlineRender?t.ssrRender=o:t.render=o:fn(o)&&(t.setupState=i5(o)),Y5(t)}function Y5(t,o,s){const a=t.type;t.render||(t.render=a.render||pr);{const l=n_(t);md();try{ihe(t)}finally{vd(),l()}}}const Bhe={get(t,o){return qs(t,"get",""),t[o]}};function q5(t){const o=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,Bhe),slots:t.slots,emit:t.emit,expose:o}}function r0(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(i5(Zl(t.exposed)),{get(o,s){if(s in o)return o[s];if(s in hg)return hg[s](t)},has(o,s){return s in o||s in hg}})):t.proxy}function jhe(t,o=!0){return Ft(t)?t.displayName||t.name:t.name||o&&t.__name}function $he(t){return Ft(t)&&"__vccOpts"in t}const U=(t,o)=>$de(t,o,Ng);function Ht(t,o,s){const a=arguments.length;return a===2?fn(o)&&!st(o)?Kr(o)?ge(t,null,[o]):ge(t,o):ge(t,null,o):(a>3?s=Array.prototype.slice.call(arguments,2):a===3&&Kr(s)&&(s=[s]),ge(t,o,s))}const Hhe="3.5.13",Whe=pr;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let BA;const v6=typeof window<"u"&&window.trustedTypes;if(v6)try{BA=v6.createPolicy("vue",{createHTML:t=>t})}catch{}const X5=BA?t=>BA.createHTML(t):t=>t,Khe="http://www.w3.org/2000/svg",Ghe="http://www.w3.org/1998/Math/MathML",Wl=typeof document<"u"?document:null,g6=Wl&&Wl.createElement("template"),zhe={insert:(t,o,s)=>{o.insertBefore(t,s||null)},remove:t=>{const o=t.parentNode;o&&o.removeChild(t)},createElement:(t,o,s,a)=>{const l=o==="svg"?Wl.createElementNS(Khe,t):o==="mathml"?Wl.createElementNS(Ghe,t):s?Wl.createElement(t,{is:s}):Wl.createElement(t);return t==="select"&&a&&a.multiple!=null&&l.setAttribute("multiple",a.multiple),l},createText:t=>Wl.createTextNode(t),createComment:t=>Wl.createComment(t),setText:(t,o)=>{t.nodeValue=o},setElementText:(t,o)=>{t.textContent=o},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Wl.querySelector(t),setScopeId(t,o){t.setAttribute(o,"")},insertStaticContent(t,o,s,a,l,d){const h=s?s.previousSibling:o.lastChild;if(l&&(l===d||l.nextSibling))for(;o.insertBefore(l.cloneNode(!0),s),!(l===d||!(l=l.nextSibling)););else{g6.innerHTML=X5(a==="svg"?`<svg>${t}</svg>`:a==="mathml"?`<math>${t}</math>`:t);const v=g6.content;if(a==="svg"||a==="mathml"){const g=v.firstChild;for(;g.firstChild;)v.appendChild(g.firstChild);v.removeChild(g)}o.insertBefore(v,s)}return[h?h.nextSibling:o.firstChild,s?s.previousSibling:o.lastChild]}},Gu="transition",Yv="animation",jp=Symbol("_vtc"),J5={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Z5=us({},_5,J5),Yhe=t=>(t.displayName="Transition",t.props=Z5,t),hs=Yhe((t,{slots:o})=>Ht(Jde,Q5(t),o)),hh=(t,o=[])=>{st(t)?t.forEach(s=>s(...o)):t&&t(...o)},_6=t=>t?st(t)?t.some(o=>o.length>1):t.length>1:!1;function Q5(t){const o={};for(const Z in t)Z in J5||(o[Z]=t[Z]);if(t.css===!1)return o;const{name:s="v",type:a,duration:l,enterFromClass:d=`${s}-enter-from`,enterActiveClass:h=`${s}-enter-active`,enterToClass:v=`${s}-enter-to`,appearFromClass:g=d,appearActiveClass:E=h,appearToClass:b=v,leaveFromClass:S=`${s}-leave-from`,leaveActiveClass:C=`${s}-leave-active`,leaveToClass:w=`${s}-leave-to`}=t,I=qhe(l),R=I&&I[0],N=I&&I[1],{onBeforeEnter:O,onEnter:V,onEnterCancelled:L,onLeave:D,onLeaveCancelled:M,onBeforeAppear:F=O,onAppear:W=V,onAppearCancelled:z=L}=o,G=(Z,fe,Ee,ae)=>{Z._enterCancelled=ae,Yu(Z,fe?b:v),Yu(Z,fe?E:h),Ee&&Ee()},Y=(Z,fe)=>{Z._isLeaving=!1,Yu(Z,S),Yu(Z,w),Yu(Z,C),fe&&fe()},te=Z=>(fe,Ee)=>{const ae=Z?W:V,X=()=>G(fe,Z,Ee);hh(ae,[fe,X]),E6(()=>{Yu(fe,Z?g:d),rl(fe,Z?b:v),_6(ae)||y6(fe,a,R,X)})};return us(o,{onBeforeEnter(Z){hh(O,[Z]),rl(Z,d),rl(Z,h)},onBeforeAppear(Z){hh(F,[Z]),rl(Z,g),rl(Z,E)},onEnter:te(!1),onAppear:te(!0),onLeave(Z,fe){Z._isLeaving=!0;const Ee=()=>Y(Z,fe);rl(Z,S),Z._enterCancelled?(rl(Z,C),jA()):(jA(),rl(Z,C)),E6(()=>{Z._isLeaving&&(Yu(Z,S),rl(Z,w),_6(D)||y6(Z,a,N,Ee))}),hh(D,[Z,Ee])},onEnterCancelled(Z){G(Z,!1,void 0,!0),hh(L,[Z])},onAppearCancelled(Z){G(Z,!0,void 0,!0),hh(z,[Z])},onLeaveCancelled(Z){Y(Z),hh(M,[Z])}})}function qhe(t){if(t==null)return null;if(fn(t))return[YI(t.enter),YI(t.leave)];{const o=YI(t);return[o,o]}}function YI(t){return ade(t)}function rl(t,o){o.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[jp]||(t[jp]=new Set)).add(o)}function Yu(t,o){o.split(/\s+/).forEach(a=>a&&t.classList.remove(a));const s=t[jp];s&&(s.delete(o),s.size||(t[jp]=void 0))}function E6(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Xhe=0;function y6(t,o,s,a){const l=t._endId=++Xhe,d=()=>{l===t._endId&&a()};if(s!=null)return setTimeout(d,s);const{type:h,timeout:v,propCount:g}=eW(t,o);if(!h)return a();const E=h+"end";let b=0;const S=()=>{t.removeEventListener(E,C),d()},C=w=>{w.target===t&&++b>=g&&S()};setTimeout(()=>{b<g&&S()},v+1),t.addEventListener(E,C)}function eW(t,o){const s=window.getComputedStyle(t),a=I=>(s[I]||"").split(", "),l=a(`${Gu}Delay`),d=a(`${Gu}Duration`),h=b6(l,d),v=a(`${Yv}Delay`),g=a(`${Yv}Duration`),E=b6(v,g);let b=null,S=0,C=0;o===Gu?h>0&&(b=Gu,S=h,C=d.length):o===Yv?E>0&&(b=Yv,S=E,C=g.length):(S=Math.max(h,E),b=S>0?h>E?Gu:Yv:null,C=b?b===Gu?d.length:g.length:0);const w=b===Gu&&/\b(transform|all)(,|$)/.test(a(`${Gu}Property`).toString());return{type:b,timeout:S,propCount:C,hasTransform:w}}function b6(t,o){for(;t.length<o.length;)t=t.concat(t);return Math.max(...o.map((s,a)=>S6(s)+S6(t[a])))}function S6(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function jA(){return document.body.offsetHeight}function Jhe(t,o,s){const a=t[jp];a&&(o=(o?[o,...a]:[...a]).join(" ")),o==null?t.removeAttribute("class"):s?t.setAttribute("class",o):t.className=o}const mS=Symbol("_vod"),tW=Symbol("_vsh"),Wn={beforeMount(t,{value:o},{transition:s}){t[mS]=t.style.display==="none"?"":t.style.display,s&&o?s.beforeEnter(t):qv(t,o)},mounted(t,{value:o},{transition:s}){s&&o&&s.enter(t)},updated(t,{value:o,oldValue:s},{transition:a}){!o!=!s&&(a?o?(a.beforeEnter(t),qv(t,!0),a.enter(t)):a.leave(t,()=>{qv(t,!1)}):qv(t,o))},beforeUnmount(t,{value:o}){qv(t,o)}};function qv(t,o){t.style.display=o?t[mS]:"none",t[tW]=!o}const Zhe=Symbol(""),Qhe=/(^|;)\s*display\s*:/;function efe(t,o,s){const a=t.style,l=Mt(s);let d=!1;if(s&&!l){if(o)if(Mt(o))for(const h of o.split(";")){const v=h.slice(0,h.indexOf(":")).trim();s[v]==null&&$b(a,v,"")}else for(const h in o)s[h]==null&&$b(a,h,"");for(const h in s)h==="display"&&(d=!0),$b(a,h,s[h])}else if(l){if(o!==s){const h=a[Zhe];h&&(s+=";"+h),a.cssText=s,d=Qhe.test(s)}}else o&&t.removeAttribute("style");mS in t&&(t[mS]=d?a.display:"",t[tW]&&(a.display="none"))}const T6=/\s*!important$/;function $b(t,o,s){if(st(s))s.forEach(a=>$b(t,o,a));else if(s==null&&(s=""),o.startsWith("--"))t.setProperty(o,s);else{const a=tfe(t,o);T6.test(s)?t.setProperty(ou(a),s.replace(T6,""),"important"):t[a]=s}}const C6=["Webkit","Moz","ms"],qI={};function tfe(t,o){const s=qI[o];if(s)return s;let a=gi(o);if(a!=="filter"&&a in t)return qI[o]=a;a=e_(a);for(let l=0;l<C6.length;l++){const d=C6[l]+a;if(d in t)return qI[o]=d}return o}const w6="http://www.w3.org/1999/xlink";function R6(t,o,s,a,l,d=fde(o)){a&&o.startsWith("xlink:")?s==null?t.removeAttributeNS(w6,o.slice(6,o.length)):t.setAttributeNS(w6,o,s):s==null||d&&!U8(s)?t.removeAttribute(o):t.setAttribute(o,d?"":yc(s)?String(s):s)}function I6(t,o,s,a,l){if(o==="innerHTML"||o==="textContent"){s!=null&&(t[o]=o==="innerHTML"?X5(s):s);return}const d=t.tagName;if(o==="value"&&d!=="PROGRESS"&&!d.includes("-")){const v=d==="OPTION"?t.getAttribute("value")||"":t.value,g=s==null?t.type==="checkbox"?"on":"":String(s);(v!==g||!("_value"in t))&&(t.value=g),s==null&&t.removeAttribute(o),t._value=s;return}let h=!1;if(s===""||s==null){const v=typeof t[o];v==="boolean"?s=U8(s):s==null&&v==="string"?(s="",h=!0):v==="number"&&(s=0,h=!0)}try{t[o]=s}catch{}h&&t.removeAttribute(l||o)}function ed(t,o,s,a){t.addEventListener(o,s,a)}function nfe(t,o,s,a){t.removeEventListener(o,s,a)}const A6=Symbol("_vei");function rfe(t,o,s,a,l=null){const d=t[A6]||(t[A6]={}),h=d[o];if(a&&h)h.value=a;else{const[v,g]=ofe(o);if(a){const E=d[o]=afe(a,l);ed(t,v,E,g)}else h&&(nfe(t,v,h,g),d[o]=void 0)}}const O6=/(?:Once|Passive|Capture)$/;function ofe(t){let o;if(O6.test(t)){o={};let a;for(;a=t.match(O6);)t=t.slice(0,t.length-a[0].length),o[a[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ou(t.slice(2)),o]}let XI=0;const sfe=Promise.resolve(),ife=()=>XI||(sfe.then(()=>XI=0),XI=Date.now());function afe(t,o){const s=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=s.attached)return;bc(cfe(a,s.value),o,5,[a])};return s.value=t,s.attached=ife(),s}function cfe(t,o){if(st(o)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},o.map(a=>l=>!l._stopped&&a&&a(l))}else return o}const N6=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,lfe=(t,o,s,a,l,d)=>{const h=l==="svg";o==="class"?Jhe(t,a,h):o==="style"?efe(t,s,a):KS(o)?iN(o)||rfe(t,o,s,a,d):(o[0]==="."?(o=o.slice(1),!0):o[0]==="^"?(o=o.slice(1),!1):ufe(t,o,a,h))?(I6(t,o,a),!t.tagName.includes("-")&&(o==="value"||o==="checked"||o==="selected")&&R6(t,o,a,h,d,o!=="value")):t._isVueCE&&(/[A-Z]/.test(o)||!Mt(a))?I6(t,gi(o),a,d,o):(o==="true-value"?t._trueValue=a:o==="false-value"&&(t._falseValue=a),R6(t,o,a,h))};function ufe(t,o,s,a){if(a)return!!(o==="innerHTML"||o==="textContent"||o in t&&N6(o)&&Ft(s));if(o==="spellcheck"||o==="draggable"||o==="translate"||o==="form"||o==="list"&&t.tagName==="INPUT"||o==="type"&&t.tagName==="TEXTAREA")return!1;if(o==="width"||o==="height"){const l=t.tagName;if(l==="IMG"||l==="VIDEO"||l==="CANVAS"||l==="SOURCE")return!1}return N6(o)&&Mt(s)?!1:o in t}const nW=new WeakMap,rW=new WeakMap,vS=Symbol("_moveCb"),k6=Symbol("_enterCb"),dfe=t=>(delete t.props.mode,t),hfe=dfe({name:"TransitionGroup",props:us({},Z5,{tag:String,moveClass:String}),setup(t,{slots:o}){const s=mn(),a=g5();let l,d;return wc(()=>{if(!l.length)return;const h=t.moveClass||`${t.name||"v"}-move`;if(!vfe(l[0].el,s.vnode.el,h))return;l.forEach(ffe),l.forEach(pfe);const v=l.filter(mfe);jA(),v.forEach(g=>{const E=g.el,b=E.style;rl(E,h),b.transform=b.webkitTransform=b.transitionDuration="";const S=E[vS]=C=>{C&&C.target!==E||(!C||/transform$/.test(C.propertyName))&&(E.removeEventListener("transitionend",S),E[vS]=null,Yu(E,h))};E.addEventListener("transitionend",S)})}),()=>{const h=Tr(t),v=Q5(h);let g=h.tag||Ut;if(l=[],d)for(let E=0;E<d.length;E++){const b=d[E];b.el&&b.el instanceof Element&&(l.push(b),Dh(b,Ag(b,v,a,s)),nW.set(b,b.el.getBoundingClientRect()))}d=o.default?vN(o.default()):[];for(let E=0;E<d.length;E++){const b=d[E];b.key!=null&&Dh(b,Ag(b,v,a,s))}return ge(g,null,d)}}}),oW=hfe;function ffe(t){const o=t.el;o[vS]&&o[vS](),o[k6]&&o[k6]()}function pfe(t){rW.set(t,t.el.getBoundingClientRect())}function mfe(t){const o=nW.get(t),s=rW.get(t),a=o.left-s.left,l=o.top-s.top;if(a||l){const d=t.el.style;return d.transform=d.webkitTransform=`translate(${a}px,${l}px)`,d.transitionDuration="0s",t}}function vfe(t,o,s){const a=t.cloneNode(),l=t[jp];l&&l.forEach(v=>{v.split(/\s+/).forEach(g=>g&&a.classList.remove(g))}),s.split(/\s+/).forEach(v=>v&&a.classList.add(v)),a.style.display="none";const d=o.nodeType===1?o:o.parentNode;d.appendChild(a);const{hasTransform:h}=eW(a);return d.removeChild(a),h}const $p=t=>{const o=t.props["onUpdate:modelValue"]||!1;return st(o)?s=>Fb(o,s):o};function gfe(t){t.target.composing=!0}function P6(t){const o=t.target;o.composing&&(o.composing=!1,o.dispatchEvent(new Event("input")))}const Ql=Symbol("_assign"),o0={created(t,{modifiers:{lazy:o,trim:s,number:a}},l){t[Ql]=$p(l);const d=a||l.props&&l.props.type==="number";ed(t,o?"change":"input",h=>{if(h.target.composing)return;let v=t.value;s&&(v=v.trim()),d&&(v=OA(v)),t[Ql](v)}),s&&ed(t,"change",()=>{t.value=t.value.trim()}),o||(ed(t,"compositionstart",gfe),ed(t,"compositionend",P6),ed(t,"change",P6))},mounted(t,{value:o}){t.value=o??""},beforeUpdate(t,{value:o,oldValue:s,modifiers:{lazy:a,trim:l,number:d}},h){if(t[Ql]=$p(h),t.composing)return;const v=(d||t.type==="number")&&!/^0\d/.test(t.value)?OA(t.value):t.value,g=o??"";v!==g&&(document.activeElement===t&&t.type!=="range"&&(a&&o===s||l&&t.value.trim()===g)||(t.value=g))}},gS={deep:!0,created(t,o,s){t[Ql]=$p(s),ed(t,"change",()=>{const a=t._modelValue,l=iW(t),d=t.checked,h=t[Ql];if(st(a)){const v=V8(a,l),g=v!==-1;if(d&&!g)h(a.concat(l));else if(!d&&g){const E=[...a];E.splice(v,1),h(E)}}else if(GS(a)){const v=new Set(a);d?v.add(l):v.delete(l),h(v)}else h(aW(t,d))})},mounted:D6,beforeUpdate(t,o,s){t[Ql]=$p(s),D6(t,o,s)}};function D6(t,{value:o,oldValue:s},a){t._modelValue=o;let l;if(st(o))l=V8(o,a.props.value)>-1;else if(GS(o))l=o.has(a.props.value);else{if(o===s)return;l=Bp(o,aW(t,!0))}t.checked!==l&&(t.checked=l)}const sW={created(t,{value:o},s){t.checked=Bp(o,s.props.value),t[Ql]=$p(s),ed(t,"change",()=>{t[Ql](iW(t))})},beforeUpdate(t,{value:o,oldValue:s},a){t[Ql]=$p(a),o!==s&&(t.checked=Bp(o,a.props.value))}};function iW(t){return"_value"in t?t._value:t.value}function aW(t,o){const s=o?"_trueValue":"_falseValue";return s in t?t[s]:o}const _fe=["ctrl","shift","alt","meta"],Efe={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,o)=>_fe.some(s=>t[`${s}Key`]&&!o.includes(s))},Gt=(t,o)=>{const s=t._withMods||(t._withMods={}),a=o.join(".");return s[a]||(s[a]=(l,...d)=>{for(let h=0;h<o.length;h++){const v=Efe[o[h]];if(v&&v(l,o))return}return t(l,...d)})},yfe={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Cr=(t,o)=>{const s=t._withKeys||(t._withKeys={}),a=o.join(".");return s[a]||(s[a]=l=>{if(!("key"in l))return;const d=ou(l.key);if(o.some(h=>h===d||yfe[h]===d))return t(l)})},bfe=us({patchProp:lfe},zhe);let L6;function cW(){return L6||(L6=Ehe(bfe))}const ad=(...t)=>{cW().render(...t)},lW=(...t)=>{const o=cW().createApp(...t),{mount:s}=o;return o.mount=a=>{const l=Tfe(a);if(!l)return;const d=o._component;!Ft(d)&&!d.render&&!d.template&&(d.template=l.innerHTML),l.nodeType===1&&(l.textContent="");const h=s(l,!1,Sfe(l));return l instanceof Element&&(l.removeAttribute("v-cloak"),l.setAttribute("data-v-app","")),h},o};function Sfe(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Tfe(t){return Mt(t)?document.querySelector(t):t}const Cfe="2.9.7",M6=Symbol("INSTALLED_KEY"),uW=Symbol(),pg="el",wfe="is-",fh=(t,o,s,a,l)=>{let d=`${t}-${o}`;return s&&(d+=`-${s}`),a&&(d+=`__${a}`),l&&(d+=`--${l}`),d},dW=Symbol("namespaceContextKey"),CN=t=>{const o=t||(mn()?It(dW,ee(pg)):ee(pg));return U(()=>p(o)||pg)},Qe=(t,o)=>{const s=CN(o);return{namespace:s,b:(R="")=>fh(s.value,t,R,"",""),e:R=>R?fh(s.value,t,"",R,""):"",m:R=>R?fh(s.value,t,"","",R):"",be:(R,N)=>R&&N?fh(s.value,t,R,N,""):"",em:(R,N)=>R&&N?fh(s.value,t,"",R,N):"",bm:(R,N)=>R&&N?fh(s.value,t,R,"",N):"",bem:(R,N,O)=>R&&N&&O?fh(s.value,t,R,N,O):"",is:(R,...N)=>{const O=N.length>=1?N[0]:!0;return R&&O?`${wfe}${R}`:""},cssVar:R=>{const N={};for(const O in R)R[O]&&(N[`--${s.value}-${O}`]=R[O]);return N},cssVarName:R=>`--${s.value}-${R}`,cssVarBlock:R=>{const N={};for(const O in R)R[O]&&(N[`--${s.value}-${t}-${O}`]=R[O]);return N},cssVarBlockName:R=>`--${s.value}-${t}-${R}`}};var hW=typeof global=="object"&&global&&global.Object===Object&&global,Rfe=typeof self=="object"&&self&&self.Object===Object&&self,Rc=hW||Rfe||Function("return this")(),ja=Rc.Symbol,fW=Object.prototype,Ife=fW.hasOwnProperty,Afe=fW.toString,Xv=ja?ja.toStringTag:void 0;function Ofe(t){var o=Ife.call(t,Xv),s=t[Xv];try{t[Xv]=void 0;var a=!0}catch{}var l=Afe.call(t);return a&&(o?t[Xv]=s:delete t[Xv]),l}var Nfe=Object.prototype,kfe=Nfe.toString;function Pfe(t){return kfe.call(t)}var Dfe="[object Null]",Lfe="[object Undefined]",x6=ja?ja.toStringTag:void 0;function $h(t){return t==null?t===void 0?Lfe:Dfe:x6&&x6 in Object(t)?Ofe(t):Pfe(t)}function dl(t){return t!=null&&typeof t=="object"}var Mfe="[object Symbol]";function s0(t){return typeof t=="symbol"||dl(t)&&$h(t)==Mfe}function wN(t,o){for(var s=-1,a=t==null?0:t.length,l=Array(a);++s<a;)l[s]=o(t[s],s,t);return l}var _i=Array.isArray,U6=ja?ja.prototype:void 0,V6=U6?U6.toString:void 0;function pW(t){if(typeof t=="string")return t;if(_i(t))return wN(t,pW)+"";if(s0(t))return V6?V6.call(t):"";var o=t+"";return o=="0"&&1/t==-1/0?"-0":o}var xfe=/\s/;function Ufe(t){for(var o=t.length;o--&&xfe.test(t.charAt(o)););return o}var Vfe=/^\s+/;function Ffe(t){return t&&t.slice(0,Ufe(t)+1).replace(Vfe,"")}function Ei(t){var o=typeof t;return t!=null&&(o=="object"||o=="function")}var F6=NaN,Bfe=/^[-+]0x[0-9a-f]+$/i,jfe=/^0b[01]+$/i,$fe=/^0o[0-7]+$/i,Hfe=parseInt;function B6(t){if(typeof t=="number")return t;if(s0(t))return F6;if(Ei(t)){var o=typeof t.valueOf=="function"?t.valueOf():t;t=Ei(o)?o+"":o}if(typeof t!="string")return t===0?t:+t;t=Ffe(t);var s=jfe.test(t);return s||$fe.test(t)?Hfe(t.slice(2),s?2:8):Bfe.test(t)?F6:+t}function RN(t){return t}var Wfe="[object AsyncFunction]",Kfe="[object Function]",Gfe="[object GeneratorFunction]",zfe="[object Proxy]";function IN(t){if(!Ei(t))return!1;var o=$h(t);return o==Kfe||o==Gfe||o==Wfe||o==zfe}var JI=Rc["__core-js_shared__"],j6=function(){var t=/[^.]+$/.exec(JI&&JI.keys&&JI.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Yfe(t){return!!j6&&j6 in t}var qfe=Function.prototype,Xfe=qfe.toString;function Hh(t){if(t!=null){try{return Xfe.call(t)}catch{}try{return t+""}catch{}}return""}var Jfe=/[\\^$.*+?()[\]{}|]/g,Zfe=/^\[object .+?Constructor\]$/,Qfe=Function.prototype,epe=Object.prototype,tpe=Qfe.toString,npe=epe.hasOwnProperty,rpe=RegExp("^"+tpe.call(npe).replace(Jfe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ope(t){if(!Ei(t)||Yfe(t))return!1;var o=IN(t)?rpe:Zfe;return o.test(Hh(t))}function spe(t,o){return t==null?void 0:t[o]}function Wh(t,o){var s=spe(t,o);return ope(s)?s:void 0}var $A=Wh(Rc,"WeakMap"),$6=Object.create,ipe=function(){function t(){}return function(o){if(!Ei(o))return{};if($6)return $6(o);t.prototype=o;var s=new t;return t.prototype=void 0,s}}();function ape(t,o,s){switch(s.length){case 0:return t.call(o);case 1:return t.call(o,s[0]);case 2:return t.call(o,s[0],s[1]);case 3:return t.call(o,s[0],s[1],s[2])}return t.apply(o,s)}function cpe(){}function mW(t,o){var s=-1,a=t.length;for(o||(o=Array(a));++s<a;)o[s]=t[s];return o}var lpe=800,upe=16,dpe=Date.now;function hpe(t){var o=0,s=0;return function(){var a=dpe(),l=upe-(a-s);if(s=a,l>0){if(++o>=lpe)return arguments[0]}else o=0;return t.apply(void 0,arguments)}}function fpe(t){return function(){return t}}var _S=function(){try{var t=Wh(Object,"defineProperty");return t({},"",{}),t}catch{}}(),ppe=_S?function(t,o){return _S(t,"toString",{configurable:!0,enumerable:!1,value:fpe(o),writable:!0})}:RN,vW=hpe(ppe);function mpe(t,o){for(var s=-1,a=t==null?0:t.length;++s<a&&o(t[s],s,t)!==!1;);return t}function gW(t,o,s,a){for(var l=t.length,d=s+(a?1:-1);a?d--:++d<l;)if(o(t[d],d,t))return d;return-1}function vpe(t){return t!==t}function gpe(t,o,s){for(var a=s-1,l=t.length;++a<l;)if(t[a]===o)return a;return-1}function _pe(t,o,s){return o===o?gpe(t,o,s):gW(t,vpe,s)}function Epe(t,o){var s=t==null?0:t.length;return!!s&&_pe(t,o,0)>-1}var ype=9007199254740991,bpe=/^(?:0|[1-9]\d*)$/;function i0(t,o){var s=typeof t;return o=o??ype,!!o&&(s=="number"||s!="symbol"&&bpe.test(t))&&t>-1&&t%1==0&&t<o}function AN(t,o,s){o=="__proto__"&&_S?_S(t,o,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[o]=s}function r_(t,o){return t===o||t!==t&&o!==o}var Spe=Object.prototype,Tpe=Spe.hasOwnProperty;function ON(t,o,s){var a=t[o];(!(Tpe.call(t,o)&&r_(a,s))||s===void 0&&!(o in t))&&AN(t,o,s)}function lm(t,o,s,a){var l=!s;s||(s={});for(var d=-1,h=o.length;++d<h;){var v=o[d],g=void 0;g===void 0&&(g=t[v]),l?AN(s,v,g):ON(s,v,g)}return s}var H6=Math.max;function _W(t,o,s){return o=H6(o===void 0?t.length-1:o,0),function(){for(var a=arguments,l=-1,d=H6(a.length-o,0),h=Array(d);++l<d;)h[l]=a[o+l];l=-1;for(var v=Array(o+1);++l<o;)v[l]=a[l];return v[o]=s(h),ape(t,this,v)}}function EW(t,o){return vW(_W(t,o,RN),t+"")}var Cpe=9007199254740991;function NN(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Cpe}function um(t){return t!=null&&NN(t.length)&&!IN(t)}function wpe(t,o,s){if(!Ei(s))return!1;var a=typeof o;return(a=="number"?um(s)&&i0(o,s.length):a=="string"&&o in s)?r_(s[o],t):!1}function Rpe(t){return EW(function(o,s){var a=-1,l=s.length,d=l>1?s[l-1]:void 0,h=l>2?s[2]:void 0;for(d=t.length>3&&typeof d=="function"?(l--,d):void 0,h&&wpe(s[0],s[1],h)&&(d=l<3?void 0:d,l=1),o=Object(o);++a<l;){var v=s[a];v&&t(o,v,a,d)}return o})}var Ipe=Object.prototype;function kN(t){var o=t&&t.constructor,s=typeof o=="function"&&o.prototype||Ipe;return t===s}function Ape(t,o){for(var s=-1,a=Array(t);++s<t;)a[s]=o(s);return a}var Ope="[object Arguments]";function W6(t){return dl(t)&&$h(t)==Ope}var yW=Object.prototype,Npe=yW.hasOwnProperty,kpe=yW.propertyIsEnumerable,kg=W6(function(){return arguments}())?W6:function(t){return dl(t)&&Npe.call(t,"callee")&&!kpe.call(t,"callee")};function Ppe(){return!1}var bW=typeof la=="object"&&la&&!la.nodeType&&la,K6=bW&&typeof ua=="object"&&ua&&!ua.nodeType&&ua,Dpe=K6&&K6.exports===bW,G6=Dpe?Rc.Buffer:void 0,Lpe=G6?G6.isBuffer:void 0,Pg=Lpe||Ppe,Mpe="[object Arguments]",xpe="[object Array]",Upe="[object Boolean]",Vpe="[object Date]",Fpe="[object Error]",Bpe="[object Function]",jpe="[object Map]",$pe="[object Number]",Hpe="[object Object]",Wpe="[object RegExp]",Kpe="[object Set]",Gpe="[object String]",zpe="[object WeakMap]",Ype="[object ArrayBuffer]",qpe="[object DataView]",Xpe="[object Float32Array]",Jpe="[object Float64Array]",Zpe="[object Int8Array]",Qpe="[object Int16Array]",eme="[object Int32Array]",tme="[object Uint8Array]",nme="[object Uint8ClampedArray]",rme="[object Uint16Array]",ome="[object Uint32Array]",wo={};wo[Xpe]=wo[Jpe]=wo[Zpe]=wo[Qpe]=wo[eme]=wo[tme]=wo[nme]=wo[rme]=wo[ome]=!0;wo[Mpe]=wo[xpe]=wo[Ype]=wo[Upe]=wo[qpe]=wo[Vpe]=wo[Fpe]=wo[Bpe]=wo[jpe]=wo[$pe]=wo[Hpe]=wo[Wpe]=wo[Kpe]=wo[Gpe]=wo[zpe]=!1;function sme(t){return dl(t)&&NN(t.length)&&!!wo[$h(t)]}function PN(t){return function(o){return t(o)}}var SW=typeof la=="object"&&la&&!la.nodeType&&la,mg=SW&&typeof ua=="object"&&ua&&!ua.nodeType&&ua,ime=mg&&mg.exports===SW,ZI=ime&&hW.process,Hp=function(){try{var t=mg&&mg.require&&mg.require("util").types;return t||ZI&&ZI.binding&&ZI.binding("util")}catch{}}(),z6=Hp&&Hp.isTypedArray,DN=z6?PN(z6):sme,ame=Object.prototype,cme=ame.hasOwnProperty;function TW(t,o){var s=_i(t),a=!s&&kg(t),l=!s&&!a&&Pg(t),d=!s&&!a&&!l&&DN(t),h=s||a||l||d,v=h?Ape(t.length,String):[],g=v.length;for(var E in t)(o||cme.call(t,E))&&!(h&&(E=="length"||l&&(E=="offset"||E=="parent")||d&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||i0(E,g)))&&v.push(E);return v}function CW(t,o){return function(s){return t(o(s))}}var lme=CW(Object.keys,Object),ume=Object.prototype,dme=ume.hasOwnProperty;function hme(t){if(!kN(t))return lme(t);var o=[];for(var s in Object(t))dme.call(t,s)&&s!="constructor"&&o.push(s);return o}function o_(t){return um(t)?TW(t):hme(t)}function fme(t){var o=[];if(t!=null)for(var s in Object(t))o.push(s);return o}var pme=Object.prototype,mme=pme.hasOwnProperty;function vme(t){if(!Ei(t))return fme(t);var o=kN(t),s=[];for(var a in t)a=="constructor"&&(o||!mme.call(t,a))||s.push(a);return s}function s_(t){return um(t)?TW(t,!0):vme(t)}var gme=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_me=/^\w*$/;function LN(t,o){if(_i(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||s0(t)?!0:_me.test(t)||!gme.test(t)||o!=null&&t in Object(o)}var Dg=Wh(Object,"create");function Eme(){this.__data__=Dg?Dg(null):{},this.size=0}function yme(t){var o=this.has(t)&&delete this.__data__[t];return this.size-=o?1:0,o}var bme="__lodash_hash_undefined__",Sme=Object.prototype,Tme=Sme.hasOwnProperty;function Cme(t){var o=this.__data__;if(Dg){var s=o[t];return s===bme?void 0:s}return Tme.call(o,t)?o[t]:void 0}var wme=Object.prototype,Rme=wme.hasOwnProperty;function Ime(t){var o=this.__data__;return Dg?o[t]!==void 0:Rme.call(o,t)}var Ame="__lodash_hash_undefined__";function Ome(t,o){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=Dg&&o===void 0?Ame:o,this}function Lh(t){var o=-1,s=t==null?0:t.length;for(this.clear();++o<s;){var a=t[o];this.set(a[0],a[1])}}Lh.prototype.clear=Eme;Lh.prototype.delete=yme;Lh.prototype.get=Cme;Lh.prototype.has=Ime;Lh.prototype.set=Ome;function Nme(){this.__data__=[],this.size=0}function a0(t,o){for(var s=t.length;s--;)if(r_(t[s][0],o))return s;return-1}var kme=Array.prototype,Pme=kme.splice;function Dme(t){var o=this.__data__,s=a0(o,t);if(s<0)return!1;var a=o.length-1;return s==a?o.pop():Pme.call(o,s,1),--this.size,!0}function Lme(t){var o=this.__data__,s=a0(o,t);return s<0?void 0:o[s][1]}function Mme(t){return a0(this.__data__,t)>-1}function xme(t,o){var s=this.__data__,a=a0(s,t);return a<0?(++this.size,s.push([t,o])):s[a][1]=o,this}function cu(t){var o=-1,s=t==null?0:t.length;for(this.clear();++o<s;){var a=t[o];this.set(a[0],a[1])}}cu.prototype.clear=Nme;cu.prototype.delete=Dme;cu.prototype.get=Lme;cu.prototype.has=Mme;cu.prototype.set=xme;var Lg=Wh(Rc,"Map");function Ume(){this.size=0,this.__data__={hash:new Lh,map:new(Lg||cu),string:new Lh}}function Vme(t){var o=typeof t;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null}function c0(t,o){var s=t.__data__;return Vme(o)?s[typeof o=="string"?"string":"hash"]:s.map}function Fme(t){var o=c0(this,t).delete(t);return this.size-=o?1:0,o}function Bme(t){return c0(this,t).get(t)}function jme(t){return c0(this,t).has(t)}function $me(t,o){var s=c0(this,t),a=s.size;return s.set(t,o),this.size+=s.size==a?0:1,this}function lu(t){var o=-1,s=t==null?0:t.length;for(this.clear();++o<s;){var a=t[o];this.set(a[0],a[1])}}lu.prototype.clear=Ume;lu.prototype.delete=Fme;lu.prototype.get=Bme;lu.prototype.has=jme;lu.prototype.set=$me;var Hme="Expected a function";function l0(t,o){if(typeof t!="function"||o!=null&&typeof o!="function")throw new TypeError(Hme);var s=function(){var a=arguments,l=o?o.apply(this,a):a[0],d=s.cache;if(d.has(l))return d.get(l);var h=t.apply(this,a);return s.cache=d.set(l,h)||d,h};return s.cache=new(l0.Cache||lu),s}l0.Cache=lu;var Wme=500;function Kme(t){var o=l0(t,function(a){return s.size===Wme&&s.clear(),a}),s=o.cache;return o}var Gme=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zme=/\\(\\)?/g,Yme=Kme(function(t){var o=[];return t.charCodeAt(0)===46&&o.push(""),t.replace(Gme,function(s,a,l,d){o.push(l?d.replace(zme,"$1"):a||s)}),o});function qme(t){return t==null?"":pW(t)}function dm(t,o){return _i(t)?t:LN(t,o)?[t]:Yme(qme(t))}function hm(t){if(typeof t=="string"||s0(t))return t;var o=t+"";return o=="0"&&1/t==-1/0?"-0":o}function u0(t,o){o=dm(o,t);for(var s=0,a=o.length;t!=null&&s<a;)t=t[hm(o[s++])];return s&&s==a?t:void 0}function Oo(t,o,s){var a=t==null?void 0:u0(t,o);return a===void 0?s:a}function MN(t,o){for(var s=-1,a=o.length,l=t.length;++s<a;)t[l+s]=o[s];return t}var Y6=ja?ja.isConcatSpreadable:void 0;function Xme(t){return _i(t)||kg(t)||!!(Y6&&t&&t[Y6])}function i_(t,o,s,a,l){var d=-1,h=t.length;for(s||(s=Xme),l||(l=[]);++d<h;){var v=t[d];o>0&&s(v)?o>1?i_(v,o-1,s,a,l):MN(l,v):a||(l[l.length]=v)}return l}function wW(t){var o=t==null?0:t.length;return o?i_(t,1):[]}function RW(t){return vW(_W(t,void 0,wW),t+"")}var xN=CW(Object.getPrototypeOf,Object),Jme="[object Object]",Zme=Function.prototype,Qme=Object.prototype,IW=Zme.toString,eve=Qme.hasOwnProperty,tve=IW.call(Object);function AW(t){if(!dl(t)||$h(t)!=Jme)return!1;var o=xN(t);if(o===null)return!0;var s=eve.call(o,"constructor")&&o.constructor;return typeof s=="function"&&s instanceof s&&IW.call(s)==tve}function nve(t,o,s){var a=-1,l=t.length;o<0&&(o=-o>l?0:l+o),s=s>l?l:s,s<0&&(s+=l),l=o>s?0:s-o>>>0,o>>>=0;for(var d=Array(l);++a<l;)d[a]=t[a+o];return d}function Js(){if(!arguments.length)return[];var t=arguments[0];return _i(t)?t:[t]}function rve(){this.__data__=new cu,this.size=0}function ove(t){var o=this.__data__,s=o.delete(t);return this.size=o.size,s}function sve(t){return this.__data__.get(t)}function ive(t){return this.__data__.has(t)}var ave=200;function cve(t,o){var s=this.__data__;if(s instanceof cu){var a=s.__data__;if(!Lg||a.length<ave-1)return a.push([t,o]),this.size=++s.size,this;s=this.__data__=new lu(a)}return s.set(t,o),this.size=s.size,this}function _c(t){var o=this.__data__=new cu(t);this.size=o.size}_c.prototype.clear=rve;_c.prototype.delete=ove;_c.prototype.get=sve;_c.prototype.has=ive;_c.prototype.set=cve;function lve(t,o){return t&&lm(o,o_(o),t)}function uve(t,o){return t&&lm(o,s_(o),t)}var OW=typeof la=="object"&&la&&!la.nodeType&&la,q6=OW&&typeof ua=="object"&&ua&&!ua.nodeType&&ua,dve=q6&&q6.exports===OW,X6=dve?Rc.Buffer:void 0,J6=X6?X6.allocUnsafe:void 0;function NW(t,o){if(o)return t.slice();var s=t.length,a=J6?J6(s):new t.constructor(s);return t.copy(a),a}function hve(t,o){for(var s=-1,a=t==null?0:t.length,l=0,d=[];++s<a;){var h=t[s];o(h,s,t)&&(d[l++]=h)}return d}function kW(){return[]}var fve=Object.prototype,pve=fve.propertyIsEnumerable,Z6=Object.getOwnPropertySymbols,UN=Z6?function(t){return t==null?[]:(t=Object(t),hve(Z6(t),function(o){return pve.call(t,o)}))}:kW;function mve(t,o){return lm(t,UN(t),o)}var vve=Object.getOwnPropertySymbols,PW=vve?function(t){for(var o=[];t;)MN(o,UN(t)),t=xN(t);return o}:kW;function gve(t,o){return lm(t,PW(t),o)}function DW(t,o,s){var a=o(t);return _i(t)?a:MN(a,s(t))}function HA(t){return DW(t,o_,UN)}function LW(t){return DW(t,s_,PW)}var WA=Wh(Rc,"DataView"),KA=Wh(Rc,"Promise"),Lp=Wh(Rc,"Set"),Q6="[object Map]",_ve="[object Object]",e$="[object Promise]",t$="[object Set]",n$="[object WeakMap]",r$="[object DataView]",Eve=Hh(WA),yve=Hh(Lg),bve=Hh(KA),Sve=Hh(Lp),Tve=Hh($A),pc=$h;(WA&&pc(new WA(new ArrayBuffer(1)))!=r$||Lg&&pc(new Lg)!=Q6||KA&&pc(KA.resolve())!=e$||Lp&&pc(new Lp)!=t$||$A&&pc(new $A)!=n$)&&(pc=function(t){var o=$h(t),s=o==_ve?t.constructor:void 0,a=s?Hh(s):"";if(a)switch(a){case Eve:return r$;case yve:return Q6;case bve:return e$;case Sve:return t$;case Tve:return n$}return o});var Cve=Object.prototype,wve=Cve.hasOwnProperty;function Rve(t){var o=t.length,s=new t.constructor(o);return o&&typeof t[0]=="string"&&wve.call(t,"index")&&(s.index=t.index,s.input=t.input),s}var ES=Rc.Uint8Array;function VN(t){var o=new t.constructor(t.byteLength);return new ES(o).set(new ES(t)),o}function Ive(t,o){var s=o?VN(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}var Ave=/\w*$/;function Ove(t){var o=new t.constructor(t.source,Ave.exec(t));return o.lastIndex=t.lastIndex,o}var o$=ja?ja.prototype:void 0,s$=o$?o$.valueOf:void 0;function Nve(t){return s$?Object(s$.call(t)):{}}function MW(t,o){var s=o?VN(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}var kve="[object Boolean]",Pve="[object Date]",Dve="[object Map]",Lve="[object Number]",Mve="[object RegExp]",xve="[object Set]",Uve="[object String]",Vve="[object Symbol]",Fve="[object ArrayBuffer]",Bve="[object DataView]",jve="[object Float32Array]",$ve="[object Float64Array]",Hve="[object Int8Array]",Wve="[object Int16Array]",Kve="[object Int32Array]",Gve="[object Uint8Array]",zve="[object Uint8ClampedArray]",Yve="[object Uint16Array]",qve="[object Uint32Array]";function Xve(t,o,s){var a=t.constructor;switch(o){case Fve:return VN(t);case kve:case Pve:return new a(+t);case Bve:return Ive(t,s);case jve:case $ve:case Hve:case Wve:case Kve:case Gve:case zve:case Yve:case qve:return MW(t,s);case Dve:return new a;case Lve:case Uve:return new a(t);case Mve:return Ove(t);case xve:return new a;case Vve:return Nve(t)}}function xW(t){return typeof t.constructor=="function"&&!kN(t)?ipe(xN(t)):{}}var Jve="[object Map]";function Zve(t){return dl(t)&&pc(t)==Jve}var i$=Hp&&Hp.isMap,Qve=i$?PN(i$):Zve,ege="[object Set]";function tge(t){return dl(t)&&pc(t)==ege}var a$=Hp&&Hp.isSet,nge=a$?PN(a$):tge,rge=1,oge=2,sge=4,UW="[object Arguments]",ige="[object Array]",age="[object Boolean]",cge="[object Date]",lge="[object Error]",VW="[object Function]",uge="[object GeneratorFunction]",dge="[object Map]",hge="[object Number]",FW="[object Object]",fge="[object RegExp]",pge="[object Set]",mge="[object String]",vge="[object Symbol]",gge="[object WeakMap]",_ge="[object ArrayBuffer]",Ege="[object DataView]",yge="[object Float32Array]",bge="[object Float64Array]",Sge="[object Int8Array]",Tge="[object Int16Array]",Cge="[object Int32Array]",wge="[object Uint8Array]",Rge="[object Uint8ClampedArray]",Ige="[object Uint16Array]",Age="[object Uint32Array]",go={};go[UW]=go[ige]=go[_ge]=go[Ege]=go[age]=go[cge]=go[yge]=go[bge]=go[Sge]=go[Tge]=go[Cge]=go[dge]=go[hge]=go[FW]=go[fge]=go[pge]=go[mge]=go[vge]=go[wge]=go[Rge]=go[Ige]=go[Age]=!0;go[lge]=go[VW]=go[gge]=!1;function Mp(t,o,s,a,l,d){var h,v=o&rge,g=o&oge,E=o&sge;if(s&&(h=l?s(t,a,l,d):s(t)),h!==void 0)return h;if(!Ei(t))return t;var b=_i(t);if(b){if(h=Rve(t),!v)return mW(t,h)}else{var S=pc(t),C=S==VW||S==uge;if(Pg(t))return NW(t,v);if(S==FW||S==UW||C&&!l){if(h=g||C?{}:xW(t),!v)return g?gve(t,uve(h,t)):mve(t,lve(h,t))}else{if(!go[S])return l?t:{};h=Xve(t,S,v)}}d||(d=new _c);var w=d.get(t);if(w)return w;d.set(t,h),nge(t)?t.forEach(function(N){h.add(Mp(N,o,s,N,t,d))}):Qve(t)&&t.forEach(function(N,O){h.set(O,Mp(N,o,s,O,t,d))});var I=E?g?LW:HA:g?s_:o_,R=b?void 0:I(t);return mpe(R||t,function(N,O){R&&(O=N,N=t[O]),ON(h,O,Mp(N,o,s,O,t,d))}),h}var Oge=4;function c$(t){return Mp(t,Oge)}var Nge=1,kge=4;function yS(t){return Mp(t,Nge|kge)}var Pge="__lodash_hash_undefined__";function Dge(t){return this.__data__.set(t,Pge),this}function Lge(t){return this.__data__.has(t)}function Mg(t){var o=-1,s=t==null?0:t.length;for(this.__data__=new lu;++o<s;)this.add(t[o])}Mg.prototype.add=Mg.prototype.push=Dge;Mg.prototype.has=Lge;function Mge(t,o){for(var s=-1,a=t==null?0:t.length;++s<a;)if(o(t[s],s,t))return!0;return!1}function BW(t,o){return t.has(o)}var xge=1,Uge=2;function jW(t,o,s,a,l,d){var h=s&xge,v=t.length,g=o.length;if(v!=g&&!(h&&g>v))return!1;var E=d.get(t),b=d.get(o);if(E&&b)return E==o&&b==t;var S=-1,C=!0,w=s&Uge?new Mg:void 0;for(d.set(t,o),d.set(o,t);++S<v;){var I=t[S],R=o[S];if(a)var N=h?a(R,I,S,o,t,d):a(I,R,S,t,o,d);if(N!==void 0){if(N)continue;C=!1;break}if(w){if(!Mge(o,function(O,V){if(!BW(w,V)&&(I===O||l(I,O,s,a,d)))return w.push(V)})){C=!1;break}}else if(!(I===R||l(I,R,s,a,d))){C=!1;break}}return d.delete(t),d.delete(o),C}function Vge(t){var o=-1,s=Array(t.size);return t.forEach(function(a,l){s[++o]=[l,a]}),s}function FN(t){var o=-1,s=Array(t.size);return t.forEach(function(a){s[++o]=a}),s}var Fge=1,Bge=2,jge="[object Boolean]",$ge="[object Date]",Hge="[object Error]",Wge="[object Map]",Kge="[object Number]",Gge="[object RegExp]",zge="[object Set]",Yge="[object String]",qge="[object Symbol]",Xge="[object ArrayBuffer]",Jge="[object DataView]",l$=ja?ja.prototype:void 0,QI=l$?l$.valueOf:void 0;function Zge(t,o,s,a,l,d,h){switch(s){case Jge:if(t.byteLength!=o.byteLength||t.byteOffset!=o.byteOffset)return!1;t=t.buffer,o=o.buffer;case Xge:return!(t.byteLength!=o.byteLength||!d(new ES(t),new ES(o)));case jge:case $ge:case Kge:return r_(+t,+o);case Hge:return t.name==o.name&&t.message==o.message;case Gge:case Yge:return t==o+"";case Wge:var v=Vge;case zge:var g=a&Fge;if(v||(v=FN),t.size!=o.size&&!g)return!1;var E=h.get(t);if(E)return E==o;a|=Bge,h.set(t,o);var b=jW(v(t),v(o),a,l,d,h);return h.delete(t),b;case qge:if(QI)return QI.call(t)==QI.call(o)}return!1}var Qge=1,e_e=Object.prototype,t_e=e_e.hasOwnProperty;function n_e(t,o,s,a,l,d){var h=s&Qge,v=HA(t),g=v.length,E=HA(o),b=E.length;if(g!=b&&!h)return!1;for(var S=g;S--;){var C=v[S];if(!(h?C in o:t_e.call(o,C)))return!1}var w=d.get(t),I=d.get(o);if(w&&I)return w==o&&I==t;var R=!0;d.set(t,o),d.set(o,t);for(var N=h;++S<g;){C=v[S];var O=t[C],V=o[C];if(a)var L=h?a(V,O,C,o,t,d):a(O,V,C,t,o,d);if(!(L===void 0?O===V||l(O,V,s,a,d):L)){R=!1;break}N||(N=C=="constructor")}if(R&&!N){var D=t.constructor,M=o.constructor;D!=M&&"constructor"in t&&"constructor"in o&&!(typeof D=="function"&&D instanceof D&&typeof M=="function"&&M instanceof M)&&(R=!1)}return d.delete(t),d.delete(o),R}var r_e=1,u$="[object Arguments]",d$="[object Array]",bb="[object Object]",o_e=Object.prototype,h$=o_e.hasOwnProperty;function s_e(t,o,s,a,l,d){var h=_i(t),v=_i(o),g=h?d$:pc(t),E=v?d$:pc(o);g=g==u$?bb:g,E=E==u$?bb:E;var b=g==bb,S=E==bb,C=g==E;if(C&&Pg(t)){if(!Pg(o))return!1;h=!0,b=!1}if(C&&!b)return d||(d=new _c),h||DN(t)?jW(t,o,s,a,l,d):Zge(t,o,g,s,a,l,d);if(!(s&r_e)){var w=b&&h$.call(t,"__wrapped__"),I=S&&h$.call(o,"__wrapped__");if(w||I){var R=w?t.value():t,N=I?o.value():o;return d||(d=new _c),l(R,N,s,a,d)}}return C?(d||(d=new _c),n_e(t,o,s,a,l,d)):!1}function d0(t,o,s,a,l){return t===o?!0:t==null||o==null||!dl(t)&&!dl(o)?t!==t&&o!==o:s_e(t,o,s,a,d0,l)}var i_e=1,a_e=2;function c_e(t,o,s,a){var l=s.length,d=l;if(t==null)return!d;for(t=Object(t);l--;){var h=s[l];if(h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++l<d;){h=s[l];var v=h[0],g=t[v],E=h[1];if(h[2]){if(g===void 0&&!(v in t))return!1}else{var b=new _c,S;if(!(S===void 0?d0(E,g,i_e|a_e,a,b):S))return!1}}return!0}function $W(t){return t===t&&!Ei(t)}function l_e(t){for(var o=o_(t),s=o.length;s--;){var a=o[s],l=t[a];o[s]=[a,l,$W(l)]}return o}function HW(t,o){return function(s){return s==null?!1:s[t]===o&&(o!==void 0||t in Object(s))}}function u_e(t){var o=l_e(t);return o.length==1&&o[0][2]?HW(o[0][0],o[0][1]):function(s){return s===t||c_e(s,t,o)}}function d_e(t,o){return t!=null&&o in Object(t)}function h_e(t,o,s){o=dm(o,t);for(var a=-1,l=o.length,d=!1;++a<l;){var h=hm(o[a]);if(!(d=t!=null&&s(t,h)))break;t=t[h]}return d||++a!=l?d:(l=t==null?0:t.length,!!l&&NN(l)&&i0(h,l)&&(_i(t)||kg(t)))}function WW(t,o){return t!=null&&h_e(t,o,d_e)}var f_e=1,p_e=2;function m_e(t,o){return LN(t)&&$W(o)?HW(hm(t),o):function(s){var a=Oo(s,t);return a===void 0&&a===o?WW(s,t):d0(o,a,f_e|p_e)}}function v_e(t){return function(o){return o==null?void 0:o[t]}}function g_e(t){return function(o){return u0(o,t)}}function __e(t){return LN(t)?v_e(hm(t)):g_e(t)}function KW(t){return typeof t=="function"?t:t==null?RN:typeof t=="object"?_i(t)?m_e(t[0],t[1]):u_e(t):__e(t)}function E_e(t){return function(o,s,a){for(var l=-1,d=Object(o),h=a(o),v=h.length;v--;){var g=h[++l];if(s(d[g],g,d)===!1)break}return o}}var GW=E_e();function y_e(t,o){return t&&GW(t,o,o_)}function b_e(t,o){return function(s,a){if(s==null)return s;if(!um(s))return t(s,a);for(var l=s.length,d=-1,h=Object(s);++d<l&&a(h[d],d,h)!==!1;);return s}}var S_e=b_e(y_e),eA=function(){return Rc.Date.now()},T_e="Expected a function",C_e=Math.max,w_e=Math.min;function Hi(t,o,s){var a,l,d,h,v,g,E=0,b=!1,S=!1,C=!0;if(typeof t!="function")throw new TypeError(T_e);o=B6(o)||0,Ei(s)&&(b=!!s.leading,S="maxWait"in s,d=S?C_e(B6(s.maxWait)||0,o):d,C="trailing"in s?!!s.trailing:C);function w(F){var W=a,z=l;return a=l=void 0,E=F,h=t.apply(z,W),h}function I(F){return E=F,v=setTimeout(O,o),b?w(F):h}function R(F){var W=F-g,z=F-E,G=o-W;return S?w_e(G,d-z):G}function N(F){var W=F-g,z=F-E;return g===void 0||W>=o||W<0||S&&z>=d}function O(){var F=eA();if(N(F))return V(F);v=setTimeout(O,R(F))}function V(F){return v=void 0,C&&a?w(F):(a=l=void 0,h)}function L(){v!==void 0&&clearTimeout(v),E=0,a=g=l=v=void 0}function D(){return v===void 0?h:V(eA())}function M(){var F=eA(),W=N(F);if(a=arguments,l=this,g=F,W){if(v===void 0)return I(g);if(S)return clearTimeout(v),v=setTimeout(O,o),w(g)}return v===void 0&&(v=setTimeout(O,o)),h}return M.cancel=L,M.flush=D,M}function GA(t,o,s){(s!==void 0&&!r_(t[o],s)||s===void 0&&!(o in t))&&AN(t,o,s)}function zW(t){return dl(t)&&um(t)}function zA(t,o){if(!(o==="constructor"&&typeof t[o]=="function")&&o!="__proto__")return t[o]}function R_e(t){return lm(t,s_(t))}function I_e(t,o,s,a,l,d,h){var v=zA(t,s),g=zA(o,s),E=h.get(g);if(E){GA(t,s,E);return}var b=d?d(v,g,s+"",t,o,h):void 0,S=b===void 0;if(S){var C=_i(g),w=!C&&Pg(g),I=!C&&!w&&DN(g);b=g,C||w||I?_i(v)?b=v:zW(v)?b=mW(v):w?(S=!1,b=NW(g,!0)):I?(S=!1,b=MW(g,!0)):b=[]:AW(g)||kg(g)?(b=v,kg(v)?b=R_e(v):(!Ei(v)||IN(v))&&(b=xW(g))):S=!1}S&&(h.set(g,b),l(b,g,a,d,h),h.delete(g)),GA(t,s,b)}function YW(t,o,s,a,l){t!==o&&GW(o,function(d,h){if(l||(l=new _c),Ei(d))I_e(t,o,h,s,YW,a,l);else{var v=a?a(zA(t,h),d,h+"",t,o,l):void 0;v===void 0&&(v=d),GA(t,h,v)}},s_)}function A_e(t){var o=t==null?0:t.length;return o?t[o-1]:void 0}function qW(t,o,s){var a=t==null?0:t.length;if(!a)return-1;var l=a-1;return gW(t,KW(o),l,!0)}function O_e(t,o){var s=-1,a=um(t)?Array(t.length):[];return S_e(t,function(l,d,h){a[++s]=o(l,d,h)}),a}function N_e(t,o){var s=_i(t)?wN:O_e;return s(t,KW(o))}function k_e(t,o){return i_(N_e(t,o),1)}var P_e=1/0;function D_e(t){var o=t==null?0:t.length;return o?i_(t,P_e):[]}function xg(t){for(var o=-1,s=t==null?0:t.length,a={};++o<s;){var l=t[o];a[l[0]]=l[1]}return a}function L_e(t,o){return o.length<2?t:u0(t,nve(o,0,-1))}function as(t,o){return d0(t,o)}function Qo(t){return t==null}function a_(t){return t===null}function XW(t){return t===void 0}var JW=Rpe(function(t,o,s){YW(t,o,s)});function M_e(t,o){return o=dm(o,t),t=L_e(t,o),t==null||delete t[hm(A_e(o))]}function x_e(t){return AW(t)?void 0:t}var U_e=1,V_e=2,F_e=4,B_e=RW(function(t,o){var s={};if(t==null)return s;var a=!1;o=wN(o,function(d){return d=dm(d,t),a||(a=d.length>1),d}),lm(t,LW(t),s),a&&(s=Mp(s,U_e|V_e|F_e,x_e));for(var l=o.length;l--;)M_e(s,o[l]);return s});function ZW(t,o,s,a){if(!Ei(t))return t;o=dm(o,t);for(var l=-1,d=o.length,h=d-1,v=t;v!=null&&++l<d;){var g=hm(o[l]),E=s;if(g==="__proto__"||g==="constructor"||g==="prototype")return t;if(l!=h){var b=v[g];E=void 0,E===void 0&&(E=Ei(b)?b:i0(o[l+1])?[]:{})}ON(v,g,E),v=v[g]}return t}function j_e(t,o,s){for(var a=-1,l=o.length,d={};++a<l;){var h=o[a],v=u0(t,h);s(v,h)&&ZW(d,dm(h,t),v)}return d}function $_e(t,o){return j_e(t,o,function(s,a){return WW(t,a)})}var mc=RW(function(t,o){return t==null?{}:$_e(t,o)});function H_e(t,o,s){return t==null?t:ZW(t,o,s)}var W_e="Expected a function";function Ih(t,o,s){var a=!0,l=!0;if(typeof t!="function")throw new TypeError(W_e);return Ei(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),Hi(t,o,{leading:a,maxWait:o,trailing:l})}var K_e=1/0,G_e=Lp&&1/FN(new Lp([,-0]))[1]==K_e?function(t){return new Lp(t)}:cpe,z_e=200;function Y_e(t,o,s){var a=-1,l=Epe,d=t.length,h=!0,v=[],g=v;if(d>=z_e){var E=G_e(t);if(E)return FN(E);h=!1,l=BW,g=new Mg}else g=v;e:for(;++a<d;){var b=t[a],S=b;if(b=b!==0?b:0,h&&S===S){for(var C=g.length;C--;)if(g[C]===S)continue e;v.push(b)}else l(g,S,s)||(g!==v&&g.push(S),v.push(b))}return v}var tA=EW(function(t){return Y_e(i_(t,1,zW,!0))});const Xn=t=>t===void 0,wr=t=>typeof t=="boolean",$t=t=>typeof t=="number",oa=t=>!t&&t!==0||st(t)&&t.length===0||fn(t)&&!Object.keys(t).length,mi=t=>typeof Element>"u"?!1:t instanceof Element,Ec=t=>Qo(t),q_e=t=>Mt(t)?!Number.isNaN(Number(t)):!1,h0=t=>t===window;var X_e=Object.defineProperty,J_e=Object.defineProperties,Z_e=Object.getOwnPropertyDescriptors,f$=Object.getOwnPropertySymbols,Q_e=Object.prototype.hasOwnProperty,eEe=Object.prototype.propertyIsEnumerable,p$=(t,o,s)=>o in t?X_e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,tEe=(t,o)=>{for(var s in o||(o={}))Q_e.call(o,s)&&p$(t,s,o[s]);if(f$)for(var s of f$(o))eEe.call(o,s)&&p$(t,s,o[s]);return t},nEe=(t,o)=>J_e(t,Z_e(o));function YA(t,o){var s;const a=Mr();return Ms(()=>{a.value=t()},nEe(tEe({},o),{flush:(s=void 0)!=null?s:"sync"})),am(a)}var m$;const Vn=typeof window<"u",rEe=t=>typeof t<"u",qA=t=>typeof t=="function",oEe=t=>typeof t=="string",Wp=()=>{},bS=Vn&&((m$=window==null?void 0:window.navigator)==null?void 0:m$.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function cd(t){return typeof t=="function"?t():p(t)}function QW(t,o){function s(...a){return new Promise((l,d)=>{Promise.resolve(t(()=>o.apply(this,a),{fn:o,thisArg:this,args:a})).then(l).catch(d)})}return s}function sEe(t,o={}){let s,a,l=Wp;const d=v=>{clearTimeout(v),l(),l=Wp};return v=>{const g=cd(t),E=cd(o.maxWait);return s&&d(s),g<=0||E!==void 0&&E<=0?(a&&(d(a),a=null),Promise.resolve(v())):new Promise((b,S)=>{l=o.rejectOnCancel?S:b,E&&!a&&(a=setTimeout(()=>{s&&d(s),a=null,b(v())},E)),s=setTimeout(()=>{a&&d(a),a=null,b(v())},g)})}}function iEe(t,o=!0,s=!0,a=!1){let l=0,d,h=!0,v=Wp,g;const E=()=>{d&&(clearTimeout(d),d=void 0,v(),v=Wp)};return S=>{const C=cd(t),w=Date.now()-l,I=()=>g=S();return E(),C<=0?(l=Date.now(),I()):(w>C&&(s||!h)?(l=Date.now(),I()):o&&(g=new Promise((R,N)=>{v=a?N:R,d=setTimeout(()=>{l=Date.now(),h=!0,R(I()),E()},Math.max(0,C-w))})),!s&&!d&&(d=setTimeout(()=>h=!0,C)),h=!1,g)}}function aEe(t){return t}function cEe(t,o){let s,a,l;const d=ee(!0),h=()=>{d.value=!0,l()};ze(t,h,{flush:"sync"});const v=qA(o)?o:o.get,g=qA(o)?void 0:o.set,E=Vde((b,S)=>(a=b,l=S,{get(){return d.value&&(s=v(),d.value=!1),a(),s},set(C){g==null||g(C)}}));return Object.isExtensible(E)&&(E.trigger=h),E}function c_(t){return $8()?(H8(t),!0):!1}function lEe(t,o=200,s={}){return QW(sEe(o,s),t)}function uEe(t,o=200,s={}){const a=ee(t.value),l=lEe(()=>{a.value=t.value},o,s);return ze(t,()=>l()),a}function eK(t,o=200,s=!1,a=!0,l=!1){return QW(iEe(o,s,a,l),t)}function BN(t,o=!0){mn()?dn(t):o?t():Vt(t)}function Mh(t,o,s={}){const{immediate:a=!0}=s,l=ee(!1);let d=null;function h(){d&&(clearTimeout(d),d=null)}function v(){l.value=!1,h()}function g(...E){h(),l.value=!0,d=setTimeout(()=>{l.value=!1,d=null,t(...E)},cd(o))}return a&&(l.value=!0,Vn&&g()),c_(v),{isPending:am(l),start:g,stop:v}}function pi(t){var o;const s=cd(t);return(o=s==null?void 0:s.$el)!=null?o:s}const gd=Vn?window:void 0,dEe=Vn?window.document:void 0;function gr(...t){let o,s,a,l;if(oEe(t[0])||Array.isArray(t[0])?([s,a,l]=t,o=gd):[o,s,a,l]=t,!o)return Wp;Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]);const d=[],h=()=>{d.forEach(b=>b()),d.length=0},v=(b,S,C,w)=>(b.addEventListener(S,C,w),()=>b.removeEventListener(S,C,w)),g=ze(()=>[pi(o),cd(l)],([b,S])=>{h(),b&&d.push(...s.flatMap(C=>a.map(w=>v(b,C,w,S))))},{immediate:!0,flush:"post"}),E=()=>{g(),h()};return c_(E),E}let v$=!1;function jN(t,o,s={}){const{window:a=gd,ignore:l=[],capture:d=!0,detectIframe:h=!1}=s;if(!a)return;bS&&!v$&&(v$=!0,Array.from(a.document.body.children).forEach(C=>C.addEventListener("click",Wp)));let v=!0;const g=C=>l.some(w=>{if(typeof w=="string")return Array.from(a.document.querySelectorAll(w)).some(I=>I===C.target||C.composedPath().includes(I));{const I=pi(w);return I&&(C.target===I||C.composedPath().includes(I))}}),b=[gr(a,"click",C=>{const w=pi(t);if(!(!w||w===C.target||C.composedPath().includes(w))){if(C.detail===0&&(v=!g(C)),!v){v=!0;return}o(C)}},{passive:!0,capture:d}),gr(a,"pointerdown",C=>{const w=pi(t);w&&(v=!C.composedPath().includes(w)&&!g(C))},{passive:!0}),h&&gr(a,"blur",C=>{var w;const I=pi(t);((w=a.document.activeElement)==null?void 0:w.tagName)==="IFRAME"&&!(I!=null&&I.contains(a.document.activeElement))&&o(C)})].filter(Boolean);return()=>b.forEach(C=>C())}function hEe(t={}){var o;const{window:s=gd}=t,a=(o=t.document)!=null?o:s==null?void 0:s.document,l=cEe(()=>null,()=>a==null?void 0:a.activeElement);return s&&(gr(s,"blur",d=>{d.relatedTarget===null&&l.trigger()},!0),gr(s,"focus",l.trigger,!0)),l}function tK(t,o=!1){const s=ee(),a=()=>s.value=!!t();return a(),BN(a,o),s}function fEe(t){return JSON.parse(JSON.stringify(t))}const g$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_$="__vueuse_ssr_handlers__";g$[_$]=g$[_$]||{};function pEe(t,o,{window:s=gd,initialValue:a=""}={}){const l=ee(a),d=U(()=>{var h;return pi(o)||((h=s==null?void 0:s.document)==null?void 0:h.documentElement)});return ze([d,()=>cd(t)],([h,v])=>{var g;if(h&&s){const E=(g=s.getComputedStyle(h).getPropertyValue(v))==null?void 0:g.trim();l.value=E||a}},{immediate:!0}),ze(l,h=>{var v;(v=d.value)!=null&&v.style&&d.value.style.setProperty(cd(t),h)}),l}function mEe({document:t=dEe}={}){if(!t)return ee("visible");const o=ee(t.visibilityState);return gr(t,"visibilitychange",()=>{o.value=t.visibilityState}),o}var E$=Object.getOwnPropertySymbols,vEe=Object.prototype.hasOwnProperty,gEe=Object.prototype.propertyIsEnumerable,_Ee=(t,o)=>{var s={};for(var a in t)vEe.call(t,a)&&o.indexOf(a)<0&&(s[a]=t[a]);if(t!=null&&E$)for(var a of E$(t))o.indexOf(a)<0&&gEe.call(t,a)&&(s[a]=t[a]);return s};function co(t,o,s={}){const a=s,{window:l=gd}=a,d=_Ee(a,["window"]);let h;const v=tK(()=>l&&"ResizeObserver"in l),g=()=>{h&&(h.disconnect(),h=void 0)},E=ze(()=>pi(t),S=>{g(),v.value&&l&&S&&(h=new ResizeObserver(o),h.observe(S,d))},{immediate:!0,flush:"post"}),b=()=>{g(),E()};return c_(b),{isSupported:v,stop:b}}function y$(t,o={}){const{reset:s=!0,windowResize:a=!0,windowScroll:l=!0,immediate:d=!0}=o,h=ee(0),v=ee(0),g=ee(0),E=ee(0),b=ee(0),S=ee(0),C=ee(0),w=ee(0);function I(){const R=pi(t);if(!R){s&&(h.value=0,v.value=0,g.value=0,E.value=0,b.value=0,S.value=0,C.value=0,w.value=0);return}const N=R.getBoundingClientRect();h.value=N.height,v.value=N.bottom,g.value=N.left,E.value=N.right,b.value=N.top,S.value=N.width,C.value=N.x,w.value=N.y}return co(t,I),ze(()=>pi(t),R=>!R&&I()),l&&gr("scroll",I,{capture:!0,passive:!0}),a&&gr("resize",I,{passive:!0}),BN(()=>{d&&I()}),{height:h,bottom:v,left:g,right:E,top:b,width:S,x:C,y:w,update:I}}var b$=Object.getOwnPropertySymbols,EEe=Object.prototype.hasOwnProperty,yEe=Object.prototype.propertyIsEnumerable,bEe=(t,o)=>{var s={};for(var a in t)EEe.call(t,a)&&o.indexOf(a)<0&&(s[a]=t[a]);if(t!=null&&b$)for(var a of b$(t))o.indexOf(a)<0&&yEe.call(t,a)&&(s[a]=t[a]);return s};function nK(t,o,s={}){const a=s,{window:l=gd}=a,d=bEe(a,["window"]);let h;const v=tK(()=>l&&"MutationObserver"in l),g=()=>{h&&(h.disconnect(),h=void 0)},E=ze(()=>pi(t),S=>{g(),v.value&&l&&S&&(h=new MutationObserver(o),h.observe(S,d))},{immediate:!0}),b=()=>{g(),E()};return c_(b),{isSupported:v,stop:b}}var S$;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(S$||(S$={}));var SEe=Object.defineProperty,T$=Object.getOwnPropertySymbols,TEe=Object.prototype.hasOwnProperty,CEe=Object.prototype.propertyIsEnumerable,C$=(t,o,s)=>o in t?SEe(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,wEe=(t,o)=>{for(var s in o||(o={}))TEe.call(o,s)&&C$(t,s,o[s]);if(T$)for(var s of T$(o))CEe.call(o,s)&&C$(t,s,o[s]);return t};const REe={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};wEe({linear:aEe},REe);function rK(t,o,s,a={}){var l,d,h;const{clone:v=!1,passive:g=!1,eventName:E,deep:b=!1,defaultValue:S}=a,C=mn(),w=s||(C==null?void 0:C.emit)||((l=C==null?void 0:C.$emit)==null?void 0:l.bind(C))||((h=(d=C==null?void 0:C.proxy)==null?void 0:d.$emit)==null?void 0:h.bind(C==null?void 0:C.proxy));let I=E;o||(o="modelValue"),I=E||I||`update:${o.toString()}`;const R=O=>v?qA(v)?v(O):fEe(O):O,N=()=>rEe(t[o])?R(t[o]):S;if(g){const O=N(),V=ee(O);return ze(()=>t[o],L=>V.value=R(L)),ze(V,L=>{(L!==t[o]||b)&&w(I,L)},{deep:b}),V}else return U({get(){return N()},set(O){w(I,O)}})}function IEe({window:t=gd}={}){if(!t)return ee(!1);const o=ee(t.document.hasFocus());return gr(t,"blur",()=>{o.value=!1}),gr(t,"focus",()=>{o.value=!0}),o}function AEe(t={}){const{window:o=gd,initialWidth:s=1/0,initialHeight:a=1/0,listenOrientation:l=!0,includeScrollbar:d=!0}=t,h=ee(s),v=ee(a),g=()=>{o&&(d?(h.value=o.innerWidth,v.value=o.innerHeight):(h.value=o.document.documentElement.clientWidth,v.value=o.document.documentElement.clientHeight))};return g(),BN(g),gr("resize",g,{passive:!0}),l&&gr("orientationchange",g,{passive:!0}),{width:h,height:v}}class OEe extends Error{constructor(o){super(o),this.name="ElementPlusError"}}function qo(t,o){throw new OEe(`[${t}] ${o}`)}const w$={current:0},R$=ee(0),oK=2e3,I$=Symbol("elZIndexContextKey"),sK=Symbol("zIndexContextKey"),fm=t=>{const o=mn()?It(I$,w$):w$,s=t||(mn()?It(sK,void 0):void 0),a=U(()=>{const h=p(s);return $t(h)?h:oK}),l=U(()=>a.value+R$.value),d=()=>(o.current++,R$.value=o.current,l.value);return!Vn&&It(I$),{initialZIndex:a,currentZIndex:l,nextZIndex:d}};var NEe={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const kEe=t=>(o,s)=>PEe(o,s,p(t)),PEe=(t,o,s)=>Oo(s,t,t).replace(/\{(\w+)\}/g,(a,l)=>{var d;return`${(d=o==null?void 0:o[l])!=null?d:`{${l}}`}`}),DEe=t=>{const o=U(()=>p(t).name),s=xr(t)?t:ee(t);return{lang:o,locale:s,t:kEe(t)}},iK=Symbol("localeContextKey"),Fn=t=>{const o=t||It(iK,ee());return DEe(U(()=>o.value||NEe))},aK="__epPropKey",Re=t=>t,LEe=t=>fn(t)&&!!t[aK],Ic=(t,o)=>{if(!fn(t)||LEe(t))return t;const{values:s,required:a,default:l,type:d,validator:h}=t,g={type:d,required:!!a,validator:s||h?E=>{let b=!1,S=[];if(s&&(S=Array.from(s),zn(t,"default")&&S.push(l),b||(b=S.includes(E))),h&&(b||(b=h(E))),!b&&S.length>0){const C=[...new Set(S)].map(w=>JSON.stringify(w)).join(", ");Whe(`Invalid prop: validation failed${o?` for prop "${o}"`:""}. Expected one of [${C}], got value ${JSON.stringify(E)}.`)}return b}:void 0,[aK]:!0};return zn(t,"default")&&(g.default=l),g},ut=t=>xg(Object.entries(t).map(([o,s])=>[o,Ic(s,o)])),vl=["","default","small","large"],Ho=Ic({type:String,values:vl,required:!1}),cK=Symbol("size"),lK=()=>{const t=It(cK,{});return U(()=>p(t.size)||"")},uK=Symbol("emptyValuesContextKey"),MEe=["",void 0,null],xEe=void 0,pm=ut({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:t=>Ft(t)?!t():!t}}),f0=(t,o)=>{const s=mn()?It(uK,ee({})):ee({}),a=U(()=>t.emptyValues||s.value.emptyValues||MEe),l=U(()=>Ft(t.valueOnClear)?t.valueOnClear():t.valueOnClear!==void 0?t.valueOnClear:Ft(s.value.valueOnClear)?s.value.valueOnClear():s.value.valueOnClear!==void 0?s.value.valueOnClear:o!==void 0?o:xEe),d=h=>a.value.includes(h);return a.value.includes(l.value),{emptyValues:a,valueOnClear:l,isEmptyValue:d}},Kp=t=>Object.keys(t),dK=t=>Object.entries(t),vg=(t,o,s)=>({get value(){return Oo(t,o,s)},set value(a){H_e(t,o,a)}}),SS=ee();function p0(t,o=void 0){const s=mn()?It(uW,SS):SS;return t?U(()=>{var a,l;return(l=(a=s.value)==null?void 0:a[t])!=null?l:o}):s}function m0(t,o){const s=p0(),a=Qe(t,U(()=>{var v;return((v=s.value)==null?void 0:v.namespace)||pg})),l=Fn(U(()=>{var v;return(v=s.value)==null?void 0:v.locale})),d=fm(U(()=>{var v;return((v=s.value)==null?void 0:v.zIndex)||oK})),h=U(()=>{var v;return p(o)||((v=s.value)==null?void 0:v.size)||""});return $N(U(()=>p(s)||{})),{ns:a,locale:l,zIndex:d,size:h}}const $N=(t,o,s=!1)=>{var a;const l=!!mn(),d=l?p0():void 0,h=(a=o==null?void 0:o.provide)!=null?a:l?wn:void 0;if(!h)return;const v=U(()=>{const g=p(t);return d!=null&&d.value?UEe(d.value,g):g});return h(uW,v),h(iK,U(()=>v.value.locale)),h(dW,U(()=>v.value.namespace)),h(sK,U(()=>v.value.zIndex)),h(cK,{size:U(()=>v.value.size||"")}),h(uK,U(()=>({emptyValues:v.value.emptyValues,valueOnClear:v.value.valueOnClear}))),(s||!SS.value)&&(SS.value=v.value),v},UEe=(t,o)=>{const s=[...new Set([...Kp(t),...Kp(o)])],a={};for(const l of s)a[l]=o[l]!==void 0?o[l]:t[l];return a},VEe=(t=[])=>({version:Cfe,install:(s,a)=>{s[M6]||(s[M6]=!0,t.forEach(l=>s.use(l)),a&&$N(a,s,!0))}}),Jt="update:modelValue",yn="change",cs="input",FEe=ut({zIndex:{type:Re([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),BEe={scroll:({scrollTop:t,fixed:o})=>$t(t)&&wr(o),[yn]:t=>wr(t)};var dt=(t,o)=>{const s=t.__vccOpts||t;for(const[a,l]of o)s[a]=l;return s};function jEe(t,o,s,a){const l=s-o;return t/=a/2,t<1?l/2*t*t*t+o:l/2*((t-=2)*t*t+2)+o}const ld=t=>Vn?window.requestAnimationFrame(t):setTimeout(t,16),xh=t=>Vn?window.cancelAnimationFrame(t):clearTimeout(t),hK=(t="")=>t.split(" ").filter(o=>!!o.trim()),Fi=(t,o)=>{if(!t||!o)return!1;if(o.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(o)},Ua=(t,o)=>{!t||!o.trim()||t.classList.add(...hK(o))},ti=(t,o)=>{!t||!o.trim()||t.classList.remove(...hK(o))},ql=(t,o)=>{var s;if(!Vn||!t||!o)return"";let a=gi(o);a==="float"&&(a="cssFloat");try{const l=t.style[a];if(l)return l;const d=(s=document.defaultView)==null?void 0:s.getComputedStyle(t,"");return d?d[a]:""}catch{return t.style[a]}},fK=(t,o,s)=>{if(!(!t||!o))if(fn(o))dK(o).forEach(([a,l])=>fK(t,a,l));else{const a=gi(o);t.style[a]=s}};function mo(t,o="px"){if(!t)return"";if($t(t)||q_e(t))return`${t}${o}`;if(Mt(t))return t}const $Ee=(t,o)=>{if(!Vn)return!1;const s={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(o)],a=ql(t,s);return["scroll","auto","overlay"].some(l=>a.includes(l))},HN=(t,o)=>{if(!Vn)return;let s=t;for(;s;){if([window,document,document.documentElement].includes(s))return window;if($Ee(s,o))return s;s=s.parentNode}return s};let Sb;const pK=t=>{var o;if(!Vn)return 0;if(Sb!==void 0)return Sb;const s=document.createElement("div");s.className=`${t}-scrollbar__wrap`,s.style.visibility="hidden",s.style.width="100px",s.style.position="absolute",s.style.top="-9999px",document.body.appendChild(s);const a=s.offsetWidth;s.style.overflow="scroll";const l=document.createElement("div");l.style.width="100%",s.appendChild(l);const d=l.offsetWidth;return(o=s.parentNode)==null||o.removeChild(s),Sb=a-d,Sb};function WN(t,o){if(!Vn)return;if(!o){t.scrollTop=0;return}const s=[];let a=o.offsetParent;for(;a!==null&&t!==a&&t.contains(a);)s.push(a),a=a.offsetParent;const l=o.offsetTop+s.reduce((g,E)=>g+E.offsetTop,0),d=l+o.offsetHeight,h=t.scrollTop,v=h+t.clientHeight;l<h?t.scrollTop=l:d>v&&(t.scrollTop=d-t.clientHeight)}function HEe(t,o,s,a,l){const d=Date.now();let h;const v=()=>{const E=Date.now()-d,b=jEe(E>a?a:E,o,s,a);h0(t)?t.scrollTo(window.pageXOffset,b):t.scrollTop=b,E<a?h=ld(v):Ft(l)&&l()};return v(),()=>{h&&xh(h)}}const A$=(t,o)=>h0(o)?t.ownerDocument.documentElement:o,O$=t=>h0(t)?window.scrollY:t.scrollTop,mK="ElAffix",WEe=me({name:mK}),KEe=me({...WEe,props:FEe,emits:BEe,setup(t,{expose:o,emit:s}){const a=t,l=Qe("affix"),d=Mr(),h=Mr(),v=Mr(),{height:g}=AEe(),{height:E,width:b,top:S,bottom:C,update:w}=y$(h,{windowScroll:!1}),I=y$(d),R=ee(!1),N=ee(0),O=ee(0),V=U(()=>({height:R.value?`${E.value}px`:"",width:R.value?`${b.value}px`:""})),L=U(()=>{if(!R.value)return{};const F=a.offset?mo(a.offset):0;return{height:`${E.value}px`,width:`${b.value}px`,top:a.position==="top"?F:"",bottom:a.position==="bottom"?F:"",transform:O.value?`translateY(${O.value}px)`:"",zIndex:a.zIndex}}),D=()=>{if(!v.value)return;N.value=v.value instanceof Window?document.documentElement.scrollTop:v.value.scrollTop||0;const{position:F,target:W,offset:z}=a,G=z+E.value;if(F==="top")if(W){const Y=I.bottom.value-G;R.value=z>S.value&&I.bottom.value>0,O.value=Y<0?Y:0}else R.value=z>S.value;else if(W){const Y=g.value-I.top.value-G;R.value=g.value-z<C.value&&g.value>I.top.value,O.value=Y<0?-Y:0}else R.value=g.value-z<C.value},M=async()=>{w(),await Vt(),s("scroll",{scrollTop:N.value,fixed:R.value})};return ze(R,F=>s(yn,F)),dn(()=>{var F;a.target?(d.value=(F=document.querySelector(a.target))!=null?F:void 0,d.value||qo(mK,`Target does not exist: ${a.target}`)):d.value=document.documentElement,v.value=HN(h.value,!0),w()}),gr(v,"scroll",M),Ms(D),o({update:D,updateRoot:w}),(F,W)=>($(),le("div",{ref_key:"root",ref:h,class:K(p(l).b()),style:jt(p(V))},[ue("div",{class:K({[p(l).m("fixed")]:R.value}),style:jt(p(L))},[Ne(F.$slots,"default")],6)],6))}});var GEe=dt(KEe,[["__file","affix.vue"]]);const rn=(t,o)=>{if(t.install=s=>{for(const a of[t,...Object.values(o??{})])s.component(a.name,a)},o)for(const[s,a]of Object.entries(o))t[s]=a;return t},vK=(t,o)=>(t.install=s=>{t._context=s._context,s.config.globalProperties[o]=t},t),zEe=(t,o)=>(t.install=s=>{s.directive(o,t)},t),uo=t=>(t.install=pr,t),YEe=rn(GEe),qEe=ut({size:{type:Re([Number,String])},color:{type:String}}),XEe=me({name:"ElIcon",inheritAttrs:!1}),JEe=me({...XEe,props:qEe,setup(t){const o=t,s=Qe("icon"),a=U(()=>{const{size:l,color:d}=o;return!l&&!d?{}:{fontSize:Xn(l)?void 0:mo(l),"--color":d}});return(l,d)=>($(),le("i",En({class:p(s).b(),style:p(a)},l.$attrs),[Ne(l.$slots,"default")],16))}});var ZEe=dt(JEe,[["__file","icon.vue"]]);const Dt=rn(ZEe);/*! Element Plus Icons Vue v2.3.1 */var QEe=me({name:"ArrowDown",__name:"arrow-down",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),uu=QEe,eye=me({name:"ArrowLeft",__name:"arrow-left",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),ud=eye,tye=me({name:"ArrowRight",__name:"arrow-right",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),vi=tye,nye=me({name:"ArrowUp",__name:"arrow-up",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),KN=nye,rye=me({name:"Back",__name:"back",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),ue("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),oye=rye,sye=me({name:"Calendar",__name:"calendar",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),iye=sye,aye=me({name:"CaretRight",__name:"caret-right",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),gK=aye,cye=me({name:"CaretTop",__name:"caret-top",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),lye=cye,uye=me({name:"Check",__name:"check",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),l_=uye,dye=me({name:"CircleCheckFilled",__name:"circle-check-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),hye=dye,fye=me({name:"CircleCheck",__name:"circle-check",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),ue("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),GN=fye,pye=me({name:"CircleCloseFilled",__name:"circle-close-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),zN=pye,mye=me({name:"CircleClose",__name:"circle-close",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),du=mye,vye=me({name:"Clock",__name:"clock",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),ue("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),ue("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),_K=vye,gye=me({name:"Close",__name:"close",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Sc=gye,_ye=me({name:"DArrowLeft",__name:"d-arrow-left",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),dd=_ye,Eye=me({name:"DArrowRight",__name:"d-arrow-right",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),hd=Eye,yye=me({name:"Delete",__name:"delete",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),bye=yye,Sye=me({name:"Document",__name:"document",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),Tye=Sye,Cye=me({name:"FullScreen",__name:"full-screen",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),wye=Cye,Rye=me({name:"Hide",__name:"hide",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),ue("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),Iye=Rye,Aye=me({name:"InfoFilled",__name:"info-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),YN=Aye,Oye=me({name:"Loading",__name:"loading",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),hl=Oye,Nye=me({name:"Minus",__name:"minus",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),kye=Nye,Pye=me({name:"MoreFilled",__name:"more-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),N$=Pye,Dye=me({name:"More",__name:"more",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),Lye=Dye,Mye=me({name:"PictureFilled",__name:"picture-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),xye=Mye,Uye=me({name:"Plus",__name:"plus",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),EK=Uye,Vye=me({name:"QuestionFilled",__name:"question-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),Fye=Vye,Bye=me({name:"RefreshLeft",__name:"refresh-left",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),jye=Bye,$ye=me({name:"RefreshRight",__name:"refresh-right",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),Hye=$ye,Wye=me({name:"ScaleToOriginal",__name:"scale-to-original",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),Kye=Wye,Gye=me({name:"Search",__name:"search",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),zye=Gye,Yye=me({name:"SortDown",__name:"sort-down",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),qye=Yye,Xye=me({name:"SortUp",__name:"sort-up",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),Jye=Xye,Zye=me({name:"StarFilled",__name:"star-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),Tb=Zye,Qye=me({name:"Star",__name:"star",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),ebe=Qye,tbe=me({name:"SuccessFilled",__name:"success-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),yK=tbe,nbe=me({name:"View",__name:"view",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),rbe=nbe,obe=me({name:"WarningFilled",__name:"warning-filled",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),v0=obe,sbe=me({name:"ZoomIn",__name:"zoom-in",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),bK=sbe,ibe=me({name:"ZoomOut",__name:"zoom-out",setup(t){return(o,s)=>($(),le("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),abe=ibe;const yr=Re([String,Object,Function]),qN={Close:Sc},XN={Close:Sc,SuccessFilled:yK,InfoFilled:YN,WarningFilled:v0,CircleCloseFilled:zN},fd={success:yK,warning:v0,error:zN,info:YN},g0={validating:hl,success:GN,error:du},cbe=["light","dark"],lbe=ut({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Kp(fd),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:cbe,default:"light"}}),ube={close:t=>t instanceof MouseEvent},dbe=me({name:"ElAlert"}),hbe=me({...dbe,props:lbe,emits:ube,setup(t,{emit:o}){const s=t,{Close:a}=XN,l=Jo(),d=Qe("alert"),h=ee(!0),v=U(()=>fd[s.type]),g=U(()=>!!(s.description||l.default)),E=b=>{h.value=!1,o("close",b)};return(b,S)=>($(),Ve(hs,{name:p(d).b("fade"),persisted:""},{default:Ce(()=>[ln(ue("div",{class:K([p(d).b(),p(d).m(b.type),p(d).is("center",b.center),p(d).is(b.effect)]),role:"alert"},[b.showIcon&&(b.$slots.icon||p(v))?($(),Ve(p(Dt),{key:0,class:K([p(d).e("icon"),{[p(d).is("big")]:p(g)}])},{default:Ce(()=>[Ne(b.$slots,"icon",{},()=>[($(),Ve(gn(p(v))))])]),_:3},8,["class"])):De("v-if",!0),ue("div",{class:K(p(d).e("content"))},[b.title||b.$slots.title?($(),le("span",{key:0,class:K([p(d).e("title"),{"with-description":p(g)}])},[Ne(b.$slots,"title",{},()=>[bn(ot(b.title),1)])],2)):De("v-if",!0),p(g)?($(),le("p",{key:1,class:K(p(d).e("description"))},[Ne(b.$slots,"default",{},()=>[bn(ot(b.description),1)])],2)):De("v-if",!0),b.closable?($(),le(Ut,{key:2},[b.closeText?($(),le("div",{key:0,class:K([p(d).e("close-btn"),p(d).is("customed")]),onClick:E},ot(b.closeText),3)):($(),Ve(p(Dt),{key:1,class:K(p(d).e("close-btn")),onClick:E},{default:Ce(()=>[ge(p(a))]),_:1},8,["class"]))],64)):De("v-if",!0)],2)],2),[[Wn,h.value]])]),_:3},8,["name"]))}});var fbe=dt(hbe,[["__file","alert.vue"]]);const pbe=rn(fbe),_0=()=>Vn&&/firefox/i.test(window.navigator.userAgent);let xi;const mbe={height:"0",visibility:"hidden",overflow:_0()?"":"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},vbe=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function gbe(t){const o=window.getComputedStyle(t),s=o.getPropertyValue("box-sizing"),a=Number.parseFloat(o.getPropertyValue("padding-bottom"))+Number.parseFloat(o.getPropertyValue("padding-top")),l=Number.parseFloat(o.getPropertyValue("border-bottom-width"))+Number.parseFloat(o.getPropertyValue("border-top-width"));return{contextStyle:vbe.map(h=>[h,o.getPropertyValue(h)]),paddingSize:a,borderSize:l,boxSizing:s}}function k$(t,o=1,s){var a;xi||(xi=document.createElement("textarea"),document.body.appendChild(xi));const{paddingSize:l,borderSize:d,boxSizing:h,contextStyle:v}=gbe(t);v.forEach(([S,C])=>xi==null?void 0:xi.style.setProperty(S,C)),Object.entries(mbe).forEach(([S,C])=>xi==null?void 0:xi.style.setProperty(S,C,"important")),xi.value=t.value||t.placeholder||"";let g=xi.scrollHeight;const E={};h==="border-box"?g=g+d:h==="content-box"&&(g=g-l),xi.value="";const b=xi.scrollHeight-l;if($t(o)){let S=b*o;h==="border-box"&&(S=S+l+d),g=Math.max(S,g),E.minHeight=`${S}px`}if($t(s)){let S=b*s;h==="border-box"&&(S=S+l+d),g=Math.min(S,g)}return E.height=`${g}px`,(a=xi.parentNode)==null||a.removeChild(xi),xi=void 0,E}const lo=t=>t,_be=ut({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),Cs=t=>mc(_be,t),JN=ut({id:{type:String,default:void 0},size:Ho,disabled:Boolean,modelValue:{type:Re([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:Re([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:yr},prefixIcon:{type:yr},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:Re([Object,Array,String]),default:()=>lo({})},autofocus:Boolean,rows:{type:Number,default:2},...Cs(["ariaLabel"])}),Ebe={[Jt]:t=>Mt(t),input:t=>Mt(t),change:t=>Mt(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},ybe=["class","style"],bbe=/^on[A-Z]/,u_=(t={})=>{const{excludeListeners:o=!1,excludeKeys:s}=t,a=U(()=>((s==null?void 0:s.value)||[]).concat(ybe)),l=mn();return U(l?()=>{var d;return xg(Object.entries((d=l.proxy)==null?void 0:d.$attrs).filter(([h])=>!a.value.includes(h)&&!(o&&bbe.test(h))))}:()=>({}))},Kh=Symbol("formContextKey"),fl=Symbol("formItemContextKey"),P$={prefix:Math.floor(Math.random()*1e4),current:0},Sbe=Symbol("elIdInjection"),ZN=()=>mn()?It(Sbe,P$):P$,Ts=t=>{const o=ZN(),s=CN();return YA(()=>p(t)||`${s.value}-id-${o.prefix}-${o.current++}`)},Vs=()=>{const t=It(Kh,void 0),o=It(fl,void 0);return{form:t,formItem:o}},Ka=(t,{formItemContext:o,disableIdGeneration:s,disableIdManagement:a})=>{s||(s=ee(!1)),a||(a=ee(!1));const l=ee();let d;const h=U(()=>{var v;return!!(!(t.label||t.ariaLabel)&&o&&o.inputIds&&((v=o.inputIds)==null?void 0:v.length)<=1)});return dn(()=>{d=ze([lr(t,"id"),s],([v,g])=>{const E=v??(g?void 0:Ts().value);E!==l.value&&(o!=null&&o.removeInputId&&(l.value&&o.removeInputId(l.value),!(a!=null&&a.value)&&!g&&E&&o.addInputId(E)),l.value=E)},{immediate:!0})}),iu(()=>{d&&d(),o!=null&&o.removeInputId&&l.value&&o.removeInputId(l.value)}),{isLabeledByFormItem:h,inputId:l}},SK=t=>{const o=mn();return U(()=>{var s,a;return(a=(s=o==null?void 0:o.proxy)==null?void 0:s.$props)==null?void 0:a[t]})},xo=(t,o={})=>{const s=ee(void 0),a=o.prop?s:SK("size"),l=o.global?s:lK(),d=o.form?{size:void 0}:It(Kh,void 0),h=o.formItem?{size:void 0}:It(fl,void 0);return U(()=>a.value||p(t)||(h==null?void 0:h.size)||(d==null?void 0:d.size)||l.value||"")},Fs=t=>{const o=SK("disabled"),s=It(Kh,void 0);return U(()=>o.value||p(t)||(s==null?void 0:s.disabled)||!1)};function _d(t,{beforeFocus:o,afterFocus:s,beforeBlur:a,afterBlur:l}={}){const d=mn(),{emit:h}=d,v=Mr(),g=ee(!1),E=C=>{Ft(o)&&o(C)||g.value||(g.value=!0,h("focus",C),s==null||s())},b=C=>{var w;Ft(a)&&a(C)||C.relatedTarget&&((w=v.value)!=null&&w.contains(C.relatedTarget))||(g.value=!1,h("blur",C),l==null||l())},S=()=>{var C,w;(C=v.value)!=null&&C.contains(document.activeElement)&&v.value!==document.activeElement||(w=t.value)==null||w.focus()};return ze(v,C=>{C&&C.setAttribute("tabindex","-1")}),gr(v,"focus",E,!0),gr(v,"blur",b,!0),gr(v,"click",S,!0),{isFocused:g,wrapperRef:v,handleFocus:E,handleBlur:b}}const Tbe=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t);function d_({afterComposition:t,emit:o}){const s=ee(!1),a=v=>{o==null||o("compositionstart",v),s.value=!0},l=v=>{var g;o==null||o("compositionupdate",v);const E=(g=v.target)==null?void 0:g.value,b=E[E.length-1]||"";s.value=!Tbe(b)},d=v=>{o==null||o("compositionend",v),s.value&&(s.value=!1,Vt(()=>t(v)))};return{isComposing:s,handleComposition:v=>{v.type==="compositionend"?d(v):l(v)},handleCompositionStart:a,handleCompositionUpdate:l,handleCompositionEnd:d}}function Cbe(t){let o;function s(){if(t.value==null)return;const{selectionStart:l,selectionEnd:d,value:h}=t.value;if(l==null||d==null)return;const v=h.slice(0,Math.max(0,l)),g=h.slice(Math.max(0,d));o={selectionStart:l,selectionEnd:d,value:h,beforeTxt:v,afterTxt:g}}function a(){if(t.value==null||o==null)return;const{value:l}=t.value,{beforeTxt:d,afterTxt:h,selectionStart:v}=o;if(d==null||h==null||v==null)return;let g=l.length;if(l.endsWith(h))g=l.length-h.length;else if(l.startsWith(d))g=d.length;else{const E=d[v-1],b=l.indexOf(E,v-1);b!==-1&&(g=b+1)}t.value.setSelectionRange(g,g)}return[s,a]}const wbe="ElInput",Rbe=me({name:wbe,inheritAttrs:!1}),Ibe=me({...Rbe,props:JN,emits:Ebe,setup(t,{expose:o,emit:s}){const a=t,l=au(),d=u_(),h=Jo(),v=U(()=>[a.type==="textarea"?R.b():I.b(),I.m(C.value),I.is("disabled",w.value),I.is("exceed",Ae.value),{[I.b("group")]:h.prepend||h.append,[I.m("prefix")]:h.prefix||a.prefixIcon,[I.m("suffix")]:h.suffix||a.suffixIcon||a.clearable||a.showPassword,[I.bm("suffix","password-clear")]:se.value&&J.value,[I.b("hidden")]:a.type==="hidden"},l.class]),g=U(()=>[I.e("wrapper"),I.is("focus",z.value)]),{form:E,formItem:b}=Vs(),{inputId:S}=Ka(a,{formItemContext:b}),C=xo(),w=Fs(),I=Qe("input"),R=Qe("textarea"),N=Mr(),O=Mr(),V=ee(!1),L=ee(!1),D=ee(),M=Mr(a.inputStyle),F=U(()=>N.value||O.value),{wrapperRef:W,isFocused:z,handleFocus:G,handleBlur:Y}=_d(F,{beforeFocus(){return w.value},afterBlur(){var qe;a.validateEvent&&((qe=b==null?void 0:b.validate)==null||qe.call(b,"blur").catch(wt=>void 0))}}),te=U(()=>{var qe;return(qe=E==null?void 0:E.statusIcon)!=null?qe:!1}),Z=U(()=>(b==null?void 0:b.validateState)||""),fe=U(()=>Z.value&&g0[Z.value]),Ee=U(()=>L.value?rbe:Iye),ae=U(()=>[l.style]),X=U(()=>[a.inputStyle,M.value,{resize:a.resize}]),ie=U(()=>Qo(a.modelValue)?"":String(a.modelValue)),se=U(()=>a.clearable&&!w.value&&!a.readonly&&!!ie.value&&(z.value||V.value)),J=U(()=>a.showPassword&&!w.value&&!!ie.value&&(!!ie.value||z.value)),pe=U(()=>a.showWordLimit&&!!a.maxlength&&(a.type==="text"||a.type==="textarea")&&!w.value&&!a.readonly&&!a.showPassword),be=U(()=>ie.value.length),Ae=U(()=>!!pe.value&&be.value>Number(a.maxlength)),_e=U(()=>!!h.suffix||!!a.suffixIcon||se.value||a.showPassword||pe.value||!!Z.value&&te.value),[Me,Fe]=Cbe(N);co(O,qe=>{if(He(),!pe.value||a.resize!=="both")return;const wt=qe[0],{width:qt}=wt.contentRect;D.value={right:`calc(100% - ${qt+15+6}px)`}});const Le=()=>{const{type:qe,autosize:wt}=a;if(!(!Vn||qe!=="textarea"||!O.value))if(wt){const qt=fn(wt)?wt.minRows:void 0,sn=fn(wt)?wt.maxRows:void 0,tn=k$(O.value,qt,sn);M.value={overflowY:"hidden",...tn},Vt(()=>{O.value.offsetHeight,M.value=tn})}else M.value={minHeight:k$(O.value).minHeight}},He=(qe=>{let wt=!1;return()=>{var qt;if(wt||!a.autosize)return;((qt=O.value)==null?void 0:qt.offsetParent)===null||(qe(),wt=!0)}})(Le),We=()=>{const qe=F.value,wt=a.formatter?a.formatter(ie.value):ie.value;!qe||qe.value===wt||(qe.value=wt)},yt=async qe=>{Me();let{value:wt}=qe.target;if(a.formatter&&a.parser&&(wt=a.parser(wt)),!ce.value){if(wt===ie.value){We();return}s(Jt,wt),s(cs,wt),await Vt(),We(),Fe()}},it=qe=>{let{value:wt}=qe.target;a.formatter&&a.parser&&(wt=a.parser(wt)),s(yn,wt)},{isComposing:ce,handleCompositionStart:Se,handleCompositionUpdate:je,handleCompositionEnd:tt}=d_({emit:s,afterComposition:yt}),et=()=>{Me(),L.value=!L.value,setTimeout(Fe)},Ge=()=>{var qe;return(qe=F.value)==null?void 0:qe.focus()},Xe=()=>{var qe;return(qe=F.value)==null?void 0:qe.blur()},Ye=qe=>{V.value=!1,s("mouseleave",qe)},ct=qe=>{V.value=!0,s("mouseenter",qe)},nt=qe=>{s("keydown",qe)},Ot=()=>{var qe;(qe=F.value)==null||qe.select()},_t=()=>{s(Jt,""),s(yn,""),s("clear"),s(cs,"")};return ze(()=>a.modelValue,()=>{var qe;Vt(()=>Le()),a.validateEvent&&((qe=b==null?void 0:b.validate)==null||qe.call(b,"change").catch(wt=>void 0))}),ze(ie,()=>We()),ze(()=>a.type,async()=>{await Vt(),We(),Le()}),dn(()=>{!a.formatter&&a.parser,We(),Vt(Le)}),o({input:N,textarea:O,ref:F,textareaStyle:X,autosize:lr(a,"autosize"),isComposing:ce,focus:Ge,blur:Xe,select:Ot,clear:_t,resizeTextarea:Le}),(qe,wt)=>($(),le("div",{class:K([p(v),{[p(I).bm("group","append")]:qe.$slots.append,[p(I).bm("group","prepend")]:qe.$slots.prepend}]),style:jt(p(ae)),onMouseenter:ct,onMouseleave:Ye},[De(" input "),qe.type!=="textarea"?($(),le(Ut,{key:0},[De(" prepend slot "),qe.$slots.prepend?($(),le("div",{key:0,class:K(p(I).be("group","prepend"))},[Ne(qe.$slots,"prepend")],2)):De("v-if",!0),ue("div",{ref_key:"wrapperRef",ref:W,class:K(p(g))},[De(" prefix slot "),qe.$slots.prefix||qe.prefixIcon?($(),le("span",{key:0,class:K(p(I).e("prefix"))},[ue("span",{class:K(p(I).e("prefix-inner"))},[Ne(qe.$slots,"prefix"),qe.prefixIcon?($(),Ve(p(Dt),{key:0,class:K(p(I).e("icon"))},{default:Ce(()=>[($(),Ve(gn(qe.prefixIcon)))]),_:1},8,["class"])):De("v-if",!0)],2)],2)):De("v-if",!0),ue("input",En({id:p(S),ref_key:"input",ref:N,class:p(I).e("inner")},p(d),{minlength:qe.minlength,maxlength:qe.maxlength,type:qe.showPassword?L.value?"text":"password":qe.type,disabled:p(w),readonly:qe.readonly,autocomplete:qe.autocomplete,tabindex:qe.tabindex,"aria-label":qe.ariaLabel,placeholder:qe.placeholder,style:qe.inputStyle,form:qe.form,autofocus:qe.autofocus,role:qe.containerRole,onCompositionstart:p(Se),onCompositionupdate:p(je),onCompositionend:p(tt),onInput:yt,onChange:it,onKeydown:nt}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),De(" suffix slot "),p(_e)?($(),le("span",{key:1,class:K(p(I).e("suffix"))},[ue("span",{class:K(p(I).e("suffix-inner"))},[!p(se)||!p(J)||!p(pe)?($(),le(Ut,{key:0},[Ne(qe.$slots,"suffix"),qe.suffixIcon?($(),Ve(p(Dt),{key:0,class:K(p(I).e("icon"))},{default:Ce(()=>[($(),Ve(gn(qe.suffixIcon)))]),_:1},8,["class"])):De("v-if",!0)],64)):De("v-if",!0),p(se)?($(),Ve(p(Dt),{key:1,class:K([p(I).e("icon"),p(I).e("clear")]),onMousedown:Gt(p(pr),["prevent"]),onClick:_t},{default:Ce(()=>[ge(p(du))]),_:1},8,["class","onMousedown"])):De("v-if",!0),p(J)?($(),Ve(p(Dt),{key:2,class:K([p(I).e("icon"),p(I).e("password")]),onClick:et},{default:Ce(()=>[($(),Ve(gn(p(Ee))))]),_:1},8,["class"])):De("v-if",!0),p(pe)?($(),le("span",{key:3,class:K(p(I).e("count"))},[ue("span",{class:K(p(I).e("count-inner"))},ot(p(be))+" / "+ot(qe.maxlength),3)],2)):De("v-if",!0),p(Z)&&p(fe)&&p(te)?($(),Ve(p(Dt),{key:4,class:K([p(I).e("icon"),p(I).e("validateIcon"),p(I).is("loading",p(Z)==="validating")])},{default:Ce(()=>[($(),Ve(gn(p(fe))))]),_:1},8,["class"])):De("v-if",!0)],2)],2)):De("v-if",!0)],2),De(" append slot "),qe.$slots.append?($(),le("div",{key:1,class:K(p(I).be("group","append"))},[Ne(qe.$slots,"append")],2)):De("v-if",!0)],64)):($(),le(Ut,{key:1},[De(" textarea "),ue("textarea",En({id:p(S),ref_key:"textarea",ref:O,class:[p(R).e("inner"),p(I).is("focus",p(z))]},p(d),{minlength:qe.minlength,maxlength:qe.maxlength,tabindex:qe.tabindex,disabled:p(w),readonly:qe.readonly,autocomplete:qe.autocomplete,style:p(X),"aria-label":qe.ariaLabel,placeholder:qe.placeholder,form:qe.form,autofocus:qe.autofocus,rows:qe.rows,role:qe.containerRole,onCompositionstart:p(Se),onCompositionupdate:p(je),onCompositionend:p(tt),onInput:yt,onFocus:p(G),onBlur:p(Y),onChange:it,onKeydown:nt}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),p(pe)?($(),le("span",{key:0,style:jt(D.value),class:K(p(I).e("count"))},ot(p(be))+" / "+ot(qe.maxlength),7)):De("v-if",!0)],64))],38))}});var Abe=dt(Ibe,[["__file","input.vue"]]);const ei=rn(Abe),fp=4,TK={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},Obe=({move:t,size:o,bar:s})=>({[s.size]:o,transform:`translate${s.axis}(${t}%)`}),QN=Symbol("scrollbarContextKey"),Nbe=ut({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),kbe="Thumb",Pbe=me({__name:"thumb",props:Nbe,setup(t){const o=t,s=It(QN),a=Qe("scrollbar");s||qo(kbe,"can not inject scrollbar context");const l=ee(),d=ee(),h=ee({}),v=ee(!1);let g=!1,E=!1,b=Vn?document.onselectstart:null;const S=U(()=>TK[o.vertical?"vertical":"horizontal"]),C=U(()=>Obe({size:o.size,move:o.move,bar:S.value})),w=U(()=>l.value[S.value.offset]**2/s.wrapElement[S.value.scrollSize]/o.ratio/d.value[S.value.offset]),I=F=>{var W;if(F.stopPropagation(),F.ctrlKey||[1,2].includes(F.button))return;(W=window.getSelection())==null||W.removeAllRanges(),N(F);const z=F.currentTarget;z&&(h.value[S.value.axis]=z[S.value.offset]-(F[S.value.client]-z.getBoundingClientRect()[S.value.direction]))},R=F=>{if(!d.value||!l.value||!s.wrapElement)return;const W=Math.abs(F.target.getBoundingClientRect()[S.value.direction]-F[S.value.client]),z=d.value[S.value.offset]/2,G=(W-z)*100*w.value/l.value[S.value.offset];s.wrapElement[S.value.scroll]=G*s.wrapElement[S.value.scrollSize]/100},N=F=>{F.stopImmediatePropagation(),g=!0,document.addEventListener("mousemove",O),document.addEventListener("mouseup",V),b=document.onselectstart,document.onselectstart=()=>!1},O=F=>{if(!l.value||!d.value||g===!1)return;const W=h.value[S.value.axis];if(!W)return;const z=(l.value.getBoundingClientRect()[S.value.direction]-F[S.value.client])*-1,G=d.value[S.value.offset]-W,Y=(z-G)*100*w.value/l.value[S.value.offset];s.wrapElement[S.value.scroll]=Y*s.wrapElement[S.value.scrollSize]/100},V=()=>{g=!1,h.value[S.value.axis]=0,document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",V),M(),E&&(v.value=!1)},L=()=>{E=!1,v.value=!!o.size},D=()=>{E=!0,v.value=g};Rr(()=>{M(),document.removeEventListener("mouseup",V)});const M=()=>{document.onselectstart!==b&&(document.onselectstart=b)};return gr(lr(s,"scrollbarElement"),"mousemove",L),gr(lr(s,"scrollbarElement"),"mouseleave",D),(F,W)=>($(),Ve(hs,{name:p(a).b("fade"),persisted:""},{default:Ce(()=>[ln(ue("div",{ref_key:"instance",ref:l,class:K([p(a).e("bar"),p(a).is(p(S).key)]),onMousedown:R},[ue("div",{ref_key:"thumb",ref:d,class:K(p(a).e("thumb")),style:jt(p(C)),onMousedown:I},null,38)],34),[[Wn,F.always||v.value]])]),_:1},8,["name"]))}});var D$=dt(Pbe,[["__file","thumb.vue"]]);const Dbe=ut({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),Lbe=me({__name:"bar",props:Dbe,setup(t,{expose:o}){const s=t,a=It(QN),l=ee(0),d=ee(0),h=ee(""),v=ee(""),g=ee(1),E=ee(1);return o({handleScroll:C=>{if(C){const w=C.offsetHeight-fp,I=C.offsetWidth-fp;d.value=C.scrollTop*100/w*g.value,l.value=C.scrollLeft*100/I*E.value}},update:()=>{const C=a==null?void 0:a.wrapElement;if(!C)return;const w=C.offsetHeight-fp,I=C.offsetWidth-fp,R=w**2/C.scrollHeight,N=I**2/C.scrollWidth,O=Math.max(R,s.minSize),V=Math.max(N,s.minSize);g.value=R/(w-R)/(O/(w-O)),E.value=N/(I-N)/(V/(I-V)),v.value=O+fp<w?`${O}px`:"",h.value=V+fp<I?`${V}px`:""}}),(C,w)=>($(),le(Ut,null,[ge(D$,{move:l.value,ratio:E.value,size:h.value,always:C.always},null,8,["move","ratio","size","always"]),ge(D$,{move:d.value,ratio:g.value,size:v.value,vertical:"",always:C.always},null,8,["move","ratio","size","always"])],64))}});var Mbe=dt(Lbe,[["__file","bar.vue"]]);const xbe=ut({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:Re([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...Cs(["ariaLabel","ariaOrientation"])}),Ube={scroll:({scrollTop:t,scrollLeft:o})=>[t,o].every($t)},Vbe="ElScrollbar",Fbe=me({name:Vbe}),Bbe=me({...Fbe,props:xbe,emits:Ube,setup(t,{expose:o,emit:s}){const a=t,l=Qe("scrollbar");let d,h,v=0,g=0;const E=ee(),b=ee(),S=ee(),C=ee(),w=U(()=>{const M={};return a.height&&(M.height=mo(a.height)),a.maxHeight&&(M.maxHeight=mo(a.maxHeight)),[a.wrapStyle,M]}),I=U(()=>[a.wrapClass,l.e("wrap"),{[l.em("wrap","hidden-default")]:!a.native}]),R=U(()=>[l.e("view"),a.viewClass]),N=()=>{var M;b.value&&((M=C.value)==null||M.handleScroll(b.value),v=b.value.scrollTop,g=b.value.scrollLeft,s("scroll",{scrollTop:b.value.scrollTop,scrollLeft:b.value.scrollLeft}))};function O(M,F){fn(M)?b.value.scrollTo(M):$t(M)&&$t(F)&&b.value.scrollTo(M,F)}const V=M=>{$t(M)&&(b.value.scrollTop=M)},L=M=>{$t(M)&&(b.value.scrollLeft=M)},D=()=>{var M;(M=C.value)==null||M.update()};return ze(()=>a.noresize,M=>{M?(d==null||d(),h==null||h()):({stop:d}=co(S,D),h=gr("resize",D))},{immediate:!0}),ze(()=>[a.maxHeight,a.height],()=>{a.native||Vt(()=>{var M;D(),b.value&&((M=C.value)==null||M.handleScroll(b.value))})}),wn(QN,er({scrollbarElement:E,wrapElement:b})),gN(()=>{b.value&&(b.value.scrollTop=v,b.value.scrollLeft=g)}),dn(()=>{a.native||Vt(()=>{D()})}),wc(()=>D()),o({wrapRef:b,update:D,scrollTo:O,setScrollTop:V,setScrollLeft:L,handleScroll:N}),(M,F)=>($(),le("div",{ref_key:"scrollbarRef",ref:E,class:K(p(l).b())},[ue("div",{ref_key:"wrapRef",ref:b,class:K(p(I)),style:jt(p(w)),tabindex:M.tabindex,onScroll:N},[($(),Ve(gn(M.tag),{id:M.id,ref_key:"resizeRef",ref:S,class:K(p(R)),style:jt(M.viewStyle),role:M.role,"aria-label":M.ariaLabel,"aria-orientation":M.ariaOrientation},{default:Ce(()=>[Ne(M.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),M.native?De("v-if",!0):($(),Ve(Mbe,{key:0,ref_key:"barRef",ref:C,always:M.always,"min-size":M.minSize},null,8,["always","min-size"]))],2))}});var jbe=dt(Bbe,[["__file","scrollbar.vue"]]);const gl=rn(jbe),ek=Symbol("popper"),CK=Symbol("popperContent"),wK=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],RK=ut({role:{type:String,values:wK,default:"tooltip"}}),$be=me({name:"ElPopper",inheritAttrs:!1}),Hbe=me({...$be,props:RK,setup(t,{expose:o}){const s=t,a=ee(),l=ee(),d=ee(),h=ee(),v=U(()=>s.role),g={triggerRef:a,popperInstanceRef:l,contentRef:d,referenceRef:h,role:v};return o(g),wn(ek,g),(E,b)=>Ne(E.$slots,"default")}});var Wbe=dt(Hbe,[["__file","popper.vue"]]);const IK=ut({arrowOffset:{type:Number,default:5}}),Kbe=me({name:"ElPopperArrow",inheritAttrs:!1}),Gbe=me({...Kbe,props:IK,setup(t,{expose:o}){const s=t,a=Qe("popper"),{arrowOffset:l,arrowRef:d,arrowStyle:h}=It(CK,void 0);return ze(()=>s.arrowOffset,v=>{l.value=v}),Rr(()=>{d.value=void 0}),o({arrowRef:d}),(v,g)=>($(),le("span",{ref_key:"arrowRef",ref:d,class:K(p(a).e("arrow")),style:jt(p(h)),"data-popper-arrow":""},null,6))}});var zbe=dt(Gbe,[["__file","arrow.vue"]]);const AK=ut({virtualRef:{type:Re(Object)},virtualTriggering:Boolean,onMouseenter:{type:Re(Function)},onMouseleave:{type:Re(Function)},onClick:{type:Re(Function)},onKeydown:{type:Re(Function)},onFocus:{type:Re(Function)},onBlur:{type:Re(Function)},onContextmenu:{type:Re(Function)},id:String,open:Boolean}),OK=Symbol("elForwardRef"),Ybe=t=>{wn(OK,{setForwardRef:s=>{t.value=s}})},qbe=t=>({mounted(o){t(o)},updated(o){t(o)},unmounted(){t(null)}}),Xbe='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',Jbe=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,L$=t=>Array.from(t.querySelectorAll(Xbe)).filter(o=>TS(o)&&Jbe(o)),TS=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.tabIndex<0||t.hasAttribute("disabled")||t.getAttribute("aria-disabled")==="true")return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},Hb=function(t,o,...s){let a;o.includes("mouse")||o.includes("click")?a="MouseEvents":o.includes("key")?a="KeyboardEvent":a="HTMLEvents";const l=document.createEvent(a);return l.initEvent(o,...s),t.dispatchEvent(l),t},NK=t=>!t.getAttribute("aria-owns"),kK=(t,o,s)=>{const{parentNode:a}=t;if(!a)return null;const l=a.querySelectorAll(s),d=Array.prototype.indexOf.call(l,t);return l[d+o]||null},Wb=t=>{t&&(t.focus(),!NK(t)&&t.click())},Zbe="ElOnlyChild",PK=me({name:Zbe,setup(t,{slots:o,attrs:s}){var a;const l=It(OK),d=qbe((a=l==null?void 0:l.setForwardRef)!=null?a:pr);return()=>{var h;const v=(h=o.default)==null?void 0:h.call(o,s);if(!v||v.length>1)return null;const g=DK(v);return g?ln(eu(g,s),[[d]]):null}}});function DK(t){if(!t)return null;const o=t;for(const s of o){if(fn(s))switch(s.type){case is:continue;case cm:case"svg":return M$(s);case Ut:return DK(s.children);default:return s}return M$(s)}return null}function M$(t){const o=Qe("only-child");return ge("span",{class:o.e("content")},[t])}const Qbe=me({name:"ElPopperTrigger",inheritAttrs:!1}),eSe=me({...Qbe,props:AK,setup(t,{expose:o}){const s=t,{role:a,triggerRef:l}=It(ek,void 0);Ybe(l);const d=U(()=>v.value?s.id:void 0),h=U(()=>{if(a&&a.value==="tooltip")return s.open&&s.id?s.id:void 0}),v=U(()=>{if(a&&a.value!=="tooltip")return a.value}),g=U(()=>v.value?`${s.open}`:void 0);let E;const b=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return dn(()=>{ze(()=>s.virtualRef,S=>{S&&(l.value=pi(S))},{immediate:!0}),ze(l,(S,C)=>{E==null||E(),E=void 0,mi(S)&&(b.forEach(w=>{var I;const R=s[w];R&&(S.addEventListener(w.slice(2).toLowerCase(),R),(I=C==null?void 0:C.removeEventListener)==null||I.call(C,w.slice(2).toLowerCase(),R))}),TS(S)&&(E=ze([d,h,v,g],w=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((I,R)=>{Qo(w[R])?S.removeAttribute(I):S.setAttribute(I,w[R])})},{immediate:!0}))),mi(C)&&TS(C)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(w=>C.removeAttribute(w))},{immediate:!0})}),Rr(()=>{if(E==null||E(),E=void 0,l.value&&mi(l.value)){const S=l.value;b.forEach(C=>{const w=s[C];w&&S.removeEventListener(C.slice(2).toLowerCase(),w)}),l.value=void 0}}),o({triggerRef:l}),(S,C)=>S.virtualTriggering?De("v-if",!0):($(),Ve(p(PK),En({key:0},S.$attrs,{"aria-controls":p(d),"aria-describedby":p(h),"aria-expanded":p(g),"aria-haspopup":p(v)}),{default:Ce(()=>[Ne(S.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var tSe=dt(eSe,[["__file","trigger.vue"]]);const nA="focus-trap.focus-after-trapped",rA="focus-trap.focus-after-released",nSe="focus-trap.focusout-prevented",x$={cancelable:!0,bubbles:!1},rSe={cancelable:!0,bubbles:!1},U$="focusAfterTrapped",V$="focusAfterReleased",tk=Symbol("elFocusTrap"),nk=ee(),E0=ee(0),rk=ee(0);let Cb=0;const LK=t=>{const o=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const l=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||l?NodeFilter.FILTER_SKIP:a.tabIndex>=0||a===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)o.push(s.currentNode);return o},F$=(t,o)=>{for(const s of t)if(!oSe(s,o))return s},oSe=(t,o)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(o&&t===o)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},sSe=t=>{const o=LK(t),s=F$(o,t),a=F$(o.reverse(),t);return[s,a]},iSe=t=>t instanceof HTMLInputElement&&"select"in t,Kl=(t,o)=>{if(t&&t.focus){const s=document.activeElement;let a=!1;mi(t)&&!TS(t)&&!t.getAttribute("tabindex")&&(t.setAttribute("tabindex","-1"),a=!0),t.focus({preventScroll:!0}),rk.value=window.performance.now(),t!==s&&iSe(t)&&o&&t.select(),mi(t)&&a&&t.removeAttribute("tabindex")}};function B$(t,o){const s=[...t],a=t.indexOf(o);return a!==-1&&s.splice(a,1),s}const aSe=()=>{let t=[];return{push:a=>{const l=t[0];l&&a!==l&&l.pause(),t=B$(t,a),t.unshift(a)},remove:a=>{var l,d;t=B$(t,a),(d=(l=t[0])==null?void 0:l.resume)==null||d.call(l)}}},cSe=(t,o=!1)=>{const s=document.activeElement;for(const a of t)if(Kl(a,o),document.activeElement!==s)return},j$=aSe(),lSe=()=>E0.value>rk.value,wb=()=>{nk.value="pointer",E0.value=window.performance.now()},$$=()=>{nk.value="keyboard",E0.value=window.performance.now()},uSe=()=>(dn(()=>{Cb===0&&(document.addEventListener("mousedown",wb),document.addEventListener("touchstart",wb),document.addEventListener("keydown",$$)),Cb++}),Rr(()=>{Cb--,Cb<=0&&(document.removeEventListener("mousedown",wb),document.removeEventListener("touchstart",wb),document.removeEventListener("keydown",$$))}),{focusReason:nk,lastUserFocusTimestamp:E0,lastAutomatedFocusTimestamp:rk}),Rb=t=>new CustomEvent(nSe,{...rSe,detail:t}),Ct={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let yp=[];const H$=t=>{t.code===Ct.esc&&yp.forEach(o=>o(t))},dSe=t=>{dn(()=>{yp.length===0&&document.addEventListener("keydown",H$),Vn&&yp.push(t)}),Rr(()=>{yp=yp.filter(o=>o!==t),yp.length===0&&Vn&&document.removeEventListener("keydown",H$)})},hSe=me({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[U$,V$,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:o}){const s=ee();let a,l;const{focusReason:d}=uSe();dSe(I=>{t.trapped&&!h.paused&&o("release-requested",I)});const h={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},v=I=>{if(!t.loop&&!t.trapped||h.paused)return;const{code:R,altKey:N,ctrlKey:O,metaKey:V,currentTarget:L,shiftKey:D}=I,{loop:M}=t,F=R===Ct.tab&&!N&&!O&&!V,W=document.activeElement;if(F&&W){const z=L,[G,Y]=sSe(z);if(G&&Y){if(!D&&W===Y){const Z=Rb({focusReason:d.value});o("focusout-prevented",Z),Z.defaultPrevented||(I.preventDefault(),M&&Kl(G,!0))}else if(D&&[G,z].includes(W)){const Z=Rb({focusReason:d.value});o("focusout-prevented",Z),Z.defaultPrevented||(I.preventDefault(),M&&Kl(Y,!0))}}else if(W===z){const Z=Rb({focusReason:d.value});o("focusout-prevented",Z),Z.defaultPrevented||I.preventDefault()}}};wn(tk,{focusTrapRef:s,onKeydown:v}),ze(()=>t.focusTrapEl,I=>{I&&(s.value=I)},{immediate:!0}),ze([s],([I],[R])=>{I&&(I.addEventListener("keydown",v),I.addEventListener("focusin",b),I.addEventListener("focusout",S)),R&&(R.removeEventListener("keydown",v),R.removeEventListener("focusin",b),R.removeEventListener("focusout",S))});const g=I=>{o(U$,I)},E=I=>o(V$,I),b=I=>{const R=p(s);if(!R)return;const N=I.target,O=I.relatedTarget,V=N&&R.contains(N);t.trapped||O&&R.contains(O)||(a=O),V&&o("focusin",I),!h.paused&&t.trapped&&(V?l=N:Kl(l,!0))},S=I=>{const R=p(s);if(!(h.paused||!R))if(t.trapped){const N=I.relatedTarget;!Qo(N)&&!R.contains(N)&&setTimeout(()=>{if(!h.paused&&t.trapped){const O=Rb({focusReason:d.value});o("focusout-prevented",O),O.defaultPrevented||Kl(l,!0)}},0)}else{const N=I.target;N&&R.contains(N)||o("focusout",I)}};async function C(){await Vt();const I=p(s);if(I){j$.push(h);const R=I.contains(document.activeElement)?a:document.activeElement;if(a=R,!I.contains(R)){const O=new Event(nA,x$);I.addEventListener(nA,g),I.dispatchEvent(O),O.defaultPrevented||Vt(()=>{let V=t.focusStartEl;Mt(V)||(Kl(V),document.activeElement!==V&&(V="first")),V==="first"&&cSe(LK(I),!0),(document.activeElement===R||V==="container")&&Kl(I)})}}}function w(){const I=p(s);if(I){I.removeEventListener(nA,g);const R=new CustomEvent(rA,{...x$,detail:{focusReason:d.value}});I.addEventListener(rA,E),I.dispatchEvent(R),!R.defaultPrevented&&(d.value=="keyboard"||!lSe()||I.contains(document.activeElement))&&Kl(a??document.body),I.removeEventListener(rA,E),j$.remove(h)}}return dn(()=>{t.trapped&&C(),ze(()=>t.trapped,I=>{I?C():w()})}),Rr(()=>{t.trapped&&w(),s.value&&(s.value.removeEventListener("keydown",v),s.value.removeEventListener("focusin",b),s.value.removeEventListener("focusout",S),s.value=void 0)}),{onKeydown:v}}});function fSe(t,o,s,a,l,d){return Ne(t.$slots,"default",{handleKeydown:t.onKeydown})}var mm=dt(hSe,[["render",fSe],["__file","focus-trap.vue"]]),Bi="top",$a="bottom",Ha="right",ji="left",ok="auto",h_=[Bi,$a,Ha,ji],Gp="start",Ug="end",pSe="clippingParents",MK="viewport",Jv="popper",mSe="reference",W$=h_.reduce(function(t,o){return t.concat([o+"-"+Gp,o+"-"+Ug])},[]),hu=[].concat(h_,[ok]).reduce(function(t,o){return t.concat([o,o+"-"+Gp,o+"-"+Ug])},[]),vSe="beforeRead",gSe="read",_Se="afterRead",ESe="beforeMain",ySe="main",bSe="afterMain",SSe="beforeWrite",TSe="write",CSe="afterWrite",wSe=[vSe,gSe,_Se,ESe,ySe,bSe,SSe,TSe,CSe];function pl(t){return t?(t.nodeName||"").toLowerCase():null}function Ac(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var o=t.ownerDocument;return o&&o.defaultView||window}return t}function zp(t){var o=Ac(t).Element;return t instanceof o||t instanceof Element}function Ba(t){var o=Ac(t).HTMLElement;return t instanceof o||t instanceof HTMLElement}function sk(t){if(typeof ShadowRoot>"u")return!1;var o=Ac(t).ShadowRoot;return t instanceof o||t instanceof ShadowRoot}function RSe(t){var o=t.state;Object.keys(o.elements).forEach(function(s){var a=o.styles[s]||{},l=o.attributes[s]||{},d=o.elements[s];!Ba(d)||!pl(d)||(Object.assign(d.style,a),Object.keys(l).forEach(function(h){var v=l[h];v===!1?d.removeAttribute(h):d.setAttribute(h,v===!0?"":v)}))})}function ISe(t){var o=t.state,s={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(o.elements.popper.style,s.popper),o.styles=s,o.elements.arrow&&Object.assign(o.elements.arrow.style,s.arrow),function(){Object.keys(o.elements).forEach(function(a){var l=o.elements[a],d=o.attributes[a]||{},h=Object.keys(o.styles.hasOwnProperty(a)?o.styles[a]:s[a]),v=h.reduce(function(g,E){return g[E]="",g},{});!Ba(l)||!pl(l)||(Object.assign(l.style,v),Object.keys(d).forEach(function(g){l.removeAttribute(g)}))})}}var xK={name:"applyStyles",enabled:!0,phase:"write",fn:RSe,effect:ISe,requires:["computeStyles"]};function cl(t){return t.split("-")[0]}var Ah=Math.max,CS=Math.min,Yp=Math.round;function qp(t,o){o===void 0&&(o=!1);var s=t.getBoundingClientRect(),a=1,l=1;if(Ba(t)&&o){var d=t.offsetHeight,h=t.offsetWidth;h>0&&(a=Yp(s.width)/h||1),d>0&&(l=Yp(s.height)/d||1)}return{width:s.width/a,height:s.height/l,top:s.top/l,right:s.right/a,bottom:s.bottom/l,left:s.left/a,x:s.left/a,y:s.top/l}}function ik(t){var o=qp(t),s=t.offsetWidth,a=t.offsetHeight;return Math.abs(o.width-s)<=1&&(s=o.width),Math.abs(o.height-a)<=1&&(a=o.height),{x:t.offsetLeft,y:t.offsetTop,width:s,height:a}}function UK(t,o){var s=o.getRootNode&&o.getRootNode();if(t.contains(o))return!0;if(s&&sk(s)){var a=o;do{if(a&&t.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function tu(t){return Ac(t).getComputedStyle(t)}function ASe(t){return["table","td","th"].indexOf(pl(t))>=0}function Ed(t){return((zp(t)?t.ownerDocument:t.document)||window.document).documentElement}function y0(t){return pl(t)==="html"?t:t.assignedSlot||t.parentNode||(sk(t)?t.host:null)||Ed(t)}function K$(t){return!Ba(t)||tu(t).position==="fixed"?null:t.offsetParent}function OSe(t){var o=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,s=navigator.userAgent.indexOf("Trident")!==-1;if(s&&Ba(t)){var a=tu(t);if(a.position==="fixed")return null}var l=y0(t);for(sk(l)&&(l=l.host);Ba(l)&&["html","body"].indexOf(pl(l))<0;){var d=tu(l);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||o&&d.willChange==="filter"||o&&d.filter&&d.filter!=="none")return l;l=l.parentNode}return null}function f_(t){for(var o=Ac(t),s=K$(t);s&&ASe(s)&&tu(s).position==="static";)s=K$(s);return s&&(pl(s)==="html"||pl(s)==="body"&&tu(s).position==="static")?o:s||OSe(t)||o}function ak(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function gg(t,o,s){return Ah(t,CS(o,s))}function NSe(t,o,s){var a=gg(t,o,s);return a>s?s:a}function VK(){return{top:0,right:0,bottom:0,left:0}}function FK(t){return Object.assign({},VK(),t)}function BK(t,o){return o.reduce(function(s,a){return s[a]=t,s},{})}var kSe=function(t,o){return t=typeof t=="function"?t(Object.assign({},o.rects,{placement:o.placement})):t,FK(typeof t!="number"?t:BK(t,h_))};function PSe(t){var o,s=t.state,a=t.name,l=t.options,d=s.elements.arrow,h=s.modifiersData.popperOffsets,v=cl(s.placement),g=ak(v),E=[ji,Ha].indexOf(v)>=0,b=E?"height":"width";if(!(!d||!h)){var S=kSe(l.padding,s),C=ik(d),w=g==="y"?Bi:ji,I=g==="y"?$a:Ha,R=s.rects.reference[b]+s.rects.reference[g]-h[g]-s.rects.popper[b],N=h[g]-s.rects.reference[g],O=f_(d),V=O?g==="y"?O.clientHeight||0:O.clientWidth||0:0,L=R/2-N/2,D=S[w],M=V-C[b]-S[I],F=V/2-C[b]/2+L,W=gg(D,F,M),z=g;s.modifiersData[a]=(o={},o[z]=W,o.centerOffset=W-F,o)}}function DSe(t){var o=t.state,s=t.options,a=s.element,l=a===void 0?"[data-popper-arrow]":a;l!=null&&(typeof l=="string"&&(l=o.elements.popper.querySelector(l),!l)||!UK(o.elements.popper,l)||(o.elements.arrow=l))}var LSe={name:"arrow",enabled:!0,phase:"main",fn:PSe,effect:DSe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Xp(t){return t.split("-")[1]}var MSe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function xSe(t){var o=t.x,s=t.y,a=window,l=a.devicePixelRatio||1;return{x:Yp(o*l)/l||0,y:Yp(s*l)/l||0}}function G$(t){var o,s=t.popper,a=t.popperRect,l=t.placement,d=t.variation,h=t.offsets,v=t.position,g=t.gpuAcceleration,E=t.adaptive,b=t.roundOffsets,S=t.isFixed,C=h.x,w=C===void 0?0:C,I=h.y,R=I===void 0?0:I,N=typeof b=="function"?b({x:w,y:R}):{x:w,y:R};w=N.x,R=N.y;var O=h.hasOwnProperty("x"),V=h.hasOwnProperty("y"),L=ji,D=Bi,M=window;if(E){var F=f_(s),W="clientHeight",z="clientWidth";if(F===Ac(s)&&(F=Ed(s),tu(F).position!=="static"&&v==="absolute"&&(W="scrollHeight",z="scrollWidth")),F=F,l===Bi||(l===ji||l===Ha)&&d===Ug){D=$a;var G=S&&F===M&&M.visualViewport?M.visualViewport.height:F[W];R-=G-a.height,R*=g?1:-1}if(l===ji||(l===Bi||l===$a)&&d===Ug){L=Ha;var Y=S&&F===M&&M.visualViewport?M.visualViewport.width:F[z];w-=Y-a.width,w*=g?1:-1}}var te=Object.assign({position:v},E&&MSe),Z=b===!0?xSe({x:w,y:R}):{x:w,y:R};if(w=Z.x,R=Z.y,g){var fe;return Object.assign({},te,(fe={},fe[D]=V?"0":"",fe[L]=O?"0":"",fe.transform=(M.devicePixelRatio||1)<=1?"translate("+w+"px, "+R+"px)":"translate3d("+w+"px, "+R+"px, 0)",fe))}return Object.assign({},te,(o={},o[D]=V?R+"px":"",o[L]=O?w+"px":"",o.transform="",o))}function USe(t){var o=t.state,s=t.options,a=s.gpuAcceleration,l=a===void 0?!0:a,d=s.adaptive,h=d===void 0?!0:d,v=s.roundOffsets,g=v===void 0?!0:v,E={placement:cl(o.placement),variation:Xp(o.placement),popper:o.elements.popper,popperRect:o.rects.popper,gpuAcceleration:l,isFixed:o.options.strategy==="fixed"};o.modifiersData.popperOffsets!=null&&(o.styles.popper=Object.assign({},o.styles.popper,G$(Object.assign({},E,{offsets:o.modifiersData.popperOffsets,position:o.options.strategy,adaptive:h,roundOffsets:g})))),o.modifiersData.arrow!=null&&(o.styles.arrow=Object.assign({},o.styles.arrow,G$(Object.assign({},E,{offsets:o.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-placement":o.placement})}var jK={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:USe,data:{}},Ib={passive:!0};function VSe(t){var o=t.state,s=t.instance,a=t.options,l=a.scroll,d=l===void 0?!0:l,h=a.resize,v=h===void 0?!0:h,g=Ac(o.elements.popper),E=[].concat(o.scrollParents.reference,o.scrollParents.popper);return d&&E.forEach(function(b){b.addEventListener("scroll",s.update,Ib)}),v&&g.addEventListener("resize",s.update,Ib),function(){d&&E.forEach(function(b){b.removeEventListener("scroll",s.update,Ib)}),v&&g.removeEventListener("resize",s.update,Ib)}}var $K={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:VSe,data:{}},FSe={left:"right",right:"left",bottom:"top",top:"bottom"};function Kb(t){return t.replace(/left|right|bottom|top/g,function(o){return FSe[o]})}var BSe={start:"end",end:"start"};function z$(t){return t.replace(/start|end/g,function(o){return BSe[o]})}function ck(t){var o=Ac(t),s=o.pageXOffset,a=o.pageYOffset;return{scrollLeft:s,scrollTop:a}}function lk(t){return qp(Ed(t)).left+ck(t).scrollLeft}function jSe(t){var o=Ac(t),s=Ed(t),a=o.visualViewport,l=s.clientWidth,d=s.clientHeight,h=0,v=0;return a&&(l=a.width,d=a.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(h=a.offsetLeft,v=a.offsetTop)),{width:l,height:d,x:h+lk(t),y:v}}function $Se(t){var o,s=Ed(t),a=ck(t),l=(o=t.ownerDocument)==null?void 0:o.body,d=Ah(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),h=Ah(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),v=-a.scrollLeft+lk(t),g=-a.scrollTop;return tu(l||s).direction==="rtl"&&(v+=Ah(s.clientWidth,l?l.clientWidth:0)-d),{width:d,height:h,x:v,y:g}}function uk(t){var o=tu(t),s=o.overflow,a=o.overflowX,l=o.overflowY;return/auto|scroll|overlay|hidden/.test(s+l+a)}function HK(t){return["html","body","#document"].indexOf(pl(t))>=0?t.ownerDocument.body:Ba(t)&&uk(t)?t:HK(y0(t))}function _g(t,o){var s;o===void 0&&(o=[]);var a=HK(t),l=a===((s=t.ownerDocument)==null?void 0:s.body),d=Ac(a),h=l?[d].concat(d.visualViewport||[],uk(a)?a:[]):a,v=o.concat(h);return l?v:v.concat(_g(y0(h)))}function XA(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function HSe(t){var o=qp(t);return o.top=o.top+t.clientTop,o.left=o.left+t.clientLeft,o.bottom=o.top+t.clientHeight,o.right=o.left+t.clientWidth,o.width=t.clientWidth,o.height=t.clientHeight,o.x=o.left,o.y=o.top,o}function Y$(t,o){return o===MK?XA(jSe(t)):zp(o)?HSe(o):XA($Se(Ed(t)))}function WSe(t){var o=_g(y0(t)),s=["absolute","fixed"].indexOf(tu(t).position)>=0,a=s&&Ba(t)?f_(t):t;return zp(a)?o.filter(function(l){return zp(l)&&UK(l,a)&&pl(l)!=="body"}):[]}function KSe(t,o,s){var a=o==="clippingParents"?WSe(t):[].concat(o),l=[].concat(a,[s]),d=l[0],h=l.reduce(function(v,g){var E=Y$(t,g);return v.top=Ah(E.top,v.top),v.right=CS(E.right,v.right),v.bottom=CS(E.bottom,v.bottom),v.left=Ah(E.left,v.left),v},Y$(t,d));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function WK(t){var o=t.reference,s=t.element,a=t.placement,l=a?cl(a):null,d=a?Xp(a):null,h=o.x+o.width/2-s.width/2,v=o.y+o.height/2-s.height/2,g;switch(l){case Bi:g={x:h,y:o.y-s.height};break;case $a:g={x:h,y:o.y+o.height};break;case Ha:g={x:o.x+o.width,y:v};break;case ji:g={x:o.x-s.width,y:v};break;default:g={x:o.x,y:o.y}}var E=l?ak(l):null;if(E!=null){var b=E==="y"?"height":"width";switch(d){case Gp:g[E]=g[E]-(o[b]/2-s[b]/2);break;case Ug:g[E]=g[E]+(o[b]/2-s[b]/2);break}}return g}function Vg(t,o){o===void 0&&(o={});var s=o,a=s.placement,l=a===void 0?t.placement:a,d=s.boundary,h=d===void 0?pSe:d,v=s.rootBoundary,g=v===void 0?MK:v,E=s.elementContext,b=E===void 0?Jv:E,S=s.altBoundary,C=S===void 0?!1:S,w=s.padding,I=w===void 0?0:w,R=FK(typeof I!="number"?I:BK(I,h_)),N=b===Jv?mSe:Jv,O=t.rects.popper,V=t.elements[C?N:b],L=KSe(zp(V)?V:V.contextElement||Ed(t.elements.popper),h,g),D=qp(t.elements.reference),M=WK({reference:D,element:O,placement:l}),F=XA(Object.assign({},O,M)),W=b===Jv?F:D,z={top:L.top-W.top+R.top,bottom:W.bottom-L.bottom+R.bottom,left:L.left-W.left+R.left,right:W.right-L.right+R.right},G=t.modifiersData.offset;if(b===Jv&&G){var Y=G[l];Object.keys(z).forEach(function(te){var Z=[Ha,$a].indexOf(te)>=0?1:-1,fe=[Bi,$a].indexOf(te)>=0?"y":"x";z[te]+=Y[fe]*Z})}return z}function GSe(t,o){o===void 0&&(o={});var s=o,a=s.placement,l=s.boundary,d=s.rootBoundary,h=s.padding,v=s.flipVariations,g=s.allowedAutoPlacements,E=g===void 0?hu:g,b=Xp(a),S=b?v?W$:W$.filter(function(I){return Xp(I)===b}):h_,C=S.filter(function(I){return E.indexOf(I)>=0});C.length===0&&(C=S);var w=C.reduce(function(I,R){return I[R]=Vg(t,{placement:R,boundary:l,rootBoundary:d,padding:h})[cl(R)],I},{});return Object.keys(w).sort(function(I,R){return w[I]-w[R]})}function zSe(t){if(cl(t)===ok)return[];var o=Kb(t);return[z$(t),o,z$(o)]}function YSe(t){var o=t.state,s=t.options,a=t.name;if(!o.modifiersData[a]._skip){for(var l=s.mainAxis,d=l===void 0?!0:l,h=s.altAxis,v=h===void 0?!0:h,g=s.fallbackPlacements,E=s.padding,b=s.boundary,S=s.rootBoundary,C=s.altBoundary,w=s.flipVariations,I=w===void 0?!0:w,R=s.allowedAutoPlacements,N=o.options.placement,O=cl(N),V=O===N,L=g||(V||!I?[Kb(N)]:zSe(N)),D=[N].concat(L).reduce(function(Me,Fe){return Me.concat(cl(Fe)===ok?GSe(o,{placement:Fe,boundary:b,rootBoundary:S,padding:E,flipVariations:I,allowedAutoPlacements:R}):Fe)},[]),M=o.rects.reference,F=o.rects.popper,W=new Map,z=!0,G=D[0],Y=0;Y<D.length;Y++){var te=D[Y],Z=cl(te),fe=Xp(te)===Gp,Ee=[Bi,$a].indexOf(Z)>=0,ae=Ee?"width":"height",X=Vg(o,{placement:te,boundary:b,rootBoundary:S,altBoundary:C,padding:E}),ie=Ee?fe?Ha:ji:fe?$a:Bi;M[ae]>F[ae]&&(ie=Kb(ie));var se=Kb(ie),J=[];if(d&&J.push(X[Z]<=0),v&&J.push(X[ie]<=0,X[se]<=0),J.every(function(Me){return Me})){G=te,z=!1;break}W.set(te,J)}if(z)for(var pe=I?3:1,be=function(Me){var Fe=D.find(function(Le){var Pe=W.get(Le);if(Pe)return Pe.slice(0,Me).every(function(He){return He})});if(Fe)return G=Fe,"break"},Ae=pe;Ae>0;Ae--){var _e=be(Ae);if(_e==="break")break}o.placement!==G&&(o.modifiersData[a]._skip=!0,o.placement=G,o.reset=!0)}}var qSe={name:"flip",enabled:!0,phase:"main",fn:YSe,requiresIfExists:["offset"],data:{_skip:!1}};function q$(t,o,s){return s===void 0&&(s={x:0,y:0}),{top:t.top-o.height-s.y,right:t.right-o.width+s.x,bottom:t.bottom-o.height+s.y,left:t.left-o.width-s.x}}function X$(t){return[Bi,Ha,$a,ji].some(function(o){return t[o]>=0})}function XSe(t){var o=t.state,s=t.name,a=o.rects.reference,l=o.rects.popper,d=o.modifiersData.preventOverflow,h=Vg(o,{elementContext:"reference"}),v=Vg(o,{altBoundary:!0}),g=q$(h,a),E=q$(v,l,d),b=X$(g),S=X$(E);o.modifiersData[s]={referenceClippingOffsets:g,popperEscapeOffsets:E,isReferenceHidden:b,hasPopperEscaped:S},o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":S})}var JSe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:XSe};function ZSe(t,o,s){var a=cl(t),l=[ji,Bi].indexOf(a)>=0?-1:1,d=typeof s=="function"?s(Object.assign({},o,{placement:t})):s,h=d[0],v=d[1];return h=h||0,v=(v||0)*l,[ji,Ha].indexOf(a)>=0?{x:v,y:h}:{x:h,y:v}}function QSe(t){var o=t.state,s=t.options,a=t.name,l=s.offset,d=l===void 0?[0,0]:l,h=hu.reduce(function(b,S){return b[S]=ZSe(S,o.rects,d),b},{}),v=h[o.placement],g=v.x,E=v.y;o.modifiersData.popperOffsets!=null&&(o.modifiersData.popperOffsets.x+=g,o.modifiersData.popperOffsets.y+=E),o.modifiersData[a]=h}var e0e={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:QSe};function t0e(t){var o=t.state,s=t.name;o.modifiersData[s]=WK({reference:o.rects.reference,element:o.rects.popper,placement:o.placement})}var KK={name:"popperOffsets",enabled:!0,phase:"read",fn:t0e,data:{}};function n0e(t){return t==="x"?"y":"x"}function r0e(t){var o=t.state,s=t.options,a=t.name,l=s.mainAxis,d=l===void 0?!0:l,h=s.altAxis,v=h===void 0?!1:h,g=s.boundary,E=s.rootBoundary,b=s.altBoundary,S=s.padding,C=s.tether,w=C===void 0?!0:C,I=s.tetherOffset,R=I===void 0?0:I,N=Vg(o,{boundary:g,rootBoundary:E,padding:S,altBoundary:b}),O=cl(o.placement),V=Xp(o.placement),L=!V,D=ak(O),M=n0e(D),F=o.modifiersData.popperOffsets,W=o.rects.reference,z=o.rects.popper,G=typeof R=="function"?R(Object.assign({},o.rects,{placement:o.placement})):R,Y=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),te=o.modifiersData.offset?o.modifiersData.offset[o.placement]:null,Z={x:0,y:0};if(F){if(d){var fe,Ee=D==="y"?Bi:ji,ae=D==="y"?$a:Ha,X=D==="y"?"height":"width",ie=F[D],se=ie+N[Ee],J=ie-N[ae],pe=w?-z[X]/2:0,be=V===Gp?W[X]:z[X],Ae=V===Gp?-z[X]:-W[X],_e=o.elements.arrow,Me=w&&_e?ik(_e):{width:0,height:0},Fe=o.modifiersData["arrow#persistent"]?o.modifiersData["arrow#persistent"].padding:VK(),Le=Fe[Ee],Pe=Fe[ae],He=gg(0,W[X],Me[X]),We=L?W[X]/2-pe-He-Le-Y.mainAxis:be-He-Le-Y.mainAxis,yt=L?-W[X]/2+pe+He+Pe+Y.mainAxis:Ae+He+Pe+Y.mainAxis,it=o.elements.arrow&&f_(o.elements.arrow),ce=it?D==="y"?it.clientTop||0:it.clientLeft||0:0,Se=(fe=te==null?void 0:te[D])!=null?fe:0,je=ie+We-Se-ce,tt=ie+yt-Se,et=gg(w?CS(se,je):se,ie,w?Ah(J,tt):J);F[D]=et,Z[D]=et-ie}if(v){var Ge,Xe=D==="x"?Bi:ji,Ye=D==="x"?$a:Ha,ct=F[M],nt=M==="y"?"height":"width",Ot=ct+N[Xe],_t=ct-N[Ye],qe=[Bi,ji].indexOf(O)!==-1,wt=(Ge=te==null?void 0:te[M])!=null?Ge:0,qt=qe?Ot:ct-W[nt]-z[nt]-wt+Y.altAxis,sn=qe?ct+W[nt]+z[nt]-wt-Y.altAxis:_t,tn=w&&qe?NSe(qt,ct,sn):gg(w?qt:Ot,ct,w?sn:_t);F[M]=tn,Z[M]=tn-ct}o.modifiersData[a]=Z}}var o0e={name:"preventOverflow",enabled:!0,phase:"main",fn:r0e,requiresIfExists:["offset"]};function s0e(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function i0e(t){return t===Ac(t)||!Ba(t)?ck(t):s0e(t)}function a0e(t){var o=t.getBoundingClientRect(),s=Yp(o.width)/t.offsetWidth||1,a=Yp(o.height)/t.offsetHeight||1;return s!==1||a!==1}function c0e(t,o,s){s===void 0&&(s=!1);var a=Ba(o),l=Ba(o)&&a0e(o),d=Ed(o),h=qp(t,l),v={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(a||!a&&!s)&&((pl(o)!=="body"||uk(d))&&(v=i0e(o)),Ba(o)?(g=qp(o,!0),g.x+=o.clientLeft,g.y+=o.clientTop):d&&(g.x=lk(d))),{x:h.left+v.scrollLeft-g.x,y:h.top+v.scrollTop-g.y,width:h.width,height:h.height}}function l0e(t){var o=new Map,s=new Set,a=[];t.forEach(function(d){o.set(d.name,d)});function l(d){s.add(d.name);var h=[].concat(d.requires||[],d.requiresIfExists||[]);h.forEach(function(v){if(!s.has(v)){var g=o.get(v);g&&l(g)}}),a.push(d)}return t.forEach(function(d){s.has(d.name)||l(d)}),a}function u0e(t){var o=l0e(t);return wSe.reduce(function(s,a){return s.concat(o.filter(function(l){return l.phase===a}))},[])}function d0e(t){var o;return function(){return o||(o=new Promise(function(s){Promise.resolve().then(function(){o=void 0,s(t())})})),o}}function h0e(t){var o=t.reduce(function(s,a){var l=s[a.name];return s[a.name]=l?Object.assign({},l,a,{options:Object.assign({},l.options,a.options),data:Object.assign({},l.data,a.data)}):a,s},{});return Object.keys(o).map(function(s){return o[s]})}var J$={placement:"bottom",modifiers:[],strategy:"absolute"};function Z$(){for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return!o.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function dk(t){t===void 0&&(t={});var o=t,s=o.defaultModifiers,a=s===void 0?[]:s,l=o.defaultOptions,d=l===void 0?J$:l;return function(h,v,g){g===void 0&&(g=d);var E={placement:"bottom",orderedModifiers:[],options:Object.assign({},J$,d),modifiersData:{},elements:{reference:h,popper:v},attributes:{},styles:{}},b=[],S=!1,C={state:E,setOptions:function(R){var N=typeof R=="function"?R(E.options):R;I(),E.options=Object.assign({},d,E.options,N),E.scrollParents={reference:zp(h)?_g(h):h.contextElement?_g(h.contextElement):[],popper:_g(v)};var O=u0e(h0e([].concat(a,E.options.modifiers)));return E.orderedModifiers=O.filter(function(V){return V.enabled}),w(),C.update()},forceUpdate:function(){if(!S){var R=E.elements,N=R.reference,O=R.popper;if(Z$(N,O)){E.rects={reference:c0e(N,f_(O),E.options.strategy==="fixed"),popper:ik(O)},E.reset=!1,E.placement=E.options.placement,E.orderedModifiers.forEach(function(z){return E.modifiersData[z.name]=Object.assign({},z.data)});for(var V=0;V<E.orderedModifiers.length;V++){if(E.reset===!0){E.reset=!1,V=-1;continue}var L=E.orderedModifiers[V],D=L.fn,M=L.options,F=M===void 0?{}:M,W=L.name;typeof D=="function"&&(E=D({state:E,options:F,name:W,instance:C})||E)}}}},update:d0e(function(){return new Promise(function(R){C.forceUpdate(),R(E)})}),destroy:function(){I(),S=!0}};if(!Z$(h,v))return C;C.setOptions(g).then(function(R){!S&&g.onFirstUpdate&&g.onFirstUpdate(R)});function w(){E.orderedModifiers.forEach(function(R){var N=R.name,O=R.options,V=O===void 0?{}:O,L=R.effect;if(typeof L=="function"){var D=L({state:E,name:N,instance:C,options:V}),M=function(){};b.push(D||M)}})}function I(){b.forEach(function(R){return R()}),b=[]}return C}}dk();var f0e=[$K,KK,jK,xK];dk({defaultModifiers:f0e});var p0e=[$K,KK,jK,xK,e0e,qSe,o0e,LSe,JSe],m0e=dk({defaultModifiers:p0e});const v0e=["fixed","absolute"],g0e=ut({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:Re(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:hu,default:"bottom"},popperOptions:{type:Re(Object),default:()=>({})},strategy:{type:String,values:v0e,default:"absolute"}}),GK=ut({...g0e,id:String,style:{type:Re([String,Array,Object])},className:{type:Re([String,Array,Object])},effect:{type:Re(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:Re([String,Array,Object])},popperStyle:{type:Re([String,Array,Object])},referenceEl:{type:Re(Object)},triggerTargetEl:{type:Re(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...Cs(["ariaLabel"])}),_0e={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},E0e=(t,o)=>{const s=ee(!1),a=ee();return{focusStartRef:a,trapped:s,onFocusAfterReleased:E=>{var b;((b=E.detail)==null?void 0:b.focusReason)!=="pointer"&&(a.value="first",o("blur"))},onFocusAfterTrapped:()=>{o("focus")},onFocusInTrap:E=>{t.visible&&!s.value&&(E.target&&(a.value=E.target),s.value=!0)},onFocusoutPrevented:E=>{t.trapping||(E.detail.focusReason==="pointer"&&E.preventDefault(),s.value=!1)},onReleaseRequested:()=>{s.value=!1,o("close")}}},y0e=(t,o=[])=>{const{placement:s,strategy:a,popperOptions:l}=t,d={placement:s,strategy:a,...l,modifiers:[...S0e(t),...o]};return T0e(d,l==null?void 0:l.modifiers),d},b0e=t=>{if(Vn)return pi(t)};function S0e(t){const{offset:o,gpuAcceleration:s,fallbackPlacements:a}=t;return[{name:"offset",options:{offset:[0,o??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:a}},{name:"computeStyles",options:{gpuAcceleration:s}}]}function T0e(t,o){o&&(t.modifiers=[...t.modifiers,...o??[]])}const C0e=(t,o,s={})=>{const a={name:"updateState",enabled:!0,phase:"write",fn:({state:g})=>{const E=w0e(g);Object.assign(h.value,E)},requires:["computeStyles"]},l=U(()=>{const{onFirstUpdate:g,placement:E,strategy:b,modifiers:S}=p(s);return{onFirstUpdate:g,placement:E||"bottom",strategy:b||"absolute",modifiers:[...S||[],a,{name:"applyStyles",enabled:!1}]}}),d=Mr(),h=ee({styles:{popper:{position:p(l).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),v=()=>{d.value&&(d.value.destroy(),d.value=void 0)};return ze(l,g=>{const E=p(d);E&&E.setOptions(g)},{deep:!0}),ze([t,o],([g,E])=>{v(),!(!g||!E)&&(d.value=m0e(g,E,p(l)))}),Rr(()=>{v()}),{state:U(()=>{var g;return{...((g=p(d))==null?void 0:g.state)||{}}}),styles:U(()=>p(h).styles),attributes:U(()=>p(h).attributes),update:()=>{var g;return(g=p(d))==null?void 0:g.update()},forceUpdate:()=>{var g;return(g=p(d))==null?void 0:g.forceUpdate()},instanceRef:U(()=>p(d))}};function w0e(t){const o=Object.keys(t.elements),s=xg(o.map(l=>[l,t.styles[l]||{}])),a=xg(o.map(l=>[l,t.attributes[l]]));return{styles:s,attributes:a}}const R0e=0,I0e=t=>{const{popperInstanceRef:o,contentRef:s,triggerRef:a,role:l}=It(ek,void 0),d=ee(),h=ee(),v=U(()=>({name:"eventListeners",enabled:!!t.visible})),g=U(()=>{var O;const V=p(d),L=(O=p(h))!=null?O:R0e;return{name:"arrow",enabled:!XW(V),options:{element:V,padding:L}}}),E=U(()=>({onFirstUpdate:()=>{I()},...y0e(t,[p(g),p(v)])})),b=U(()=>b0e(t.referenceEl)||p(a)),{attributes:S,state:C,styles:w,update:I,forceUpdate:R,instanceRef:N}=C0e(b,s,E);return ze(N,O=>o.value=O),dn(()=>{ze(()=>{var O;return(O=p(b))==null?void 0:O.getBoundingClientRect()},()=>{I()})}),{attributes:S,arrowRef:d,contentRef:s,instanceRef:N,state:C,styles:w,role:l,forceUpdate:R,update:I}},A0e=(t,{attributes:o,styles:s,role:a})=>{const{nextZIndex:l}=fm(),d=Qe("popper"),h=U(()=>p(o).popper),v=ee($t(t.zIndex)?t.zIndex:l()),g=U(()=>[d.b(),d.is("pure",t.pure),d.is(t.effect),t.popperClass]),E=U(()=>[{zIndex:p(v)},p(s).popper,t.popperStyle||{}]),b=U(()=>a.value==="dialog"?"false":void 0),S=U(()=>p(s).arrow||{});return{ariaModal:b,arrowStyle:S,contentAttrs:h,contentClass:g,contentStyle:E,contentZIndex:v,updateZIndex:()=>{v.value=$t(t.zIndex)?t.zIndex:l()}}},O0e=me({name:"ElPopperContent"}),N0e=me({...O0e,props:GK,emits:_0e,setup(t,{expose:o,emit:s}){const a=t,{focusStartRef:l,trapped:d,onFocusAfterReleased:h,onFocusAfterTrapped:v,onFocusInTrap:g,onFocusoutPrevented:E,onReleaseRequested:b}=E0e(a,s),{attributes:S,arrowRef:C,contentRef:w,styles:I,instanceRef:R,role:N,update:O}=I0e(a),{ariaModal:V,arrowStyle:L,contentAttrs:D,contentClass:M,contentStyle:F,updateZIndex:W}=A0e(a,{styles:I,attributes:S,role:N}),z=It(fl,void 0),G=ee();wn(CK,{arrowStyle:L,arrowRef:C,arrowOffset:G}),z&&wn(fl,{...z,addInputId:pr,removeInputId:pr});let Y;const te=(fe=!0)=>{O(),fe&&W()},Z=()=>{te(!1),a.visible&&a.focusOnShow?d.value=!0:a.visible===!1&&(d.value=!1)};return dn(()=>{ze(()=>a.triggerTargetEl,(fe,Ee)=>{Y==null||Y(),Y=void 0;const ae=p(fe||w.value),X=p(Ee||w.value);mi(ae)&&(Y=ze([N,()=>a.ariaLabel,V,()=>a.id],ie=>{["role","aria-label","aria-modal","id"].forEach((se,J)=>{Qo(ie[J])?ae.removeAttribute(se):ae.setAttribute(se,ie[J])})},{immediate:!0})),X!==ae&&mi(X)&&["role","aria-label","aria-modal","id"].forEach(ie=>{X.removeAttribute(ie)})},{immediate:!0}),ze(()=>a.visible,Z,{immediate:!0})}),Rr(()=>{Y==null||Y(),Y=void 0}),o({popperContentRef:w,popperInstanceRef:R,updatePopper:te,contentStyle:F}),(fe,Ee)=>($(),le("div",En({ref_key:"contentRef",ref:w},p(D),{style:p(F),class:p(M),tabindex:"-1",onMouseenter:ae=>fe.$emit("mouseenter",ae),onMouseleave:ae=>fe.$emit("mouseleave",ae)}),[ge(p(mm),{trapped:p(d),"trap-on-focus-in":!0,"focus-trap-el":p(w),"focus-start-el":p(l),onFocusAfterTrapped:p(v),onFocusAfterReleased:p(h),onFocusin:p(g),onFocusoutPrevented:p(E),onReleaseRequested:p(b)},{default:Ce(()=>[Ne(fe.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var k0e=dt(N0e,[["__file","content.vue"]]);const zK=rn(Wbe),b0=Symbol("elTooltip");function Q$(){let t;const o=(a,l)=>{s(),t=window.setTimeout(a,l)},s=()=>window.clearTimeout(t);return c_(()=>s()),{registerTimeout:o,cancelTimeout:s}}const P0e=ut({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),D0e=({showAfter:t,hideAfter:o,autoClose:s,open:a,close:l})=>{const{registerTimeout:d}=Q$(),{registerTimeout:h,cancelTimeout:v}=Q$();return{onOpen:b=>{d(()=>{a(b);const S=p(s);$t(S)&&S>0&&h(()=>{l(b)},S)},p(t))},onClose:b=>{v(),d(()=>{l(b)},p(o))}}},ss=ut({...P0e,...GK,appendTo:{type:Re([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:Re(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...Cs(["ariaLabel"])}),Fg=ut({...AK,disabled:Boolean,trigger:{type:Re([String,Array]),default:"hover"},triggerKeys:{type:Re(Array),default:()=>[Ct.enter,Ct.numpadEnter,Ct.space]}}),L0e=Ic({type:Re(Boolean),default:null}),M0e=Ic({type:Re(Function)}),x0e=t=>{const o=`update:${t}`,s=`onUpdate:${t}`,a=[o],l={[t]:L0e,[s]:M0e};return{useModelToggle:({indicator:h,toggleReason:v,shouldHideWhenRouteChanges:g,shouldProceed:E,onShow:b,onHide:S})=>{const C=mn(),{emit:w}=C,I=C.props,R=U(()=>Ft(I[s])),N=U(()=>I[t]===null),O=W=>{h.value!==!0&&(h.value=!0,v&&(v.value=W),Ft(b)&&b(W))},V=W=>{h.value!==!1&&(h.value=!1,v&&(v.value=W),Ft(S)&&S(W))},L=W=>{if(I.disabled===!0||Ft(E)&&!E())return;const z=R.value&&Vn;z&&w(o,!0),(N.value||!z)&&O(W)},D=W=>{if(I.disabled===!0||!Vn)return;const z=R.value&&Vn;z&&w(o,!1),(N.value||!z)&&V(W)},M=W=>{wr(W)&&(I.disabled&&W?R.value&&w(o,!1):h.value!==W&&(W?O():V()))},F=()=>{h.value?D():L()};return ze(()=>I[t],M),g&&C.appContext.config.globalProperties.$route!==void 0&&ze(()=>({...C.proxy.$route}),()=>{g.value&&h.value&&D()}),dn(()=>{M(I[t])}),{hide:D,show:L,toggle:F,hasUpdateHandler:R}},useModelToggleProps:l,useModelToggleEmits:a}},{useModelToggleProps:U0e,useModelToggleEmits:V0e,useModelToggle:F0e}=x0e("visible"),B0e=ut({...RK,...U0e,...ss,...Fg,...IK,showArrow:{type:Boolean,default:!0}}),j0e=[...V0e,"before-show","before-hide","show","hide","open","close"],$0e=(t,o)=>st(t)?t.includes(o):t===o,pp=(t,o,s)=>a=>{$0e(p(t),o)&&s(a)},Eo=(t,o,{checkForDefaultPrevented:s=!0}={})=>l=>{const d=t==null?void 0:t(l);if(s===!1||!d)return o==null?void 0:o(l)},eH=t=>o=>o.pointerType==="mouse"?t(o):void 0,H0e=me({name:"ElTooltipTrigger"}),W0e=me({...H0e,props:Fg,setup(t,{expose:o}){const s=t,a=Qe("tooltip"),{controlled:l,id:d,open:h,onOpen:v,onClose:g,onToggle:E}=It(b0,void 0),b=ee(null),S=()=>{if(p(l)||s.disabled)return!0},C=lr(s,"trigger"),w=Eo(S,pp(C,"hover",v)),I=Eo(S,pp(C,"hover",g)),R=Eo(S,pp(C,"click",D=>{D.button===0&&E(D)})),N=Eo(S,pp(C,"focus",v)),O=Eo(S,pp(C,"focus",g)),V=Eo(S,pp(C,"contextmenu",D=>{D.preventDefault(),E(D)})),L=Eo(S,D=>{const{code:M}=D;s.triggerKeys.includes(M)&&(D.preventDefault(),E(D))});return o({triggerRef:b}),(D,M)=>($(),Ve(p(tSe),{id:p(d),"virtual-ref":D.virtualRef,open:p(h),"virtual-triggering":D.virtualTriggering,class:K(p(a).e("trigger")),onBlur:p(O),onClick:p(R),onContextmenu:p(V),onFocus:p(N),onMouseenter:p(w),onMouseleave:p(I),onKeydown:p(L)},{default:Ce(()=>[Ne(D.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var K0e=dt(W0e,[["__file","trigger.vue"]]);const G0e=ut({to:{type:Re([String,Object]),required:!0},disabled:Boolean}),z0e=me({__name:"teleport",props:G0e,setup(t){return(o,s)=>o.disabled?Ne(o.$slots,"default",{key:0}):($(),Ve(qde,{key:1,to:o.to},[Ne(o.$slots,"default")],8,["to"]))}});var Y0e=dt(z0e,[["__file","teleport.vue"]]);const vm=rn(Y0e),YK=()=>{const t=CN(),o=ZN(),s=U(()=>`${t.value}-popper-container-${o.prefix}`),a=U(()=>`#${s.value}`);return{id:s,selector:a}},q0e=t=>{const o=document.createElement("div");return o.id=t,document.body.appendChild(o),o},X0e=()=>{const{id:t,selector:o}=YK();return e0(()=>{Vn&&(document.body.querySelector(o.value)||q0e(t.value))}),{id:t,selector:o}},J0e=me({name:"ElTooltipContent",inheritAttrs:!1}),Z0e=me({...J0e,props:ss,setup(t,{expose:o}){const s=t,{selector:a}=YK(),l=Qe("tooltip"),d=ee();let h;const{controlled:v,id:g,open:E,trigger:b,onClose:S,onOpen:C,onShow:w,onHide:I,onBeforeShow:R,onBeforeHide:N}=It(b0,void 0),O=U(()=>s.transition||`${l.namespace.value}-fade-in-linear`),V=U(()=>s.persistent);Rr(()=>{h==null||h()});const L=U(()=>p(V)?!0:p(E)),D=U(()=>s.disabled?!1:p(E)),M=U(()=>s.appendTo||a.value),F=U(()=>{var ie;return(ie=s.style)!=null?ie:{}}),W=ee(!0),z=()=>{I(),X()&&Kl(document.body),W.value=!0},G=()=>{if(p(v))return!0},Y=Eo(G,()=>{s.enterable&&p(b)==="hover"&&C()}),te=Eo(G,()=>{p(b)==="hover"&&S()}),Z=()=>{var ie,se;(se=(ie=d.value)==null?void 0:ie.updatePopper)==null||se.call(ie),R==null||R()},fe=()=>{N==null||N()},Ee=()=>{w(),h=jN(U(()=>{var ie;return(ie=d.value)==null?void 0:ie.popperContentRef}),()=>{if(p(v))return;p(b)!=="hover"&&S()})},ae=()=>{s.virtualTriggering||S()},X=ie=>{var se;const J=(se=d.value)==null?void 0:se.popperContentRef,pe=(ie==null?void 0:ie.relatedTarget)||document.activeElement;return J==null?void 0:J.contains(pe)};return ze(()=>p(E),ie=>{ie?W.value=!1:h==null||h()},{flush:"post"}),ze(()=>s.content,()=>{var ie,se;(se=(ie=d.value)==null?void 0:ie.updatePopper)==null||se.call(ie)}),o({contentRef:d,isFocusInsideContent:X}),(ie,se)=>($(),Ve(p(vm),{disabled:!ie.teleported,to:p(M)},{default:Ce(()=>[ge(hs,{name:p(O),onAfterLeave:z,onBeforeEnter:Z,onAfterEnter:Ee,onBeforeLeave:fe},{default:Ce(()=>[p(L)?ln(($(),Ve(p(k0e),En({key:0,id:p(g),ref_key:"contentRef",ref:d},ie.$attrs,{"aria-label":ie.ariaLabel,"aria-hidden":W.value,"boundaries-padding":ie.boundariesPadding,"fallback-placements":ie.fallbackPlacements,"gpu-acceleration":ie.gpuAcceleration,offset:ie.offset,placement:ie.placement,"popper-options":ie.popperOptions,strategy:ie.strategy,effect:ie.effect,enterable:ie.enterable,pure:ie.pure,"popper-class":ie.popperClass,"popper-style":[ie.popperStyle,p(F)],"reference-el":ie.referenceEl,"trigger-target-el":ie.triggerTargetEl,visible:p(D),"z-index":ie.zIndex,onMouseenter:p(Y),onMouseleave:p(te),onBlur:ae,onClose:p(S)}),{default:Ce(()=>[Ne(ie.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Wn,p(D)]]):De("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var Q0e=dt(Z0e,[["__file","content.vue"]]);const eTe=me({name:"ElTooltip"}),tTe=me({...eTe,props:B0e,emits:j0e,setup(t,{expose:o,emit:s}){const a=t;X0e();const l=Ts(),d=ee(),h=ee(),v=()=>{var O;const V=p(d);V&&((O=V.popperInstanceRef)==null||O.update())},g=ee(!1),E=ee(),{show:b,hide:S,hasUpdateHandler:C}=F0e({indicator:g,toggleReason:E}),{onOpen:w,onClose:I}=D0e({showAfter:lr(a,"showAfter"),hideAfter:lr(a,"hideAfter"),autoClose:lr(a,"autoClose"),open:b,close:S}),R=U(()=>wr(a.visible)&&!C.value);wn(b0,{controlled:R,id:l,open:am(g),trigger:lr(a,"trigger"),onOpen:O=>{w(O)},onClose:O=>{I(O)},onToggle:O=>{p(g)?I(O):w(O)},onShow:()=>{s("show",E.value)},onHide:()=>{s("hide",E.value)},onBeforeShow:()=>{s("before-show",E.value)},onBeforeHide:()=>{s("before-hide",E.value)},updatePopper:v}),ze(()=>a.disabled,O=>{O&&g.value&&(g.value=!1)});const N=O=>{var V;return(V=h.value)==null?void 0:V.isFocusInsideContent(O)};return T5(()=>g.value&&S()),o({popperRef:d,contentRef:h,isFocusInsideContent:N,updatePopper:v,onOpen:w,onClose:I,hide:S}),(O,V)=>($(),Ve(p(zK),{ref_key:"popperRef",ref:d,role:O.role},{default:Ce(()=>[ge(K0e,{disabled:O.disabled,trigger:O.trigger,"trigger-keys":O.triggerKeys,"virtual-ref":O.virtualRef,"virtual-triggering":O.virtualTriggering},{default:Ce(()=>[O.$slots.default?Ne(O.$slots,"default",{key:0}):De("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),ge(Q0e,{ref_key:"contentRef",ref:h,"aria-label":O.ariaLabel,"boundaries-padding":O.boundariesPadding,content:O.content,disabled:O.disabled,effect:O.effect,enterable:O.enterable,"fallback-placements":O.fallbackPlacements,"hide-after":O.hideAfter,"gpu-acceleration":O.gpuAcceleration,offset:O.offset,persistent:O.persistent,"popper-class":O.popperClass,"popper-style":O.popperStyle,placement:O.placement,"popper-options":O.popperOptions,pure:O.pure,"raw-content":O.rawContent,"reference-el":O.referenceEl,"trigger-target-el":O.triggerTargetEl,"show-after":O.showAfter,strategy:O.strategy,teleported:O.teleported,transition:O.transition,"virtual-triggering":O.virtualTriggering,"z-index":O.zIndex,"append-to":O.appendTo},{default:Ce(()=>[Ne(O.$slots,"content",{},()=>[O.rawContent?($(),le("span",{key:0,innerHTML:O.content},null,8,["innerHTML"])):($(),le("span",{key:1},ot(O.content),1))]),O.showArrow?($(),Ve(p(zbe),{key:0,"arrow-offset":O.arrowOffset},null,8,["arrow-offset"])):De("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var nTe=dt(tTe,[["__file","tooltip.vue"]]);const Us=rn(nTe),rTe=ut({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:Re(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:Re([Function,Array]),default:pr},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:ss.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Cs(["ariaLabel"])}),oTe={[Jt]:t=>Mt(t),[cs]:t=>Mt(t),[yn]:t=>Mt(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,select:t=>fn(t)},qK="ElAutocomplete",sTe=me({name:qK,inheritAttrs:!1}),iTe=me({...sTe,props:rTe,emits:oTe,setup(t,{expose:o,emit:s}){const a=t,l=u_(),d=au(),h=Fs(),v=Qe("autocomplete"),g=ee(),E=ee(),b=ee(),S=ee();let C=!1,w=!1;const I=ee([]),R=ee(-1),N=ee(""),O=ee(!1),V=ee(!1),L=ee(!1),D=Ts(),M=U(()=>d.style),F=U(()=>(I.value.length>0||L.value)&&O.value),W=U(()=>!a.hideLoading&&L.value),z=U(()=>g.value?Array.from(g.value.$el.querySelectorAll("input")):[]),G=()=>{F.value&&(N.value=`${g.value.$el.offsetWidth}px`)},Y=()=>{R.value=-1},te=async Pe=>{if(V.value)return;const He=We=>{L.value=!1,!V.value&&(st(We)?(I.value=We,R.value=a.highlightFirstItem?0:-1):qo(qK,"autocomplete suggestions must be an array"))};if(L.value=!0,st(a.fetchSuggestions))He(a.fetchSuggestions);else{const We=await a.fetchSuggestions(Pe,He);st(We)&&He(We)}},Z=Hi(te,a.debounce),fe=Pe=>{const He=!!Pe;if(s(cs,Pe),s(Jt,Pe),V.value=!1,O.value||(O.value=He),!a.triggerOnFocus&&!Pe){V.value=!0,I.value=[];return}Z(Pe)},Ee=Pe=>{var He;h.value||(((He=Pe.target)==null?void 0:He.tagName)!=="INPUT"||z.value.includes(document.activeElement))&&(O.value=!0)},ae=Pe=>{s(yn,Pe)},X=Pe=>{w?w=!1:(O.value=!0,s("focus",Pe),a.triggerOnFocus&&!C&&Z(String(a.modelValue)))},ie=Pe=>{setTimeout(()=>{var He;if((He=b.value)!=null&&He.isFocusInsideContent()){w=!0;return}O.value&&be(),s("blur",Pe)})},se=()=>{O.value=!1,s(Jt,""),s("clear")},J=async()=>{F.value&&R.value>=0&&R.value<I.value.length?Me(I.value[R.value]):a.selectWhenUnmatched&&(s("select",{value:a.modelValue}),I.value=[],R.value=-1)},pe=Pe=>{F.value&&(Pe.preventDefault(),Pe.stopPropagation(),be())},be=()=>{O.value=!1},Ae=()=>{var Pe;(Pe=g.value)==null||Pe.focus()},_e=()=>{var Pe;(Pe=g.value)==null||Pe.blur()},Me=async Pe=>{s(cs,Pe[a.valueKey]),s(Jt,Pe[a.valueKey]),s("select",Pe),I.value=[],R.value=-1},Fe=Pe=>{if(!F.value||L.value)return;if(Pe<0){R.value=-1;return}Pe>=I.value.length&&(Pe=I.value.length-1);const He=E.value.querySelector(`.${v.be("suggestion","wrap")}`),yt=He.querySelectorAll(`.${v.be("suggestion","list")} li`)[Pe],it=He.scrollTop,{offsetTop:ce,scrollHeight:Se}=yt;ce+Se>it+He.clientHeight&&(He.scrollTop+=Se),ce<it&&(He.scrollTop-=Se),R.value=Pe,g.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${R.value}`)},Le=jN(S,()=>{var Pe;(Pe=b.value)!=null&&Pe.isFocusInsideContent()||F.value&&be()});return Rr(()=>{Le==null||Le()}),dn(()=>{g.value.ref.setAttribute("role","textbox"),g.value.ref.setAttribute("aria-autocomplete","list"),g.value.ref.setAttribute("aria-controls","id"),g.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${R.value}`),C=g.value.ref.hasAttribute("readonly")}),o({highlightedIndex:R,activated:O,loading:L,inputRef:g,popperRef:b,suggestions:I,handleSelect:Me,handleKeyEnter:J,focus:Ae,blur:_e,close:be,highlight:Fe,getData:te}),(Pe,He)=>($(),Ve(p(Us),{ref_key:"popperRef",ref:b,visible:p(F),placement:Pe.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[p(v).e("popper"),Pe.popperClass],teleported:Pe.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${p(v).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:G,onHide:Y},{content:Ce(()=>[ue("div",{ref_key:"regionRef",ref:E,class:K([p(v).b("suggestion"),p(v).is("loading",p(W))]),style:jt({[Pe.fitInputWidth?"width":"minWidth"]:N.value,outline:"none"}),role:"region"},[ge(p(gl),{id:p(D),tag:"ul","wrap-class":p(v).be("suggestion","wrap"),"view-class":p(v).be("suggestion","list"),role:"listbox"},{default:Ce(()=>[p(W)?($(),le("li",{key:0},[Ne(Pe.$slots,"loading",{},()=>[ge(p(Dt),{class:K(p(v).is("loading"))},{default:Ce(()=>[ge(p(hl))]),_:1},8,["class"])])])):($(!0),le(Ut,{key:1},Cn(I.value,(We,yt)=>($(),le("li",{id:`${p(D)}-item-${yt}`,key:yt,class:K({highlighted:R.value===yt}),role:"option","aria-selected":R.value===yt,onClick:it=>Me(We)},[Ne(Pe.$slots,"default",{item:We},()=>[bn(ot(We[Pe.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:Ce(()=>[ue("div",{ref_key:"listboxRef",ref:S,class:K([p(v).b(),Pe.$attrs.class]),style:jt(p(M)),role:"combobox","aria-haspopup":"listbox","aria-expanded":p(F),"aria-owns":p(D)},[ge(p(ei),En({ref_key:"inputRef",ref:g},p(l),{clearable:Pe.clearable,disabled:p(h),name:Pe.name,"model-value":Pe.modelValue,"aria-label":Pe.ariaLabel,onInput:fe,onChange:ae,onFocus:X,onBlur:ie,onClear:se,onKeydown:[Cr(Gt(We=>Fe(R.value-1),["prevent"]),["up"]),Cr(Gt(We=>Fe(R.value+1),["prevent"]),["down"]),Cr(J,["enter"]),Cr(be,["tab"]),Cr(pe,["esc"])],onMousedown:Ee}),fa({_:2},[Pe.$slots.prepend?{name:"prepend",fn:Ce(()=>[Ne(Pe.$slots,"prepend")])}:void 0,Pe.$slots.append?{name:"append",fn:Ce(()=>[Ne(Pe.$slots,"append")])}:void 0,Pe.$slots.prefix?{name:"prefix",fn:Ce(()=>[Ne(Pe.$slots,"prefix")])}:void 0,Pe.$slots.suffix?{name:"suffix",fn:Ce(()=>[Ne(Pe.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var aTe=dt(iTe,[["__file","autocomplete.vue"]]);const cTe=rn(aTe),lTe=ut({size:{type:[Number,String],values:vl,default:"",validator:t=>$t(t)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:yr},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:Re(String),default:"cover"}}),uTe={error:t=>t instanceof Event},dTe=me({name:"ElAvatar"}),hTe=me({...dTe,props:lTe,emits:uTe,setup(t,{emit:o}){const s=t,a=Qe("avatar"),l=ee(!1),d=U(()=>{const{size:E,icon:b,shape:S}=s,C=[a.b()];return Mt(E)&&C.push(a.m(E)),b&&C.push(a.m("icon")),S&&C.push(a.m(S)),C}),h=U(()=>{const{size:E}=s;return $t(E)?a.cssVarBlock({size:mo(E)||""}):void 0}),v=U(()=>({objectFit:s.fit}));ze(()=>s.src,()=>l.value=!1);function g(E){l.value=!0,o("error",E)}return(E,b)=>($(),le("span",{class:K(p(d)),style:jt(p(h))},[(E.src||E.srcSet)&&!l.value?($(),le("img",{key:0,src:E.src,alt:E.alt,srcset:E.srcSet,style:jt(p(v)),onError:g},null,44,["src","alt","srcset"])):E.icon?($(),Ve(p(Dt),{key:1},{default:Ce(()=>[($(),Ve(gn(E.icon)))]),_:1})):Ne(E.$slots,"default",{key:2})],6))}});var fTe=dt(hTe,[["__file","avatar.vue"]]);const pTe=rn(fTe),mTe={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},vTe={click:t=>t instanceof MouseEvent},gTe=(t,o,s)=>{const a=Mr(),l=Mr(),d=ee(!1),h=()=>{a.value&&(d.value=a.value.scrollTop>=t.visibilityHeight)},v=E=>{var b;(b=a.value)==null||b.scrollTo({top:0,behavior:"smooth"}),o("click",E)},g=eK(h,300,!0);return gr(l,"scroll",g),dn(()=>{var E;l.value=document,a.value=document.documentElement,t.target&&(a.value=(E=document.querySelector(t.target))!=null?E:void 0,a.value||qo(s,`target does not exist: ${t.target}`),l.value=a.value),h()}),{visible:d,handleClick:v}},XK="ElBacktop",_Te=me({name:XK}),ETe=me({..._Te,props:mTe,emits:vTe,setup(t,{emit:o}){const s=t,a=Qe("backtop"),{handleClick:l,visible:d}=gTe(s,o,XK),h=U(()=>({right:`${s.right}px`,bottom:`${s.bottom}px`}));return(v,g)=>($(),Ve(hs,{name:`${p(a).namespace.value}-fade-in`},{default:Ce(()=>[p(d)?($(),le("div",{key:0,style:jt(p(h)),class:K(p(a).b()),onClick:Gt(p(l),["stop"])},[Ne(v.$slots,"default",{},()=>[ge(p(Dt),{class:K(p(a).e("icon"))},{default:Ce(()=>[ge(p(lye))]),_:1},8,["class"])])],14,["onClick"])):De("v-if",!0)]),_:3},8,["name"]))}});var yTe=dt(ETe,[["__file","backtop.vue"]]);const bTe=rn(yTe),STe=ut({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:Re([String,Object,Array])},offset:{type:Re(Array),default:[0,0]},badgeClass:{type:String}}),TTe=me({name:"ElBadge"}),CTe=me({...TTe,props:STe,setup(t,{expose:o}){const s=t,a=Qe("badge"),l=U(()=>s.isDot?"":$t(s.value)&&$t(s.max)?s.max<s.value?`${s.max}+`:`${s.value}`:`${s.value}`),d=U(()=>{var h,v,g,E,b;return[{backgroundColor:s.color,marginRight:mo(-((v=(h=s.offset)==null?void 0:h[0])!=null?v:0)),marginTop:mo((E=(g=s.offset)==null?void 0:g[1])!=null?E:0)},(b=s.badgeStyle)!=null?b:{}]});return o({content:l}),(h,v)=>($(),le("div",{class:K(p(a).b())},[Ne(h.$slots,"default"),ge(hs,{name:`${p(a).namespace.value}-zoom-in-center`,persisted:""},{default:Ce(()=>[ln(ue("sup",{class:K([p(a).e("content"),p(a).em("content",h.type),p(a).is("fixed",!!h.$slots.default),p(a).is("dot",h.isDot),p(a).is("hide-zero",!h.showZero&&s.value===0),h.badgeClass]),style:jt(p(d))},[Ne(h.$slots,"content",{value:p(l)},()=>[bn(ot(p(l)),1)])],6),[[Wn,!h.hidden&&(p(l)||h.isDot||h.$slots.content)]])]),_:3},8,["name"])],2))}});var wTe=dt(CTe,[["__file","badge.vue"]]);const JK=rn(wTe),ZK=Symbol("breadcrumbKey"),RTe=ut({separator:{type:String,default:"/"},separatorIcon:{type:yr}}),ITe=me({name:"ElBreadcrumb"}),ATe=me({...ITe,props:RTe,setup(t){const o=t,{t:s}=Fn(),a=Qe("breadcrumb"),l=ee();return wn(ZK,o),dn(()=>{const d=l.value.querySelectorAll(`.${a.e("item")}`);d.length&&d[d.length-1].setAttribute("aria-current","page")}),(d,h)=>($(),le("div",{ref_key:"breadcrumb",ref:l,class:K(p(a).b()),"aria-label":p(s)("el.breadcrumb.label"),role:"navigation"},[Ne(d.$slots,"default")],10,["aria-label"]))}});var OTe=dt(ATe,[["__file","breadcrumb.vue"]]);const NTe=ut({to:{type:Re([String,Object]),default:""},replace:Boolean}),kTe=me({name:"ElBreadcrumbItem"}),PTe=me({...kTe,props:NTe,setup(t){const o=t,s=mn(),a=It(ZK,void 0),l=Qe("breadcrumb"),d=s.appContext.config.globalProperties.$router,h=ee(),v=()=>{!o.to||!d||(o.replace?d.replace(o.to):d.push(o.to))};return(g,E)=>{var b,S;return $(),le("span",{class:K(p(l).e("item"))},[ue("span",{ref_key:"link",ref:h,class:K([p(l).e("inner"),p(l).is("link",!!g.to)]),role:"link",onClick:v},[Ne(g.$slots,"default")],2),(b=p(a))!=null&&b.separatorIcon?($(),Ve(p(Dt),{key:0,class:K(p(l).e("separator"))},{default:Ce(()=>[($(),Ve(gn(p(a).separatorIcon)))]),_:1},8,["class"])):($(),le("span",{key:1,class:K(p(l).e("separator")),role:"presentation"},ot((S=p(a))==null?void 0:S.separator),3))],2)}}});var QK=dt(PTe,[["__file","breadcrumb-item.vue"]]);const DTe=rn(OTe,{BreadcrumbItem:QK}),LTe=uo(QK),eG=Symbol("buttonGroupContextKey"),od=({from:t,replacement:o,scope:s,version:a,ref:l,type:d="API"},h)=>{ze(()=>p(h),v=>{},{immediate:!0})},MTe=(t,o)=>{od({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},U(()=>t.type==="text"));const s=It(eG,void 0),a=p0("button"),{form:l}=Vs(),d=xo(U(()=>s==null?void 0:s.size)),h=Fs(),v=ee(),g=Jo(),E=U(()=>t.type||(s==null?void 0:s.type)||""),b=U(()=>{var I,R,N;return(N=(R=t.autoInsertSpace)!=null?R:(I=a.value)==null?void 0:I.autoInsertSpace)!=null?N:!1}),S=U(()=>t.tag==="button"?{ariaDisabled:h.value||t.loading,disabled:h.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),C=U(()=>{var I;const R=(I=g.default)==null?void 0:I.call(g);if(b.value&&(R==null?void 0:R.length)===1){const N=R[0];if((N==null?void 0:N.type)===cm){const O=N.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(O.trim())}}return!1});return{_disabled:h,_size:d,_type:E,_ref:v,_props:S,shouldAddSpace:C,handleClick:I=>{if(h.value||t.loading){I.stopPropagation();return}t.nativeType==="reset"&&(l==null||l.resetFields()),o("click",I)}}},JA=["default","primary","success","warning","info","danger","text",""],xTe=["button","submit","reset"],ZA=ut({size:Ho,disabled:Boolean,type:{type:String,values:JA,default:""},icon:{type:yr},nativeType:{type:String,values:xTe,default:"button"},loading:Boolean,loadingIcon:{type:yr,default:()=>hl},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:Re([String,Object]),default:"button"}}),UTe={click:t=>t instanceof MouseEvent};function xs(t,o){VTe(t)&&(t="100%");var s=FTe(t);return t=o===360?t:Math.min(o,Math.max(0,parseFloat(t))),s&&(t=parseInt(String(t*o),10)/100),Math.abs(t-o)<1e-6?1:(o===360?t=(t<0?t%o+o:t%o)/parseFloat(String(o)):t=t%o/parseFloat(String(o)),t)}function Ab(t){return Math.min(1,Math.max(0,t))}function VTe(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function FTe(t){return typeof t=="string"&&t.indexOf("%")!==-1}function tG(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ob(t){return t<=1?"".concat(Number(t)*100,"%"):t}function yh(t){return t.length===1?"0"+t:String(t)}function BTe(t,o,s){return{r:xs(t,255)*255,g:xs(o,255)*255,b:xs(s,255)*255}}function tH(t,o,s){t=xs(t,255),o=xs(o,255),s=xs(s,255);var a=Math.max(t,o,s),l=Math.min(t,o,s),d=0,h=0,v=(a+l)/2;if(a===l)h=0,d=0;else{var g=a-l;switch(h=v>.5?g/(2-a-l):g/(a+l),a){case t:d=(o-s)/g+(o<s?6:0);break;case o:d=(s-t)/g+2;break;case s:d=(t-o)/g+4;break}d/=6}return{h:d,s:h,l:v}}function oA(t,o,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(o-t)*(6*s):s<1/2?o:s<2/3?t+(o-t)*(2/3-s)*6:t}function jTe(t,o,s){var a,l,d;if(t=xs(t,360),o=xs(o,100),s=xs(s,100),o===0)l=s,d=s,a=s;else{var h=s<.5?s*(1+o):s+o-s*o,v=2*s-h;a=oA(v,h,t+1/3),l=oA(v,h,t),d=oA(v,h,t-1/3)}return{r:a*255,g:l*255,b:d*255}}function nH(t,o,s){t=xs(t,255),o=xs(o,255),s=xs(s,255);var a=Math.max(t,o,s),l=Math.min(t,o,s),d=0,h=a,v=a-l,g=a===0?0:v/a;if(a===l)d=0;else{switch(a){case t:d=(o-s)/v+(o<s?6:0);break;case o:d=(s-t)/v+2;break;case s:d=(t-o)/v+4;break}d/=6}return{h:d,s:g,v:h}}function $Te(t,o,s){t=xs(t,360)*6,o=xs(o,100),s=xs(s,100);var a=Math.floor(t),l=t-a,d=s*(1-o),h=s*(1-l*o),v=s*(1-(1-l)*o),g=a%6,E=[s,h,d,d,v,s][g],b=[v,s,s,h,d,d][g],S=[d,d,v,s,s,h][g];return{r:E*255,g:b*255,b:S*255}}function rH(t,o,s,a){var l=[yh(Math.round(t).toString(16)),yh(Math.round(o).toString(16)),yh(Math.round(s).toString(16))];return a&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0):l.join("")}function HTe(t,o,s,a,l){var d=[yh(Math.round(t).toString(16)),yh(Math.round(o).toString(16)),yh(Math.round(s).toString(16)),yh(WTe(a))];return l&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))&&d[3].startsWith(d[3].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0)+d[3].charAt(0):d.join("")}function WTe(t){return Math.round(parseFloat(t)*255).toString(16)}function oH(t){return ra(t)/255}function ra(t){return parseInt(t,16)}function KTe(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var QA={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function GTe(t){var o={r:0,g:0,b:0},s=1,a=null,l=null,d=null,h=!1,v=!1;return typeof t=="string"&&(t=qTe(t)),typeof t=="object"&&(Hl(t.r)&&Hl(t.g)&&Hl(t.b)?(o=BTe(t.r,t.g,t.b),h=!0,v=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Hl(t.h)&&Hl(t.s)&&Hl(t.v)?(a=Ob(t.s),l=Ob(t.v),o=$Te(t.h,a,l),h=!0,v="hsv"):Hl(t.h)&&Hl(t.s)&&Hl(t.l)&&(a=Ob(t.s),d=Ob(t.l),o=jTe(t.h,a,d),h=!0,v="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(s=t.a)),s=tG(s),{ok:h,format:t.format||v,r:Math.min(255,Math.max(o.r,0)),g:Math.min(255,Math.max(o.g,0)),b:Math.min(255,Math.max(o.b,0)),a:s}}var zTe="[-\\+]?\\d+%?",YTe="[-\\+]?\\d*\\.\\d+%?",td="(?:".concat(YTe,")|(?:").concat(zTe,")"),sA="[\\s|\\(]+(".concat(td,")[,|\\s]+(").concat(td,")[,|\\s]+(").concat(td,")\\s*\\)?"),iA="[\\s|\\(]+(".concat(td,")[,|\\s]+(").concat(td,")[,|\\s]+(").concat(td,")[,|\\s]+(").concat(td,")\\s*\\)?"),hc={CSS_UNIT:new RegExp(td),rgb:new RegExp("rgb"+sA),rgba:new RegExp("rgba"+iA),hsl:new RegExp("hsl"+sA),hsla:new RegExp("hsla"+iA),hsv:new RegExp("hsv"+sA),hsva:new RegExp("hsva"+iA),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function qTe(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var o=!1;if(QA[t])t=QA[t],o=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var s=hc.rgb.exec(t);return s?{r:s[1],g:s[2],b:s[3]}:(s=hc.rgba.exec(t),s?{r:s[1],g:s[2],b:s[3],a:s[4]}:(s=hc.hsl.exec(t),s?{h:s[1],s:s[2],l:s[3]}:(s=hc.hsla.exec(t),s?{h:s[1],s:s[2],l:s[3],a:s[4]}:(s=hc.hsv.exec(t),s?{h:s[1],s:s[2],v:s[3]}:(s=hc.hsva.exec(t),s?{h:s[1],s:s[2],v:s[3],a:s[4]}:(s=hc.hex8.exec(t),s?{r:ra(s[1]),g:ra(s[2]),b:ra(s[3]),a:oH(s[4]),format:o?"name":"hex8"}:(s=hc.hex6.exec(t),s?{r:ra(s[1]),g:ra(s[2]),b:ra(s[3]),format:o?"name":"hex"}:(s=hc.hex4.exec(t),s?{r:ra(s[1]+s[1]),g:ra(s[2]+s[2]),b:ra(s[3]+s[3]),a:oH(s[4]+s[4]),format:o?"name":"hex8"}:(s=hc.hex3.exec(t),s?{r:ra(s[1]+s[1]),g:ra(s[2]+s[2]),b:ra(s[3]+s[3]),format:o?"name":"hex"}:!1)))))))))}function Hl(t){return!!hc.CSS_UNIT.exec(String(t))}var nG=function(){function t(o,s){o===void 0&&(o=""),s===void 0&&(s={});var a;if(o instanceof t)return o;typeof o=="number"&&(o=KTe(o)),this.originalInput=o;var l=GTe(o);this.originalInput=o,this.r=l.r,this.g=l.g,this.b=l.b,this.a=l.a,this.roundA=Math.round(100*this.a)/100,this.format=(a=s.format)!==null&&a!==void 0?a:l.format,this.gradientType=s.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=l.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var o=this.toRgb();return(o.r*299+o.g*587+o.b*114)/1e3},t.prototype.getLuminance=function(){var o=this.toRgb(),s,a,l,d=o.r/255,h=o.g/255,v=o.b/255;return d<=.03928?s=d/12.92:s=Math.pow((d+.055)/1.055,2.4),h<=.03928?a=h/12.92:a=Math.pow((h+.055)/1.055,2.4),v<=.03928?l=v/12.92:l=Math.pow((v+.055)/1.055,2.4),.2126*s+.7152*a+.0722*l},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(o){return this.a=tG(o),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var o=this.toHsl().s;return o===0},t.prototype.toHsv=function(){var o=nH(this.r,this.g,this.b);return{h:o.h*360,s:o.s,v:o.v,a:this.a}},t.prototype.toHsvString=function(){var o=nH(this.r,this.g,this.b),s=Math.round(o.h*360),a=Math.round(o.s*100),l=Math.round(o.v*100);return this.a===1?"hsv(".concat(s,", ").concat(a,"%, ").concat(l,"%)"):"hsva(".concat(s,", ").concat(a,"%, ").concat(l,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var o=tH(this.r,this.g,this.b);return{h:o.h*360,s:o.s,l:o.l,a:this.a}},t.prototype.toHslString=function(){var o=tH(this.r,this.g,this.b),s=Math.round(o.h*360),a=Math.round(o.s*100),l=Math.round(o.l*100);return this.a===1?"hsl(".concat(s,", ").concat(a,"%, ").concat(l,"%)"):"hsla(".concat(s,", ").concat(a,"%, ").concat(l,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(o){return o===void 0&&(o=!1),rH(this.r,this.g,this.b,o)},t.prototype.toHexString=function(o){return o===void 0&&(o=!1),"#"+this.toHex(o)},t.prototype.toHex8=function(o){return o===void 0&&(o=!1),HTe(this.r,this.g,this.b,this.a,o)},t.prototype.toHex8String=function(o){return o===void 0&&(o=!1),"#"+this.toHex8(o)},t.prototype.toHexShortString=function(o){return o===void 0&&(o=!1),this.a===1?this.toHexString(o):this.toHex8String(o)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var o=Math.round(this.r),s=Math.round(this.g),a=Math.round(this.b);return this.a===1?"rgb(".concat(o,", ").concat(s,", ").concat(a,")"):"rgba(".concat(o,", ").concat(s,", ").concat(a,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var o=function(s){return"".concat(Math.round(xs(s,255)*100),"%")};return{r:o(this.r),g:o(this.g),b:o(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var o=function(s){return Math.round(xs(s,255)*100)};return this.a===1?"rgb(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%)"):"rgba(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var o="#"+rH(this.r,this.g,this.b,!1),s=0,a=Object.entries(QA);s<a.length;s++){var l=a[s],d=l[0],h=l[1];if(o===h)return d}return!1},t.prototype.toString=function(o){var s=!!o;o=o??this.format;var a=!1,l=this.a<1&&this.a>=0,d=!s&&l&&(o.startsWith("hex")||o==="name");return d?o==="name"&&this.a===0?this.toName():this.toRgbString():(o==="rgb"&&(a=this.toRgbString()),o==="prgb"&&(a=this.toPercentageRgbString()),(o==="hex"||o==="hex6")&&(a=this.toHexString()),o==="hex3"&&(a=this.toHexString(!0)),o==="hex4"&&(a=this.toHex8String(!0)),o==="hex8"&&(a=this.toHex8String()),o==="name"&&(a=this.toName()),o==="hsl"&&(a=this.toHslString()),o==="hsv"&&(a=this.toHsvString()),a||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(o){o===void 0&&(o=10);var s=this.toHsl();return s.l+=o/100,s.l=Ab(s.l),new t(s)},t.prototype.brighten=function(o){o===void 0&&(o=10);var s=this.toRgb();return s.r=Math.max(0,Math.min(255,s.r-Math.round(255*-(o/100)))),s.g=Math.max(0,Math.min(255,s.g-Math.round(255*-(o/100)))),s.b=Math.max(0,Math.min(255,s.b-Math.round(255*-(o/100)))),new t(s)},t.prototype.darken=function(o){o===void 0&&(o=10);var s=this.toHsl();return s.l-=o/100,s.l=Ab(s.l),new t(s)},t.prototype.tint=function(o){return o===void 0&&(o=10),this.mix("white",o)},t.prototype.shade=function(o){return o===void 0&&(o=10),this.mix("black",o)},t.prototype.desaturate=function(o){o===void 0&&(o=10);var s=this.toHsl();return s.s-=o/100,s.s=Ab(s.s),new t(s)},t.prototype.saturate=function(o){o===void 0&&(o=10);var s=this.toHsl();return s.s+=o/100,s.s=Ab(s.s),new t(s)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(o){var s=this.toHsl(),a=(s.h+o)%360;return s.h=a<0?360+a:a,new t(s)},t.prototype.mix=function(o,s){s===void 0&&(s=50);var a=this.toRgb(),l=new t(o).toRgb(),d=s/100,h={r:(l.r-a.r)*d+a.r,g:(l.g-a.g)*d+a.g,b:(l.b-a.b)*d+a.b,a:(l.a-a.a)*d+a.a};return new t(h)},t.prototype.analogous=function(o,s){o===void 0&&(o=6),s===void 0&&(s=30);var a=this.toHsl(),l=360/s,d=[this];for(a.h=(a.h-(l*o>>1)+720)%360;--o;)a.h=(a.h+l)%360,d.push(new t(a));return d},t.prototype.complement=function(){var o=this.toHsl();return o.h=(o.h+180)%360,new t(o)},t.prototype.monochromatic=function(o){o===void 0&&(o=6);for(var s=this.toHsv(),a=s.h,l=s.s,d=s.v,h=[],v=1/o;o--;)h.push(new t({h:a,s:l,v:d})),d=(d+v)%1;return h},t.prototype.splitcomplement=function(){var o=this.toHsl(),s=o.h;return[this,new t({h:(s+72)%360,s:o.s,l:o.l}),new t({h:(s+216)%360,s:o.s,l:o.l})]},t.prototype.onBackground=function(o){var s=this.toRgb(),a=new t(o).toRgb(),l=s.a+a.a*(1-s.a);return new t({r:(s.r*s.a+a.r*a.a*(1-s.a))/l,g:(s.g*s.a+a.g*a.a*(1-s.a))/l,b:(s.b*s.a+a.b*a.a*(1-s.a))/l,a:l})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(o){for(var s=this.toHsl(),a=s.h,l=[this],d=360/o,h=1;h<o;h++)l.push(new t({h:(a+h*d)%360,s:s.s,l:s.l}));return l},t.prototype.equals=function(o){return this.toRgbString()===new t(o).toRgbString()},t}();function zu(t,o=20){return t.mix("#141414",o).toString()}function XTe(t){const o=Fs(),s=Qe("button");return U(()=>{let a={},l=t.color;if(l){const d=l.match(/var\((.*?)\)/);d&&(l=window.getComputedStyle(window.document.documentElement).getPropertyValue(d[1]));const h=new nG(l),v=t.dark?h.tint(20).toString():zu(h,20);if(t.plain)a=s.cssVarBlock({"bg-color":t.dark?zu(h,90):h.tint(90).toString(),"text-color":l,"border-color":t.dark?zu(h,50):h.tint(50).toString(),"hover-text-color":`var(${s.cssVarName("color-white")})`,"hover-bg-color":l,"hover-border-color":l,"active-bg-color":v,"active-text-color":`var(${s.cssVarName("color-white")})`,"active-border-color":v}),o.value&&(a[s.cssVarBlockName("disabled-bg-color")]=t.dark?zu(h,90):h.tint(90).toString(),a[s.cssVarBlockName("disabled-text-color")]=t.dark?zu(h,50):h.tint(50).toString(),a[s.cssVarBlockName("disabled-border-color")]=t.dark?zu(h,80):h.tint(80).toString());else{const g=t.dark?zu(h,30):h.tint(30).toString(),E=h.isDark()?`var(${s.cssVarName("color-white")})`:`var(${s.cssVarName("color-black")})`;if(a=s.cssVarBlock({"bg-color":l,"text-color":E,"border-color":l,"hover-bg-color":g,"hover-text-color":E,"hover-border-color":g,"active-bg-color":v,"active-border-color":v}),o.value){const b=t.dark?zu(h,50):h.tint(50).toString();a[s.cssVarBlockName("disabled-bg-color")]=b,a[s.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${s.cssVarName("color-white")})`,a[s.cssVarBlockName("disabled-border-color")]=b}}}return a})}const JTe=me({name:"ElButton"}),ZTe=me({...JTe,props:ZA,emits:UTe,setup(t,{expose:o,emit:s}){const a=t,l=XTe(a),d=Qe("button"),{_ref:h,_size:v,_type:g,_disabled:E,_props:b,shouldAddSpace:S,handleClick:C}=MTe(a,s),w=U(()=>[d.b(),d.m(g.value),d.m(v.value),d.is("disabled",E.value),d.is("loading",a.loading),d.is("plain",a.plain),d.is("round",a.round),d.is("circle",a.circle),d.is("text",a.text),d.is("link",a.link),d.is("has-bg",a.bg)]);return o({ref:h,size:v,type:g,disabled:E,shouldAddSpace:S}),(I,R)=>($(),Ve(gn(I.tag),En({ref_key:"_ref",ref:h},p(b),{class:p(w),style:p(l),onClick:p(C)}),{default:Ce(()=>[I.loading?($(),le(Ut,{key:0},[I.$slots.loading?Ne(I.$slots,"loading",{key:0}):($(),Ve(p(Dt),{key:1,class:K(p(d).is("loading"))},{default:Ce(()=>[($(),Ve(gn(I.loadingIcon)))]),_:1},8,["class"]))],64)):I.icon||I.$slots.icon?($(),Ve(p(Dt),{key:1},{default:Ce(()=>[I.icon?($(),Ve(gn(I.icon),{key:0})):Ne(I.$slots,"icon",{key:1})]),_:3})):De("v-if",!0),I.$slots.default?($(),le("span",{key:2,class:K({[p(d).em("text","expand")]:p(S)})},[Ne(I.$slots,"default")],2)):De("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var QTe=dt(ZTe,[["__file","button.vue"]]);const eCe={size:ZA.size,type:ZA.type},tCe=me({name:"ElButtonGroup"}),nCe=me({...tCe,props:eCe,setup(t){const o=t;wn(eG,er({size:lr(o,"size"),type:lr(o,"type")}));const s=Qe("button");return(a,l)=>($(),le("div",{class:K(p(s).b("group"))},[Ne(a.$slots,"default")],2))}});var rG=dt(nCe,[["__file","button-group.vue"]]);const ls=rn(QTe,{ButtonGroup:rG}),oG=uo(rG);var aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _l(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){var s=1e3,a=6e4,l=36e5,d="millisecond",h="second",v="minute",g="hour",E="day",b="week",S="month",C="quarter",w="year",I="date",R="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,O=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,V={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ee){var ae=["th","st","nd","rd"],X=Ee%100;return"["+Ee+(ae[(X-20)%10]||ae[X]||ae[0])+"]"}},L=function(Ee,ae,X){var ie=String(Ee);return!ie||ie.length>=ae?Ee:""+Array(ae+1-ie.length).join(X)+Ee},D={s:L,z:function(Ee){var ae=-Ee.utcOffset(),X=Math.abs(ae),ie=Math.floor(X/60),se=X%60;return(ae<=0?"+":"-")+L(ie,2,"0")+":"+L(se,2,"0")},m:function Ee(ae,X){if(ae.date()<X.date())return-Ee(X,ae);var ie=12*(X.year()-ae.year())+(X.month()-ae.month()),se=ae.clone().add(ie,S),J=X-se<0,pe=ae.clone().add(ie+(J?-1:1),S);return+(-(ie+(X-se)/(J?se-pe:pe-se))||0)},a:function(Ee){return Ee<0?Math.ceil(Ee)||0:Math.floor(Ee)},p:function(Ee){return{M:S,y:w,w:b,d:E,D:I,h:g,m:v,s:h,ms:d,Q:C}[Ee]||String(Ee||"").toLowerCase().replace(/s$/,"")},u:function(Ee){return Ee===void 0}},M="en",F={};F[M]=V;var W="$isDayjsObject",z=function(Ee){return Ee instanceof Z||!(!Ee||!Ee[W])},G=function Ee(ae,X,ie){var se;if(!ae)return M;if(typeof ae=="string"){var J=ae.toLowerCase();F[J]&&(se=J),X&&(F[J]=X,se=J);var pe=ae.split("-");if(!se&&pe.length>1)return Ee(pe[0])}else{var be=ae.name;F[be]=ae,se=be}return!ie&&se&&(M=se),se||!ie&&M},Y=function(Ee,ae){if(z(Ee))return Ee.clone();var X=typeof ae=="object"?ae:{};return X.date=Ee,X.args=arguments,new Z(X)},te=D;te.l=G,te.i=z,te.w=function(Ee,ae){return Y(Ee,{locale:ae.$L,utc:ae.$u,x:ae.$x,$offset:ae.$offset})};var Z=function(){function Ee(X){this.$L=G(X.locale,null,!0),this.parse(X),this.$x=this.$x||X.x||{},this[W]=!0}var ae=Ee.prototype;return ae.parse=function(X){this.$d=function(ie){var se=ie.date,J=ie.utc;if(se===null)return new Date(NaN);if(te.u(se))return new Date;if(se instanceof Date)return new Date(se);if(typeof se=="string"&&!/Z$/i.test(se)){var pe=se.match(N);if(pe){var be=pe[2]-1||0,Ae=(pe[7]||"0").substring(0,3);return J?new Date(Date.UTC(pe[1],be,pe[3]||1,pe[4]||0,pe[5]||0,pe[6]||0,Ae)):new Date(pe[1],be,pe[3]||1,pe[4]||0,pe[5]||0,pe[6]||0,Ae)}}return new Date(se)}(X),this.init()},ae.init=function(){var X=this.$d;this.$y=X.getFullYear(),this.$M=X.getMonth(),this.$D=X.getDate(),this.$W=X.getDay(),this.$H=X.getHours(),this.$m=X.getMinutes(),this.$s=X.getSeconds(),this.$ms=X.getMilliseconds()},ae.$utils=function(){return te},ae.isValid=function(){return this.$d.toString()!==R},ae.isSame=function(X,ie){var se=Y(X);return this.startOf(ie)<=se&&se<=this.endOf(ie)},ae.isAfter=function(X,ie){return Y(X)<this.startOf(ie)},ae.isBefore=function(X,ie){return this.endOf(ie)<Y(X)},ae.$g=function(X,ie,se){return te.u(X)?this[ie]:this.set(se,X)},ae.unix=function(){return Math.floor(this.valueOf()/1e3)},ae.valueOf=function(){return this.$d.getTime()},ae.startOf=function(X,ie){var se=this,J=!!te.u(ie)||ie,pe=te.p(X),be=function(We,yt){var it=te.w(se.$u?Date.UTC(se.$y,yt,We):new Date(se.$y,yt,We),se);return J?it:it.endOf(E)},Ae=function(We,yt){return te.w(se.toDate()[We].apply(se.toDate("s"),(J?[0,0,0,0]:[23,59,59,999]).slice(yt)),se)},_e=this.$W,Me=this.$M,Fe=this.$D,Le="set"+(this.$u?"UTC":"");switch(pe){case w:return J?be(1,0):be(31,11);case S:return J?be(1,Me):be(0,Me+1);case b:var Pe=this.$locale().weekStart||0,He=(_e<Pe?_e+7:_e)-Pe;return be(J?Fe-He:Fe+(6-He),Me);case E:case I:return Ae(Le+"Hours",0);case g:return Ae(Le+"Minutes",1);case v:return Ae(Le+"Seconds",2);case h:return Ae(Le+"Milliseconds",3);default:return this.clone()}},ae.endOf=function(X){return this.startOf(X,!1)},ae.$set=function(X,ie){var se,J=te.p(X),pe="set"+(this.$u?"UTC":""),be=(se={},se[E]=pe+"Date",se[I]=pe+"Date",se[S]=pe+"Month",se[w]=pe+"FullYear",se[g]=pe+"Hours",se[v]=pe+"Minutes",se[h]=pe+"Seconds",se[d]=pe+"Milliseconds",se)[J],Ae=J===E?this.$D+(ie-this.$W):ie;if(J===S||J===w){var _e=this.clone().set(I,1);_e.$d[be](Ae),_e.init(),this.$d=_e.set(I,Math.min(this.$D,_e.daysInMonth())).$d}else be&&this.$d[be](Ae);return this.init(),this},ae.set=function(X,ie){return this.clone().$set(X,ie)},ae.get=function(X){return this[te.p(X)]()},ae.add=function(X,ie){var se,J=this;X=Number(X);var pe=te.p(ie),be=function(Me){var Fe=Y(J);return te.w(Fe.date(Fe.date()+Math.round(Me*X)),J)};if(pe===S)return this.set(S,this.$M+X);if(pe===w)return this.set(w,this.$y+X);if(pe===E)return be(1);if(pe===b)return be(7);var Ae=(se={},se[v]=a,se[g]=l,se[h]=s,se)[pe]||1,_e=this.$d.getTime()+X*Ae;return te.w(_e,this)},ae.subtract=function(X,ie){return this.add(-1*X,ie)},ae.format=function(X){var ie=this,se=this.$locale();if(!this.isValid())return se.invalidDate||R;var J=X||"YYYY-MM-DDTHH:mm:ssZ",pe=te.z(this),be=this.$H,Ae=this.$m,_e=this.$M,Me=se.weekdays,Fe=se.months,Le=se.meridiem,Pe=function(yt,it,ce,Se){return yt&&(yt[it]||yt(ie,J))||ce[it].slice(0,Se)},He=function(yt){return te.s(be%12||12,yt,"0")},We=Le||function(yt,it,ce){var Se=yt<12?"AM":"PM";return ce?Se.toLowerCase():Se};return J.replace(O,function(yt,it){return it||function(ce){switch(ce){case"YY":return String(ie.$y).slice(-2);case"YYYY":return te.s(ie.$y,4,"0");case"M":return _e+1;case"MM":return te.s(_e+1,2,"0");case"MMM":return Pe(se.monthsShort,_e,Fe,3);case"MMMM":return Pe(Fe,_e);case"D":return ie.$D;case"DD":return te.s(ie.$D,2,"0");case"d":return String(ie.$W);case"dd":return Pe(se.weekdaysMin,ie.$W,Me,2);case"ddd":return Pe(se.weekdaysShort,ie.$W,Me,3);case"dddd":return Me[ie.$W];case"H":return String(be);case"HH":return te.s(be,2,"0");case"h":return He(1);case"hh":return He(2);case"a":return We(be,Ae,!0);case"A":return We(be,Ae,!1);case"m":return String(Ae);case"mm":return te.s(Ae,2,"0");case"s":return String(ie.$s);case"ss":return te.s(ie.$s,2,"0");case"SSS":return te.s(ie.$ms,3,"0");case"Z":return pe}return null}(yt)||pe.replace(":","")})},ae.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ae.diff=function(X,ie,se){var J,pe=this,be=te.p(ie),Ae=Y(X),_e=(Ae.utcOffset()-this.utcOffset())*a,Me=this-Ae,Fe=function(){return te.m(pe,Ae)};switch(be){case w:J=Fe()/12;break;case S:J=Fe();break;case C:J=Fe()/3;break;case b:J=(Me-_e)/6048e5;break;case E:J=(Me-_e)/864e5;break;case g:J=Me/l;break;case v:J=Me/a;break;case h:J=Me/s;break;default:J=Me}return se?J:te.a(J)},ae.daysInMonth=function(){return this.endOf(S).$D},ae.$locale=function(){return F[this.$L]},ae.locale=function(X,ie){if(!X)return this.$L;var se=this.clone(),J=G(X,ie,!0);return J&&(se.$L=J),se},ae.clone=function(){return te.w(this.$d,this)},ae.toDate=function(){return new Date(this.valueOf())},ae.toJSON=function(){return this.isValid()?this.toISOString():null},ae.toISOString=function(){return this.$d.toISOString()},ae.toString=function(){return this.$d.toUTCString()},Ee}(),fe=Z.prototype;return Y.prototype=fe,[["$ms",d],["$s",h],["$m",v],["$H",g],["$W",E],["$M",S],["$y",w],["$D",I]].forEach(function(Ee){fe[Ee[1]]=function(ae){return this.$g(ae,Ee[0],Ee[1])}}),Y.extend=function(Ee,ae){return Ee.$i||(Ee(ae,Z,Y),Ee.$i=!0),Y},Y.locale=G,Y.isDayjs=z,Y.unix=function(Ee){return Y(1e3*Ee)},Y.en=F[M],Y.Ls=F,Y.p={},Y})})(sG);var rCe=sG.exports;const on=_l(rCe),aA=(t,o)=>[t>0?t-1:void 0,t,t<o?t+1:void 0],sd=t=>Array.from(Array.from({length:t}).keys()),iG=t=>t.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),aG=t=>t.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),sH=function(t,o){const s=id(t),a=id(o);return s&&a?t.getTime()===o.getTime():!s&&!a?t===o:!1},iH=function(t,o){const s=st(t),a=st(o);return s&&a?t.length!==o.length?!1:t.every((l,d)=>sH(l,o[d])):!s&&!a?sH(t,o):!1},aH=function(t,o,s){const a=oa(o)||o==="x"?on(t).locale(s):on(t,o).locale(s);return a.isValid()?a:void 0},cH=function(t,o,s){return oa(o)?t:o==="x"?+t:on(t).locale(s).format(o)},cA=(t,o)=>{var s;const a=[],l=o==null?void 0:o();for(let d=0;d<t;d++)a.push((s=l==null?void 0:l.includes(d))!=null?s:!1);return a},Nb=t=>st(t)?t.map(o=>o.toDate()):t.toDate(),oCe=(t,o)=>{const s=t.subtract(1,"month").endOf("month").date();return sd(o).map((a,l)=>s-(o-l-1))},sCe=t=>{const o=t.daysInMonth();return sd(o).map((s,a)=>a+1)},iCe=t=>sd(t.length/7).map(o=>{const s=o*7;return t.slice(s,s+7)}),aCe=ut({selectedDay:{type:Re(Object)},range:{type:Re(Array)},date:{type:Re(Object),required:!0},hideHeader:{type:Boolean}}),cCe={pick:t=>fn(t)};var cG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a,l){var d=a.prototype,h=function(S){return S&&(S.indexOf?S:S.s)},v=function(S,C,w,I,R){var N=S.name?S:S.$locale(),O=h(N[C]),V=h(N[w]),L=O||V.map(function(M){return M.slice(0,I)});if(!R)return L;var D=N.weekStart;return L.map(function(M,F){return L[(F+(D||0))%7]})},g=function(){return l.Ls[l.locale()]},E=function(S,C){return S.formats[C]||function(w){return w.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(I,R,N){return R||N.slice(1)})}(S.formats[C.toUpperCase()])},b=function(){var S=this;return{months:function(C){return C?C.format("MMMM"):v(S,"months")},monthsShort:function(C){return C?C.format("MMM"):v(S,"monthsShort","months",3)},firstDayOfWeek:function(){return S.$locale().weekStart||0},weekdays:function(C){return C?C.format("dddd"):v(S,"weekdays")},weekdaysMin:function(C){return C?C.format("dd"):v(S,"weekdaysMin","weekdays",2)},weekdaysShort:function(C){return C?C.format("ddd"):v(S,"weekdaysShort","weekdays",3)},longDateFormat:function(C){return E(S.$locale(),C)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};d.localeData=function(){return b.bind(this)()},l.localeData=function(){var S=g();return{firstDayOfWeek:function(){return S.weekStart||0},weekdays:function(){return l.weekdays()},weekdaysShort:function(){return l.weekdaysShort()},weekdaysMin:function(){return l.weekdaysMin()},months:function(){return l.months()},monthsShort:function(){return l.monthsShort()},longDateFormat:function(C){return E(S,C)},meridiem:S.meridiem,ordinal:S.ordinal}},l.months=function(){return v(g(),"months")},l.monthsShort=function(){return v(g(),"monthsShort","months",3)},l.weekdays=function(S){return v(g(),"weekdays",null,null,S)},l.weekdaysShort=function(S){return v(g(),"weekdaysShort","weekdays",3,S)},l.weekdaysMin=function(S){return v(g(),"weekdaysMin","weekdays",2,S)}}})})(cG);var lCe=cG.exports;const lG=_l(lCe),uCe=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],lA=["sun","mon","tue","wed","thu","fri","sat"],dCe=(t,o)=>{on.extend(lG);const s=on.localeData().firstDayOfWeek(),{t:a,lang:l}=Fn(),d=on().locale(l.value),h=U(()=>!!t.range&&!!t.range.length),v=U(()=>{let C=[];if(h.value){const[w,I]=t.range,R=sd(I.date()-w.date()+1).map(V=>({text:w.date()+V,type:"current"}));let N=R.length%7;N=N===0?0:7-N;const O=sd(N).map((V,L)=>({text:L+1,type:"next"}));C=R.concat(O)}else{const w=t.date.startOf("month").day(),I=oCe(t.date,(w-s+7)%7).map(V=>({text:V,type:"prev"})),R=sCe(t.date).map(V=>({text:V,type:"current"}));C=[...I,...R];const N=7-(C.length%7||7),O=sd(N).map((V,L)=>({text:L+1,type:"next"}));C=C.concat(O)}return iCe(C)}),g=U(()=>{const C=s;return C===0?lA.map(w=>a(`el.datepicker.weeks.${w}`)):lA.slice(C).concat(lA.slice(0,C)).map(w=>a(`el.datepicker.weeks.${w}`))}),E=(C,w)=>{switch(w){case"prev":return t.date.startOf("month").subtract(1,"month").date(C);case"next":return t.date.startOf("month").add(1,"month").date(C);case"current":return t.date.date(C)}};return{now:d,isInRange:h,rows:v,weekDays:g,getFormattedDate:E,handlePickDay:({text:C,type:w})=>{const I=E(C,w);o("pick",I)},getSlotData:({text:C,type:w})=>{const I=E(C,w);return{isSelected:I.isSame(t.selectedDay),type:`${w}-month`,day:I.format("YYYY-MM-DD"),date:I.toDate()}}}},hCe=me({name:"DateTable"}),fCe=me({...hCe,props:aCe,emits:cCe,setup(t,{expose:o,emit:s}){const a=t,{isInRange:l,now:d,rows:h,weekDays:v,getFormattedDate:g,handlePickDay:E,getSlotData:b}=dCe(a,s),S=Qe("calendar-table"),C=Qe("calendar-day"),w=({text:I,type:R})=>{const N=[R];if(R==="current"){const O=g(I,R);O.isSame(a.selectedDay,"day")&&N.push(C.is("selected")),O.isSame(d,"day")&&N.push(C.is("today"))}return N};return o({getFormattedDate:g}),(I,R)=>($(),le("table",{class:K([p(S).b(),p(S).is("range",p(l))]),cellspacing:"0",cellpadding:"0"},[I.hideHeader?De("v-if",!0):($(),le("thead",{key:0},[ue("tr",null,[($(!0),le(Ut,null,Cn(p(v),N=>($(),le("th",{key:N,scope:"col"},ot(N),1))),128))])])),ue("tbody",null,[($(!0),le(Ut,null,Cn(p(h),(N,O)=>($(),le("tr",{key:O,class:K({[p(S).e("row")]:!0,[p(S).em("row","hide-border")]:O===0&&I.hideHeader})},[($(!0),le(Ut,null,Cn(N,(V,L)=>($(),le("td",{key:L,class:K(w(V)),onClick:D=>p(E)(V)},[ue("div",{class:K(p(C).b())},[Ne(I.$slots,"date-cell",{data:p(b)(V)},()=>[ue("span",null,ot(V.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var lH=dt(fCe,[["__file","date-table.vue"]]);const pCe=(t,o)=>{const s=t.endOf("month"),a=o.startOf("month"),d=s.isSame(a,"week")?a.add(1,"week"):a;return[[t,s],[d.startOf("week"),o]]},mCe=(t,o)=>{const s=t.endOf("month"),a=t.add(1,"month").startOf("month"),l=s.isSame(a,"week")?a.add(1,"week"):a,d=l.endOf("month"),h=o.startOf("month"),v=d.isSame(h,"week")?h.add(1,"week"):h;return[[t,s],[l.startOf("week"),d],[v.startOf("week"),o]]},vCe=(t,o,s)=>{const{lang:a}=Fn(),l=ee(),d=on().locale(a.value),h=U({get(){return t.modelValue?g.value:l.value},set(N){if(!N)return;l.value=N;const O=N.toDate();o(cs,O),o(Jt,O)}}),v=U(()=>{if(!t.range||!st(t.range)||t.range.length!==2||t.range.some(L=>!id(L)))return[];const N=t.range.map(L=>on(L).locale(a.value)),[O,V]=N;return O.isAfter(V)?[]:O.isSame(V,"month")?w(O,V):O.add(1,"month").month()!==V.month()?[]:w(O,V)}),g=U(()=>t.modelValue?on(t.modelValue).locale(a.value):h.value||(v.value.length?v.value[0][0]:d)),E=U(()=>g.value.subtract(1,"month").date(1)),b=U(()=>g.value.add(1,"month").date(1)),S=U(()=>g.value.subtract(1,"year").date(1)),C=U(()=>g.value.add(1,"year").date(1)),w=(N,O)=>{const V=N.startOf("week"),L=O.endOf("week"),D=V.get("month"),M=L.get("month");return D===M?[[V,L]]:(D+1)%12===M?pCe(V,L):D+2===M||(D+1)%11===M?mCe(V,L):[]},I=N=>{h.value=N};return{calculateValidatedDateRange:w,date:g,realSelectedDay:h,pickDay:I,selectDate:N=>{const V={"prev-month":E.value,"next-month":b.value,"prev-year":S.value,"next-year":C.value,today:d}[N];V.isSame(g.value,"day")||I(V)},validatedRange:v}},gCe=t=>st(t)&&t.length===2&&t.every(o=>id(o)),_Ce=ut({modelValue:{type:Date},range:{type:Re(Array),validator:gCe}}),ECe={[Jt]:t=>id(t),[cs]:t=>id(t)},yCe="ElCalendar",bCe=me({name:yCe}),SCe=me({...bCe,props:_Ce,emits:ECe,setup(t,{expose:o,emit:s}){const a=t,l=Qe("calendar"),{calculateValidatedDateRange:d,date:h,pickDay:v,realSelectedDay:g,selectDate:E,validatedRange:b}=vCe(a,s),{t:S}=Fn(),C=U(()=>{const w=`el.datepicker.month${h.value.format("M")}`;return`${h.value.year()} ${S("el.datepicker.year")} ${S(w)}`});return o({selectedDay:g,pickDay:v,selectDate:E,calculateValidatedDateRange:d}),(w,I)=>($(),le("div",{class:K(p(l).b())},[ue("div",{class:K(p(l).e("header"))},[Ne(w.$slots,"header",{date:p(C)},()=>[ue("div",{class:K(p(l).e("title"))},ot(p(C)),3),p(b).length===0?($(),le("div",{key:0,class:K(p(l).e("button-group"))},[ge(p(oG),null,{default:Ce(()=>[ge(p(ls),{size:"small",onClick:R=>p(E)("prev-month")},{default:Ce(()=>[bn(ot(p(S)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),ge(p(ls),{size:"small",onClick:R=>p(E)("today")},{default:Ce(()=>[bn(ot(p(S)("el.datepicker.today")),1)]),_:1},8,["onClick"]),ge(p(ls),{size:"small",onClick:R=>p(E)("next-month")},{default:Ce(()=>[bn(ot(p(S)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):De("v-if",!0)])],2),p(b).length===0?($(),le("div",{key:0,class:K(p(l).e("body"))},[ge(lH,{date:p(h),"selected-day":p(g),onPick:p(v)},fa({_:2},[w.$slots["date-cell"]?{name:"date-cell",fn:Ce(R=>[Ne(w.$slots,"date-cell",sa(ul(R)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):($(),le("div",{key:1,class:K(p(l).e("body"))},[($(!0),le(Ut,null,Cn(p(b),(R,N)=>($(),Ve(lH,{key:N,date:R[0],"selected-day":p(g),range:R,"hide-header":N!==0,onPick:p(v)},fa({_:2},[w.$slots["date-cell"]?{name:"date-cell",fn:Ce(O=>[Ne(w.$slots,"date-cell",sa(ul(O)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var TCe=dt(SCe,[["__file","calendar.vue"]]);const CCe=rn(TCe),wCe=ut({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:Re([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),RCe=me({name:"ElCard"}),ICe=me({...RCe,props:wCe,setup(t){const o=Qe("card");return(s,a)=>($(),le("div",{class:K([p(o).b(),p(o).is(`${s.shadow}-shadow`)])},[s.$slots.header||s.header?($(),le("div",{key:0,class:K(p(o).e("header"))},[Ne(s.$slots,"header",{},()=>[bn(ot(s.header),1)])],2)):De("v-if",!0),ue("div",{class:K([p(o).e("body"),s.bodyClass]),style:jt(s.bodyStyle)},[Ne(s.$slots,"default")],6),s.$slots.footer||s.footer?($(),le("div",{key:1,class:K(p(o).e("footer"))},[Ne(s.$slots,"footer",{},()=>[bn(ot(s.footer),1)])],2)):De("v-if",!0)],2))}});var ACe=dt(ICe,[["__file","card.vue"]]);const OCe=rn(ACe),NCe=ut({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),kCe={change:(t,o)=>[t,o].every($t)},uG=Symbol("carouselContextKey"),eO="ElCarouselItem";var Ma=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(Ma||{});function tO(t){return Kr(t)&&t.type===Ut}function PCe(t){return Kr(t)&&t.type===is}function DCe(t){return Kr(t)&&!tO(t)&&!PCe(t)}const LCe=t=>{if(!Kr(t))return{};const o=t.props||{},s=(Kr(t.type)?t.type.props:void 0)||{},a={};return Object.keys(s).forEach(l=>{zn(s[l],"default")&&(a[l]=s[l].default)}),Object.keys(o).forEach(l=>{a[gi(l)]=o[l]}),a},MCe=t=>{if(!st(t)||t.length>1)throw new Error("expect to receive a single Vue element child");return t[0]},Jl=t=>{const o=st(t)?t:[t],s=[];return o.forEach(a=>{var l;st(a)?s.push(...Jl(a)):Kr(a)&&((l=a.component)!=null&&l.subTree)?s.push(a,...Jl(a.component.subTree)):Kr(a)&&st(a.children)?s.push(...Jl(a.children)):Kr(a)&&a.shapeFlag===2?s.push(...Jl(a.type())):s.push(a)}),s},xCe=(t,o,s)=>Jl(t.subTree).filter(d=>{var h;return Kr(d)&&((h=d.type)==null?void 0:h.name)===o&&!!d.component}).map(d=>d.component.uid).map(d=>s[d]).filter(d=>!!d),hk=(t,o)=>{const s={},a=Mr([]);return{children:a,addChild:h=>{s[h.uid]=h,a.value=xCe(t,o,s)},removeChild:h=>{delete s[h],a.value=a.value.filter(v=>v.uid!==h)}}},uH=300,UCe=(t,o,s)=>{const{children:a,addChild:l,removeChild:d}=hk(mn(),eO),h=Jo(),v=ee(-1),g=ee(null),E=ee(!1),b=ee(),S=ee(0),C=ee(!0),w=ee(!0),I=ee(!1),R=U(()=>t.arrow!=="never"&&!p(V)),N=U(()=>a.value.some(Le=>Le.props.label.toString().length>0)),O=U(()=>t.type==="card"),V=U(()=>t.direction==="vertical"),L=U(()=>t.height!=="auto"?{height:t.height}:{height:`${S.value}px`,overflow:"hidden"}),D=Ih(Le=>{Y(Le)},uH,{trailing:!0}),M=Ih(Le=>{J(Le)},uH),F=Le=>C.value?v.value<=1?Le<=1:Le>1:!0;function W(){g.value&&(clearInterval(g.value),g.value=null)}function z(){t.interval<=0||!t.autoplay||g.value||(g.value=setInterval(()=>G(),t.interval))}const G=()=>{w.value||(I.value=!0),w.value=!1,v.value<a.value.length-1?v.value=v.value+1:t.loop?v.value=0:I.value=!1};function Y(Le){if(w.value||(I.value=!0),w.value=!1,Mt(Le)){const We=a.value.filter(yt=>yt.props.name===Le);We.length>0&&(Le=a.value.indexOf(We[0]))}if(Le=Number(Le),Number.isNaN(Le)||Le!==Math.floor(Le))return;const Pe=a.value.length,He=v.value;Le<0?v.value=t.loop?Pe-1:0:Le>=Pe?v.value=t.loop?0:Pe-1:v.value=Le,He===v.value&&te(He),Ae()}function te(Le){a.value.forEach((Pe,He)=>{Pe.translateItem(He,v.value,Le)})}function Z(Le,Pe){var He,We,yt,it;const ce=p(a),Se=ce.length;if(Se===0||!Le.states.inStage)return!1;const je=Pe+1,tt=Pe-1,et=Se-1,Ge=ce[et].states.active,Xe=ce[0].states.active,Ye=(We=(He=ce[je])==null?void 0:He.states)==null?void 0:We.active,ct=(it=(yt=ce[tt])==null?void 0:yt.states)==null?void 0:it.active;return Pe===et&&Xe||Ye?"left":Pe===0&&Ge||ct?"right":!1}function fe(){E.value=!0,t.pauseOnHover&&W()}function Ee(){E.value=!1,z()}function ae(){I.value=!1}function X(Le){p(V)||a.value.forEach((Pe,He)=>{Le===Z(Pe,He)&&(Pe.states.hover=!0)})}function ie(){p(V)||a.value.forEach(Le=>{Le.states.hover=!1})}function se(Le){Le!==v.value&&(w.value||(I.value=!0)),v.value=Le}function J(Le){t.trigger==="hover"&&Le!==v.value&&(v.value=Le,w.value||(I.value=!0))}function pe(){Y(v.value-1)}function be(){Y(v.value+1)}function Ae(){W(),t.pauseOnHover||z()}function _e(Le){t.height==="auto"&&(S.value=Le)}function Me(){var Le;const Pe=(Le=h.default)==null?void 0:Le.call(h);if(!Pe)return null;const We=Jl(Pe).filter(yt=>Kr(yt)&&yt.type.name===eO);return(We==null?void 0:We.length)===2&&t.loop&&!O.value?(C.value=!0,We):(C.value=!1,null)}ze(()=>v.value,(Le,Pe)=>{te(Pe),C.value&&(Le=Le%2,Pe=Pe%2),Pe>-1&&o(yn,Le,Pe)}),ze(()=>t.autoplay,Le=>{Le?z():W()}),ze(()=>t.loop,()=>{Y(v.value)}),ze(()=>t.interval,()=>{Ae()});const Fe=Mr();return dn(()=>{ze(()=>a.value,()=>{a.value.length>0&&Y(t.initialIndex)},{immediate:!0}),Fe.value=co(b.value,()=>{te()}),z()}),Rr(()=>{W(),b.value&&Fe.value&&Fe.value.stop()}),wn(uG,{root:b,isCardType:O,isVertical:V,items:a,loop:t.loop,cardScale:t.cardScale,addItem:l,removeItem:d,setActiveItem:Y,setContainerHeight:_e}),{root:b,activeIndex:v,arrowDisplay:R,hasLabel:N,hover:E,isCardType:O,isTransitioning:I,items:a,isVertical:V,containerStyle:L,isItemsTwoLength:C,handleButtonEnter:X,handleTransitionEnd:ae,handleButtonLeave:ie,handleIndicatorClick:se,handleMouseEnter:fe,handleMouseLeave:Ee,setActiveItem:Y,prev:pe,next:be,PlaceholderItem:Me,isTwoLengthShow:F,throttledArrowClick:D,throttledIndicatorHover:M}},VCe="ElCarousel",FCe=me({name:VCe}),BCe=me({...FCe,props:NCe,emits:kCe,setup(t,{expose:o,emit:s}){const a=t,{root:l,activeIndex:d,arrowDisplay:h,hasLabel:v,hover:g,isCardType:E,items:b,isVertical:S,containerStyle:C,handleButtonEnter:w,handleButtonLeave:I,isTransitioning:R,handleIndicatorClick:N,handleMouseEnter:O,handleMouseLeave:V,handleTransitionEnd:L,setActiveItem:D,prev:M,next:F,PlaceholderItem:W,isTwoLengthShow:z,throttledArrowClick:G,throttledIndicatorHover:Y}=UCe(a,s),te=Qe("carousel"),{t:Z}=Fn(),fe=U(()=>{const X=[te.b(),te.m(a.direction)];return p(E)&&X.push(te.m("card")),X}),Ee=U(()=>{const X=[te.e("container")];return a.motionBlur&&p(R)&&b.value.length>1&&X.push(p(S)?`${te.namespace.value}-transitioning-vertical`:`${te.namespace.value}-transitioning`),X}),ae=U(()=>{const X=[te.e("indicators"),te.em("indicators",a.direction)];return p(v)&&X.push(te.em("indicators","labels")),a.indicatorPosition==="outside"&&X.push(te.em("indicators","outside")),p(S)&&X.push(te.em("indicators","right")),X});return o({activeIndex:d,setActiveItem:D,prev:M,next:F}),(X,ie)=>($(),le("div",{ref_key:"root",ref:l,class:K(p(fe)),onMouseenter:Gt(p(O),["stop"]),onMouseleave:Gt(p(V),["stop"])},[p(h)?($(),Ve(hs,{key:0,name:"carousel-arrow-left",persisted:""},{default:Ce(()=>[ln(ue("button",{type:"button",class:K([p(te).e("arrow"),p(te).em("arrow","left")]),"aria-label":p(Z)("el.carousel.leftArrow"),onMouseenter:se=>p(w)("left"),onMouseleave:p(I),onClick:Gt(se=>p(G)(p(d)-1),["stop"])},[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Wn,(X.arrow==="always"||p(g))&&(a.loop||p(d)>0)]])]),_:1})):De("v-if",!0),p(h)?($(),Ve(hs,{key:1,name:"carousel-arrow-right",persisted:""},{default:Ce(()=>[ln(ue("button",{type:"button",class:K([p(te).e("arrow"),p(te).em("arrow","right")]),"aria-label":p(Z)("el.carousel.rightArrow"),onMouseenter:se=>p(w)("right"),onMouseleave:p(I),onClick:Gt(se=>p(G)(p(d)+1),["stop"])},[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[Wn,(X.arrow==="always"||p(g))&&(a.loop||p(d)<p(b).length-1)]])]),_:1})):De("v-if",!0),ue("div",{class:K(p(Ee)),style:jt(p(C)),onTransitionend:p(L)},[ge(p(W)),Ne(X.$slots,"default")],46,["onTransitionend"]),X.indicatorPosition!=="none"?($(),le("ul",{key:2,class:K(p(ae))},[($(!0),le(Ut,null,Cn(p(b),(se,J)=>ln(($(),le("li",{key:J,class:K([p(te).e("indicator"),p(te).em("indicator",X.direction),p(te).is("active",J===p(d))]),onMouseenter:pe=>p(Y)(J),onClick:Gt(pe=>p(N)(J),["stop"])},[ue("button",{class:K(p(te).e("button")),"aria-label":p(Z)("el.carousel.indicator",{index:J+1})},[p(v)?($(),le("span",{key:0},ot(se.props.label),1)):De("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[Wn,p(z)(J)]])),128))],2)):De("v-if",!0),a.motionBlur?($(),le("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[ue("defs",null,[ue("filter",{id:"elCarouselHorizontal"},[ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),ue("filter",{id:"elCarouselVertical"},[ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):De("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var jCe=dt(BCe,[["__file","carousel.vue"]]);const $Ce=ut({name:{type:String,default:""},label:{type:[String,Number],default:""}}),HCe=t=>{const o=It(uG),s=mn(),a=ee(),l=ee(!1),d=ee(0),h=ee(1),v=ee(!1),g=ee(!1),E=ee(!1),b=ee(!1),{isCardType:S,isVertical:C,cardScale:w}=o;function I(L,D,M){const F=M-1,W=D-1,z=D+1,G=M/2;return D===0&&L===F?-1:D===F&&L===0?M:L<W&&D-L>=G?M+1:L>z&&L-D>=G?-2:L}function R(L,D){var M,F;const W=p(C)?((M=o.root.value)==null?void 0:M.offsetHeight)||0:((F=o.root.value)==null?void 0:F.offsetWidth)||0;return E.value?W*((2-w)*(L-D)+1)/4:L<D?-(1+w)*W/4:(3+w)*W/4}function N(L,D,M){const F=o.root.value;return F?((M?F.offsetHeight:F.offsetWidth)||0)*(L-D):0}const O=(L,D,M)=>{var F;const W=p(S),z=(F=o.items.value.length)!=null?F:Number.NaN,G=L===D;!W&&!Xn(M)&&(b.value=G||L===M),!G&&z>2&&o.loop&&(L=I(L,D,z));const Y=p(C);v.value=G,W?(E.value=Math.round(Math.abs(L-D))<=1,d.value=R(L,D),h.value=p(v)?1:w):d.value=N(L,D,Y),g.value=!0,G&&a.value&&o.setContainerHeight(a.value.offsetHeight)};function V(){if(o&&p(S)){const L=o.items.value.findIndex(({uid:D})=>D===s.uid);o.setActiveItem(L)}}return dn(()=>{o.addItem({props:t,states:er({hover:l,translate:d,scale:h,active:v,ready:g,inStage:E,animating:b}),uid:s.uid,translateItem:O})}),iu(()=>{o.removeItem(s.uid)}),{carouselItemRef:a,active:v,animating:b,hover:l,inStage:E,isVertical:C,translate:d,isCardType:S,scale:h,ready:g,handleItemClick:V}},WCe=me({name:eO}),KCe=me({...WCe,props:$Ce,setup(t){const o=t,s=Qe("carousel"),{carouselItemRef:a,active:l,animating:d,hover:h,inStage:v,isVertical:g,translate:E,isCardType:b,scale:S,ready:C,handleItemClick:w}=HCe(o),I=U(()=>[s.e("item"),s.is("active",l.value),s.is("in-stage",v.value),s.is("hover",h.value),s.is("animating",d.value),{[s.em("item","card")]:b.value,[s.em("item","card-vertical")]:b.value&&g.value}]),R=U(()=>{const O=`${`translate${p(g)?"Y":"X"}`}(${p(E)}px)`,V=`scale(${p(S)})`;return{transform:[O,V].join(" ")}});return(N,O)=>ln(($(),le("div",{ref_key:"carouselItemRef",ref:a,class:K(p(I)),style:jt(p(R)),onClick:p(w)},[p(b)?ln(($(),le("div",{key:0,class:K(p(s).e("mask"))},null,2)),[[Wn,!p(l)]]):De("v-if",!0),Ne(N.$slots,"default")],14,["onClick"])),[[Wn,p(C)]])}});var dG=dt(KCe,[["__file","carousel-item.vue"]]);const GCe=rn(jCe,{CarouselItem:dG}),zCe=uo(dG),hG={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:Ho,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...Cs(["ariaControls"])},fG={[Jt]:t=>Mt(t)||$t(t)||wr(t),change:t=>Mt(t)||$t(t)||wr(t)},gm=Symbol("checkboxGroupContextKey"),YCe=({model:t,isChecked:o})=>{const s=It(gm,void 0),a=U(()=>{var d,h;const v=(d=s==null?void 0:s.max)==null?void 0:d.value,g=(h=s==null?void 0:s.min)==null?void 0:h.value;return!Xn(v)&&t.value.length>=v&&!o.value||!Xn(g)&&t.value.length<=g&&o.value});return{isDisabled:Fs(U(()=>(s==null?void 0:s.disabled.value)||a.value)),isLimitDisabled:a}},qCe=(t,{model:o,isLimitExceeded:s,hasOwnLabel:a,isDisabled:l,isLabeledByFormItem:d})=>{const h=It(gm,void 0),{formItem:v}=Vs(),{emit:g}=mn();function E(I){var R,N,O,V;return[!0,t.trueValue,t.trueLabel].includes(I)?(N=(R=t.trueValue)!=null?R:t.trueLabel)!=null?N:!0:(V=(O=t.falseValue)!=null?O:t.falseLabel)!=null?V:!1}function b(I,R){g(yn,E(I),R)}function S(I){if(s.value)return;const R=I.target;g(yn,E(R.checked),I)}async function C(I){s.value||!a.value&&!l.value&&d.value&&(I.composedPath().some(O=>O.tagName==="LABEL")||(o.value=E([!1,t.falseValue,t.falseLabel].includes(o.value)),await Vt(),b(o.value,I)))}const w=U(()=>(h==null?void 0:h.validateEvent)||t.validateEvent);return ze(()=>t.modelValue,()=>{w.value&&(v==null||v.validate("change").catch(I=>void 0))}),{handleChange:S,onClickRoot:C}},XCe=t=>{const o=ee(!1),{emit:s}=mn(),a=It(gm,void 0),l=U(()=>Xn(a)===!1),d=ee(!1),h=U({get(){var v,g;return l.value?(v=a==null?void 0:a.modelValue)==null?void 0:v.value:(g=t.modelValue)!=null?g:o.value},set(v){var g,E;l.value&&st(v)?(d.value=((g=a==null?void 0:a.max)==null?void 0:g.value)!==void 0&&v.length>(a==null?void 0:a.max.value)&&v.length>h.value.length,d.value===!1&&((E=a==null?void 0:a.changeEvent)==null||E.call(a,v))):(s(Jt,v),o.value=v)}});return{model:h,isGroup:l,isLimitExceeded:d}},JCe=(t,o,{model:s})=>{const a=It(gm,void 0),l=ee(!1),d=U(()=>Ec(t.value)?t.label:t.value),h=U(()=>{const b=s.value;return wr(b)?b:st(b)?fn(d.value)?b.map(Tr).some(S=>as(S,d.value)):b.map(Tr).includes(d.value):b!=null?b===t.trueValue||b===t.trueLabel:!!b}),v=xo(U(()=>{var b;return(b=a==null?void 0:a.size)==null?void 0:b.value}),{prop:!0}),g=xo(U(()=>{var b;return(b=a==null?void 0:a.size)==null?void 0:b.value})),E=U(()=>!!o.default||!Ec(d.value));return{checkboxButtonSize:v,isChecked:h,isFocused:l,checkboxSize:g,hasOwnLabel:E,actualValue:d}},pG=(t,o)=>{const{formItem:s}=Vs(),{model:a,isGroup:l,isLimitExceeded:d}=XCe(t),{isFocused:h,isChecked:v,checkboxButtonSize:g,checkboxSize:E,hasOwnLabel:b,actualValue:S}=JCe(t,o,{model:a}),{isDisabled:C}=YCe({model:a,isChecked:v}),{inputId:w,isLabeledByFormItem:I}=Ka(t,{formItemContext:s,disableIdGeneration:b,disableIdManagement:l}),{handleChange:R,onClickRoot:N}=qCe(t,{model:a,isLimitExceeded:d,hasOwnLabel:b,isDisabled:C,isLabeledByFormItem:I});return(()=>{function V(){var L,D;st(a.value)&&!a.value.includes(S.value)?a.value.push(S.value):a.value=(D=(L=t.trueValue)!=null?L:t.trueLabel)!=null?D:!0}t.checked&&V()})(),od({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},U(()=>l.value&&Ec(t.value))),od({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},U(()=>!!t.trueLabel)),od({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},U(()=>!!t.falseLabel)),{inputId:w,isLabeledByFormItem:I,isChecked:v,isDisabled:C,isFocused:h,checkboxButtonSize:g,checkboxSize:E,hasOwnLabel:b,model:a,actualValue:S,handleChange:R,onClickRoot:N}},ZCe=me({name:"ElCheckbox"}),QCe=me({...ZCe,props:hG,emits:fG,setup(t){const o=t,s=Jo(),{inputId:a,isLabeledByFormItem:l,isChecked:d,isDisabled:h,isFocused:v,checkboxSize:g,hasOwnLabel:E,model:b,actualValue:S,handleChange:C,onClickRoot:w}=pG(o,s),I=Qe("checkbox"),R=U(()=>[I.b(),I.m(g.value),I.is("disabled",h.value),I.is("bordered",o.border),I.is("checked",d.value)]),N=U(()=>[I.e("input"),I.is("disabled",h.value),I.is("checked",d.value),I.is("indeterminate",o.indeterminate),I.is("focus",v.value)]);return(O,V)=>($(),Ve(gn(!p(E)&&p(l)?"span":"label"),{class:K(p(R)),"aria-controls":O.indeterminate?O.ariaControls:null,onClick:p(w)},{default:Ce(()=>{var L,D,M,F;return[ue("span",{class:K(p(N))},[O.trueValue||O.falseValue||O.trueLabel||O.falseLabel?ln(($(),le("input",{key:0,id:p(a),"onUpdate:modelValue":W=>xr(b)?b.value=W:null,class:K(p(I).e("original")),type:"checkbox",indeterminate:O.indeterminate,name:O.name,tabindex:O.tabindex,disabled:p(h),"true-value":(D=(L=O.trueValue)!=null?L:O.trueLabel)!=null?D:!0,"false-value":(F=(M=O.falseValue)!=null?M:O.falseLabel)!=null?F:!1,onChange:p(C),onFocus:W=>v.value=!0,onBlur:W=>v.value=!1,onClick:Gt(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[gS,p(b)]]):ln(($(),le("input",{key:1,id:p(a),"onUpdate:modelValue":W=>xr(b)?b.value=W:null,class:K(p(I).e("original")),type:"checkbox",indeterminate:O.indeterminate,disabled:p(h),value:p(S),name:O.name,tabindex:O.tabindex,onChange:p(C),onFocus:W=>v.value=!0,onBlur:W=>v.value=!1,onClick:Gt(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[gS,p(b)]]),ue("span",{class:K(p(I).e("inner"))},null,2)],2),p(E)?($(),le("span",{key:0,class:K(p(I).e("label"))},[Ne(O.$slots,"default"),O.$slots.default?De("v-if",!0):($(),le(Ut,{key:0},[bn(ot(O.label),1)],64))],2)):De("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var ewe=dt(QCe,[["__file","checkbox.vue"]]);const twe=me({name:"ElCheckboxButton"}),nwe=me({...twe,props:hG,emits:fG,setup(t){const o=t,s=Jo(),{isFocused:a,isChecked:l,isDisabled:d,checkboxButtonSize:h,model:v,actualValue:g,handleChange:E}=pG(o,s),b=It(gm,void 0),S=Qe("checkbox"),C=U(()=>{var I,R,N,O;const V=(R=(I=b==null?void 0:b.fill)==null?void 0:I.value)!=null?R:"";return{backgroundColor:V,borderColor:V,color:(O=(N=b==null?void 0:b.textColor)==null?void 0:N.value)!=null?O:"",boxShadow:V?`-1px 0 0 0 ${V}`:void 0}}),w=U(()=>[S.b("button"),S.bm("button",h.value),S.is("disabled",d.value),S.is("checked",l.value),S.is("focus",a.value)]);return(I,R)=>{var N,O,V,L;return $(),le("label",{class:K(p(w))},[I.trueValue||I.falseValue||I.trueLabel||I.falseLabel?ln(($(),le("input",{key:0,"onUpdate:modelValue":D=>xr(v)?v.value=D:null,class:K(p(S).be("button","original")),type:"checkbox",name:I.name,tabindex:I.tabindex,disabled:p(d),"true-value":(O=(N=I.trueValue)!=null?N:I.trueLabel)!=null?O:!0,"false-value":(L=(V=I.falseValue)!=null?V:I.falseLabel)!=null?L:!1,onChange:p(E),onFocus:D=>a.value=!0,onBlur:D=>a.value=!1,onClick:Gt(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[gS,p(v)]]):ln(($(),le("input",{key:1,"onUpdate:modelValue":D=>xr(v)?v.value=D:null,class:K(p(S).be("button","original")),type:"checkbox",name:I.name,tabindex:I.tabindex,disabled:p(d),value:p(g),onChange:p(E),onFocus:D=>a.value=!0,onBlur:D=>a.value=!1,onClick:Gt(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[gS,p(v)]]),I.$slots.default||I.label?($(),le("span",{key:2,class:K(p(S).be("button","inner")),style:jt(p(l)?p(C):void 0)},[Ne(I.$slots,"default",{},()=>[bn(ot(I.label),1)])],6)):De("v-if",!0)],2)}}});var mG=dt(nwe,[["__file","checkbox-button.vue"]]);const rwe=ut({modelValue:{type:Re(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Ho,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...Cs(["ariaLabel"])}),owe={[Jt]:t=>st(t),change:t=>st(t)},swe=me({name:"ElCheckboxGroup"}),iwe=me({...swe,props:rwe,emits:owe,setup(t,{emit:o}){const s=t,a=Qe("checkbox"),{formItem:l}=Vs(),{inputId:d,isLabeledByFormItem:h}=Ka(s,{formItemContext:l}),v=async E=>{o(Jt,E),await Vt(),o(yn,E)},g=U({get(){return s.modelValue},set(E){v(E)}});return wn(gm,{...mc(ds(s),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:g,changeEvent:v}),ze(()=>s.modelValue,()=>{s.validateEvent&&(l==null||l.validate("change").catch(E=>void 0))}),(E,b)=>{var S;return $(),Ve(gn(E.tag),{id:p(d),class:K(p(a).b("group")),role:"group","aria-label":p(h)?void 0:E.ariaLabel||"checkbox-group","aria-labelledby":p(h)?(S=p(l))==null?void 0:S.labelId:void 0},{default:Ce(()=>[Ne(E.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var vG=dt(iwe,[["__file","checkbox-group.vue"]]);const Wa=rn(ewe,{CheckboxButton:mG,CheckboxGroup:vG}),awe=uo(mG),gG=uo(vG),_G=ut({modelValue:{type:[String,Number,Boolean],default:void 0},size:Ho,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),cwe=ut({..._G,border:Boolean}),EG={[Jt]:t=>Mt(t)||$t(t)||wr(t),[yn]:t=>Mt(t)||$t(t)||wr(t)},yG=Symbol("radioGroupKey"),bG=(t,o)=>{const s=ee(),a=It(yG,void 0),l=U(()=>!!a),d=U(()=>Ec(t.value)?t.label:t.value),h=U({get(){return l.value?a.modelValue:t.modelValue},set(S){l.value?a.changeEvent(S):o&&o(Jt,S),s.value.checked=t.modelValue===d.value}}),v=xo(U(()=>a==null?void 0:a.size)),g=Fs(U(()=>a==null?void 0:a.disabled)),E=ee(!1),b=U(()=>g.value||l.value&&h.value!==d.value?-1:0);return od({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},U(()=>l.value&&Ec(t.value))),{radioRef:s,isGroup:l,radioGroup:a,focus:E,size:v,disabled:g,tabIndex:b,modelValue:h,actualValue:d}},lwe=me({name:"ElRadio"}),uwe=me({...lwe,props:cwe,emits:EG,setup(t,{emit:o}){const s=t,a=Qe("radio"),{radioRef:l,radioGroup:d,focus:h,size:v,disabled:g,modelValue:E,actualValue:b}=bG(s,o);function S(){Vt(()=>o(yn,E.value))}return(C,w)=>{var I;return $(),le("label",{class:K([p(a).b(),p(a).is("disabled",p(g)),p(a).is("focus",p(h)),p(a).is("bordered",C.border),p(a).is("checked",p(E)===p(b)),p(a).m(p(v))])},[ue("span",{class:K([p(a).e("input"),p(a).is("disabled",p(g)),p(a).is("checked",p(E)===p(b))])},[ln(ue("input",{ref_key:"radioRef",ref:l,"onUpdate:modelValue":R=>xr(E)?E.value=R:null,class:K(p(a).e("original")),value:p(b),name:C.name||((I=p(d))==null?void 0:I.name),disabled:p(g),checked:p(E)===p(b),type:"radio",onFocus:R=>h.value=!0,onBlur:R=>h.value=!1,onChange:S,onClick:Gt(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[sW,p(E)]]),ue("span",{class:K(p(a).e("inner"))},null,2)],2),ue("span",{class:K(p(a).e("label")),onKeydown:Gt(()=>{},["stop"])},[Ne(C.$slots,"default",{},()=>[bn(ot(C.label),1)])],42,["onKeydown"])],2)}}});var dwe=dt(uwe,[["__file","radio.vue"]]);const hwe=ut({..._G}),fwe=me({name:"ElRadioButton"}),pwe=me({...fwe,props:hwe,setup(t){const o=t,s=Qe("radio"),{radioRef:a,focus:l,size:d,disabled:h,modelValue:v,radioGroup:g,actualValue:E}=bG(o),b=U(()=>({backgroundColor:(g==null?void 0:g.fill)||"",borderColor:(g==null?void 0:g.fill)||"",boxShadow:g!=null&&g.fill?`-1px 0 0 0 ${g.fill}`:"",color:(g==null?void 0:g.textColor)||""}));return(S,C)=>{var w;return $(),le("label",{class:K([p(s).b("button"),p(s).is("active",p(v)===p(E)),p(s).is("disabled",p(h)),p(s).is("focus",p(l)),p(s).bm("button",p(d))])},[ln(ue("input",{ref_key:"radioRef",ref:a,"onUpdate:modelValue":I=>xr(v)?v.value=I:null,class:K(p(s).be("button","original-radio")),value:p(E),type:"radio",name:S.name||((w=p(g))==null?void 0:w.name),disabled:p(h),onFocus:I=>l.value=!0,onBlur:I=>l.value=!1,onClick:Gt(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[sW,p(v)]]),ue("span",{class:K(p(s).be("button","inner")),style:jt(p(v)===p(E)?p(b):{}),onKeydown:Gt(()=>{},["stop"])},[Ne(S.$slots,"default",{},()=>[bn(ot(S.label),1)])],46,["onKeydown"])],2)}}});var SG=dt(pwe,[["__file","radio-button.vue"]]);const mwe=ut({id:{type:String,default:void 0},size:Ho,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...Cs(["ariaLabel"])}),vwe=EG,gwe=me({name:"ElRadioGroup"}),_we=me({...gwe,props:mwe,emits:vwe,setup(t,{emit:o}){const s=t,a=Qe("radio"),l=Ts(),d=ee(),{formItem:h}=Vs(),{inputId:v,isLabeledByFormItem:g}=Ka(s,{formItemContext:h}),E=S=>{o(Jt,S),Vt(()=>o(yn,S))};dn(()=>{const S=d.value.querySelectorAll("[type=radio]"),C=S[0];!Array.from(S).some(w=>w.checked)&&C&&(C.tabIndex=0)});const b=U(()=>s.name||l.value);return wn(yG,er({...ds(s),changeEvent:E,name:b})),ze(()=>s.modelValue,()=>{s.validateEvent&&(h==null||h.validate("change").catch(S=>void 0))}),(S,C)=>($(),le("div",{id:p(v),ref_key:"radioGroupRef",ref:d,class:K(p(a).b("group")),role:"radiogroup","aria-label":p(g)?void 0:S.ariaLabel||"radio-group","aria-labelledby":p(g)?p(h).labelId:void 0},[Ne(S.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var TG=dt(_we,[["__file","radio-group.vue"]]);const CG=rn(dwe,{RadioButton:SG,RadioGroup:TG}),Ewe=uo(TG),ywe=uo(SG);var bwe=me({name:"NodeContent",setup(){return{ns:Qe("cascader-node")}},render(){const{ns:t}=this,{node:o,panel:s}=this.$parent,{data:a,label:l}=o,{renderLabelFn:d}=s;return Ht("span",{class:t.e("label")},d?d({node:o,data:a}):l)}});const fk=Symbol(),Swe=me({name:"ElCascaderNode",components:{ElCheckbox:Wa,ElRadio:CG,NodeContent:bwe,ElIcon:Dt,Check:l_,Loading:hl,ArrowRight:vi},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(t,{emit:o}){const s=It(fk),a=Qe("cascader-node"),l=U(()=>s.isHoverMenu),d=U(()=>s.config.multiple),h=U(()=>s.config.checkStrictly),v=U(()=>{var F;return(F=s.checkedNodes[0])==null?void 0:F.uid}),g=U(()=>t.node.isDisabled),E=U(()=>t.node.isLeaf),b=U(()=>h.value&&!E.value||!g.value),S=U(()=>w(s.expandingNode)),C=U(()=>h.value&&s.checkedNodes.some(w)),w=F=>{var W;const{level:z,uid:G}=t.node;return((W=F==null?void 0:F.pathNodes[z-1])==null?void 0:W.uid)===G},I=()=>{S.value||s.expandNode(t.node)},R=F=>{const{node:W}=t;F!==W.checked&&s.handleCheckChange(W,F)},N=()=>{s.lazyLoad(t.node,()=>{E.value||I()})},O=F=>{l.value&&(V(),!E.value&&o("expand",F))},V=()=>{const{node:F}=t;!b.value||F.loading||(F.loaded?I():N())},L=()=>{l.value&&!E.value||(E.value&&!g.value&&!h.value&&!d.value?M(!0):V())},D=F=>{h.value?(R(F),t.node.loaded&&I()):M(F)},M=F=>{t.node.loaded?(R(F),!h.value&&I()):N()};return{panel:s,isHoverMenu:l,multiple:d,checkStrictly:h,checkedNodeId:v,isDisabled:g,isLeaf:E,expandable:b,inExpandingPath:S,inCheckedPath:C,ns:a,handleHoverExpand:O,handleExpand:V,handleClick:L,handleCheck:M,handleSelectCheck:D}}});function Twe(t,o,s,a,l,d){const h=_n("el-checkbox"),v=_n("el-radio"),g=_n("check"),E=_n("el-icon"),b=_n("node-content"),S=_n("loading"),C=_n("arrow-right");return $(),le("li",{id:`${t.menuId}-${t.node.uid}`,role:"menuitem","aria-haspopup":!t.isLeaf,"aria-owns":t.isLeaf?void 0:t.menuId,"aria-expanded":t.inExpandingPath,tabindex:t.expandable?-1:void 0,class:K([t.ns.b(),t.ns.is("selectable",t.checkStrictly),t.ns.is("active",t.node.checked),t.ns.is("disabled",!t.expandable),t.inExpandingPath&&"in-active-path",t.inCheckedPath&&"in-checked-path"]),onMouseenter:t.handleHoverExpand,onFocus:t.handleHoverExpand,onClick:t.handleClick},[De(" prefix "),t.multiple?($(),Ve(h,{key:0,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:t.isDisabled,onClick:Gt(()=>{},["stop"]),"onUpdate:modelValue":t.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):t.checkStrictly?($(),Ve(v,{key:1,"model-value":t.checkedNodeId,label:t.node.uid,disabled:t.isDisabled,"onUpdate:modelValue":t.handleSelectCheck,onClick:Gt(()=>{},["stop"])},{default:Ce(()=>[De(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),ue("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):t.isLeaf&&t.node.checked?($(),Ve(E,{key:2,class:K(t.ns.e("prefix"))},{default:Ce(()=>[ge(g)]),_:1},8,["class"])):De("v-if",!0),De(" content "),ge(b),De(" postfix "),t.isLeaf?De("v-if",!0):($(),le(Ut,{key:3},[t.node.loading?($(),Ve(E,{key:0,class:K([t.ns.is("loading"),t.ns.e("postfix")])},{default:Ce(()=>[ge(S)]),_:1},8,["class"])):($(),Ve(E,{key:1,class:K(["arrow-right",t.ns.e("postfix")])},{default:Ce(()=>[ge(C)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var Cwe=dt(Swe,[["render",Twe],["__file","node.vue"]]);const wwe=me({name:"ElCascaderMenu",components:{Loading:hl,ElIcon:Dt,ElScrollbar:gl,ElCascaderNode:Cwe},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(t){const o=mn(),s=Qe("cascader-menu"),{t:a}=Fn(),l=Ts();let d=null,h=null;const v=It(fk),g=ee(null),E=U(()=>!t.nodes.length),b=U(()=>!v.initialLoaded),S=U(()=>`${l.value}-${t.index}`),C=N=>{d=N.target},w=N=>{if(!(!v.isHoverMenu||!d||!g.value))if(d.contains(N.target)){I();const O=o.vnode.el,{left:V}=O.getBoundingClientRect(),{offsetWidth:L,offsetHeight:D}=O,M=N.clientX-V,F=d.offsetTop,W=F+d.offsetHeight;g.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${M} ${F} L${L} 0 V${F} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${M} ${W} L${L} ${D} V${W} Z" />
        `}else h||(h=window.setTimeout(R,v.config.hoverThreshold))},I=()=>{h&&(clearTimeout(h),h=null)},R=()=>{g.value&&(g.value.innerHTML="",I())};return{ns:s,panel:v,hoverZone:g,isEmpty:E,isLoading:b,menuId:S,t:a,handleExpand:C,handleMouseMove:w,clearHoverZone:R}}});function Rwe(t,o,s,a,l,d){const h=_n("el-cascader-node"),v=_n("loading"),g=_n("el-icon"),E=_n("el-scrollbar");return $(),Ve(E,{key:t.menuId,tag:"ul",role:"menu",class:K(t.ns.b()),"wrap-class":t.ns.e("wrap"),"view-class":[t.ns.e("list"),t.ns.is("empty",t.isEmpty)],onMousemove:t.handleMouseMove,onMouseleave:t.clearHoverZone},{default:Ce(()=>{var b;return[($(!0),le(Ut,null,Cn(t.nodes,S=>($(),Ve(h,{key:S.uid,node:S,"menu-id":t.menuId,onExpand:t.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),t.isLoading?($(),le("div",{key:0,class:K(t.ns.e("empty-text"))},[ge(g,{size:"14",class:K(t.ns.is("loading"))},{default:Ce(()=>[ge(v)]),_:1},8,["class"]),bn(" "+ot(t.t("el.cascader.loading")),1)],2)):t.isEmpty?($(),le("div",{key:1,class:K(t.ns.e("empty-text"))},[Ne(t.$slots,"empty",{},()=>[bn(ot(t.t("el.cascader.noData")),1)])],2)):(b=t.panel)!=null&&b.isHoverMenu?($(),le(Ut,{key:2},[De(" eslint-disable-next-line vue/html-self-closing "),($(),le("svg",{ref:"hoverZone",class:K(t.ns.e("hover-zone"))},null,2))],2112)):De("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var Iwe=dt(wwe,[["render",Rwe],["__file","menu.vue"]]);const pk=(t="")=>t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),il=t=>e_(t);let Awe=0;const Owe=t=>{const o=[t];let{parent:s}=t;for(;s;)o.unshift(s),s=s.parent;return o};let nO=class rO{constructor(o,s,a,l=!1){this.data=o,this.config=s,this.parent=a,this.root=l,this.uid=Awe++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:d,label:h,children:v}=s,g=o[v],E=Owe(this);this.level=l?0:a?a.level+1:1,this.value=o[d],this.label=o[h],this.pathNodes=E,this.pathValues=E.map(b=>b.value),this.pathLabels=E.map(b=>b.label),this.childrenData=g,this.children=(g||[]).map(b=>new rO(b,s,this)),this.loaded=!s.lazy||this.isLeaf||!oa(g)}get isDisabled(){const{data:o,parent:s,config:a}=this,{disabled:l,checkStrictly:d}=a;return(Ft(l)?l(o,this):!!o[l])||!d&&(s==null?void 0:s.isDisabled)}get isLeaf(){const{data:o,config:s,childrenData:a,loaded:l}=this,{lazy:d,leaf:h}=s,v=Ft(h)?h(o,this):o[h];return Xn(v)?d&&!l?!1:!(st(a)&&a.length):!!v}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(o){const{childrenData:s,children:a}=this,l=new rO(o,this.config,this);return st(s)?s.push(o):this.childrenData=[o],a.push(l),l}calcText(o,s){const a=o?this.pathLabels.join(s):this.label;return this.text=a,a}broadcast(o,...s){const a=`onParent${il(o)}`;this.children.forEach(l=>{l&&(l.broadcast(o,...s),l[a]&&l[a](...s))})}emit(o,...s){const{parent:a}=this,l=`onChild${il(o)}`;a&&(a[l]&&a[l](...s),a.emit(o,...s))}onParentCheck(o){this.isDisabled||this.setCheckState(o)}onChildCheck(){const{children:o}=this,s=o.filter(l=>!l.isDisabled),a=s.length?s.every(l=>l.checked):!1;this.setCheckState(a)}setCheckState(o){const s=this.children.length,a=this.children.reduce((l,d)=>{const h=d.checked?1:d.indeterminate?.5:0;return l+h},0);this.checked=this.loaded&&this.children.filter(l=>!l.isDisabled).every(l=>l.loaded&&l.checked)&&o,this.indeterminate=this.loaded&&a!==s&&a>0}doCheck(o){if(this.checked===o)return;const{checkStrictly:s,multiple:a}=this.config;s||!a?this.checked=o:(this.broadcast("check",o),this.setCheckState(o),this.emit("check"))}};const oO=(t,o)=>t.reduce((s,a)=>(a.isLeaf?s.push(a):(!o&&s.push(a),s=s.concat(oO(a.children,o))),s),[]);class dH{constructor(o,s){this.config=s;const a=(o||[]).map(l=>new nO(l,this.config));this.nodes=a,this.allNodes=oO(a,!1),this.leafNodes=oO(a,!0)}getNodes(){return this.nodes}getFlattedNodes(o){return o?this.leafNodes:this.allNodes}appendNode(o,s){const a=s?s.appendChild(o):new nO(o,this.config);s||this.nodes.push(a),this.appendAllNodesAndLeafNodes(a)}appendNodes(o,s){o.forEach(a=>this.appendNode(a,s))}appendAllNodesAndLeafNodes(o){this.allNodes.push(o),o.isLeaf&&this.leafNodes.push(o),o.children&&o.children.forEach(s=>{this.appendAllNodesAndLeafNodes(s)})}getNodeByValue(o,s=!1){return!o&&o!==0?null:this.getFlattedNodes(s).find(l=>as(l.value,o)||as(l.pathValues,o))||null}getSameNode(o){return o&&this.getFlattedNodes(!1).find(({value:a,level:l})=>as(o.value,a)&&o.level===l)||null}}const wG=ut({modelValue:{type:Re([Number,String,Array])},options:{type:Re(Array),default:()=>[]},props:{type:Re(Object),default:()=>({})}}),Nwe={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:pr,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},kwe=t=>U(()=>({...Nwe,...t.props})),hH=t=>{if(!t)return 0;const o=t.id.split("-");return Number(o[o.length-2])},Pwe=t=>{if(!t)return;const o=t.querySelector("input");o?o.click():NK(t)&&t.click()},Dwe=(t,o)=>{const s=o.slice(0),a=s.map(d=>d.uid),l=t.reduce((d,h)=>{const v=a.indexOf(h.uid);return v>-1&&(d.push(h),s.splice(v,1),a.splice(v,1)),d},[]);return l.push(...s),l},fH=t=>[...new Set(t)],fi=t=>!t&&t!==0?[]:st(t)?t:[t],Lwe=me({name:"ElCascaderPanel",components:{ElCascaderMenu:Iwe},props:{...wG,border:{type:Boolean,default:!0},renderLabel:Function},emits:[Jt,yn,"close","expand-change"],setup(t,{emit:o,slots:s}){let a=!1;const l=Qe("cascader"),d=kwe(t);let h=null;const v=ee(!0),g=ee([]),E=ee(null),b=ee([]),S=ee(null),C=ee([]),w=U(()=>d.value.expandTrigger==="hover"),I=U(()=>t.renderLabel||s.default),R=()=>{const{options:Z}=t,fe=d.value;a=!1,h=new dH(Z,fe),b.value=[h.getNodes()],fe.lazy&&oa(t.options)?(v.value=!1,N(void 0,Ee=>{Ee&&(h=new dH(Ee,fe),b.value=[h.getNodes()]),v.value=!0,z(!1,!0)})):z(!1,!0)},N=(Z,fe)=>{const Ee=d.value;Z=Z||new nO({},Ee,void 0,!0),Z.loading=!0;const ae=X=>{const ie=Z,se=ie.root?null:ie;X&&(h==null||h.appendNodes(X,se)),ie.loading=!1,ie.loaded=!0,ie.childrenData=ie.childrenData||[],fe&&fe(X)};Ee.lazyLoad(Z,ae)},O=(Z,fe)=>{var Ee;const{level:ae}=Z,X=b.value.slice(0,ae);let ie;Z.isLeaf?ie=Z.pathNodes[ae-2]:(ie=Z,X.push(Z.children)),((Ee=S.value)==null?void 0:Ee.uid)!==(ie==null?void 0:ie.uid)&&(S.value=Z,b.value=X,!fe&&o("expand-change",(Z==null?void 0:Z.pathValues)||[]))},V=(Z,fe,Ee=!0)=>{const{checkStrictly:ae,multiple:X}=d.value,ie=C.value[0];a=!0,!X&&(ie==null||ie.doCheck(!1)),Z.doCheck(fe),W(),Ee&&!X&&!ae&&o("close"),!Ee&&!X&&!ae&&L(Z)},L=Z=>{Z&&(Z=Z.parent,L(Z),Z&&O(Z))},D=Z=>h==null?void 0:h.getFlattedNodes(Z),M=Z=>{var fe;return(fe=D(Z))==null?void 0:fe.filter(Ee=>Ee.checked!==!1)},F=()=>{C.value.forEach(Z=>Z.doCheck(!1)),W(),b.value=b.value.slice(0,1),S.value=null,o("expand-change",[])},W=()=>{var Z;const{checkStrictly:fe,multiple:Ee}=d.value,ae=C.value,X=M(!fe),ie=Dwe(ae,X),se=ie.map(J=>J.valueByOption);C.value=ie,E.value=Ee?se:(Z=se[0])!=null?Z:null},z=(Z=!1,fe=!1)=>{const{modelValue:Ee}=t,{lazy:ae,multiple:X,checkStrictly:ie}=d.value,se=!ie;if(!(!v.value||a||!fe&&as(Ee,E.value)))if(ae&&!Z){const pe=fH(D_e(fi(Ee))).map(be=>h==null?void 0:h.getNodeByValue(be)).filter(be=>!!be&&!be.loaded&&!be.loading);pe.length?pe.forEach(be=>{N(be,()=>z(!1,fe))}):z(!0,fe)}else{const J=X?fi(Ee):[Ee],pe=fH(J.map(be=>h==null?void 0:h.getNodeByValue(be,se)));G(pe,fe),E.value=yS(Ee)}},G=(Z,fe=!0)=>{const{checkStrictly:Ee}=d.value,ae=C.value,X=Z.filter(J=>!!J&&(Ee||J.isLeaf)),ie=h==null?void 0:h.getSameNode(S.value),se=fe&&ie||X[0];se?se.pathNodes.forEach(J=>O(J,!0)):S.value=null,ae.forEach(J=>J.doCheck(!1)),er(X).forEach(J=>J.doCheck(!0)),C.value=X,Vt(Y)},Y=()=>{Vn&&g.value.forEach(Z=>{const fe=Z==null?void 0:Z.$el;if(fe){const Ee=fe.querySelector(`.${l.namespace.value}-scrollbar__wrap`),ae=fe.querySelector(`.${l.b("node")}.${l.is("active")}`)||fe.querySelector(`.${l.b("node")}.in-active-path`);WN(Ee,ae)}})},te=Z=>{const fe=Z.target,{code:Ee}=Z;switch(Ee){case Ct.up:case Ct.down:{Z.preventDefault();const ae=Ee===Ct.up?-1:1;Wb(kK(fe,ae,`.${l.b("node")}[tabindex="-1"]`));break}case Ct.left:{Z.preventDefault();const ae=g.value[hH(fe)-1],X=ae==null?void 0:ae.$el.querySelector(`.${l.b("node")}[aria-expanded="true"]`);Wb(X);break}case Ct.right:{Z.preventDefault();const ae=g.value[hH(fe)+1],X=ae==null?void 0:ae.$el.querySelector(`.${l.b("node")}[tabindex="-1"]`);Wb(X);break}case Ct.enter:case Ct.numpadEnter:Pwe(fe);break}};return wn(fk,er({config:d,expandingNode:S,checkedNodes:C,isHoverMenu:w,initialLoaded:v,renderLabelFn:I,lazyLoad:N,expandNode:O,handleCheckChange:V})),ze([d,()=>t.options],R,{deep:!0,immediate:!0}),ze(()=>t.modelValue,()=>{a=!1,z()},{deep:!0}),ze(()=>E.value,Z=>{as(Z,t.modelValue)||(o(Jt,Z),o(yn,Z))}),w5(()=>g.value=[]),dn(()=>!oa(t.modelValue)&&z()),{ns:l,menuList:g,menus:b,checkedNodes:C,handleKeyDown:te,handleCheckChange:V,getFlattedNodes:D,getCheckedNodes:M,clearCheckedNodes:F,calculateCheckedValue:W,scrollToExpandingNode:Y}}});function Mwe(t,o,s,a,l,d){const h=_n("el-cascader-menu");return $(),le("div",{class:K([t.ns.b("panel"),t.ns.is("bordered",t.border)]),onKeydown:t.handleKeyDown},[($(!0),le(Ut,null,Cn(t.menus,(v,g)=>($(),Ve(h,{key:g,ref_for:!0,ref:E=>t.menuList[g]=E,index:g,nodes:[...v]},{empty:Ce(()=>[Ne(t.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var xwe=dt(Lwe,[["render",Mwe],["__file","index.vue"]]);const RG=rn(xwe),nu=ut({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:vl},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Uwe={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},Vwe=me({name:"ElTag"}),Fwe=me({...Vwe,props:nu,emits:Uwe,setup(t,{emit:o}){const s=t,a=xo(),l=Qe("tag"),d=U(()=>{const{type:E,hit:b,effect:S,closable:C,round:w}=s;return[l.b(),l.is("closable",C),l.m(E||"primary"),l.m(a.value),l.m(S),l.is("hit",b),l.is("round",w)]}),h=E=>{o("close",E)},v=E=>{o("click",E)},g=E=>{var b,S,C;(C=(S=(b=E==null?void 0:E.component)==null?void 0:b.subTree)==null?void 0:S.component)!=null&&C.bum&&(E.component.subTree.component.bum=null)};return(E,b)=>E.disableTransitions?($(),le("span",{key:0,class:K(p(d)),style:jt({backgroundColor:E.color}),onClick:v},[ue("span",{class:K(p(l).e("content"))},[Ne(E.$slots,"default")],2),E.closable?($(),Ve(p(Dt),{key:0,class:K(p(l).e("close")),onClick:Gt(h,["stop"])},{default:Ce(()=>[ge(p(Sc))]),_:1},8,["class","onClick"])):De("v-if",!0)],6)):($(),Ve(hs,{key:1,name:`${p(l).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:g},{default:Ce(()=>[ue("span",{class:K(p(d)),style:jt({backgroundColor:E.color}),onClick:v},[ue("span",{class:K(p(l).e("content"))},[Ne(E.$slots,"default")],2),E.closable?($(),Ve(p(Dt),{key:0,class:K(p(l).e("close")),onClick:Gt(h,["stop"])},{default:Ce(()=>[ge(p(Sc))]),_:1},8,["class","onClick"])):De("v-if",!0)],6)]),_:3},8,["name"]))}});var Bwe=dt(Fwe,[["__file","tag.vue"]]);const Jp=rn(Bwe),jwe=ut({...wG,size:Ho,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:Re(Function),default:(t,o)=>t.text.includes(o)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:Re(Function),default:()=>!0},placement:{type:Re(String),values:hu,default:"bottom-start"},fallbackPlacements:{type:Re(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:ss.teleported,tagType:{...nu.type,default:"info"},tagEffect:{...nu.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...pm}),$we={[Jt]:t=>!0,[yn]:t=>!0,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,visibleChange:t=>wr(t),expandChange:t=>!!t,removeTag:t=>!!t},qu=new Map;if(Vn){let t;document.addEventListener("mousedown",o=>t=o),document.addEventListener("mouseup",o=>{if(t){for(const s of qu.values())for(const{documentHandler:a}of s)a(o,t);t=void 0}})}function pH(t,o){let s=[];return st(o.arg)?s=o.arg:mi(o.arg)&&s.push(o.arg),function(a,l){const d=o.instance.popperRef,h=a.target,v=l==null?void 0:l.target,g=!o||!o.instance,E=!h||!v,b=t.contains(h)||t.contains(v),S=t===h,C=s.length&&s.some(I=>I==null?void 0:I.contains(h))||s.length&&s.includes(v),w=d&&(d.contains(h)||d.contains(v));g||E||b||S||C||w||o.value(a,l)}}const ru={beforeMount(t,o){qu.has(t)||qu.set(t,[]),qu.get(t).push({documentHandler:pH(t,o),bindingFn:o.value})},updated(t,o){qu.has(t)||qu.set(t,[]);const s=qu.get(t),a=s.findIndex(d=>d.bindingFn===o.oldValue),l={documentHandler:pH(t,o),bindingFn:o.value};a>=0?s.splice(a,1,l):s.push(l)},unmounted(t){qu.delete(t)}},Hwe="ElCascader",Wwe=me({name:Hwe}),Kwe=me({...Wwe,props:jwe,emits:$we,setup(t,{expose:o,emit:s}){const a=t,l={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:Ie})=>{const{modifiersData:Ke,placement:Te}=Ie;["right","left","bottom","top"].includes(Te)||(Ke.arrow.x=35)},requires:["arrow"]}]},d=au();let h=0,v=0;const g=Qe("cascader"),E=Qe("input"),{t:b}=Fn(),{form:S,formItem:C}=Vs(),{valueOnClear:w}=f0(a),{isComposing:I,handleComposition:R}=d_({afterComposition(Ie){var Ke;const Te=(Ke=Ie.target)==null?void 0:Ke.value;Wt(Te)}}),N=ee(null),O=ee(null),V=ee(null),L=ee(null),D=ee(null),M=ee(!1),F=ee(!1),W=ee(!1),z=ee(!1),G=ee(""),Y=ee(""),te=ee([]),Z=ee([]),fe=ee([]),Ee=U(()=>d.style),ae=U(()=>a.disabled||(S==null?void 0:S.disabled)),X=U(()=>a.placeholder||b("el.cascader.placeholder")),ie=U(()=>Y.value||te.value.length>0||I.value?"":X.value),se=xo(),J=U(()=>se.value==="small"?"small":"default"),pe=U(()=>!!a.props.multiple),be=U(()=>!a.filterable||pe.value),Ae=U(()=>pe.value?Y.value:G.value),_e=U(()=>{var Ie;return((Ie=L.value)==null?void 0:Ie.checkedNodes)||[]}),Me=U(()=>!a.clearable||ae.value||W.value||!F.value?!1:!!_e.value.length),Fe=U(()=>{const{showAllLevels:Ie,separator:Ke}=a,Te=_e.value;return Te.length?pe.value?"":Te[0].calcText(Ie,Ke):""}),Le=U(()=>(C==null?void 0:C.validateState)||""),Pe=U({get(){return yS(a.modelValue)},set(Ie){const Ke=Ie??w.value;s(Jt,Ke),s(yn,Ke),a.validateEvent&&(C==null||C.validate("change").catch(Te=>void 0))}}),He=U(()=>[g.b(),g.m(se.value),g.is("disabled",ae.value),d.class]),We=U(()=>[E.e("icon"),"icon-arrow-down",g.is("reverse",M.value)]),yt=U(()=>g.is("focus",M.value||z.value)),it=U(()=>{var Ie,Ke;return(Ke=(Ie=N.value)==null?void 0:Ie.popperRef)==null?void 0:Ke.contentRef}),ce=Ie=>{var Ke,Te,vt;ae.value||(Ie=Ie??!M.value,Ie!==M.value&&(M.value=Ie,(Te=(Ke=O.value)==null?void 0:Ke.input)==null||Te.setAttribute("aria-expanded",`${Ie}`),Ie?(Se(),Vt((vt=L.value)==null?void 0:vt.scrollToExpandingNode)):a.filterable&&wt(),s("visibleChange",Ie)))},Se=()=>{Vt(()=>{var Ie;(Ie=N.value)==null||Ie.updatePopper()})},je=()=>{W.value=!1},tt=Ie=>{const{showAllLevels:Ke,separator:Te}=a;return{node:Ie,key:Ie.uid,text:Ie.calcText(Ke,Te),hitState:!1,closable:!ae.value&&!Ie.isDisabled,isCollapseTag:!1}},et=Ie=>{var Ke;const Te=Ie.node;Te.doCheck(!1),(Ke=L.value)==null||Ke.calculateCheckedValue(),s("removeTag",Te.valueByOption)},Ge=()=>{if(!pe.value)return;const Ie=_e.value,Ke=[],Te=[];if(Ie.forEach(vt=>Te.push(tt(vt))),Z.value=Te,Ie.length){Ie.slice(0,a.maxCollapseTags).forEach(en=>Ke.push(tt(en)));const vt=Ie.slice(a.maxCollapseTags),an=vt.length;an&&(a.collapseTags?Ke.push({key:-1,text:`+ ${an}`,closable:!1,isCollapseTag:!0}):vt.forEach(en=>Ke.push(tt(en))))}te.value=Ke},Xe=()=>{var Ie,Ke;const{filterMethod:Te,showAllLevels:vt,separator:an}=a,en=(Ke=(Ie=L.value)==null?void 0:Ie.getFlattedNodes(!a.props.checkStrictly))==null?void 0:Ke.filter(Ir=>Ir.isDisabled?!1:(Ir.calcText(vt,an),Te(Ir,Ae.value)));pe.value&&(te.value.forEach(Ir=>{Ir.hitState=!1}),Z.value.forEach(Ir=>{Ir.hitState=!1})),W.value=!0,fe.value=en,Se()},Ye=()=>{var Ie;let Ke;W.value&&D.value?Ke=D.value.$el.querySelector(`.${g.e("suggestion-item")}`):Ke=(Ie=L.value)==null?void 0:Ie.$el.querySelector(`.${g.b("node")}[tabindex="-1"]`),Ke&&(Ke.focus(),!W.value&&Ke.click())},ct=()=>{var Ie,Ke;const Te=(Ie=O.value)==null?void 0:Ie.input,vt=V.value,an=(Ke=D.value)==null?void 0:Ke.$el;if(!(!Vn||!Te)){if(an){const en=an.querySelector(`.${g.e("suggestion-list")}`);en.style.minWidth=`${Te.offsetWidth}px`}if(vt){const{offsetHeight:en}=vt,Ir=te.value.length>0?`${Math.max(en,h)-2}px`:`${h}px`;Te.style.height=Ir,Se()}}},nt=Ie=>{var Ke;return(Ke=L.value)==null?void 0:Ke.getCheckedNodes(Ie)},Ot=Ie=>{Se(),s("expandChange",Ie)},_t=Ie=>{if(!I.value)switch(Ie.code){case Ct.enter:case Ct.numpadEnter:ce();break;case Ct.down:ce(!0),Vt(Ye),Ie.preventDefault();break;case Ct.esc:M.value===!0&&(Ie.preventDefault(),Ie.stopPropagation(),ce(!1));break;case Ct.tab:ce(!1);break}},qe=()=>{var Ie;(Ie=L.value)==null||Ie.clearCheckedNodes(),!M.value&&a.filterable&&wt(),ce(!1),s("clear")},wt=()=>{const{value:Ie}=Fe;G.value=Ie,Y.value=Ie},qt=Ie=>{var Ke,Te;const{checked:vt}=Ie;pe.value?(Ke=L.value)==null||Ke.handleCheckChange(Ie,!vt,!1):(!vt&&((Te=L.value)==null||Te.handleCheckChange(Ie,!0,!1)),ce(!1))},sn=Ie=>{const Ke=Ie.target,{code:Te}=Ie;switch(Te){case Ct.up:case Ct.down:{Ie.preventDefault();const vt=Te===Ct.up?-1:1;Wb(kK(Ke,vt,`.${g.e("suggestion-item")}[tabindex="-1"]`));break}case Ct.enter:case Ct.numpadEnter:Ke.click();break}},tn=()=>{const Ie=te.value,Ke=Ie[Ie.length-1];v=Y.value?0:v+1,!(!Ke||!v||a.collapseTags&&Ie.length>1)&&(Ke.hitState?et(Ke):Ke.hitState=!0)},Kn=Ie=>{const Ke=Ie.target,Te=g.e("search-input");Ke.className===Te&&(z.value=!0),s("focus",Ie)},Sn=Ie=>{z.value=!1,s("blur",Ie)},zr=Hi(()=>{const{value:Ie}=Ae;if(!Ie)return;const Ke=a.beforeFilter(Ie);Tg(Ke)?Ke.then(Xe).catch(()=>{}):Ke!==!1?Xe():je()},a.debounce),Wt=(Ie,Ke)=>{!M.value&&ce(!0),!(Ke!=null&&Ke.isComposing)&&(Ie?zr():je())},Je=Ie=>Number.parseFloat(pEe(E.cssVarName("input-height"),Ie).value)-2;return ze(W,Se),ze([_e,ae,()=>a.collapseTags],Ge),ze(te,()=>{Vt(()=>ct())}),ze(se,async()=>{await Vt();const Ie=O.value.input;h=Je(Ie)||h,ct()}),ze(Fe,wt,{immediate:!0}),dn(()=>{const Ie=O.value.input,Ke=Je(Ie);h=Ie.offsetHeight||Ke,co(Ie,ct)}),o({getCheckedNodes:nt,cascaderPanelRef:L,togglePopperVisible:ce,contentRef:it,presentText:Fe}),(Ie,Ke)=>($(),Ve(p(Us),{ref_key:"tooltipRef",ref:N,visible:M.value,teleported:Ie.teleported,"popper-class":[p(g).e("dropdown"),Ie.popperClass],"popper-options":l,"fallback-placements":Ie.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:Ie.placement,transition:`${p(g).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:Ie.persistent,onHide:je},{default:Ce(()=>[ln(($(),le("div",{class:K(p(He)),style:jt(p(Ee)),onClick:()=>ce(p(be)?void 0:!0),onKeydown:_t,onMouseenter:Te=>F.value=!0,onMouseleave:Te=>F.value=!1},[ge(p(ei),{ref_key:"input",ref:O,modelValue:G.value,"onUpdate:modelValue":Te=>G.value=Te,placeholder:p(ie),readonly:p(be),disabled:p(ae),"validate-event":!1,size:p(se),class:K(p(yt)),tabindex:p(pe)&&Ie.filterable&&!p(ae)?-1:void 0,onCompositionstart:p(R),onCompositionupdate:p(R),onCompositionend:p(R),onFocus:Kn,onBlur:Sn,onInput:Wt},fa({suffix:Ce(()=>[p(Me)?($(),Ve(p(Dt),{key:"clear",class:K([p(E).e("icon"),"icon-circle-close"]),onClick:Gt(qe,["stop"])},{default:Ce(()=>[ge(p(du))]),_:1},8,["class","onClick"])):($(),Ve(p(Dt),{key:"arrow-down",class:K(p(We)),onClick:Gt(Te=>ce(),["stop"])},{default:Ce(()=>[ge(p(uu))]),_:1},8,["class","onClick"]))]),_:2},[Ie.$slots.prefix?{name:"prefix",fn:Ce(()=>[Ne(Ie.$slots,"prefix")])}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),p(pe)?($(),le("div",{key:0,ref_key:"tagWrapper",ref:V,class:K([p(g).e("tags"),p(g).is("validate",!!p(Le))])},[($(!0),le(Ut,null,Cn(te.value,Te=>($(),Ve(p(Jp),{key:Te.key,type:Ie.tagType,size:p(J),effect:Ie.tagEffect,hit:Te.hitState,closable:Te.closable,"disable-transitions":"",onClose:vt=>et(Te)},{default:Ce(()=>[Te.isCollapseTag===!1?($(),le("span",{key:0},ot(Te.text),1)):($(),Ve(p(Us),{key:1,disabled:M.value||!Ie.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:Ce(()=>[ue("span",null,ot(Te.text),1)]),content:Ce(()=>[ue("div",{class:K(p(g).e("collapse-tags"))},[($(!0),le(Ut,null,Cn(Z.value.slice(Ie.maxCollapseTags),(vt,an)=>($(),le("div",{key:an,class:K(p(g).e("collapse-tag"))},[($(),Ve(p(Jp),{key:vt.key,class:"in-tooltip",type:Ie.tagType,size:p(J),effect:Ie.tagEffect,hit:vt.hitState,closable:vt.closable,"disable-transitions":"",onClose:en=>et(vt)},{default:Ce(()=>[ue("span",null,ot(vt.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),Ie.filterable&&!p(ae)?ln(($(),le("input",{key:0,"onUpdate:modelValue":Te=>Y.value=Te,type:"text",class:K(p(g).e("search-input")),placeholder:p(Fe)?"":p(X),onInput:Te=>Wt(Y.value,Te),onClick:Gt(Te=>ce(!0),["stop"]),onKeydown:Cr(tn,["delete"]),onCompositionstart:p(R),onCompositionupdate:p(R),onCompositionend:p(R),onFocus:Kn,onBlur:Sn},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[o0,Y.value]]):De("v-if",!0)],2)):De("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[p(ru),()=>ce(!1),p(it)]])]),content:Ce(()=>[ln(ge(p(RG),{ref_key:"cascaderPanelRef",ref:L,modelValue:p(Pe),"onUpdate:modelValue":Te=>xr(Pe)?Pe.value=Te:null,options:Ie.options,props:a.props,border:!1,"render-label":Ie.$slots.default,onExpandChange:Ot,onClose:Te=>Ie.$nextTick(()=>ce(!1))},{empty:Ce(()=>[Ne(Ie.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[Wn,!W.value]]),Ie.filterable?ln(($(),Ve(p(gl),{key:0,ref_key:"suggestionPanel",ref:D,tag:"ul",class:K(p(g).e("suggestion-panel")),"view-class":p(g).e("suggestion-list"),onKeydown:sn},{default:Ce(()=>[fe.value.length?($(!0),le(Ut,{key:0},Cn(fe.value,Te=>($(),le("li",{key:Te.uid,class:K([p(g).e("suggestion-item"),p(g).is("checked",Te.checked)]),tabindex:-1,onClick:vt=>qt(Te)},[Ne(Ie.$slots,"suggestion-item",{item:Te},()=>[ue("span",null,ot(Te.text),1),Te.checked?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[ge(p(l_))]),_:1})):De("v-if",!0)])],10,["onClick"]))),128)):Ne(Ie.$slots,"empty",{key:1},()=>[ue("li",{class:K(p(g).e("empty-text"))},ot(p(b)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Wn,W.value]]):De("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var Gwe=dt(Kwe,[["__file","cascader.vue"]]);const zwe=rn(Gwe),Ywe=ut({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),qwe={"update:checked":t=>wr(t),[yn]:t=>wr(t)},Xwe=me({name:"ElCheckTag"}),Jwe=me({...Xwe,props:Ywe,emits:qwe,setup(t,{emit:o}){const s=t,a=Qe("check-tag"),l=U(()=>s.disabled),d=U(()=>[a.b(),a.is("checked",s.checked),a.is("disabled",l.value),a.m(s.type||"primary")]),h=()=>{if(l.value)return;const v=!s.checked;o(yn,v),o("update:checked",v)};return(v,g)=>($(),le("span",{class:K(p(d)),onClick:h},[Ne(v.$slots,"default")],2))}});var Zwe=dt(Jwe,[["__file","check-tag.vue"]]);const Qwe=rn(Zwe),eRe=ut({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Re([Number,Object]),default:()=>lo({})},sm:{type:Re([Number,Object]),default:()=>lo({})},md:{type:Re([Number,Object]),default:()=>lo({})},lg:{type:Re([Number,Object]),default:()=>lo({})},xl:{type:Re([Number,Object]),default:()=>lo({})}}),IG=Symbol("rowContextKey"),tRe=me({name:"ElCol"}),nRe=me({...tRe,props:eRe,setup(t){const o=t,{gutter:s}=It(IG,{gutter:U(()=>0)}),a=Qe("col"),l=U(()=>{const h={};return s.value&&(h.paddingLeft=h.paddingRight=`${s.value/2}px`),h}),d=U(()=>{const h=[];return["span","offset","pull","push"].forEach(E=>{const b=o[E];$t(b)&&(E==="span"?h.push(a.b(`${o[E]}`)):b>0&&h.push(a.b(`${E}-${o[E]}`)))}),["xs","sm","md","lg","xl"].forEach(E=>{$t(o[E])?h.push(a.b(`${E}-${o[E]}`)):fn(o[E])&&Object.entries(o[E]).forEach(([b,S])=>{h.push(b!=="span"?a.b(`${E}-${b}-${S}`):a.b(`${E}-${S}`))})}),s.value&&h.push(a.is("guttered")),[a.b(),h]});return(h,v)=>($(),Ve(gn(h.tag),{class:K(p(d)),style:jt(p(l))},{default:Ce(()=>[Ne(h.$slots,"default")]),_:3},8,["class","style"]))}});var rRe=dt(nRe,[["__file","col.vue"]]);const oRe=rn(rRe),mH=t=>$t(t)||Mt(t)||st(t),sRe=ut({accordion:Boolean,modelValue:{type:Re([Array,String,Number]),default:()=>lo([])}}),iRe={[Jt]:mH,[yn]:mH},AG=Symbol("collapseContextKey"),aRe=(t,o)=>{const s=ee(Js(t.modelValue)),a=d=>{s.value=d;const h=t.accordion?s.value[0]:s.value;o(Jt,h),o(yn,h)},l=d=>{if(t.accordion)a([s.value[0]===d?"":d]);else{const h=[...s.value],v=h.indexOf(d);v>-1?h.splice(v,1):h.push(d),a(h)}};return ze(()=>t.modelValue,()=>s.value=Js(t.modelValue),{deep:!0}),wn(AG,{activeNames:s,handleItemClick:l}),{activeNames:s,setActiveNames:a}},cRe=()=>{const t=Qe("collapse");return{rootKls:U(()=>t.b())}},lRe=me({name:"ElCollapse"}),uRe=me({...lRe,props:sRe,emits:iRe,setup(t,{expose:o,emit:s}){const a=t,{activeNames:l,setActiveNames:d}=aRe(a,s),{rootKls:h}=cRe();return o({activeNames:l,setActiveNames:d}),(v,g)=>($(),le("div",{class:K(p(h))},[Ne(v.$slots,"default")],2))}});var dRe=dt(uRe,[["__file","collapse.vue"]]);const hRe=me({name:"ElCollapseTransition"}),fRe=me({...hRe,setup(t){const o=Qe("collapse-transition"),s=l=>{l.style.maxHeight="",l.style.overflow=l.dataset.oldOverflow,l.style.paddingTop=l.dataset.oldPaddingTop,l.style.paddingBottom=l.dataset.oldPaddingBottom},a={beforeEnter(l){l.dataset||(l.dataset={}),l.dataset.oldPaddingTop=l.style.paddingTop,l.dataset.oldPaddingBottom=l.style.paddingBottom,l.style.height&&(l.dataset.elExistsHeight=l.style.height),l.style.maxHeight=0,l.style.paddingTop=0,l.style.paddingBottom=0},enter(l){requestAnimationFrame(()=>{l.dataset.oldOverflow=l.style.overflow,l.dataset.elExistsHeight?l.style.maxHeight=l.dataset.elExistsHeight:l.scrollHeight!==0?l.style.maxHeight=`${l.scrollHeight}px`:l.style.maxHeight=0,l.style.paddingTop=l.dataset.oldPaddingTop,l.style.paddingBottom=l.dataset.oldPaddingBottom,l.style.overflow="hidden"})},afterEnter(l){l.style.maxHeight="",l.style.overflow=l.dataset.oldOverflow},enterCancelled(l){s(l)},beforeLeave(l){l.dataset||(l.dataset={}),l.dataset.oldPaddingTop=l.style.paddingTop,l.dataset.oldPaddingBottom=l.style.paddingBottom,l.dataset.oldOverflow=l.style.overflow,l.style.maxHeight=`${l.scrollHeight}px`,l.style.overflow="hidden"},leave(l){l.scrollHeight!==0&&(l.style.maxHeight=0,l.style.paddingTop=0,l.style.paddingBottom=0)},afterLeave(l){s(l)},leaveCancelled(l){s(l)}};return(l,d)=>($(),Ve(hs,En({name:p(o).b()},ohe(a)),{default:Ce(()=>[Ne(l.$slots,"default")]),_:3},16,["name"]))}});var pRe=dt(fRe,[["__file","collapse-transition.vue"]]);const S0=rn(pRe),mRe=ut({title:{type:String,default:""},name:{type:Re([String,Number]),default:void 0},icon:{type:yr,default:vi},disabled:Boolean}),vRe=t=>{const o=It(AG),{namespace:s}=Qe("collapse"),a=ee(!1),l=ee(!1),d=ZN(),h=U(()=>d.current++),v=U(()=>{var C;return(C=t.name)!=null?C:`${s.value}-id-${d.prefix}-${p(h)}`}),g=U(()=>o==null?void 0:o.activeNames.value.includes(p(v)));return{focusing:a,id:h,isActive:g,handleFocus:()=>{setTimeout(()=>{l.value?l.value=!1:a.value=!0},50)},handleHeaderClick:()=>{t.disabled||(o==null||o.handleItemClick(p(v)),a.value=!1,l.value=!0)},handleEnterClick:()=>{o==null||o.handleItemClick(p(v))}}},gRe=(t,{focusing:o,isActive:s,id:a})=>{const l=Qe("collapse"),d=U(()=>[l.b("item"),l.is("active",p(s)),l.is("disabled",t.disabled)]),h=U(()=>[l.be("item","header"),l.is("active",p(s)),{focusing:p(o)&&!t.disabled}]),v=U(()=>[l.be("item","arrow"),l.is("active",p(s))]),g=U(()=>l.be("item","wrap")),E=U(()=>l.be("item","content")),b=U(()=>l.b(`content-${p(a)}`)),S=U(()=>l.b(`head-${p(a)}`));return{arrowKls:v,headKls:h,rootKls:d,itemWrapperKls:g,itemContentKls:E,scopedContentId:b,scopedHeadId:S}},_Re=me({name:"ElCollapseItem"}),ERe=me({..._Re,props:mRe,setup(t,{expose:o}){const s=t,{focusing:a,id:l,isActive:d,handleFocus:h,handleHeaderClick:v,handleEnterClick:g}=vRe(s),{arrowKls:E,headKls:b,rootKls:S,itemWrapperKls:C,itemContentKls:w,scopedContentId:I,scopedHeadId:R}=gRe(s,{focusing:a,isActive:d,id:l});return o({isActive:d}),(N,O)=>($(),le("div",{class:K(p(S))},[ue("button",{id:p(R),class:K(p(b)),"aria-expanded":p(d),"aria-controls":p(I),"aria-describedby":p(I),tabindex:N.disabled?-1:0,type:"button",onClick:p(v),onKeydown:Cr(Gt(p(g),["stop","prevent"]),["space","enter"]),onFocus:p(h),onBlur:V=>a.value=!1},[Ne(N.$slots,"title",{},()=>[bn(ot(N.title),1)]),Ne(N.$slots,"icon",{isActive:p(d)},()=>[ge(p(Dt),{class:K(p(E))},{default:Ce(()=>[($(),Ve(gn(N.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),ge(p(S0),null,{default:Ce(()=>[ln(ue("div",{id:p(I),role:"region",class:K(p(C)),"aria-hidden":!p(d),"aria-labelledby":p(R)},[ue("div",{class:K(p(w))},[Ne(N.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Wn,p(d)]])]),_:3})],2))}});var OG=dt(ERe,[["__file","collapse-item.vue"]]);const yRe=rn(dRe,{CollapseItem:OG}),bRe=uo(OG),SRe=ut({color:{type:Re(Object),required:!0},vertical:{type:Boolean,default:!1}});let uA=!1;function Bg(t,o){if(!Vn)return;const s=function(d){var h;(h=o.drag)==null||h.call(o,d)},a=function(d){var h;document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",a),document.onselectstart=null,document.ondragstart=null,uA=!1,(h=o.end)==null||h.call(o,d)},l=function(d){var h;uA||(d.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",s),document.addEventListener("mouseup",a),document.addEventListener("touchmove",s),document.addEventListener("touchend",a),uA=!0,(h=o.start)==null||h.call(o,d))};t.addEventListener("mousedown",l),t.addEventListener("touchstart",l,{passive:!1})}const TRe=(t,o)=>{if(!Vn||!t||!o)return!1;const s=t.getBoundingClientRect();let a;return o instanceof Element?a=o.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<a.bottom&&s.bottom>a.top&&s.right>a.left&&s.left<a.right},vH=t=>{let o=0,s=t;for(;s;)o+=s.offsetTop,s=s.offsetParent;return o},sO=(t,o)=>Math.abs(vH(t)-vH(o)),mk=t=>{let o,s;return t.type==="touchend"?(s=t.changedTouches[0].clientY,o=t.changedTouches[0].clientX):t.type.startsWith("touch")?(s=t.touches[0].clientY,o=t.touches[0].clientX):(s=t.clientY,o=t.clientX),{clientX:o,clientY:s}},CRe=t=>{const o=mn(),{t:s}=Fn(),a=Mr(),l=Mr(),d=U(()=>t.color.get("alpha")),h=U(()=>s("el.colorpicker.alphaLabel"));function v(S){var C;S.target!==a.value&&g(S),(C=a.value)==null||C.focus()}function g(S){if(!l.value||!a.value)return;const w=o.vnode.el.getBoundingClientRect(),{clientX:I,clientY:R}=mk(S);if(t.vertical){let N=R-w.top;N=Math.max(a.value.offsetHeight/2,N),N=Math.min(N,w.height-a.value.offsetHeight/2),t.color.set("alpha",Math.round((N-a.value.offsetHeight/2)/(w.height-a.value.offsetHeight)*100))}else{let N=I-w.left;N=Math.max(a.value.offsetWidth/2,N),N=Math.min(N,w.width-a.value.offsetWidth/2),t.color.set("alpha",Math.round((N-a.value.offsetWidth/2)/(w.width-a.value.offsetWidth)*100))}}function E(S){const{code:C,shiftKey:w}=S,I=w?10:1;switch(C){case Ct.left:case Ct.down:S.preventDefault(),S.stopPropagation(),b(-I);break;case Ct.right:case Ct.up:S.preventDefault(),S.stopPropagation(),b(I);break}}function b(S){let C=d.value+S;C=C<0?0:C>100?100:C,t.color.set("alpha",C)}return{thumb:a,bar:l,alpha:d,alphaLabel:h,handleDrag:g,handleClick:v,handleKeydown:E}},wRe=(t,{bar:o,thumb:s,handleDrag:a})=>{const l=mn(),d=Qe("color-alpha-slider"),h=ee(0),v=ee(0),g=ee();function E(){if(!s.value||t.vertical)return 0;const V=l.vnode.el,L=t.color.get("alpha");return V?Math.round(L*(V.offsetWidth-s.value.offsetWidth/2)/100):0}function b(){if(!s.value)return 0;const V=l.vnode.el;if(!t.vertical)return 0;const L=t.color.get("alpha");return V?Math.round(L*(V.offsetHeight-s.value.offsetHeight/2)/100):0}function S(){if(t.color&&t.color.value){const{r:V,g:L,b:D}=t.color.toRgb();return`linear-gradient(to right, rgba(${V}, ${L}, ${D}, 0) 0%, rgba(${V}, ${L}, ${D}, 1) 100%)`}return""}function C(){h.value=E(),v.value=b(),g.value=S()}dn(()=>{if(!o.value||!s.value)return;const V={drag:L=>{a(L)},end:L=>{a(L)}};Bg(o.value,V),Bg(s.value,V),C()}),ze(()=>t.color.get("alpha"),()=>C()),ze(()=>t.color.value,()=>C());const w=U(()=>[d.b(),d.is("vertical",t.vertical)]),I=U(()=>d.e("bar")),R=U(()=>d.e("thumb")),N=U(()=>({background:g.value})),O=U(()=>({left:mo(h.value),top:mo(v.value)}));return{rootKls:w,barKls:I,barStyle:N,thumbKls:R,thumbStyle:O,update:C}},RRe="ElColorAlphaSlider",IRe=me({name:RRe}),ARe=me({...IRe,props:SRe,setup(t,{expose:o}){const s=t,{alpha:a,alphaLabel:l,bar:d,thumb:h,handleDrag:v,handleClick:g,handleKeydown:E}=CRe(s),{rootKls:b,barKls:S,barStyle:C,thumbKls:w,thumbStyle:I,update:R}=wRe(s,{bar:d,thumb:h,handleDrag:v});return o({update:R,bar:d,thumb:h}),(N,O)=>($(),le("div",{class:K(p(b))},[ue("div",{ref_key:"bar",ref:d,class:K(p(S)),style:jt(p(C)),onClick:p(g)},null,14,["onClick"]),ue("div",{ref_key:"thumb",ref:h,class:K(p(w)),style:jt(p(I)),"aria-label":p(l),"aria-valuenow":p(a),"aria-orientation":N.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:p(E)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var ORe=dt(ARe,[["__file","alpha-slider.vue"]]);const NRe=me({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(t){const o=Qe("color-hue-slider"),s=mn(),a=ee(),l=ee(),d=ee(0),h=ee(0),v=U(()=>t.color.get("hue"));ze(()=>v.value,()=>{C()});function g(w){w.target!==a.value&&E(w)}function E(w){if(!l.value||!a.value)return;const R=s.vnode.el.getBoundingClientRect(),{clientX:N,clientY:O}=mk(w);let V;if(t.vertical){let L=O-R.top;L=Math.min(L,R.height-a.value.offsetHeight/2),L=Math.max(a.value.offsetHeight/2,L),V=Math.round((L-a.value.offsetHeight/2)/(R.height-a.value.offsetHeight)*360)}else{let L=N-R.left;L=Math.min(L,R.width-a.value.offsetWidth/2),L=Math.max(a.value.offsetWidth/2,L),V=Math.round((L-a.value.offsetWidth/2)/(R.width-a.value.offsetWidth)*360)}t.color.set("hue",V)}function b(){if(!a.value)return 0;const w=s.vnode.el;if(t.vertical)return 0;const I=t.color.get("hue");return w?Math.round(I*(w.offsetWidth-a.value.offsetWidth/2)/360):0}function S(){if(!a.value)return 0;const w=s.vnode.el;if(!t.vertical)return 0;const I=t.color.get("hue");return w?Math.round(I*(w.offsetHeight-a.value.offsetHeight/2)/360):0}function C(){d.value=b(),h.value=S()}return dn(()=>{if(!l.value||!a.value)return;const w={drag:I=>{E(I)},end:I=>{E(I)}};Bg(l.value,w),Bg(a.value,w),C()}),{bar:l,thumb:a,thumbLeft:d,thumbTop:h,hueValue:v,handleClick:g,update:C,ns:o}}});function kRe(t,o,s,a,l,d){return $(),le("div",{class:K([t.ns.b(),t.ns.is("vertical",t.vertical)])},[ue("div",{ref:"bar",class:K(t.ns.e("bar")),onClick:t.handleClick},null,10,["onClick"]),ue("div",{ref:"thumb",class:K(t.ns.e("thumb")),style:jt({left:t.thumbLeft+"px",top:t.thumbTop+"px"})},null,6)],2)}var PRe=dt(NRe,[["render",kRe],["__file","hue-slider.vue"]]);const DRe=ut({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Ho,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:ss.teleported,predefine:{type:Re(Array)},validateEvent:{type:Boolean,default:!0},...Cs(["ariaLabel"])}),LRe={[Jt]:t=>Mt(t)||Qo(t),[yn]:t=>Mt(t)||Qo(t),activeChange:t=>Mt(t)||Qo(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent},NG=Symbol("colorPickerContextKey"),gH=function(t,o,s){return[t,o*s/((t=(2-o)*s)<1?t:2-t)||0,t/2]},MRe=function(t){return Mt(t)&&t.includes(".")&&Number.parseFloat(t)===1},xRe=function(t){return Mt(t)&&t.includes("%")},xp=function(t,o){MRe(t)&&(t="100%");const s=xRe(t);return t=Math.min(o,Math.max(0,Number.parseFloat(`${t}`))),s&&(t=Number.parseInt(`${t*o}`,10)/100),Math.abs(t-o)<1e-6?1:t%o/Number.parseFloat(o)},_H={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Gb=t=>{t=Math.min(Math.round(t),255);const o=Math.floor(t/16),s=t%16;return`${_H[o]||o}${_H[s]||s}`},EH=function({r:t,g:o,b:s}){return Number.isNaN(+t)||Number.isNaN(+o)||Number.isNaN(+s)?"":`#${Gb(t)}${Gb(o)}${Gb(s)}`},dA={A:10,B:11,C:12,D:13,E:14,F:15},ph=function(t){return t.length===2?(dA[t[0].toUpperCase()]||+t[0])*16+(dA[t[1].toUpperCase()]||+t[1]):dA[t[1].toUpperCase()]||+t[1]},URe=function(t,o,s){o=o/100,s=s/100;let a=o;const l=Math.max(s,.01);s*=2,o*=s<=1?s:2-s,a*=l<=1?l:2-l;const d=(s+o)/2,h=s===0?2*a/(l+a):2*o/(s+o);return{h:t,s:h*100,v:d*100}},yH=(t,o,s)=>{t=xp(t,255),o=xp(o,255),s=xp(s,255);const a=Math.max(t,o,s),l=Math.min(t,o,s);let d;const h=a,v=a-l,g=a===0?0:v/a;if(a===l)d=0;else{switch(a){case t:{d=(o-s)/v+(o<s?6:0);break}case o:{d=(s-t)/v+2;break}case s:{d=(t-o)/v+4;break}}d/=6}return{h:d*360,s:g*100,v:h*100}},Zv=function(t,o,s){t=xp(t,360)*6,o=xp(o,100),s=xp(s,100);const a=Math.floor(t),l=t-a,d=s*(1-o),h=s*(1-l*o),v=s*(1-(1-l)*o),g=a%6,E=[s,h,d,d,v,s][g],b=[v,s,s,h,d,d][g],S=[d,d,v,s,s,h][g];return{r:Math.round(E*255),g:Math.round(b*255),b:Math.round(S*255)}};class Eg{constructor(o={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const s in o)zn(o,s)&&(this[s]=o[s]);o.value?this.fromString(o.value):this.doOnChange()}set(o,s){if(arguments.length===1&&typeof o=="object"){for(const a in o)zn(o,a)&&this.set(a,o[a]);return}this[`_${o}`]=s,this.doOnChange()}get(o){return o==="alpha"?Math.floor(this[`_${o}`]):this[`_${o}`]}toRgb(){return Zv(this._hue,this._saturation,this._value)}fromString(o){if(!o){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const s=(a,l,d)=>{this._hue=Math.max(0,Math.min(360,a)),this._saturation=Math.max(0,Math.min(100,l)),this._value=Math.max(0,Math.min(100,d)),this.doOnChange()};if(o.includes("hsl")){const a=o.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,d)=>d>2?Number.parseFloat(l):Number.parseInt(l,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:l,s:d,v:h}=URe(a[0],a[1],a[2]);s(l,d,h)}}else if(o.includes("hsv")){const a=o.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,d)=>d>2?Number.parseFloat(l):Number.parseInt(l,10));a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3&&s(a[0],a[1],a[2])}else if(o.includes("rgb")){const a=o.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,d)=>d>2?Number.parseFloat(l):Number.parseInt(l,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:l,s:d,v:h}=yH(a[0],a[1],a[2]);s(l,d,h)}}else if(o.includes("#")){const a=o.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(a))return;let l,d,h;a.length===3?(l=ph(a[0]+a[0]),d=ph(a[1]+a[1]),h=ph(a[2]+a[2])):(a.length===6||a.length===8)&&(l=ph(a.slice(0,2)),d=ph(a.slice(2,4)),h=ph(a.slice(4,6))),a.length===8?this._alpha=ph(a.slice(6))/255*100:(a.length===3||a.length===6)&&(this._alpha=100);const{h:v,s:g,v:E}=yH(l,d,h);s(v,g,E)}}compare(o){return Math.abs(o._hue-this._hue)<2&&Math.abs(o._saturation-this._saturation)<1&&Math.abs(o._value-this._value)<1&&Math.abs(o._alpha-this._alpha)<1}doOnChange(){const{_hue:o,_saturation:s,_value:a,_alpha:l,format:d}=this;if(this.enableAlpha)switch(d){case"hsl":{const h=gH(o,s/100,a/100);this.value=`hsla(${o}, ${Math.round(h[1]*100)}%, ${Math.round(h[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${o}, ${Math.round(s)}%, ${Math.round(a)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${EH(Zv(o,s,a))}${Gb(l*255/100)}`;break}default:{const{r:h,g:v,b:g}=Zv(o,s,a);this.value=`rgba(${h}, ${v}, ${g}, ${this.get("alpha")/100})`}}else switch(d){case"hsl":{const h=gH(o,s/100,a/100);this.value=`hsl(${o}, ${Math.round(h[1]*100)}%, ${Math.round(h[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${o}, ${Math.round(s)}%, ${Math.round(a)}%)`;break}case"rgb":{const{r:h,g:v,b:g}=Zv(o,s,a);this.value=`rgb(${h}, ${v}, ${g})`;break}default:this.value=EH(Zv(o,s,a))}}}const VRe=me({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(t){const o=Qe("color-predefine"),{currentColor:s}=It(NG),a=ee(d(t.colors,t.color));ze(()=>s.value,h=>{const v=new Eg;v.fromString(h),a.value.forEach(g=>{g.selected=v.compare(g)})}),Ms(()=>{a.value=d(t.colors,t.color)});function l(h){t.color.fromString(t.colors[h])}function d(h,v){return h.map(g=>{const E=new Eg;return E.enableAlpha=t.enableAlpha,E.format="rgba",E.fromString(g),E.selected=E.value===v.value,E})}return{rgbaColors:a,handleSelect:l,ns:o}}});function FRe(t,o,s,a,l,d){return $(),le("div",{class:K(t.ns.b())},[ue("div",{class:K(t.ns.e("colors"))},[($(!0),le(Ut,null,Cn(t.rgbaColors,(h,v)=>($(),le("div",{key:t.colors[v],class:K([t.ns.e("color-selector"),t.ns.is("alpha",h._alpha<100),{selected:h.selected}]),onClick:g=>t.handleSelect(v)},[ue("div",{style:jt({backgroundColor:h.value})},null,4)],10,["onClick"]))),128))],2)],2)}var BRe=dt(VRe,[["render",FRe],["__file","predefine.vue"]]);const jRe=me({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(t){const o=Qe("color-svpanel"),s=mn(),a=ee(0),l=ee(0),d=ee("hsl(0, 100%, 50%)"),h=U(()=>{const E=t.color.get("hue"),b=t.color.get("value");return{hue:E,value:b}});function v(){const E=t.color.get("saturation"),b=t.color.get("value"),S=s.vnode.el,{clientWidth:C,clientHeight:w}=S;l.value=E*C/100,a.value=(100-b)*w/100,d.value=`hsl(${t.color.get("hue")}, 100%, 50%)`}function g(E){const S=s.vnode.el.getBoundingClientRect(),{clientX:C,clientY:w}=mk(E);let I=C-S.left,R=w-S.top;I=Math.max(0,I),I=Math.min(I,S.width),R=Math.max(0,R),R=Math.min(R,S.height),l.value=I,a.value=R,t.color.set({saturation:I/S.width*100,value:100-R/S.height*100})}return ze(()=>h.value,()=>{v()}),dn(()=>{Bg(s.vnode.el,{drag:E=>{g(E)},end:E=>{g(E)}}),v()}),{cursorTop:a,cursorLeft:l,background:d,colorValue:h,handleDrag:g,update:v,ns:o}}});function $Re(t,o,s,a,l,d){return $(),le("div",{class:K(t.ns.b()),style:jt({backgroundColor:t.background})},[ue("div",{class:K(t.ns.e("white"))},null,2),ue("div",{class:K(t.ns.e("black"))},null,2),ue("div",{class:K(t.ns.e("cursor")),style:jt({top:t.cursorTop+"px",left:t.cursorLeft+"px"})},[ue("div")],6)],6)}var HRe=dt(jRe,[["render",$Re],["__file","sv-panel.vue"]]);const WRe=me({name:"ElColorPicker"}),KRe=me({...WRe,props:DRe,emits:LRe,setup(t,{expose:o,emit:s}){const a=t,{t:l}=Fn(),d=Qe("color"),{formItem:h}=Vs(),v=xo(),g=Fs(),{inputId:E,isLabeledByFormItem:b}=Ka(a,{formItemContext:h}),S=ee(),C=ee(),w=ee(),I=ee(),R=ee(),N=ee(),{isFocused:O,handleFocus:V,handleBlur:L}=_d(R,{beforeFocus(){return g.value},beforeBlur(We){var yt;return(yt=I.value)==null?void 0:yt.isFocusInsideContent(We)},afterBlur(){ae(!1),J()}});let D=!0;const M=er(new Eg({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue})),F=ee(!1),W=ee(!1),z=ee(""),G=U(()=>!a.modelValue&&!W.value?"transparent":Ee(M,a.showAlpha)),Y=U(()=>!a.modelValue&&!W.value?"":M.value),te=U(()=>b.value?void 0:a.ariaLabel||l("el.colorpicker.defaultLabel")),Z=U(()=>b.value?h==null?void 0:h.labelId:void 0),fe=U(()=>[d.b("picker"),d.is("disabled",g.value),d.bm("picker",v.value),d.is("focused",O.value)]);function Ee(We,yt){if(!(We instanceof Eg))throw new TypeError("color should be instance of _color Class");const{r:it,g:ce,b:Se}=We.toRgb();return yt?`rgba(${it}, ${ce}, ${Se}, ${We.get("alpha")/100})`:`rgb(${it}, ${ce}, ${Se})`}function ae(We){F.value=We}const X=Hi(ae,100,{leading:!0});function ie(){g.value||ae(!0)}function se(){X(!1),J()}function J(){Vt(()=>{a.modelValue?M.fromString(a.modelValue):(M.value="",Vt(()=>{W.value=!1}))})}function pe(){g.value||(F.value&&J(),X(!F.value))}function be(){M.fromString(z.value)}function Ae(){const We=M.value;s(Jt,We),s(yn,We),a.validateEvent&&(h==null||h.validate("change").catch(yt=>void 0)),X(!1),Vt(()=>{const yt=new Eg({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue});M.compare(yt)||J()})}function _e(){X(!1),s(Jt,null),s(yn,null),a.modelValue!==null&&a.validateEvent&&(h==null||h.validate("change").catch(We=>void 0)),J()}function Me(){F.value&&(se(),O.value&&Pe())}function Fe(We){We.preventDefault(),We.stopPropagation(),ae(!1),J()}function Le(We){switch(We.code){case Ct.enter:case Ct.numpadEnter:case Ct.space:We.preventDefault(),We.stopPropagation(),ie(),N.value.focus();break;case Ct.esc:Fe(We);break}}function Pe(){R.value.focus()}function He(){R.value.blur()}return dn(()=>{a.modelValue&&(z.value=Y.value)}),ze(()=>a.modelValue,We=>{We?We&&We!==M.value&&(D=!1,M.fromString(We)):W.value=!1}),ze(()=>[a.colorFormat,a.showAlpha],()=>{M.enableAlpha=a.showAlpha,M.format=a.colorFormat||M.format,M.doOnChange(),s(Jt,M.value)}),ze(()=>Y.value,We=>{z.value=We,D&&s("activeChange",We),D=!0}),ze(()=>M.value,()=>{!a.modelValue&&!W.value&&(W.value=!0)}),ze(()=>F.value,()=>{Vt(()=>{var We,yt,it;(We=S.value)==null||We.update(),(yt=C.value)==null||yt.update(),(it=w.value)==null||it.update()})}),wn(NG,{currentColor:Y}),o({color:M,show:ie,hide:se,focus:Pe,blur:He}),(We,yt)=>($(),Ve(p(Us),{ref_key:"popper",ref:I,visible:F.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[p(d).be("picker","panel"),p(d).b("dropdown"),We.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:We.teleported,transition:`${p(d).namespace.value}-zoom-in-top`,persistent:"",onHide:it=>ae(!1)},{content:Ce(()=>[ln(($(),le("div",{onKeydown:Cr(Fe,["esc"])},[ue("div",{class:K(p(d).be("dropdown","main-wrapper"))},[ge(PRe,{ref_key:"hue",ref:S,class:"hue-slider",color:p(M),vertical:""},null,8,["color"]),ge(HRe,{ref_key:"sv",ref:C,color:p(M)},null,8,["color"])],2),We.showAlpha?($(),Ve(ORe,{key:0,ref_key:"alpha",ref:w,color:p(M)},null,8,["color"])):De("v-if",!0),We.predefine?($(),Ve(BRe,{key:1,ref:"predefine","enable-alpha":We.showAlpha,color:p(M),colors:We.predefine},null,8,["enable-alpha","color","colors"])):De("v-if",!0),ue("div",{class:K(p(d).be("dropdown","btns"))},[ue("span",{class:K(p(d).be("dropdown","value"))},[ge(p(ei),{ref_key:"inputRef",ref:N,modelValue:z.value,"onUpdate:modelValue":it=>z.value=it,"validate-event":!1,size:"small",onKeyup:Cr(be,["enter"]),onBlur:be},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),ge(p(ls),{class:K(p(d).be("dropdown","link-btn")),text:"",size:"small",onClick:_e},{default:Ce(()=>[bn(ot(p(l)("el.colorpicker.clear")),1)]),_:1},8,["class"]),ge(p(ls),{plain:"",size:"small",class:K(p(d).be("dropdown","btn")),onClick:Ae},{default:Ce(()=>[bn(ot(p(l)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[p(ru),Me,R.value]])]),default:Ce(()=>[ue("div",En({id:p(E),ref_key:"triggerRef",ref:R},We.$attrs,{class:p(fe),role:"button","aria-label":p(te),"aria-labelledby":p(Z),"aria-description":p(l)("el.colorpicker.description",{color:We.modelValue||""}),"aria-disabled":p(g),tabindex:p(g)?-1:We.tabindex,onKeydown:Le,onFocus:p(V),onBlur:p(L)}),[p(g)?($(),le("div",{key:0,class:K(p(d).be("picker","mask"))},null,2)):De("v-if",!0),ue("div",{class:K(p(d).be("picker","trigger")),onClick:pe},[ue("span",{class:K([p(d).be("picker","color"),p(d).is("alpha",We.showAlpha)])},[ue("span",{class:K(p(d).be("picker","color-inner")),style:jt({backgroundColor:p(G)})},[ln(ge(p(Dt),{class:K([p(d).be("picker","icon"),p(d).is("icon-arrow-down")])},{default:Ce(()=>[ge(p(uu))]),_:1},8,["class"]),[[Wn,We.modelValue||W.value]]),ln(ge(p(Dt),{class:K([p(d).be("picker","empty"),p(d).is("icon-close")])},{default:Ce(()=>[ge(p(Sc))]),_:1},8,["class"]),[[Wn,!We.modelValue&&!W.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var GRe=dt(KRe,[["__file","color-picker.vue"]]);const zRe=rn(GRe),YRe=ut({a11y:{type:Boolean,default:!0},locale:{type:Re(Object)},size:Ho,button:{type:Re(Object)},experimentalFeatures:{type:Re(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:Re(Object)},zIndex:Number,namespace:{type:String,default:"el"},...pm}),fc={},qRe=me({name:"ElConfigProvider",props:YRe,setup(t,{slots:o}){ze(()=>t.message,a=>{Object.assign(fc,a??{})},{immediate:!0,deep:!0});const s=$N(t);return()=>Ne(o,"default",{config:s==null?void 0:s.value})}}),XRe=rn(qRe),JRe=me({name:"ElContainer"}),ZRe=me({...JRe,props:{direction:{type:String}},setup(t){const o=t,s=Jo(),a=Qe("container"),l=U(()=>o.direction==="vertical"?!0:o.direction==="horizontal"?!1:s&&s.default?s.default().some(h=>{const v=h.type.name;return v==="ElHeader"||v==="ElFooter"}):!1);return(d,h)=>($(),le("section",{class:K([p(a).b(),p(a).is("vertical",p(l))])},[Ne(d.$slots,"default")],2))}});var QRe=dt(ZRe,[["__file","container.vue"]]);const eIe=me({name:"ElAside"}),tIe=me({...eIe,props:{width:{type:String,default:null}},setup(t){const o=t,s=Qe("aside"),a=U(()=>o.width?s.cssVarBlock({width:o.width}):{});return(l,d)=>($(),le("aside",{class:K(p(s).b()),style:jt(p(a))},[Ne(l.$slots,"default")],6))}});var kG=dt(tIe,[["__file","aside.vue"]]);const nIe=me({name:"ElFooter"}),rIe=me({...nIe,props:{height:{type:String,default:null}},setup(t){const o=t,s=Qe("footer"),a=U(()=>o.height?s.cssVarBlock({height:o.height}):{});return(l,d)=>($(),le("footer",{class:K(p(s).b()),style:jt(p(a))},[Ne(l.$slots,"default")],6))}});var PG=dt(rIe,[["__file","footer.vue"]]);const oIe=me({name:"ElHeader"}),sIe=me({...oIe,props:{height:{type:String,default:null}},setup(t){const o=t,s=Qe("header"),a=U(()=>o.height?s.cssVarBlock({height:o.height}):{});return(l,d)=>($(),le("header",{class:K(p(s).b()),style:jt(p(a))},[Ne(l.$slots,"default")],6))}});var DG=dt(sIe,[["__file","header.vue"]]);const iIe=me({name:"ElMain"}),aIe=me({...iIe,setup(t){const o=Qe("main");return(s,a)=>($(),le("main",{class:K(p(o).b())},[Ne(s.$slots,"default")],2))}});var LG=dt(aIe,[["__file","main.vue"]]);const cIe=rn(QRe,{Aside:kG,Footer:PG,Header:DG,Main:LG}),lIe=uo(kG),uIe=uo(PG),dIe=uo(DG),hIe=uo(LG);var MG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d/,d=/\d\d/,h=/\d\d?/,v=/\d*[^-_:/,()\s\d]+/,g={},E=function(N){return(N=+N)+(N>68?1900:2e3)},b=function(N){return function(O){this[N]=+O}},S=[/[+-]\d\d:?(\d\d)?|Z/,function(N){(this.zone||(this.zone={})).offset=function(O){if(!O||O==="Z")return 0;var V=O.match(/([+-]|\d\d)/g),L=60*V[1]+(+V[2]||0);return L===0?0:V[0]==="+"?-L:L}(N)}],C=function(N){var O=g[N];return O&&(O.indexOf?O:O.s.concat(O.f))},w=function(N,O){var V,L=g.meridiem;if(L){for(var D=1;D<=24;D+=1)if(N.indexOf(L(D,0,O))>-1){V=D>12;break}}else V=N===(O?"pm":"PM");return V},I={A:[v,function(N){this.afternoon=w(N,!1)}],a:[v,function(N){this.afternoon=w(N,!0)}],Q:[l,function(N){this.month=3*(N-1)+1}],S:[l,function(N){this.milliseconds=100*+N}],SS:[d,function(N){this.milliseconds=10*+N}],SSS:[/\d{3}/,function(N){this.milliseconds=+N}],s:[h,b("seconds")],ss:[h,b("seconds")],m:[h,b("minutes")],mm:[h,b("minutes")],H:[h,b("hours")],h:[h,b("hours")],HH:[h,b("hours")],hh:[h,b("hours")],D:[h,b("day")],DD:[d,b("day")],Do:[v,function(N){var O=g.ordinal,V=N.match(/\d+/);if(this.day=V[0],O)for(var L=1;L<=31;L+=1)O(L).replace(/\[|\]/g,"")===N&&(this.day=L)}],w:[h,b("week")],ww:[d,b("week")],M:[h,b("month")],MM:[d,b("month")],MMM:[v,function(N){var O=C("months"),V=(C("monthsShort")||O.map(function(L){return L.slice(0,3)})).indexOf(N)+1;if(V<1)throw new Error;this.month=V%12||V}],MMMM:[v,function(N){var O=C("months").indexOf(N)+1;if(O<1)throw new Error;this.month=O%12||O}],Y:[/[+-]?\d+/,b("year")],YY:[d,function(N){this.year=E(N)}],YYYY:[/\d{4}/,b("year")],Z:S,ZZ:S};function R(N){var O,V;O=N,V=g&&g.formats;for(var L=(N=O.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(Y,te,Z){var fe=Z&&Z.toUpperCase();return te||V[Z]||s[Z]||V[fe].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Ee,ae,X){return ae||X.slice(1)})})).match(a),D=L.length,M=0;M<D;M+=1){var F=L[M],W=I[F],z=W&&W[0],G=W&&W[1];L[M]=G?{regex:z,parser:G}:F.replace(/^\[|\]$/g,"")}return function(Y){for(var te={},Z=0,fe=0;Z<D;Z+=1){var Ee=L[Z];if(typeof Ee=="string")fe+=Ee.length;else{var ae=Ee.regex,X=Ee.parser,ie=Y.slice(fe),se=ae.exec(ie)[0];X.call(te,se),Y=Y.replace(se,"")}}return function(J){var pe=J.afternoon;if(pe!==void 0){var be=J.hours;pe?be<12&&(J.hours+=12):be===12&&(J.hours=0),delete J.afternoon}}(te),te}}return function(N,O,V){V.p.customParseFormat=!0,N&&N.parseTwoDigitYear&&(E=N.parseTwoDigitYear);var L=O.prototype,D=L.parse;L.parse=function(M){var F=M.date,W=M.utc,z=M.args;this.$u=W;var G=z[1];if(typeof G=="string"){var Y=z[2]===!0,te=z[3]===!0,Z=Y||te,fe=z[2];te&&(fe=z[2]),g=this.$locale(),!Y&&fe&&(g=V.Ls[fe]),this.$d=function(ie,se,J,pe){try{if(["x","X"].indexOf(se)>-1)return new Date((se==="X"?1e3:1)*ie);var be=R(se)(ie),Ae=be.year,_e=be.month,Me=be.day,Fe=be.hours,Le=be.minutes,Pe=be.seconds,He=be.milliseconds,We=be.zone,yt=be.week,it=new Date,ce=Me||(Ae||_e?1:it.getDate()),Se=Ae||it.getFullYear(),je=0;Ae&&!_e||(je=_e>0?_e-1:it.getMonth());var tt,et=Fe||0,Ge=Le||0,Xe=Pe||0,Ye=He||0;return We?new Date(Date.UTC(Se,je,ce,et,Ge,Xe,Ye+60*We.offset*1e3)):J?new Date(Date.UTC(Se,je,ce,et,Ge,Xe,Ye)):(tt=new Date(Se,je,ce,et,Ge,Xe,Ye),yt&&(tt=pe(tt).week(yt).toDate()),tt)}catch{return new Date("")}}(F,G,W,V),this.init(),fe&&fe!==!0&&(this.$L=this.locale(fe).$L),Z&&F!=this.format(G)&&(this.$d=new Date("")),g={}}else if(G instanceof Array)for(var Ee=G.length,ae=1;ae<=Ee;ae+=1){z[1]=G[ae-1];var X=V.apply(this,z);if(X.isValid()){this.$d=X.$d,this.$L=X.$L,this.init();break}ae===Ee&&(this.$d=new Date(""))}else D.call(this,M)}}})})(MG);var fIe=MG.exports;const vk=_l(fIe);var xG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a){var l=a.prototype,d=l.format;l.format=function(h){var v=this,g=this.$locale();if(!this.isValid())return d.bind(this)(h);var E=this.$utils(),b=(h||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(S){switch(S){case"Q":return Math.ceil((v.$M+1)/3);case"Do":return g.ordinal(v.$D);case"gggg":return v.weekYear();case"GGGG":return v.isoWeekYear();case"wo":return g.ordinal(v.week(),"W");case"w":case"ww":return E.s(v.week(),S==="w"?1:2,"0");case"W":case"WW":return E.s(v.isoWeek(),S==="W"?1:2,"0");case"k":case"kk":return E.s(String(v.$H===0?24:v.$H),S==="k"?1:2,"0");case"X":return Math.floor(v.$d.getTime()/1e3);case"x":return v.$d.getTime();case"z":return"["+v.offsetName()+"]";case"zzz":return"["+v.offsetName("long")+"]";default:return S}});return d.bind(this)(b)}}})})(xG);var pIe=xG.exports;const mIe=_l(pIe);var UG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){var s="week",a="year";return function(l,d,h){var v=d.prototype;v.week=function(g){if(g===void 0&&(g=null),g!==null)return this.add(7*(g-this.week()),"day");var E=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var b=h(this).startOf(a).add(1,a).date(E),S=h(this).endOf(s);if(b.isBefore(S))return 1}var C=h(this).startOf(a).date(E).startOf(s).subtract(1,"millisecond"),w=this.diff(C,s,!0);return w<0?h(this).startOf("week").week():Math.ceil(w)},v.weeks=function(g){return g===void 0&&(g=null),this.week(g)}}})})(UG);var vIe=UG.exports;const gIe=_l(vIe);var VG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a){a.prototype.weekYear=function(){var l=this.month(),d=this.week(),h=this.year();return d===1&&l===11?h+1:l===0&&d>=52?h-1:h}}})})(VG);var _Ie=VG.exports;const EIe=_l(_Ie);var FG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a,l){a.prototype.dayOfYear=function(d){var h=Math.round((l(this).startOf("day")-l(this).startOf("year"))/864e5)+1;return d==null?h:this.add(d-h,"day")}}})})(FG);var yIe=FG.exports;const bIe=_l(yIe);var BG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a){a.prototype.isSameOrAfter=function(l,d){return this.isSame(l,d)||this.isAfter(l,d)}}})})(BG);var SIe=BG.exports;const TIe=_l(SIe);var jG={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){return function(s,a){a.prototype.isSameOrBefore=function(l,d){return this.isSame(l,d)||this.isBefore(l,d)}}})})(jG);var CIe=jG.exports;const wIe=_l(CIe),bH=["hours","minutes","seconds"],wS="HH:mm:ss",bp="YYYY-MM-DD",RIe={date:bp,dates:bp,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${bp} ${wS}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:bp,datetimerange:`${bp} ${wS}`},$G=ut({disabledHours:{type:Re(Function)},disabledMinutes:{type:Re(Function)},disabledSeconds:{type:Re(Function)}}),HG=ut({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),gk=ut({id:{type:Re([Array,String])},name:{type:Re([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:Re([String,Object]),default:du},editable:{type:Boolean,default:!0},prefixIcon:{type:Re([String,Object]),default:""},size:Ho,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:Re(Object),default:()=>({})},modelValue:{type:Re([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:Re([Date,Array])},defaultTime:{type:Re([Date,Array])},isRange:Boolean,...$G,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:Re([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:Re(String),values:hu,default:"bottom"},fallbackPlacements:{type:Re(Array),default:["bottom","top","right","left"]},...pm,...Cs(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),IIe=ut({id:{type:Re(Array)},name:{type:Re(Array)},modelValue:{type:Re([Array,String])},startPlaceholder:String,endPlaceholder:String}),AIe=me({name:"PickerRangeTrigger",inheritAttrs:!1}),OIe=me({...AIe,props:IIe,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(t,{expose:o,emit:s}){const a=u_(),l=Qe("date"),d=Qe("range"),h=ee(),v=ee(),{wrapperRef:g,isFocused:E}=_d(h),b=D=>{s("click",D)},S=D=>{s("mouseenter",D)},C=D=>{s("mouseleave",D)},w=D=>{s("mouseenter",D)},I=D=>{s("startInput",D)},R=D=>{s("endInput",D)},N=D=>{s("startChange",D)},O=D=>{s("endChange",D)};return o({focus:()=>{var D;(D=h.value)==null||D.focus()},blur:()=>{var D,M;(D=h.value)==null||D.blur(),(M=v.value)==null||M.blur()}}),(D,M)=>($(),le("div",{ref_key:"wrapperRef",ref:g,class:K([p(l).is("active",p(E)),D.$attrs.class]),style:jt(D.$attrs.style),onClick:b,onMouseenter:S,onMouseleave:C,onTouchstartPassive:w},[Ne(D.$slots,"prefix"),ue("input",En(p(a),{id:D.id&&D.id[0],ref_key:"inputRef",ref:h,name:D.name&&D.name[0],placeholder:D.startPlaceholder,value:D.modelValue&&D.modelValue[0],class:p(d).b("input"),onInput:I,onChange:N}),null,16,["id","name","placeholder","value"]),Ne(D.$slots,"range-separator"),ue("input",En(p(a),{id:D.id&&D.id[1],ref_key:"endInputRef",ref:v,name:D.name&&D.name[1],placeholder:D.endPlaceholder,value:D.modelValue&&D.modelValue[1],class:p(d).b("input"),onInput:R,onChange:O}),null,16,["id","name","placeholder","value"]),Ne(D.$slots,"suffix")],38))}});var NIe=dt(OIe,[["__file","picker-range-trigger.vue"]]);const kIe=me({name:"Picker"}),PIe=me({...kIe,props:gk,emits:[Jt,yn,"focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(t,{expose:o,emit:s}){const a=t,l=au(),{lang:d}=Fn(),h=Qe("date"),v=Qe("input"),g=Qe("range"),{form:E,formItem:b}=Vs(),S=It("ElPopperOptions",{}),{valueOnClear:C}=f0(a,null),w=ee(),I=ee(),R=ee(!1),N=ee(!1),O=ee(null);let V=!1;const{isFocused:L,handleFocus:D,handleBlur:M}=_d(I,{beforeFocus(){return a.readonly||J.value},afterFocus(){R.value=!0},beforeBlur(Te){var vt;return!V&&((vt=w.value)==null?void 0:vt.isFocusInsideContent(Te))},afterBlur(){ct(),R.value=!1,V=!1,a.validateEvent&&(b==null||b.validate("blur").catch(Te=>void 0))}}),F=U(()=>[h.b("editor"),h.bm("editor",a.type),v.e("wrapper"),h.is("disabled",J.value),h.is("active",R.value),g.b("editor"),et?g.bm("editor",et.value):"",l.class]),W=U(()=>[v.e("icon"),g.e("close-icon"),He.value?"":g.e("close-icon--hidden")]);ze(R,Te=>{Te?Vt(()=>{Te&&(O.value=a.modelValue)}):(Ye.value=null,Vt(()=>{z(a.modelValue)}))});const z=(Te,vt)=>{(vt||!iH(Te,O.value))&&(s(yn,Te),vt&&(O.value=Te),a.validateEvent&&(b==null||b.validate("change").catch(an=>void 0)))},G=Te=>{if(!iH(a.modelValue,Te)){let vt;st(Te)?vt=Te.map(an=>cH(an,a.valueFormat,d.value)):Te&&(vt=cH(Te,a.valueFormat,d.value)),s(Jt,Te&&vt,d.value)}},Y=Te=>{s("keydown",Te)},te=U(()=>I.value?Array.from(I.value.$el.querySelectorAll("input")):[]),Z=(Te,vt,an)=>{const en=te.value;en.length&&(!an||an==="min"?(en[0].setSelectionRange(Te,vt),en[0].focus()):an==="max"&&(en[1].setSelectionRange(Te,vt),en[1].focus()))},fe=(Te="",vt=!1)=>{R.value=vt;let an;st(Te)?an=Te.map(en=>en.toDate()):an=Te&&Te.toDate(),Ye.value=null,G(an)},Ee=()=>{N.value=!0},ae=()=>{s("visible-change",!0)},X=()=>{N.value=!1,R.value=!1,s("visible-change",!1)},ie=()=>{R.value=!0},se=()=>{R.value=!1},J=U(()=>a.disabled||(E==null?void 0:E.disabled)),pe=U(()=>{let Te;if(yt.value?Sn.value.getDefaultValue&&(Te=Sn.value.getDefaultValue()):st(a.modelValue)?Te=a.modelValue.map(vt=>aH(vt,a.valueFormat,d.value)):Te=aH(a.modelValue,a.valueFormat,d.value),Sn.value.getRangeAvailableTime){const vt=Sn.value.getRangeAvailableTime(Te);as(vt,Te)||(Te=vt,yt.value||G(Nb(Te)))}return st(Te)&&Te.some(vt=>!vt)&&(Te=[]),Te}),be=U(()=>{if(!Sn.value.panelReady)return"";const Te=Ot(pe.value);return st(Ye.value)?[Ye.value[0]||Te&&Te[0]||"",Ye.value[1]||Te&&Te[1]||""]:Ye.value!==null?Ye.value:!_e.value&&yt.value||!R.value&&yt.value?"":Te?Me.value||Fe.value||Le.value?Te.join(", "):Te:""}),Ae=U(()=>a.type.includes("time")),_e=U(()=>a.type.startsWith("time")),Me=U(()=>a.type==="dates"),Fe=U(()=>a.type==="months"),Le=U(()=>a.type==="years"),Pe=U(()=>a.prefixIcon||(Ae.value?_K:iye)),He=ee(!1),We=Te=>{a.readonly||J.value||(He.value&&(Te.stopPropagation(),Sn.value.handleClear?Sn.value.handleClear():G(C.value),z(C.value,!0),He.value=!1,X()),s("clear"))},yt=U(()=>{const{modelValue:Te}=a;return!Te||st(Te)&&!Te.filter(Boolean).length}),it=async Te=>{var vt;a.readonly||J.value||(((vt=Te.target)==null?void 0:vt.tagName)!=="INPUT"||L.value)&&(R.value=!0)},ce=()=>{a.readonly||J.value||!yt.value&&a.clearable&&(He.value=!0)},Se=()=>{He.value=!1},je=Te=>{var vt;a.readonly||J.value||(((vt=Te.touches[0].target)==null?void 0:vt.tagName)!=="INPUT"||L.value)&&(R.value=!0)},tt=U(()=>a.type.includes("range")),et=xo(),Ge=U(()=>{var Te,vt;return(vt=(Te=p(w))==null?void 0:Te.popperRef)==null?void 0:vt.contentRef}),Xe=jN(I,Te=>{const vt=p(Ge),an=pi(I);vt&&(Te.target===vt||Te.composedPath().includes(vt))||Te.target===an||an&&Te.composedPath().includes(an)||(R.value=!1)});Rr(()=>{Xe==null||Xe()});const Ye=ee(null),ct=()=>{if(Ye.value){const Te=nt(be.value);Te&&_t(Te)&&(G(Nb(Te)),Ye.value=null)}Ye.value===""&&(G(C.value),z(C.value,!0),Ye.value=null)},nt=Te=>Te?Sn.value.parseUserInput(Te):null,Ot=Te=>Te?Sn.value.formatToString(Te):null,_t=Te=>Sn.value.isValidValue(Te),qe=async Te=>{if(a.readonly||J.value)return;const{code:vt}=Te;if(Y(Te),vt===Ct.esc){R.value===!0&&(R.value=!1,Te.preventDefault(),Te.stopPropagation());return}if(vt===Ct.down&&(Sn.value.handleFocusPicker&&(Te.preventDefault(),Te.stopPropagation()),R.value===!1&&(R.value=!0,await Vt()),Sn.value.handleFocusPicker)){Sn.value.handleFocusPicker();return}if(vt===Ct.tab){V=!0;return}if(vt===Ct.enter||vt===Ct.numpadEnter){(Ye.value===null||Ye.value===""||_t(nt(be.value)))&&(ct(),R.value=!1),Te.stopPropagation();return}if(Ye.value){Te.stopPropagation();return}Sn.value.handleKeydownInput&&Sn.value.handleKeydownInput(Te)},wt=Te=>{Ye.value=Te,R.value||(R.value=!0)},qt=Te=>{const vt=Te.target;Ye.value?Ye.value=[vt.value,Ye.value[1]]:Ye.value=[vt.value,null]},sn=Te=>{const vt=Te.target;Ye.value?Ye.value=[Ye.value[0],vt.value]:Ye.value=[null,vt.value]},tn=()=>{var Te;const vt=Ye.value,an=nt(vt&&vt[0]),en=p(pe);if(an&&an.isValid()){Ye.value=[Ot(an),((Te=be.value)==null?void 0:Te[1])||null];const Ir=[an,en&&(en[1]||null)];_t(Ir)&&(G(Nb(Ir)),Ye.value=null)}},Kn=()=>{var Te;const vt=p(Ye),an=nt(vt&&vt[1]),en=p(pe);if(an&&an.isValid()){Ye.value=[((Te=p(be))==null?void 0:Te[0])||null,Ot(an)];const Ir=[en&&en[0],an];_t(Ir)&&(G(Nb(Ir)),Ye.value=null)}},Sn=ee({}),zr=Te=>{Sn.value[Te[0]]=Te[1],Sn.value.panelReady=!0},Wt=Te=>{s("calendar-change",Te)},Je=(Te,vt,an)=>{s("panel-change",Te,vt,an)},Ie=()=>{var Te;(Te=I.value)==null||Te.focus()},Ke=()=>{var Te;(Te=I.value)==null||Te.blur()};return wn("EP_PICKER_BASE",{props:a}),o({focus:Ie,blur:Ke,handleOpen:ie,handleClose:se,onPick:fe}),(Te,vt)=>($(),Ve(p(Us),En({ref_key:"refPopper",ref:w,visible:R.value,effect:"light",pure:"",trigger:"click"},Te.$attrs,{role:"dialog",teleported:"",transition:`${p(h).namespace.value}-zoom-in-top`,"popper-class":[`${p(h).namespace.value}-picker__popper`,Te.popperClass],"popper-options":p(S),"fallback-placements":Te.fallbackPlacements,"gpu-acceleration":!1,placement:Te.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:Ee,onShow:ae,onHide:X}),{default:Ce(()=>[p(tt)?($(),Ve(NIe,{key:1,id:Te.id,ref_key:"inputRef",ref:I,"model-value":p(be),name:Te.name,disabled:p(J),readonly:!Te.editable||Te.readonly,"start-placeholder":Te.startPlaceholder,"end-placeholder":Te.endPlaceholder,class:K(p(F)),style:jt(Te.$attrs.style),"aria-label":Te.ariaLabel,tabindex:Te.tabindex,autocomplete:"off",role:"combobox",onClick:it,onFocus:p(D),onBlur:p(M),onStartInput:qt,onStartChange:tn,onEndInput:sn,onEndChange:Kn,onMousedown:it,onMouseenter:ce,onMouseleave:Se,onTouchstartPassive:je,onKeydown:qe},{prefix:Ce(()=>[p(Pe)?($(),Ve(p(Dt),{key:0,class:K([p(v).e("icon"),p(g).e("icon")])},{default:Ce(()=>[($(),Ve(gn(p(Pe))))]),_:1},8,["class"])):De("v-if",!0)]),"range-separator":Ce(()=>[Ne(Te.$slots,"range-separator",{},()=>[ue("span",{class:K(p(g).b("separator"))},ot(Te.rangeSeparator),3)])]),suffix:Ce(()=>[Te.clearIcon?($(),Ve(p(Dt),{key:0,class:K(p(W)),onMousedown:Gt(p(pr),["prevent"]),onClick:We},{default:Ce(()=>[($(),Ve(gn(Te.clearIcon)))]),_:1},8,["class","onMousedown"])):De("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):($(),Ve(p(ei),{key:0,id:Te.id,ref_key:"inputRef",ref:I,"container-role":"combobox","model-value":p(be),name:Te.name,size:p(et),disabled:p(J),placeholder:Te.placeholder,class:K([p(h).b("editor"),p(h).bm("editor",Te.type),Te.$attrs.class]),style:jt(Te.$attrs.style),readonly:!Te.editable||Te.readonly||p(Me)||p(Fe)||p(Le)||Te.type==="week","aria-label":Te.ariaLabel,tabindex:Te.tabindex,"validate-event":!1,onInput:wt,onFocus:p(D),onBlur:p(M),onKeydown:qe,onChange:ct,onMousedown:it,onMouseenter:ce,onMouseleave:Se,onTouchstartPassive:je,onClick:Gt(()=>{},["stop"])},{prefix:Ce(()=>[p(Pe)?($(),Ve(p(Dt),{key:0,class:K(p(v).e("icon")),onMousedown:Gt(it,["prevent"]),onTouchstartPassive:je},{default:Ce(()=>[($(),Ve(gn(p(Pe))))]),_:1},8,["class","onMousedown"])):De("v-if",!0)]),suffix:Ce(()=>[He.value&&Te.clearIcon?($(),Ve(p(Dt),{key:0,class:K(`${p(v).e("icon")} clear-icon`),onMousedown:Gt(p(pr),["prevent"]),onClick:We},{default:Ce(()=>[($(),Ve(gn(Te.clearIcon)))]),_:1},8,["class","onMousedown"])):De("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:Ce(()=>[Ne(Te.$slots,"default",{visible:R.value,actualVisible:N.value,parsedValue:p(pe),format:Te.format,dateFormat:Te.dateFormat,timeFormat:Te.timeFormat,unlinkPanels:Te.unlinkPanels,type:Te.type,defaultValue:Te.defaultValue,showNow:Te.showNow,onPick:fe,onSelectRange:Z,onSetPickerOption:zr,onCalendarChange:Wt,onPanelChange:Je,onMousedown:Gt(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var WG=dt(PIe,[["__file","picker.vue"]]);const DIe=ut({...HG,datetimeRole:String,parsedValue:{type:Re(Object)}}),KG=({getAvailableHours:t,getAvailableMinutes:o,getAvailableSeconds:s})=>{const a=(h,v,g,E)=>{const b={hour:t,minute:o,second:s};let S=h;return["hour","minute","second"].forEach(C=>{if(b[C]){let w;const I=b[C];switch(C){case"minute":{w=I(S.hour(),v,E);break}case"second":{w=I(S.hour(),S.minute(),v,E);break}default:{w=I(v,E);break}}if(w!=null&&w.length&&!w.includes(S[C]())){const R=g?0:w.length-1;S=S[C](w[R])}}}),S},l={};return{timePickerOptions:l,getAvailableTime:a,onSetOption:([h,v])=>{l[h]=v}}},hA=t=>{const o=(a,l)=>a||l,s=a=>a!==!0;return t.map(o).filter(s)},GG=(t,o,s)=>({getHoursList:(h,v)=>cA(24,t&&(()=>t==null?void 0:t(h,v))),getMinutesList:(h,v,g)=>cA(60,o&&(()=>o==null?void 0:o(h,v,g))),getSecondsList:(h,v,g,E)=>cA(60,s&&(()=>s==null?void 0:s(h,v,g,E)))}),zG=(t,o,s)=>{const{getHoursList:a,getMinutesList:l,getSecondsList:d}=GG(t,o,s);return{getAvailableHours:(E,b)=>hA(a(E,b)),getAvailableMinutes:(E,b,S)=>hA(l(E,b,S)),getAvailableSeconds:(E,b,S,C)=>hA(d(E,b,S,C))}},YG=t=>{const o=ee(t.parsedValue);return ze(()=>t.visible,s=>{s||(o.value=t.parsedValue)}),o},LIe=ut({role:{type:String,required:!0},spinnerDate:{type:Re(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:Re(String),default:""},...$G}),MIe=100,xIe=600,RS={beforeMount(t,o){const s=o.value,{interval:a=MIe,delay:l=xIe}=Ft(s)?{}:s;let d,h;const v=()=>Ft(s)?s():s.handler(),g=()=>{h&&(clearTimeout(h),h=void 0),d&&(clearInterval(d),d=void 0)};t.addEventListener("mousedown",E=>{E.button===0&&(g(),v(),document.addEventListener("mouseup",()=>g(),{once:!0}),h=setTimeout(()=>{d=setInterval(()=>{v()},a)},l))})}},UIe=me({__name:"basic-time-spinner",props:LIe,emits:[yn,"select-range","set-option"],setup(t,{emit:o}){const s=t,a=It("EP_PICKER_BASE"),{isRange:l,format:d}=a.props,h=Qe("time"),{getHoursList:v,getMinutesList:g,getSecondsList:E}=GG(s.disabledHours,s.disabledMinutes,s.disabledSeconds);let b=!1;const S=ee(),C=ee(),w=ee(),I=ee(),R={hours:C,minutes:w,seconds:I},N=U(()=>s.showSeconds?bH:bH.slice(0,2)),O=U(()=>{const{spinnerDate:Ae}=s,_e=Ae.hour(),Me=Ae.minute(),Fe=Ae.second();return{hours:_e,minutes:Me,seconds:Fe}}),V=U(()=>{const{hours:Ae,minutes:_e}=p(O),{role:Me,spinnerDate:Fe}=s,Le=l?void 0:Fe;return{hours:v(Me,Le),minutes:g(Ae,Me,Le),seconds:E(Ae,_e,Me,Le)}}),L=U(()=>{const{hours:Ae,minutes:_e,seconds:Me}=p(O);return{hours:aA(Ae,23),minutes:aA(_e,59),seconds:aA(Me,59)}}),D=Hi(Ae=>{b=!1,W(Ae)},200),M=Ae=>{if(!!!s.amPmMode)return"";const Me=s.amPmMode==="A";let Fe=Ae<12?" am":" pm";return Me&&(Fe=Fe.toUpperCase()),Fe},F=Ae=>{let _e=[0,0];if(!d||d===wS)switch(Ae){case"hours":_e=[0,2];break;case"minutes":_e=[3,5];break;case"seconds":_e=[6,8];break}const[Me,Fe]=_e;o("select-range",Me,Fe),S.value=Ae},W=Ae=>{Y(Ae,p(O)[Ae])},z=()=>{W("hours"),W("minutes"),W("seconds")},G=Ae=>Ae.querySelector(`.${h.namespace.value}-scrollbar__wrap`),Y=(Ae,_e)=>{if(s.arrowControl)return;const Me=p(R[Ae]);Me&&Me.$el&&(G(Me.$el).scrollTop=Math.max(0,_e*te(Ae)))},te=Ae=>{const _e=p(R[Ae]),Me=_e==null?void 0:_e.$el.querySelector("li");return Me&&Number.parseFloat(ql(Me,"height"))||0},Z=()=>{Ee(1)},fe=()=>{Ee(-1)},Ee=Ae=>{S.value||F("hours");const _e=S.value,Me=p(O)[_e],Fe=S.value==="hours"?24:60,Le=ae(_e,Me,Ae,Fe);X(_e,Le),Y(_e,Le),Vt(()=>F(_e))},ae=(Ae,_e,Me,Fe)=>{let Le=(_e+Me+Fe)%Fe;const Pe=p(V)[Ae];for(;Pe[Le]&&Le!==_e;)Le=(Le+Me+Fe)%Fe;return Le},X=(Ae,_e)=>{if(p(V)[Ae][_e])return;const{hours:Le,minutes:Pe,seconds:He}=p(O);let We;switch(Ae){case"hours":We=s.spinnerDate.hour(_e).minute(Pe).second(He);break;case"minutes":We=s.spinnerDate.hour(Le).minute(_e).second(He);break;case"seconds":We=s.spinnerDate.hour(Le).minute(Pe).second(_e);break}o(yn,We)},ie=(Ae,{value:_e,disabled:Me})=>{Me||(X(Ae,_e),F(Ae),Y(Ae,_e))},se=Ae=>{const _e=p(R[Ae]);if(!_e)return;b=!0,D(Ae);const Me=Math.min(Math.round((G(_e.$el).scrollTop-(J(Ae)*.5-10)/te(Ae)+3)/te(Ae)),Ae==="hours"?23:59);X(Ae,Me)},J=Ae=>p(R[Ae]).$el.offsetHeight,pe=()=>{const Ae=_e=>{const Me=p(R[_e]);Me&&Me.$el&&(G(Me.$el).onscroll=()=>{se(_e)})};Ae("hours"),Ae("minutes"),Ae("seconds")};dn(()=>{Vt(()=>{!s.arrowControl&&pe(),z(),s.role==="start"&&F("hours")})});const be=(Ae,_e)=>{R[_e].value=Ae??void 0};return o("set-option",[`${s.role}_scrollDown`,Ee]),o("set-option",[`${s.role}_emitSelectRange`,F]),ze(()=>s.spinnerDate,()=>{b||z()}),(Ae,_e)=>($(),le("div",{class:K([p(h).b("spinner"),{"has-seconds":Ae.showSeconds}])},[Ae.arrowControl?De("v-if",!0):($(!0),le(Ut,{key:0},Cn(p(N),Me=>($(),Ve(p(gl),{key:Me,ref_for:!0,ref:Fe=>be(Fe,Me),class:K(p(h).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":p(h).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Fe=>F(Me),onMousemove:Fe=>W(Me)},{default:Ce(()=>[($(!0),le(Ut,null,Cn(p(V)[Me],(Fe,Le)=>($(),le("li",{key:Le,class:K([p(h).be("spinner","item"),p(h).is("active",Le===p(O)[Me]),p(h).is("disabled",Fe)]),onClick:Pe=>ie(Me,{value:Le,disabled:Fe})},[Me==="hours"?($(),le(Ut,{key:0},[bn(ot(("0"+(Ae.amPmMode?Le%12||12:Le)).slice(-2))+ot(M(Le)),1)],64)):($(),le(Ut,{key:1},[bn(ot(("0"+Le).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Ae.arrowControl?($(!0),le(Ut,{key:1},Cn(p(N),Me=>($(),le("div",{key:Me,class:K([p(h).be("spinner","wrapper"),p(h).is("arrow")]),onMouseenter:Fe=>F(Me)},[ln(($(),Ve(p(Dt),{class:K(["arrow-up",p(h).be("spinner","arrow")])},{default:Ce(()=>[ge(p(KN))]),_:1},8,["class"])),[[p(RS),fe]]),ln(($(),Ve(p(Dt),{class:K(["arrow-down",p(h).be("spinner","arrow")])},{default:Ce(()=>[ge(p(uu))]),_:1},8,["class"])),[[p(RS),Z]]),ue("ul",{class:K(p(h).be("spinner","list"))},[($(!0),le(Ut,null,Cn(p(L)[Me],(Fe,Le)=>($(),le("li",{key:Le,class:K([p(h).be("spinner","item"),p(h).is("active",Fe===p(O)[Me]),p(h).is("disabled",p(V)[Me][Fe])])},[p($t)(Fe)?($(),le(Ut,{key:0},[Me==="hours"?($(),le(Ut,{key:0},[bn(ot(("0"+(Ae.amPmMode?Fe%12||12:Fe)).slice(-2))+ot(M(Fe)),1)],64)):($(),le(Ut,{key:1},[bn(ot(("0"+Fe).slice(-2)),1)],64))],64)):De("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):De("v-if",!0)],2))}});var iO=dt(UIe,[["__file","basic-time-spinner.vue"]]);const VIe=me({__name:"panel-time-pick",props:DIe,emits:["pick","select-range","set-picker-option"],setup(t,{emit:o}){const s=t,a=It("EP_PICKER_BASE"),{arrowControl:l,disabledHours:d,disabledMinutes:h,disabledSeconds:v,defaultValue:g}=a.props,{getAvailableHours:E,getAvailableMinutes:b,getAvailableSeconds:S}=zG(d,h,v),C=Qe("time"),{t:w,lang:I}=Fn(),R=ee([0,2]),N=YG(s),O=U(()=>Xn(s.actualVisible)?`${C.namespace.value}-zoom-in-top`:""),V=U(()=>s.format.includes("ss")),L=U(()=>s.format.includes("A")?"A":s.format.includes("a")?"a":""),D=se=>{const J=on(se).locale(I.value),pe=Ee(J);return J.isSame(pe)},M=()=>{o("pick",N.value,!1)},F=(se=!1,J=!1)=>{J||o("pick",s.parsedValue,se)},W=se=>{if(!s.visible)return;const J=Ee(se).millisecond(0);o("pick",J,!0)},z=(se,J)=>{o("select-range",se,J),R.value=[se,J]},G=se=>{const J=[0,3].concat(V.value?[6]:[]),pe=["hours","minutes"].concat(V.value?["seconds"]:[]),Ae=(J.indexOf(R.value[0])+se+J.length)%J.length;te.start_emitSelectRange(pe[Ae])},Y=se=>{const J=se.code,{left:pe,right:be,up:Ae,down:_e}=Ct;if([pe,be].includes(J)){G(J===pe?-1:1),se.preventDefault();return}if([Ae,_e].includes(J)){const Me=J===Ae?-1:1;te.start_scrollDown(Me),se.preventDefault();return}},{timePickerOptions:te,onSetOption:Z,getAvailableTime:fe}=KG({getAvailableHours:E,getAvailableMinutes:b,getAvailableSeconds:S}),Ee=se=>fe(se,s.datetimeRole||"",!0),ae=se=>se?on(se,s.format).locale(I.value):null,X=se=>se?se.format(s.format):null,ie=()=>on(g).locale(I.value);return o("set-picker-option",["isValidValue",D]),o("set-picker-option",["formatToString",X]),o("set-picker-option",["parseUserInput",ae]),o("set-picker-option",["handleKeydownInput",Y]),o("set-picker-option",["getRangeAvailableTime",Ee]),o("set-picker-option",["getDefaultValue",ie]),(se,J)=>($(),Ve(hs,{name:p(O)},{default:Ce(()=>[se.actualVisible||se.visible?($(),le("div",{key:0,class:K(p(C).b("panel"))},[ue("div",{class:K([p(C).be("panel","content"),{"has-seconds":p(V)}])},[ge(iO,{ref:"spinner",role:se.datetimeRole||"start","arrow-control":p(l),"show-seconds":p(V),"am-pm-mode":p(L),"spinner-date":se.parsedValue,"disabled-hours":p(d),"disabled-minutes":p(h),"disabled-seconds":p(v),onChange:W,onSetOption:p(Z),onSelectRange:z},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),ue("div",{class:K(p(C).be("panel","footer"))},[ue("button",{type:"button",class:K([p(C).be("panel","btn"),"cancel"]),onClick:M},ot(p(w)("el.datepicker.cancel")),3),ue("button",{type:"button",class:K([p(C).be("panel","btn"),"confirm"]),onClick:pe=>F()},ot(p(w)("el.datepicker.confirm")),11,["onClick"])],2)],2)):De("v-if",!0)]),_:1},8,["name"]))}});var IS=dt(VIe,[["__file","panel-time-pick.vue"]]);const FIe=ut({...HG,parsedValue:{type:Re(Array)}}),BIe=me({__name:"panel-time-range",props:FIe,emits:["pick","select-range","set-picker-option"],setup(t,{emit:o}){const s=t,a=(it,ce)=>{const Se=[];for(let je=it;je<=ce;je++)Se.push(je);return Se},{t:l,lang:d}=Fn(),h=Qe("time"),v=Qe("picker"),g=It("EP_PICKER_BASE"),{arrowControl:E,disabledHours:b,disabledMinutes:S,disabledSeconds:C,defaultValue:w}=g.props,I=U(()=>[h.be("range-picker","body"),h.be("panel","content"),h.is("arrow",E),D.value?"has-seconds":""]),R=U(()=>[h.be("range-picker","body"),h.be("panel","content"),h.is("arrow",E),D.value?"has-seconds":""]),N=U(()=>s.parsedValue[0]),O=U(()=>s.parsedValue[1]),V=YG(s),L=()=>{o("pick",V.value,!1)},D=U(()=>s.format.includes("ss")),M=U(()=>s.format.includes("A")?"A":s.format.includes("a")?"a":""),F=(it=!1)=>{o("pick",[N.value,O.value],it)},W=it=>{Y(it.millisecond(0),O.value)},z=it=>{Y(N.value,it.millisecond(0))},G=it=>{const ce=it.map(je=>on(je).locale(d.value)),Se=be(ce);return ce[0].isSame(Se[0])&&ce[1].isSame(Se[1])},Y=(it,ce)=>{s.visible&&o("pick",[it,ce],!0)},te=U(()=>N.value>O.value),Z=ee([0,2]),fe=(it,ce)=>{o("select-range",it,ce,"min"),Z.value=[it,ce]},Ee=U(()=>D.value?11:8),ae=(it,ce)=>{o("select-range",it,ce,"max");const Se=p(Ee);Z.value=[it+Se,ce+Se]},X=it=>{const ce=D.value?[0,3,6,11,14,17]:[0,3,8,11],Se=["hours","minutes"].concat(D.value?["seconds"]:[]),tt=(ce.indexOf(Z.value[0])+it+ce.length)%ce.length,et=ce.length/2;tt<et?Fe.start_emitSelectRange(Se[tt]):Fe.end_emitSelectRange(Se[tt-et])},ie=it=>{const ce=it.code,{left:Se,right:je,up:tt,down:et}=Ct;if([Se,je].includes(ce)){X(ce===Se?-1:1),it.preventDefault();return}if([tt,et].includes(ce)){const Ge=ce===tt?-1:1,Xe=Z.value[0]<Ee.value?"start":"end";Fe[`${Xe}_scrollDown`](Ge),it.preventDefault();return}},se=(it,ce)=>{const Se=b?b(it):[],je=it==="start",et=(ce||(je?O.value:N.value)).hour(),Ge=je?a(et+1,23):a(0,et-1);return tA(Se,Ge)},J=(it,ce,Se)=>{const je=S?S(it,ce):[],tt=ce==="start",et=Se||(tt?O.value:N.value),Ge=et.hour();if(it!==Ge)return je;const Xe=et.minute(),Ye=tt?a(Xe+1,59):a(0,Xe-1);return tA(je,Ye)},pe=(it,ce,Se,je)=>{const tt=C?C(it,ce,Se):[],et=Se==="start",Ge=je||(et?O.value:N.value),Xe=Ge.hour(),Ye=Ge.minute();if(it!==Xe||ce!==Ye)return tt;const ct=Ge.second(),nt=et?a(ct+1,59):a(0,ct-1);return tA(tt,nt)},be=([it,ce])=>[Le(it,"start",!0,ce),Le(ce,"end",!1,it)],{getAvailableHours:Ae,getAvailableMinutes:_e,getAvailableSeconds:Me}=zG(se,J,pe),{timePickerOptions:Fe,getAvailableTime:Le,onSetOption:Pe}=KG({getAvailableHours:Ae,getAvailableMinutes:_e,getAvailableSeconds:Me}),He=it=>it?st(it)?it.map(ce=>on(ce,s.format).locale(d.value)):on(it,s.format).locale(d.value):null,We=it=>it?st(it)?it.map(ce=>ce.format(s.format)):it.format(s.format):null,yt=()=>{if(st(w))return w.map(ce=>on(ce).locale(d.value));const it=on(w).locale(d.value);return[it,it.add(60,"m")]};return o("set-picker-option",["formatToString",We]),o("set-picker-option",["parseUserInput",He]),o("set-picker-option",["isValidValue",G]),o("set-picker-option",["handleKeydownInput",ie]),o("set-picker-option",["getDefaultValue",yt]),o("set-picker-option",["getRangeAvailableTime",be]),(it,ce)=>it.actualVisible?($(),le("div",{key:0,class:K([p(h).b("range-picker"),p(v).b("panel")])},[ue("div",{class:K(p(h).be("range-picker","content"))},[ue("div",{class:K(p(h).be("range-picker","cell"))},[ue("div",{class:K(p(h).be("range-picker","header"))},ot(p(l)("el.datepicker.startTime")),3),ue("div",{class:K(p(I))},[ge(iO,{ref:"minSpinner",role:"start","show-seconds":p(D),"am-pm-mode":p(M),"arrow-control":p(E),"spinner-date":p(N),"disabled-hours":se,"disabled-minutes":J,"disabled-seconds":pe,onChange:W,onSetOption:p(Pe),onSelectRange:fe},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),ue("div",{class:K(p(h).be("range-picker","cell"))},[ue("div",{class:K(p(h).be("range-picker","header"))},ot(p(l)("el.datepicker.endTime")),3),ue("div",{class:K(p(R))},[ge(iO,{ref:"maxSpinner",role:"end","show-seconds":p(D),"am-pm-mode":p(M),"arrow-control":p(E),"spinner-date":p(O),"disabled-hours":se,"disabled-minutes":J,"disabled-seconds":pe,onChange:z,onSetOption:p(Pe),onSelectRange:ae},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),ue("div",{class:K(p(h).be("panel","footer"))},[ue("button",{type:"button",class:K([p(h).be("panel","btn"),"cancel"]),onClick:Se=>L()},ot(p(l)("el.datepicker.cancel")),11,["onClick"]),ue("button",{type:"button",class:K([p(h).be("panel","btn"),"confirm"]),disabled:p(te),onClick:Se=>F()},ot(p(l)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):De("v-if",!0)}});var jIe=dt(BIe,[["__file","panel-time-range.vue"]]);on.extend(vk);var $Ie=me({name:"ElTimePicker",install:null,props:{...gk,isRange:{type:Boolean,default:!1}},emits:[Jt],setup(t,o){const s=ee(),[a,l]=t.isRange?["timerange",jIe]:["time",IS],d=h=>o.emit(Jt,h);return wn("ElPopperOptions",t.popperOptions),o.expose({focus:()=>{var h;(h=s.value)==null||h.focus()},blur:()=>{var h;(h=s.value)==null||h.blur()},handleOpen:()=>{var h;(h=s.value)==null||h.handleOpen()},handleClose:()=>{var h;(h=s.value)==null||h.handleClose()}}),()=>{var h;const v=(h=t.format)!=null?h:wS;return ge(WG,En(t,{ref:s,type:a,format:v,"onUpdate:modelValue":d}),{default:g=>ge(l,g,null)})}}});const HIe=rn($Ie),T0=Symbol(),WIe=ut({...gk,type:{type:Re(String),default:"date"}}),KIe=["date","dates","year","years","month","months","week","range"],_k=ut({disabledDate:{type:Re(Function)},date:{type:Re(Object),required:!0},minDate:{type:Re(Object)},maxDate:{type:Re(Object)},parsedValue:{type:Re([Object,Array])},rangeState:{type:Re(Object),default:()=>({endDate:null,selecting:!1})}}),qG=ut({type:{type:Re(String),required:!0,values:uCe},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),Ek=ut({unlinkPanels:Boolean,parsedValue:{type:Re(Array)}}),yk=t=>({type:String,values:KIe,default:t}),GIe=ut({...qG,parsedValue:{type:Re([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),Zp=t=>{if(!st(t))return!1;const[o,s]=t;return on.isDayjs(o)&&on.isDayjs(s)&&on(o).isValid()&&on(s).isValid()&&o.isSameOrBefore(s)},bk=(t,{lang:o,unit:s,unlinkPanels:a})=>{let l;if(st(t)){let[d,h]=t.map(v=>on(v).locale(o));return a||(h=d.add(1,s)),[d,h]}else t?l=on(t):l=on();return l=l.locale(o),[l,l.add(1,s)]},zIe=(t,o,{columnIndexOffset:s,startDate:a,nextEndDate:l,now:d,unit:h,relativeDateGetter:v,setCellMetadata:g,setRowMetadata:E})=>{for(let b=0;b<t.row;b++){const S=o[b];for(let C=0;C<t.column;C++){let w=S[C+s];w||(w={row:b,column:C,type:"normal",inRange:!1,start:!1,end:!1});const I=b*t.column+C,R=v(I);w.dayjs=R,w.date=R.toDate(),w.timestamp=R.valueOf(),w.type="normal",w.inRange=!!(a&&R.isSameOrAfter(a,h)&&l&&R.isSameOrBefore(l,h))||!!(a&&R.isSameOrBefore(a,h)&&l&&R.isSameOrAfter(l,h)),a!=null&&a.isSameOrAfter(l)?(w.start=!!l&&R.isSame(l,h),w.end=a&&R.isSame(a,h)):(w.start=!!a&&R.isSame(a,h),w.end=!!l&&R.isSame(l,h)),R.isSame(d,h)&&(w.type="today"),g==null||g(w,{rowIndex:b,columnIndex:C}),S[C+s]=w}E==null||E(S)}},AS=(t,o,s)=>{const a=on().locale(s).startOf("month").month(o).year(t),l=a.daysInMonth();return sd(l).map(d=>a.add(d,"day").toDate())},jg=(t,o,s,a)=>{const l=on().year(t).month(o).startOf("month"),d=AS(t,o,s).find(h=>!(a!=null&&a(h)));return d?on(d).locale(s):l.locale(s)},aO=(t,o,s)=>{const a=t.year();if(!(s!=null&&s(t.toDate())))return t.locale(o);const l=t.month();if(!AS(a,l,o).every(s))return jg(a,l,o,s);for(let d=0;d<12;d++)if(!AS(a,d,o).every(s))return jg(a,d,o,s);return t},Qp=(t,o,s)=>{if(st(t))return t.map(a=>Qp(a,o,s));if(typeof t=="string"){const a=on(t);if(!a.isValid())return a}return on(t,o).locale(s)},YIe=ut({..._k,cellClassName:{type:Re(Function)},showWeekNumber:Boolean,selectionMode:yk("date")}),qIe=["changerange","pick","select"],cO=(t="")=>["normal","today"].includes(t),XIe=(t,o)=>{const{lang:s}=Fn(),a=ee(),l=ee(),d=ee(),h=ee(),v=ee([[],[],[],[],[],[]]);let g=!1;const E=t.date.$locale().weekStart||7,b=t.date.locale("en").localeData().weekdaysShort().map(J=>J.toLowerCase()),S=U(()=>E>3?7-E:-E),C=U(()=>{const J=t.date.startOf("month");return J.subtract(J.day()||7,"day")}),w=U(()=>b.concat(b).slice(E,E+7)),I=U(()=>wW(p(D)).some(J=>J.isCurrent)),R=U(()=>{const J=t.date.startOf("month"),pe=J.day()||7,be=J.daysInMonth(),Ae=J.subtract(1,"month").daysInMonth();return{startOfMonthDay:pe,dateCountOfMonth:be,dateCountOfLastMonth:Ae}}),N=U(()=>t.selectionMode==="dates"?fi(t.parsedValue):[]),O=(J,{count:pe,rowIndex:be,columnIndex:Ae})=>{const{startOfMonthDay:_e,dateCountOfMonth:Me,dateCountOfLastMonth:Fe}=p(R),Le=p(S);if(be>=0&&be<=1){const Pe=_e+Le<0?7+_e+Le:_e+Le;if(Ae+be*7>=Pe)return J.text=pe,!0;J.text=Fe-(Pe-Ae%7)+1+be*7,J.type="prev-month"}else return pe<=Me?J.text=pe:(J.text=pe-Me,J.type="next-month"),!0;return!1},V=(J,{columnIndex:pe,rowIndex:be},Ae)=>{const{disabledDate:_e,cellClassName:Me}=t,Fe=p(N),Le=O(J,{count:Ae,rowIndex:be,columnIndex:pe}),Pe=J.dayjs.toDate();return J.selected=Fe.find(He=>He.isSame(J.dayjs,"day")),J.isSelected=!!J.selected,J.isCurrent=F(J),J.disabled=_e==null?void 0:_e(Pe),J.customClass=Me==null?void 0:Me(Pe),Le},L=J=>{if(t.selectionMode==="week"){const[pe,be]=t.showWeekNumber?[1,7]:[0,6],Ae=se(J[pe+1]);J[pe].inRange=Ae,J[pe].start=Ae,J[be].inRange=Ae,J[be].end=Ae}},D=U(()=>{const{minDate:J,maxDate:pe,rangeState:be,showWeekNumber:Ae}=t,_e=p(S),Me=p(v),Fe="day";let Le=1;if(Ae)for(let Pe=0;Pe<6;Pe++)Me[Pe][0]||(Me[Pe][0]={type:"week",text:p(C).add(Pe*7+1,Fe).week()});return zIe({row:6,column:7},Me,{startDate:J,columnIndexOffset:Ae?1:0,nextEndDate:be.endDate||pe||be.selecting&&J||null,now:on().locale(p(s)).startOf(Fe),unit:Fe,relativeDateGetter:Pe=>p(C).add(Pe-_e,Fe),setCellMetadata:(...Pe)=>{V(...Pe,Le)&&(Le+=1)},setRowMetadata:L}),Me});ze(()=>t.date,async()=>{var J;(J=p(a))!=null&&J.contains(document.activeElement)&&(await Vt(),await M())});const M=async()=>{var J;return(J=p(l))==null?void 0:J.focus()},F=J=>t.selectionMode==="date"&&cO(J.type)&&W(J,t.parsedValue),W=(J,pe)=>pe?on(pe).locale(p(s)).isSame(t.date.date(Number(J.text)),"day"):!1,z=(J,pe)=>{const be=J*7+(pe-(t.showWeekNumber?1:0))-p(S);return p(C).add(be,"day")},G=J=>{var pe;if(!t.rangeState.selecting)return;let be=J.target;if(be.tagName==="SPAN"&&(be=(pe=be.parentNode)==null?void 0:pe.parentNode),be.tagName==="DIV"&&(be=be.parentNode),be.tagName!=="TD")return;const Ae=be.parentNode.rowIndex-1,_e=be.cellIndex;p(D)[Ae][_e].disabled||(Ae!==p(d)||_e!==p(h))&&(d.value=Ae,h.value=_e,o("changerange",{selecting:!0,endDate:z(Ae,_e)}))},Y=J=>!p(I)&&(J==null?void 0:J.text)===1&&J.type==="normal"||J.isCurrent,te=J=>{g||p(I)||t.selectionMode!=="date"||ie(J,!0)},Z=J=>{J.target.closest("td")&&(g=!0)},fe=J=>{J.target.closest("td")&&(g=!1)},Ee=J=>{!t.rangeState.selecting||!t.minDate?(o("pick",{minDate:J,maxDate:null}),o("select",!0)):(J>=t.minDate?o("pick",{minDate:t.minDate,maxDate:J}):o("pick",{minDate:J,maxDate:t.minDate}),o("select",!1))},ae=J=>{const pe=J.week(),be=`${J.year()}w${pe}`;o("pick",{year:J.year(),week:pe,value:be,date:J.startOf("week")})},X=(J,pe)=>{const be=pe?fi(t.parsedValue).filter(Ae=>(Ae==null?void 0:Ae.valueOf())!==J.valueOf()):fi(t.parsedValue).concat([J]);o("pick",be)},ie=(J,pe=!1)=>{const be=J.target.closest("td");if(!be)return;const Ae=be.parentNode.rowIndex-1,_e=be.cellIndex,Me=p(D)[Ae][_e];if(Me.disabled||Me.type==="week")return;const Fe=z(Ae,_e);switch(t.selectionMode){case"range":{Ee(Fe);break}case"date":{o("pick",Fe,pe);break}case"week":{ae(Fe);break}case"dates":{X(Fe,!!Me.selected);break}}},se=J=>{if(t.selectionMode!=="week")return!1;let pe=t.date.startOf("day");if(J.type==="prev-month"&&(pe=pe.subtract(1,"month")),J.type==="next-month"&&(pe=pe.add(1,"month")),pe=pe.date(Number.parseInt(J.text,10)),t.parsedValue&&!st(t.parsedValue)){const be=(t.parsedValue.day()-E+7)%7-1;return t.parsedValue.subtract(be,"day").isSame(pe,"day")}return!1};return{WEEKS:w,rows:D,tbodyRef:a,currentCellRef:l,focus:M,isCurrent:F,isWeekActive:se,isSelectedCell:Y,handlePickDate:ie,handleMouseUp:fe,handleMouseDown:Z,handleMouseMove:G,handleFocus:te}},JIe=(t,{isCurrent:o,isWeekActive:s})=>{const a=Qe("date-table"),{t:l}=Fn(),d=U(()=>[a.b(),{"is-week-mode":t.selectionMode==="week"}]),h=U(()=>l("el.datepicker.dateTablePrompt")),v=U(()=>l("el.datepicker.week"));return{tableKls:d,tableLabel:h,weekLabel:v,getCellClasses:b=>{const S=[];return cO(b.type)&&!b.disabled?(S.push("available"),b.type==="today"&&S.push("today")):S.push(b.type),o(b)&&S.push("current"),b.inRange&&(cO(b.type)||t.selectionMode==="week")&&(S.push("in-range"),b.start&&S.push("start-date"),b.end&&S.push("end-date")),b.disabled&&S.push("disabled"),b.selected&&S.push("selected"),b.customClass&&S.push(b.customClass),S.join(" ")},getRowKls:b=>[a.e("row"),{current:s(b)}],t:l}},ZIe=ut({cell:{type:Re(Object)}});var Sk=me({name:"ElDatePickerCell",props:ZIe,setup(t){const o=Qe("date-table-cell"),{slots:s}=It(T0);return()=>{const{cell:a}=t;return Ne(s,"default",{...a},()=>{var l;return[ge("div",{class:o.b()},[ge("span",{class:o.e("text")},[(l=a==null?void 0:a.renderText)!=null?l:a==null?void 0:a.text])])]})}}});const QIe=me({__name:"basic-date-table",props:YIe,emits:qIe,setup(t,{expose:o,emit:s}){const a=t,{WEEKS:l,rows:d,tbodyRef:h,currentCellRef:v,focus:g,isCurrent:E,isWeekActive:b,isSelectedCell:S,handlePickDate:C,handleMouseUp:w,handleMouseDown:I,handleMouseMove:R,handleFocus:N}=XIe(a,s),{tableLabel:O,tableKls:V,weekLabel:L,getCellClasses:D,getRowKls:M,t:F}=JIe(a,{isCurrent:E,isWeekActive:b});return o({focus:g}),(W,z)=>($(),le("table",{"aria-label":p(O),class:K(p(V)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:p(C),onMousemove:p(R),onMousedown:Gt(p(I),["prevent"]),onMouseup:p(w)},[ue("tbody",{ref_key:"tbodyRef",ref:h},[ue("tr",null,[W.showWeekNumber?($(),le("th",{key:0,scope:"col"},ot(p(L)),1)):De("v-if",!0),($(!0),le(Ut,null,Cn(p(l),(G,Y)=>($(),le("th",{key:Y,"aria-label":p(F)("el.datepicker.weeksFull."+G),scope:"col"},ot(p(F)("el.datepicker.weeks."+G)),9,["aria-label"]))),128))]),($(!0),le(Ut,null,Cn(p(d),(G,Y)=>($(),le("tr",{key:Y,class:K(p(M)(G[1]))},[($(!0),le(Ut,null,Cn(G,(te,Z)=>($(),le("td",{key:`${Y}.${Z}`,ref_for:!0,ref:fe=>p(S)(te)&&(v.value=fe),class:K(p(D)(te)),"aria-current":te.isCurrent?"date":void 0,"aria-selected":te.isCurrent,tabindex:p(S)(te)?0:-1,onFocus:p(N)},[ge(p(Sk),{cell:te},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var lO=dt(QIe,[["__file","basic-date-table.vue"]]);const eAe=ut({..._k,selectionMode:yk("month")}),tAe=me({__name:"basic-month-table",props:eAe,emits:["changerange","pick","select"],setup(t,{expose:o,emit:s}){const a=t,l=Qe("month-table"),{t:d,lang:h}=Fn(),v=ee(),g=ee(),E=ee(a.date.locale("en").localeData().monthsShort().map(L=>L.toLowerCase())),b=ee([[],[],[]]),S=ee(),C=ee(),w=U(()=>{var L,D;const M=b.value,F=on().locale(h.value).startOf("month");for(let W=0;W<3;W++){const z=M[W];for(let G=0;G<4;G++){const Y=z[G]||(z[G]={row:W,column:G,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});Y.type="normal";const te=W*4+G,Z=a.date.startOf("year").month(te),fe=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;Y.inRange=!!(a.minDate&&Z.isSameOrAfter(a.minDate,"month")&&fe&&Z.isSameOrBefore(fe,"month"))||!!(a.minDate&&Z.isSameOrBefore(a.minDate,"month")&&fe&&Z.isSameOrAfter(fe,"month")),(L=a.minDate)!=null&&L.isSameOrAfter(fe)?(Y.start=!!(fe&&Z.isSame(fe,"month")),Y.end=a.minDate&&Z.isSame(a.minDate,"month")):(Y.start=!!(a.minDate&&Z.isSame(a.minDate,"month")),Y.end=!!(fe&&Z.isSame(fe,"month"))),F.isSame(Z)&&(Y.type="today"),Y.text=te,Y.disabled=((D=a.disabledDate)==null?void 0:D.call(a,Z.toDate()))||!1}}return M}),I=()=>{var L;(L=g.value)==null||L.focus()},R=L=>{const D={},M=a.date.year(),F=new Date,W=L.text;return D.disabled=a.disabledDate?AS(M,W,h.value).every(a.disabledDate):!1,D.current=fi(a.parsedValue).findIndex(z=>on.isDayjs(z)&&z.year()===M&&z.month()===W)>=0,D.today=F.getFullYear()===M&&F.getMonth()===W,L.inRange&&(D["in-range"]=!0,L.start&&(D["start-date"]=!0),L.end&&(D["end-date"]=!0)),D},N=L=>{const D=a.date.year(),M=L.text;return fi(a.date).findIndex(F=>F.year()===D&&F.month()===M)>=0},O=L=>{var D;if(!a.rangeState.selecting)return;let M=L.target;if(M.tagName==="SPAN"&&(M=(D=M.parentNode)==null?void 0:D.parentNode),M.tagName==="DIV"&&(M=M.parentNode),M.tagName!=="TD")return;const F=M.parentNode.rowIndex,W=M.cellIndex;w.value[F][W].disabled||(F!==S.value||W!==C.value)&&(S.value=F,C.value=W,s("changerange",{selecting:!0,endDate:a.date.startOf("year").month(F*4+W)}))},V=L=>{var D;const M=(D=L.target)==null?void 0:D.closest("td");if((M==null?void 0:M.tagName)!=="TD"||Fi(M,"disabled"))return;const F=M.cellIndex,z=M.parentNode.rowIndex*4+F,G=a.date.startOf("year").month(z);if(a.selectionMode==="months"){if(L.type==="keydown"){s("pick",fi(a.parsedValue),!1);return}const Y=jg(a.date.year(),z,h.value,a.disabledDate),te=Fi(M,"current")?fi(a.parsedValue).filter(Z=>(Z==null?void 0:Z.year())!==Y.year()||(Z==null?void 0:Z.month())!==Y.month()):fi(a.parsedValue).concat([on(Y)]);s("pick",te)}else a.selectionMode==="range"?a.rangeState.selecting?(a.minDate&&G>=a.minDate?s("pick",{minDate:a.minDate,maxDate:G}):s("pick",{minDate:G,maxDate:a.minDate}),s("select",!1)):(s("pick",{minDate:G,maxDate:null}),s("select",!0)):s("pick",z)};return ze(()=>a.date,async()=>{var L,D;(L=v.value)!=null&&L.contains(document.activeElement)&&(await Vt(),(D=g.value)==null||D.focus())}),o({focus:I}),(L,D)=>($(),le("table",{role:"grid","aria-label":p(d)("el.datepicker.monthTablePrompt"),class:K(p(l).b()),onClick:V,onMousemove:O},[ue("tbody",{ref_key:"tbodyRef",ref:v},[($(!0),le(Ut,null,Cn(p(w),(M,F)=>($(),le("tr",{key:F},[($(!0),le(Ut,null,Cn(M,(W,z)=>($(),le("td",{key:z,ref_for:!0,ref:G=>N(W)&&(g.value=G),class:K(R(W)),"aria-selected":`${N(W)}`,"aria-label":p(d)(`el.datepicker.month${+W.text+1}`),tabindex:N(W)?0:-1,onKeydown:[Cr(Gt(V,["prevent","stop"]),["space"]),Cr(Gt(V,["prevent","stop"]),["enter"])]},[ge(p(Sk),{cell:{...W,renderText:p(d)("el.datepicker.months."+E.value[W.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var uO=dt(tAe,[["__file","basic-month-table.vue"]]);const nAe=ut({..._k,selectionMode:yk("year")}),rAe=me({__name:"basic-year-table",props:nAe,emits:["changerange","pick","select"],setup(t,{expose:o,emit:s}){const a=t,l=(D,M)=>{const F=on(String(D)).locale(M).startOf("year"),z=F.endOf("year").dayOfYear();return sd(z).map(G=>F.add(G,"day").toDate())},d=Qe("year-table"),{t:h,lang:v}=Fn(),g=ee(),E=ee(),b=U(()=>Math.floor(a.date.year()/10)*10),S=ee([[],[],[]]),C=ee(),w=ee(),I=U(()=>{var D;const M=S.value,F=on().locale(v.value).startOf("year");for(let W=0;W<3;W++){const z=M[W];for(let G=0;G<4&&!(W*4+G>=10);G++){let Y=z[G];Y||(Y={row:W,column:G,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),Y.type="normal";const te=W*4+G+b.value,Z=on().year(te),fe=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;Y.inRange=!!(a.minDate&&Z.isSameOrAfter(a.minDate,"year")&&fe&&Z.isSameOrBefore(fe,"year"))||!!(a.minDate&&Z.isSameOrBefore(a.minDate,"year")&&fe&&Z.isSameOrAfter(fe,"year")),(D=a.minDate)!=null&&D.isSameOrAfter(fe)?(Y.start=!!(fe&&Z.isSame(fe,"year")),Y.end=!!(a.minDate&&Z.isSame(a.minDate,"year"))):(Y.start=!!(a.minDate&&Z.isSame(a.minDate,"year")),Y.end=!!(fe&&Z.isSame(fe,"year"))),F.isSame(Z)&&(Y.type="today"),Y.text=te;const ae=Z.toDate();Y.disabled=a.disabledDate&&a.disabledDate(ae)||!1,z[G]=Y}}return M}),R=()=>{var D;(D=E.value)==null||D.focus()},N=D=>{const M={},F=on().locale(v.value),W=D.text;return M.disabled=a.disabledDate?l(W,v.value).every(a.disabledDate):!1,M.today=F.year()===W,M.current=fi(a.parsedValue).findIndex(z=>z.year()===W)>=0,D.inRange&&(M["in-range"]=!0,D.start&&(M["start-date"]=!0),D.end&&(M["end-date"]=!0)),M},O=D=>{const M=D.text;return fi(a.date).findIndex(F=>F.year()===M)>=0},V=D=>{var M;const F=(M=D.target)==null?void 0:M.closest("td");if(!F||!F.textContent||Fi(F,"disabled"))return;const W=F.cellIndex,G=F.parentNode.rowIndex*4+W+b.value,Y=on().year(G);if(a.selectionMode==="range")a.rangeState.selecting?(a.minDate&&Y>=a.minDate?s("pick",{minDate:a.minDate,maxDate:Y}):s("pick",{minDate:Y,maxDate:a.minDate}),s("select",!1)):(s("pick",{minDate:Y,maxDate:null}),s("select",!0));else if(a.selectionMode==="years"){if(D.type==="keydown"){s("pick",fi(a.parsedValue),!1);return}const te=aO(Y.startOf("year"),v.value,a.disabledDate),Z=Fi(F,"current")?fi(a.parsedValue).filter(fe=>(fe==null?void 0:fe.year())!==G):fi(a.parsedValue).concat([te]);s("pick",Z)}else s("pick",G)},L=D=>{var M;if(!a.rangeState.selecting)return;const F=(M=D.target)==null?void 0:M.closest("td");if(!F)return;const W=F.parentNode.rowIndex,z=F.cellIndex;I.value[W][z].disabled||(W!==C.value||z!==w.value)&&(C.value=W,w.value=z,s("changerange",{selecting:!0,endDate:on().year(b.value).add(W*4+z,"year")}))};return ze(()=>a.date,async()=>{var D,M;(D=g.value)!=null&&D.contains(document.activeElement)&&(await Vt(),(M=E.value)==null||M.focus())}),o({focus:R}),(D,M)=>($(),le("table",{role:"grid","aria-label":p(h)("el.datepicker.yearTablePrompt"),class:K(p(d).b()),onClick:V,onMousemove:L},[ue("tbody",{ref_key:"tbodyRef",ref:g},[($(!0),le(Ut,null,Cn(p(I),(F,W)=>($(),le("tr",{key:W},[($(!0),le(Ut,null,Cn(F,(z,G)=>($(),le("td",{key:`${W}_${G}`,ref_for:!0,ref:Y=>O(z)&&(E.value=Y),class:K(["available",N(z)]),"aria-selected":O(z),"aria-label":String(z.text),tabindex:O(z)?0:-1,onKeydown:[Cr(Gt(V,["prevent","stop"]),["space"]),Cr(Gt(V,["prevent","stop"]),["enter"])]},[ge(p(Sk),{cell:z},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var dO=dt(rAe,[["__file","basic-year-table.vue"]]);const oAe=me({__name:"panel-date-pick",props:GIe,emits:["pick","set-picker-option","panel-change"],setup(t,{emit:o}){const s=t,a=(Je,Ie,Ke)=>!0,l=Qe("picker-panel"),d=Qe("date-picker"),h=au(),v=Jo(),{t:g,lang:E}=Fn(),b=It("EP_PICKER_BASE"),S=It(b0),{shortcuts:C,disabledDate:w,cellClassName:I,defaultTime:R}=b.props,N=lr(b.props,"defaultValue"),O=ee(),V=ee(on().locale(E.value)),L=ee(!1);let D=!1;const M=U(()=>on(R).locale(E.value)),F=U(()=>V.value.month()),W=U(()=>V.value.year()),z=ee([]),G=ee(null),Y=ee(null),te=Je=>z.value.length>0?a(Je,z.value,s.format||"HH:mm:ss"):!0,Z=Je=>R&&!tt.value&&!L.value&&!D?M.value.year(Je.year()).month(Je.month()).date(Je.date()):Pe.value?Je.millisecond(0):Je.startOf("day"),fe=(Je,...Ie)=>{if(!Je)o("pick",Je,...Ie);else if(st(Je)){const Ke=Je.map(Z);o("pick",Ke,...Ie)}else o("pick",Z(Je),...Ie);G.value=null,Y.value=null,L.value=!1,D=!1},Ee=async(Je,Ie)=>{if(pe.value==="date"){Je=Je;let Ke=s.parsedValue?s.parsedValue.year(Je.year()).month(Je.month()).date(Je.date()):Je;te(Ke)||(Ke=z.value[0][0].year(Je.year()).month(Je.month()).date(Je.date())),V.value=Ke,fe(Ke,Pe.value||Ie),s.type==="datetime"&&(await Vt(),tn())}else pe.value==="week"?fe(Je.date):pe.value==="dates"&&fe(Je,!0)},ae=Je=>{const Ie=Je?"add":"subtract";V.value=V.value[Ie](1,"month"),Wt("month")},X=Je=>{const Ie=V.value,Ke=Je?"add":"subtract";V.value=ie.value==="year"?Ie[Ke](10,"year"):Ie[Ke](1,"year"),Wt("year")},ie=ee("date"),se=U(()=>{const Je=g("el.datepicker.year");if(ie.value==="year"){const Ie=Math.floor(W.value/10)*10;return Je?`${Ie} ${Je} - ${Ie+9} ${Je}`:`${Ie} - ${Ie+9}`}return`${W.value} ${Je}`}),J=Je=>{const Ie=Ft(Je.value)?Je.value():Je.value;if(Ie){D=!0,fe(on(Ie).locale(E.value));return}Je.onClick&&Je.onClick({attrs:h,slots:v,emit:o})},pe=U(()=>{const{type:Je}=s;return["week","month","months","year","years","dates"].includes(Je)?Je:"date"}),be=U(()=>pe.value==="dates"||pe.value==="months"||pe.value==="years"),Ae=U(()=>pe.value==="date"?ie.value:pe.value),_e=U(()=>!!C.length),Me=async(Je,Ie)=>{pe.value==="month"?(V.value=jg(V.value.year(),Je,E.value,w),fe(V.value,!1)):pe.value==="months"?fe(Je,Ie??!0):(V.value=jg(V.value.year(),Je,E.value,w),ie.value="date",["month","year","date","week"].includes(pe.value)&&(fe(V.value,!0),await Vt(),tn())),Wt("month")},Fe=async(Je,Ie)=>{if(pe.value==="year"){const Ke=V.value.startOf("year").year(Je);V.value=aO(Ke,E.value,w),fe(V.value,!1)}else if(pe.value==="years")fe(Je,Ie??!0);else{const Ke=V.value.year(Je);V.value=aO(Ke,E.value,w),ie.value="month",["month","year","date","week"].includes(pe.value)&&(fe(V.value,!0),await Vt(),tn())}Wt("year")},Le=async Je=>{ie.value=Je,await Vt(),tn()},Pe=U(()=>s.type==="datetime"||s.type==="datetimerange"),He=U(()=>{const Je=Pe.value||pe.value==="dates",Ie=pe.value==="years",Ke=pe.value==="months",Te=ie.value==="date",vt=ie.value==="year",an=ie.value==="month";return Je&&Te||Ie&&vt||Ke&&an}),We=U(()=>w?s.parsedValue?st(s.parsedValue)?w(s.parsedValue[0].toDate()):w(s.parsedValue.toDate()):!0:!1),yt=()=>{if(be.value)fe(s.parsedValue);else{let Je=s.parsedValue;if(!Je){const Ie=on(R).locale(E.value),Ke=sn();Je=Ie.year(Ke.year()).month(Ke.month()).date(Ke.date())}V.value=Je,fe(Je)}},it=U(()=>w?w(on().locale(E.value).toDate()):!1),ce=()=>{const Ie=on().locale(E.value).toDate();L.value=!0,(!w||!w(Ie))&&te(Ie)&&(V.value=on().locale(E.value),fe(V.value))},Se=U(()=>s.timeFormat||aG(s.format)),je=U(()=>s.dateFormat||iG(s.format)),tt=U(()=>{if(Y.value)return Y.value;if(!(!s.parsedValue&&!N.value))return(s.parsedValue||V.value).format(Se.value)}),et=U(()=>{if(G.value)return G.value;if(!(!s.parsedValue&&!N.value))return(s.parsedValue||V.value).format(je.value)}),Ge=ee(!1),Xe=()=>{Ge.value=!0},Ye=()=>{Ge.value=!1},ct=Je=>({hour:Je.hour(),minute:Je.minute(),second:Je.second(),year:Je.year(),month:Je.month(),date:Je.date()}),nt=(Je,Ie,Ke)=>{const{hour:Te,minute:vt,second:an}=ct(Je),en=s.parsedValue?s.parsedValue.hour(Te).minute(vt).second(an):Je;V.value=en,fe(V.value,!0),Ke||(Ge.value=Ie)},Ot=Je=>{const Ie=on(Je,Se.value).locale(E.value);if(Ie.isValid()&&te(Ie)){const{year:Ke,month:Te,date:vt}=ct(V.value);V.value=Ie.year(Ke).month(Te).date(vt),Y.value=null,Ge.value=!1,fe(V.value,!0)}},_t=Je=>{const Ie=Qp(Je,je.value,E.value);if(Ie.isValid()){if(w&&w(Ie.toDate()))return;const{hour:Ke,minute:Te,second:vt}=ct(V.value);V.value=Ie.hour(Ke).minute(Te).second(vt),G.value=null,fe(V.value,!0)}},qe=Je=>on.isDayjs(Je)&&Je.isValid()&&(w?!w(Je.toDate()):!0),wt=Je=>st(Je)?Je.map(Ie=>Ie.format(s.format)):Je.format(s.format),qt=Je=>Qp(Je,s.format,E.value),sn=()=>{const Je=on(N.value).locale(E.value);if(!N.value){const Ie=M.value;return on().hour(Ie.hour()).minute(Ie.minute()).second(Ie.second()).locale(E.value)}return Je},tn=()=>{var Je;["week","month","year","date"].includes(pe.value)&&((Je=O.value)==null||Je.focus())},Kn=()=>{tn(),pe.value==="week"&&zr(Ct.down)},Sn=Je=>{const{code:Ie}=Je;[Ct.up,Ct.down,Ct.left,Ct.right,Ct.home,Ct.end,Ct.pageUp,Ct.pageDown].includes(Ie)&&(zr(Ie),Je.stopPropagation(),Je.preventDefault()),[Ct.enter,Ct.space,Ct.numpadEnter].includes(Ie)&&G.value===null&&Y.value===null&&(Je.preventDefault(),fe(V.value,!1))},zr=Je=>{var Ie;const{up:Ke,down:Te,left:vt,right:an,home:en,end:Ir,pageUp:yi,pageDown:No}=Ct,Wo={year:{[Ke]:-4,[Te]:4,[vt]:-1,[an]:1,offset:(_r,ws)=>_r.setFullYear(_r.getFullYear()+ws)},month:{[Ke]:-4,[Te]:4,[vt]:-1,[an]:1,offset:(_r,ws)=>_r.setMonth(_r.getMonth()+ws)},week:{[Ke]:-1,[Te]:1,[vt]:-1,[an]:1,offset:(_r,ws)=>_r.setDate(_r.getDate()+ws*7)},date:{[Ke]:-7,[Te]:7,[vt]:-1,[an]:1,[en]:_r=>-_r.getDay(),[Ir]:_r=>-_r.getDay()+6,[yi]:_r=>-new Date(_r.getFullYear(),_r.getMonth(),0).getDate(),[No]:_r=>new Date(_r.getFullYear(),_r.getMonth()+1,0).getDate(),offset:(_r,ws)=>_r.setDate(_r.getDate()+ws)}},$r=V.value.toDate();for(;Math.abs(V.value.diff($r,"year",!0))<1;){const _r=Wo[Ae.value];if(!_r)return;if(_r.offset($r,Ft(_r[Je])?_r[Je]($r):(Ie=_r[Je])!=null?Ie:0),w&&w($r))break;const ws=on($r).locale(E.value);V.value=ws,o("pick",ws,!0);break}},Wt=Je=>{o("panel-change",V.value.toDate(),Je,ie.value)};return ze(()=>pe.value,Je=>{if(["month","year"].includes(Je)){ie.value=Je;return}else if(Je==="years"){ie.value="year";return}else if(Je==="months"){ie.value="month";return}ie.value="date"},{immediate:!0}),ze(()=>ie.value,()=>{S==null||S.updatePopper()}),ze(()=>N.value,Je=>{Je&&(V.value=sn())},{immediate:!0}),ze(()=>s.parsedValue,Je=>{if(Je){if(be.value||st(Je))return;V.value=Je}else V.value=sn()},{immediate:!0}),o("set-picker-option",["isValidValue",qe]),o("set-picker-option",["formatToString",wt]),o("set-picker-option",["parseUserInput",qt]),o("set-picker-option",["handleFocusPicker",Kn]),(Je,Ie)=>($(),le("div",{class:K([p(l).b(),p(d).b(),{"has-sidebar":Je.$slots.sidebar||p(_e),"has-time":p(Pe)}])},[ue("div",{class:K(p(l).e("body-wrapper"))},[Ne(Je.$slots,"sidebar",{class:K(p(l).e("sidebar"))}),p(_e)?($(),le("div",{key:0,class:K(p(l).e("sidebar"))},[($(!0),le(Ut,null,Cn(p(C),(Ke,Te)=>($(),le("button",{key:Te,type:"button",class:K(p(l).e("shortcut")),onClick:vt=>J(Ke)},ot(Ke.text),11,["onClick"]))),128))],2)):De("v-if",!0),ue("div",{class:K(p(l).e("body"))},[p(Pe)?($(),le("div",{key:0,class:K(p(d).e("time-header"))},[ue("span",{class:K(p(d).e("editor-wrap"))},[ge(p(ei),{placeholder:p(g)("el.datepicker.selectDate"),"model-value":p(et),size:"small","validate-event":!1,onInput:Ke=>G.value=Ke,onChange:_t},null,8,["placeholder","model-value","onInput"])],2),ln(($(),le("span",{class:K(p(d).e("editor-wrap"))},[ge(p(ei),{placeholder:p(g)("el.datepicker.selectTime"),"model-value":p(tt),size:"small","validate-event":!1,onFocus:Xe,onInput:Ke=>Y.value=Ke,onChange:Ot},null,8,["placeholder","model-value","onInput"]),ge(p(IS),{visible:Ge.value,format:p(Se),"parsed-value":V.value,onPick:nt},null,8,["visible","format","parsed-value"])],2)),[[p(ru),Ye]])],2)):De("v-if",!0),ln(ue("div",{class:K([p(d).e("header"),(ie.value==="year"||ie.value==="month")&&p(d).e("header--bordered")])},[ue("span",{class:K(p(d).e("prev-btn"))},[ue("button",{type:"button","aria-label":p(g)("el.datepicker.prevYear"),class:K(["d-arrow-left",p(l).e("icon-btn")]),onClick:Ke=>X(!1)},[Ne(Je.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["aria-label","onClick"]),ln(ue("button",{type:"button","aria-label":p(g)("el.datepicker.prevMonth"),class:K([p(l).e("icon-btn"),"arrow-left"]),onClick:Ke=>ae(!1)},[Ne(Je.$slots,"prev-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1})])],10,["aria-label","onClick"]),[[Wn,ie.value==="date"]])],2),ue("span",{role:"button",class:K(p(d).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:Cr(Ke=>Le("year"),["enter"]),onClick:Ke=>Le("year")},ot(p(se)),43,["onKeydown","onClick"]),ln(ue("span",{role:"button","aria-live":"polite",tabindex:"0",class:K([p(d).e("header-label"),{active:ie.value==="month"}]),onKeydown:Cr(Ke=>Le("month"),["enter"]),onClick:Ke=>Le("month")},ot(p(g)(`el.datepicker.month${p(F)+1}`)),43,["onKeydown","onClick"]),[[Wn,ie.value==="date"]]),ue("span",{class:K(p(d).e("next-btn"))},[ln(ue("button",{type:"button","aria-label":p(g)("el.datepicker.nextMonth"),class:K([p(l).e("icon-btn"),"arrow-right"]),onClick:Ke=>ae(!0)},[Ne(Je.$slots,"next-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})])],10,["aria-label","onClick"]),[[Wn,ie.value==="date"]]),ue("button",{type:"button","aria-label":p(g)("el.datepicker.nextYear"),class:K([p(l).e("icon-btn"),"d-arrow-right"]),onClick:Ke=>X(!0)},[Ne(Je.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[Wn,ie.value!=="time"]]),ue("div",{class:K(p(l).e("content")),onKeydown:Sn},[ie.value==="date"?($(),Ve(lO,{key:0,ref_key:"currentViewRef",ref:O,"selection-mode":p(pe),date:V.value,"parsed-value":Je.parsedValue,"disabled-date":p(w),"cell-class-name":p(I),onPick:Ee},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):De("v-if",!0),ie.value==="year"?($(),Ve(dO,{key:1,ref_key:"currentViewRef",ref:O,"selection-mode":p(pe),date:V.value,"disabled-date":p(w),"parsed-value":Je.parsedValue,onPick:Fe},null,8,["selection-mode","date","disabled-date","parsed-value"])):De("v-if",!0),ie.value==="month"?($(),Ve(uO,{key:2,ref_key:"currentViewRef",ref:O,"selection-mode":p(pe),date:V.value,"parsed-value":Je.parsedValue,"disabled-date":p(w),onPick:Me},null,8,["selection-mode","date","parsed-value","disabled-date"])):De("v-if",!0)],34)],2)],2),ln(ue("div",{class:K(p(l).e("footer"))},[ln(ge(p(ls),{text:"",size:"small",class:K(p(l).e("link-btn")),disabled:p(it),onClick:ce},{default:Ce(()=>[bn(ot(p(g)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[Wn,!p(be)&&Je.showNow]]),ge(p(ls),{plain:"",size:"small",class:K(p(l).e("link-btn")),disabled:p(We),onClick:yt},{default:Ce(()=>[bn(ot(p(g)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[Wn,p(He)]])],2))}});var sAe=dt(oAe,[["__file","panel-date-pick.vue"]]);const iAe=ut({...qG,...Ek,visible:Boolean}),XG=t=>{const{emit:o}=mn(),s=au(),a=Jo();return d=>{const h=Ft(d.value)?d.value():d.value;if(h){o("pick",[on(h[0]).locale(t.value),on(h[1]).locale(t.value)]);return}d.onClick&&d.onClick({attrs:s,slots:a,emit:o})}},JG=(t,{defaultValue:o,leftDate:s,rightDate:a,unit:l,onParsedValueChanged:d})=>{const{emit:h}=mn(),{pickerNs:v}=It(T0),g=Qe("date-range-picker"),{t:E,lang:b}=Fn(),S=XG(b),C=ee(),w=ee(),I=ee({endDate:null,selecting:!1}),R=D=>{I.value=D},N=(D=!1)=>{const M=p(C),F=p(w);Zp([M,F])&&h("pick",[M,F],D)},O=D=>{I.value.selecting=D,D||(I.value.endDate=null)},V=D=>{if(st(D)&&D.length===2){const[M,F]=D;C.value=M,s.value=M,w.value=F,d(p(C),p(w))}else L()},L=()=>{const[D,M]=bk(p(o),{lang:p(b),unit:l,unlinkPanels:t.unlinkPanels});C.value=void 0,w.value=void 0,s.value=D,a.value=M};return ze(o,D=>{D&&L()},{immediate:!0}),ze(()=>t.parsedValue,V,{immediate:!0}),{minDate:C,maxDate:w,rangeState:I,lang:b,ppNs:v,drpNs:g,handleChangeRange:R,handleRangeConfirm:N,handleShortcutClick:S,onSelect:O,onReset:V,t:E}},kb="month",aAe=me({__name:"panel-date-range",props:iAe,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(t,{emit:o}){const s=t,a=It("EP_PICKER_BASE"),{disabledDate:l,cellClassName:d,defaultTime:h,clearable:v}=a.props,g=lr(a.props,"format"),E=lr(a.props,"shortcuts"),b=lr(a.props,"defaultValue"),{lang:S}=Fn(),C=ee(on().locale(S.value)),w=ee(on().locale(S.value).add(1,kb)),{minDate:I,maxDate:R,rangeState:N,ppNs:O,drpNs:V,handleChangeRange:L,handleRangeConfirm:D,handleShortcutClick:M,onSelect:F,onReset:W,t:z}=JG(s,{defaultValue:b,leftDate:C,rightDate:w,unit:kb,onParsedValueChanged:Je});ze(()=>s.visible,Ie=>{!Ie&&N.value.selecting&&(W(s.parsedValue),F(!1))});const G=ee({min:null,max:null}),Y=ee({min:null,max:null}),te=U(()=>`${C.value.year()} ${z("el.datepicker.year")} ${z(`el.datepicker.month${C.value.month()+1}`)}`),Z=U(()=>`${w.value.year()} ${z("el.datepicker.year")} ${z(`el.datepicker.month${w.value.month()+1}`)}`),fe=U(()=>C.value.year()),Ee=U(()=>C.value.month()),ae=U(()=>w.value.year()),X=U(()=>w.value.month()),ie=U(()=>!!E.value.length),se=U(()=>G.value.min!==null?G.value.min:I.value?I.value.format(_e.value):""),J=U(()=>G.value.max!==null?G.value.max:R.value||I.value?(R.value||I.value).format(_e.value):""),pe=U(()=>Y.value.min!==null?Y.value.min:I.value?I.value.format(Ae.value):""),be=U(()=>Y.value.max!==null?Y.value.max:R.value||I.value?(R.value||I.value).format(Ae.value):""),Ae=U(()=>s.timeFormat||aG(g.value)),_e=U(()=>s.dateFormat||iG(g.value)),Me=Ie=>Zp(Ie)&&(l?!l(Ie[0].toDate())&&!l(Ie[1].toDate()):!0),Fe=()=>{C.value=C.value.subtract(1,"year"),s.unlinkPanels||(w.value=C.value.add(1,"month")),Se("year")},Le=()=>{C.value=C.value.subtract(1,"month"),s.unlinkPanels||(w.value=C.value.add(1,"month")),Se("month")},Pe=()=>{s.unlinkPanels?w.value=w.value.add(1,"year"):(C.value=C.value.add(1,"year"),w.value=C.value.add(1,"month")),Se("year")},He=()=>{s.unlinkPanels?w.value=w.value.add(1,"month"):(C.value=C.value.add(1,"month"),w.value=C.value.add(1,"month")),Se("month")},We=()=>{C.value=C.value.add(1,"year"),Se("year")},yt=()=>{C.value=C.value.add(1,"month"),Se("month")},it=()=>{w.value=w.value.subtract(1,"year"),Se("year")},ce=()=>{w.value=w.value.subtract(1,"month"),Se("month")},Se=Ie=>{o("panel-change",[C.value.toDate(),w.value.toDate()],Ie)},je=U(()=>{const Ie=(Ee.value+1)%12,Ke=Ee.value+1>=12?1:0;return s.unlinkPanels&&new Date(fe.value+Ke,Ie)<new Date(ae.value,X.value)}),tt=U(()=>s.unlinkPanels&&ae.value*12+X.value-(fe.value*12+Ee.value+1)>=12),et=U(()=>!(I.value&&R.value&&!N.value.selecting&&Zp([I.value,R.value]))),Ge=U(()=>s.type==="datetime"||s.type==="datetimerange"),Xe=(Ie,Ke)=>{if(Ie)return h?on(h[Ke]||h).locale(S.value).year(Ie.year()).month(Ie.month()).date(Ie.date()):Ie},Ye=(Ie,Ke=!0)=>{const Te=Ie.minDate,vt=Ie.maxDate,an=Xe(Te,0),en=Xe(vt,1);R.value===en&&I.value===an||(o("calendar-change",[Te.toDate(),vt&&vt.toDate()]),R.value=en,I.value=an,!(!Ke||Ge.value)&&D())},ct=ee(!1),nt=ee(!1),Ot=()=>{ct.value=!1},_t=()=>{nt.value=!1},qe=(Ie,Ke)=>{G.value[Ke]=Ie;const Te=on(Ie,_e.value).locale(S.value);if(Te.isValid()){if(l&&l(Te.toDate()))return;Ke==="min"?(C.value=Te,I.value=(I.value||C.value).year(Te.year()).month(Te.month()).date(Te.date()),!s.unlinkPanels&&(!R.value||R.value.isBefore(I.value))&&(w.value=Te.add(1,"month"),R.value=I.value.add(1,"month"))):(w.value=Te,R.value=(R.value||w.value).year(Te.year()).month(Te.month()).date(Te.date()),!s.unlinkPanels&&(!I.value||I.value.isAfter(R.value))&&(C.value=Te.subtract(1,"month"),I.value=R.value.subtract(1,"month")))}},wt=(Ie,Ke)=>{G.value[Ke]=null},qt=(Ie,Ke)=>{Y.value[Ke]=Ie;const Te=on(Ie,Ae.value).locale(S.value);Te.isValid()&&(Ke==="min"?(ct.value=!0,I.value=(I.value||C.value).hour(Te.hour()).minute(Te.minute()).second(Te.second())):(nt.value=!0,R.value=(R.value||w.value).hour(Te.hour()).minute(Te.minute()).second(Te.second()),w.value=R.value))},sn=(Ie,Ke)=>{Y.value[Ke]=null,Ke==="min"?(C.value=I.value,ct.value=!1,(!R.value||R.value.isBefore(I.value))&&(R.value=I.value)):(w.value=R.value,nt.value=!1,R.value&&R.value.isBefore(I.value)&&(I.value=R.value))},tn=(Ie,Ke,Te)=>{Y.value.min||(Ie&&(C.value=Ie,I.value=(I.value||C.value).hour(Ie.hour()).minute(Ie.minute()).second(Ie.second())),Te||(ct.value=Ke),(!R.value||R.value.isBefore(I.value))&&(R.value=I.value,w.value=Ie))},Kn=(Ie,Ke,Te)=>{Y.value.max||(Ie&&(w.value=Ie,R.value=(R.value||w.value).hour(Ie.hour()).minute(Ie.minute()).second(Ie.second())),Te||(nt.value=Ke),R.value&&R.value.isBefore(I.value)&&(I.value=R.value))},Sn=()=>{C.value=bk(p(b),{lang:p(S),unit:"month",unlinkPanels:s.unlinkPanels})[0],w.value=C.value.add(1,"month"),R.value=void 0,I.value=void 0,o("pick",null)},zr=Ie=>st(Ie)?Ie.map(Ke=>Ke.format(g.value)):Ie.format(g.value),Wt=Ie=>Qp(Ie,g.value,S.value);function Je(Ie,Ke){if(s.unlinkPanels&&Ke){const Te=(Ie==null?void 0:Ie.year())||0,vt=(Ie==null?void 0:Ie.month())||0,an=Ke.year(),en=Ke.month();w.value=Te===an&&vt===en?Ke.add(1,kb):Ke}else w.value=C.value.add(1,kb),Ke&&(w.value=w.value.hour(Ke.hour()).minute(Ke.minute()).second(Ke.second()))}return o("set-picker-option",["isValidValue",Me]),o("set-picker-option",["parseUserInput",Wt]),o("set-picker-option",["formatToString",zr]),o("set-picker-option",["handleClear",Sn]),(Ie,Ke)=>($(),le("div",{class:K([p(O).b(),p(V).b(),{"has-sidebar":Ie.$slots.sidebar||p(ie),"has-time":p(Ge)}])},[ue("div",{class:K(p(O).e("body-wrapper"))},[Ne(Ie.$slots,"sidebar",{class:K(p(O).e("sidebar"))}),p(ie)?($(),le("div",{key:0,class:K(p(O).e("sidebar"))},[($(!0),le(Ut,null,Cn(p(E),(Te,vt)=>($(),le("button",{key:vt,type:"button",class:K(p(O).e("shortcut")),onClick:an=>p(M)(Te)},ot(Te.text),11,["onClick"]))),128))],2)):De("v-if",!0),ue("div",{class:K(p(O).e("body"))},[p(Ge)?($(),le("div",{key:0,class:K(p(V).e("time-header"))},[ue("span",{class:K(p(V).e("editors-wrap"))},[ue("span",{class:K(p(V).e("time-picker-wrap"))},[ge(p(ei),{size:"small",disabled:p(N).selecting,placeholder:p(z)("el.datepicker.startDate"),class:K(p(V).e("editor")),"model-value":p(se),"validate-event":!1,onInput:Te=>qe(Te,"min"),onChange:Te=>wt(Te,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),ln(($(),le("span",{class:K(p(V).e("time-picker-wrap"))},[ge(p(ei),{size:"small",class:K(p(V).e("editor")),disabled:p(N).selecting,placeholder:p(z)("el.datepicker.startTime"),"model-value":p(pe),"validate-event":!1,onFocus:Te=>ct.value=!0,onInput:Te=>qt(Te,"min"),onChange:Te=>sn(Te,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),ge(p(IS),{visible:ct.value,format:p(Ae),"datetime-role":"start","parsed-value":C.value,onPick:tn},null,8,["visible","format","parsed-value"])],2)),[[p(ru),Ot]])],2),ue("span",null,[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})]),ue("span",{class:K([p(V).e("editors-wrap"),"is-right"])},[ue("span",{class:K(p(V).e("time-picker-wrap"))},[ge(p(ei),{size:"small",class:K(p(V).e("editor")),disabled:p(N).selecting,placeholder:p(z)("el.datepicker.endDate"),"model-value":p(J),readonly:!p(I),"validate-event":!1,onInput:Te=>qe(Te,"max"),onChange:Te=>wt(Te,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),ln(($(),le("span",{class:K(p(V).e("time-picker-wrap"))},[ge(p(ei),{size:"small",class:K(p(V).e("editor")),disabled:p(N).selecting,placeholder:p(z)("el.datepicker.endTime"),"model-value":p(be),readonly:!p(I),"validate-event":!1,onFocus:Te=>p(I)&&(nt.value=!0),onInput:Te=>qt(Te,"max"),onChange:Te=>sn(Te,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),ge(p(IS),{"datetime-role":"end",visible:nt.value,format:p(Ae),"parsed-value":w.value,onPick:Kn},null,8,["visible","format","parsed-value"])],2)),[[p(ru),_t]])],2)],2)):De("v-if",!0),ue("div",{class:K([[p(O).e("content"),p(V).e("content")],"is-left"])},[ue("div",{class:K(p(V).e("header"))},[ue("button",{type:"button",class:K([p(O).e("icon-btn"),"d-arrow-left"]),"aria-label":p(z)("el.datepicker.prevYear"),onClick:Fe},[Ne(Ie.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["aria-label"]),ue("button",{type:"button",class:K([p(O).e("icon-btn"),"arrow-left"]),"aria-label":p(z)("el.datepicker.prevMonth"),onClick:Le},[Ne(Ie.$slots,"prev-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1})])],10,["aria-label"]),Ie.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(tt),class:K([[p(O).e("icon-btn"),{"is-disabled":!p(tt)}],"d-arrow-right"]),"aria-label":p(z)("el.datepicker.nextYear"),onClick:We},[Ne(Ie.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["disabled","aria-label"])):De("v-if",!0),Ie.unlinkPanels?($(),le("button",{key:1,type:"button",disabled:!p(je),class:K([[p(O).e("icon-btn"),{"is-disabled":!p(je)}],"arrow-right"]),"aria-label":p(z)("el.datepicker.nextMonth"),onClick:yt},[Ne(Ie.$slots,"next-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})])],10,["disabled","aria-label"])):De("v-if",!0),ue("div",null,ot(p(te)),1)],2),ge(lO,{"selection-mode":"range",date:C.value,"min-date":p(I),"max-date":p(R),"range-state":p(N),"disabled-date":p(l),"cell-class-name":p(d),onChangerange:p(L),onPick:Ye,onSelect:p(F)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),ue("div",{class:K([[p(O).e("content"),p(V).e("content")],"is-right"])},[ue("div",{class:K(p(V).e("header"))},[Ie.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(tt),class:K([[p(O).e("icon-btn"),{"is-disabled":!p(tt)}],"d-arrow-left"]),"aria-label":p(z)("el.datepicker.prevYear"),onClick:it},[Ne(Ie.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["disabled","aria-label"])):De("v-if",!0),Ie.unlinkPanels?($(),le("button",{key:1,type:"button",disabled:!p(je),class:K([[p(O).e("icon-btn"),{"is-disabled":!p(je)}],"arrow-left"]),"aria-label":p(z)("el.datepicker.prevMonth"),onClick:ce},[Ne(Ie.$slots,"prev-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1})])],10,["disabled","aria-label"])):De("v-if",!0),ue("button",{type:"button","aria-label":p(z)("el.datepicker.nextYear"),class:K([p(O).e("icon-btn"),"d-arrow-right"]),onClick:Pe},[Ne(Ie.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["aria-label"]),ue("button",{type:"button",class:K([p(O).e("icon-btn"),"arrow-right"]),"aria-label":p(z)("el.datepicker.nextMonth"),onClick:He},[Ne(Ie.$slots,"next-month",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})])],10,["aria-label"]),ue("div",null,ot(p(Z)),1)],2),ge(lO,{"selection-mode":"range",date:w.value,"min-date":p(I),"max-date":p(R),"range-state":p(N),"disabled-date":p(l),"cell-class-name":p(d),onChangerange:p(L),onPick:Ye,onSelect:p(F)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),p(Ge)?($(),le("div",{key:0,class:K(p(O).e("footer"))},[p(v)?($(),Ve(p(ls),{key:0,text:"",size:"small",class:K(p(O).e("link-btn")),onClick:Sn},{default:Ce(()=>[bn(ot(p(z)("el.datepicker.clear")),1)]),_:1},8,["class"])):De("v-if",!0),ge(p(ls),{plain:"",size:"small",class:K(p(O).e("link-btn")),disabled:p(et),onClick:Te=>p(D)(!1)},{default:Ce(()=>[bn(ot(p(z)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):De("v-if",!0)],2))}});var cAe=dt(aAe,[["__file","panel-date-range.vue"]]);const lAe=ut({...Ek}),uAe=["pick","set-picker-option","calendar-change"],dAe=({unlinkPanels:t,leftDate:o,rightDate:s})=>{const{t:a}=Fn(),l=()=>{o.value=o.value.subtract(1,"year"),t.value||(s.value=s.value.subtract(1,"year"))},d=()=>{t.value||(o.value=o.value.add(1,"year")),s.value=s.value.add(1,"year")},h=()=>{o.value=o.value.add(1,"year")},v=()=>{s.value=s.value.subtract(1,"year")},g=U(()=>`${o.value.year()} ${a("el.datepicker.year")}`),E=U(()=>`${s.value.year()} ${a("el.datepicker.year")}`),b=U(()=>o.value.year()),S=U(()=>s.value.year()===o.value.year()?o.value.year()+1:s.value.year());return{leftPrevYear:l,rightNextYear:d,leftNextYear:h,rightPrevYear:v,leftLabel:g,rightLabel:E,leftYear:b,rightYear:S}},Pb="year",hAe=me({name:"DatePickerMonthRange"}),fAe=me({...hAe,props:lAe,emits:uAe,setup(t,{emit:o}){const s=t,{lang:a}=Fn(),l=It("EP_PICKER_BASE"),{shortcuts:d,disabledDate:h}=l.props,v=lr(l.props,"format"),g=lr(l.props,"defaultValue"),E=ee(on().locale(a.value)),b=ee(on().locale(a.value).add(1,Pb)),{minDate:S,maxDate:C,rangeState:w,ppNs:I,drpNs:R,handleChangeRange:N,handleRangeConfirm:O,handleShortcutClick:V,onSelect:L}=JG(s,{defaultValue:g,leftDate:E,rightDate:b,unit:Pb,onParsedValueChanged:se}),D=U(()=>!!d.length),{leftPrevYear:M,rightNextYear:F,leftNextYear:W,rightPrevYear:z,leftLabel:G,rightLabel:Y,leftYear:te,rightYear:Z}=dAe({unlinkPanels:lr(s,"unlinkPanels"),leftDate:E,rightDate:b}),fe=U(()=>s.unlinkPanels&&Z.value>te.value+1),Ee=(J,pe=!0)=>{const be=J.minDate,Ae=J.maxDate;C.value===Ae&&S.value===be||(o("calendar-change",[be.toDate(),Ae&&Ae.toDate()]),C.value=Ae,S.value=be,pe&&O())},ae=()=>{E.value=bk(p(g),{lang:p(a),unit:"year",unlinkPanels:s.unlinkPanels})[0],b.value=E.value.add(1,"year"),o("pick",null)},X=J=>st(J)?J.map(pe=>pe.format(v.value)):J.format(v.value),ie=J=>Qp(J,v.value,a.value);function se(J,pe){if(s.unlinkPanels&&pe){const be=(J==null?void 0:J.year())||0,Ae=pe.year();b.value=be===Ae?pe.add(1,Pb):pe}else b.value=E.value.add(1,Pb)}return o("set-picker-option",["isValidValue",Zp]),o("set-picker-option",["formatToString",X]),o("set-picker-option",["parseUserInput",ie]),o("set-picker-option",["handleClear",ae]),(J,pe)=>($(),le("div",{class:K([p(I).b(),p(R).b(),{"has-sidebar":!!J.$slots.sidebar||p(D)}])},[ue("div",{class:K(p(I).e("body-wrapper"))},[Ne(J.$slots,"sidebar",{class:K(p(I).e("sidebar"))}),p(D)?($(),le("div",{key:0,class:K(p(I).e("sidebar"))},[($(!0),le(Ut,null,Cn(p(d),(be,Ae)=>($(),le("button",{key:Ae,type:"button",class:K(p(I).e("shortcut")),onClick:_e=>p(V)(be)},ot(be.text),11,["onClick"]))),128))],2)):De("v-if",!0),ue("div",{class:K(p(I).e("body"))},[ue("div",{class:K([[p(I).e("content"),p(R).e("content")],"is-left"])},[ue("div",{class:K(p(R).e("header"))},[ue("button",{type:"button",class:K([p(I).e("icon-btn"),"d-arrow-left"]),onClick:p(M)},[Ne(J.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["onClick"]),J.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(fe),class:K([[p(I).e("icon-btn"),{[p(I).is("disabled")]:!p(fe)}],"d-arrow-right"]),onClick:p(W)},[Ne(J.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["disabled","onClick"])):De("v-if",!0),ue("div",null,ot(p(G)),1)],2),ge(uO,{"selection-mode":"range",date:E.value,"min-date":p(S),"max-date":p(C),"range-state":p(w),"disabled-date":p(h),onChangerange:p(N),onPick:Ee,onSelect:p(L)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),ue("div",{class:K([[p(I).e("content"),p(R).e("content")],"is-right"])},[ue("div",{class:K(p(R).e("header"))},[J.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(fe),class:K([[p(I).e("icon-btn"),{"is-disabled":!p(fe)}],"d-arrow-left"]),onClick:p(z)},[Ne(J.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["disabled","onClick"])):De("v-if",!0),ue("button",{type:"button",class:K([p(I).e("icon-btn"),"d-arrow-right"]),onClick:p(F)},[Ne(J.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["onClick"]),ue("div",null,ot(p(Y)),1)],2),ge(uO,{"selection-mode":"range",date:b.value,"min-date":p(S),"max-date":p(C),"range-state":p(w),"disabled-date":p(h),onChangerange:p(N),onPick:Ee,onSelect:p(L)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var pAe=dt(fAe,[["__file","panel-month-range.vue"]]);const mAe=ut({...Ek}),vAe=["pick","set-picker-option","calendar-change"],gAe=({unlinkPanels:t,leftDate:o,rightDate:s})=>{const a=()=>{o.value=o.value.subtract(10,"year"),t.value||(s.value=s.value.subtract(10,"year"))},l=()=>{t.value||(o.value=o.value.add(10,"year")),s.value=s.value.add(10,"year")},d=()=>{o.value=o.value.add(10,"year")},h=()=>{s.value=s.value.subtract(10,"year")},v=U(()=>{const S=Math.floor(o.value.year()/10)*10;return`${S}-${S+9}`}),g=U(()=>{const S=Math.floor(s.value.year()/10)*10;return`${S}-${S+9}`}),E=U(()=>Math.floor(o.value.year()/10)*10+9),b=U(()=>Math.floor(s.value.year()/10)*10);return{leftPrevYear:a,rightNextYear:l,leftNextYear:d,rightPrevYear:h,leftLabel:v,rightLabel:g,leftYear:E,rightYear:b}},SH="year",_Ae=me({name:"DatePickerYearRange"}),EAe=me({..._Ae,props:mAe,emits:vAe,setup(t,{emit:o}){const s=t,{lang:a}=Fn(),l=ee(on().locale(a.value)),d=ee(l.value.add(10,"year")),{pickerNs:h}=It(T0),v=Qe("date-range-picker"),g=U(()=>!!Ee.length),E=U(()=>[h.b(),v.b(),{"has-sidebar":!!Jo().sidebar||g.value}]),b=U(()=>({content:[h.e("content"),v.e("content"),"is-left"],arrowLeftBtn:[h.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[h.e("icon-btn"),{[h.is("disabled")]:!M.value},"d-arrow-right"]})),S=U(()=>({content:[h.e("content"),v.e("content"),"is-right"],arrowLeftBtn:[h.e("icon-btn"),{"is-disabled":!M.value},"d-arrow-left"],arrowRightBtn:[h.e("icon-btn"),"d-arrow-right"]})),C=XG(a),{leftPrevYear:w,rightNextYear:I,leftNextYear:R,rightPrevYear:N,leftLabel:O,rightLabel:V,leftYear:L,rightYear:D}=gAe({unlinkPanels:lr(s,"unlinkPanels"),leftDate:l,rightDate:d}),M=U(()=>s.unlinkPanels&&D.value>L.value+1),F=ee(),W=ee(),z=ee({endDate:null,selecting:!1}),G=_e=>{z.value=_e},Y=(_e,Me=!0)=>{const Fe=_e.minDate,Le=_e.maxDate;W.value===Le&&F.value===Fe||(o("calendar-change",[Fe.toDate(),Le&&Le.toDate()]),W.value=Le,F.value=Fe,Me&&te())},te=(_e=!1)=>{Zp([F.value,W.value])&&o("pick",[F.value,W.value],_e)},Z=_e=>{z.value.selecting=_e,_e||(z.value.endDate=null)},fe=It("EP_PICKER_BASE"),{shortcuts:Ee,disabledDate:ae}=fe.props,X=lr(fe.props,"format"),ie=lr(fe.props,"defaultValue"),se=()=>{let _e;if(st(ie.value)){const Me=on(ie.value[0]);let Fe=on(ie.value[1]);return s.unlinkPanels||(Fe=Me.add(10,SH)),[Me,Fe]}else ie.value?_e=on(ie.value):_e=on();return _e=_e.locale(a.value),[_e,_e.add(10,SH)]};ze(()=>ie.value,_e=>{if(_e){const Me=se();l.value=Me[0],d.value=Me[1]}},{immediate:!0}),ze(()=>s.parsedValue,_e=>{if(_e&&_e.length===2)if(F.value=_e[0],W.value=_e[1],l.value=F.value,s.unlinkPanels&&W.value){const Me=F.value.year(),Fe=W.value.year();d.value=Me===Fe?W.value.add(10,"year"):W.value}else d.value=l.value.add(10,"year");else{const Me=se();F.value=void 0,W.value=void 0,l.value=Me[0],d.value=Me[1]}},{immediate:!0});const J=_e=>Qp(_e,X.value,a.value),pe=_e=>st(_e)?_e.map(Me=>Me.format(X.value)):_e.format(X.value),be=_e=>Zp(_e)&&(ae?!ae(_e[0].toDate())&&!ae(_e[1].toDate()):!0),Ae=()=>{const _e=se();l.value=_e[0],d.value=_e[1],W.value=void 0,F.value=void 0,o("pick",null)};return o("set-picker-option",["isValidValue",be]),o("set-picker-option",["parseUserInput",J]),o("set-picker-option",["formatToString",pe]),o("set-picker-option",["handleClear",Ae]),(_e,Me)=>($(),le("div",{class:K(p(E))},[ue("div",{class:K(p(h).e("body-wrapper"))},[Ne(_e.$slots,"sidebar",{class:K(p(h).e("sidebar"))}),p(g)?($(),le("div",{key:0,class:K(p(h).e("sidebar"))},[($(!0),le(Ut,null,Cn(p(Ee),(Fe,Le)=>($(),le("button",{key:Le,type:"button",class:K(p(h).e("shortcut")),onClick:Pe=>p(C)(Fe)},ot(Fe.text),11,["onClick"]))),128))],2)):De("v-if",!0),ue("div",{class:K(p(h).e("body"))},[ue("div",{class:K(p(b).content)},[ue("div",{class:K(p(v).e("header"))},[ue("button",{type:"button",class:K(p(b).arrowLeftBtn),onClick:p(w)},[Ne(_e.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["onClick"]),_e.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(M),class:K(p(b).arrowRightBtn),onClick:p(R)},[Ne(_e.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["disabled","onClick"])):De("v-if",!0),ue("div",null,ot(p(O)),1)],2),ge(dO,{"selection-mode":"range",date:l.value,"min-date":F.value,"max-date":W.value,"range-state":z.value,"disabled-date":p(ae),onChangerange:G,onPick:Y,onSelect:Z},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),ue("div",{class:K(p(S).content)},[ue("div",{class:K(p(v).e("header"))},[_e.unlinkPanels?($(),le("button",{key:0,type:"button",disabled:!p(M),class:K(p(S).arrowLeftBtn),onClick:p(N)},[Ne(_e.$slots,"prev-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(dd))]),_:1})])],10,["disabled","onClick"])):De("v-if",!0),ue("button",{type:"button",class:K(p(S).arrowRightBtn),onClick:p(I)},[Ne(_e.$slots,"next-year",{},()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(hd))]),_:1})])],10,["onClick"]),ue("div",null,ot(p(V)),1)],2),ge(dO,{"selection-mode":"range",date:d.value,"min-date":F.value,"max-date":W.value,"range-state":z.value,"disabled-date":p(ae),onChangerange:G,onPick:Y,onSelect:Z},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var yAe=dt(EAe,[["__file","panel-year-range.vue"]]);const bAe=function(t){switch(t){case"daterange":case"datetimerange":return cAe;case"monthrange":return pAe;case"yearrange":return yAe;default:return sAe}};on.extend(lG);on.extend(mIe);on.extend(vk);on.extend(gIe);on.extend(EIe);on.extend(bIe);on.extend(TIe);on.extend(wIe);var SAe=me({name:"ElDatePicker",install:null,props:WIe,emits:[Jt],setup(t,{expose:o,emit:s,slots:a}){const l=Qe("picker-panel");wn("ElPopperOptions",er(lr(t,"popperOptions"))),wn(T0,{slots:a,pickerNs:l});const d=ee();o({focus:()=>{var g;(g=d.value)==null||g.focus()},blur:()=>{var g;(g=d.value)==null||g.blur()},handleOpen:()=>{var g;(g=d.value)==null||g.handleOpen()},handleClose:()=>{var g;(g=d.value)==null||g.handleClose()}});const v=g=>{s(Jt,g)};return()=>{var g;const E=(g=t.format)!=null?g:RIe[t.type]||bp,b=bAe(t.type);return ge(WG,En(t,{format:E,type:t.type,ref:d,"onUpdate:modelValue":v}),{default:S=>ge(b,S,{"prev-month":a["prev-month"],"next-month":a["next-month"],"prev-year":a["prev-year"],"next-year":a["next-year"]}),"range-separator":a["range-separator"]})}}});const TAe=rn(SAe),Tk=Symbol("elDescriptions");var Qv=me({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:It(Tk,{})}},render(){var t;const o=LCe(this.cell),s=(((t=this.cell)==null?void 0:t.dirs)||[]).map(O=>{const{dir:V,arg:L,modifiers:D,value:M}=O;return[V,M,L,D]}),{border:a,direction:l}=this.descriptions,d=l==="vertical",h=()=>{var O,V,L;return((L=(V=(O=this.cell)==null?void 0:O.children)==null?void 0:V.label)==null?void 0:L.call(V))||o.label},v=()=>{var O,V,L;return(L=(V=(O=this.cell)==null?void 0:O.children)==null?void 0:V.default)==null?void 0:L.call(V)},g=o.span,E=o.rowspan,b=o.align?`is-${o.align}`:"",S=o.labelAlign?`is-${o.labelAlign}`:b,C=o.className,w=o.labelClassName,I=this.type==="label"&&(o.labelWidth||this.descriptions.labelWidth)||o.width,R={width:mo(I),minWidth:mo(o.minWidth)},N=Qe("descriptions");switch(this.type){case"label":return ln(Ht(this.tag,{style:R,class:[N.e("cell"),N.e("label"),N.is("bordered-label",a),N.is("vertical-label",d),S,w],colSpan:d?g:1,rowspan:d?1:E},h()),s);case"content":return ln(Ht(this.tag,{style:R,class:[N.e("cell"),N.e("content"),N.is("bordered-content",a),N.is("vertical-content",d),b,C],colSpan:d?g:g*2-1,rowspan:d?E*2-1:E},v()),s);default:{const O=h(),V={},L=mo(o.labelWidth||this.descriptions.labelWidth);return L&&(V.width=L,V.display="inline-block"),ln(Ht("td",{style:R,class:[N.e("cell"),b],colSpan:g,rowspan:E},[Qo(O)?void 0:Ht("span",{style:V,class:[N.e("label"),w]},O),Ht("span",{class:[N.e("content"),C]},v())]),s)}}}});const CAe=ut({row:{type:Re(Array),default:()=>[]}}),wAe=me({name:"ElDescriptionsRow"}),RAe=me({...wAe,props:CAe,setup(t){const o=It(Tk,{});return(s,a)=>p(o).direction==="vertical"?($(),le(Ut,{key:0},[ue("tr",null,[($(!0),le(Ut,null,Cn(s.row,(l,d)=>($(),Ve(p(Qv),{key:`tr1-${d}`,cell:l,tag:"th",type:"label"},null,8,["cell"]))),128))]),ue("tr",null,[($(!0),le(Ut,null,Cn(s.row,(l,d)=>($(),Ve(p(Qv),{key:`tr2-${d}`,cell:l,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):($(),le("tr",{key:1},[($(!0),le(Ut,null,Cn(s.row,(l,d)=>($(),le(Ut,{key:`tr3-${d}`},[p(o).border?($(),le(Ut,{key:0},[ge(p(Qv),{cell:l,tag:"td",type:"label"},null,8,["cell"]),ge(p(Qv),{cell:l,tag:"td",type:"content"},null,8,["cell"])],64)):($(),Ve(p(Qv),{key:1,cell:l,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var IAe=dt(RAe,[["__file","descriptions-row.vue"]]);const AAe=ut({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Ho,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),ZG="ElDescriptionsItem",OAe=me({name:"ElDescriptions"}),NAe=me({...OAe,props:AAe,setup(t){const o=t,s=Qe("descriptions"),a=xo(),l=Jo();wn(Tk,o);const d=U(()=>[s.b(),s.m(a.value)]),h=(g,E,b,S=!1)=>(g.props||(g.props={}),E>b&&(g.props.span=b),S&&(g.props.span=E),g),v=()=>{if(!l.default)return[];const g=Jl(l.default()).filter(I=>{var R;return((R=I==null?void 0:I.type)==null?void 0:R.name)===ZG}),E=[];let b=[],S=o.column,C=0;const w=[];return g.forEach((I,R)=>{var N,O,V;const L=((N=I.props)==null?void 0:N.span)||1,D=((O=I.props)==null?void 0:O.rowspan)||1,M=E.length;if(w[M]||(w[M]=0),D>1)for(let F=1;F<D;F++)w[V=M+F]||(w[V]=0),w[M+F]++,C++;if(w[M]>0&&(S-=w[M],w[M]=0),R<g.length-1&&(C+=L>S?S:L),R===g.length-1){const F=o.column-C%o.column;b.push(h(I,F,S,!0)),E.push(b);return}L<S?(S-=L,b.push(I)):(b.push(h(I,L,S)),E.push(b),S=o.column,b=[])}),E};return(g,E)=>($(),le("div",{class:K(p(d))},[g.title||g.extra||g.$slots.title||g.$slots.extra?($(),le("div",{key:0,class:K(p(s).e("header"))},[ue("div",{class:K(p(s).e("title"))},[Ne(g.$slots,"title",{},()=>[bn(ot(g.title),1)])],2),ue("div",{class:K(p(s).e("extra"))},[Ne(g.$slots,"extra",{},()=>[bn(ot(g.extra),1)])],2)],2)):De("v-if",!0),ue("div",{class:K(p(s).e("body"))},[ue("table",{class:K([p(s).e("table"),p(s).is("bordered",g.border)])},[ue("tbody",null,[($(!0),le(Ut,null,Cn(v(),(b,S)=>($(),Ve(IAe,{key:S,row:b},null,8,["row"]))),128))])],2)],2)],2))}});var kAe=dt(NAe,[["__file","description.vue"]]);const PAe=ut({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),QG=me({name:ZG,props:PAe}),DAe=rn(kAe,{DescriptionsItem:QG}),LAe=uo(QG),Ck=t=>{if(!t)return{onClick:pr,onMousedown:pr,onMouseup:pr};let o=!1,s=!1;return{onClick:h=>{o&&s&&t(h),o=s=!1},onMousedown:h=>{o=h.target===h.currentTarget},onMouseup:h=>{s=h.target===h.currentTarget}}},MAe=ut({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:Re([String,Array,Object])},zIndex:{type:Re([String,Number])}}),xAe={click:t=>t instanceof MouseEvent},UAe="overlay";var VAe=me({name:"ElOverlay",props:MAe,emits:xAe,setup(t,{slots:o,emit:s}){const a=Qe(UAe),l=g=>{s("click",g)},{onClick:d,onMousedown:h,onMouseup:v}=Ck(t.customMaskEvent?void 0:l);return()=>t.mask?ge("div",{class:[a.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:d,onMousedown:h,onMouseup:v},[Ne(o,"default")],Ma.STYLE|Ma.CLASS|Ma.PROPS,["onClick","onMouseup","onMousedown"]):Ht("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Ne(o,"default")])}});const wk=VAe,ez=Symbol("dialogInjectionKey"),tz=ut({center:Boolean,alignCenter:Boolean,closeIcon:{type:yr},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),FAe={close:()=>!0},nz=(t,o,s,a)=>{let l={offsetX:0,offsetY:0};const d=E=>{const b=E.clientX,S=E.clientY,{offsetX:C,offsetY:w}=l,I=t.value.getBoundingClientRect(),R=I.left,N=I.top,O=I.width,V=I.height,L=document.documentElement.clientWidth,D=document.documentElement.clientHeight,M=-R+C,F=-N+w,W=L-R-O+C,z=D-N-V+w,G=te=>{let Z=C+te.clientX-b,fe=w+te.clientY-S;a!=null&&a.value||(Z=Math.min(Math.max(Z,M),W),fe=Math.min(Math.max(fe,F),z)),l={offsetX:Z,offsetY:fe},t.value&&(t.value.style.transform=`translate(${mo(Z)}, ${mo(fe)})`)},Y=()=>{document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",Y)};document.addEventListener("mousemove",G),document.addEventListener("mouseup",Y)},h=()=>{o.value&&t.value&&o.value.addEventListener("mousedown",d)},v=()=>{o.value&&t.value&&o.value.removeEventListener("mousedown",d)},g=()=>{l={offsetX:0,offsetY:0},t.value&&(t.value.style.transform="none")};return dn(()=>{Ms(()=>{s.value?h():v()})}),Rr(()=>{v()}),{resetPosition:g}},C0=(...t)=>o=>{t.forEach(s=>{Ft(s)?s(o):s.value=o})},BAe=me({name:"ElDialogContent"}),jAe=me({...BAe,props:tz,emits:FAe,setup(t,{expose:o}){const s=t,{t:a}=Fn(),{Close:l}=qN,{dialogRef:d,headerRef:h,bodyId:v,ns:g,style:E}=It(ez),{focusTrapRef:b}=It(tk),S=U(()=>[g.b(),g.is("fullscreen",s.fullscreen),g.is("draggable",s.draggable),g.is("align-center",s.alignCenter),{[g.m("center")]:s.center}]),C=C0(b,d),w=U(()=>s.draggable),I=U(()=>s.overflow),{resetPosition:R}=nz(d,h,w,I);return o({resetPosition:R}),(N,O)=>($(),le("div",{ref:p(C),class:K(p(S)),style:jt(p(E)),tabindex:"-1"},[ue("header",{ref_key:"headerRef",ref:h,class:K([p(g).e("header"),N.headerClass,{"show-close":N.showClose}])},[Ne(N.$slots,"header",{},()=>[ue("span",{role:"heading","aria-level":N.ariaLevel,class:K(p(g).e("title"))},ot(N.title),11,["aria-level"])]),N.showClose?($(),le("button",{key:0,"aria-label":p(a)("el.dialog.close"),class:K(p(g).e("headerbtn")),type:"button",onClick:V=>N.$emit("close")},[ge(p(Dt),{class:K(p(g).e("close"))},{default:Ce(()=>[($(),Ve(gn(N.closeIcon||p(l))))]),_:1},8,["class"])],10,["aria-label","onClick"])):De("v-if",!0)],2),ue("div",{id:p(v),class:K([p(g).e("body"),N.bodyClass])},[Ne(N.$slots,"default")],10,["id"]),N.$slots.footer?($(),le("footer",{key:0,class:K([p(g).e("footer"),N.footerClass])},[Ne(N.$slots,"footer")],2)):De("v-if",!0)],6))}});var $Ae=dt(jAe,[["__file","dialog-content.vue"]]);const rz=ut({...tz,appendToBody:Boolean,appendTo:{type:Re([String,Object]),default:"body"},beforeClose:{type:Re(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),oz={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[Jt]:t=>wr(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Rk=(t,o={})=>{xr(t)||qo("[useLockscreen]","You need to pass a ref param to this function");const s=o.ns||Qe("popup"),a=U(()=>s.bm("parent","hidden"));if(!Vn||Fi(document.body,a.value))return;let l=0,d=!1,h="0";const v=()=>{setTimeout(()=>{typeof document>"u"||d&&document&&(document.body.style.width=h,ti(document.body,a.value))},200)};ze(t,g=>{if(!g){v();return}d=!Fi(document.body,a.value),d&&(h=document.body.style.width,Ua(document.body,a.value)),l=pK(s.namespace.value);const E=document.documentElement.clientHeight<document.body.scrollHeight,b=ql(document.body,"overflowY");l>0&&(E||b==="scroll")&&d&&(document.body.style.width=`calc(100% - ${l}px)`)}),H8(()=>v())},sz=(t,o)=>{var s;const l=mn().emit,{nextZIndex:d}=fm();let h="";const v=Ts(),g=Ts(),E=ee(!1),b=ee(!1),S=ee(!1),C=ee((s=t.zIndex)!=null?s:d());let w,I;const R=p0("namespace",pg),N=U(()=>{const ae={},X=`--${R.value}-dialog`;return t.fullscreen||(t.top&&(ae[`${X}-margin-top`]=t.top),t.width&&(ae[`${X}-width`]=mo(t.width))),ae}),O=U(()=>t.alignCenter?{display:"flex"}:{});function V(){l("opened")}function L(){l("closed"),l(Jt,!1),t.destroyOnClose&&(S.value=!1)}function D(){l("close")}function M(){I==null||I(),w==null||w(),t.openDelay&&t.openDelay>0?{stop:w}=Mh(()=>G(),t.openDelay):G()}function F(){w==null||w(),I==null||I(),t.closeDelay&&t.closeDelay>0?{stop:I}=Mh(()=>Y(),t.closeDelay):Y()}function W(){function ae(X){X||(b.value=!0,E.value=!1)}t.beforeClose?t.beforeClose(ae):F()}function z(){t.closeOnClickModal&&W()}function G(){Vn&&(E.value=!0)}function Y(){E.value=!1}function te(){l("openAutoFocus")}function Z(){l("closeAutoFocus")}function fe(ae){var X;((X=ae.detail)==null?void 0:X.focusReason)==="pointer"&&ae.preventDefault()}t.lockScroll&&Rk(E);function Ee(){t.closeOnPressEscape&&W()}return ze(()=>t.modelValue,ae=>{ae?(b.value=!1,M(),S.value=!0,C.value=XW(t.zIndex)?d():C.value++,Vt(()=>{l("open"),o.value&&(o.value.parentElement.scrollTop=0,o.value.parentElement.scrollLeft=0,o.value.scrollTop=0)})):E.value&&F()}),ze(()=>t.fullscreen,ae=>{o.value&&(ae?(h=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=h)}),dn(()=>{t.modelValue&&(E.value=!0,S.value=!0,M())}),{afterEnter:V,afterLeave:L,beforeLeave:D,handleClose:W,onModalClick:z,close:F,doClose:Y,onOpenAutoFocus:te,onCloseAutoFocus:Z,onCloseRequested:Ee,onFocusoutPrevented:fe,titleId:v,bodyId:g,closed:b,style:N,overlayDialogStyle:O,rendered:S,visible:E,zIndex:C}},HAe=me({name:"ElDialog",inheritAttrs:!1}),WAe=me({...HAe,props:rz,emits:oz,setup(t,{expose:o}){const s=t,a=Jo();od({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},U(()=>!!a.title));const l=Qe("dialog"),d=ee(),h=ee(),v=ee(),{visible:g,titleId:E,bodyId:b,style:S,overlayDialogStyle:C,rendered:w,zIndex:I,afterEnter:R,afterLeave:N,beforeLeave:O,handleClose:V,onModalClick:L,onOpenAutoFocus:D,onCloseAutoFocus:M,onCloseRequested:F,onFocusoutPrevented:W}=sz(s,d);wn(ez,{dialogRef:d,headerRef:h,bodyId:b,ns:l,rendered:w,style:S});const z=Ck(L),G=U(()=>s.draggable&&!s.fullscreen);return o({visible:g,dialogContentRef:v,resetPosition:()=>{var te;(te=v.value)==null||te.resetPosition()}}),(te,Z)=>($(),Ve(p(vm),{to:te.appendTo,disabled:te.appendTo!=="body"?!1:!te.appendToBody},{default:Ce(()=>[ge(hs,{name:"dialog-fade",onAfterEnter:p(R),onAfterLeave:p(N),onBeforeLeave:p(O),persisted:""},{default:Ce(()=>[ln(ge(p(wk),{"custom-mask-event":"",mask:te.modal,"overlay-class":te.modalClass,"z-index":p(I)},{default:Ce(()=>[ue("div",{role:"dialog","aria-modal":"true","aria-label":te.title||void 0,"aria-labelledby":te.title?void 0:p(E),"aria-describedby":p(b),class:K(`${p(l).namespace.value}-overlay-dialog`),style:jt(p(C)),onClick:p(z).onClick,onMousedown:p(z).onMousedown,onMouseup:p(z).onMouseup},[ge(p(mm),{loop:"",trapped:p(g),"focus-start-el":"container",onFocusAfterTrapped:p(D),onFocusAfterReleased:p(M),onFocusoutPrevented:p(W),onReleaseRequested:p(F)},{default:Ce(()=>[p(w)?($(),Ve($Ae,En({key:0,ref_key:"dialogContentRef",ref:v},te.$attrs,{center:te.center,"align-center":te.alignCenter,"close-icon":te.closeIcon,draggable:p(G),overflow:te.overflow,fullscreen:te.fullscreen,"header-class":te.headerClass,"body-class":te.bodyClass,"footer-class":te.footerClass,"show-close":te.showClose,title:te.title,"aria-level":te.headerAriaLevel,onClose:p(V)}),fa({header:Ce(()=>[te.$slots.title?Ne(te.$slots,"title",{key:1}):Ne(te.$slots,"header",{key:0,close:p(V),titleId:p(E),titleClass:p(l).e("title")})]),default:Ce(()=>[Ne(te.$slots,"default")]),_:2},[te.$slots.footer?{name:"footer",fn:Ce(()=>[Ne(te.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):De("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[Wn,p(g)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var KAe=dt(WAe,[["__file","dialog.vue"]]);const GAe=rn(KAe),zAe=ut({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Re(String),default:"solid"}}),YAe=me({name:"ElDivider"}),qAe=me({...YAe,props:zAe,setup(t){const o=t,s=Qe("divider"),a=U(()=>s.cssVar({"border-style":o.borderStyle}));return(l,d)=>($(),le("div",{class:K([p(s).b(),p(s).m(l.direction)]),style:jt(p(a)),role:"separator"},[l.$slots.default&&l.direction!=="vertical"?($(),le("div",{key:0,class:K([p(s).e("text"),p(s).is(l.contentPosition)])},[Ne(l.$slots,"default")],2)):De("v-if",!0)],6))}});var XAe=dt(qAe,[["__file","divider.vue"]]);const iz=rn(XAe),JAe=ut({...rz,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),ZAe=oz,QAe=me({name:"ElDrawer",inheritAttrs:!1}),eOe=me({...QAe,props:JAe,emits:ZAe,setup(t,{expose:o}){const s=t,a=Jo();od({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},U(()=>!!a.title));const l=ee(),d=ee(),h=Qe("drawer"),{t:v}=Fn(),{afterEnter:g,afterLeave:E,beforeLeave:b,visible:S,rendered:C,titleId:w,bodyId:I,zIndex:R,onModalClick:N,onOpenAutoFocus:O,onCloseAutoFocus:V,onFocusoutPrevented:L,onCloseRequested:D,handleClose:M}=sz(s,l),F=U(()=>s.direction==="rtl"||s.direction==="ltr"),W=U(()=>mo(s.size));return o({handleClose:M,afterEnter:g,afterLeave:E}),(z,G)=>($(),Ve(p(vm),{to:z.appendTo,disabled:z.appendTo!=="body"?!1:!z.appendToBody},{default:Ce(()=>[ge(hs,{name:p(h).b("fade"),onAfterEnter:p(g),onAfterLeave:p(E),onBeforeLeave:p(b),persisted:""},{default:Ce(()=>[ln(ge(p(wk),{mask:z.modal,"overlay-class":z.modalClass,"z-index":p(R),onClick:p(N)},{default:Ce(()=>[ge(p(mm),{loop:"",trapped:p(S),"focus-trap-el":l.value,"focus-start-el":d.value,onFocusAfterTrapped:p(O),onFocusAfterReleased:p(V),onFocusoutPrevented:p(L),onReleaseRequested:p(D)},{default:Ce(()=>[ue("div",En({ref_key:"drawerRef",ref:l,"aria-modal":"true","aria-label":z.title||void 0,"aria-labelledby":z.title?void 0:p(w),"aria-describedby":p(I)},z.$attrs,{class:[p(h).b(),z.direction,p(S)&&"open"],style:p(F)?"width: "+p(W):"height: "+p(W),role:"dialog",onClick:Gt(()=>{},["stop"])}),[ue("span",{ref_key:"focusStartRef",ref:d,class:K(p(h).e("sr-focus")),tabindex:"-1"},null,2),z.withHeader?($(),le("header",{key:0,class:K([p(h).e("header"),z.headerClass])},[z.$slots.title?Ne(z.$slots,"title",{key:1},()=>[De(" DEPRECATED SLOT ")]):Ne(z.$slots,"header",{key:0,close:p(M),titleId:p(w),titleClass:p(h).e("title")},()=>[z.$slots.title?De("v-if",!0):($(),le("span",{key:0,id:p(w),role:"heading","aria-level":z.headerAriaLevel,class:K(p(h).e("title"))},ot(z.title),11,["id","aria-level"]))]),z.showClose?($(),le("button",{key:2,"aria-label":p(v)("el.drawer.close"),class:K(p(h).e("close-btn")),type:"button",onClick:p(M)},[ge(p(Dt),{class:K(p(h).e("close"))},{default:Ce(()=>[ge(p(Sc))]),_:1},8,["class"])],10,["aria-label","onClick"])):De("v-if",!0)],2)):De("v-if",!0),p(C)?($(),le("div",{key:1,id:p(I),class:K([p(h).e("body"),z.bodyClass])},[Ne(z.$slots,"default")],10,["id"])):De("v-if",!0),z.$slots.footer?($(),le("div",{key:2,class:K([p(h).e("footer"),z.footerClass])},[Ne(z.$slots,"footer")],2)):De("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Wn,p(S)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var tOe=dt(eOe,[["__file","drawer.vue"]]);const nOe=rn(tOe),rOe=me({inheritAttrs:!1});function oOe(t,o,s,a,l,d){return Ne(t.$slots,"default")}var sOe=dt(rOe,[["render",oOe],["__file","collection.vue"]]);const iOe=me({name:"ElCollectionItem",inheritAttrs:!1});function aOe(t,o,s,a,l,d){return Ne(t.$slots,"default")}var cOe=dt(iOe,[["render",aOe],["__file","collection-item.vue"]]);const az="data-el-collection-item",cz=t=>{const o=`El${t}Collection`,s=`${o}Item`,a=Symbol(o),l=Symbol(s),d={...sOe,name:o,setup(){const v=ee(),g=new Map;wn(a,{itemMap:g,getItems:()=>{const b=p(v);if(!b)return[];const S=Array.from(b.querySelectorAll(`[${az}]`));return[...g.values()].sort((w,I)=>S.indexOf(w.ref)-S.indexOf(I.ref))},collectionRef:v})}},h={...cOe,name:s,setup(v,{attrs:g}){const E=ee(),b=It(a,void 0);wn(l,{collectionItemRef:E}),dn(()=>{const S=p(E);S&&b.itemMap.set(S,{ref:S,...g})}),Rr(()=>{const S=p(E);b.itemMap.delete(S)})}};return{COLLECTION_INJECTION_KEY:a,COLLECTION_ITEM_INJECTION_KEY:l,ElCollection:d,ElCollectionItem:h}},lOe=ut({style:{type:Re([String,Array,Object])},currentTabId:{type:Re(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:Re(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:uOe,ElCollectionItem:dOe,COLLECTION_INJECTION_KEY:Ik,COLLECTION_ITEM_INJECTION_KEY:hOe}=cz("RovingFocusGroup"),Ak=Symbol("elRovingFocusGroup"),lz=Symbol("elRovingFocusGroupItem"),fOe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},pOe=(t,o)=>t,mOe=(t,o,s)=>{const a=pOe(t.code);return fOe[a]},vOe=(t,o)=>t.map((s,a)=>t[(a+o)%t.length]),Ok=t=>{const{activeElement:o}=document;for(const s of t)if(s===o||(s.focus(),o!==document.activeElement))return},TH="currentTabIdChange",CH="rovingFocusGroup.entryFocus",gOe={bubbles:!1,cancelable:!0},_Oe=me({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:lOe,emits:[TH,"entryFocus"],setup(t,{emit:o}){var s;const a=ee((s=t.currentTabId||t.defaultCurrentTabId)!=null?s:null),l=ee(!1),d=ee(!1),h=ee(),{getItems:v}=It(Ik,void 0),g=U(()=>[{outline:"none"},t.style]),E=R=>{o(TH,R)},b=()=>{l.value=!0},S=Eo(R=>{var N;(N=t.onMousedown)==null||N.call(t,R)},()=>{d.value=!0}),C=Eo(R=>{var N;(N=t.onFocus)==null||N.call(t,R)},R=>{const N=!p(d),{target:O,currentTarget:V}=R;if(O===V&&N&&!p(l)){const L=new Event(CH,gOe);if(V==null||V.dispatchEvent(L),!L.defaultPrevented){const D=v().filter(G=>G.focusable),M=D.find(G=>G.active),F=D.find(G=>G.id===p(a)),z=[M,F,...D].filter(Boolean).map(G=>G.ref);Ok(z)}}d.value=!1}),w=Eo(R=>{var N;(N=t.onBlur)==null||N.call(t,R)},()=>{l.value=!1}),I=(...R)=>{o("entryFocus",...R)};wn(Ak,{currentTabbedId:am(a),loop:lr(t,"loop"),tabIndex:U(()=>p(l)?-1:0),rovingFocusGroupRef:h,rovingFocusGroupRootStyle:g,orientation:lr(t,"orientation"),dir:lr(t,"dir"),onItemFocus:E,onItemShiftTab:b,onBlur:w,onFocus:C,onMousedown:S}),ze(()=>t.currentTabId,R=>{a.value=R??null}),gr(h,CH,I)}});function EOe(t,o,s,a,l,d){return Ne(t.$slots,"default")}var yOe=dt(_Oe,[["render",EOe],["__file","roving-focus-group-impl.vue"]]);const bOe=me({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:uOe,ElRovingFocusGroupImpl:yOe}});function SOe(t,o,s,a,l,d){const h=_n("el-roving-focus-group-impl"),v=_n("el-focus-group-collection");return $(),Ve(v,null,{default:Ce(()=>[ge(h,sa(ul(t.$attrs)),{default:Ce(()=>[Ne(t.$slots,"default")]),_:3},16)]),_:3})}var TOe=dt(bOe,[["render",SOe],["__file","roving-focus-group.vue"]]);const zb=ut({trigger:Fg.trigger,triggerKeys:{type:Re(Array),default:()=>[Ct.enter,Ct.numpadEnter,Ct.space,Ct.down]},effect:{...ss.effect,default:"light"},type:{type:Re(String)},placement:{type:Re(String),default:"bottom"},popperOptions:{type:Re(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:Re([Number,String]),default:0},maxHeight:{type:Re([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,values:wK,default:"menu"},buttonProps:{type:Re(Object)},teleported:ss.teleported,persistent:{type:Boolean,default:!0}}),uz=ut({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:yr}}),COe=ut({onKeydown:{type:Re(Function)}}),wOe=[Ct.down,Ct.pageDown,Ct.home],dz=[Ct.up,Ct.pageUp,Ct.end],ROe=[...wOe,...dz],{ElCollection:IOe,ElCollectionItem:AOe,COLLECTION_INJECTION_KEY:OOe,COLLECTION_ITEM_INJECTION_KEY:NOe}=cz("Dropdown"),w0=Symbol("elDropdown"),{ButtonGroup:kOe}=ls,POe=me({name:"ElDropdown",components:{ElButton:ls,ElButtonGroup:kOe,ElScrollbar:gl,ElDropdownCollection:IOe,ElTooltip:Us,ElRovingFocusGroup:TOe,ElOnlyChild:PK,ElIcon:Dt,ArrowDown:uu},props:zb,emits:["visible-change","click","command"],setup(t,{emit:o}){const s=mn(),a=Qe("dropdown"),{t:l}=Fn(),d=ee(),h=ee(),v=ee(),g=ee(),E=ee(null),b=ee(null),S=ee(!1),C=U(()=>({maxHeight:mo(t.maxHeight)})),w=U(()=>[a.m(D.value)]),I=U(()=>Js(t.trigger)),R=Ts().value,N=U(()=>t.id||R);ze([d,I],([X,ie],[se])=>{var J,pe,be;(J=se==null?void 0:se.$el)!=null&&J.removeEventListener&&se.$el.removeEventListener("pointerenter",F),(pe=X==null?void 0:X.$el)!=null&&pe.removeEventListener&&X.$el.removeEventListener("pointerenter",F),(be=X==null?void 0:X.$el)!=null&&be.addEventListener&&ie.includes("hover")&&X.$el.addEventListener("pointerenter",F)},{immediate:!0}),Rr(()=>{var X,ie;(ie=(X=d.value)==null?void 0:X.$el)!=null&&ie.removeEventListener&&d.value.$el.removeEventListener("pointerenter",F)});function O(){V()}function V(){var X;(X=v.value)==null||X.onClose()}function L(){var X;(X=v.value)==null||X.onOpen()}const D=xo();function M(...X){o("command",...X)}function F(){var X,ie;(ie=(X=d.value)==null?void 0:X.$el)==null||ie.focus()}function W(){}function z(){const X=p(g);I.value.includes("hover")&&(X==null||X.focus()),b.value=null}function G(X){b.value=X}function Y(X){S.value||(X.preventDefault(),X.stopImmediatePropagation())}function te(){o("visible-change",!0)}function Z(X){var ie;(X==null?void 0:X.type)==="keydown"&&((ie=g.value)==null||ie.focus())}function fe(){o("visible-change",!1)}return wn(w0,{contentRef:g,role:U(()=>t.role),triggerId:N,isUsingKeyboard:S,onItemEnter:W,onItemLeave:z}),wn("elDropdown",{instance:s,dropdownSize:D,handleClick:O,commandHandler:M,trigger:lr(t,"trigger"),hideOnClick:lr(t,"hideOnClick")}),{t:l,ns:a,scrollbar:E,wrapStyle:C,dropdownTriggerKls:w,dropdownSize:D,triggerId:N,currentTabId:b,handleCurrentTabIdChange:G,handlerMainButtonClick:X=>{o("click",X)},handleEntryFocus:Y,handleClose:V,handleOpen:L,handleBeforeShowTooltip:te,handleShowTooltip:Z,handleBeforeHideTooltip:fe,onFocusAfterTrapped:X=>{var ie,se;X.preventDefault(),(se=(ie=g.value)==null?void 0:ie.focus)==null||se.call(ie,{preventScroll:!0})},popperRef:v,contentRef:g,triggeringElementRef:d,referenceElementRef:h}}});function DOe(t,o,s,a,l,d){var h;const v=_n("el-dropdown-collection"),g=_n("el-roving-focus-group"),E=_n("el-scrollbar"),b=_n("el-only-child"),S=_n("el-tooltip"),C=_n("el-button"),w=_n("arrow-down"),I=_n("el-icon"),R=_n("el-button-group");return $(),le("div",{class:K([t.ns.b(),t.ns.is("disabled",t.disabled)])},[ge(S,{ref:"popperRef",role:t.role,effect:t.effect,"fallback-placements":["bottom","top"],"popper-options":t.popperOptions,"gpu-acceleration":!1,"hide-after":t.trigger==="hover"?t.hideTimeout:0,"manual-mode":!0,placement:t.placement,"popper-class":[t.ns.e("popper"),t.popperClass],"reference-element":(h=t.referenceElementRef)==null?void 0:h.$el,trigger:t.trigger,"trigger-keys":t.triggerKeys,"trigger-target-el":t.contentRef,"show-after":t.trigger==="hover"?t.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":t.triggeringElementRef,"virtual-triggering":t.splitButton,disabled:t.disabled,transition:`${t.ns.namespace.value}-zoom-in-top`,teleported:t.teleported,pure:"",persistent:t.persistent,onBeforeShow:t.handleBeforeShowTooltip,onShow:t.handleShowTooltip,onBeforeHide:t.handleBeforeHideTooltip},fa({content:Ce(()=>[ge(E,{ref:"scrollbar","wrap-style":t.wrapStyle,tag:"div","view-class":t.ns.e("list")},{default:Ce(()=>[ge(g,{loop:t.loop,"current-tab-id":t.currentTabId,orientation:"horizontal",onCurrentTabIdChange:t.handleCurrentTabIdChange,onEntryFocus:t.handleEntryFocus},{default:Ce(()=>[ge(v,null,{default:Ce(()=>[Ne(t.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[t.splitButton?void 0:{name:"default",fn:Ce(()=>[ge(b,{id:t.triggerId,ref:"triggeringElementRef",role:"button",tabindex:t.tabindex},{default:Ce(()=>[Ne(t.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","persistent","onBeforeShow","onShow","onBeforeHide"]),t.splitButton?($(),Ve(R,{key:0},{default:Ce(()=>[ge(C,En({ref:"referenceElementRef"},t.buttonProps,{size:t.dropdownSize,type:t.type,disabled:t.disabled,tabindex:t.tabindex,onClick:t.handlerMainButtonClick}),{default:Ce(()=>[Ne(t.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),ge(C,En({id:t.triggerId,ref:"triggeringElementRef"},t.buttonProps,{role:"button",size:t.dropdownSize,type:t.type,class:t.ns.e("caret-button"),disabled:t.disabled,tabindex:t.tabindex,"aria-label":t.t("el.dropdown.toggleDropdown")}),{default:Ce(()=>[ge(I,{class:K(t.ns.e("icon"))},{default:Ce(()=>[ge(w)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):De("v-if",!0)],2)}var LOe=dt(POe,[["render",DOe],["__file","dropdown.vue"]]);const MOe=me({components:{ElRovingFocusCollectionItem:dOe},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(t,{emit:o}){const{currentTabbedId:s,loop:a,onItemFocus:l,onItemShiftTab:d}=It(Ak,void 0),{getItems:h}=It(Ik,void 0),v=Ts(),g=ee(),E=Eo(w=>{o("mousedown",w)},w=>{t.focusable?l(p(v)):w.preventDefault()}),b=Eo(w=>{o("focus",w)},()=>{l(p(v))}),S=Eo(w=>{o("keydown",w)},w=>{const{code:I,shiftKey:R,target:N,currentTarget:O}=w;if(I===Ct.tab&&R){d();return}if(N!==O)return;const V=mOe(w);if(V){w.preventDefault();let D=h().filter(M=>M.focusable).map(M=>M.ref);switch(V){case"last":{D.reverse();break}case"prev":case"next":{V==="prev"&&D.reverse();const M=D.indexOf(O);D=a.value?vOe(D,M+1):D.slice(M+1);break}}Vt(()=>{Ok(D)})}}),C=U(()=>s.value===p(v));return wn(lz,{rovingFocusGroupItemRef:g,tabIndex:U(()=>p(C)?0:-1),handleMousedown:E,handleFocus:b,handleKeydown:S}),{id:v,handleKeydown:S,handleFocus:b,handleMousedown:E}}});function xOe(t,o,s,a,l,d){const h=_n("el-roving-focus-collection-item");return $(),Ve(h,{id:t.id,focusable:t.focusable,active:t.active},{default:Ce(()=>[Ne(t.$slots,"default")]),_:3},8,["id","focusable","active"])}var UOe=dt(MOe,[["render",xOe],["__file","roving-focus-item.vue"]]);const VOe=me({name:"DropdownItemImpl",components:{ElIcon:Dt},props:uz,emits:["pointermove","pointerleave","click","clickimpl"],setup(t,{emit:o}){const s=Qe("dropdown"),{role:a}=It(w0,void 0),{collectionItemRef:l}=It(NOe,void 0),{collectionItemRef:d}=It(hOe,void 0),{rovingFocusGroupItemRef:h,tabIndex:v,handleFocus:g,handleKeydown:E,handleMousedown:b}=It(lz,void 0),S=C0(l,d,h),C=U(()=>a.value==="menu"?"menuitem":a.value==="navigation"?"link":"button"),w=Eo(I=>{if([Ct.enter,Ct.numpadEnter,Ct.space].includes(I.code))return I.preventDefault(),I.stopImmediatePropagation(),o("clickimpl",I),!0},E);return{ns:s,itemRef:S,dataset:{[az]:""},role:C,tabIndex:v,handleFocus:g,handleKeydown:w,handleMousedown:b}}});function FOe(t,o,s,a,l,d){const h=_n("el-icon");return $(),le(Ut,null,[t.divided?($(),le("li",{key:0,role:"separator",class:K(t.ns.bem("menu","item","divided"))},null,2)):De("v-if",!0),ue("li",En({ref:t.itemRef},{...t.dataset,...t.$attrs},{"aria-disabled":t.disabled,class:[t.ns.be("menu","item"),t.ns.is("disabled",t.disabled)],tabindex:t.tabIndex,role:t.role,onClick:v=>t.$emit("clickimpl",v),onFocus:t.handleFocus,onKeydown:Gt(t.handleKeydown,["self"]),onMousedown:t.handleMousedown,onPointermove:v=>t.$emit("pointermove",v),onPointerleave:v=>t.$emit("pointerleave",v)}),[t.icon?($(),Ve(h,{key:0},{default:Ce(()=>[($(),Ve(gn(t.icon)))]),_:1})):De("v-if",!0),Ne(t.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var BOe=dt(VOe,[["render",FOe],["__file","dropdown-item-impl.vue"]]);const hz=()=>{const t=It("elDropdown",{}),o=U(()=>t==null?void 0:t.dropdownSize);return{elDropdown:t,_elDropdownSize:o}},jOe=me({name:"ElDropdownItem",components:{ElDropdownCollectionItem:AOe,ElRovingFocusItem:UOe,ElDropdownItemImpl:BOe},inheritAttrs:!1,props:uz,emits:["pointermove","pointerleave","click"],setup(t,{emit:o,attrs:s}){const{elDropdown:a}=hz(),l=mn(),d=ee(null),h=U(()=>{var w,I;return(I=(w=p(d))==null?void 0:w.textContent)!=null?I:""}),{onItemEnter:v,onItemLeave:g}=It(w0,void 0),E=Eo(w=>(o("pointermove",w),w.defaultPrevented),eH(w=>{if(t.disabled){g(w);return}const I=w.currentTarget;I===document.activeElement||I.contains(document.activeElement)||(v(w),w.defaultPrevented||I==null||I.focus())})),b=Eo(w=>(o("pointerleave",w),w.defaultPrevented),eH(g)),S=Eo(w=>{if(!t.disabled)return o("click",w),w.type!=="keydown"&&w.defaultPrevented},w=>{var I,R,N;if(t.disabled){w.stopImmediatePropagation();return}(I=a==null?void 0:a.hideOnClick)!=null&&I.value&&((R=a.handleClick)==null||R.call(a)),(N=a.commandHandler)==null||N.call(a,t.command,l,w)}),C=U(()=>({...t,...s}));return{handleClick:S,handlePointerMove:E,handlePointerLeave:b,textContent:h,propsAndAttrs:C}}});function $Oe(t,o,s,a,l,d){var h;const v=_n("el-dropdown-item-impl"),g=_n("el-roving-focus-item"),E=_n("el-dropdown-collection-item");return $(),Ve(E,{disabled:t.disabled,"text-value":(h=t.textValue)!=null?h:t.textContent},{default:Ce(()=>[ge(g,{focusable:!t.disabled},{default:Ce(()=>[ge(v,En(t.propsAndAttrs,{onPointerleave:t.handlePointerLeave,onPointermove:t.handlePointerMove,onClickimpl:t.handleClick}),{default:Ce(()=>[Ne(t.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var fz=dt(jOe,[["render",$Oe],["__file","dropdown-item.vue"]]);const HOe=me({name:"ElDropdownMenu",props:COe,setup(t){const o=Qe("dropdown"),{_elDropdownSize:s}=hz(),a=s.value,{focusTrapRef:l,onKeydown:d}=It(tk,void 0),{contentRef:h,role:v,triggerId:g}=It(w0,void 0),{collectionRef:E,getItems:b}=It(OOe,void 0),{rovingFocusGroupRef:S,rovingFocusGroupRootStyle:C,tabIndex:w,onBlur:I,onFocus:R,onMousedown:N}=It(Ak,void 0),{collectionRef:O}=It(Ik,void 0),V=U(()=>[o.b("menu"),o.bm("menu",a==null?void 0:a.value)]),L=C0(h,E,l,S,O),D=Eo(F=>{var W;(W=t.onKeydown)==null||W.call(t,F)},F=>{const{currentTarget:W,code:z,target:G}=F;if(W.contains(G),Ct.tab===z&&F.stopImmediatePropagation(),F.preventDefault(),G!==p(h)||!ROe.includes(z))return;const te=b().filter(Z=>!Z.disabled).map(Z=>Z.ref);dz.includes(z)&&te.reverse(),Ok(te)});return{size:a,rovingFocusGroupRootStyle:C,tabIndex:w,dropdownKls:V,role:v,triggerId:g,dropdownListWrapperRef:L,handleKeydown:F=>{D(F),d(F)},onBlur:I,onFocus:R,onMousedown:N}}});function WOe(t,o,s,a,l,d){return $(),le("ul",{ref:t.dropdownListWrapperRef,class:K(t.dropdownKls),style:jt(t.rovingFocusGroupRootStyle),tabindex:-1,role:t.role,"aria-labelledby":t.triggerId,onBlur:t.onBlur,onFocus:t.onFocus,onKeydown:Gt(t.handleKeydown,["self"]),onMousedown:Gt(t.onMousedown,["self"])},[Ne(t.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var pz=dt(HOe,[["render",WOe],["__file","dropdown-menu.vue"]]);const KOe=rn(LOe,{DropdownItem:fz,DropdownMenu:pz}),GOe=uo(fz),zOe=uo(pz),YOe=me({name:"ImgEmpty"}),qOe=me({...YOe,setup(t){const o=Qe("empty"),s=Ts();return(a,l)=>($(),le("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[ue("defs",null,[ue("linearGradient",{id:`linearGradient-1-${p(s)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[ue("stop",{"stop-color":`var(${p(o).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),ue("stop",{"stop-color":`var(${p(o).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),ue("linearGradient",{id:`linearGradient-2-${p(s)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[ue("stop",{"stop-color":`var(${p(o).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),ue("stop",{"stop-color":`var(${p(o).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),ue("rect",{id:`path-3-${p(s)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),ue("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[ue("g",{transform:"translate(-1268.000000, -535.000000)"},[ue("g",{transform:"translate(1268.000000, 535.000000)"},[ue("path",{d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${p(o).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),ue("g",{transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),ue("rect",{fill:`url(#linearGradient-1-${p(s)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),ue("rect",{fill:`url(#linearGradient-2-${p(s)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),ue("g",{transform:"translate(53.000000, 45.000000)"},[ue("use",{fill:`var(${p(o).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${p(s)}`},null,8,["fill","xlink:href"]),ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${p(s)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),ue("polygon",{fill:`var(${p(o).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var XOe=dt(qOe,[["__file","img-empty.vue"]]);const JOe=ut({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),ZOe=me({name:"ElEmpty"}),QOe=me({...ZOe,props:JOe,setup(t){const o=t,{t:s}=Fn(),a=Qe("empty"),l=U(()=>o.description||s("el.table.emptyText")),d=U(()=>({width:mo(o.imageSize)}));return(h,v)=>($(),le("div",{class:K(p(a).b())},[ue("div",{class:K(p(a).e("image")),style:jt(p(d))},[h.image?($(),le("img",{key:0,src:h.image,ondragstart:"return false"},null,8,["src"])):Ne(h.$slots,"image",{key:1},()=>[ge(XOe)])],6),ue("div",{class:K(p(a).e("description"))},[h.$slots.description?Ne(h.$slots,"description",{key:0}):($(),le("p",{key:1},ot(p(l)),1))],2),h.$slots.default?($(),le("div",{key:0,class:K(p(a).e("bottom"))},[Ne(h.$slots,"default")],2)):De("v-if",!0)],2))}});var eNe=dt(QOe,[["__file","empty.vue"]]);const mz=rn(eNe),tNe=ut({size:{type:String,values:vl},disabled:Boolean}),nNe=ut({...tNe,model:Object,rules:{type:Re(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),rNe={validate:(t,o,s)=>(st(t)||Mt(t))&&wr(o)&&Mt(s)};function oNe(){const t=ee([]),o=U(()=>{if(!t.value.length)return"0";const d=Math.max(...t.value);return d?`${d}px`:""});function s(d){const h=t.value.indexOf(d);return h===-1&&o.value,h}function a(d,h){if(d&&h){const v=s(h);t.value.splice(v,1,d)}else d&&t.value.push(d)}function l(d){const h=s(d);h>-1&&t.value.splice(h,1)}return{autoLabelWidth:o,registerLabelWidth:a,deregisterLabelWidth:l}}const Db=(t,o)=>{const s=Js(o);return s.length>0?t.filter(a=>a.prop&&s.includes(a.prop)):t},sNe="ElForm",iNe=me({name:sNe}),aNe=me({...iNe,props:nNe,emits:rNe,setup(t,{expose:o,emit:s}){const a=t,l=[],d=xo(),h=Qe("form"),v=U(()=>{const{labelPosition:L,inline:D}=a;return[h.b(),h.m(d.value||"default"),{[h.m(`label-${L}`)]:L,[h.m("inline")]:D}]}),g=L=>l.find(D=>D.prop===L),E=L=>{l.push(L)},b=L=>{L.prop&&l.splice(l.indexOf(L),1)},S=(L=[])=>{a.model&&Db(l,L).forEach(D=>D.resetField())},C=(L=[])=>{Db(l,L).forEach(D=>D.clearValidate())},w=U(()=>!!a.model),I=L=>{if(l.length===0)return[];const D=Db(l,L);return D.length?D:[]},R=async L=>O(void 0,L),N=async(L=[])=>{if(!w.value)return!1;const D=I(L);if(D.length===0)return!0;let M={};for(const F of D)try{await F.validate(""),F.validateState==="error"&&F.resetField()}catch(W){M={...M,...W}}return Object.keys(M).length===0?!0:Promise.reject(M)},O=async(L=[],D)=>{const M=!Ft(D);try{const F=await N(L);return F===!0&&await(D==null?void 0:D(F)),F}catch(F){if(F instanceof Error)throw F;const W=F;return a.scrollToError&&V(Object.keys(W)[0]),await(D==null?void 0:D(!1,W)),M&&Promise.reject(W)}},V=L=>{var D;const M=Db(l,L)[0];M&&((D=M.$el)==null||D.scrollIntoView(a.scrollIntoViewOptions))};return ze(()=>a.rules,()=>{a.validateOnRuleChange&&R().catch(L=>void 0)},{deep:!0,flush:"post"}),wn(Kh,er({...ds(a),emit:s,resetFields:S,clearValidate:C,validateField:O,getField:g,addField:E,removeField:b,...oNe()})),o({validate:R,validateField:O,resetFields:S,clearValidate:C,scrollToField:V,fields:l}),(L,D)=>($(),le("form",{class:K(p(v))},[Ne(L.$slots,"default")],2))}});var cNe=dt(aNe,[["__file","form.vue"]]);function bh(){return bh=Object.assign?Object.assign.bind():function(t){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},bh.apply(this,arguments)}function lNe(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,$g(t,o)}function hO(t){return hO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},hO(t)}function $g(t,o){return $g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,l){return a.__proto__=l,a},$g(t,o)}function uNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yb(t,o,s){return uNe()?Yb=Reflect.construct.bind():Yb=function(l,d,h){var v=[null];v.push.apply(v,d);var g=Function.bind.apply(l,v),E=new g;return h&&$g(E,h.prototype),E},Yb.apply(null,arguments)}function dNe(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function fO(t){var o=typeof Map=="function"?new Map:void 0;return fO=function(a){if(a===null||!dNe(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(a))return o.get(a);o.set(a,l)}function l(){return Yb(a,arguments,hO(this).constructor)}return l.prototype=Object.create(a.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),$g(l,a)},fO(t)}var hNe=/%[sdj%]/g,fNe=function(){};function pO(t){if(!t||!t.length)return null;var o={};return t.forEach(function(s){var a=s.field;o[a]=o[a]||[],o[a].push(s)}),o}function ca(t){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];var l=0,d=s.length;if(typeof t=="function")return t.apply(null,s);if(typeof t=="string"){var h=t.replace(hNe,function(v){if(v==="%%")return"%";if(l>=d)return v;switch(v){case"%s":return String(s[l++]);case"%d":return Number(s[l++]);case"%j":try{return JSON.stringify(s[l++])}catch{return"[Circular]"}break;default:return v}});return h}return t}function pNe(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function fs(t,o){return!!(t==null||o==="array"&&Array.isArray(t)&&!t.length||pNe(o)&&typeof t=="string"&&!t)}function mNe(t,o,s){var a=[],l=0,d=t.length;function h(v){a.push.apply(a,v||[]),l++,l===d&&s(a)}t.forEach(function(v){o(v,h)})}function wH(t,o,s){var a=0,l=t.length;function d(h){if(h&&h.length){s(h);return}var v=a;a=a+1,v<l?o(t[v],d):s([])}d([])}function vNe(t){var o=[];return Object.keys(t).forEach(function(s){o.push.apply(o,t[s]||[])}),o}var RH=function(t){lNe(o,t);function o(s,a){var l;return l=t.call(this,"Async Validation Error")||this,l.errors=s,l.fields=a,l}return o}(fO(Error));function gNe(t,o,s,a,l){if(o.first){var d=new Promise(function(C,w){var I=function(O){return a(O),O.length?w(new RH(O,pO(O))):C(l)},R=vNe(t);wH(R,s,I)});return d.catch(function(C){return C}),d}var h=o.firstFields===!0?Object.keys(t):o.firstFields||[],v=Object.keys(t),g=v.length,E=0,b=[],S=new Promise(function(C,w){var I=function(N){if(b.push.apply(b,N),E++,E===g)return a(b),b.length?w(new RH(b,pO(b))):C(l)};v.length||(a(b),C(l)),v.forEach(function(R){var N=t[R];h.indexOf(R)!==-1?wH(N,s,I):mNe(N,s,I)})});return S.catch(function(C){return C}),S}function _Ne(t){return!!(t&&t.message!==void 0)}function ENe(t,o){for(var s=t,a=0;a<o.length;a++){if(s==null)return s;s=s[o[a]]}return s}function IH(t,o){return function(s){var a;return t.fullFields?a=ENe(o,t.fullFields):a=o[s.field||t.fullField],_Ne(s)?(s.field=s.field||t.fullField,s.fieldValue=a,s):{message:typeof s=="function"?s():s,fieldValue:a,field:s.field||t.fullField}}}function AH(t,o){if(o){for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];typeof a=="object"&&typeof t[s]=="object"?t[s]=bh({},t[s],a):t[s]=a}}return t}var vz=function(o,s,a,l,d,h){o.required&&(!a.hasOwnProperty(o.field)||fs(s,h||o.type))&&l.push(ca(d.messages.required,o.fullField))},yNe=function(o,s,a,l,d){(/^\s+$/.test(s)||s==="")&&l.push(ca(d.messages.whitespace,o.fullField))},Lb,bNe=function(){if(Lb)return Lb;var t="[a-fA-F\\d:]",o=function(D){return D&&D.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},s="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",a="[a-fA-F\\d]{1,4}",l=(`
(?:
(?:`+a+":){7}(?:"+a+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+a+":){6}(?:"+s+"|:"+a+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+a+":){5}(?::"+s+"|(?::"+a+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+a+":){4}(?:(?::"+a+"){0,1}:"+s+"|(?::"+a+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+a+":){3}(?:(?::"+a+"){0,2}:"+s+"|(?::"+a+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+a+":){2}(?:(?::"+a+"){0,3}:"+s+"|(?::"+a+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+a+":){1}(?:(?::"+a+"){0,4}:"+s+"|(?::"+a+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+a+"){0,5}:"+s+"|(?::"+a+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),d=new RegExp("(?:^"+s+"$)|(?:^"+l+"$)"),h=new RegExp("^"+s+"$"),v=new RegExp("^"+l+"$"),g=function(D){return D&&D.exact?d:new RegExp("(?:"+o(D)+s+o(D)+")|(?:"+o(D)+l+o(D)+")","g")};g.v4=function(L){return L&&L.exact?h:new RegExp(""+o(L)+s+o(L),"g")},g.v6=function(L){return L&&L.exact?v:new RegExp(""+o(L)+l+o(L),"g")};var E="(?:(?:[a-z]+:)?//)",b="(?:\\S+(?::\\S*)?@)?",S=g.v4().source,C=g.v6().source,w="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",I="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",R="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",N="(?::\\d{2,5})?",O='(?:[/?#][^\\s"]*)?',V="(?:"+E+"|www\\.)"+b+"(?:localhost|"+S+"|"+C+"|"+w+I+R+")"+N+O;return Lb=new RegExp("(?:^"+V+"$)","i"),Lb},OH={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},rg={integer:function(o){return rg.number(o)&&parseInt(o,10)===o},float:function(o){return rg.number(o)&&!rg.integer(o)},array:function(o){return Array.isArray(o)},regexp:function(o){if(o instanceof RegExp)return!0;try{return!!new RegExp(o)}catch{return!1}},date:function(o){return typeof o.getTime=="function"&&typeof o.getMonth=="function"&&typeof o.getYear=="function"&&!isNaN(o.getTime())},number:function(o){return isNaN(o)?!1:typeof o=="number"},object:function(o){return typeof o=="object"&&!rg.array(o)},method:function(o){return typeof o=="function"},email:function(o){return typeof o=="string"&&o.length<=320&&!!o.match(OH.email)},url:function(o){return typeof o=="string"&&o.length<=2048&&!!o.match(bNe())},hex:function(o){return typeof o=="string"&&!!o.match(OH.hex)}},SNe=function(o,s,a,l,d){if(o.required&&s===void 0){vz(o,s,a,l,d);return}var h=["integer","float","array","regexp","object","method","email","number","date","url","hex"],v=o.type;h.indexOf(v)>-1?rg[v](s)||l.push(ca(d.messages.types[v],o.fullField,o.type)):v&&typeof s!==o.type&&l.push(ca(d.messages.types[v],o.fullField,o.type))},TNe=function(o,s,a,l,d){var h=typeof o.len=="number",v=typeof o.min=="number",g=typeof o.max=="number",E=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b=s,S=null,C=typeof s=="number",w=typeof s=="string",I=Array.isArray(s);if(C?S="number":w?S="string":I&&(S="array"),!S)return!1;I&&(b=s.length),w&&(b=s.replace(E,"_").length),h?b!==o.len&&l.push(ca(d.messages[S].len,o.fullField,o.len)):v&&!g&&b<o.min?l.push(ca(d.messages[S].min,o.fullField,o.min)):g&&!v&&b>o.max?l.push(ca(d.messages[S].max,o.fullField,o.max)):v&&g&&(b<o.min||b>o.max)&&l.push(ca(d.messages[S].range,o.fullField,o.min,o.max))},mp="enum",CNe=function(o,s,a,l,d){o[mp]=Array.isArray(o[mp])?o[mp]:[],o[mp].indexOf(s)===-1&&l.push(ca(d.messages[mp],o.fullField,o[mp].join(", ")))},wNe=function(o,s,a,l,d){if(o.pattern){if(o.pattern instanceof RegExp)o.pattern.lastIndex=0,o.pattern.test(s)||l.push(ca(d.messages.pattern.mismatch,o.fullField,s,o.pattern));else if(typeof o.pattern=="string"){var h=new RegExp(o.pattern);h.test(s)||l.push(ca(d.messages.pattern.mismatch,o.fullField,s,o.pattern))}}},Or={required:vz,whitespace:yNe,type:SNe,range:TNe,enum:CNe,pattern:wNe},RNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s,"string")&&!o.required)return a();Or.required(o,s,l,h,d,"string"),fs(s,"string")||(Or.type(o,s,l,h,d),Or.range(o,s,l,h,d),Or.pattern(o,s,l,h,d),o.whitespace===!0&&Or.whitespace(o,s,l,h,d))}a(h)},INe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&Or.type(o,s,l,h,d)}a(h)},ANe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(s===""&&(s=void 0),fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&(Or.type(o,s,l,h,d),Or.range(o,s,l,h,d))}a(h)},ONe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&Or.type(o,s,l,h,d)}a(h)},NNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),fs(s)||Or.type(o,s,l,h,d)}a(h)},kNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&(Or.type(o,s,l,h,d),Or.range(o,s,l,h,d))}a(h)},PNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&(Or.type(o,s,l,h,d),Or.range(o,s,l,h,d))}a(h)},DNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(s==null&&!o.required)return a();Or.required(o,s,l,h,d,"array"),s!=null&&(Or.type(o,s,l,h,d),Or.range(o,s,l,h,d))}a(h)},LNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&Or.type(o,s,l,h,d)}a(h)},MNe="enum",xNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d),s!==void 0&&Or[MNe](o,s,l,h,d)}a(h)},UNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s,"string")&&!o.required)return a();Or.required(o,s,l,h,d),fs(s,"string")||Or.pattern(o,s,l,h,d)}a(h)},VNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s,"date")&&!o.required)return a();if(Or.required(o,s,l,h,d),!fs(s,"date")){var g;s instanceof Date?g=s:g=new Date(s),Or.type(o,g,l,h,d),g&&Or.range(o,g.getTime(),l,h,d)}}a(h)},FNe=function(o,s,a,l,d){var h=[],v=Array.isArray(s)?"array":typeof s;Or.required(o,s,l,h,d,v),a(h)},fA=function(o,s,a,l,d){var h=o.type,v=[],g=o.required||!o.required&&l.hasOwnProperty(o.field);if(g){if(fs(s,h)&&!o.required)return a();Or.required(o,s,l,v,d,h),fs(s,h)||Or.type(o,s,l,v,d)}a(v)},BNe=function(o,s,a,l,d){var h=[],v=o.required||!o.required&&l.hasOwnProperty(o.field);if(v){if(fs(s)&&!o.required)return a();Or.required(o,s,l,h,d)}a(h)},yg={string:RNe,method:INe,number:ANe,boolean:ONe,regexp:NNe,integer:kNe,float:PNe,array:DNe,object:LNe,enum:xNe,pattern:UNe,date:VNe,url:fA,hex:fA,email:fA,required:FNe,any:BNe};function mO(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var o=JSON.parse(JSON.stringify(this));return o.clone=this.clone,o}}}var vO=mO(),p_=function(){function t(s){this.rules=null,this._messages=vO,this.define(s)}var o=t.prototype;return o.define=function(a){var l=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(typeof a!="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(d){var h=a[d];l.rules[d]=Array.isArray(h)?h:[h]})},o.messages=function(a){return a&&(this._messages=AH(mO(),a)),this._messages},o.validate=function(a,l,d){var h=this;l===void 0&&(l={}),d===void 0&&(d=function(){});var v=a,g=l,E=d;if(typeof g=="function"&&(E=g,g={}),!this.rules||Object.keys(this.rules).length===0)return E&&E(null,v),Promise.resolve(v);function b(R){var N=[],O={};function V(D){if(Array.isArray(D)){var M;N=(M=N).concat.apply(M,D)}else N.push(D)}for(var L=0;L<R.length;L++)V(R[L]);N.length?(O=pO(N),E(N,O)):E(null,v)}if(g.messages){var S=this.messages();S===vO&&(S=mO()),AH(S,g.messages),g.messages=S}else g.messages=this.messages();var C={},w=g.keys||Object.keys(this.rules);w.forEach(function(R){var N=h.rules[R],O=v[R];N.forEach(function(V){var L=V;typeof L.transform=="function"&&(v===a&&(v=bh({},v)),O=v[R]=L.transform(O)),typeof L=="function"?L={validator:L}:L=bh({},L),L.validator=h.getValidationMethod(L),L.validator&&(L.field=R,L.fullField=L.fullField||R,L.type=h.getType(L),C[R]=C[R]||[],C[R].push({rule:L,value:O,source:v,field:R}))})});var I={};return gNe(C,g,function(R,N){var O=R.rule,V=(O.type==="object"||O.type==="array")&&(typeof O.fields=="object"||typeof O.defaultField=="object");V=V&&(O.required||!O.required&&R.value),O.field=R.field;function L(F,W){return bh({},W,{fullField:O.fullField+"."+F,fullFields:O.fullFields?[].concat(O.fullFields,[F]):[F]})}function D(F){F===void 0&&(F=[]);var W=Array.isArray(F)?F:[F];!g.suppressWarning&&W.length&&t.warning("async-validator:",W),W.length&&O.message!==void 0&&(W=[].concat(O.message));var z=W.map(IH(O,v));if(g.first&&z.length)return I[O.field]=1,N(z);if(!V)N(z);else{if(O.required&&!R.value)return O.message!==void 0?z=[].concat(O.message).map(IH(O,v)):g.error&&(z=[g.error(O,ca(g.messages.required,O.field))]),N(z);var G={};O.defaultField&&Object.keys(R.value).map(function(Z){G[Z]=O.defaultField}),G=bh({},G,R.rule.fields);var Y={};Object.keys(G).forEach(function(Z){var fe=G[Z],Ee=Array.isArray(fe)?fe:[fe];Y[Z]=Ee.map(L.bind(null,Z))});var te=new t(Y);te.messages(g.messages),R.rule.options&&(R.rule.options.messages=g.messages,R.rule.options.error=g.error),te.validate(R.value,R.rule.options||g,function(Z){var fe=[];z&&z.length&&fe.push.apply(fe,z),Z&&Z.length&&fe.push.apply(fe,Z),N(fe.length?fe:null)})}}var M;if(O.asyncValidator)M=O.asyncValidator(O,R.value,D,R.source,g);else if(O.validator){try{M=O.validator(O,R.value,D,R.source,g)}catch(F){console.error==null||console.error(F),g.suppressValidatorError||setTimeout(function(){throw F},0),D(F.message)}M===!0?D():M===!1?D(typeof O.message=="function"?O.message(O.fullField||O.field):O.message||(O.fullField||O.field)+" fails"):M instanceof Array?D(M):M instanceof Error&&D(M.message)}M&&M.then&&M.then(function(){return D()},function(F){return D(F)})},function(R){b(R)},v)},o.getType=function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!yg.hasOwnProperty(a.type))throw new Error(ca("Unknown rule type %s",a.type));return a.type||"string"},o.getValidationMethod=function(a){if(typeof a.validator=="function")return a.validator;var l=Object.keys(a),d=l.indexOf("message");return d!==-1&&l.splice(d,1),l.length===1&&l[0]==="required"?yg.required:yg[this.getType(a)]||void 0},t}();p_.register=function(o,s){if(typeof s!="function")throw new Error("Cannot register a validator by type, validator is not a function");yg[o]=s};p_.warning=fNe;p_.messages=vO;p_.validators=yg;const jNe=["","error","validating","success"],$Ne=ut({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:Re([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Re([Object,Array])},error:String,validateStatus:{type:String,values:jNe},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:vl}}),NH="ElLabelWrap";var HNe=me({name:NH,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:o}){const s=It(Kh,void 0),a=It(fl);a||qo(NH,"usage: <el-form-item><label-wrap /></el-form-item>");const l=Qe("form"),d=ee(),h=ee(0),v=()=>{var b;if((b=d.value)!=null&&b.firstElementChild){const S=window.getComputedStyle(d.value.firstElementChild).width;return Math.ceil(Number.parseFloat(S))}else return 0},g=(b="update")=>{Vt(()=>{o.default&&t.isAutoWidth&&(b==="update"?h.value=v():b==="remove"&&(s==null||s.deregisterLabelWidth(h.value)))})},E=()=>g("update");return dn(()=>{E()}),Rr(()=>{g("remove")}),wc(()=>E()),ze(h,(b,S)=>{t.updateAll&&(s==null||s.registerLabelWidth(b,S))}),co(U(()=>{var b,S;return(S=(b=d.value)==null?void 0:b.firstElementChild)!=null?S:null}),E),()=>{var b,S;if(!o)return null;const{isAutoWidth:C}=t;if(C){const w=s==null?void 0:s.autoLabelWidth,I=a==null?void 0:a.hasLabel,R={};if(I&&w&&w!=="auto"){const N=Math.max(0,Number.parseInt(w,10)-h.value),V=(a.labelPosition||s.labelPosition)==="left"?"marginRight":"marginLeft";N&&(R[V]=`${N}px`)}return ge("div",{ref:d,class:[l.be("item","label-wrap")],style:R},[(b=o.default)==null?void 0:b.call(o)])}else return ge(Ut,{ref:d},[(S=o.default)==null?void 0:S.call(o)])}}});const WNe=me({name:"ElFormItem"}),KNe=me({...WNe,props:$Ne,setup(t,{expose:o}){const s=t,a=Jo(),l=It(Kh,void 0),d=It(fl,void 0),h=xo(void 0,{formItem:!1}),v=Qe("form-item"),g=Ts().value,E=ee([]),b=ee(""),S=uEe(b,100),C=ee(""),w=ee();let I,R=!1;const N=U(()=>s.labelPosition||(l==null?void 0:l.labelPosition)),O=U(()=>{if(N.value==="top")return{};const He=mo(s.labelWidth||(l==null?void 0:l.labelWidth)||"");return He?{width:He}:{}}),V=U(()=>{if(N.value==="top"||l!=null&&l.inline)return{};if(!s.label&&!s.labelWidth&&Y)return{};const He=mo(s.labelWidth||(l==null?void 0:l.labelWidth)||"");return!s.label&&!a.label?{marginLeft:He}:{}}),L=U(()=>[v.b(),v.m(h.value),v.is("error",b.value==="error"),v.is("validating",b.value==="validating"),v.is("success",b.value==="success"),v.is("required",ae.value||s.required),v.is("no-asterisk",l==null?void 0:l.hideRequiredAsterisk),(l==null?void 0:l.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[v.m("feedback")]:l==null?void 0:l.statusIcon,[v.m(`label-${N.value}`)]:N.value}]),D=U(()=>wr(s.inlineMessage)?s.inlineMessage:(l==null?void 0:l.inlineMessage)||!1),M=U(()=>[v.e("error"),{[v.em("error","inline")]:D.value}]),F=U(()=>s.prop?Mt(s.prop)?s.prop:s.prop.join("."):""),W=U(()=>!!(s.label||a.label)),z=U(()=>s.for||(E.value.length===1?E.value[0]:void 0)),G=U(()=>!z.value&&W.value),Y=!!d,te=U(()=>{const He=l==null?void 0:l.model;if(!(!He||!s.prop))return vg(He,s.prop).value}),Z=U(()=>{const{required:He}=s,We=[];s.rules&&We.push(...Js(s.rules));const yt=l==null?void 0:l.rules;if(yt&&s.prop){const it=vg(yt,s.prop).value;it&&We.push(...Js(it))}if(He!==void 0){const it=We.map((ce,Se)=>[ce,Se]).filter(([ce])=>Object.keys(ce).includes("required"));if(it.length>0)for(const[ce,Se]of it)ce.required!==He&&(We[Se]={...ce,required:He});else We.push({required:He})}return We}),fe=U(()=>Z.value.length>0),Ee=He=>Z.value.filter(yt=>!yt.trigger||!He?!0:st(yt.trigger)?yt.trigger.includes(He):yt.trigger===He).map(({trigger:yt,...it})=>it),ae=U(()=>Z.value.some(He=>He.required)),X=U(()=>{var He;return S.value==="error"&&s.showMessage&&((He=l==null?void 0:l.showMessage)!=null?He:!0)}),ie=U(()=>`${s.label||""}${(l==null?void 0:l.labelSuffix)||""}`),se=He=>{b.value=He},J=He=>{var We,yt;const{errors:it,fields:ce}=He;(!it||!ce)&&console.error(He),se("error"),C.value=it?(yt=(We=it==null?void 0:it[0])==null?void 0:We.message)!=null?yt:`${s.prop} is required`:"",l==null||l.emit("validate",s.prop,!1,C.value)},pe=()=>{se("success"),l==null||l.emit("validate",s.prop,!0,"")},be=async He=>{const We=F.value;return new p_({[We]:He}).validate({[We]:te.value},{firstFields:!0}).then(()=>(pe(),!0)).catch(it=>(J(it),Promise.reject(it)))},Ae=async(He,We)=>{if(R||!s.prop)return!1;const yt=Ft(We);if(!fe.value)return We==null||We(!1),!1;const it=Ee(He);return it.length===0?(We==null||We(!0),!0):(se("validating"),be(it).then(()=>(We==null||We(!0),!0)).catch(ce=>{const{fields:Se}=ce;return We==null||We(!1,Se),yt?!1:Promise.reject(Se)}))},_e=()=>{se(""),C.value="",R=!1},Me=async()=>{const He=l==null?void 0:l.model;if(!He||!s.prop)return;const We=vg(He,s.prop);R=!0,We.value=c$(I),await Vt(),_e(),R=!1},Fe=He=>{E.value.includes(He)||E.value.push(He)},Le=He=>{E.value=E.value.filter(We=>We!==He)};ze(()=>s.error,He=>{C.value=He||"",se(He?"error":"")},{immediate:!0}),ze(()=>s.validateStatus,He=>se(He||""));const Pe=er({...ds(s),$el:w,size:h,validateState:b,labelId:g,inputIds:E,isGroup:G,hasLabel:W,fieldValue:te,addInputId:Fe,removeInputId:Le,resetField:Me,clearValidate:_e,validate:Ae});return wn(fl,Pe),dn(()=>{s.prop&&(l==null||l.addField(Pe),I=c$(te.value))}),Rr(()=>{l==null||l.removeField(Pe)}),o({size:h,validateMessage:C,validateState:b,validate:Ae,clearValidate:_e,resetField:Me}),(He,We)=>{var yt;return $(),le("div",{ref_key:"formItemRef",ref:w,class:K(p(L)),role:p(G)?"group":void 0,"aria-labelledby":p(G)?p(g):void 0},[ge(p(HNe),{"is-auto-width":p(O).width==="auto","update-all":((yt=p(l))==null?void 0:yt.labelWidth)==="auto"},{default:Ce(()=>[p(W)?($(),Ve(gn(p(z)?"label":"div"),{key:0,id:p(g),for:p(z),class:K(p(v).e("label")),style:jt(p(O))},{default:Ce(()=>[Ne(He.$slots,"label",{label:p(ie)},()=>[bn(ot(p(ie)),1)])]),_:3},8,["id","for","class","style"])):De("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),ue("div",{class:K(p(v).e("content")),style:jt(p(V))},[Ne(He.$slots,"default"),ge(oW,{name:`${p(v).namespace.value}-zoom-in-top`},{default:Ce(()=>[p(X)?Ne(He.$slots,"error",{key:0,error:C.value},()=>[ue("div",{class:K(p(M))},ot(C.value),3)]):De("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var gz=dt(KNe,[["__file","form-item.vue"]]);const GNe=rn(cNe,{FormItem:gz}),zNe=uo(gz),YNe=ut({urlList:{type:Re(Array),default:()=>lo([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Re(String)}}),qNe={close:()=>!0,switch:t=>$t(t),rotate:t=>$t(t)},XNe=me({name:"ElImageViewer"}),JNe=me({...XNe,props:YNe,emits:qNe,setup(t,{expose:o,emit:s}){var a;const l=t,d={CONTAIN:{name:"contain",icon:Zl(wye)},ORIGINAL:{name:"original",icon:Zl(Kye)}};let h,v="";const{t:g}=Fn(),E=Qe("image-viewer"),{nextZIndex:b}=fm(),S=ee(),C=ee([]),w=mde(),I=ee(!0),R=ee(l.initialIndex),N=Mr(d.CONTAIN),O=ee({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=ee((a=l.zIndex)!=null?a:b()),L=U(()=>{const{urlList:Le}=l;return Le.length<=1}),D=U(()=>R.value===0),M=U(()=>R.value===l.urlList.length-1),F=U(()=>l.urlList[R.value]),W=U(()=>[E.e("btn"),E.e("prev"),E.is("disabled",!l.infinite&&D.value)]),z=U(()=>[E.e("btn"),E.e("next"),E.is("disabled",!l.infinite&&M.value)]),G=U(()=>{const{scale:Le,deg:Pe,offsetX:He,offsetY:We,enableTransition:yt}=O.value;let it=He/Le,ce=We/Le;const Se=Pe*Math.PI/180,je=Math.cos(Se),tt=Math.sin(Se);it=it*je+ce*tt,ce=ce*je-He/Le*tt;const et={transform:`scale(${Le}) rotate(${Pe}deg) translate(${it}px, ${ce}px)`,transition:yt?"transform .3s":""};return N.value.name===d.CONTAIN.name&&(et.maxWidth=et.maxHeight="100%"),et}),Y=U(()=>`${R.value+1} / ${l.urlList.length}`);function te(){fe(),h==null||h(),document.body.style.overflow=v,s("close")}function Z(){const Le=Ih(He=>{switch(He.code){case Ct.esc:l.closeOnPressEscape&&te();break;case Ct.space:se();break;case Ct.left:pe();break;case Ct.up:Ae("zoomIn");break;case Ct.right:be();break;case Ct.down:Ae("zoomOut");break}}),Pe=Ih(He=>{const We=He.deltaY||He.deltaX;Ae(We<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});w.run(()=>{gr(document,"keydown",Le),gr(document,"wheel",Pe)})}function fe(){w.stop()}function Ee(){I.value=!1}function ae(Le){I.value=!1,Le.target.alt=g("el.image.error")}function X(Le){if(I.value||Le.button!==0||!S.value)return;O.value.enableTransition=!1;const{offsetX:Pe,offsetY:He}=O.value,We=Le.pageX,yt=Le.pageY,it=Ih(Se=>{O.value={...O.value,offsetX:Pe+Se.pageX-We,offsetY:He+Se.pageY-yt}}),ce=gr(document,"mousemove",it);gr(document,"mouseup",()=>{ce()}),Le.preventDefault()}function ie(){O.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function se(){if(I.value)return;const Le=Kp(d),Pe=Object.values(d),He=N.value.name,yt=(Pe.findIndex(it=>it.name===He)+1)%Le.length;N.value=d[Le[yt]],ie()}function J(Le){const Pe=l.urlList.length;R.value=(Le+Pe)%Pe}function pe(){D.value&&!l.infinite||J(R.value-1)}function be(){M.value&&!l.infinite||J(R.value+1)}function Ae(Le,Pe={}){if(I.value)return;const{minScale:He,maxScale:We}=l,{zoomRate:yt,rotateDeg:it,enableTransition:ce}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...Pe};switch(Le){case"zoomOut":O.value.scale>He&&(O.value.scale=Number.parseFloat((O.value.scale/yt).toFixed(3)));break;case"zoomIn":O.value.scale<We&&(O.value.scale=Number.parseFloat((O.value.scale*yt).toFixed(3)));break;case"clockwise":O.value.deg+=it,s("rotate",O.value.deg);break;case"anticlockwise":O.value.deg-=it,s("rotate",O.value.deg);break}O.value.enableTransition=ce}function _e(Le){var Pe;((Pe=Le.detail)==null?void 0:Pe.focusReason)==="pointer"&&Le.preventDefault()}function Me(){l.closeOnPressEscape&&te()}function Fe(Le){if(Le.ctrlKey){if(Le.deltaY<0)return Le.preventDefault(),!1;if(Le.deltaY>0)return Le.preventDefault(),!1}}return ze(F,()=>{Vt(()=>{const Le=C.value[0];Le!=null&&Le.complete||(I.value=!0)})}),ze(R,Le=>{ie(),s("switch",Le)}),dn(()=>{Z(),h=gr("wheel",Fe,{passive:!1}),v=document.body.style.overflow,document.body.style.overflow="hidden"}),o({setActiveItem:J}),(Le,Pe)=>($(),Ve(p(vm),{to:"body",disabled:!Le.teleported},{default:Ce(()=>[ge(hs,{name:"viewer-fade",appear:""},{default:Ce(()=>[ue("div",{ref_key:"wrapper",ref:S,tabindex:-1,class:K(p(E).e("wrapper")),style:jt({zIndex:V.value})},[ge(p(mm),{loop:"",trapped:"","focus-trap-el":S.value,"focus-start-el":"container",onFocusoutPrevented:_e,onReleaseRequested:Me},{default:Ce(()=>[ue("div",{class:K(p(E).e("mask")),onClick:Gt(He=>Le.hideOnClickModal&&te(),["self"])},null,10,["onClick"]),De(" CLOSE "),ue("span",{class:K([p(E).e("btn"),p(E).e("close")]),onClick:te},[ge(p(Dt),null,{default:Ce(()=>[ge(p(Sc))]),_:1})],2),De(" ARROW "),p(L)?De("v-if",!0):($(),le(Ut,{key:0},[ue("span",{class:K(p(W)),onClick:pe},[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1})],2),ue("span",{class:K(p(z)),onClick:be},[ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})],2)],64)),Le.showProgress?($(),le("div",{key:1,class:K([p(E).e("btn"),p(E).e("progress")])},[Ne(Le.$slots,"progress",{activeIndex:R.value,total:Le.urlList.length},()=>[bn(ot(p(Y)),1)])],2)):De("v-if",!0),De(" ACTIONS "),ue("div",{class:K([p(E).e("btn"),p(E).e("actions")])},[ue("div",{class:K(p(E).e("actions__inner"))},[Ne(Le.$slots,"toolbar",{actions:Ae,prev:pe,next:be,reset:se,activeIndex:R.value,setActiveItem:J},()=>[ge(p(Dt),{onClick:He=>Ae("zoomOut")},{default:Ce(()=>[ge(p(abe))]),_:1},8,["onClick"]),ge(p(Dt),{onClick:He=>Ae("zoomIn")},{default:Ce(()=>[ge(p(bK))]),_:1},8,["onClick"]),ue("i",{class:K(p(E).e("actions__divider"))},null,2),ge(p(Dt),{onClick:se},{default:Ce(()=>[($(),Ve(gn(p(N).icon)))]),_:1}),ue("i",{class:K(p(E).e("actions__divider"))},null,2),ge(p(Dt),{onClick:He=>Ae("anticlockwise")},{default:Ce(()=>[ge(p(jye))]),_:1},8,["onClick"]),ge(p(Dt),{onClick:He=>Ae("clockwise")},{default:Ce(()=>[ge(p(Hye))]),_:1},8,["onClick"])])],2)],2),De(" CANVAS "),ue("div",{class:K(p(E).e("canvas"))},[($(!0),le(Ut,null,Cn(Le.urlList,(He,We)=>ln(($(),le("img",{ref_for:!0,ref:yt=>C.value[We]=yt,key:He,src:He,style:jt(p(G)),class:K(p(E).e("img")),crossorigin:Le.crossorigin,onLoad:Ee,onError:ae,onMousedown:X},null,46,["src","crossorigin"])),[[Wn,We===R.value]])),128))],2),Ne(Le.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var ZNe=dt(JNe,[["__file","image-viewer.vue"]]);const _z=rn(ZNe),QNe=ut({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Re([String,Object])},previewSrcList:{type:Re(Array),default:()=>lo([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:Re(String)}}),eke={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>$t(t),close:()=>!0,show:()=>!0},tke=me({name:"ElImage",inheritAttrs:!1}),nke=me({...tke,props:QNe,emits:eke,setup(t,{expose:o,emit:s}){const a=t,{t:l}=Fn(),d=Qe("image"),h=au(),v=U(()=>xg(Object.entries(h).filter(([X])=>/^(data-|on[A-Z])/i.test(X)||["id","style"].includes(X)))),g=u_({excludeListeners:!0,excludeKeys:U(()=>Object.keys(v.value))}),E=ee(),b=ee(!1),S=ee(!0),C=ee(!1),w=ee(),I=ee(),R=Vn&&"loading"in HTMLImageElement.prototype;let N;const O=U(()=>[d.e("inner"),L.value&&d.e("preview"),S.value&&d.is("loading")]),V=U(()=>{const{fit:X}=a;return Vn&&X?{objectFit:X}:{}}),L=U(()=>{const{previewSrcList:X}=a;return st(X)&&X.length>0}),D=U(()=>{const{previewSrcList:X,initialIndex:ie}=a;let se=ie;return ie>X.length-1&&(se=0),se}),M=U(()=>a.loading==="eager"?!1:!R&&a.loading==="lazy"||a.lazy),F=()=>{Vn&&(S.value=!0,b.value=!1,E.value=a.src)};function W(X){S.value=!1,b.value=!1,s("load",X)}function z(X){S.value=!1,b.value=!0,s("error",X)}function G(){TRe(w.value,I.value)&&(F(),Z())}const Y=eK(G,200,!0);async function te(){var X;if(!Vn)return;await Vt();const{scrollContainer:ie}=a;mi(ie)?I.value=ie:Mt(ie)&&ie!==""?I.value=(X=document.querySelector(ie))!=null?X:void 0:w.value&&(I.value=HN(w.value)),I.value&&(N=gr(I,"scroll",Y),setTimeout(()=>G(),100))}function Z(){!Vn||!I.value||!Y||(N==null||N(),I.value=void 0)}function fe(){L.value&&(C.value=!0,s("show"))}function Ee(){C.value=!1,s("close")}function ae(X){s("switch",X)}return ze(()=>a.src,()=>{M.value?(S.value=!0,b.value=!1,Z(),te()):F()}),dn(()=>{M.value?te():F()}),o({showPreview:fe}),(X,ie)=>($(),le("div",En({ref_key:"container",ref:w},p(v),{class:[p(d).b(),X.$attrs.class]}),[b.value?Ne(X.$slots,"error",{key:0},()=>[ue("div",{class:K(p(d).e("error"))},ot(p(l)("el.image.error")),3)]):($(),le(Ut,{key:1},[E.value!==void 0?($(),le("img",En({key:0},p(g),{src:E.value,loading:X.loading,style:p(V),class:p(O),crossorigin:X.crossorigin,onClick:fe,onLoad:W,onError:z}),null,16,["src","loading","crossorigin"])):De("v-if",!0),S.value?($(),le("div",{key:1,class:K(p(d).e("wrapper"))},[Ne(X.$slots,"placeholder",{},()=>[ue("div",{class:K(p(d).e("placeholder"))},null,2)])],2)):De("v-if",!0)],64)),p(L)?($(),le(Ut,{key:2},[C.value?($(),Ve(p(_z),{key:0,"z-index":X.zIndex,"initial-index":p(D),infinite:X.infinite,"zoom-rate":X.zoomRate,"min-scale":X.minScale,"max-scale":X.maxScale,"show-progress":X.showProgress,"url-list":X.previewSrcList,crossorigin:X.crossorigin,"hide-on-click-modal":X.hideOnClickModal,teleported:X.previewTeleported,"close-on-press-escape":X.closeOnPressEscape,onClose:Ee,onSwitch:ae},{progress:Ce(se=>[Ne(X.$slots,"progress",sa(ul(se)))]),toolbar:Ce(se=>[Ne(X.$slots,"toolbar",sa(ul(se)))]),default:Ce(()=>[X.$slots.viewer?($(),le("div",{key:0},[Ne(X.$slots,"viewer")])):De("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):De("v-if",!0)],64)):De("v-if",!0)],16))}});var rke=dt(nke,[["__file","image.vue"]]);const oke=rn(rke),ske=ut({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Ho,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:t=>t===null||$t(t)||["min","max"].includes(t),default:null},name:String,placeholder:String,precision:{type:Number,validator:t=>t>=0&&t===Number.parseInt(`${t}`,10)},validateEvent:{type:Boolean,default:!0},...Cs(["ariaLabel"])}),ike={[yn]:(t,o)=>o!==t,blur:t=>t instanceof FocusEvent,focus:t=>t instanceof FocusEvent,[cs]:t=>$t(t)||Qo(t),[Jt]:t=>$t(t)||Qo(t)},ake=me({name:"ElInputNumber"}),cke=me({...ake,props:ske,emits:ike,setup(t,{expose:o,emit:s}){const a=t,{t:l}=Fn(),d=Qe("input-number"),h=ee(),v=er({currentValue:a.modelValue,userInput:null}),{formItem:g}=Vs(),E=U(()=>$t(a.modelValue)&&a.modelValue<=a.min),b=U(()=>$t(a.modelValue)&&a.modelValue>=a.max),S=U(()=>{const ae=O(a.step);return Xn(a.precision)?Math.max(O(a.modelValue),ae):(ae>a.precision,a.precision)}),C=U(()=>a.controls&&a.controlsPosition==="right"),w=xo(),I=Fs(),R=U(()=>{if(v.userInput!==null)return v.userInput;let ae=v.currentValue;if(Qo(ae))return"";if($t(ae)){if(Number.isNaN(ae))return"";Xn(a.precision)||(ae=ae.toFixed(a.precision))}return ae}),N=(ae,X)=>{if(Xn(X)&&(X=S.value),X===0)return Math.round(ae);let ie=String(ae);const se=ie.indexOf(".");if(se===-1||!ie.replace(".","").split("")[se+X])return ae;const be=ie.length;return ie.charAt(be-1)==="5"&&(ie=`${ie.slice(0,Math.max(0,be-1))}6`),Number.parseFloat(Number(ie).toFixed(X))},O=ae=>{if(Qo(ae))return 0;const X=ae.toString(),ie=X.indexOf(".");let se=0;return ie!==-1&&(se=X.length-ie-1),se},V=(ae,X=1)=>$t(ae)?N(ae+a.step*X):v.currentValue,L=()=>{if(a.readonly||I.value||b.value)return;const ae=Number(R.value)||0,X=V(ae);F(X),s(cs,v.currentValue),fe()},D=()=>{if(a.readonly||I.value||E.value)return;const ae=Number(R.value)||0,X=V(ae,-1);F(X),s(cs,v.currentValue),fe()},M=(ae,X)=>{const{max:ie,min:se,step:J,precision:pe,stepStrictly:be,valueOnClear:Ae}=a;ie<se&&qo("InputNumber","min should not be greater than max.");let _e=Number(ae);if(Qo(ae)||Number.isNaN(_e))return null;if(ae===""){if(Ae===null)return null;_e=Mt(Ae)?{min:se,max:ie}[Ae]:Ae}return be&&(_e=N(Math.round(_e/J)*J,pe),_e!==ae&&X&&s(Jt,_e)),Xn(pe)||(_e=N(_e,pe)),(_e>ie||_e<se)&&(_e=_e>ie?ie:se,X&&s(Jt,_e)),_e},F=(ae,X=!0)=>{var ie;const se=v.currentValue,J=M(ae);if(!X){s(Jt,J);return}se===J&&ae||(v.userInput=null,s(Jt,J),se!==J&&s(yn,J,se),a.validateEvent&&((ie=g==null?void 0:g.validate)==null||ie.call(g,"change").catch(pe=>void 0)),v.currentValue=J)},W=ae=>{v.userInput=ae;const X=ae===""?null:Number(ae);s(cs,X),F(X,!1)},z=ae=>{const X=ae!==""?Number(ae):"";($t(X)&&!Number.isNaN(X)||ae==="")&&F(X),fe(),v.userInput=null},G=()=>{var ae,X;(X=(ae=h.value)==null?void 0:ae.focus)==null||X.call(ae)},Y=()=>{var ae,X;(X=(ae=h.value)==null?void 0:ae.blur)==null||X.call(ae)},te=ae=>{s("focus",ae)},Z=ae=>{var X,ie;v.userInput=null,_0()&&v.currentValue===null&&((X=h.value)!=null&&X.input)&&(h.value.input.value=""),s("blur",ae),a.validateEvent&&((ie=g==null?void 0:g.validate)==null||ie.call(g,"blur").catch(se=>void 0))},fe=()=>{v.currentValue!==a.modelValue&&(v.currentValue=a.modelValue)},Ee=ae=>{document.activeElement===ae.target&&ae.preventDefault()};return ze(()=>a.modelValue,(ae,X)=>{const ie=M(ae,!0);v.userInput===null&&ie!==X&&(v.currentValue=ie)},{immediate:!0}),dn(()=>{var ae;const{min:X,max:ie,modelValue:se}=a,J=(ae=h.value)==null?void 0:ae.input;if(J.setAttribute("role","spinbutton"),Number.isFinite(ie)?J.setAttribute("aria-valuemax",String(ie)):J.removeAttribute("aria-valuemax"),Number.isFinite(X)?J.setAttribute("aria-valuemin",String(X)):J.removeAttribute("aria-valuemin"),J.setAttribute("aria-valuenow",v.currentValue||v.currentValue===0?String(v.currentValue):""),J.setAttribute("aria-disabled",String(I.value)),!$t(se)&&se!=null){let pe=Number(se);Number.isNaN(pe)&&(pe=null),s(Jt,pe)}J.addEventListener("wheel",Ee,{passive:!1})}),wc(()=>{var ae,X;const ie=(ae=h.value)==null?void 0:ae.input;ie==null||ie.setAttribute("aria-valuenow",`${(X=v.currentValue)!=null?X:""}`)}),o({focus:G,blur:Y}),(ae,X)=>($(),le("div",{class:K([p(d).b(),p(d).m(p(w)),p(d).is("disabled",p(I)),p(d).is("without-controls",!ae.controls),p(d).is("controls-right",p(C))]),onDragstart:Gt(()=>{},["prevent"])},[ae.controls?ln(($(),le("span",{key:0,role:"button","aria-label":p(l)("el.inputNumber.decrease"),class:K([p(d).e("decrease"),p(d).is("disabled",p(E))]),onKeydown:Cr(D,["enter"])},[Ne(ae.$slots,"decrease-icon",{},()=>[ge(p(Dt),null,{default:Ce(()=>[p(C)?($(),Ve(p(uu),{key:0})):($(),Ve(p(kye),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[p(RS),D]]):De("v-if",!0),ae.controls?ln(($(),le("span",{key:1,role:"button","aria-label":p(l)("el.inputNumber.increase"),class:K([p(d).e("increase"),p(d).is("disabled",p(b))]),onKeydown:Cr(L,["enter"])},[Ne(ae.$slots,"increase-icon",{},()=>[ge(p(Dt),null,{default:Ce(()=>[p(C)?($(),Ve(p(KN),{key:0})):($(),Ve(p(EK),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[p(RS),L]]):De("v-if",!0),ge(p(ei),{id:ae.id,ref_key:"input",ref:h,type:"number",step:ae.step,"model-value":p(R),placeholder:ae.placeholder,readonly:ae.readonly,disabled:p(I),size:p(w),max:ae.max,min:ae.min,name:ae.name,"aria-label":ae.ariaLabel,"validate-event":!1,onKeydown:[Cr(Gt(L,["prevent"]),["up"]),Cr(Gt(D,["prevent"]),["down"])],onBlur:Z,onFocus:te,onInput:W,onChange:z},fa({_:2},[ae.$slots.prefix?{name:"prefix",fn:Ce(()=>[Ne(ae.$slots,"prefix")])}:void 0,ae.$slots.suffix?{name:"suffix",fn:Ce(()=>[Ne(ae.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var lke=dt(cke,[["__file","input-number.vue"]]);const Ez=rn(lke),uke=ut({modelValue:{type:Re(Array)},max:Number,tagType:{...nu.type,default:"info"},tagEffect:nu.effect,trigger:{type:Re(String),default:Ct.enter},draggable:{type:Boolean,default:!1},size:Ho,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),dke={[Jt]:t=>st(t)||Xn(t),[yn]:t=>st(t)||Xn(t),[cs]:t=>Mt(t),"add-tag":t=>Mt(t),"remove-tag":t=>Mt(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0};function hke({props:t,emit:o,formItem:s}){const a=Fs(),l=xo(),d=Mr(),h=ee(),v=U(()=>["small"].includes(l.value)?"small":"default"),g=U(()=>{var G;return(G=t.modelValue)!=null&&G.length?void 0:t.placeholder}),E=U(()=>!(t.readonly||a.value)),b=U(()=>{var G,Y;return Xn(t.max)?!1:((Y=(G=t.modelValue)==null?void 0:G.length)!=null?Y:0)>=t.max}),S=G=>{if(b.value){h.value=void 0;return}M.value||o(cs,G.target.value)},C=G=>{var Y;if(!M.value)switch(G.code){case t.trigger:G.preventDefault(),G.stopPropagation(),w();break;case Ct.numpadEnter:t.trigger===Ct.enter&&(G.preventDefault(),G.stopPropagation(),w());break;case Ct.backspace:!h.value&&((Y=t.modelValue)!=null&&Y.length)&&(G.preventDefault(),G.stopPropagation(),I(t.modelValue.length-1));break}},w=()=>{var G,Y;const te=(G=h.value)==null?void 0:G.trim();if(!te||b.value)return;const Z=[...(Y=t.modelValue)!=null?Y:[],te];o(Jt,Z),o(yn,Z),o("add-tag",te),h.value=void 0},I=G=>{var Y;const te=((Y=t.modelValue)!=null?Y:[]).slice(),[Z]=te.splice(G,1);o(Jt,te),o(yn,te),o("remove-tag",Z)},R=()=>{h.value=void 0,o(Jt,void 0),o(yn,void 0),o("clear")},N=(G,Y,te)=>{var Z;const fe=((Z=t.modelValue)!=null?Z:[]).slice(),[Ee]=fe.splice(G,1),ae=Y>G&&te==="before"?-1:Y<G&&te==="after"?1:0;fe.splice(Y+ae,0,Ee),o(Jt,fe),o(yn,fe)},O=()=>{var G;(G=d.value)==null||G.focus()},V=()=>{var G;(G=d.value)==null||G.blur()},{wrapperRef:L,isFocused:D}=_d(d,{beforeFocus(){return a.value},afterBlur(){var G;t.saveOnBlur?w():h.value=void 0,t.validateEvent&&((G=s==null?void 0:s.validate)==null||G.call(s,"blur").catch(Y=>void 0))}}),{isComposing:M,handleCompositionStart:F,handleCompositionUpdate:W,handleCompositionEnd:z}=d_({afterComposition:S});return ze(()=>t.modelValue,()=>{var G;t.validateEvent&&((G=s==null?void 0:s.validate)==null||G.call(s,yn).catch(Y=>void 0))}),{inputRef:d,wrapperRef:L,isFocused:D,isComposing:M,inputValue:h,size:l,tagSize:v,placeholder:g,closable:E,disabled:a,inputLimit:b,handleDragged:N,handleInput:S,handleKeydown:C,handleAddTag:w,handleRemoveTag:I,handleClear:R,handleCompositionStart:F,handleCompositionUpdate:W,handleCompositionEnd:z,focus:O,blur:V}}function fke(){const t=ee(!1);return{hovering:t,handleMouseEnter:()=>{t.value=!0},handleMouseLeave:()=>{t.value=!1}}}function Nk(){const t=Mr(),o=ee(0),s=11,a=U(()=>({minWidth:`${Math.max(o.value,s)}px`}));return co(t,()=>{var d,h;o.value=(h=(d=t.value)==null?void 0:d.getBoundingClientRect().width)!=null?h:0}),{calculatorRef:t,calculatorWidth:o,inputStyle:a}}function pke({wrapperRef:t,handleDragged:o,afterDragged:s}){const a=Qe("input-tag"),l=Mr(),d=ee(!1);let h,v,g,E;function b(I){return`.${a.e("inner")} .${a.namespace.value}-tag:nth-child(${I+1})`}function S(I,R){h=R,v=t.value.querySelector(b(R)),v&&(v.style.opacity="0.5"),I.dataTransfer.effectAllowed="move"}function C(I,R){if(g=R,I.preventDefault(),I.dataTransfer.dropEffect="move",Xn(h)||h===R){d.value=!1;return}const N=t.value.querySelector(b(R)).getBoundingClientRect(),O=h+1!==R,V=h-1!==R,L=I.clientX-N.left,D=O?V?.5:1:-1,M=V?O?.5:0:1;L<=N.width*D?E="before":L>N.width*M?E="after":E=void 0;const F=t.value.querySelector(`.${a.e("inner")}`),W=F.getBoundingClientRect(),z=Number.parseFloat(ql(F,"gap"))/2,G=N.top-W.top;let Y=-9999;if(E==="before")Y=Math.max(N.left-W.left-z,Math.floor(-z/2));else if(E==="after"){const te=N.right-W.left;Y=te+(W.width===te?Math.floor(z/2):z)}fK(l.value,{top:`${G}px`,left:`${Y}px`}),d.value=!!E}function w(I){I.preventDefault(),v&&(v.style.opacity=""),E&&!Xn(h)&&!Xn(g)&&h!==g&&o(h,g,E),d.value=!1,h=void 0,v=null,g=void 0,E=void 0,s==null||s()}return{dropIndicatorRef:l,showDropIndicator:d,handleDragStart:S,handleDragOver:C,handleDragEnd:w}}function mke({props:t,isFocused:o,hovering:s,disabled:a,inputValue:l,size:d,validateState:h,validateIcon:v,needStatusIcon:g}){const E=au(),b=Jo(),S=Qe("input-tag"),C=Qe("input"),w=U(()=>[S.b(),S.is("focused",o.value),S.is("hovering",s.value),S.is("disabled",a.value),S.m(d.value),S.e("wrapper"),E.class]),I=U(()=>[E.style]),R=U(()=>{var V,L;return[S.e("inner"),S.is("draggable",t.draggable),S.is("left-space",!((V=t.modelValue)!=null&&V.length)&&!b.prefix),S.is("right-space",!((L=t.modelValue)!=null&&L.length)&&!O.value)]}),N=U(()=>{var V;return t.clearable&&!a.value&&!t.readonly&&(((V=t.modelValue)==null?void 0:V.length)||l.value)&&(o.value||s.value)}),O=U(()=>b.suffix||N.value||h.value&&v.value&&g.value);return{ns:S,nsInput:C,containerKls:w,containerStyle:I,innerKls:R,showClear:N,showSuffix:O}}const vke=me({name:"ElInputTag",inheritAttrs:!1}),gke=me({...vke,props:uke,emits:dke,setup(t,{expose:o,emit:s}){const a=t,l=u_(),d=Jo(),{form:h,formItem:v}=Vs(),{inputId:g}=Ka(a,{formItemContext:v}),E=U(()=>{var ce;return(ce=h==null?void 0:h.statusIcon)!=null?ce:!1}),b=U(()=>(v==null?void 0:v.validateState)||""),S=U(()=>b.value&&g0[b.value]),{inputRef:C,wrapperRef:w,isFocused:I,inputValue:R,size:N,tagSize:O,placeholder:V,closable:L,disabled:D,handleDragged:M,handleInput:F,handleKeydown:W,handleRemoveTag:z,handleClear:G,handleCompositionStart:Y,handleCompositionUpdate:te,handleCompositionEnd:Z,focus:fe,blur:Ee}=hke({props:a,emit:s,formItem:v}),{hovering:ae,handleMouseEnter:X,handleMouseLeave:ie}=fke(),{calculatorRef:se,inputStyle:J}=Nk(),{dropIndicatorRef:pe,showDropIndicator:be,handleDragStart:Ae,handleDragOver:_e,handleDragEnd:Me}=pke({wrapperRef:w,handleDragged:M,afterDragged:fe}),{ns:Fe,nsInput:Le,containerKls:Pe,containerStyle:He,innerKls:We,showClear:yt,showSuffix:it}=mke({props:a,hovering:ae,isFocused:I,inputValue:R,disabled:D,size:N,validateState:b,validateIcon:S,needStatusIcon:E});return o({focus:fe,blur:Ee}),(ce,Se)=>($(),le("div",{ref_key:"wrapperRef",ref:w,class:K(p(Pe)),style:jt(p(He)),onMouseenter:p(X),onMouseleave:p(ie)},[p(d).prefix?($(),le("div",{key:0,class:K(p(Fe).e("prefix"))},[Ne(ce.$slots,"prefix")],2)):De("v-if",!0),ue("div",{class:K(p(We))},[($(!0),le(Ut,null,Cn(ce.modelValue,(je,tt)=>($(),Ve(p(Jp),{key:tt,size:p(O),closable:p(L),type:ce.tagType,effect:ce.tagEffect,draggable:p(L)&&ce.draggable,"disable-transitions":"",onClose:et=>p(z)(tt),onDragstart:et=>p(Ae)(et,tt),onDragover:et=>p(_e)(et,tt),onDragend:p(Me),onDrop:Gt(()=>{},["stop"])},{default:Ce(()=>[Ne(ce.$slots,"tag",{value:je,index:tt},()=>[bn(ot(je),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),ue("div",{class:K(p(Fe).e("input-wrapper"))},[ln(ue("input",En({id:p(g),ref_key:"inputRef",ref:C,"onUpdate:modelValue":je=>xr(R)?R.value=je:null},p(l),{type:"text",minlength:ce.minlength,maxlength:ce.maxlength,disabled:p(D),readonly:ce.readonly,autocomplete:ce.autocomplete,tabindex:ce.tabindex,placeholder:p(V),autofocus:ce.autofocus,ariaLabel:ce.ariaLabel,class:p(Fe).e("input"),style:p(J),onCompositionstart:p(Y),onCompositionupdate:p(te),onCompositionend:p(Z),onInput:p(F),onKeydown:p(W)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[o0,p(R)]]),ue("span",{ref_key:"calculatorRef",ref:se,"aria-hidden":"true",class:K(p(Fe).e("input-calculator")),textContent:ot(p(R))},null,10,["textContent"])],2),ln(ue("div",{ref_key:"dropIndicatorRef",ref:pe,class:K(p(Fe).e("drop-indicator"))},null,2),[[Wn,p(be)]])],2),p(it)?($(),le("div",{key:1,class:K(p(Fe).e("suffix"))},[Ne(ce.$slots,"suffix"),p(yt)?($(),Ve(p(Dt),{key:0,class:K([p(Fe).e("icon"),p(Fe).e("clear")]),onMousedown:Gt(p(pr),["prevent"]),onClick:p(G)},{default:Ce(()=>[ge(p(du))]),_:1},8,["class","onMousedown","onClick"])):De("v-if",!0),p(b)&&p(S)&&p(E)?($(),Ve(p(Dt),{key:1,class:K([p(Le).e("icon"),p(Le).e("validateIcon"),p(Le).is("loading",p(b)==="validating")])},{default:Ce(()=>[($(),Ve(gn(p(S))))]),_:1},8,["class"])):De("v-if",!0)],2)):De("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var _ke=dt(gke,[["__file","input-tag.vue"]]);const Eke=rn(_ke),yke=ut({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:yr}}),bke={click:t=>t instanceof MouseEvent},Ske=me({name:"ElLink"}),Tke=me({...Ske,props:yke,emits:bke,setup(t,{emit:o}){const s=t,a=Qe("link"),l=U(()=>[a.b(),a.m(s.type),a.is("disabled",s.disabled),a.is("underline",s.underline&&!s.disabled)]);function d(h){s.disabled||o("click",h)}return(h,v)=>($(),le("a",{class:K(p(l)),href:h.disabled||!h.href?void 0:h.href,target:h.disabled||!h.href?void 0:h.target,onClick:d},[h.icon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(h.icon)))]),_:1})):De("v-if",!0),h.$slots.default?($(),le("span",{key:1,class:K(p(a).e("inner"))},[Ne(h.$slots,"default")],2)):De("v-if",!0),h.$slots.icon?Ne(h.$slots,"icon",{key:2}):De("v-if",!0)],10,["href","target"]))}});var Cke=dt(Tke,[["__file","link.vue"]]);const wke=rn(Cke);let Rke=class{constructor(o,s){this.parent=o,this.domNode=s,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(o){o===this.subMenuItems.length?o=0:o<0&&(o=this.subMenuItems.length-1),this.subMenuItems[o].focus(),this.subIndex=o}addListeners(){const o=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,s=>{s.addEventListener("keydown",a=>{let l=!1;switch(a.code){case Ct.down:{this.gotoSubIndex(this.subIndex+1),l=!0;break}case Ct.up:{this.gotoSubIndex(this.subIndex-1),l=!0;break}case Ct.tab:{Hb(o,"mouseleave");break}case Ct.enter:case Ct.numpadEnter:case Ct.space:{l=!0,a.currentTarget.click();break}}return l&&(a.preventDefault(),a.stopPropagation()),!1})})}},Ike=class{constructor(o,s){this.domNode=o,this.submenu=null,this.submenu=null,this.init(s)}init(o){this.domNode.setAttribute("tabindex","0");const s=this.domNode.querySelector(`.${o}-menu`);s&&(this.submenu=new Rke(this,s)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",o=>{let s=!1;switch(o.code){case Ct.down:{Hb(o.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),s=!0;break}case Ct.up:{Hb(o.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),s=!0;break}case Ct.tab:{Hb(o.currentTarget,"mouseleave");break}case Ct.enter:case Ct.numpadEnter:case Ct.space:{s=!0,o.currentTarget.click();break}}s&&o.preventDefault()})}},Ake=class{constructor(o,s){this.domNode=o,this.init(s)}init(o){const s=this.domNode.childNodes;Array.from(s).forEach(a=>{a.nodeType===1&&new Ike(a,o)})}};const Oke=me({name:"ElMenuCollapseTransition"}),Nke=me({...Oke,setup(t){const o=Qe("menu"),s={onBeforeEnter:a=>a.style.opacity="0.2",onEnter(a,l){Ua(a,`${o.namespace.value}-opacity-transition`),a.style.opacity="1",l()},onAfterEnter(a){ti(a,`${o.namespace.value}-opacity-transition`),a.style.opacity=""},onBeforeLeave(a){a.dataset||(a.dataset={}),Fi(a,o.m("collapse"))?(ti(a,o.m("collapse")),a.dataset.oldOverflow=a.style.overflow,a.dataset.scrollWidth=a.clientWidth.toString(),Ua(a,o.m("collapse"))):(Ua(a,o.m("collapse")),a.dataset.oldOverflow=a.style.overflow,a.dataset.scrollWidth=a.clientWidth.toString(),ti(a,o.m("collapse"))),a.style.width=`${a.scrollWidth}px`,a.style.overflow="hidden"},onLeave(a){Ua(a,"horizontal-collapse-transition"),a.style.width=`${a.dataset.scrollWidth}px`}};return(a,l)=>($(),Ve(hs,En({mode:"out-in"},p(s)),{default:Ce(()=>[Ne(a.$slots,"default")]),_:3},16))}});var kke=dt(Nke,[["__file","menu-collapse-transition.vue"]]);function yz(t,o){const s=U(()=>{let l=t.parent;const d=[o.value];for(;l.type.name!=="ElMenu";)l.props.index&&d.unshift(l.props.index),l=l.parent;return d});return{parentMenu:U(()=>{let l=t.parent;for(;l&&!["ElMenu","ElSubMenu"].includes(l.type.name);)l=l.parent;return l}),indexPath:s}}function Pke(t){return U(()=>{const s=t.backgroundColor;return s?new nG(s).shade(20).toString():""})}const bz=(t,o)=>{const s=Qe("menu");return U(()=>s.cssVarBlock({"text-color":t.textColor||"","hover-text-color":t.textColor||"","bg-color":t.backgroundColor||"","hover-bg-color":Pke(t).value||"","active-color":t.activeTextColor||"",level:`${o}`}))},Dke=ut({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:yr},expandOpenIcon:{type:yr},collapseCloseIcon:{type:yr},collapseOpenIcon:{type:yr}}),pA="ElSubMenu";var kk=me({name:pA,props:Dke,setup(t,{slots:o,expose:s}){const a=mn(),{indexPath:l,parentMenu:d}=yz(a,U(()=>t.index)),h=Qe("menu"),v=Qe("sub-menu"),g=It("rootMenu");g||qo(pA,"can not inject root menu");const E=It(`subMenu:${d.value.uid}`);E||qo(pA,"can not inject sub menu");const b=ee({}),S=ee({});let C;const w=ee(!1),I=ee(),R=ee(),N=U(()=>z.value==="horizontal"&&V.value?"bottom-start":"right-start"),O=U(()=>z.value==="horizontal"&&V.value||z.value==="vertical"&&!g.props.collapse?t.expandCloseIcon&&t.expandOpenIcon?F.value?t.expandOpenIcon:t.expandCloseIcon:uu:t.collapseCloseIcon&&t.collapseOpenIcon?F.value?t.collapseOpenIcon:t.collapseCloseIcon:vi),V=U(()=>E.level===0),L=U(()=>{const be=t.teleported;return be===void 0?V.value:be}),D=U(()=>g.props.collapse?`${h.namespace.value}-zoom-in-left`:`${h.namespace.value}-zoom-in-top`),M=U(()=>z.value==="horizontal"&&V.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),F=U(()=>g.openedMenus.includes(t.index)),W=U(()=>[...Object.values(b.value),...Object.values(S.value)].some(({active:be})=>be)),z=U(()=>g.props.mode),G=U(()=>g.props.persistent),Y=er({index:t.index,indexPath:l,active:W}),te=bz(g.props,E.level+1),Z=U(()=>{var be;return(be=t.popperOffset)!=null?be:g.props.popperOffset}),fe=U(()=>{var be;return(be=t.popperClass)!=null?be:g.props.popperClass}),Ee=U(()=>{var be;return(be=t.showTimeout)!=null?be:g.props.showTimeout}),ae=U(()=>{var be;return(be=t.hideTimeout)!=null?be:g.props.hideTimeout}),X=()=>{var be,Ae,_e;return(_e=(Ae=(be=R.value)==null?void 0:be.popperRef)==null?void 0:Ae.popperInstanceRef)==null?void 0:_e.destroy()},ie=be=>{be||X()},se=()=>{g.props.menuTrigger==="hover"&&g.props.mode==="horizontal"||g.props.collapse&&g.props.mode==="vertical"||t.disabled||g.handleSubMenuClick({index:t.index,indexPath:l.value,active:W.value})},J=(be,Ae=Ee.value)=>{var _e;if(be.type!=="focus"){if(g.props.menuTrigger==="click"&&g.props.mode==="horizontal"||!g.props.collapse&&g.props.mode==="vertical"||t.disabled){E.mouseInChild.value=!0;return}E.mouseInChild.value=!0,C==null||C(),{stop:C}=Mh(()=>{g.openMenu(t.index,l.value)},Ae),L.value&&((_e=d.value.vnode.el)==null||_e.dispatchEvent(new MouseEvent("mouseenter")))}},pe=(be=!1)=>{var Ae;if(g.props.menuTrigger==="click"&&g.props.mode==="horizontal"||!g.props.collapse&&g.props.mode==="vertical"){E.mouseInChild.value=!1;return}C==null||C(),E.mouseInChild.value=!1,{stop:C}=Mh(()=>!w.value&&g.closeMenu(t.index,l.value),ae.value),L.value&&be&&((Ae=E.handleMouseleave)==null||Ae.call(E,!0))};ze(()=>g.props.collapse,be=>ie(!!be));{const be=_e=>{S.value[_e.index]=_e},Ae=_e=>{delete S.value[_e.index]};wn(`subMenu:${a.uid}`,{addSubMenu:be,removeSubMenu:Ae,handleMouseleave:pe,mouseInChild:w,level:E.level+1})}return s({opened:F}),dn(()=>{g.addSubMenu(Y),E.addSubMenu(Y)}),Rr(()=>{E.removeSubMenu(Y),g.removeSubMenu(Y)}),()=>{var be;const Ae=[(be=o.title)==null?void 0:be.call(o),Ht(Dt,{class:v.e("icon-arrow"),style:{transform:F.value?t.expandCloseIcon&&t.expandOpenIcon||t.collapseCloseIcon&&t.collapseOpenIcon&&g.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Mt(O.value)?Ht(a.appContext.components[O.value]):Ht(O.value)})],_e=g.isMenuPopup?Ht(Us,{ref:R,visible:F.value,effect:"light",pure:!0,offset:Z.value,showArrow:!1,persistent:G.value,popperClass:fe.value,placement:N.value,teleported:L.value,fallbackPlacements:M.value,transition:D.value,gpuAcceleration:!1},{content:()=>{var Me;return Ht("div",{class:[h.m(z.value),h.m("popup-container"),fe.value],onMouseenter:Fe=>J(Fe,100),onMouseleave:()=>pe(!0),onFocus:Fe=>J(Fe,100)},[Ht("ul",{class:[h.b(),h.m("popup"),h.m(`popup-${N.value}`)],style:te.value},[(Me=o.default)==null?void 0:Me.call(o)])])},default:()=>Ht("div",{class:v.e("title"),onClick:se},Ae)}):Ht(Ut,{},[Ht("div",{class:v.e("title"),ref:I,onClick:se},Ae),Ht(S0,{},{default:()=>{var Me;return ln(Ht("ul",{role:"menu",class:[h.b(),h.m("inline")],style:te.value},[(Me=o.default)==null?void 0:Me.call(o)]),[[Wn,F.value]])}})]);return Ht("li",{class:[v.b(),v.is("active",W.value),v.is("opened",F.value),v.is("disabled",t.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:F.value,onMouseenter:J,onMouseleave:()=>pe(),onFocus:J},[_e])}}});const Lke=ut({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:Re(Array),default:()=>lo([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:yr,default:()=>Lye},popperEffect:{type:Re(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},persistent:{type:Boolean,default:!0}}),mA=t=>st(t)&&t.every(o=>Mt(o)),Mke={close:(t,o)=>Mt(t)&&mA(o),open:(t,o)=>Mt(t)&&mA(o),select:(t,o,s,a)=>Mt(t)&&mA(o)&&fn(s)&&(a===void 0||a instanceof Promise)};var xke=me({name:"ElMenu",props:Lke,emits:Mke,setup(t,{emit:o,slots:s,expose:a}){const l=mn(),d=l.appContext.config.globalProperties.$router,h=ee(),v=Qe("menu"),g=Qe("sub-menu"),E=ee(-1),b=ee(t.defaultOpeneds&&!t.collapse?t.defaultOpeneds.slice(0):[]),S=ee(t.defaultActive),C=ee({}),w=ee({}),I=U(()=>t.mode==="horizontal"||t.mode==="vertical"&&t.collapse),R=()=>{const ae=S.value&&C.value[S.value];if(!ae||t.mode==="horizontal"||t.collapse)return;ae.indexPath.forEach(ie=>{const se=w.value[ie];se&&N(ie,se.indexPath)})},N=(ae,X)=>{b.value.includes(ae)||(t.uniqueOpened&&(b.value=b.value.filter(ie=>X.includes(ie))),b.value.push(ae),o("open",ae,X))},O=ae=>{const X=b.value.indexOf(ae);X!==-1&&b.value.splice(X,1)},V=(ae,X)=>{O(ae),o("close",ae,X)},L=({index:ae,indexPath:X})=>{b.value.includes(ae)?V(ae,X):N(ae,X)},D=ae=>{(t.mode==="horizontal"||t.collapse)&&(b.value=[]);const{index:X,indexPath:ie}=ae;if(!(Qo(X)||Qo(ie)))if(t.router&&d){const se=ae.route||X,J=d.push(se).then(pe=>(pe||(S.value=X),pe));o("select",X,ie,{index:X,indexPath:ie,route:se},J)}else S.value=X,o("select",X,ie,{index:X,indexPath:ie})},M=ae=>{var X;const ie=C.value,se=ie[ae]||S.value&&ie[S.value]||ie[t.defaultActive];S.value=(X=se==null?void 0:se.index)!=null?X:ae},F=ae=>{const X=getComputedStyle(ae),ie=Number.parseInt(X.marginLeft,10),se=Number.parseInt(X.marginRight,10);return ae.offsetWidth+ie+se||0},W=()=>{var ae,X;if(!h.value)return-1;const ie=Array.from((X=(ae=h.value)==null?void 0:ae.childNodes)!=null?X:[]).filter(Fe=>Fe.nodeName!=="#text"||Fe.nodeValue),se=64,J=getComputedStyle(h.value),pe=Number.parseInt(J.paddingLeft,10),be=Number.parseInt(J.paddingRight,10),Ae=h.value.clientWidth-pe-be;let _e=0,Me=0;return ie.forEach((Fe,Le)=>{Fe.nodeName!=="#comment"&&(_e+=F(Fe),_e<=Ae-se&&(Me=Le+1))}),Me===ie.length?-1:Me},z=ae=>w.value[ae].indexPath,G=(ae,X=33.34)=>{let ie;return()=>{ie&&clearTimeout(ie),ie=setTimeout(()=>{ae()},X)}};let Y=!0;const te=()=>{if(E.value===W())return;const ae=()=>{E.value=-1,Vt(()=>{E.value=W()})};Y?ae():G(ae)(),Y=!1};ze(()=>t.defaultActive,ae=>{C.value[ae]||(S.value=""),M(ae)}),ze(()=>t.collapse,ae=>{ae&&(b.value=[])}),ze(C.value,R);let Z;Ms(()=>{t.mode==="horizontal"&&t.ellipsis?Z=co(h,te).stop:Z==null||Z()});const fe=ee(!1);{const ae=J=>{w.value[J.index]=J},X=J=>{delete w.value[J.index]};wn("rootMenu",er({props:t,openedMenus:b,items:C,subMenus:w,activeIndex:S,isMenuPopup:I,addMenuItem:J=>{C.value[J.index]=J},removeMenuItem:J=>{delete C.value[J.index]},addSubMenu:ae,removeSubMenu:X,openMenu:N,closeMenu:V,handleMenuItemClick:D,handleSubMenuClick:L})),wn(`subMenu:${l.uid}`,{addSubMenu:ae,removeSubMenu:X,mouseInChild:fe,level:0})}dn(()=>{t.mode==="horizontal"&&new Ake(l.vnode.el,v.namespace.value)}),a({open:X=>{const{indexPath:ie}=w.value[X];ie.forEach(se=>N(se,ie))},close:O,handleResize:te});const Ee=bz(t,0);return()=>{var ae,X;let ie=(X=(ae=s.default)==null?void 0:ae.call(s))!=null?X:[];const se=[];if(t.mode==="horizontal"&&h.value){const be=Jl(ie),Ae=E.value===-1?be:be.slice(0,E.value),_e=E.value===-1?[]:be.slice(E.value);_e!=null&&_e.length&&t.ellipsis&&(ie=Ae,se.push(Ht(kk,{index:"sub-menu-more",class:g.e("hide-arrow"),popperOffset:t.popperOffset},{title:()=>Ht(Dt,{class:g.e("icon-more")},{default:()=>Ht(t.ellipsisIcon)}),default:()=>_e})))}const J=t.closeOnClickOutside?[[ru,()=>{b.value.length&&(fe.value||(b.value.forEach(be=>o("close",be,z(be))),b.value=[]))}]]:[],pe=ln(Ht("ul",{key:String(t.collapse),role:"menubar",ref:h,style:Ee.value,class:{[v.b()]:!0,[v.m(t.mode)]:!0,[v.m("collapse")]:t.collapse}},[...ie,...se]),J);return t.collapseTransition&&t.mode==="vertical"?Ht(kke,()=>pe):pe}}});const Uke=ut({index:{type:Re([String,null]),default:null},route:{type:Re([String,Object])},disabled:Boolean}),Vke={click:t=>Mt(t.index)&&st(t.indexPath)},gO="ElMenuItem",Fke=me({name:gO}),Bke=me({...Fke,props:Uke,emits:Vke,setup(t,{expose:o,emit:s}){const a=t,l=mn(),d=It("rootMenu"),h=Qe("menu"),v=Qe("menu-item");d||qo(gO,"can not inject root menu");const{parentMenu:g,indexPath:E}=yz(l,lr(a,"index")),b=It(`subMenu:${g.value.uid}`);b||qo(gO,"can not inject sub menu");const S=U(()=>a.index===d.activeIndex),C=er({index:a.index,indexPath:E,active:S}),w=()=>{a.disabled||(d.handleMenuItemClick({index:a.index,indexPath:E.value,route:a.route}),s("click",C))};return dn(()=>{b.addSubMenu(C),d.addMenuItem(C)}),Rr(()=>{b.removeSubMenu(C),d.removeMenuItem(C)}),o({parentMenu:g,rootMenu:d,active:S,nsMenu:h,nsMenuItem:v,handleClick:w}),(I,R)=>($(),le("li",{class:K([p(v).b(),p(v).is("active",p(S)),p(v).is("disabled",I.disabled)]),role:"menuitem",tabindex:"-1",onClick:w},[p(g).type.name==="ElMenu"&&p(d).props.collapse&&I.$slots.title?($(),Ve(p(Us),{key:0,effect:p(d).props.popperEffect,placement:"right","fallback-placements":["left"],persistent:p(d).props.persistent},{content:Ce(()=>[Ne(I.$slots,"title")]),default:Ce(()=>[ue("div",{class:K(p(h).be("tooltip","trigger"))},[Ne(I.$slots,"default")],2)]),_:3},8,["effect","persistent"])):($(),le(Ut,{key:1},[Ne(I.$slots,"default"),Ne(I.$slots,"title")],64))],2))}});var Sz=dt(Bke,[["__file","menu-item.vue"]]);const jke={title:String},$ke=me({name:"ElMenuItemGroup"}),Hke=me({...$ke,props:jke,setup(t){const o=Qe("menu-item-group");return(s,a)=>($(),le("li",{class:K(p(o).b())},[ue("div",{class:K(p(o).e("title"))},[s.$slots.title?Ne(s.$slots,"title",{key:1}):($(),le(Ut,{key:0},[bn(ot(s.title),1)],64))],2),ue("ul",null,[Ne(s.$slots,"default")])],2))}});var Tz=dt(Hke,[["__file","menu-item-group.vue"]]);const Wke=rn(xke,{MenuItem:Sz,MenuItemGroup:Tz,SubMenu:kk}),Kke=uo(Sz),Gke=uo(Tz),zke=uo(kk),Yke=ut({icon:{type:yr,default:()=>oye},title:String,content:{type:String,default:""}}),qke={back:()=>!0},Xke=me({name:"ElPageHeader"}),Jke=me({...Xke,props:Yke,emits:qke,setup(t,{emit:o}){const{t:s}=Fn(),a=Qe("page-header");function l(){o("back")}return(d,h)=>($(),le("div",{class:K([p(a).b(),{[p(a).m("has-breadcrumb")]:!!d.$slots.breadcrumb,[p(a).m("has-extra")]:!!d.$slots.extra,[p(a).is("contentful")]:!!d.$slots.default}])},[d.$slots.breadcrumb?($(),le("div",{key:0,class:K(p(a).e("breadcrumb"))},[Ne(d.$slots,"breadcrumb")],2)):De("v-if",!0),ue("div",{class:K(p(a).e("header"))},[ue("div",{class:K(p(a).e("left"))},[ue("div",{class:K(p(a).e("back")),role:"button",tabindex:"0",onClick:l},[d.icon||d.$slots.icon?($(),le("div",{key:0,"aria-label":d.title||p(s)("el.pageHeader.title"),class:K(p(a).e("icon"))},[Ne(d.$slots,"icon",{},()=>[d.icon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(d.icon)))]),_:1})):De("v-if",!0)])],10,["aria-label"])):De("v-if",!0),ue("div",{class:K(p(a).e("title"))},[Ne(d.$slots,"title",{},()=>[bn(ot(d.title||p(s)("el.pageHeader.title")),1)])],2)],2),ge(p(iz),{direction:"vertical"}),ue("div",{class:K(p(a).e("content"))},[Ne(d.$slots,"content",{},()=>[bn(ot(d.content),1)])],2)],2),d.$slots.extra?($(),le("div",{key:0,class:K(p(a).e("extra"))},[Ne(d.$slots,"extra")],2)):De("v-if",!0)],2),d.$slots.default?($(),le("div",{key:1,class:K(p(a).e("main"))},[Ne(d.$slots,"default")],2)):De("v-if",!0)],2))}});var Zke=dt(Jke,[["__file","page-header.vue"]]);const Qke=rn(Zke),Cz=Symbol("elPaginationKey"),ePe=ut({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:yr}}),tPe={click:t=>t instanceof MouseEvent},nPe=me({name:"ElPaginationPrev"}),rPe=me({...nPe,props:ePe,emits:tPe,setup(t){const o=t,{t:s}=Fn(),a=U(()=>o.disabled||o.currentPage<=1);return(l,d)=>($(),le("button",{type:"button",class:"btn-prev",disabled:p(a),"aria-label":l.prevText||p(s)("el.pagination.prev"),"aria-disabled":p(a),onClick:h=>l.$emit("click",h)},[l.prevText?($(),le("span",{key:0},ot(l.prevText),1)):($(),Ve(p(Dt),{key:1},{default:Ce(()=>[($(),Ve(gn(l.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var oPe=dt(rPe,[["__file","prev.vue"]]);const sPe=ut({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:yr}}),iPe=me({name:"ElPaginationNext"}),aPe=me({...iPe,props:sPe,emits:["click"],setup(t){const o=t,{t:s}=Fn(),a=U(()=>o.disabled||o.currentPage===o.pageCount||o.pageCount===0);return(l,d)=>($(),le("button",{type:"button",class:"btn-next",disabled:p(a),"aria-label":l.nextText||p(s)("el.pagination.next"),"aria-disabled":p(a),onClick:h=>l.$emit("click",h)},[l.nextText?($(),le("span",{key:0},ot(l.nextText),1)):($(),Ve(p(Dt),{key:1},{default:Ce(()=>[($(),Ve(gn(l.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var cPe=dt(aPe,[["__file","next.vue"]]);const wz=Symbol("ElSelectGroup"),_m=Symbol("ElSelect");function lPe(t,o){const s=It(_m),a=It(wz,{disabled:!1}),l=U(()=>b(Js(s.props.modelValue),t.value)),d=U(()=>{var w;if(s.props.multiple){const I=Js((w=s.props.modelValue)!=null?w:[]);return!l.value&&I.length>=s.props.multipleLimit&&s.props.multipleLimit>0}else return!1}),h=U(()=>t.label||(fn(t.value)?"":t.value)),v=U(()=>t.value||t.label||""),g=U(()=>t.disabled||o.groupDisabled||d.value),E=mn(),b=(w=[],I)=>{if(fn(t.value)){const R=s.props.valueKey;return w&&w.some(N=>Tr(Oo(N,R))===Oo(I,R))}else return w&&w.includes(I)},S=()=>{!t.disabled&&!a.disabled&&(s.states.hoveringIndex=s.optionsArray.indexOf(E.proxy))},C=w=>{const I=new RegExp(pk(w),"i");o.visible=I.test(h.value)||t.created};return ze(()=>h.value,()=>{!t.created&&!s.props.remote&&s.setSelected()}),ze(()=>t.value,(w,I)=>{const{remote:R,valueKey:N}=s.props;if((R?w!==I:!as(w,I))&&(s.onOptionDestroy(I,E.proxy),s.onOptionCreate(E.proxy)),!t.created&&!R){if(N&&fn(w)&&fn(I)&&w[N]===I[N])return;s.setSelected()}}),ze(()=>a.disabled,()=>{o.groupDisabled=a.disabled},{immediate:!0}),{select:s,currentLabel:h,currentValue:v,itemSelected:l,isDisabled:g,hoverItem:S,updateOption:C}}const uPe=me({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(t){const o=Qe("select"),s=Ts(),a=U(()=>[o.be("dropdown","item"),o.is("disabled",p(v)),o.is("selected",p(h)),o.is("hovering",p(C))]),l=er({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:d,itemSelected:h,isDisabled:v,select:g,hoverItem:E,updateOption:b}=lPe(t,l),{visible:S,hover:C}=ds(l),w=mn().proxy;g.onOptionCreate(w),Rr(()=>{const R=w.value,{selected:N}=g.states,O=N.some(V=>V.value===w.value);Vt(()=>{g.states.cachedOptions.get(R)===w&&!O&&g.states.cachedOptions.delete(R)}),g.onOptionDestroy(R,w)});function I(){v.value||g.handleOptionSelect(w)}return{ns:o,id:s,containerKls:a,currentLabel:d,itemSelected:h,isDisabled:v,select:g,hoverItem:E,updateOption:b,visible:S,hover:C,selectOptionClick:I,states:l}}});function dPe(t,o,s,a,l,d){return ln(($(),le("li",{id:t.id,class:K(t.containerKls),role:"option","aria-disabled":t.isDisabled||void 0,"aria-selected":t.itemSelected,onMousemove:t.hoverItem,onClick:Gt(t.selectOptionClick,["stop"])},[Ne(t.$slots,"default",{},()=>[ue("span",null,ot(t.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[Wn,t.visible]])}var Pk=dt(uPe,[["render",dPe],["__file","option.vue"]]);const hPe=me({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const t=It(_m),o=Qe("select"),s=U(()=>t.props.popperClass),a=U(()=>t.props.multiple),l=U(()=>t.props.fitInputWidth),d=ee("");function h(){var v;d.value=`${(v=t.selectRef)==null?void 0:v.offsetWidth}px`}return dn(()=>{h(),co(t.selectRef,h)}),{ns:o,minWidth:d,popperClass:s,isMultiple:a,isFitInputWidth:l}}});function fPe(t,o,s,a,l,d){return $(),le("div",{class:K([t.ns.b("dropdown"),t.ns.is("multiple",t.isMultiple),t.popperClass]),style:jt({[t.isFitInputWidth?"width":"minWidth"]:t.minWidth})},[t.$slots.header?($(),le("div",{key:0,class:K(t.ns.be("dropdown","header"))},[Ne(t.$slots,"header")],2)):De("v-if",!0),Ne(t.$slots,"default"),t.$slots.footer?($(),le("div",{key:1,class:K(t.ns.be("dropdown","footer"))},[Ne(t.$slots,"footer")],2)):De("v-if",!0)],6)}var pPe=dt(hPe,[["render",fPe],["__file","select-dropdown.vue"]]);const mPe=(t,o)=>{const{t:s}=Fn(),a=Ts(),l=Qe("select"),d=Qe("input"),h=er({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),v=ee(null),g=ee(null),E=ee(null),b=ee(null),S=ee(null),C=ee(null),w=ee(null),I=ee(null),R=ee(null),N=ee(null),O=ee(null),{isComposing:V,handleCompositionStart:L,handleCompositionUpdate:D,handleCompositionEnd:M}=d_({afterComposition:mt=>tn(mt)}),{wrapperRef:F,isFocused:W,handleBlur:z}=_d(S,{beforeFocus(){return X.value},afterFocus(){t.automaticDropdown&&!G.value&&(G.value=!0,h.menuVisibleOnFocus=!0)},beforeBlur(mt){var Zt,Zn;return((Zt=E.value)==null?void 0:Zt.isFocusInsideContent(mt))||((Zn=b.value)==null?void 0:Zn.isFocusInsideContent(mt))},afterBlur(){G.value=!1,h.menuVisibleOnFocus=!1}}),G=ee(!1),Y=ee(),{form:te,formItem:Z}=Vs(),{inputId:fe}=Ka(t,{formItemContext:Z}),{valueOnClear:Ee,isEmptyValue:ae}=f0(t),X=U(()=>t.disabled||(te==null?void 0:te.disabled)),ie=U(()=>st(t.modelValue)?t.modelValue.length>0:!ae(t.modelValue)),se=U(()=>{var mt;return(mt=te==null?void 0:te.statusIcon)!=null?mt:!1}),J=U(()=>t.clearable&&!X.value&&h.inputHovering&&ie.value),pe=U(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),be=U(()=>l.is("reverse",pe.value&&G.value)),Ae=U(()=>(Z==null?void 0:Z.validateState)||""),_e=U(()=>g0[Ae.value]),Me=U(()=>t.remote?300:0),Fe=U(()=>t.remote&&!h.inputValue&&h.options.size===0),Le=U(()=>t.loading?t.loadingText||s("el.select.loading"):t.filterable&&h.inputValue&&h.options.size>0&&Pe.value===0?t.noMatchText||s("el.select.noMatch"):h.options.size===0?t.noDataText||s("el.select.noData"):null),Pe=U(()=>He.value.filter(mt=>mt.visible).length),He=U(()=>{const mt=Array.from(h.options.values()),Zt=[];return h.optionValues.forEach(Zn=>{const ko=mt.findIndex(ps=>ps.value===Zn);ko>-1&&Zt.push(mt[ko])}),Zt.length>=mt.length?Zt:mt}),We=U(()=>Array.from(h.cachedOptions.values())),yt=U(()=>{const mt=He.value.filter(Zt=>!Zt.created).some(Zt=>Zt.currentLabel===h.inputValue);return t.filterable&&t.allowCreate&&h.inputValue!==""&&!mt}),it=()=>{t.filterable&&Ft(t.filterMethod)||t.filterable&&t.remote&&Ft(t.remoteMethod)||He.value.forEach(mt=>{var Zt;(Zt=mt.updateOption)==null||Zt.call(mt,h.inputValue)})},ce=xo(),Se=U(()=>["small"].includes(ce.value)?"small":"default"),je=U({get(){return G.value&&!Fe.value},set(mt){G.value=mt}}),tt=U(()=>{if(t.multiple&&!Xn(t.modelValue))return Js(t.modelValue).length===0&&!h.inputValue;const mt=st(t.modelValue)?t.modelValue[0]:t.modelValue;return t.filterable||Xn(mt)?!h.inputValue:!0}),et=U(()=>{var mt;const Zt=(mt=t.placeholder)!=null?mt:s("el.select.placeholder");return t.multiple||!ie.value?Zt:h.selectedLabel}),Ge=U(()=>bS?null:"mouseenter");ze(()=>t.modelValue,(mt,Zt)=>{t.multiple&&t.filterable&&!t.reserveKeyword&&(h.inputValue="",Xe("")),ct(),!as(mt,Zt)&&t.validateEvent&&(Z==null||Z.validate("change").catch(Zn=>void 0))},{flush:"post",deep:!0}),ze(()=>G.value,mt=>{mt?Xe(h.inputValue):(h.inputValue="",h.previousQuery=null,h.isBeforeHide=!0),o("visible-change",mt)}),ze(()=>h.options.entries(),()=>{Vn&&(ct(),t.defaultFirstOption&&(t.filterable||t.remote)&&Pe.value&&Ye())},{flush:"post"}),ze([()=>h.hoveringIndex,He],([mt])=>{$t(mt)&&mt>-1?Y.value=He.value[mt]||{}:Y.value={},He.value.forEach(Zt=>{Zt.hover=Y.value===Zt})}),Ms(()=>{h.isBeforeHide||it()});const Xe=mt=>{h.previousQuery===mt||V.value||(h.previousQuery=mt,t.filterable&&Ft(t.filterMethod)?t.filterMethod(mt):t.filterable&&t.remote&&Ft(t.remoteMethod)&&t.remoteMethod(mt),t.defaultFirstOption&&(t.filterable||t.remote)&&Pe.value?Vt(Ye):Vt(Ot))},Ye=()=>{const mt=He.value.filter(ps=>ps.visible&&!ps.disabled&&!ps.states.groupDisabled),Zt=mt.find(ps=>ps.created),Zn=mt[0],ko=He.value.map(ps=>ps.value);h.hoveringIndex=Te(ko,Zt||Zn)},ct=()=>{if(t.multiple)h.selectedLabel="";else{const Zt=st(t.modelValue)?t.modelValue[0]:t.modelValue,Zn=nt(Zt);h.selectedLabel=Zn.currentLabel,h.selected=[Zn];return}const mt=[];Xn(t.modelValue)||Js(t.modelValue).forEach(Zt=>{mt.push(nt(Zt))}),h.selected=mt},nt=mt=>{let Zt;const Zn=Cg(mt);for(let za=h.cachedOptions.size-1;za>=0;za--){const bi=We.value[za];if(Zn?Oo(bi.value,t.valueKey)===Oo(mt,t.valueKey):bi.value===mt){Zt={value:mt,currentLabel:bi.currentLabel,get isDisabled(){return bi.isDisabled}};break}}if(Zt)return Zt;const ko=Zn?mt.label:mt??"";return{value:mt,currentLabel:ko}},Ot=()=>{h.hoveringIndex=He.value.findIndex(mt=>h.selected.some(Zt=>yl(Zt)===yl(mt)))},_t=()=>{h.selectionWidth=g.value.getBoundingClientRect().width},qe=()=>{h.collapseItemWidth=N.value.getBoundingClientRect().width},wt=()=>{var mt,Zt;(Zt=(mt=E.value)==null?void 0:mt.updatePopper)==null||Zt.call(mt)},qt=()=>{var mt,Zt;(Zt=(mt=b.value)==null?void 0:mt.updatePopper)==null||Zt.call(mt)},sn=()=>{h.inputValue.length>0&&!G.value&&(G.value=!0),Xe(h.inputValue)},tn=mt=>{if(h.inputValue=mt.target.value,t.remote)Kn();else return sn()},Kn=Hi(()=>{sn()},Me.value),Sn=mt=>{as(t.modelValue,mt)||o(yn,mt)},zr=mt=>qW(mt,Zt=>{const Zn=h.cachedOptions.get(Zt);return Zn&&!Zn.disabled&&!Zn.states.groupDisabled}),Wt=mt=>{if(t.multiple&&mt.code!==Ct.delete&&mt.target.value.length<=0){const Zt=Js(t.modelValue).slice(),Zn=zr(Zt);if(Zn<0)return;const ko=Zt[Zn];Zt.splice(Zn,1),o(Jt,Zt),Sn(Zt),o("remove-tag",ko)}},Je=(mt,Zt)=>{const Zn=h.selected.indexOf(Zt);if(Zn>-1&&!X.value){const ko=Js(t.modelValue).slice();ko.splice(Zn,1),o(Jt,ko),Sn(ko),o("remove-tag",Zt.value)}mt.stopPropagation(),No()},Ie=mt=>{mt.stopPropagation();const Zt=t.multiple?[]:Ee.value;if(t.multiple)for(const Zn of h.selected)Zn.isDisabled&&Zt.push(Zn.value);o(Jt,Zt),Sn(Zt),h.hoveringIndex=-1,G.value=!1,o("clear"),No()},Ke=mt=>{var Zt;if(t.multiple){const Zn=Js((Zt=t.modelValue)!=null?Zt:[]).slice(),ko=Te(Zn,mt);ko>-1?Zn.splice(ko,1):(t.multipleLimit<=0||Zn.length<t.multipleLimit)&&Zn.push(mt.value),o(Jt,Zn),Sn(Zn),mt.created&&Xe(""),t.filterable&&!t.reserveKeyword&&(h.inputValue="")}else o(Jt,mt.value),Sn(mt.value),G.value=!1;No(),!G.value&&Vt(()=>{vt(mt)})},Te=(mt=[],Zt)=>Xn(Zt)?-1:fn(Zt.value)?mt.findIndex(Zn=>as(Oo(Zn,t.valueKey),yl(Zt))):mt.indexOf(Zt.value),vt=mt=>{var Zt,Zn,ko,ps,za;const bi=st(mt)?mt[0]:mt;let Ya=null;if(bi!=null&&bi.value){const Si=He.value.filter(bd=>bd.value===bi.value);Si.length>0&&(Ya=Si[0].$el)}if(E.value&&Ya){const Si=(ps=(ko=(Zn=(Zt=E.value)==null?void 0:Zt.popperRef)==null?void 0:Zn.contentRef)==null?void 0:ko.querySelector)==null?void 0:ps.call(ko,`.${l.be("dropdown","wrap")}`);Si&&WN(Si,Ya)}(za=O.value)==null||za.handleScroll()},an=mt=>{h.options.set(mt.value,mt),h.cachedOptions.set(mt.value,mt)},en=(mt,Zt)=>{h.options.get(mt)===Zt&&h.options.delete(mt)},Ir=U(()=>{var mt,Zt;return(Zt=(mt=E.value)==null?void 0:mt.popperRef)==null?void 0:Zt.contentRef}),yi=()=>{h.isBeforeHide=!1,Vt(()=>{var mt;(mt=O.value)==null||mt.update(),vt(h.selected)})},No=()=>{var mt;(mt=S.value)==null||mt.focus()},Wo=()=>{var mt;if(G.value){G.value=!1,Vt(()=>{var Zt;return(Zt=S.value)==null?void 0:Zt.blur()});return}(mt=S.value)==null||mt.blur()},$r=mt=>{Ie(mt)},_r=mt=>{if(G.value=!1,W.value){const Zt=new FocusEvent("focus",mt);Vt(()=>z(Zt))}},ws=()=>{h.inputValue.length>0?h.inputValue="":G.value=!1},Ga=()=>{X.value||(bS&&(h.inputHovering=!0),h.menuVisibleOnFocus?h.menuVisibleOnFocus=!1:G.value=!G.value)},yd=()=>{if(!G.value)Ga();else{const mt=He.value[h.hoveringIndex];mt&&!mt.isDisabled&&Ke(mt)}},yl=mt=>fn(mt.value)?Oo(mt.value,t.valueKey):mt.value,Gh=U(()=>He.value.filter(mt=>mt.visible).every(mt=>mt.isDisabled)),Rs=U(()=>t.multiple?t.collapseTags?h.selected.slice(0,t.maxCollapseTags):h.selected:[]),fu=U(()=>t.multiple?t.collapseTags?h.selected.slice(t.maxCollapseTags):[]:[]),zh=mt=>{if(!G.value){G.value=!0;return}if(!(h.options.size===0||Pe.value===0||V.value)&&!Gh.value){mt==="next"?(h.hoveringIndex++,h.hoveringIndex===h.options.size&&(h.hoveringIndex=0)):mt==="prev"&&(h.hoveringIndex--,h.hoveringIndex<0&&(h.hoveringIndex=h.options.size-1));const Zt=He.value[h.hoveringIndex];(Zt.isDisabled||!Zt.visible)&&zh(mt),Vt(()=>vt(Y.value))}},pu=()=>{if(!g.value)return 0;const mt=window.getComputedStyle(g.value);return Number.parseFloat(mt.gap||"6px")},Yh=U(()=>{const mt=pu();return{maxWidth:`${N.value&&t.maxCollapseTags===1?h.selectionWidth-h.collapseItemWidth-mt:h.selectionWidth}px`}}),qh=U(()=>({maxWidth:`${h.selectionWidth}px`})),Xh=mt=>{o("popup-scroll",mt)};return co(g,_t),co(I,wt),co(F,wt),co(R,qt),co(N,qe),dn(()=>{ct()}),{inputId:fe,contentId:a,nsSelect:l,nsInput:d,states:h,isFocused:W,expanded:G,optionsArray:He,hoverOption:Y,selectSize:ce,filteredOptionsCount:Pe,updateTooltip:wt,updateTagTooltip:qt,debouncedOnInputChange:Kn,onInput:tn,deletePrevTag:Wt,deleteTag:Je,deleteSelected:Ie,handleOptionSelect:Ke,scrollToOption:vt,hasModelValue:ie,shouldShowPlaceholder:tt,currentPlaceholder:et,mouseEnterEventName:Ge,needStatusIcon:se,showClose:J,iconComponent:pe,iconReverse:be,validateState:Ae,validateIcon:_e,showNewOption:yt,updateOptions:it,collapseTagSize:Se,setSelected:ct,selectDisabled:X,emptyText:Le,handleCompositionStart:L,handleCompositionUpdate:D,handleCompositionEnd:M,onOptionCreate:an,onOptionDestroy:en,handleMenuEnter:yi,focus:No,blur:Wo,handleClearClick:$r,handleClickOutside:_r,handleEsc:ws,toggleMenu:Ga,selectOption:yd,getValueKey:yl,navigateOptions:zh,dropdownMenuVisible:je,showTagList:Rs,collapseTagList:fu,popupScroll:Xh,tagStyle:Yh,collapseTagStyle:qh,popperRef:Ir,inputRef:S,tooltipRef:E,tagTooltipRef:b,prefixRef:C,suffixRef:w,selectRef:v,wrapperRef:F,selectionRef:g,scrollbarRef:O,menuRef:I,tagMenuRef:R,collapseItemRef:N}};var vPe=me({name:"ElOptions",setup(t,{slots:o}){const s=It(_m);let a=[];return()=>{var l,d;const h=(l=o.default)==null?void 0:l.call(o),v=[];function g(E){st(E)&&E.forEach(b=>{var S,C,w,I;const R=(S=(b==null?void 0:b.type)||{})==null?void 0:S.name;R==="ElOptionGroup"?g(!Mt(b.children)&&!st(b.children)&&Ft((C=b.children)==null?void 0:C.default)?(w=b.children)==null?void 0:w.default():b.children):R==="ElOption"?v.push((I=b.props)==null?void 0:I.value):st(b.children)&&g(b.children)})}return h.length&&g((d=h[0])==null?void 0:d.children),as(v,a)||(a=v,s&&(s.states.optionValues=v)),h}}});const gPe=ut({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Ho,effect:{type:Re(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Re(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:ss.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:yr,default:du},fitInputWidth:Boolean,suffixIcon:{type:yr,default:uu},tagType:{...nu.type,default:"info"},tagEffect:{...nu.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:Re(String),values:hu,default:"bottom-start"},fallbackPlacements:{type:Re(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...pm,...Cs(["ariaLabel"])}),kH="ElSelect",_Pe=me({name:kH,componentName:kH,components:{ElSelectMenu:pPe,ElOption:Pk,ElOptions:vPe,ElTag:Jp,ElScrollbar:gl,ElTooltip:Us,ElIcon:Dt},directives:{ClickOutside:ru},props:gPe,emits:[Jt,yn,"remove-tag","clear","visible-change","focus","blur","popup-scroll"],setup(t,{emit:o}){const s=U(()=>{const{modelValue:g,multiple:E}=t,b=E?[]:void 0;return st(g)?E?g:b:E?b:g}),a=er({...ds(t),modelValue:s}),l=mPe(a,o),{calculatorRef:d,inputStyle:h}=Nk();wn(_m,er({props:a,states:l.states,optionsArray:l.optionsArray,handleOptionSelect:l.handleOptionSelect,onOptionCreate:l.onOptionCreate,onOptionDestroy:l.onOptionDestroy,selectRef:l.selectRef,setSelected:l.setSelected}));const v=U(()=>t.multiple?l.states.selected.map(g=>g.currentLabel):l.states.selectedLabel);return{...l,modelValue:s,selectedLabel:v,calculatorRef:d,inputStyle:h}}});function EPe(t,o,s,a,l,d){const h=_n("el-tag"),v=_n("el-tooltip"),g=_n("el-icon"),E=_n("el-option"),b=_n("el-options"),S=_n("el-scrollbar"),C=_n("el-select-menu"),w=t0("click-outside");return ln(($(),le("div",{ref:"selectRef",class:K([t.nsSelect.b(),t.nsSelect.m(t.selectSize)]),[cg(t.mouseEnterEventName)]:I=>t.states.inputHovering=!0,onMouseleave:I=>t.states.inputHovering=!1},[ge(v,{ref:"tooltipRef",visible:t.dropdownMenuVisible,placement:t.placement,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"popper-options":t.popperOptions,"fallback-placements":t.fallbackPlacements,effect:t.effect,pure:"",trigger:"click",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:t.persistent,"append-to":t.appendTo,"show-arrow":t.showArrow,offset:t.offset,onBeforeShow:t.handleMenuEnter,onHide:I=>t.states.isBeforeHide=!1},{default:Ce(()=>{var I;return[ue("div",{ref:"wrapperRef",class:K([t.nsSelect.e("wrapper"),t.nsSelect.is("focused",t.isFocused),t.nsSelect.is("hovering",t.states.inputHovering),t.nsSelect.is("filterable",t.filterable),t.nsSelect.is("disabled",t.selectDisabled)]),onClick:Gt(t.toggleMenu,["prevent"])},[t.$slots.prefix?($(),le("div",{key:0,ref:"prefixRef",class:K(t.nsSelect.e("prefix"))},[Ne(t.$slots,"prefix")],2)):De("v-if",!0),ue("div",{ref:"selectionRef",class:K([t.nsSelect.e("selection"),t.nsSelect.is("near",t.multiple&&!t.$slots.prefix&&!!t.states.selected.length)])},[t.multiple?Ne(t.$slots,"tag",{key:0},()=>[($(!0),le(Ut,null,Cn(t.showTagList,R=>($(),le("div",{key:t.getValueKey(R),class:K(t.nsSelect.e("selected-item"))},[ge(h,{closable:!t.selectDisabled&&!R.isDisabled,size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,"disable-transitions":"",style:jt(t.tagStyle),onClose:N=>t.deleteTag(N,R)},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))},[Ne(t.$slots,"label",{label:R.currentLabel,value:R.value},()=>[bn(ot(R.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),t.collapseTags&&t.states.selected.length>t.maxCollapseTags?($(),Ve(v,{key:0,ref:"tagTooltipRef",disabled:t.dropdownMenuVisible||!t.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:Ce(()=>[ue("div",{ref:"collapseItemRef",class:K(t.nsSelect.e("selected-item"))},[ge(h,{closable:!1,size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,"disable-transitions":"",style:jt(t.collapseTagStyle)},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))}," + "+ot(t.states.selected.length-t.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:Ce(()=>[ue("div",{ref:"tagMenuRef",class:K(t.nsSelect.e("selection"))},[($(!0),le(Ut,null,Cn(t.collapseTagList,R=>($(),le("div",{key:t.getValueKey(R),class:K(t.nsSelect.e("selected-item"))},[ge(h,{class:"in-tooltip",closable:!t.selectDisabled&&!R.isDisabled,size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,"disable-transitions":"",onClose:N=>t.deleteTag(N,R)},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))},[Ne(t.$slots,"label",{label:R.currentLabel,value:R.value},()=>[bn(ot(R.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):De("v-if",!0)]):De("v-if",!0),ue("div",{class:K([t.nsSelect.e("selected-item"),t.nsSelect.e("input-wrapper"),t.nsSelect.is("hidden",!t.filterable)])},[ln(ue("input",{id:t.inputId,ref:"inputRef","onUpdate:modelValue":R=>t.states.inputValue=R,type:"text",name:t.name,class:K([t.nsSelect.e("input"),t.nsSelect.is(t.selectSize)]),disabled:t.selectDisabled,autocomplete:t.autocomplete,style:jt(t.inputStyle),tabindex:t.tabindex,role:"combobox",readonly:!t.filterable,spellcheck:"false","aria-activedescendant":((I=t.hoverOption)==null?void 0:I.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropdownMenuVisible,"aria-label":t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[Cr(Gt(R=>t.navigateOptions("next"),["stop","prevent"]),["down"]),Cr(Gt(R=>t.navigateOptions("prev"),["stop","prevent"]),["up"]),Cr(Gt(t.handleEsc,["stop","prevent"]),["esc"]),Cr(Gt(t.selectOption,["stop","prevent"]),["enter"]),Cr(Gt(t.deletePrevTag,["stop"]),["delete"])],onCompositionstart:t.handleCompositionStart,onCompositionupdate:t.handleCompositionUpdate,onCompositionend:t.handleCompositionEnd,onInput:t.onInput,onClick:Gt(t.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[o0,t.states.inputValue]]),t.filterable?($(),le("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:K(t.nsSelect.e("input-calculator")),textContent:ot(t.states.inputValue)},null,10,["textContent"])):De("v-if",!0)],2),t.shouldShowPlaceholder?($(),le("div",{key:1,class:K([t.nsSelect.e("selected-item"),t.nsSelect.e("placeholder"),t.nsSelect.is("transparent",!t.hasModelValue||t.expanded&&!t.states.inputValue)])},[t.hasModelValue?Ne(t.$slots,"label",{key:0,label:t.currentPlaceholder,value:t.modelValue},()=>[ue("span",null,ot(t.currentPlaceholder),1)]):($(),le("span",{key:1},ot(t.currentPlaceholder),1))],2)):De("v-if",!0)],2),ue("div",{ref:"suffixRef",class:K(t.nsSelect.e("suffix"))},[t.iconComponent&&!t.showClose?($(),Ve(g,{key:0,class:K([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.iconReverse])},{default:Ce(()=>[($(),Ve(gn(t.iconComponent)))]),_:1},8,["class"])):De("v-if",!0),t.showClose&&t.clearIcon?($(),Ve(g,{key:1,class:K([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.nsSelect.e("clear")]),onClick:t.handleClearClick},{default:Ce(()=>[($(),Ve(gn(t.clearIcon)))]),_:1},8,["class","onClick"])):De("v-if",!0),t.validateState&&t.validateIcon&&t.needStatusIcon?($(),Ve(g,{key:2,class:K([t.nsInput.e("icon"),t.nsInput.e("validateIcon"),t.nsInput.is("loading",t.validateState==="validating")])},{default:Ce(()=>[($(),Ve(gn(t.validateIcon)))]),_:1},8,["class"])):De("v-if",!0)],2)],10,["onClick"])]}),content:Ce(()=>[ge(C,{ref:"menuRef"},{default:Ce(()=>[t.$slots.header?($(),le("div",{key:0,class:K(t.nsSelect.be("dropdown","header")),onClick:Gt(()=>{},["stop"])},[Ne(t.$slots,"header")],10,["onClick"])):De("v-if",!0),ln(ge(S,{id:t.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":t.nsSelect.be("dropdown","wrap"),"view-class":t.nsSelect.be("dropdown","list"),class:K([t.nsSelect.is("empty",t.filteredOptionsCount===0)]),role:"listbox","aria-label":t.ariaLabel,"aria-orientation":"vertical",onScroll:t.popupScroll},{default:Ce(()=>[t.showNewOption?($(),Ve(E,{key:0,value:t.states.inputValue,created:!0},null,8,["value"])):De("v-if",!0),ge(b,null,{default:Ce(()=>[Ne(t.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label","onScroll"]),[[Wn,t.states.options.size>0&&!t.loading]]),t.$slots.loading&&t.loading?($(),le("div",{key:1,class:K(t.nsSelect.be("dropdown","loading"))},[Ne(t.$slots,"loading")],2)):t.loading||t.filteredOptionsCount===0?($(),le("div",{key:2,class:K(t.nsSelect.be("dropdown","empty"))},[Ne(t.$slots,"empty",{},()=>[ue("span",null,ot(t.emptyText),1)])],2)):De("v-if",!0),t.$slots.footer?($(),le("div",{key:3,class:K(t.nsSelect.be("dropdown","footer")),onClick:Gt(()=>{},["stop"])},[Ne(t.$slots,"footer")],10,["onClick"])):De("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[w,t.handleClickOutside,t.popperRef]])}var yPe=dt(_Pe,[["render",EPe],["__file","select.vue"]]);const bPe=me({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(t){const o=Qe("select"),s=ee(null),a=mn(),l=ee([]);wn(wz,er({...ds(t)}));const d=U(()=>l.value.some(E=>E.visible===!0)),h=E=>{var b,S;return((b=E.type)==null?void 0:b.name)==="ElOption"&&!!((S=E.component)!=null&&S.proxy)},v=E=>{const b=Js(E),S=[];return b.forEach(C=>{var w,I;h(C)?S.push(C.component.proxy):(w=C.children)!=null&&w.length?S.push(...v(C.children)):(I=C.component)!=null&&I.subTree&&S.push(...v(C.component.subTree))}),S},g=()=>{l.value=v(a.subTree)};return dn(()=>{g()}),nK(s,g,{attributes:!0,subtree:!0,childList:!0}),{groupRef:s,visible:d,ns:o}}});function SPe(t,o,s,a,l,d){return ln(($(),le("ul",{ref:"groupRef",class:K(t.ns.be("group","wrap"))},[ue("li",{class:K(t.ns.be("group","title"))},ot(t.label),3),ue("li",null,[ue("ul",{class:K(t.ns.b("group"))},[Ne(t.$slots,"default")],2)])],2)),[[Wn,t.visible]])}var Rz=dt(bPe,[["render",SPe],["__file","option-group.vue"]]);const Uh=rn(yPe,{Option:Pk,OptionGroup:Rz}),OS=uo(Pk),TPe=uo(Rz),Dk=()=>It(Cz,{}),CPe=ut({pageSize:{type:Number,required:!0},pageSizes:{type:Re(Array),default:()=>lo([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:vl},appendSizeTo:String}),wPe=me({name:"ElPaginationSizes"}),RPe=me({...wPe,props:CPe,emits:["page-size-change"],setup(t,{emit:o}){const s=t,{t:a}=Fn(),l=Qe("pagination"),d=Dk(),h=ee(s.pageSize);ze(()=>s.pageSizes,(E,b)=>{if(!as(E,b)&&st(E)){const S=E.includes(s.pageSize)?s.pageSize:s.pageSizes[0];o("page-size-change",S)}}),ze(()=>s.pageSize,E=>{h.value=E});const v=U(()=>s.pageSizes);function g(E){var b;E!==h.value&&(h.value=E,(b=d.handleSizeChange)==null||b.call(d,Number(E)))}return(E,b)=>($(),le("span",{class:K(p(l).e("sizes"))},[ge(p(Uh),{"model-value":h.value,disabled:E.disabled,"popper-class":E.popperClass,size:E.size,teleported:E.teleported,"validate-event":!1,"append-to":E.appendSizeTo,onChange:g},{default:Ce(()=>[($(!0),le(Ut,null,Cn(p(v),S=>($(),Ve(p(OS),{key:S,value:S,label:S+p(a)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var IPe=dt(RPe,[["__file","sizes.vue"]]);const APe=ut({size:{type:String,values:vl}}),OPe=me({name:"ElPaginationJumper"}),NPe=me({...OPe,props:APe,setup(t){const{t:o}=Fn(),s=Qe("pagination"),{pageCount:a,disabled:l,currentPage:d,changeEvent:h}=Dk(),v=ee(),g=U(()=>{var S;return(S=v.value)!=null?S:d==null?void 0:d.value});function E(S){v.value=S?+S:""}function b(S){S=Math.trunc(+S),h==null||h(S),v.value=void 0}return(S,C)=>($(),le("span",{class:K(p(s).e("jump")),disabled:p(l)},[ue("span",{class:K([p(s).e("goto")])},ot(p(o)("el.pagination.goto")),3),ge(p(ei),{size:S.size,class:K([p(s).e("editor"),p(s).is("in-pagination")]),min:1,max:p(a),disabled:p(l),"model-value":p(g),"validate-event":!1,"aria-label":p(o)("el.pagination.page"),type:"number","onUpdate:modelValue":E,onChange:b},null,8,["size","class","max","disabled","model-value","aria-label"]),ue("span",{class:K([p(s).e("classifier")])},ot(p(o)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var kPe=dt(NPe,[["__file","jumper.vue"]]);const PPe=ut({total:{type:Number,default:1e3}}),DPe=me({name:"ElPaginationTotal"}),LPe=me({...DPe,props:PPe,setup(t){const{t:o}=Fn(),s=Qe("pagination"),{disabled:a}=Dk();return(l,d)=>($(),le("span",{class:K(p(s).e("total")),disabled:p(a)},ot(p(o)("el.pagination.total",{total:l.total})),11,["disabled"]))}});var MPe=dt(LPe,[["__file","total.vue"]]);const xPe=ut({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),UPe=me({name:"ElPaginationPager"}),VPe=me({...UPe,props:xPe,emits:[yn],setup(t,{emit:o}){const s=t,a=Qe("pager"),l=Qe("icon"),{t:d}=Fn(),h=ee(!1),v=ee(!1),g=ee(!1),E=ee(!1),b=ee(!1),S=ee(!1),C=U(()=>{const D=s.pagerCount,M=(D-1)/2,F=Number(s.currentPage),W=Number(s.pageCount);let z=!1,G=!1;W>D&&(F>D-M&&(z=!0),F<W-M&&(G=!0));const Y=[];if(z&&!G){const te=W-(D-2);for(let Z=te;Z<W;Z++)Y.push(Z)}else if(!z&&G)for(let te=2;te<D;te++)Y.push(te);else if(z&&G){const te=Math.floor(D/2)-1;for(let Z=F-te;Z<=F+te;Z++)Y.push(Z)}else for(let te=2;te<W;te++)Y.push(te);return Y}),w=U(()=>["more","btn-quickprev",l.b(),a.is("disabled",s.disabled)]),I=U(()=>["more","btn-quicknext",l.b(),a.is("disabled",s.disabled)]),R=U(()=>s.disabled?-1:0);Ms(()=>{const D=(s.pagerCount-1)/2;h.value=!1,v.value=!1,s.pageCount>s.pagerCount&&(s.currentPage>s.pagerCount-D&&(h.value=!0),s.currentPage<s.pageCount-D&&(v.value=!0))});function N(D=!1){s.disabled||(D?g.value=!0:E.value=!0)}function O(D=!1){D?b.value=!0:S.value=!0}function V(D){const M=D.target;if(M.tagName.toLowerCase()==="li"&&Array.from(M.classList).includes("number")){const F=Number(M.textContent);F!==s.currentPage&&o(yn,F)}else M.tagName.toLowerCase()==="li"&&Array.from(M.classList).includes("more")&&L(D)}function L(D){const M=D.target;if(M.tagName.toLowerCase()==="ul"||s.disabled)return;let F=Number(M.textContent);const W=s.pageCount,z=s.currentPage,G=s.pagerCount-2;M.className.includes("more")&&(M.className.includes("quickprev")?F=z-G:M.className.includes("quicknext")&&(F=z+G)),Number.isNaN(+F)||(F<1&&(F=1),F>W&&(F=W)),F!==z&&o(yn,F)}return(D,M)=>($(),le("ul",{class:K(p(a).b()),onClick:L,onKeyup:Cr(V,["enter"])},[D.pageCount>0?($(),le("li",{key:0,class:K([[p(a).is("active",D.currentPage===1),p(a).is("disabled",D.disabled)],"number"]),"aria-current":D.currentPage===1,"aria-label":p(d)("el.pagination.currentPage",{pager:1}),tabindex:p(R)}," 1 ",10,["aria-current","aria-label","tabindex"])):De("v-if",!0),h.value?($(),le("li",{key:1,class:K(p(w)),tabindex:p(R),"aria-label":p(d)("el.pagination.prevPages",{pager:D.pagerCount-2}),onMouseenter:F=>N(!0),onMouseleave:F=>g.value=!1,onFocus:F=>O(!0),onBlur:F=>b.value=!1},[(g.value||b.value)&&!D.disabled?($(),Ve(p(dd),{key:0})):($(),Ve(p(N$),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):De("v-if",!0),($(!0),le(Ut,null,Cn(p(C),F=>($(),le("li",{key:F,class:K([[p(a).is("active",D.currentPage===F),p(a).is("disabled",D.disabled)],"number"]),"aria-current":D.currentPage===F,"aria-label":p(d)("el.pagination.currentPage",{pager:F}),tabindex:p(R)},ot(F),11,["aria-current","aria-label","tabindex"]))),128)),v.value?($(),le("li",{key:2,class:K(p(I)),tabindex:p(R),"aria-label":p(d)("el.pagination.nextPages",{pager:D.pagerCount-2}),onMouseenter:F=>N(),onMouseleave:F=>E.value=!1,onFocus:F=>O(),onBlur:F=>S.value=!1},[(E.value||S.value)&&!D.disabled?($(),Ve(p(hd),{key:0})):($(),Ve(p(N$),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):De("v-if",!0),D.pageCount>1?($(),le("li",{key:3,class:K([[p(a).is("active",D.currentPage===D.pageCount),p(a).is("disabled",D.disabled)],"number"]),"aria-current":D.currentPage===D.pageCount,"aria-label":p(d)("el.pagination.currentPage",{pager:D.pageCount}),tabindex:p(R)},ot(D.pageCount),11,["aria-current","aria-label","tabindex"])):De("v-if",!0)],42,["onKeyup"]))}});var FPe=dt(VPe,[["__file","pager.vue"]]);const ci=t=>typeof t!="number",BPe=ut({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:t=>$t(t)&&Math.trunc(t)===t&&t>4&&t<22&&t%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:Re(Array),default:()=>lo([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:yr,default:()=>ud},nextText:{type:String,default:""},nextIcon:{type:yr,default:()=>vi},teleported:{type:Boolean,default:!0},small:Boolean,size:Ho,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),jPe={"update:current-page":t=>$t(t),"update:page-size":t=>$t(t),"size-change":t=>$t(t),change:(t,o)=>$t(t)&&$t(o),"current-change":t=>$t(t),"prev-click":t=>$t(t),"next-click":t=>$t(t)},PH="ElPagination";var $Pe=me({name:PH,props:BPe,emits:jPe,setup(t,{emit:o,slots:s}){const{t:a}=Fn(),l=Qe("pagination"),d=mn().vnode.props||{},h=lK(),v=U(()=>{var M;return t.small?"small":(M=t.size)!=null?M:h.value});od({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},U(()=>!!t.small));const g="onUpdate:currentPage"in d||"onUpdate:current-page"in d||"onCurrentChange"in d,E="onUpdate:pageSize"in d||"onUpdate:page-size"in d||"onSizeChange"in d,b=U(()=>{if(ci(t.total)&&ci(t.pageCount)||!ci(t.currentPage)&&!g)return!1;if(t.layout.includes("sizes")){if(ci(t.pageCount)){if(!ci(t.total)&&!ci(t.pageSize)&&!E)return!1}else if(!E)return!1}return!0}),S=ee(ci(t.defaultPageSize)?10:t.defaultPageSize),C=ee(ci(t.defaultCurrentPage)?1:t.defaultCurrentPage),w=U({get(){return ci(t.pageSize)?S.value:t.pageSize},set(M){ci(t.pageSize)&&(S.value=M),E&&(o("update:page-size",M),o("size-change",M))}}),I=U(()=>{let M=0;return ci(t.pageCount)?ci(t.total)||(M=Math.max(1,Math.ceil(t.total/w.value))):M=t.pageCount,M}),R=U({get(){return ci(t.currentPage)?C.value:t.currentPage},set(M){let F=M;M<1?F=1:M>I.value&&(F=I.value),ci(t.currentPage)&&(C.value=F),g&&(o("update:current-page",F),o("current-change",F))}});ze(I,M=>{R.value>M&&(R.value=M)}),ze([R,w],M=>{o(yn,...M)},{flush:"post"});function N(M){R.value=M}function O(M){w.value=M;const F=I.value;R.value>F&&(R.value=F)}function V(){t.disabled||(R.value-=1,o("prev-click",R.value))}function L(){t.disabled||(R.value+=1,o("next-click",R.value))}function D(M,F){M&&(M.props||(M.props={}),M.props.class=[M.props.class,F].join(" "))}return wn(Cz,{pageCount:I,disabled:U(()=>t.disabled),currentPage:R,changeEvent:N,handleSizeChange:O}),()=>{var M,F;if(!b.value)return a("el.pagination.deprecationWarning"),null;if(!t.layout||t.hideOnSinglePage&&I.value<=1)return null;const W=[],z=[],G=Ht("div",{class:l.e("rightwrapper")},z),Y={prev:Ht(oPe,{disabled:t.disabled,currentPage:R.value,prevText:t.prevText,prevIcon:t.prevIcon,onClick:V}),jumper:Ht(kPe,{size:v.value}),pager:Ht(FPe,{currentPage:R.value,pageCount:I.value,pagerCount:t.pagerCount,onChange:N,disabled:t.disabled}),next:Ht(cPe,{disabled:t.disabled,currentPage:R.value,pageCount:I.value,nextText:t.nextText,nextIcon:t.nextIcon,onClick:L}),sizes:Ht(IPe,{pageSize:w.value,pageSizes:t.pageSizes,popperClass:t.popperClass,disabled:t.disabled,teleported:t.teleported,size:v.value,appendSizeTo:t.appendSizeTo}),slot:(F=(M=s==null?void 0:s.default)==null?void 0:M.call(s))!=null?F:null,total:Ht(MPe,{total:ci(t.total)?0:t.total})},te=t.layout.split(",").map(fe=>fe.trim());let Z=!1;return te.forEach(fe=>{if(fe==="->"){Z=!0;return}Z?z.push(Y[fe]):W.push(Y[fe])}),D(W[0],l.is("first")),D(W[W.length-1],l.is("last")),Z&&z.length>0&&(D(z[0],l.is("first")),D(z[z.length-1],l.is("last")),W.push(G)),Ht("div",{class:[l.b(),l.is("background",t.background),l.m(v.value)]},W)}}});const HPe=rn($Pe),WPe=ut({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:JA,default:"primary"},cancelButtonType:{type:String,values:JA,default:"text"},icon:{type:yr,default:()=>Fye},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:ss.teleported,persistent:ss.persistent,width:{type:[String,Number],default:150}}),KPe={confirm:t=>t instanceof MouseEvent,cancel:t=>t instanceof MouseEvent},GPe=me({name:"ElPopconfirm"}),zPe=me({...GPe,props:WPe,emits:KPe,setup(t,{emit:o}){const s=t,{t:a}=Fn(),l=Qe("popconfirm"),d=ee(),h=()=>{var C,w;(w=(C=d.value)==null?void 0:C.onClose)==null||w.call(C)},v=U(()=>({width:mo(s.width)})),g=C=>{o("confirm",C),h()},E=C=>{o("cancel",C),h()},b=U(()=>s.confirmButtonText||a("el.popconfirm.confirmButtonText")),S=U(()=>s.cancelButtonText||a("el.popconfirm.cancelButtonText"));return(C,w)=>($(),Ve(p(Us),En({ref_key:"tooltipRef",ref:d,trigger:"click",effect:"light"},C.$attrs,{"popper-class":`${p(l).namespace.value}-popover`,"popper-style":p(v),teleported:C.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":C.hideAfter,persistent:C.persistent}),{content:Ce(()=>[ue("div",{class:K(p(l).b())},[ue("div",{class:K(p(l).e("main"))},[!C.hideIcon&&C.icon?($(),Ve(p(Dt),{key:0,class:K(p(l).e("icon")),style:jt({color:C.iconColor})},{default:Ce(()=>[($(),Ve(gn(C.icon)))]),_:1},8,["class","style"])):De("v-if",!0),bn(" "+ot(C.title),1)],2),ue("div",{class:K(p(l).e("action"))},[Ne(C.$slots,"actions",{confirm:g,cancel:E},()=>[ge(p(ls),{size:"small",type:C.cancelButtonType==="text"?"":C.cancelButtonType,text:C.cancelButtonType==="text",onClick:E},{default:Ce(()=>[bn(ot(p(S)),1)]),_:1},8,["type","text"]),ge(p(ls),{size:"small",type:C.confirmButtonType==="text"?"":C.confirmButtonType,text:C.confirmButtonType==="text",onClick:g},{default:Ce(()=>[bn(ot(p(b)),1)]),_:1},8,["type","text"])])],2)],2)]),default:Ce(()=>[C.$slots.reference?Ne(C.$slots,"reference",{key:0}):De("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var YPe=dt(zPe,[["__file","popconfirm.vue"]]);const qPe=rn(YPe),XPe=ut({trigger:Fg.trigger,placement:zb.placement,disabled:Fg.disabled,visible:ss.visible,transition:ss.transition,popperOptions:zb.popperOptions,tabindex:zb.tabindex,content:ss.content,popperStyle:ss.popperStyle,popperClass:ss.popperClass,enterable:{...ss.enterable,default:!0},effect:{...ss.effect,default:"light"},teleported:ss.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),JPe={"update:visible":t=>wr(t),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},ZPe="onUpdate:visible",QPe=me({name:"ElPopover"}),e1e=me({...QPe,props:XPe,emits:JPe,setup(t,{expose:o,emit:s}){const a=t,l=U(()=>a[ZPe]),d=Qe("popover"),h=ee(),v=U(()=>{var N;return(N=p(h))==null?void 0:N.popperRef}),g=U(()=>[{width:mo(a.width)},a.popperStyle]),E=U(()=>[d.b(),a.popperClass,{[d.m("plain")]:!!a.content}]),b=U(()=>a.transition===`${d.namespace.value}-fade-in-linear`),S=()=>{var N;(N=h.value)==null||N.hide()},C=()=>{s("before-enter")},w=()=>{s("before-leave")},I=()=>{s("after-enter")},R=()=>{s("update:visible",!1),s("after-leave")};return o({popperRef:v,hide:S}),(N,O)=>($(),Ve(p(Us),En({ref_key:"tooltipRef",ref:h},N.$attrs,{trigger:N.trigger,placement:N.placement,disabled:N.disabled,visible:N.visible,transition:N.transition,"popper-options":N.popperOptions,tabindex:N.tabindex,content:N.content,offset:N.offset,"show-after":N.showAfter,"hide-after":N.hideAfter,"auto-close":N.autoClose,"show-arrow":N.showArrow,"aria-label":N.title,effect:N.effect,enterable:N.enterable,"popper-class":p(E),"popper-style":p(g),teleported:N.teleported,persistent:N.persistent,"gpu-acceleration":p(b),"onUpdate:visible":p(l),onBeforeShow:C,onBeforeHide:w,onShow:I,onHide:R}),{content:Ce(()=>[N.title?($(),le("div",{key:0,class:K(p(d).e("title")),role:"title"},ot(N.title),3)):De("v-if",!0),Ne(N.$slots,"default",{},()=>[bn(ot(N.content),1)])]),default:Ce(()=>[N.$slots.reference?Ne(N.$slots,"reference",{key:0}):De("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var t1e=dt(e1e,[["__file","popover.vue"]]);const DH=(t,o)=>{const s=o.arg||o.value,a=s==null?void 0:s.popperRef;a&&(a.triggerRef=t)};var n1e={mounted(t,o){DH(t,o)},updated(t,o){DH(t,o)}};const r1e="popover",Iz=zEe(n1e,r1e),o1e=rn(t1e,{directive:Iz}),s1e=ut({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Re(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Re([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Re(Function),default:t=>`${t}%`}}),i1e=me({name:"ElProgress"}),a1e=me({...i1e,props:s1e,setup(t){const o=t,s={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=Qe("progress"),l=U(()=>{const L={width:`${o.percentage}%`,animationDuration:`${o.duration}s`},D=V(o.percentage);return D.includes("gradient")?L.background=D:L.backgroundColor=D,L}),d=U(()=>(o.strokeWidth/o.width*100).toFixed(1)),h=U(()=>["circle","dashboard"].includes(o.type)?Number.parseInt(`${50-Number.parseFloat(d.value)/2}`,10):0),v=U(()=>{const L=h.value,D=o.type==="dashboard";return`
          M 50 50
          m 0 ${D?"":"-"}${L}
          a ${L} ${L} 0 1 1 0 ${D?"-":""}${L*2}
          a ${L} ${L} 0 1 1 0 ${D?"":"-"}${L*2}
          `}),g=U(()=>2*Math.PI*h.value),E=U(()=>o.type==="dashboard"?.75:1),b=U(()=>`${-1*g.value*(1-E.value)/2}px`),S=U(()=>({strokeDasharray:`${g.value*E.value}px, ${g.value}px`,strokeDashoffset:b.value})),C=U(()=>({strokeDasharray:`${g.value*E.value*(o.percentage/100)}px, ${g.value}px`,strokeDashoffset:b.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),w=U(()=>{let L;return o.color?L=V(o.percentage):L=s[o.status]||s.default,L}),I=U(()=>o.status==="warning"?v0:o.type==="line"?o.status==="success"?GN:du:o.status==="success"?l_:Sc),R=U(()=>o.type==="line"?12+o.strokeWidth*.4:o.width*.111111+2),N=U(()=>o.format(o.percentage));function O(L){const D=100/L.length;return L.map((F,W)=>Mt(F)?{color:F,percentage:(W+1)*D}:F).sort((F,W)=>F.percentage-W.percentage)}const V=L=>{var D;const{color:M}=o;if(Ft(M))return M(L);if(Mt(M))return M;{const F=O(M);for(const W of F)if(W.percentage>L)return W.color;return(D=F[F.length-1])==null?void 0:D.color}};return(L,D)=>($(),le("div",{class:K([p(a).b(),p(a).m(L.type),p(a).is(L.status),{[p(a).m("without-text")]:!L.showText,[p(a).m("text-inside")]:L.textInside}]),role:"progressbar","aria-valuenow":L.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[L.type==="line"?($(),le("div",{key:0,class:K(p(a).b("bar"))},[ue("div",{class:K(p(a).be("bar","outer")),style:jt({height:`${L.strokeWidth}px`})},[ue("div",{class:K([p(a).be("bar","inner"),{[p(a).bem("bar","inner","indeterminate")]:L.indeterminate},{[p(a).bem("bar","inner","striped")]:L.striped},{[p(a).bem("bar","inner","striped-flow")]:L.stripedFlow}]),style:jt(p(l))},[(L.showText||L.$slots.default)&&L.textInside?($(),le("div",{key:0,class:K(p(a).be("bar","innerText"))},[Ne(L.$slots,"default",{percentage:L.percentage},()=>[ue("span",null,ot(p(N)),1)])],2)):De("v-if",!0)],6)],6)],2)):($(),le("div",{key:1,class:K(p(a).b("circle")),style:jt({height:`${L.width}px`,width:`${L.width}px`})},[($(),le("svg",{viewBox:"0 0 100 100"},[ue("path",{class:K(p(a).be("circle","track")),d:p(v),stroke:`var(${p(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":L.strokeLinecap,"stroke-width":p(d),fill:"none",style:jt(p(S))},null,14,["d","stroke","stroke-linecap","stroke-width"]),ue("path",{class:K(p(a).be("circle","path")),d:p(v),stroke:p(w),fill:"none",opacity:L.percentage?1:0,"stroke-linecap":L.strokeLinecap,"stroke-width":p(d),style:jt(p(C))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(L.showText||L.$slots.default)&&!L.textInside?($(),le("div",{key:2,class:K(p(a).e("text")),style:jt({fontSize:`${p(R)}px`})},[Ne(L.$slots,"default",{percentage:L.percentage},()=>[L.status?($(),Ve(p(Dt),{key:1},{default:Ce(()=>[($(),Ve(gn(p(I))))]),_:1})):($(),le("span",{key:0},ot(p(N)),1))])],6)):De("v-if",!0)],10,["aria-valuenow"]))}});var c1e=dt(a1e,[["__file","progress.vue"]]);const Az=rn(c1e),l1e=ut({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:Re([Array,Object]),default:()=>lo(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:Re([Array,Object]),default:()=>[Tb,Tb,Tb]},voidIcon:{type:yr,default:()=>ebe},disabledVoidIcon:{type:yr,default:()=>Tb},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:Re(Array),default:()=>lo(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Ho,clearable:Boolean,...Cs(["ariaLabel"])}),u1e={[yn]:t=>$t(t),[Jt]:t=>$t(t)},d1e=me({name:"ElRate"}),h1e=me({...d1e,props:l1e,emits:u1e,setup(t,{expose:o,emit:s}){const a=t;function l(X,ie){const se=be=>fn(be),J=Object.keys(ie).map(be=>+be).filter(be=>{const Ae=ie[be];return(se(Ae)?Ae.excluded:!1)?X<be:X<=be}).sort((be,Ae)=>be-Ae),pe=ie[J[0]];return se(pe)&&pe.value||pe}const d=It(Kh,void 0),h=It(fl,void 0),v=xo(),g=Qe("rate"),{inputId:E,isLabeledByFormItem:b}=Ka(a,{formItemContext:h}),S=ee(a.modelValue),C=ee(-1),w=ee(!0),I=U(()=>[g.b(),g.m(v.value)]),R=U(()=>a.disabled||(d==null?void 0:d.disabled)),N=U(()=>g.cssVarBlock({"void-color":a.voidColor,"disabled-void-color":a.disabledVoidColor,"fill-color":D.value})),O=U(()=>{let X="";return a.showScore?X=a.scoreTemplate.replace(/\{\s*value\s*\}/,R.value?`${a.modelValue}`:`${S.value}`):a.showText&&(X=a.texts[Math.ceil(S.value)-1]),X}),V=U(()=>a.modelValue*100-Math.floor(a.modelValue)*100),L=U(()=>st(a.colors)?{[a.lowThreshold]:a.colors[0],[a.highThreshold]:{value:a.colors[1],excluded:!0},[a.max]:a.colors[2]}:a.colors),D=U(()=>{const X=l(S.value,L.value);return fn(X)?"":X}),M=U(()=>{let X="";return R.value?X=`${V.value}%`:a.allowHalf&&(X="50%"),{color:D.value,width:X}}),F=U(()=>{let X=st(a.icons)?[...a.icons]:{...a.icons};return X=Zl(X),st(X)?{[a.lowThreshold]:X[0],[a.highThreshold]:{value:X[1],excluded:!0},[a.max]:X[2]}:X}),W=U(()=>l(a.modelValue,F.value)),z=U(()=>R.value?Mt(a.disabledVoidIcon)?a.disabledVoidIcon:Zl(a.disabledVoidIcon):Mt(a.voidIcon)?a.voidIcon:Zl(a.voidIcon)),G=U(()=>l(S.value,F.value));function Y(X){const ie=R.value&&V.value>0&&X-1<a.modelValue&&X>a.modelValue,se=a.allowHalf&&w.value&&X-.5<=S.value&&X>S.value;return ie||se}function te(X){a.clearable&&X===a.modelValue&&(X=0),s(Jt,X),a.modelValue!==X&&s(yn,X)}function Z(X){R.value||(a.allowHalf&&w.value?te(S.value):te(X))}function fe(X){if(R.value)return;let ie=S.value;const se=X.code;return se===Ct.up||se===Ct.right?(a.allowHalf?ie+=.5:ie+=1,X.stopPropagation(),X.preventDefault()):(se===Ct.left||se===Ct.down)&&(a.allowHalf?ie-=.5:ie-=1,X.stopPropagation(),X.preventDefault()),ie=ie<0?0:ie,ie=ie>a.max?a.max:ie,s(Jt,ie),s(yn,ie),ie}function Ee(X,ie){if(!R.value){if(a.allowHalf&&ie){let se=ie.target;Fi(se,g.e("item"))&&(se=se.querySelector(`.${g.e("icon")}`)),(se.clientWidth===0||Fi(se,g.e("decimal")))&&(se=se.parentNode),w.value=ie.offsetX*2<=se.clientWidth,S.value=w.value?X-.5:X}else S.value=X;C.value=X}}function ae(){R.value||(a.allowHalf&&(w.value=a.modelValue!==Math.floor(a.modelValue)),S.value=a.modelValue,C.value=-1)}return ze(()=>a.modelValue,X=>{S.value=X,w.value=a.modelValue!==Math.floor(a.modelValue)}),a.modelValue||s(Jt,0),o({setCurrentValue:Ee,resetCurrentValue:ae}),(X,ie)=>{var se;return $(),le("div",{id:p(E),class:K([p(I),p(g).is("disabled",p(R))]),role:"slider","aria-label":p(b)?void 0:X.ariaLabel||"rating","aria-labelledby":p(b)?(se=p(h))==null?void 0:se.labelId:void 0,"aria-valuenow":S.value,"aria-valuetext":p(O)||void 0,"aria-valuemin":"0","aria-valuemax":X.max,tabindex:"0",style:jt(p(N)),onKeydown:fe},[($(!0),le(Ut,null,Cn(X.max,(J,pe)=>($(),le("span",{key:pe,class:K(p(g).e("item")),onMousemove:be=>Ee(J,be),onMouseleave:ae,onClick:be=>Z(J)},[ge(p(Dt),{class:K([p(g).e("icon"),{hover:C.value===J},p(g).is("active",J<=S.value)])},{default:Ce(()=>[Y(J)?De("v-if",!0):($(),le(Ut,{key:0},[ln(($(),Ve(gn(p(G)),null,null,512)),[[Wn,J<=S.value]]),ln(($(),Ve(gn(p(z)),null,null,512)),[[Wn,!(J<=S.value)]])],64)),Y(J)?($(),le(Ut,{key:1},[($(),Ve(gn(p(z)),{class:K([p(g).em("decimal","box")])},null,8,["class"])),ge(p(Dt),{style:jt(p(M)),class:K([p(g).e("icon"),p(g).e("decimal")])},{default:Ce(()=>[($(),Ve(gn(p(W))))]),_:1},8,["style","class"])],64)):De("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),X.showText||X.showScore?($(),le("span",{key:0,class:K(p(g).e("text")),style:jt({color:X.textColor})},ot(p(O)),7)):De("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var f1e=dt(h1e,[["__file","rate.vue"]]);const p1e=rn(f1e),wp={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},LH={[wp.success]:hye,[wp.warning]:v0,[wp.error]:zN,[wp.info]:YN},m1e=ut({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),v1e=me({name:"ElResult"}),g1e=me({...v1e,props:m1e,setup(t){const o=t,s=Qe("result"),a=U(()=>{const l=o.icon,d=l&&wp[l]?wp[l]:"icon-info",h=LH[d]||LH["icon-info"];return{class:d,component:h}});return(l,d)=>($(),le("div",{class:K(p(s).b())},[ue("div",{class:K(p(s).e("icon"))},[Ne(l.$slots,"icon",{},()=>[p(a).component?($(),Ve(gn(p(a).component),{key:0,class:K(p(a).class)},null,8,["class"])):De("v-if",!0)])],2),l.title||l.$slots.title?($(),le("div",{key:0,class:K(p(s).e("title"))},[Ne(l.$slots,"title",{},()=>[ue("p",null,ot(l.title),1)])],2)):De("v-if",!0),l.subTitle||l.$slots["sub-title"]?($(),le("div",{key:1,class:K(p(s).e("subtitle"))},[Ne(l.$slots,"sub-title",{},()=>[ue("p",null,ot(l.subTitle),1)])],2)):De("v-if",!0),l.$slots.extra?($(),le("div",{key:2,class:K(p(s).e("extra"))},[Ne(l.$slots,"extra")],2)):De("v-if",!0)],2))}});var _1e=dt(g1e,[["__file","result.vue"]]);const E1e=rn(_1e),y1e=["start","center","end","space-around","space-between","space-evenly"],b1e=["top","middle","bottom"],S1e=ut({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:y1e,default:"start"},align:{type:String,values:b1e}}),T1e=me({name:"ElRow"}),C1e=me({...T1e,props:S1e,setup(t){const o=t,s=Qe("row"),a=U(()=>o.gutter);wn(IG,{gutter:a});const l=U(()=>{const h={};return o.gutter&&(h.marginRight=h.marginLeft=`-${o.gutter/2}px`),h}),d=U(()=>[s.b(),s.is(`justify-${o.justify}`,o.justify!=="start"),s.is(`align-${o.align}`,!!o.align)]);return(h,v)=>($(),Ve(gn(h.tag),{class:K(p(d)),style:jt(p(l))},{default:Ce(()=>[Ne(h.$slots,"default")]),_:3},8,["class","style"]))}});var w1e=dt(C1e,[["__file","row.vue"]]);const R1e=rn(w1e),I1e=me({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:Qe("select")}}});function A1e(t,o,s,a,l,d){return $(),le("div",{class:K(t.ns.be("group","title")),style:jt({...t.style,lineHeight:`${t.height}px`})},ot(t.item.label),7)}var O1e=dt(I1e,[["render",A1e],["__file","group-item.vue"]]);function N1e(t,{emit:o}){return{hoverItem:()=>{t.disabled||o("hover",t.index)},selectOptionClick:()=>{t.disabled||o("select",t.item,t.index)}}}const Oz={label:"label",value:"value",disabled:"disabled",options:"options"};function R0(t){const o=U(()=>({...Oz,...t.props}));return{aliasProps:o,getLabel:h=>Oo(h,o.value.label),getValue:h=>Oo(h,o.value.value),getDisabled:h=>Oo(h,o.value.disabled),getOptions:h=>Oo(h,o.value.options)}}const k1e=ut({allowCreate:Boolean,autocomplete:{type:Re(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:yr,default:du},effect:{type:Re(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:Re([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Re(Array),required:!0},placeholder:{type:String},teleported:ss.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Re(Object),default:()=>({})},remote:Boolean,size:Ho,props:{type:Re(Object),default:()=>Oz},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:Re(String),values:hu,default:"bottom-start"},fallbackPlacements:{type:Re(Array),default:["bottom-start","top-start","right","left"]},tagType:{...nu.type,default:"info"},tagEffect:{...nu.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:String,fitInputWidth:{type:[Boolean,Number],default:!0,validator(t){return wr(t)||$t(t)}},...pm,...Cs(["ariaLabel"])}),P1e=ut({data:Array,disabled:Boolean,hovering:Boolean,item:{type:Re(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),D1e={[Jt]:t=>!0,[yn]:t=>!0,"remove-tag":t=>!0,"visible-change":t=>!0,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0},L1e={hover:t=>$t(t),select:(t,o)=>!0},Lk=Symbol("ElSelectV2Injection"),M1e=me({props:P1e,emits:L1e,setup(t,{emit:o}){const s=It(Lk),a=Qe("select"),{hoverItem:l,selectOptionClick:d}=N1e(t,{emit:o}),{getLabel:h}=R0(s.props);return{ns:a,hoverItem:l,selectOptionClick:d,getLabel:h}}});function x1e(t,o,s,a,l,d){return $(),le("li",{"aria-selected":t.selected,style:jt(t.style),class:K([t.ns.be("dropdown","item"),t.ns.is("selected",t.selected),t.ns.is("disabled",t.disabled),t.ns.is("created",t.created),t.ns.is("hovering",t.hovering)]),onMousemove:t.hoverItem,onClick:Gt(t.selectOptionClick,["stop"])},[Ne(t.$slots,"default",{item:t.item,index:t.index,disabled:t.disabled},()=>[ue("span",null,ot(t.getLabel(t.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var U1e=dt(M1e,[["render",x1e],["__file","option-item.vue"]]),MH=Number.isNaN||function(o){return typeof o=="number"&&o!==o};function V1e(t,o){return!!(t===o||MH(t)&&MH(o))}function F1e(t,o){if(t.length!==o.length)return!1;for(var s=0;s<t.length;s++)if(!V1e(t[s],o[s]))return!1;return!0}function B1e(t,o){o===void 0&&(o=F1e);var s=null;function a(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];if(s&&s.lastThis===this&&o(l,s.lastArgs))return s.lastResult;var h=t.apply(this,l);return s={lastResult:h,lastArgs:l,lastThis:this},h}return a.clear=function(){s=null},a}const Nz=()=>{const o=mn().proxy.$props;return U(()=>{const s=(a,l,d)=>({});return o.perfMode?l0(s):B1e(s)})},_O=50,NS="itemRendered",kS="scroll",Rp="forward",PS="backward",Va="auto",I0="smart",Hg="start",al="center",Wg="end",em="horizontal",Mk="vertical",j1e="ltr",Up="rtl",Kg="negative",xk="positive-ascending",Uk="positive-descending",$1e={[em]:"left",[Mk]:"top"},H1e=20,W1e={[em]:"deltaX",[Mk]:"deltaY"},K1e=({atEndEdge:t,atStartEdge:o,layout:s},a)=>{let l,d=0;const h=g=>g<0&&o.value||g>0&&t.value;return{hasReachedEdge:h,onWheel:g=>{xh(l);const E=g[W1e[s.value]];h(d)&&h(d+E)||(d+=E,_0()||g.preventDefault(),l=ld(()=>{a(d),d=0}))}}},EO=Ic({type:Re([Number,Function]),required:!0}),yO=Ic({type:Number}),bO=Ic({type:Number,default:2}),G1e=Ic({type:String,values:["ltr","rtl"],default:"ltr"}),SO=Ic({type:Number,default:0}),DS=Ic({type:Number,required:!0}),kz=Ic({type:String,values:["horizontal","vertical"],default:Mk}),Pz=ut({className:{type:String,default:""},containerElement:{type:Re([String,Object]),default:"div"},data:{type:Re(Array),default:()=>lo([])},direction:G1e,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:Re([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),Dz=ut({cache:bO,estimatedItemSize:yO,layout:kz,initScrollOffset:SO,total:DS,itemSize:EO,...Pz}),TO={type:Number,default:6},Lz={type:Number,default:0},Mz={type:Number,default:2},Oh=ut({columnCache:bO,columnWidth:EO,estimatedColumnWidth:yO,estimatedRowHeight:yO,initScrollLeft:SO,initScrollTop:SO,itemKey:{type:Re(Function),default:({columnIndex:t,rowIndex:o})=>`${o}:${t}`},rowCache:bO,rowHeight:EO,totalColumn:DS,totalRow:DS,hScrollbarSize:TO,vScrollbarSize:TO,scrollbarStartGap:Lz,scrollbarEndGap:Mz,role:String,...Pz}),xz=ut({alwaysOn:Boolean,class:String,layout:kz,total:DS,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:TO,startGap:Lz,endGap:Mz,visible:Boolean}),Sh=(t,o)=>t<o?Rp:PS,Gg=t=>t===j1e||t===Up||t===em,xH=t=>t===Up;let vp=null;function LS(t=!1){if(vp===null||t){const o=document.createElement("div"),s=o.style;s.width="50px",s.height="50px",s.overflow="scroll",s.direction="rtl";const a=document.createElement("div"),l=a.style;return l.width="100px",l.height="100px",o.appendChild(a),document.body.appendChild(o),o.scrollLeft>0?vp=Uk:(o.scrollLeft=1,o.scrollLeft===0?vp=Kg:vp=xk),document.body.removeChild(o),vp}return vp}function z1e({move:t,size:o,bar:s},a){const l={},d=`translate${s.axis}(${t}px)`;return l[s.size]=o,l.transform=d,l.msTransform=d,l.webkitTransform=d,a==="horizontal"?l.height="100%":l.width="100%",l}const CO=me({name:"ElVirtualScrollBar",props:xz,emits:["scroll","start-move","stop-move"],setup(t,{emit:o}){const s=U(()=>t.startGap+t.endGap),a=Qe("virtual-scrollbar"),l=Qe("scrollbar"),d=ee(),h=ee();let v=null,g=null;const E=er({isDragging:!1,traveled:0}),b=U(()=>TK[t.layout]),S=U(()=>t.clientSize-p(s)),C=U(()=>({position:"absolute",width:`${em===t.layout?S.value:t.scrollbarSize}px`,height:`${em===t.layout?t.scrollbarSize:S.value}px`,[$1e[t.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),w=U(()=>{const F=t.ratio,W=t.clientSize;if(F>=100)return Number.POSITIVE_INFINITY;if(F>=50)return F*W/100;const z=W/3;return Math.floor(Math.min(Math.max(F*W,H1e),z))}),I=U(()=>{if(!Number.isFinite(w.value))return{display:"none"};const F=`${w.value}px`;return z1e({bar:b.value,size:F,move:E.traveled},t.layout)}),R=U(()=>Math.floor(t.clientSize-w.value-p(s))),N=()=>{window.addEventListener("mousemove",D),window.addEventListener("mouseup",L);const F=p(h);F&&(g=document.onselectstart,document.onselectstart=()=>!1,F.addEventListener("touchmove",D,{passive:!0}),F.addEventListener("touchend",L))},O=()=>{window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",L),document.onselectstart=g,g=null;const F=p(h);F&&(F.removeEventListener("touchmove",D),F.removeEventListener("touchend",L))},V=F=>{F.stopImmediatePropagation(),!(F.ctrlKey||[1,2].includes(F.button))&&(E.isDragging=!0,E[b.value.axis]=F.currentTarget[b.value.offset]-(F[b.value.client]-F.currentTarget.getBoundingClientRect()[b.value.direction]),o("start-move"),N())},L=()=>{E.isDragging=!1,E[b.value.axis]=0,o("stop-move"),O()},D=F=>{const{isDragging:W}=E;if(!W||!h.value||!d.value)return;const z=E[b.value.axis];if(!z)return;xh(v);const G=(d.value.getBoundingClientRect()[b.value.direction]-F[b.value.client])*-1,Y=h.value[b.value.offset]-z,te=G-Y;v=ld(()=>{E.traveled=Math.max(t.startGap,Math.min(te,R.value)),o("scroll",te,R.value)})},M=F=>{const W=Math.abs(F.target.getBoundingClientRect()[b.value.direction]-F[b.value.client]),z=h.value[b.value.offset]/2,G=W-z;E.traveled=Math.max(0,Math.min(G,R.value)),o("scroll",G,R.value)};return ze(()=>t.scrollFrom,F=>{E.isDragging||(E.traveled=Math.ceil(F*R.value))}),Rr(()=>{O()}),()=>Ht("div",{role:"presentation",ref:d,class:[a.b(),t.class,(t.alwaysOn||E.isDragging)&&"always-on"],style:C.value,onMousedown:Gt(M,["stop","prevent"]),onTouchstartPrevent:V},Ht("div",{ref:h,class:l.e("thumb"),style:I.value,onMousedown:V},[]))}}),Uz=({name:t,getOffset:o,getItemSize:s,getItemOffset:a,getEstimatedTotalSize:l,getStartIndexForOffset:d,getStopIndexForStartIndex:h,initCache:v,clearCache:g,validateProps:E})=>me({name:t??"ElVirtualList",props:Dz,emits:[NS,kS],setup(b,{emit:S,expose:C}){E(b);const w=mn(),I=Qe("vl"),R=ee(v(b,w)),N=Nz(),O=ee(),V=ee(),L=ee(),D=ee({isScrolling:!1,scrollDir:"forward",scrollOffset:$t(b.initScrollOffset)?b.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:b.scrollbarAlwaysOn}),M=U(()=>{const{total:_e,cache:Me}=b,{isScrolling:Fe,scrollDir:Le,scrollOffset:Pe}=p(D);if(_e===0)return[0,0,0,0];const He=d(b,Pe,p(R)),We=h(b,He,Pe,p(R)),yt=!Fe||Le===PS?Math.max(1,Me):1,it=!Fe||Le===Rp?Math.max(1,Me):1;return[Math.max(0,He-yt),Math.max(0,Math.min(_e-1,We+it)),He,We]}),F=U(()=>l(b,p(R))),W=U(()=>Gg(b.layout)),z=U(()=>[{position:"relative",[`overflow-${W.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:b.direction,height:$t(b.height)?`${b.height}px`:b.height,width:$t(b.width)?`${b.width}px`:b.width},b.style]),G=U(()=>{const _e=p(F),Me=p(W);return{height:Me?"100%":`${_e}px`,pointerEvents:p(D).isScrolling?"none":void 0,width:Me?`${_e}px`:"100%"}}),Y=U(()=>W.value?b.width:b.height),{onWheel:te}=K1e({atStartEdge:U(()=>D.value.scrollOffset<=0),atEndEdge:U(()=>D.value.scrollOffset>=F.value),layout:U(()=>b.layout)},_e=>{var Me,Fe;(Fe=(Me=L.value).onMouseUp)==null||Fe.call(Me),ie(Math.min(D.value.scrollOffset+_e,F.value-Y.value))});gr(O,"wheel",te,{passive:!1});const Z=()=>{const{total:_e}=b;if(_e>0){const[Pe,He,We,yt]=p(M);S(NS,Pe,He,We,yt)}const{scrollDir:Me,scrollOffset:Fe,updateRequested:Le}=p(D);S(kS,Me,Fe,Le)},fe=_e=>{const{clientHeight:Me,scrollHeight:Fe,scrollTop:Le}=_e.currentTarget,Pe=p(D);if(Pe.scrollOffset===Le)return;const He=Math.max(0,Math.min(Le,Fe-Me));D.value={...Pe,isScrolling:!0,scrollDir:Sh(Pe.scrollOffset,He),scrollOffset:He,updateRequested:!1},Vt(pe)},Ee=_e=>{const{clientWidth:Me,scrollLeft:Fe,scrollWidth:Le}=_e.currentTarget,Pe=p(D);if(Pe.scrollOffset===Fe)return;const{direction:He}=b;let We=Fe;if(He===Up)switch(LS()){case Kg:{We=-Fe;break}case Uk:{We=Le-Me-Fe;break}}We=Math.max(0,Math.min(We,Le-Me)),D.value={...Pe,isScrolling:!0,scrollDir:Sh(Pe.scrollOffset,We),scrollOffset:We,updateRequested:!1},Vt(pe)},ae=_e=>{p(W)?Ee(_e):fe(_e),Z()},X=(_e,Me)=>{const Fe=(F.value-Y.value)/Me*_e;ie(Math.min(F.value-Y.value,Fe))},ie=_e=>{_e=Math.max(_e,0),_e!==p(D).scrollOffset&&(D.value={...p(D),scrollOffset:_e,scrollDir:Sh(p(D).scrollOffset,_e),updateRequested:!0},Vt(pe))},se=(_e,Me=Va)=>{const{scrollOffset:Fe}=p(D);_e=Math.max(0,Math.min(_e,b.total-1)),ie(o(b,_e,Me,Fe,p(R)))},J=_e=>{const{direction:Me,itemSize:Fe,layout:Le}=b,Pe=N.value(g&&Fe,g&&Le,g&&Me);let He;if(zn(Pe,String(_e)))He=Pe[_e];else{const We=a(b,_e,p(R)),yt=s(b,_e,p(R)),it=p(W),ce=Me===Up,Se=it?We:0;Pe[_e]=He={position:"absolute",left:ce?void 0:`${Se}px`,right:ce?`${Se}px`:void 0,top:it?0:`${We}px`,height:it?"100%":`${yt}px`,width:it?`${yt}px`:"100%"}}return He},pe=()=>{D.value.isScrolling=!1,Vt(()=>{N.value(-1,null,null)})},be=()=>{const _e=O.value;_e&&(_e.scrollTop=0)};dn(()=>{if(!Vn)return;const{initScrollOffset:_e}=b,Me=p(O);$t(_e)&&Me&&(p(W)?Me.scrollLeft=_e:Me.scrollTop=_e),Z()}),wc(()=>{const{direction:_e,layout:Me}=b,{scrollOffset:Fe,updateRequested:Le}=p(D),Pe=p(O);if(Le&&Pe)if(Me===em)if(_e===Up)switch(LS()){case Kg:{Pe.scrollLeft=-Fe;break}case xk:{Pe.scrollLeft=Fe;break}default:{const{clientWidth:He,scrollWidth:We}=Pe;Pe.scrollLeft=We-He-Fe;break}}else Pe.scrollLeft=Fe;else Pe.scrollTop=Fe}),gN(()=>{p(O).scrollTop=p(D).scrollOffset});const Ae={ns:I,clientSize:Y,estimatedTotalSize:F,windowStyle:z,windowRef:O,innerRef:V,innerStyle:G,itemsToRender:M,scrollbarRef:L,states:D,getItemStyle:J,onScroll:ae,onScrollbarScroll:X,onWheel:te,scrollTo:ie,scrollToItem:se,resetScrollTop:be};return C({windowRef:O,innerRef:V,getItemStyleCache:N,scrollTo:ie,scrollToItem:se,resetScrollTop:be,states:D}),Ae},render(b){var S;const{$slots:C,className:w,clientSize:I,containerElement:R,data:N,getItemStyle:O,innerElement:V,itemsToRender:L,innerStyle:D,layout:M,total:F,onScroll:W,onScrollbarScroll:z,states:G,useIsScrolling:Y,windowStyle:te,ns:Z}=b,[fe,Ee]=L,ae=gn(R),X=gn(V),ie=[];if(F>0)for(let be=fe;be<=Ee;be++)ie.push(Ht(Ut,{key:be},(S=C.default)==null?void 0:S.call(C,{data:N,index:be,isScrolling:Y?G.isScrolling:void 0,style:O(be)})));const se=[Ht(X,{style:D,ref:"innerRef"},Mt(X)?ie:{default:()=>ie})],J=Ht(CO,{ref:"scrollbarRef",clientSize:I,layout:M,onScroll:z,ratio:I*100/this.estimatedTotalSize,scrollFrom:G.scrollOffset/(this.estimatedTotalSize-I),total:F}),pe=Ht(ae,{class:[Z.e("window"),w],style:te,onScroll:W,ref:"windowRef",key:0},Mt(ae)?[se]:{default:()=>[se]});return Ht("div",{key:0,class:[Z.e("wrapper"),G.scrollbarAlwaysOn?"always-on":""]},[pe,J])}}),Vz=Uz({name:"ElFixedSizeList",getItemOffset:({itemSize:t},o)=>o*t,getItemSize:({itemSize:t})=>t,getEstimatedTotalSize:({total:t,itemSize:o})=>o*t,getOffset:({height:t,total:o,itemSize:s,layout:a,width:l},d,h,v)=>{const g=Gg(a)?l:t,E=Math.max(0,o*s-g),b=Math.min(E,d*s),S=Math.max(0,(d+1)*s-g);switch(h===I0&&(v>=S-g&&v<=b+g?h=Va:h=al),h){case Hg:return b;case Wg:return S;case al:{const C=Math.round(S+(b-S)/2);return C<Math.ceil(g/2)?0:C>E+Math.floor(g/2)?E:C}case Va:default:return v>=S&&v<=b?v:v<S?S:b}},getStartIndexForOffset:({total:t,itemSize:o},s)=>Math.max(0,Math.min(t-1,Math.floor(s/o))),getStopIndexForStartIndex:({height:t,total:o,itemSize:s,layout:a,width:l},d,h)=>{const v=d*s,g=Gg(a)?l:t,E=Math.ceil((g+h-v)/s);return Math.max(0,Math.min(o-1,d+E-1))},initCache(){},clearCache:!0,validateProps(){}}),Ip=(t,o,s)=>{const{itemSize:a}=t,{items:l,lastVisitedIndex:d}=s;if(o>d){let h=0;if(d>=0){const v=l[d];h=v.offset+v.size}for(let v=d+1;v<=o;v++){const g=a(v);l[v]={offset:h,size:g},h+=g}s.lastVisitedIndex=o}return l[o]},Y1e=(t,o,s)=>{const{items:a,lastVisitedIndex:l}=o;return(l>0?a[l].offset:0)>=s?Fz(t,o,0,l,s):q1e(t,o,Math.max(0,l),s)},Fz=(t,o,s,a,l)=>{for(;s<=a;){const d=s+Math.floor((a-s)/2),h=Ip(t,d,o).offset;if(h===l)return d;h<l?s=d+1:h>l&&(a=d-1)}return Math.max(0,s-1)},q1e=(t,o,s,a)=>{const{total:l}=t;let d=1;for(;s<l&&Ip(t,s,o).offset<a;)s+=d,d*=2;return Fz(t,o,Math.floor(s/2),Math.min(s,l-1),a)},UH=({total:t},{items:o,estimatedItemSize:s,lastVisitedIndex:a})=>{let l=0;if(a>=t&&(a=t-1),a>=0){const v=o[a];l=v.offset+v.size}const h=(t-a-1)*s;return l+h},X1e=Uz({name:"ElDynamicSizeList",getItemOffset:(t,o,s)=>Ip(t,o,s).offset,getItemSize:(t,o,{items:s})=>s[o].size,getEstimatedTotalSize:UH,getOffset:(t,o,s,a,l)=>{const{height:d,layout:h,width:v}=t,g=Gg(h)?v:d,E=Ip(t,o,l),b=UH(t,l),S=Math.max(0,Math.min(b-g,E.offset)),C=Math.max(0,E.offset-g+E.size);switch(s===I0&&(a>=C-g&&a<=S+g?s=Va:s=al),s){case Hg:return S;case Wg:return C;case al:return Math.round(C+(S-C)/2);case Va:default:return a>=C&&a<=S?a:a<C?C:S}},getStartIndexForOffset:(t,o,s)=>Y1e(t,s,o),getStopIndexForStartIndex:(t,o,s,a)=>{const{height:l,total:d,layout:h,width:v}=t,g=Gg(h)?v:l,E=Ip(t,o,a),b=s+g;let S=E.offset+E.size,C=o;for(;C<d-1&&S<b;)C++,S+=Ip(t,C,a).size;return C},initCache({estimatedItemSize:t=_O},o){const s={items:{},estimatedItemSize:t,lastVisitedIndex:-1};return s.clearCacheAfterIndex=(a,l=!0)=>{var d,h;s.lastVisitedIndex=Math.min(s.lastVisitedIndex,a-1),(d=o.exposed)==null||d.getItemStyleCache(-1),l&&((h=o.proxy)==null||h.$forceUpdate())},s},clearCache:!1,validateProps:({itemSize:t})=>{}}),J1e={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var Z1e=me({name:"ElSelectDropdown",props:J1e,setup(t,{slots:o,expose:s}){const a=It(Lk),l=Qe("select"),{getLabel:d,getValue:h,getDisabled:v}=R0(a.props),g=ee([]),E=ee(),b=U(()=>t.data.length);ze(()=>b.value,()=>{var te,Z;(Z=(te=a.tooltipRef.value).updatePopper)==null||Z.call(te)});const S=U(()=>Xn(a.props.estimatedOptionHeight)),C=U(()=>S.value?{itemSize:a.props.itemHeight}:{estimatedSize:a.props.estimatedOptionHeight,itemSize:te=>g.value[te]}),w=(te=[],Z)=>{const{props:{valueKey:fe}}=a;return fn(Z)?te&&te.some(Ee=>Tr(Oo(Ee,fe))===Oo(Z,fe)):te.includes(Z)},I=(te,Z)=>{if(fn(Z)){const{valueKey:fe}=a.props;return Oo(te,fe)===Oo(Z,fe)}else return te===Z},R=(te,Z)=>a.props.multiple?w(te,h(Z)):I(te,h(Z)),N=(te,Z)=>{const{disabled:fe,multiple:Ee,multipleLimit:ae}=a.props;return fe||!Z&&(Ee?ae>0&&te.length>=ae:!1)},O=te=>t.hoveringIndex===te;s({listRef:E,isSized:S,isItemDisabled:N,isItemHovering:O,isItemSelected:R,scrollToItem:te=>{const Z=E.value;Z&&Z.scrollToItem(te)},resetScrollTop:()=>{const te=E.value;te&&te.resetScrollTop()}});const M=te=>{const{index:Z,data:fe,style:Ee}=te,ae=p(S),{itemSize:X,estimatedSize:ie}=p(C),{modelValue:se}=a.props,{onSelect:J,onHover:pe}=a,be=fe[Z];if(be.type==="Group")return ge(O1e,{item:be,style:Ee,height:ae?X:ie},null);const Ae=R(se,be),_e=N(se,Ae),Me=O(Z);return ge(U1e,En(te,{selected:Ae,disabled:v(be)||_e,created:!!be.created,hovering:Me,item:be,onSelect:J,onHover:pe}),{default:Fe=>{var Le;return((Le=o.default)==null?void 0:Le.call(o,Fe))||ge("span",null,[d(be)])}})},{onKeyboardNavigate:F,onKeyboardSelect:W}=a,z=()=>{F("forward")},G=()=>{F("backward")},Y=te=>{const{code:Z}=te,{tab:fe,esc:Ee,down:ae,up:X,enter:ie,numpadEnter:se}=Ct;switch([Ee,ae,X,ie,se].includes(Z)&&(te.preventDefault(),te.stopPropagation()),Z){case fe:case Ee:break;case ae:z();break;case X:G();break;case ie:case se:W();break}};return()=>{var te,Z,fe,Ee;const{data:ae,width:X}=t,{height:ie,multiple:se,scrollbarAlwaysOn:J}=a.props,pe=U(()=>bS?!0:J),be=p(S)?Vz:X1e;return ge("div",{class:[l.b("dropdown"),l.is("multiple",se)],style:{width:`${X}px`}},[(te=o.header)==null?void 0:te.call(o),((Z=o.loading)==null?void 0:Z.call(o))||((fe=o.empty)==null?void 0:fe.call(o))||ge(be,En({ref:E},p(C),{className:l.be("dropdown","list"),scrollbarAlwaysOn:pe.value,data:ae,height:ie,width:X,total:ae.length,onKeydown:Y}),{default:Ae=>ge(M,Ae,null)}),(Ee=o.footer)==null?void 0:Ee.call(o)])}}});function Q1e(t,o){const{aliasProps:s,getLabel:a,getValue:l}=R0(t),d=ee(0),h=ee(),v=U(()=>t.allowCreate&&t.filterable);function g(w){const I=R=>a(R)===w;return t.options&&t.options.some(I)||o.createdOptions.some(I)}function E(w){v.value&&(t.multiple&&w.created?d.value++:h.value=w)}function b(w){if(v.value)if(w&&w.length>0){if(g(w))return;const I={[s.value.value]:w,[s.value.label]:w,created:!0,[s.value.disabled]:!1};o.createdOptions.length>=d.value?o.createdOptions[d.value]=I:o.createdOptions.push(I)}else if(t.multiple)o.createdOptions.length=d.value;else{const I=h.value;o.createdOptions.length=0,I&&I.created&&o.createdOptions.push(I)}}function S(w){if(!v.value||!w||!w.created||w.created&&t.reserveKeyword&&o.inputValue===a(w))return;const I=o.createdOptions.findIndex(R=>l(R)===l(w));~I&&(o.createdOptions.splice(I,1),d.value--)}function C(){v.value&&(o.createdOptions.length=0,d.value=0)}return{createNewOption:b,removeNewOption:S,selectNewOption:E,clearAllNewOption:C}}const eDe=(t,o)=>{const{t:s}=Fn(),a=Qe("select"),l=Qe("input"),{form:d,formItem:h}=Vs(),{inputId:v}=Ka(t,{formItemContext:h}),{aliasProps:g,getLabel:E,getValue:b,getDisabled:S,getOptions:C}=R0(t),{valueOnClear:w,isEmptyValue:I}=f0(t),R=er({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),N=ee(-1),O=ee(),V=ee(),L=ee(),D=ee(),M=ee(),F=ee(),W=ee(),z=ee(),G=ee(),Y=ee(),{isComposing:te,handleCompositionStart:Z,handleCompositionEnd:fe,handleCompositionUpdate:Ee}=d_({afterComposition:pt=>ps(pt)}),{wrapperRef:ae,isFocused:X,handleBlur:ie}=_d(M,{beforeFocus(){return Ae.value},afterFocus(){t.automaticDropdown&&!be.value&&(be.value=!0,R.menuVisibleOnFocus=!0)},beforeBlur(pt){var zt,On;return((zt=L.value)==null?void 0:zt.isFocusInsideContent(pt))||((On=D.value)==null?void 0:On.isFocusInsideContent(pt))},afterBlur(){be.value=!1,R.menuVisibleOnFocus=!1}}),se=U(()=>Se("")),J=U(()=>t.loading?!1:t.options.length>0||R.createdOptions.length>0),pe=ee([]),be=ee(!1),Ae=U(()=>t.disabled||(d==null?void 0:d.disabled)),_e=U(()=>{var pt;return(pt=d==null?void 0:d.statusIcon)!=null?pt:!1}),Me=U(()=>{const pt=pe.value.length*t.itemHeight;return pt>t.height?t.height:pt}),Fe=U(()=>t.multiple?st(t.modelValue)&&t.modelValue.length>0:!I(t.modelValue)),Le=U(()=>t.clearable&&!Ae.value&&R.inputHovering&&Fe.value),Pe=U(()=>t.remote&&t.filterable?"":uu),He=U(()=>Pe.value&&a.is("reverse",be.value)),We=U(()=>(h==null?void 0:h.validateState)||""),yt=U(()=>{if(We.value)return g0[We.value]}),it=U(()=>t.remote?300:0),ce=U(()=>t.loading?t.loadingText||s("el.select.loading"):t.remote&&!R.inputValue&&!J.value?!1:t.filterable&&R.inputValue&&J.value&&pe.value.length===0?t.noMatchText||s("el.select.noMatch"):J.value?null:t.noDataText||s("el.select.noData")),Se=pt=>{const zt=new RegExp(pk(pt),"i"),On=t.filterable&&Ft(t.filterMethod),Gn=t.filterable&&t.remote&&Ft(t.remoteMethod),mr=ni=>On||Gn?!0:pt?zt.test(E(ni)||""):!0;return t.loading?[]:[...R.createdOptions,...t.options].reduce((ni,bl)=>{const mu=C(bl);if(st(mu)){const Jh=mu.filter(mr);Jh.length>0&&ni.push({label:E(bl),type:"Group"},...Jh)}else(t.remote||mr(bl))&&ni.push(bl);return ni},[])},je=()=>{pe.value=Se(R.inputValue)},tt=U(()=>{const pt=new Map;return se.value.forEach((zt,On)=>{pt.set($r(b(zt)),{option:zt,index:On})}),pt}),et=U(()=>{const pt=new Map;return pe.value.forEach((zt,On)=>{pt.set($r(b(zt)),{option:zt,index:On})}),pt}),Ge=U(()=>pe.value.every(pt=>S(pt))),Xe=xo(),Ye=U(()=>Xe.value==="small"?"small":"default"),ct=()=>{var pt;if($t(t.fitInputWidth)){N.value=t.fitInputWidth;return}const zt=((pt=O.value)==null?void 0:pt.offsetWidth)||200;!t.fitInputWidth&&J.value?Vt(()=>{N.value=Math.max(zt,nt())}):N.value=zt},nt=()=>{var pt,zt;const Gn=document.createElement("canvas").getContext("2d"),mr=a.be("dropdown","item"),bl=(((zt=(pt=z.value)==null?void 0:pt.listRef)==null?void 0:zt.innerRef)||document).querySelector(`.${mr}`);if(bl===null||Gn===null)return 0;const mu=getComputedStyle(bl),Jh=Number.parseFloat(mu.paddingLeft)+Number.parseFloat(mu.paddingRight);return Gn.font=mu.font,pe.value.reduce((j0,T_)=>{const $0=Gn.measureText(E(T_));return Math.max($0.width,j0)},0)+Jh},Ot=()=>{if(!V.value)return 0;const pt=window.getComputedStyle(V.value);return Number.parseFloat(pt.gap||"6px")},_t=U(()=>{const pt=Ot();return{maxWidth:`${Y.value&&t.maxCollapseTags===1?R.selectionWidth-R.collapseItemWidth-pt:R.selectionWidth}px`}}),qe=U(()=>({maxWidth:`${R.selectionWidth}px`})),wt=U(()=>st(t.modelValue)?t.modelValue.length===0&&!R.inputValue:t.filterable?!R.inputValue:!0),qt=U(()=>{var pt;const zt=(pt=t.placeholder)!=null?pt:s("el.select.placeholder");return t.multiple||!Fe.value?zt:R.selectedLabel}),sn=U(()=>{var pt,zt;return(zt=(pt=L.value)==null?void 0:pt.popperRef)==null?void 0:zt.contentRef}),tn=U(()=>{if(t.multiple){const pt=t.modelValue.length;if(t.modelValue.length>0&&et.value.has(t.modelValue[pt-1])){const{index:zt}=et.value.get(t.modelValue[pt-1]);return zt}}else if(!I(t.modelValue)&&et.value.has(t.modelValue)){const{index:pt}=et.value.get(t.modelValue);return pt}return-1}),Kn=U({get(){return be.value&&ce.value!==!1},set(pt){be.value=pt}}),Sn=U(()=>t.multiple?t.collapseTags?R.cachedOptions.slice(0,t.maxCollapseTags):R.cachedOptions:[]),zr=U(()=>t.multiple?t.collapseTags?R.cachedOptions.slice(t.maxCollapseTags):[]:[]),{createNewOption:Wt,removeNewOption:Je,selectNewOption:Ie,clearAllNewOption:Ke}=Q1e(t,R),Te=()=>{Ae.value||(R.menuVisibleOnFocus?R.menuVisibleOnFocus=!1:be.value=!be.value)},vt=()=>{R.inputValue.length>0&&!be.value&&(be.value=!0),Wt(R.inputValue),en(R.inputValue)},an=Hi(vt,it.value),en=pt=>{R.previousQuery===pt||te.value||(R.previousQuery=pt,t.filterable&&Ft(t.filterMethod)?t.filterMethod(pt):t.filterable&&t.remote&&Ft(t.remoteMethod)&&t.remoteMethod(pt),t.defaultFirstOption&&(t.filterable||t.remote)&&pe.value.length?Vt(Ir):Vt(ko))},Ir=()=>{const pt=pe.value.filter(Gn=>!Gn.disabled&&Gn.type!=="Group"),zt=pt.find(Gn=>Gn.created),On=pt[0];R.hoveringIndex=Wo(pe.value,zt||On)},yi=pt=>{as(t.modelValue,pt)||o(yn,pt)},No=pt=>{o(Jt,pt),yi(pt),R.previousValue=t.multiple?String(pt):pt},Wo=(pt=[],zt)=>{if(!fn(zt))return pt.indexOf(zt);const On=t.valueKey;let Gn=-1;return pt.some((mr,ni)=>Oo(mr,On)===Oo(zt,On)?(Gn=ni,!0):!1),Gn},$r=pt=>fn(pt)?Oo(pt,t.valueKey):pt,_r=()=>{ct()},ws=()=>{R.selectionWidth=V.value.getBoundingClientRect().width},Ga=()=>{R.collapseItemWidth=Y.value.getBoundingClientRect().width},yd=()=>{var pt,zt;(zt=(pt=L.value)==null?void 0:pt.updatePopper)==null||zt.call(pt)},yl=()=>{var pt,zt;(zt=(pt=D.value)==null?void 0:pt.updatePopper)==null||zt.call(pt)},Gh=pt=>{if(t.multiple){let zt=t.modelValue.slice();const On=Wo(zt,b(pt));On>-1?(zt=[...zt.slice(0,On),...zt.slice(On+1)],R.cachedOptions.splice(On,1),Je(pt)):(t.multipleLimit<=0||zt.length<t.multipleLimit)&&(zt=[...zt,b(pt)],R.cachedOptions.push(pt),Ie(pt),Vt(()=>{as(zt,t.modelValue)||R.cachedOptions.pop()})),No(zt),pt.created&&en(""),t.filterable&&!t.reserveKeyword&&(R.inputValue="")}else R.selectedLabel=E(pt),No(b(pt)),be.value=!1,Ie(pt),pt.created||Ke();fu()},Rs=(pt,zt)=>{let On=t.modelValue.slice();const Gn=Wo(On,b(zt));Gn>-1&&!Ae.value&&(On=[...t.modelValue.slice(0,Gn),...t.modelValue.slice(Gn+1)],R.cachedOptions.splice(Gn,1),No(On),o("remove-tag",b(zt)),Je(zt)),pt.stopPropagation(),fu()},fu=()=>{var pt;(pt=M.value)==null||pt.focus()},zh=()=>{var pt;if(be.value){be.value=!1,Vt(()=>{var zt;return(zt=M.value)==null?void 0:zt.blur()});return}(pt=M.value)==null||pt.blur()},pu=()=>{R.inputValue.length>0?R.inputValue="":be.value=!1},Yh=pt=>qW(pt,zt=>!R.cachedOptions.some(On=>b(On)===zt&&S(On))),qh=pt=>{if(t.multiple&&pt.code!==Ct.delete&&R.inputValue.length===0){pt.preventDefault();const zt=t.modelValue.slice(),On=Yh(zt);if(On<0)return;const Gn=zt[On];zt.splice(On,1);const mr=R.cachedOptions[On];R.cachedOptions.splice(On,1),Je(mr),No(zt),o("remove-tag",Gn)}},Xh=()=>{let pt;st(t.modelValue)?pt=[]:pt=w.value,t.multiple?R.cachedOptions=[]:R.selectedLabel="",be.value=!1,No(pt),o("clear"),Ke(),fu()},mt=(pt,zt=void 0)=>{const On=pe.value;if(!["forward","backward"].includes(pt)||Ae.value||On.length<=0||Ge.value||te.value)return;if(!be.value)return Te();zt===void 0&&(zt=R.hoveringIndex);let Gn=-1;pt==="forward"?(Gn=zt+1,Gn>=On.length&&(Gn=0)):pt==="backward"&&(Gn=zt-1,(Gn<0||Gn>=On.length)&&(Gn=On.length-1));const mr=On[Gn];if(S(mr)||mr.type==="Group")return mt(pt,Gn);R.hoveringIndex=Gn,Ya(Gn)},Zt=()=>{if(be.value)~R.hoveringIndex&&pe.value[R.hoveringIndex]&&Gh(pe.value[R.hoveringIndex]);else return Te()},Zn=pt=>{R.hoveringIndex=pt??-1},ko=()=>{t.multiple?R.hoveringIndex=pe.value.findIndex(pt=>t.modelValue.some(zt=>$r(zt)===$r(pt))):R.hoveringIndex=pe.value.findIndex(pt=>$r(pt)===$r(t.modelValue))},ps=pt=>{if(R.inputValue=pt.target.value,t.remote)an();else return vt()},za=pt=>{if(be.value=!1,X.value){const zt=new FocusEvent("focus",pt);ie(zt)}},bi=()=>(R.isBeforeHide=!1,Vt(()=>{~tn.value&&Ya(R.hoveringIndex)})),Ya=pt=>{z.value.scrollToItem(pt)},Si=(pt,zt)=>{const On=$r(pt);if(tt.value.has(On)){const{option:Gn}=tt.value.get(On);return Gn}if(zt&&zt.length){const Gn=zt.find(mr=>$r(b(mr))===On);if(Gn)return Gn}return{[g.value.value]:pt,[g.value.label]:pt}},bd=(pt=!1)=>{if(t.multiple)if(t.modelValue.length>0){const zt=R.cachedOptions.slice();R.cachedOptions.length=0,R.previousValue=t.modelValue.toString();for(const On of t.modelValue){const Gn=Si(On,zt);R.cachedOptions.push(Gn)}}else R.cachedOptions=[],R.previousValue=void 0;else if(Fe.value){R.previousValue=t.modelValue;const zt=pe.value,On=zt.findIndex(Gn=>$r(b(Gn))===$r(t.modelValue));~On?R.selectedLabel=E(zt[On]):(!R.selectedLabel||pt)&&(R.selectedLabel=$r(t.modelValue))}else R.selectedLabel="",R.previousValue=void 0;Ke(),ct()};return ze(()=>t.fitInputWidth,()=>{ct()}),ze(be,pt=>{pt?(t.persistent||ct(),en("")):(R.inputValue="",R.previousQuery=null,R.isBeforeHide=!0,Wt("")),o("visible-change",pt)}),ze(()=>t.modelValue,(pt,zt)=>{var On;(!pt||st(pt)&&pt.length===0||t.multiple&&!as(pt.toString(),R.previousValue)||!t.multiple&&$r(pt)!==$r(R.previousValue))&&bd(!0),!as(pt,zt)&&t.validateEvent&&((On=h==null?void 0:h.validate)==null||On.call(h,"change").catch(mr=>void 0))},{deep:!0}),ze(()=>t.options,()=>{const pt=M.value;(!pt||pt&&document.activeElement!==pt)&&bd()},{deep:!0,flush:"post"}),ze(()=>pe.value,()=>(ct(),z.value&&Vt(z.value.resetScrollTop))),Ms(()=>{R.isBeforeHide||je()}),Ms(()=>{const{valueKey:pt,options:zt}=t,On=new Map;for(const Gn of zt){const mr=b(Gn);let ni=mr;if(fn(ni)&&(ni=Oo(mr,pt)),On.get(ni))break;On.set(ni,!0)}}),dn(()=>{bd()}),co(O,_r),co(V,ws),co(z,yd),co(ae,yd),co(G,yl),co(Y,Ga),{inputId:v,collapseTagSize:Ye,currentPlaceholder:qt,expanded:be,emptyText:ce,popupHeight:Me,debounce:it,allOptions:se,filteredOptions:pe,iconComponent:Pe,iconReverse:He,tagStyle:_t,collapseTagStyle:qe,popperSize:N,dropdownMenuVisible:Kn,hasModelValue:Fe,shouldShowPlaceholder:wt,selectDisabled:Ae,selectSize:Xe,needStatusIcon:_e,showClearBtn:Le,states:R,isFocused:X,nsSelect:a,nsInput:l,inputRef:M,menuRef:z,tagMenuRef:G,tooltipRef:L,tagTooltipRef:D,selectRef:O,wrapperRef:ae,selectionRef:V,prefixRef:F,suffixRef:W,collapseItemRef:Y,popperRef:sn,validateState:We,validateIcon:yt,showTagList:Sn,collapseTagList:zr,debouncedOnInputChange:an,deleteTag:Rs,getLabel:E,getValue:b,getDisabled:S,getValueKey:$r,handleClear:Xh,handleClickOutside:za,handleDel:qh,handleEsc:pu,focus:fu,blur:zh,handleMenuEnter:bi,handleResize:_r,resetSelectionWidth:ws,updateTooltip:yd,updateTagTooltip:yl,updateOptions:je,toggleMenu:Te,scrollTo:Ya,onInput:ps,onKeyboardNavigate:mt,onKeyboardSelect:Zt,onSelect:Gh,onHover:Zn,handleCompositionStart:Z,handleCompositionEnd:fe,handleCompositionUpdate:Ee}},tDe=me({name:"ElSelectV2",components:{ElSelectMenu:Z1e,ElTag:Jp,ElTooltip:Us,ElIcon:Dt},directives:{ClickOutside:ru},props:k1e,emits:D1e,setup(t,{emit:o}){const s=U(()=>{const{modelValue:v,multiple:g}=t,E=g?[]:void 0;return st(v)?g?v:E:g?E:v}),a=eDe(er({...ds(t),modelValue:s}),o),{calculatorRef:l,inputStyle:d}=Nk();wn(Lk,{props:er({...ds(t),height:a.popupHeight,modelValue:s}),expanded:a.expanded,tooltipRef:a.tooltipRef,onSelect:a.onSelect,onHover:a.onHover,onKeyboardNavigate:a.onKeyboardNavigate,onKeyboardSelect:a.onKeyboardSelect});const h=U(()=>t.multiple?a.states.cachedOptions.map(v=>v.label):a.states.selectedLabel);return{...a,modelValue:s,selectedLabel:h,calculatorRef:l,inputStyle:d}}});function nDe(t,o,s,a,l,d){const h=_n("el-tag"),v=_n("el-tooltip"),g=_n("el-icon"),E=_n("el-select-menu"),b=t0("click-outside");return ln(($(),le("div",{ref:"selectRef",class:K([t.nsSelect.b(),t.nsSelect.m(t.selectSize)]),onMouseenter:S=>t.states.inputHovering=!0,onMouseleave:S=>t.states.inputHovering=!1},[ge(v,{ref:"tooltipRef",visible:t.dropdownMenuVisible,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":t.popperOptions,"fallback-placements":t.fallbackPlacements,effect:t.effect,placement:t.placement,pure:"",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:t.persistent,"append-to":t.appendTo,"show-arrow":t.showArrow,offset:t.offset,onBeforeShow:t.handleMenuEnter,onHide:S=>t.states.isBeforeHide=!1},{default:Ce(()=>[ue("div",{ref:"wrapperRef",class:K([t.nsSelect.e("wrapper"),t.nsSelect.is("focused",t.isFocused),t.nsSelect.is("hovering",t.states.inputHovering),t.nsSelect.is("filterable",t.filterable),t.nsSelect.is("disabled",t.selectDisabled)]),onClick:Gt(t.toggleMenu,["prevent"])},[t.$slots.prefix?($(),le("div",{key:0,ref:"prefixRef",class:K(t.nsSelect.e("prefix"))},[Ne(t.$slots,"prefix")],2)):De("v-if",!0),ue("div",{ref:"selectionRef",class:K([t.nsSelect.e("selection"),t.nsSelect.is("near",t.multiple&&!t.$slots.prefix&&!!t.modelValue.length)])},[t.multiple?Ne(t.$slots,"tag",{key:0},()=>[($(!0),le(Ut,null,Cn(t.showTagList,S=>($(),le("div",{key:t.getValueKey(t.getValue(S)),class:K(t.nsSelect.e("selected-item"))},[ge(h,{closable:!t.selectDisabled&&!t.getDisabled(S),size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,"disable-transitions":"",style:jt(t.tagStyle),onClose:C=>t.deleteTag(C,S)},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))},[Ne(t.$slots,"label",{label:t.getLabel(S),value:t.getValue(S)},()=>[bn(ot(t.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),t.collapseTags&&t.modelValue.length>t.maxCollapseTags?($(),Ve(v,{key:0,ref:"tagTooltipRef",disabled:t.dropdownMenuVisible||!t.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:Ce(()=>[ue("div",{ref:"collapseItemRef",class:K(t.nsSelect.e("selected-item"))},[ge(h,{closable:!1,size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,style:jt(t.collapseTagStyle),"disable-transitions":""},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))}," + "+ot(t.modelValue.length-t.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:Ce(()=>[ue("div",{ref:"tagMenuRef",class:K(t.nsSelect.e("selection"))},[($(!0),le(Ut,null,Cn(t.collapseTagList,S=>($(),le("div",{key:t.getValueKey(t.getValue(S)),class:K(t.nsSelect.e("selected-item"))},[ge(h,{class:"in-tooltip",closable:!t.selectDisabled&&!t.getDisabled(S),size:t.collapseTagSize,type:t.tagType,effect:t.tagEffect,"disable-transitions":"",onClose:C=>t.deleteTag(C,S)},{default:Ce(()=>[ue("span",{class:K(t.nsSelect.e("tags-text"))},[Ne(t.$slots,"label",{label:t.getLabel(S),value:t.getValue(S)},()=>[bn(ot(t.getLabel(S)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):De("v-if",!0)]):De("v-if",!0),ue("div",{class:K([t.nsSelect.e("selected-item"),t.nsSelect.e("input-wrapper"),t.nsSelect.is("hidden",!t.filterable)])},[ln(ue("input",{id:t.inputId,ref:"inputRef","onUpdate:modelValue":S=>t.states.inputValue=S,style:jt(t.inputStyle),autocomplete:t.autocomplete,tabindex:t.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":t.expanded,"aria-label":t.ariaLabel,class:K([t.nsSelect.e("input"),t.nsSelect.is(t.selectSize)]),disabled:t.selectDisabled,role:"combobox",readonly:!t.filterable,spellcheck:"false",type:"text",name:t.name,onInput:t.onInput,onCompositionstart:t.handleCompositionStart,onCompositionupdate:t.handleCompositionUpdate,onCompositionend:t.handleCompositionEnd,onKeydown:[Cr(Gt(S=>t.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),Cr(Gt(S=>t.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),Cr(Gt(t.onKeyboardSelect,["stop","prevent"]),["enter"]),Cr(Gt(t.handleEsc,["stop","prevent"]),["esc"]),Cr(Gt(t.handleDel,["stop"]),["delete"])],onClick:Gt(t.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[o0,t.states.inputValue]]),t.filterable?($(),le("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:K(t.nsSelect.e("input-calculator")),textContent:ot(t.states.inputValue)},null,10,["textContent"])):De("v-if",!0)],2),t.shouldShowPlaceholder?($(),le("div",{key:1,class:K([t.nsSelect.e("selected-item"),t.nsSelect.e("placeholder"),t.nsSelect.is("transparent",!t.hasModelValue||t.expanded&&!t.states.inputValue)])},[t.hasModelValue?Ne(t.$slots,"label",{key:0,label:t.currentPlaceholder,value:t.modelValue},()=>[ue("span",null,ot(t.currentPlaceholder),1)]):($(),le("span",{key:1},ot(t.currentPlaceholder),1))],2)):De("v-if",!0)],2),ue("div",{ref:"suffixRef",class:K(t.nsSelect.e("suffix"))},[t.iconComponent?ln(($(),Ve(g,{key:0,class:K([t.nsSelect.e("caret"),t.nsInput.e("icon"),t.iconReverse])},{default:Ce(()=>[($(),Ve(gn(t.iconComponent)))]),_:1},8,["class"])),[[Wn,!t.showClearBtn]]):De("v-if",!0),t.showClearBtn&&t.clearIcon?($(),Ve(g,{key:1,class:K([t.nsSelect.e("caret"),t.nsInput.e("icon"),t.nsSelect.e("clear")]),onClick:Gt(t.handleClear,["prevent","stop"])},{default:Ce(()=>[($(),Ve(gn(t.clearIcon)))]),_:1},8,["class","onClick"])):De("v-if",!0),t.validateState&&t.validateIcon&&t.needStatusIcon?($(),Ve(g,{key:2,class:K([t.nsInput.e("icon"),t.nsInput.e("validateIcon"),t.nsInput.is("loading",t.validateState==="validating")])},{default:Ce(()=>[($(),Ve(gn(t.validateIcon)))]),_:1},8,["class"])):De("v-if",!0)],2)],10,["onClick"])]),content:Ce(()=>[ge(E,{ref:"menuRef",data:t.filteredOptions,width:t.popperSize,"hovering-index":t.states.hoveringIndex,"scrollbar-always-on":t.scrollbarAlwaysOn},fa({default:Ce(S=>[Ne(t.$slots,"default",sa(ul(S)))]),_:2},[t.$slots.header?{name:"header",fn:Ce(()=>[ue("div",{class:K(t.nsSelect.be("dropdown","header"))},[Ne(t.$slots,"header")],2)])}:void 0,t.$slots.loading&&t.loading?{name:"loading",fn:Ce(()=>[ue("div",{class:K(t.nsSelect.be("dropdown","loading"))},[Ne(t.$slots,"loading")],2)])}:t.loading||t.filteredOptions.length===0?{name:"empty",fn:Ce(()=>[ue("div",{class:K(t.nsSelect.be("dropdown","empty"))},[Ne(t.$slots,"empty",{},()=>[ue("span",null,ot(t.emptyText),1)])],2)])}:void 0,t.$slots.footer?{name:"footer",fn:Ce(()=>[ue("div",{class:K(t.nsSelect.be("dropdown","footer"))},[Ne(t.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[b,t.handleClickOutside,t.popperRef]])}var rDe=dt(tDe,[["render",nDe],["__file","select.vue"]]);const oDe=rn(rDe),sDe=ut({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Re([Number,Object])}}),iDe=ut({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),aDe=me({name:"ElSkeletonItem"}),cDe=me({...aDe,props:iDe,setup(t){const o=Qe("skeleton");return(s,a)=>($(),le("div",{class:K([p(o).e("item"),p(o).e(s.variant)])},[s.variant==="image"?($(),Ve(p(xye),{key:0})):De("v-if",!0)],2))}});var MS=dt(cDe,[["__file","skeleton-item.vue"]]);const lDe=(t,o=0)=>{if(o===0)return t;const s=fn(o)&&!!o.initVal,a=ee(s);let l=null;const d=v=>{if(Xn(v)){a.value=t.value;return}l&&clearTimeout(l),l=setTimeout(()=>{a.value=t.value},v)},h=v=>{v==="leading"?$t(o)?d(o):d(o.leading):fn(o)?d(o.trailing):a.value=!1};return dn(()=>h("leading")),ze(()=>t.value,v=>{h(v?"leading":"trailing")}),a},uDe=me({name:"ElSkeleton"}),dDe=me({...uDe,props:sDe,setup(t,{expose:o}){const s=t,a=Qe("skeleton"),l=lDe(lr(s,"loading"),s.throttle);return o({uiLoading:l}),(d,h)=>p(l)?($(),le("div",En({key:0,class:[p(a).b(),p(a).is("animated",d.animated)]},d.$attrs),[($(!0),le(Ut,null,Cn(d.count,v=>($(),le(Ut,{key:v},[p(l)?Ne(d.$slots,"template",{key:v},()=>[ge(MS,{class:K(p(a).is("first")),variant:"p"},null,8,["class"]),($(!0),le(Ut,null,Cn(d.rows,g=>($(),Ve(MS,{key:g,class:K([p(a).e("paragraph"),p(a).is("last",g===d.rows&&d.rows>1)]),variant:"p"},null,8,["class"]))),128))]):De("v-if",!0)],64))),128))],16)):Ne(d.$slots,"default",sa(En({key:1},d.$attrs)))}});var hDe=dt(dDe,[["__file","skeleton.vue"]]);const fDe=rn(hDe,{SkeletonItem:MS}),pDe=uo(MS),Bz=Symbol("sliderContextKey"),mDe=ut({modelValue:{type:Re([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Ho,inputSize:Ho,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:Re(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:Re(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:hu,default:"top"},marks:{type:Re(Object)},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Cs(["ariaLabel"])}),vA=t=>$t(t)||st(t)&&t.every($t),vDe={[Jt]:vA,[cs]:vA,[yn]:vA},gDe=ut({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:hu,default:"top"}}),_De={[Jt]:t=>$t(t)},EDe=(t,o,s)=>{const a=ee(),l=ee(!1),d=U(()=>o.value instanceof Function),h=U(()=>d.value&&o.value(t.modelValue)||t.modelValue),v=Hi(()=>{s.value&&(l.value=!0)},50),g=Hi(()=>{s.value&&(l.value=!1)},50);return{tooltip:a,tooltipVisible:l,formatValue:h,displayTooltip:v,hideTooltip:g}},yDe=(t,o,s)=>{const{disabled:a,min:l,max:d,step:h,showTooltip:v,persistent:g,precision:E,sliderSize:b,formatTooltip:S,emitChange:C,resetSize:w,updateDragging:I}=It(Bz),{tooltip:R,tooltipVisible:N,formatValue:O,displayTooltip:V,hideTooltip:L}=EDe(t,S,v),D=ee(),M=U(()=>`${(t.modelValue-l.value)/(d.value-l.value)*100}%`),F=U(()=>t.vertical?{bottom:M.value}:{left:M.value}),W=()=>{o.hovering=!0,V()},z=()=>{o.hovering=!1,o.dragging||L()},G=_e=>{a.value||(_e.preventDefault(),J(_e),window.addEventListener("mousemove",pe),window.addEventListener("touchmove",pe),window.addEventListener("mouseup",be),window.addEventListener("touchend",be),window.addEventListener("contextmenu",be),D.value.focus())},Y=_e=>{a.value||(o.newPosition=Number.parseFloat(M.value)+_e/(d.value-l.value)*100,Ae(o.newPosition),C())},te=()=>{Y(-h.value)},Z=()=>{Y(h.value)},fe=()=>{Y(-h.value*4)},Ee=()=>{Y(h.value*4)},ae=()=>{a.value||(Ae(0),C())},X=()=>{a.value||(Ae(100),C())},ie=_e=>{let Me=!0;switch(_e.code){case Ct.left:case Ct.down:te();break;case Ct.right:case Ct.up:Z();break;case Ct.home:ae();break;case Ct.end:X();break;case Ct.pageDown:fe();break;case Ct.pageUp:Ee();break;default:Me=!1;break}Me&&_e.preventDefault()},se=_e=>{let Me,Fe;return _e.type.startsWith("touch")?(Fe=_e.touches[0].clientY,Me=_e.touches[0].clientX):(Fe=_e.clientY,Me=_e.clientX),{clientX:Me,clientY:Fe}},J=_e=>{o.dragging=!0,o.isClick=!0;const{clientX:Me,clientY:Fe}=se(_e);t.vertical?o.startY=Fe:o.startX=Me,o.startPosition=Number.parseFloat(M.value),o.newPosition=o.startPosition},pe=_e=>{if(o.dragging){o.isClick=!1,V(),w();let Me;const{clientX:Fe,clientY:Le}=se(_e);t.vertical?(o.currentY=Le,Me=(o.startY-o.currentY)/b.value*100):(o.currentX=Fe,Me=(o.currentX-o.startX)/b.value*100),o.newPosition=o.startPosition+Me,Ae(o.newPosition)}},be=()=>{o.dragging&&(setTimeout(()=>{o.dragging=!1,o.hovering||L(),o.isClick||Ae(o.newPosition),C()},0),window.removeEventListener("mousemove",pe),window.removeEventListener("touchmove",pe),window.removeEventListener("mouseup",be),window.removeEventListener("touchend",be),window.removeEventListener("contextmenu",be))},Ae=async _e=>{if(_e===null||Number.isNaN(+_e))return;_e<0?_e=0:_e>100&&(_e=100);const Me=100/((d.value-l.value)/h.value);let Le=Math.round(_e/Me)*Me*(d.value-l.value)*.01+l.value;Le=Number.parseFloat(Le.toFixed(E.value)),Le!==t.modelValue&&s(Jt,Le),!o.dragging&&t.modelValue!==o.oldValue&&(o.oldValue=t.modelValue),await Vt(),o.dragging&&V(),R.value.updatePopper()};return ze(()=>o.dragging,_e=>{I(_e)}),gr(D,"touchstart",G,{passive:!1}),{disabled:a,button:D,tooltip:R,tooltipVisible:N,showTooltip:v,persistent:g,wrapperStyle:F,formatValue:O,handleMouseEnter:W,handleMouseLeave:z,onButtonDown:G,onKeyDown:ie,setPosition:Ae}},bDe=me({name:"ElSliderButton"}),SDe=me({...bDe,props:gDe,emits:_De,setup(t,{expose:o,emit:s}){const a=t,l=Qe("slider"),d=er({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),h=U(()=>b.value?S.value:!1),{disabled:v,button:g,tooltip:E,showTooltip:b,persistent:S,tooltipVisible:C,wrapperStyle:w,formatValue:I,handleMouseEnter:R,handleMouseLeave:N,onButtonDown:O,onKeyDown:V,setPosition:L}=yDe(a,d,s),{hovering:D,dragging:M}=ds(d);return o({onButtonDown:O,onKeyDown:V,setPosition:L,hovering:D,dragging:M}),(F,W)=>($(),le("div",{ref_key:"button",ref:g,class:K([p(l).e("button-wrapper"),{hover:p(D),dragging:p(M)}]),style:jt(p(w)),tabindex:p(v)?-1:0,onMouseenter:p(R),onMouseleave:p(N),onMousedown:p(O),onFocus:p(R),onBlur:p(N),onKeydown:p(V)},[ge(p(Us),{ref_key:"tooltip",ref:E,visible:p(C),placement:F.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":F.tooltipClass,disabled:!p(b),persistent:p(h)},{content:Ce(()=>[ue("span",null,ot(p(I)),1)]),default:Ce(()=>[ue("div",{class:K([p(l).e("button"),{hover:p(D),dragging:p(M)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var VH=dt(SDe,[["__file","button.vue"]]);const TDe=ut({mark:{type:Re([String,Object]),default:void 0}});var CDe=me({name:"ElSliderMarker",props:TDe,setup(t){const o=Qe("slider"),s=U(()=>Mt(t.mark)?t.mark:t.mark.label),a=U(()=>Mt(t.mark)?void 0:t.mark.style);return()=>Ht("div",{class:o.e("marks-text"),style:a.value},s.value)}});const wDe=(t,o,s)=>{const{form:a,formItem:l}=Vs(),d=Mr(),h=ee(),v=ee(),g={firstButton:h,secondButton:v},E=U(()=>t.disabled||(a==null?void 0:a.disabled)||!1),b=U(()=>Math.min(o.firstValue,o.secondValue)),S=U(()=>Math.max(o.firstValue,o.secondValue)),C=U(()=>t.range?`${100*(S.value-b.value)/(t.max-t.min)}%`:`${100*(o.firstValue-t.min)/(t.max-t.min)}%`),w=U(()=>t.range?`${100*(b.value-t.min)/(t.max-t.min)}%`:"0%"),I=U(()=>t.vertical?{height:t.height}:{}),R=U(()=>t.vertical?{height:C.value,bottom:w.value}:{width:C.value,left:w.value}),N=()=>{d.value&&(o.sliderSize=d.value[`client${t.vertical?"Height":"Width"}`])},O=Z=>{const fe=t.min+Z*(t.max-t.min)/100;if(!t.range)return h;let Ee;return Math.abs(b.value-fe)<Math.abs(S.value-fe)?Ee=o.firstValue<o.secondValue?"firstButton":"secondButton":Ee=o.firstValue>o.secondValue?"firstButton":"secondButton",g[Ee]},V=Z=>{const fe=O(Z);return fe.value.setPosition(Z),fe},L=Z=>{o.firstValue=Z??t.min,M(t.range?[b.value,S.value]:Z??t.min)},D=Z=>{o.secondValue=Z,t.range&&M([b.value,S.value])},M=Z=>{s(Jt,Z),s(cs,Z)},F=async()=>{await Vt(),s(yn,t.range?[b.value,S.value]:t.modelValue)},W=Z=>{var fe,Ee,ae,X,ie,se;if(E.value||o.dragging)return;N();let J=0;if(t.vertical){const pe=(ae=(Ee=(fe=Z.touches)==null?void 0:fe.item(0))==null?void 0:Ee.clientY)!=null?ae:Z.clientY;J=(d.value.getBoundingClientRect().bottom-pe)/o.sliderSize*100}else{const pe=(se=(ie=(X=Z.touches)==null?void 0:X.item(0))==null?void 0:ie.clientX)!=null?se:Z.clientX,be=d.value.getBoundingClientRect().left;J=(pe-be)/o.sliderSize*100}if(!(J<0||J>100))return V(J)};return{elFormItem:l,slider:d,firstButton:h,secondButton:v,sliderDisabled:E,minValue:b,maxValue:S,runwayStyle:I,barStyle:R,resetSize:N,setPosition:V,emitChange:F,onSliderWrapperPrevent:Z=>{var fe,Ee;((fe=g.firstButton.value)!=null&&fe.dragging||(Ee=g.secondButton.value)!=null&&Ee.dragging)&&Z.preventDefault()},onSliderClick:Z=>{W(Z)&&F()},onSliderDown:async Z=>{const fe=W(Z);fe&&(await Vt(),fe.value.onButtonDown(Z))},onSliderMarkerDown:Z=>{E.value||o.dragging||V(Z)},setFirstValue:L,setSecondValue:D}},RDe=(t,o,s,a)=>({stops:U(()=>{if(!t.showStops||t.min>t.max)return[];if(t.step===0)return[];const h=(t.max-t.min)/t.step,v=100*t.step/(t.max-t.min),g=Array.from({length:h-1}).map((E,b)=>(b+1)*v);return t.range?g.filter(E=>E<100*(s.value-t.min)/(t.max-t.min)||E>100*(a.value-t.min)/(t.max-t.min)):g.filter(E=>E>100*(o.firstValue-t.min)/(t.max-t.min))}),getStopStyle:h=>t.vertical?{bottom:`${h}%`}:{left:`${h}%`}}),IDe=t=>U(()=>t.marks?Object.keys(t.marks).map(Number.parseFloat).sort((s,a)=>s-a).filter(s=>s<=t.max&&s>=t.min).map(s=>({point:s,position:(s-t.min)*100/(t.max-t.min),mark:t.marks[s]})):[]),ADe=(t,o,s,a,l,d)=>{const h=E=>{l(Jt,E),l(cs,E)},v=()=>t.range?![s.value,a.value].every((E,b)=>E===o.oldValue[b]):t.modelValue!==o.oldValue,g=()=>{var E,b;t.min>t.max&&qo("Slider","min should not be greater than max.");const S=t.modelValue;t.range&&st(S)?S[1]<t.min?h([t.min,t.min]):S[0]>t.max?h([t.max,t.max]):S[0]<t.min?h([t.min,S[1]]):S[1]>t.max?h([S[0],t.max]):(o.firstValue=S[0],o.secondValue=S[1],v()&&(t.validateEvent&&((E=d==null?void 0:d.validate)==null||E.call(d,"change").catch(C=>void 0)),o.oldValue=S.slice())):!t.range&&$t(S)&&!Number.isNaN(S)&&(S<t.min?h(t.min):S>t.max?h(t.max):(o.firstValue=S,v()&&(t.validateEvent&&((b=d==null?void 0:d.validate)==null||b.call(d,"change").catch(C=>void 0)),o.oldValue=S)))};g(),ze(()=>o.dragging,E=>{E||g()}),ze(()=>t.modelValue,(E,b)=>{o.dragging||st(E)&&st(b)&&E.every((S,C)=>S===b[C])&&o.firstValue===E[0]&&o.secondValue===E[1]||g()},{deep:!0}),ze(()=>[t.min,t.max],()=>{g()})},ODe=(t,o,s)=>{const a=ee();return dn(async()=>{t.range?(st(t.modelValue)?(o.firstValue=Math.max(t.min,t.modelValue[0]),o.secondValue=Math.min(t.max,t.modelValue[1])):(o.firstValue=t.min,o.secondValue=t.max),o.oldValue=[o.firstValue,o.secondValue]):(!$t(t.modelValue)||Number.isNaN(t.modelValue)?o.firstValue=t.min:o.firstValue=Math.min(t.max,Math.max(t.min,t.modelValue)),o.oldValue=o.firstValue),gr(window,"resize",s),await Vt(),s()}),{sliderWrapper:a}},NDe=me({name:"ElSlider"}),kDe=me({...NDe,props:mDe,emits:vDe,setup(t,{expose:o,emit:s}){const a=t,l=Qe("slider"),{t:d}=Fn(),h=er({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:v,slider:g,firstButton:E,secondButton:b,sliderDisabled:S,minValue:C,maxValue:w,runwayStyle:I,barStyle:R,resetSize:N,emitChange:O,onSliderWrapperPrevent:V,onSliderClick:L,onSliderDown:D,onSliderMarkerDown:M,setFirstValue:F,setSecondValue:W}=wDe(a,h,s),{stops:z,getStopStyle:G}=RDe(a,h,C,w),{inputId:Y,isLabeledByFormItem:te}=Ka(a,{formItemContext:v}),Z=xo(),fe=U(()=>a.inputSize||Z.value),Ee=U(()=>a.ariaLabel||d("el.slider.defaultLabel",{min:a.min,max:a.max})),ae=U(()=>a.range?a.rangeStartLabel||d("el.slider.defaultRangeStartLabel"):Ee.value),X=U(()=>a.formatValueText?a.formatValueText(_e.value):`${_e.value}`),ie=U(()=>a.rangeEndLabel||d("el.slider.defaultRangeEndLabel")),se=U(()=>a.formatValueText?a.formatValueText(Me.value):`${Me.value}`),J=U(()=>[l.b(),l.m(Z.value),l.is("vertical",a.vertical),{[l.m("with-input")]:a.showInput}]),pe=IDe(a);ADe(a,h,C,w,s,v);const be=U(()=>{const Pe=[a.min,a.max,a.step].map(He=>{const We=`${He}`.split(".")[1];return We?We.length:0});return Math.max.apply(null,Pe)}),{sliderWrapper:Ae}=ODe(a,h,N),{firstValue:_e,secondValue:Me,sliderSize:Fe}=ds(h),Le=Pe=>{h.dragging=Pe};return gr(Ae,"touchstart",V,{passive:!1}),gr(Ae,"touchmove",V,{passive:!1}),wn(Bz,{...ds(a),sliderSize:Fe,disabled:S,precision:be,emitChange:O,resetSize:N,updateDragging:Le}),o({onSliderClick:L}),(Pe,He)=>{var We,yt;return $(),le("div",{id:Pe.range?p(Y):void 0,ref_key:"sliderWrapper",ref:Ae,class:K(p(J)),role:Pe.range?"group":void 0,"aria-label":Pe.range&&!p(te)?p(Ee):void 0,"aria-labelledby":Pe.range&&p(te)?(We=p(v))==null?void 0:We.labelId:void 0},[ue("div",{ref_key:"slider",ref:g,class:K([p(l).e("runway"),{"show-input":Pe.showInput&&!Pe.range},p(l).is("disabled",p(S))]),style:jt(p(I)),onMousedown:p(D),onTouchstartPassive:p(D)},[ue("div",{class:K(p(l).e("bar")),style:jt(p(R))},null,6),ge(VH,{id:Pe.range?void 0:p(Y),ref_key:"firstButton",ref:E,"model-value":p(_e),vertical:Pe.vertical,"tooltip-class":Pe.tooltipClass,placement:Pe.placement,role:"slider","aria-label":Pe.range||!p(te)?p(ae):void 0,"aria-labelledby":!Pe.range&&p(te)?(yt=p(v))==null?void 0:yt.labelId:void 0,"aria-valuemin":Pe.min,"aria-valuemax":Pe.range?p(Me):Pe.max,"aria-valuenow":p(_e),"aria-valuetext":p(X),"aria-orientation":Pe.vertical?"vertical":"horizontal","aria-disabled":p(S),"onUpdate:modelValue":p(F)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),Pe.range?($(),Ve(VH,{key:0,ref_key:"secondButton",ref:b,"model-value":p(Me),vertical:Pe.vertical,"tooltip-class":Pe.tooltipClass,placement:Pe.placement,role:"slider","aria-label":p(ie),"aria-valuemin":p(_e),"aria-valuemax":Pe.max,"aria-valuenow":p(Me),"aria-valuetext":p(se),"aria-orientation":Pe.vertical?"vertical":"horizontal","aria-disabled":p(S),"onUpdate:modelValue":p(W)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):De("v-if",!0),Pe.showStops?($(),le("div",{key:1},[($(!0),le(Ut,null,Cn(p(z),(it,ce)=>($(),le("div",{key:ce,class:K(p(l).e("stop")),style:jt(p(G)(it))},null,6))),128))])):De("v-if",!0),p(pe).length>0?($(),le(Ut,{key:2},[ue("div",null,[($(!0),le(Ut,null,Cn(p(pe),(it,ce)=>($(),le("div",{key:ce,style:jt(p(G)(it.position)),class:K([p(l).e("stop"),p(l).e("marks-stop")])},null,6))),128))]),ue("div",{class:K(p(l).e("marks"))},[($(!0),le(Ut,null,Cn(p(pe),(it,ce)=>($(),Ve(p(CDe),{key:ce,mark:it.mark,style:jt(p(G)(it.position)),onMousedown:Gt(Se=>p(M)(it.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):De("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),Pe.showInput&&!Pe.range?($(),Ve(p(Ez),{key:0,ref:"input","model-value":p(_e),class:K(p(l).e("input")),step:Pe.step,disabled:p(S),controls:Pe.showInputControls,min:Pe.min,max:Pe.max,precision:p(be),debounce:Pe.debounce,size:p(fe),"onUpdate:modelValue":p(F),onChange:p(O)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):De("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var PDe=dt(kDe,[["__file","slider.vue"]]);const DDe=rn(PDe),LDe=ut({prefixCls:{type:String}}),FH=me({name:"ElSpaceItem",props:LDe,setup(t,{slots:o}){const s=Qe("space"),a=U(()=>`${t.prefixCls||s.b()}__item`);return()=>Ht("div",{class:a.value},Ne(o,"default"))}}),BH={small:8,default:12,large:16};function MDe(t){const o=Qe("space"),s=U(()=>[o.b(),o.m(t.direction),t.class]),a=ee(0),l=ee(0),d=U(()=>{const v=t.wrap||t.fill?{flexWrap:"wrap"}:{},g={alignItems:t.alignment},E={rowGap:`${l.value}px`,columnGap:`${a.value}px`};return[v,g,E,t.style]}),h=U(()=>t.fill?{flexGrow:1,minWidth:`${t.fillRatio}%`}:{});return Ms(()=>{const{size:v="small",wrap:g,direction:E,fill:b}=t;if(st(v)){const[S=0,C=0]=v;a.value=S,l.value=C}else{let S;$t(v)?S=v:S=BH[v||"small"]||BH.small,(g||b)&&E==="horizontal"?a.value=l.value=S:E==="horizontal"?(a.value=S,l.value=0):(l.value=S,a.value=0)}}),{classes:s,containerStyle:d,itemStyle:h}}const xDe=ut({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:Re([String,Object,Array]),default:""},style:{type:Re([String,Array,Object]),default:""},alignment:{type:Re(String),default:"center"},prefixCls:{type:String},spacer:{type:Re([Object,String,Number,Array]),default:null,validator:t=>Kr(t)||$t(t)||Mt(t)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:vl,validator:t=>$t(t)||st(t)&&t.length===2&&t.every($t)}}),UDe=me({name:"ElSpace",props:xDe,setup(t,{slots:o}){const{classes:s,containerStyle:a,itemStyle:l}=MDe(t);function d(h,v="",g=[]){const{prefixCls:E}=t;return h.forEach((b,S)=>{tO(b)?st(b.children)&&b.children.forEach((C,w)=>{tO(C)&&st(C.children)?d(C.children,`${v+w}-`,g):g.push(ge(FH,{style:l.value,prefixCls:E,key:`nested-${v+w}`},{default:()=>[C]},Ma.PROPS|Ma.STYLE,["style","prefixCls"]))}):DCe(b)&&g.push(ge(FH,{style:l.value,prefixCls:E,key:`LoopKey${v+S}`},{default:()=>[b]},Ma.PROPS|Ma.STYLE,["style","prefixCls"]))}),g}return()=>{var h;const{spacer:v,direction:g}=t,E=Ne(o,"default",{key:0},()=>[]);if(((h=E.children)!=null?h:[]).length===0)return null;if(st(E.children)){let b=d(E.children);if(v){const S=b.length-1;b=b.reduce((C,w,I)=>{const R=[...C,w];return I!==S&&R.push(ge("span",{style:[l.value,g==="vertical"?"width: 100%":null],key:I},[Kr(v)?v:bn(v,Ma.TEXT)],Ma.STYLE)),R},[])}return ge("div",{class:s.value,style:a.value},b,Ma.STYLE|Ma.CLASS)}return E.children}}}),VDe=rn(UDe),FDe=ut({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:Re([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:Re([String,Object,Array])}}),BDe=me({name:"ElStatistic"}),jDe=me({...BDe,props:FDe,setup(t,{expose:o}){const s=t,a=Qe("statistic"),l=U(()=>{const{value:d,formatter:h,precision:v,decimalSeparator:g,groupSeparator:E}=s;if(Ft(h))return h(d);if(!$t(d)||Number.isNaN(d))return d;let[b,S=""]=String(d).split(".");return S=S.padEnd(v,"0").slice(0,v>0?v:0),b=b.replace(/\B(?=(\d{3})+(?!\d))/g,E),[b,S].join(S?g:"")});return o({displayValue:l}),(d,h)=>($(),le("div",{class:K(p(a).b())},[d.$slots.title||d.title?($(),le("div",{key:0,class:K(p(a).e("head"))},[Ne(d.$slots,"title",{},()=>[bn(ot(d.title),1)])],2)):De("v-if",!0),ue("div",{class:K(p(a).e("content"))},[d.$slots.prefix||d.prefix?($(),le("div",{key:0,class:K(p(a).e("prefix"))},[Ne(d.$slots,"prefix",{},()=>[ue("span",null,ot(d.prefix),1)])],2)):De("v-if",!0),ue("span",{class:K(p(a).e("number")),style:jt(d.valueStyle)},ot(p(l)),7),d.$slots.suffix||d.suffix?($(),le("div",{key:1,class:K(p(a).e("suffix"))},[Ne(d.$slots,"suffix",{},()=>[ue("span",null,ot(d.suffix),1)])],2)):De("v-if",!0)],2)],2))}});var $De=dt(jDe,[["__file","statistic.vue"]]);const jz=rn($De),HDe=ut({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:Re([Number,Object]),default:0},valueStyle:{type:Re([String,Object,Array])}}),WDe={finish:()=>!0,[yn]:t=>$t(t)},KDe=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],jH=t=>$t(t)?new Date(t).getTime():t.valueOf(),$H=(t,o)=>{let s=t;const a=/\[([^\]]*)]/g;return KDe.reduce((d,[h,v])=>{const g=new RegExp(`${h}+(?![^\\[\\]]*\\])`,"g");if(g.test(d)){const E=Math.floor(s/v);return s-=E*v,d.replace(g,b=>String(E).padStart(b.length,"0"))}return d},o).replace(a,"$1")},GDe=me({name:"ElCountdown"}),zDe=me({...GDe,props:HDe,emits:WDe,setup(t,{expose:o,emit:s}){const a=t;let l;const d=ee(0),h=U(()=>$H(d.value,a.format)),v=b=>$H(b,a.format),g=()=>{l&&(xh(l),l=void 0)},E=()=>{const b=jH(a.value),S=()=>{let C=b-Date.now();s(yn,C),C<=0?(C=0,g(),s("finish")):l=ld(S),d.value=C};l=ld(S)};return dn(()=>{d.value=jH(a.value)-Date.now(),ze(()=>[a.value,a.format],()=>{g(),E()},{immediate:!0})}),Rr(()=>{g()}),o({displayValue:h}),(b,S)=>($(),Ve(p(jz),{value:d.value,title:b.title,prefix:b.prefix,suffix:b.suffix,"value-style":b.valueStyle,formatter:v},fa({_:2},[Cn(b.$slots,(C,w)=>({name:w,fn:Ce(()=>[Ne(b.$slots,w)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var YDe=dt(zDe,[["__file","countdown.vue"]]);const qDe=rn(YDe),XDe=ut({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),JDe={[yn]:(t,o)=>[t,o].every($t)},ZDe=me({name:"ElSteps"}),QDe=me({...ZDe,props:XDe,emits:JDe,setup(t,{emit:o}){const s=t,a=Qe("steps"),{children:l,addChild:d,removeChild:h}=hk(mn(),"ElStep");return ze(l,()=>{l.value.forEach((v,g)=>{v.setIndex(g)})}),wn("ElSteps",{props:s,steps:l,addStep:d,removeStep:h}),ze(()=>s.active,(v,g)=>{o(yn,v,g)}),(v,g)=>($(),le("div",{class:K([p(a).b(),p(a).m(v.simple?"simple":v.direction)])},[Ne(v.$slots,"default")],2))}});var eLe=dt(QDe,[["__file","steps.vue"]]);const tLe=ut({title:{type:String,default:""},icon:{type:yr},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),nLe=me({name:"ElStep"}),rLe=me({...nLe,props:tLe,setup(t){const o=t,s=Qe("step"),a=ee(-1),l=ee({}),d=ee(""),h=It("ElSteps"),v=mn();dn(()=>{ze([()=>h.props.active,()=>h.props.processStatus,()=>h.props.finishStatus],([F])=>{D(F)},{immediate:!0})}),Rr(()=>{h.removeStep(M.uid)});const g=U(()=>o.status||d.value),E=U(()=>{const F=h.steps.value[a.value-1];return F?F.currentStatus:"wait"}),b=U(()=>h.props.alignCenter),S=U(()=>h.props.direction==="vertical"),C=U(()=>h.props.simple),w=U(()=>h.steps.value.length),I=U(()=>{var F;return((F=h.steps.value[w.value-1])==null?void 0:F.uid)===(v==null?void 0:v.uid)}),R=U(()=>C.value?"":h.props.space),N=U(()=>[s.b(),s.is(C.value?"simple":h.props.direction),s.is("flex",I.value&&!R.value&&!b.value),s.is("center",b.value&&!S.value&&!C.value)]),O=U(()=>{const F={flexBasis:$t(R.value)?`${R.value}px`:R.value?R.value:`${100/(w.value-(b.value?0:1))}%`};return S.value||I.value&&(F.maxWidth=`${100/w.value}%`),F}),V=F=>{a.value=F},L=F=>{const W=F==="wait",z={transitionDelay:`${W?"-":""}${150*a.value}ms`},G=F===h.props.processStatus||W?0:100;z.borderWidth=G&&!C.value?"1px":0,z[h.props.direction==="vertical"?"height":"width"]=`${G}%`,l.value=z},D=F=>{F>a.value?d.value=h.props.finishStatus:F===a.value&&E.value!=="error"?d.value=h.props.processStatus:d.value="wait";const W=h.steps.value[a.value-1];W&&W.calcProgress(d.value)},M=er({uid:v.uid,currentStatus:g,setIndex:V,calcProgress:L});return h.addStep(M),(F,W)=>($(),le("div",{style:jt(p(O)),class:K(p(N))},[De(" icon & line "),ue("div",{class:K([p(s).e("head"),p(s).is(p(g))])},[p(C)?De("v-if",!0):($(),le("div",{key:0,class:K(p(s).e("line"))},[ue("i",{class:K(p(s).e("line-inner")),style:jt(l.value)},null,6)],2)),ue("div",{class:K([p(s).e("icon"),p(s).is(F.icon||F.$slots.icon?"icon":"text")])},[Ne(F.$slots,"icon",{},()=>[F.icon?($(),Ve(p(Dt),{key:0,class:K(p(s).e("icon-inner"))},{default:Ce(()=>[($(),Ve(gn(F.icon)))]),_:1},8,["class"])):p(g)==="success"?($(),Ve(p(Dt),{key:1,class:K([p(s).e("icon-inner"),p(s).is("status")])},{default:Ce(()=>[ge(p(l_))]),_:1},8,["class"])):p(g)==="error"?($(),Ve(p(Dt),{key:2,class:K([p(s).e("icon-inner"),p(s).is("status")])},{default:Ce(()=>[ge(p(Sc))]),_:1},8,["class"])):p(C)?De("v-if",!0):($(),le("div",{key:3,class:K(p(s).e("icon-inner"))},ot(a.value+1),3))])],2)],2),De(" title & description "),ue("div",{class:K(p(s).e("main"))},[ue("div",{class:K([p(s).e("title"),p(s).is(p(g))])},[Ne(F.$slots,"title",{},()=>[bn(ot(F.title),1)])],2),p(C)?($(),le("div",{key:0,class:K(p(s).e("arrow"))},null,2)):($(),le("div",{key:1,class:K([p(s).e("description"),p(s).is(p(g))])},[Ne(F.$slots,"description",{},()=>[bn(ot(F.description),1)])],2))],2)],6))}});var $z=dt(rLe,[["__file","item.vue"]]);const oLe=rn(eLe,{Step:$z}),sLe=uo($z),Hz=t=>["",...vl].includes(t),iLe=ut({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Hz},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:yr},activeActionIcon:{type:yr},activeIcon:{type:yr},inactiveIcon:{type:yr},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Re(Function)},id:String,tabindex:{type:[String,Number]},...Cs(["ariaLabel"])}),aLe={[Jt]:t=>wr(t)||Mt(t)||$t(t),[yn]:t=>wr(t)||Mt(t)||$t(t),[cs]:t=>wr(t)||Mt(t)||$t(t)},Wz="ElSwitch",cLe=me({name:Wz}),lLe=me({...cLe,props:iLe,emits:aLe,setup(t,{expose:o,emit:s}){const a=t,{formItem:l}=Vs(),d=xo(),h=Qe("switch"),{inputId:v}=Ka(a,{formItemContext:l}),g=Fs(U(()=>a.loading)),E=ee(a.modelValue!==!1),b=ee(),S=ee(),C=U(()=>[h.b(),h.m(d.value),h.is("disabled",g.value),h.is("checked",O.value)]),w=U(()=>[h.e("label"),h.em("label","left"),h.is("active",!O.value)]),I=U(()=>[h.e("label"),h.em("label","right"),h.is("active",O.value)]),R=U(()=>({width:mo(a.width)}));ze(()=>a.modelValue,()=>{E.value=!0});const N=U(()=>E.value?a.modelValue:!1),O=U(()=>N.value===a.activeValue);[a.activeValue,a.inactiveValue].includes(N.value)||(s(Jt,a.inactiveValue),s(yn,a.inactiveValue),s(cs,a.inactiveValue)),ze(O,M=>{var F;b.value.checked=M,a.validateEvent&&((F=l==null?void 0:l.validate)==null||F.call(l,"change").catch(W=>void 0))});const V=()=>{const M=O.value?a.inactiveValue:a.activeValue;s(Jt,M),s(yn,M),s(cs,M),Vt(()=>{b.value.checked=O.value})},L=()=>{if(g.value)return;const{beforeChange:M}=a;if(!M){V();return}const F=M();[Tg(F),wr(F)].includes(!0)||qo(Wz,"beforeChange must return type `Promise<boolean>` or `boolean`"),Tg(F)?F.then(z=>{z&&V()}).catch(z=>{}):F&&V()},D=()=>{var M,F;(F=(M=b.value)==null?void 0:M.focus)==null||F.call(M)};return dn(()=>{b.value.checked=O.value}),o({focus:D,checked:O}),(M,F)=>($(),le("div",{class:K(p(C)),onClick:Gt(L,["prevent"])},[ue("input",{id:p(v),ref_key:"input",ref:b,class:K(p(h).e("input")),type:"checkbox",role:"switch","aria-checked":p(O),"aria-disabled":p(g),"aria-label":M.ariaLabel,name:M.name,"true-value":M.activeValue,"false-value":M.inactiveValue,disabled:p(g),tabindex:M.tabindex,onChange:V,onKeydown:Cr(L,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!M.inlinePrompt&&(M.inactiveIcon||M.inactiveText)?($(),le("span",{key:0,class:K(p(w))},[M.inactiveIcon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(M.inactiveIcon)))]),_:1})):De("v-if",!0),!M.inactiveIcon&&M.inactiveText?($(),le("span",{key:1,"aria-hidden":p(O)},ot(M.inactiveText),9,["aria-hidden"])):De("v-if",!0)],2)):De("v-if",!0),ue("span",{ref_key:"core",ref:S,class:K(p(h).e("core")),style:jt(p(R))},[M.inlinePrompt?($(),le("div",{key:0,class:K(p(h).e("inner"))},[M.activeIcon||M.inactiveIcon?($(),Ve(p(Dt),{key:0,class:K(p(h).is("icon"))},{default:Ce(()=>[($(),Ve(gn(p(O)?M.activeIcon:M.inactiveIcon)))]),_:1},8,["class"])):M.activeText||M.inactiveText?($(),le("span",{key:1,class:K(p(h).is("text")),"aria-hidden":!p(O)},ot(p(O)?M.activeText:M.inactiveText),11,["aria-hidden"])):De("v-if",!0)],2)):De("v-if",!0),ue("div",{class:K(p(h).e("action"))},[M.loading?($(),Ve(p(Dt),{key:0,class:K(p(h).is("loading"))},{default:Ce(()=>[ge(p(hl))]),_:1},8,["class"])):p(O)?Ne(M.$slots,"active-action",{key:1},()=>[M.activeActionIcon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(M.activeActionIcon)))]),_:1})):De("v-if",!0)]):p(O)?De("v-if",!0):Ne(M.$slots,"inactive-action",{key:2},()=>[M.inactiveActionIcon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(M.inactiveActionIcon)))]),_:1})):De("v-if",!0)])],2)],6),!M.inlinePrompt&&(M.activeIcon||M.activeText)?($(),le("span",{key:1,class:K(p(I))},[M.activeIcon?($(),Ve(p(Dt),{key:0},{default:Ce(()=>[($(),Ve(gn(M.activeIcon)))]),_:1})):De("v-if",!0),!M.activeIcon&&M.activeText?($(),le("span",{key:1,"aria-hidden":!p(O)},ot(M.activeText),9,["aria-hidden"])):De("v-if",!0)],2)):De("v-if",!0)],10,["onClick"]))}});var uLe=dt(lLe,[["__file","switch.vue"]]);const dLe=rn(uLe),gA=function(t){var o;return(o=t.target)==null?void 0:o.closest("td")},hLe=function(t,o,s,a,l){if(!o&&!a&&(!l||st(l)&&!l.length))return t;Mt(s)?s=s==="descending"?-1:1:s=s&&s<0?-1:1;const d=a?null:function(v,g){return l?(st(l)||(l=[l]),l.map(E=>Mt(E)?Oo(v,E):E(v,g,t))):(o!=="$key"&&fn(v)&&"$value"in v&&(v=v.$value),[fn(v)?Oo(v,o):v])},h=function(v,g){if(a)return a(v.value,g.value);for(let E=0,b=v.key.length;E<b;E++){if(v.key[E]<g.key[E])return-1;if(v.key[E]>g.key[E])return 1}return 0};return t.map((v,g)=>({value:v,index:g,key:d?d(v,g):null})).sort((v,g)=>{let E=h(v,g);return E||(E=v.index-g.index),E*+s}).map(v=>v.value)},Kz=function(t,o){let s=null;return t.columns.forEach(a=>{a.id===o&&(s=a)}),s},fLe=function(t,o){let s=null;for(let a=0;a<t.columns.length;a++){const l=t.columns[a];if(l.columnKey===o){s=l;break}}return s||qo("ElTable",`No column matching with column-key: ${o}`),s},HH=function(t,o,s){const a=(o.className||"").match(new RegExp(`${s}-table_[^\\s]+`,"gm"));return a?Kz(t,a[0]):null},Zs=(t,o)=>{if(!t)throw new Error("Row is required when get row identity");if(Mt(o)){if(!o.includes("."))return`${t[o]}`;const s=o.split(".");let a=t;for(const l of s)a=a[l];return`${a}`}else if(Ft(o))return o.call(null,t)},bg=function(t,o){const s={};return(t||[]).forEach((a,l)=>{s[Zs(a,o)]={row:a,index:l}}),s};function pLe(t,o){const s={};let a;for(a in t)s[a]=t[a];for(a in o)if(zn(o,a)){const l=o[a];Xn(l)||(s[a]=l)}return s}function Vk(t){return t===""||Xn(t)||(t=Number.parseInt(t,10),Number.isNaN(t)&&(t="")),t}function Gz(t){return t===""||Xn(t)||(t=Vk(t),Number.isNaN(t)&&(t=80)),t}function mLe(t){return $t(t)?t:Mt(t)?/^\d+(?:px)?$/.test(t)?Number.parseInt(t,10):t:null}function vLe(...t){return t.length===0?o=>o:t.length===1?t[0]:t.reduce((o,s)=>(...a)=>o(s(...a)))}function xS(t,o,s,a,l,d){let h=d??0,v=!1;const g=t.indexOf(o),E=g!==-1,b=l==null?void 0:l.call(null,o,h),S=w=>{w==="add"?t.push(o):t.splice(g,1),v=!0},C=w=>{let I=0;const R=(a==null?void 0:a.children)&&w[a.children];return R&&st(R)&&(I+=R.length,R.forEach(N=>{I+=C(N)})),I};return(!l||b)&&(wr(s)?s&&!E?S("add"):!s&&E&&S("remove"):S(E?"remove":"add")),!(a!=null&&a.checkStrictly)&&(a!=null&&a.children)&&st(o[a.children])&&o[a.children].forEach(w=>{const I=xS(t,w,s??!E,a,l,h+1);h+=C(w)+1,I&&(v=I)}),v}function gLe(t,o,s="children",a="hasChildren"){const l=h=>!(st(h)&&h.length);function d(h,v,g){o(h,v,g),v.forEach(E=>{if(E[a]){o(E,null,g+1);return}const b=E[s];l(b)||d(E,b,g+1)})}t.forEach(h=>{if(h[a]){o(h,null,0);return}const v=h[s];l(v)||d(h,v,0)})}const _Le=(t,o,s,a)=>{const l={strategy:"fixed",...t.popperOptions},d=Ft(a.tooltipFormatter)?a.tooltipFormatter({row:s,column:a,cellValue:vg(s,a.property).value}):void 0;return Kr(d)?{slotContent:d,content:null,...t,popperOptions:l}:{slotContent:null,content:d??o,...t,popperOptions:l}};let Vi=null;function ELe(t,o,s,a,l,d){const h=_Le(t,o,s,a),v={...h,slotContent:void 0};if((Vi==null?void 0:Vi.trigger)===l){const w=Vi.vm.component;JW(w.props,v),h.slotContent&&(w.slots.content=()=>[h.slotContent]);return}Vi==null||Vi();const g=d==null?void 0:d.refs.tableWrapper,E=g==null?void 0:g.dataset.prefix,b=ge(Us,{virtualTriggering:!0,virtualRef:l,appendTo:g,placement:"top",transition:"none",offset:0,hideAfter:0,...v},h.slotContent?{content:()=>h.slotContent}:void 0);b.appContext={...d.appContext,...d};const S=document.createElement("div");ad(b,S),b.component.exposed.onOpen();const C=g==null?void 0:g.querySelector(`.${E}-scrollbar__wrap`);Vi=()=>{ad(null,S),C==null||C.removeEventListener("scroll",Vi),Vi=null},Vi.trigger=l,Vi.vm=b,C==null||C.addEventListener("scroll",Vi)}function zz(t){return t.children?k_e(t.children,zz):[t]}function WH(t,o){return t+o.colSpan}const Yz=(t,o,s,a)=>{let l=0,d=t;const h=s.states.columns.value;if(a){const g=zz(a[t]);l=h.slice(0,h.indexOf(g[0])).reduce(WH,0),d=l+g.reduce(WH,0)-1}else l=t;let v;switch(o){case"left":d<s.states.fixedLeafColumnsLength.value&&(v="left");break;case"right":l>=h.length-s.states.rightFixedLeafColumnsLength.value&&(v="right");break;default:d<s.states.fixedLeafColumnsLength.value?v="left":l>=h.length-s.states.rightFixedLeafColumnsLength.value&&(v="right")}return v?{direction:v,start:l,after:d}:{}},Fk=(t,o,s,a,l,d=0)=>{const h=[],{direction:v,start:g,after:E}=Yz(o,s,a,l);if(v){const b=v==="left";h.push(`${t}-fixed-column--${v}`),b&&E+d===a.states.fixedLeafColumnsLength.value-1?h.push("is-last-column"):!b&&g-d===a.states.columns.value.length-a.states.rightFixedLeafColumnsLength.value&&h.push("is-first-column")}return h};function KH(t,o){return t+(a_(o.realWidth)||Number.isNaN(o.realWidth)?Number(o.width):o.realWidth)}const Bk=(t,o,s,a)=>{const{direction:l,start:d=0,after:h=0}=Yz(t,o,s,a);if(!l)return;const v={},g=l==="left",E=s.states.columns.value;return g?v.left=E.slice(0,d).reduce(KH,0):v.right=E.slice(h+1).reverse().reduce(KH,0),v},tm=(t,o)=>{t&&(Number.isNaN(t[o])||(t[o]=`${t[o]}px`))};function yLe(t){const o=mn(),s=ee(!1),a=ee([]);return{updateExpandRows:()=>{const g=t.data.value||[],E=t.rowKey.value;if(s.value)a.value=g.slice();else if(E){const b=bg(a.value,E);a.value=g.reduce((S,C)=>{const w=Zs(C,E);return b[w]&&S.push(C),S},[])}else a.value=[]},toggleRowExpansion:(g,E)=>{xS(a.value,g,E)&&o.emit("expand-change",g,a.value.slice())},setExpandRowKeys:g=>{o.store.assertRowKey();const E=t.data.value||[],b=t.rowKey.value,S=bg(E,b);a.value=g.reduce((C,w)=>{const I=S[w];return I&&C.push(I.row),C},[])},isRowExpanded:g=>{const E=t.rowKey.value;return E?!!bg(a.value,E)[Zs(g,E)]:a.value.includes(g)},states:{expandRows:a,defaultExpandAll:s}}}function bLe(t){const o=mn(),s=ee(null),a=ee(null),l=E=>{o.store.assertRowKey(),s.value=E,h(E)},d=()=>{s.value=null},h=E=>{const{data:b,rowKey:S}=t;let C=null;S.value&&(C=(p(b)||[]).find(w=>Zs(w,S.value)===E)),a.value=C,o.emit("current-change",a.value,null)};return{setCurrentRowKey:l,restoreCurrentRowKey:d,setCurrentRowByKey:h,updateCurrentRow:E=>{const b=a.value;if(E&&E!==b){a.value=E,o.emit("current-change",a.value,b);return}!E&&b&&(a.value=null,o.emit("current-change",null,b))},updateCurrentRowData:()=>{const E=t.rowKey.value,b=t.data.value||[],S=a.value;if(!b.includes(S)&&S){if(E){const C=Zs(S,E);h(C)}else a.value=null;a_(a.value)&&o.emit("current-change",null,S)}else s.value&&(h(s.value),d())},states:{_currentRowKey:s,currentRow:a}}}function SLe(t){const o=ee([]),s=ee({}),a=ee(16),l=ee(!1),d=ee({}),h=ee("hasChildren"),v=ee("children"),g=ee(!1),E=mn(),b=U(()=>{if(!t.rowKey.value)return{};const D=t.data.value||[];return C(D)}),S=U(()=>{const D=t.rowKey.value,M=Object.keys(d.value),F={};return M.length&&M.forEach(W=>{if(d.value[W].length){const z={children:[]};d.value[W].forEach(G=>{const Y=Zs(G,D);z.children.push(Y),G[h.value]&&!F[Y]&&(F[Y]={children:[]})}),F[W]=z}}),F}),C=D=>{const M=t.rowKey.value,F={};return gLe(D,(W,z,G)=>{const Y=Zs(W,M);st(z)?F[Y]={children:z.map(te=>Zs(te,M)),level:G}:l.value&&(F[Y]={children:[],lazy:!0,level:G})},v.value,h.value),F},w=(D=!1,M=(F=>(F=E.store)==null?void 0:F.states.defaultExpandAll.value)())=>{var F;const W=b.value,z=S.value,G=Object.keys(W),Y={};if(G.length){const te=p(s),Z=[],fe=(ae,X)=>{if(D)return o.value?M||o.value.includes(X):!!(M||ae!=null&&ae.expanded);{const ie=M||o.value&&o.value.includes(X);return!!(ae!=null&&ae.expanded||ie)}};G.forEach(ae=>{const X=te[ae],ie={...W[ae]};if(ie.expanded=fe(X,ae),ie.lazy){const{loaded:se=!1,loading:J=!1}=X||{};ie.loaded=!!se,ie.loading=!!J,Z.push(ae)}Y[ae]=ie});const Ee=Object.keys(z);l.value&&Ee.length&&Z.length&&Ee.forEach(ae=>{const X=te[ae],ie=z[ae].children;if(Z.includes(ae)){if(Y[ae].children.length!==0)throw new Error("[ElTable]children must be an empty array.");Y[ae].children=ie}else{const{loaded:se=!1,loading:J=!1}=X||{};Y[ae]={lazy:!0,loaded:!!se,loading:!!J,expanded:fe(X,ae),children:ie,level:""}}})}s.value=Y,(F=E.store)==null||F.updateTableScrollY()};ze(()=>o.value,()=>{w(!0)}),ze(()=>b.value,()=>{w()}),ze(()=>S.value,()=>{w()});const I=D=>{o.value=D,w()},R=D=>l.value&&D&&"loaded"in D&&!D.loaded,N=(D,M)=>{E.store.assertRowKey();const F=t.rowKey.value,W=Zs(D,F),z=W&&s.value[W];if(W&&z&&"expanded"in z){const G=z.expanded;M=Xn(M)?!z.expanded:M,s.value[W].expanded=M,G!==M&&E.emit("expand-change",D,M),R(z)&&V(D,W,z),E.store.updateTableScrollY()}},O=D=>{E.store.assertRowKey();const M=t.rowKey.value,F=Zs(D,M),W=s.value[F];R(W)?V(D,F,W):N(D,void 0)},V=(D,M,F)=>{const{load:W}=E.props;W&&!s.value[M].loaded&&(s.value[M].loading=!0,W(D,F,z=>{if(!st(z))throw new TypeError("[ElTable] data must be an array");s.value[M].loading=!1,s.value[M].loaded=!0,s.value[M].expanded=!0,z.length&&(d.value[M]=z),E.emit("expand-change",D,!0)}))};return{loadData:V,loadOrToggle:O,toggleTreeExpansion:N,updateTreeExpandKeys:I,updateTreeData:w,updateKeyChildren:(D,M)=>{const{lazy:F,rowKey:W}=E.props;if(F){if(!W)throw new Error("[Table] rowKey is required in updateKeyChild");d.value[D]&&(d.value[D]=M)}},normalize:C,states:{expandRowKeys:o,treeData:s,indent:a,lazy:l,lazyTreeNodeMap:d,lazyColumnIdentifier:h,childrenColumnName:v,checkStrictly:g}}}const TLe=(t,o)=>{const s=o.sortingColumn;return!s||Mt(s.sortable)?t:hLe(t,o.sortProp,o.sortOrder,s.sortMethod,s.sortBy)},qb=t=>{const o=[];return t.forEach(s=>{s.children&&s.children.length>0?o.push.apply(o,qb(s.children)):o.push(s)}),o};function CLe(){var t;const o=mn(),{size:s}=ds((t=o.proxy)==null?void 0:t.$props),a=ee(null),l=ee([]),d=ee([]),h=ee(!1),v=ee([]),g=ee([]),E=ee([]),b=ee([]),S=ee([]),C=ee([]),w=ee([]),I=ee([]),R=[],N=ee(0),O=ee(0),V=ee(0),L=ee(!1),D=ee([]),M=ee(!1),F=ee(!1),W=ee(null),z=ee({}),G=ee(null),Y=ee(null),te=ee(null),Z=ee(null),fe=ee(null),Ee=U(()=>a.value?bg(D.value,a.value):void 0);ze(l,()=>{var Wt;o.state&&(se(!1),o.props.tableLayout==="auto"&&((Wt=o.refs.tableHeaderRef)==null||Wt.updateFixedColumnStyle()))},{deep:!0});const ae=()=>{if(!a.value)throw new Error("[ElTable] prop row-key is required")},X=Wt=>{var Je;(Je=Wt.children)==null||Je.forEach(Ie=>{Ie.fixed=Wt.fixed,X(Ie)})},ie=()=>{var Wt,Je;v.value.forEach(en=>{X(en)}),b.value=v.value.filter(en=>en.type!=="selection"&&[!0,"left"].includes(en.fixed));let Ie;if(((Je=(Wt=v.value)==null?void 0:Wt[0])==null?void 0:Je.type)==="selection"){const en=v.value[0];Ie=[!0,"left"].includes(en.fixed)||b.value.length&&en.fixed!=="right",Ie&&b.value.unshift(en)}S.value=v.value.filter(en=>en.fixed==="right");const Ke=v.value.filter(en=>(Ie?en.type!=="selection":!0)&&!en.fixed);g.value=[].concat(b.value).concat(Ke).concat(S.value);const Te=qb(Ke),vt=qb(b.value),an=qb(S.value);N.value=Te.length,O.value=vt.length,V.value=an.length,E.value=[].concat(vt).concat(Te).concat(an),h.value=b.value.length>0||S.value.length>0},se=(Wt,Je=!1)=>{Wt&&ie(),Je?o.state.doLayout():o.state.debouncedUpdateLayout()},J=Wt=>Ee.value?!!Ee.value[Zs(Wt,a.value)]:D.value.includes(Wt),pe=()=>{L.value=!1;const Wt=D.value;D.value=[],Wt.length&&o.emit("selection-change",[])},be=()=>{let Wt;if(a.value){Wt=[];const Je=bg(l.value,a.value);for(const Ie in Ee.value)zn(Ee.value,Ie)&&!Je[Ie]&&Wt.push(Ee.value[Ie].row)}else Wt=D.value.filter(Je=>!l.value.includes(Je));if(Wt.length){const Je=D.value.filter(Ie=>!Wt.includes(Ie));D.value=Je,o.emit("selection-change",Je.slice())}},Ae=()=>(D.value||[]).slice(),_e=(Wt,Je,Ie=!0,Ke=!1)=>{var Te,vt,an,en;const Ir={children:(vt=(Te=o==null?void 0:o.store)==null?void 0:Te.states)==null?void 0:vt.childrenColumnName.value,checkStrictly:(en=(an=o==null?void 0:o.store)==null?void 0:an.states)==null?void 0:en.checkStrictly.value};if(xS(D.value,Wt,Je,Ir,Ke?void 0:W.value,l.value.indexOf(Wt))){const No=(D.value||[]).slice();Ie&&o.emit("select",No,Wt),o.emit("selection-change",No)}},Me=()=>{var Wt,Je;const Ie=F.value?!L.value:!(L.value||D.value.length);L.value=Ie;let Ke=!1,Te=0;const vt=(Je=(Wt=o==null?void 0:o.store)==null?void 0:Wt.states)==null?void 0:Je.rowKey.value,{childrenColumnName:an}=o.store.states,en={children:an.value,checkStrictly:!1};l.value.forEach((Ir,yi)=>{const No=yi+Te;xS(D.value,Ir,Ie,en,W.value,No)&&(Ke=!0),Te+=Pe(Zs(Ir,vt))}),Ke&&o.emit("selection-change",D.value?D.value.slice():[]),o.emit("select-all",(D.value||[]).slice())},Fe=()=>{l.value.forEach(Wt=>{const Je=Zs(Wt,a.value),Ie=Ee.value[Je];Ie&&(D.value[Ie.index]=Wt)})},Le=()=>{var Wt;if(((Wt=l.value)==null?void 0:Wt.length)===0){L.value=!1;return}const{childrenColumnName:Je}=o.store.states;let Ie=0,Ke=0;const Te=an=>{var en;for(const Ir of an){const yi=W.value&&W.value.call(null,Ir,Ie);if(J(Ir))Ke++;else if(!W.value||yi)return!1;if(Ie++,(en=Ir[Je.value])!=null&&en.length&&!Te(Ir[Je.value]))return!1}return!0},vt=Te(l.value||[]);L.value=Ke===0?!1:vt},Pe=Wt=>{var Je;if(!o||!o.store)return 0;const{treeData:Ie}=o.store.states;let Ke=0;const Te=(Je=Ie.value[Wt])==null?void 0:Je.children;return Te&&(Ke+=Te.length,Te.forEach(vt=>{Ke+=Pe(vt)})),Ke},He=(Wt,Je)=>{st(Wt)||(Wt=[Wt]);const Ie={};return Wt.forEach(Ke=>{z.value[Ke.id]=Je,Ie[Ke.columnKey||Ke.id]=Je}),Ie},We=(Wt,Je,Ie)=>{Y.value&&Y.value!==Wt&&(Y.value.order=null),Y.value=Wt,te.value=Je,Z.value=Ie},yt=()=>{let Wt=p(d);Object.keys(z.value).forEach(Je=>{const Ie=z.value[Je];if(!Ie||Ie.length===0)return;const Ke=Kz({columns:E.value},Je);Ke&&Ke.filterMethod&&(Wt=Wt.filter(Te=>Ie.some(vt=>Ke.filterMethod.call(null,vt,Te,Ke))))}),G.value=Wt},it=()=>{l.value=TLe(G.value,{sortingColumn:Y.value,sortProp:te.value,sortOrder:Z.value})},ce=(Wt=void 0)=>{Wt&&Wt.filter||yt(),it()},Se=Wt=>{const{tableHeaderRef:Je}=o.refs;if(!Je)return;const Ie=Object.assign({},Je.filterPanels),Ke=Object.keys(Ie);if(Ke.length)if(Mt(Wt)&&(Wt=[Wt]),st(Wt)){const Te=Wt.map(vt=>fLe({columns:E.value},vt));Ke.forEach(vt=>{const an=Te.find(en=>en.id===vt);an&&(an.filteredValue=[])}),o.store.commit("filterChange",{column:Te,values:[],silent:!0,multi:!0})}else Ke.forEach(Te=>{const vt=E.value.find(an=>an.id===Te);vt&&(vt.filteredValue=[])}),z.value={},o.store.commit("filterChange",{column:{},values:[],silent:!0})},je=()=>{Y.value&&(We(null,null,null),o.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:tt,toggleRowExpansion:et,updateExpandRows:Ge,states:Xe,isRowExpanded:Ye}=yLe({data:l,rowKey:a}),{updateTreeExpandKeys:ct,toggleTreeExpansion:nt,updateTreeData:Ot,updateKeyChildren:_t,loadOrToggle:qe,states:wt}=SLe({data:l,rowKey:a}),{updateCurrentRowData:qt,updateCurrentRow:sn,setCurrentRowKey:tn,states:Kn}=bLe({data:l,rowKey:a});return{assertRowKey:ae,updateColumns:ie,scheduleLayout:se,isSelected:J,clearSelection:pe,cleanSelection:be,getSelectionRows:Ae,toggleRowSelection:_e,_toggleAllSelection:Me,toggleAllSelection:null,updateSelectionByRowKey:Fe,updateAllSelected:Le,updateFilters:He,updateCurrentRow:sn,updateSort:We,execFilter:yt,execSort:it,execQuery:ce,clearFilter:Se,clearSort:je,toggleRowExpansion:et,setExpandRowKeysAdapter:Wt=>{tt(Wt),ct(Wt)},setCurrentRowKey:tn,toggleRowExpansionAdapter:(Wt,Je)=>{E.value.some(({type:Ke})=>Ke==="expand")?et(Wt,Je):nt(Wt,Je)},isRowExpanded:Ye,updateExpandRows:Ge,updateCurrentRowData:qt,loadOrToggle:qe,updateTreeData:Ot,updateKeyChildren:_t,states:{tableSize:s,rowKey:a,data:l,_data:d,isComplex:h,_columns:v,originColumns:g,columns:E,fixedColumns:b,rightFixedColumns:S,leafColumns:C,fixedLeafColumns:w,rightFixedLeafColumns:I,updateOrderFns:R,leafColumnsLength:N,fixedLeafColumnsLength:O,rightFixedLeafColumnsLength:V,isAllSelected:L,selection:D,reserveSelection:M,selectOnIndeterminate:F,selectable:W,filters:z,filteredData:G,sortingColumn:Y,sortProp:te,sortOrder:Z,hoverRow:fe,...Xe,...wt,...Kn}}}function wO(t,o){return t.map(s=>{var a;return s.id===o.id?o:((a=s.children)!=null&&a.length&&(s.children=wO(s.children,o)),s)})}function RO(t){t.forEach(o=>{var s,a;o.no=(s=o.getColumnIndex)==null?void 0:s.call(o),(a=o.children)!=null&&a.length&&RO(o.children)}),t.sort((o,s)=>o.no-s.no)}function wLe(){const t=mn(),o=CLe();return{ns:Qe("table"),...o,mutations:{setData(h,v){const g=p(h._data)!==v;h.data.value=v,h._data.value=v,t.store.execQuery(),t.store.updateCurrentRowData(),t.store.updateExpandRows(),t.store.updateTreeData(t.store.states.defaultExpandAll.value),p(h.reserveSelection)?(t.store.assertRowKey(),t.store.updateSelectionByRowKey()):g?t.store.clearSelection():t.store.cleanSelection(),t.store.updateAllSelected(),t.$ready&&t.store.scheduleLayout()},insertColumn(h,v,g,E){const b=p(h._columns);let S=[];g?(g&&!g.children&&(g.children=[]),g.children.push(v),S=wO(b,g)):(b.push(v),S=b),RO(S),h._columns.value=S,h.updateOrderFns.push(E),v.type==="selection"&&(h.selectable.value=v.selectable,h.reserveSelection.value=v.reserveSelection),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},updateColumnOrder(h,v){var g;((g=v.getColumnIndex)==null?void 0:g.call(v))!==v.no&&(RO(h._columns.value),t.$ready&&t.store.updateColumns())},removeColumn(h,v,g,E){const b=p(h._columns)||[];if(g)g.children.splice(g.children.findIndex(C=>C.id===v.id),1),Vt(()=>{var C;((C=g.children)==null?void 0:C.length)===0&&delete g.children}),h._columns.value=wO(b,g);else{const C=b.indexOf(v);C>-1&&(b.splice(C,1),h._columns.value=b)}const S=h.updateOrderFns.indexOf(E);S>-1&&h.updateOrderFns.splice(S,1),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},sort(h,v){const{prop:g,order:E,init:b}=v;if(g){const S=p(h.columns).find(C=>C.property===g);S&&(S.order=E,t.store.updateSort(S,g,E),t.store.commit("changeSortCondition",{init:b}))}},changeSortCondition(h,v){const{sortingColumn:g,sortProp:E,sortOrder:b}=h,S=p(g),C=p(E),w=p(b);a_(w)&&(h.sortingColumn.value=null,h.sortProp.value=null);const I={filter:!0};t.store.execQuery(I),(!v||!(v.silent||v.init))&&t.emit("sort-change",{column:S,prop:C,order:w}),t.store.updateTableScrollY()},filterChange(h,v){const{column:g,values:E,silent:b}=v,S=t.store.updateFilters(g,E);t.store.execQuery(),b||t.emit("filter-change",S),t.store.updateTableScrollY()},toggleAllSelection(){t.store.toggleAllSelection()},rowSelectedChanged(h,v){t.store.toggleRowSelection(v),t.store.updateAllSelected()},setHoverRow(h,v){h.hoverRow.value=v},setCurrentRow(h,v){t.store.updateCurrentRow(v)}},commit:function(h,...v){const g=t.store.mutations;if(g[h])g[h].apply(t,[t.store.states].concat(v));else throw new Error(`Action not found: ${h}`)},updateTableScrollY:function(){Vt(()=>t.layout.updateScrollY.apply(t.layout))}}}const Sg={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function RLe(t,o){if(!t)throw new Error("Table is required.");const s=wLe();return s.toggleAllSelection=Hi(s._toggleAllSelection,10),Object.keys(Sg).forEach(a=>{qz(Xz(o,a),a,s)}),ILe(s,o),s}function ILe(t,o){Object.keys(Sg).forEach(s=>{ze(()=>Xz(o,s),a=>{qz(a,s,t)})})}function qz(t,o,s){let a=t,l=Sg[o];fn(Sg[o])&&(l=l.key,a=a||Sg[o].default),s.states[l].value=a}function Xz(t,o){if(o.includes(".")){const s=o.split(".");let a=t;return s.forEach(l=>{a=a[l]}),a}else return t[o]}class ALe{constructor(o){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=ee(null),this.scrollX=ee(!1),this.scrollY=ee(!1),this.bodyWidth=ee(null),this.fixedWidth=ee(null),this.rightFixedWidth=ee(null),this.gutterWidth=0;for(const s in o)zn(o,s)&&(xr(this[s])?this[s].value=o[s]:this[s]=o[s]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){const o=this.height.value;if(a_(o))return!1;const s=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(s!=null&&s.wrapRef)){let a=!0;const l=this.scrollY.value;return a=s.wrapRef.scrollHeight>s.wrapRef.clientHeight,this.scrollY.value=a,l!==a}return!1}setHeight(o,s="height"){if(!Vn)return;const a=this.table.vnode.el;if(o=mLe(o),this.height.value=Number(o),!a&&(o||o===0))return Vt(()=>this.setHeight(o,s));$t(o)?(a.style[s]=`${o}px`,this.updateElsHeight()):Mt(o)&&(a.style[s]=o,this.updateElsHeight())}setMaxHeight(o){this.setHeight(o,"max-height")}getFlattenColumns(){const o=[];return this.table.store.states.columns.value.forEach(a=>{a.isColumnGroup?o.push.apply(o,a.columns):o.push(a)}),o}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(o){if(!o)return!0;let s=o;for(;s.tagName!=="DIV";){if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}updateColumnsWidth(){if(!Vn)return;const o=this.fit,s=this.table.vnode.el.clientWidth;let a=0;const l=this.getFlattenColumns(),d=l.filter(g=>!$t(g.width));if(l.forEach(g=>{$t(g.width)&&g.realWidth&&(g.realWidth=null)}),d.length>0&&o){if(l.forEach(g=>{a+=Number(g.width||g.minWidth||80)}),a<=s){this.scrollX.value=!1;const g=s-a;if(d.length===1)d[0].realWidth=Number(d[0].minWidth||80)+g;else{const E=d.reduce((C,w)=>C+Number(w.minWidth||80),0),b=g/E;let S=0;d.forEach((C,w)=>{if(w===0)return;const I=Math.floor(Number(C.minWidth||80)*b);S+=I,C.realWidth=Number(C.minWidth||80)+I}),d[0].realWidth=Number(d[0].minWidth||80)+g-S}}else this.scrollX.value=!0,d.forEach(g=>{g.realWidth=Number(g.minWidth)});this.bodyWidth.value=Math.max(a,s),this.table.state.resizeState.value.width=this.bodyWidth.value}else l.forEach(g=>{!g.width&&!g.minWidth?g.realWidth=80:g.realWidth=Number(g.width||g.minWidth),a+=g.realWidth}),this.scrollX.value=a>s,this.bodyWidth.value=a;const h=this.store.states.fixedColumns.value;if(h.length>0){let g=0;h.forEach(E=>{g+=Number(E.realWidth||E.width)}),this.fixedWidth.value=g}const v=this.store.states.rightFixedColumns.value;if(v.length>0){let g=0;v.forEach(E=>{g+=Number(E.realWidth||E.width)}),this.rightFixedWidth.value=g}this.notifyObservers("columns")}addObserver(o){this.observers.push(o)}removeObserver(o){const s=this.observers.indexOf(o);s!==-1&&this.observers.splice(s,1)}notifyObservers(o){this.observers.forEach(a=>{var l,d;switch(o){case"columns":(l=a.state)==null||l.onColumnsChange(this);break;case"scrollable":(d=a.state)==null||d.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${o}.`)}})}}const{CheckboxGroup:OLe}=Wa,NLe=me({name:"ElTableFilterPanel",components:{ElCheckbox:Wa,ElCheckboxGroup:OLe,ElScrollbar:gl,ElTooltip:Us,ElIcon:Dt,ArrowDown:uu,ArrowUp:KN},directives:{ClickOutside:ru},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(t){const o=mn(),{t:s}=Fn(),a=Qe("table-filter"),l=o==null?void 0:o.parent;l.filterPanels.value[t.column.id]||(l.filterPanels.value[t.column.id]=o);const d=ee(!1),h=ee(null),v=U(()=>t.column&&t.column.filters),g=U(()=>t.column.filterClassName?`${a.b()} ${t.column.filterClassName}`:a.b()),E=U({get:()=>{var M;return(((M=t.column)==null?void 0:M.filteredValue)||[])[0]},set:M=>{b.value&&(Ec(M)?b.value.splice(0,1):b.value.splice(0,1,M))}}),b=U({get(){return t.column?t.column.filteredValue||[]:[]},set(M){t.column&&t.upDataColumn("filteredValue",M)}}),S=U(()=>t.column?t.column.filterMultiple:!0),C=M=>M.value===E.value,w=()=>{d.value=!1},I=M=>{M.stopPropagation(),d.value=!d.value},R=()=>{d.value=!1},N=()=>{L(b.value),w()},O=()=>{b.value=[],L(b.value),w()},V=M=>{E.value=M,Ec(M)?L([]):L(b.value),w()},L=M=>{t.store.commit("filterChange",{column:t.column,values:M}),t.store.updateAllSelected()};ze(d,M=>{t.column&&t.upDataColumn("filterOpened",M)},{immediate:!0});const D=U(()=>{var M,F;return(F=(M=h.value)==null?void 0:M.popperRef)==null?void 0:F.contentRef});return{tooltipVisible:d,multiple:S,filterClassName:g,filteredValue:b,filterValue:E,filters:v,handleConfirm:N,handleReset:O,handleSelect:V,isPropAbsent:Ec,isActive:C,t:s,ns:a,showFilterPanel:I,hideFilterPanel:R,popperPaneRef:D,tooltip:h}}});function kLe(t,o,s,a,l,d){const h=_n("el-checkbox"),v=_n("el-checkbox-group"),g=_n("el-scrollbar"),E=_n("arrow-up"),b=_n("arrow-down"),S=_n("el-icon"),C=_n("el-tooltip"),w=t0("click-outside");return $(),Ve(C,{ref:"tooltip",visible:t.tooltipVisible,offset:0,placement:t.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":t.filterClassName,persistent:"","append-to":t.appendTo},{content:Ce(()=>[t.multiple?($(),le("div",{key:0},[ue("div",{class:K(t.ns.e("content"))},[ge(g,{"wrap-class":t.ns.e("wrap")},{default:Ce(()=>[ge(v,{modelValue:t.filteredValue,"onUpdate:modelValue":I=>t.filteredValue=I,class:K(t.ns.e("checkbox-group"))},{default:Ce(()=>[($(!0),le(Ut,null,Cn(t.filters,I=>($(),Ve(h,{key:I.value,value:I.value},{default:Ce(()=>[bn(ot(I.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),ue("div",{class:K(t.ns.e("bottom"))},[ue("button",{class:K({[t.ns.is("disabled")]:t.filteredValue.length===0}),disabled:t.filteredValue.length===0,type:"button",onClick:t.handleConfirm},ot(t.t("el.table.confirmFilter")),11,["disabled","onClick"]),ue("button",{type:"button",onClick:t.handleReset},ot(t.t("el.table.resetFilter")),9,["onClick"])],2)])):($(),le("ul",{key:1,class:K(t.ns.e("list"))},[ue("li",{class:K([t.ns.e("list-item"),{[t.ns.is("active")]:t.isPropAbsent(t.filterValue)}]),onClick:I=>t.handleSelect(null)},ot(t.t("el.table.clearFilter")),11,["onClick"]),($(!0),le(Ut,null,Cn(t.filters,I=>($(),le("li",{key:I.value,class:K([t.ns.e("list-item"),t.ns.is("active",t.isActive(I))]),label:I.value,onClick:R=>t.handleSelect(I.value)},ot(I.text),11,["label","onClick"]))),128))],2))]),default:Ce(()=>[ln(($(),le("span",{class:K([`${t.ns.namespace.value}-table__column-filter-trigger`,`${t.ns.namespace.value}-none-outline`]),onClick:t.showFilterPanel},[ge(S,null,{default:Ce(()=>[Ne(t.$slots,"filter-icon",{},()=>[t.column.filterOpened?($(),Ve(E,{key:0})):($(),Ve(b,{key:1}))])]),_:3})],10,["onClick"])),[[w,t.hideFilterPanel,t.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var PLe=dt(NLe,[["render",kLe],["__file","filter-panel.vue"]]);function jk(t){const o=mn();e0(()=>{s.value.addObserver(o)}),dn(()=>{a(s.value),l(s.value)}),wc(()=>{a(s.value),l(s.value)}),iu(()=>{s.value.removeObserver(o)});const s=U(()=>{const d=t.layout;if(!d)throw new Error("Can not find table layout.");return d}),a=d=>{var h;const v=((h=t.vnode.el)==null?void 0:h.querySelectorAll("colgroup > col"))||[];if(!v.length)return;const g=d.getFlattenColumns(),E={};g.forEach(b=>{E[b.id]=b});for(let b=0,S=v.length;b<S;b++){const C=v[b],w=C.getAttribute("name"),I=E[w];I&&C.setAttribute("width",I.realWidth||I.width)}},l=d=>{var h,v;const g=((h=t.vnode.el)==null?void 0:h.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let b=0,S=g.length;b<S;b++)g[b].setAttribute("width",d.scrollY.value?d.gutterWidth:"0");const E=((v=t.vnode.el)==null?void 0:v.querySelectorAll("th.gutter"))||[];for(let b=0,S=E.length;b<S;b++){const C=E[b];C.style.width=d.scrollY.value?`${d.gutterWidth}px`:"0",C.style.display=d.scrollY.value?"":"none"}};return{tableLayout:s.value,onColumnsChange:a,onScrollableChange:l}}const Oc=Symbol("ElTable");function DLe(t,o){const s=mn(),a=It(Oc),l=R=>{R.stopPropagation()},d=(R,N)=>{!N.filters&&N.sortable?I(R,N,!1):N.filterable&&!N.sortable&&l(R),a==null||a.emit("header-click",N,R)},h=(R,N)=>{a==null||a.emit("header-contextmenu",N,R)},v=ee(null),g=ee(!1),E=ee({}),b=(R,N)=>{if(Vn&&!(N.children&&N.children.length>0)&&v.value&&t.border){g.value=!0;const O=a;o("set-drag-visible",!0);const L=(O==null?void 0:O.vnode.el).getBoundingClientRect().left,D=s.vnode.el.querySelector(`th.${N.id}`),M=D.getBoundingClientRect(),F=M.left-L+30;Ua(D,"noclick"),E.value={startMouseLeft:R.clientX,startLeft:M.right-L,startColumnLeft:M.left-L,tableLeft:L};const W=O==null?void 0:O.refs.resizeProxy;W.style.left=`${E.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const z=Y=>{const te=Y.clientX-E.value.startMouseLeft,Z=E.value.startLeft+te;W.style.left=`${Math.max(F,Z)}px`},G=()=>{if(g.value){const{startColumnLeft:Y,startLeft:te}=E.value,fe=Number.parseInt(W.style.left,10)-Y;N.width=N.realWidth=fe,O==null||O.emit("header-dragend",N.width,te-Y,N,R),requestAnimationFrame(()=>{t.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",g.value=!1,v.value=null,E.value={},o("set-drag-visible",!1)}document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",G),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{ti(D,"noclick")},0)};document.addEventListener("mousemove",z),document.addEventListener("mouseup",G)}},S=(R,N)=>{var O;if(N.children&&N.children.length>0)return;const V=R.target;if(!mi(V))return;const L=V==null?void 0:V.closest("th");if(!(!N||!N.resizable||!L)&&!g.value&&t.border){const D=L.getBoundingClientRect(),M=document.body.style,F=((O=L.parentNode)==null?void 0:O.lastElementChild)===L,W=t.allowDragLastColumn||!F;D.width>12&&D.right-R.clientX<8&&W?(M.cursor="col-resize",Fi(L,"is-sortable")&&(L.style.cursor="col-resize"),v.value=N):g.value||(M.cursor="",Fi(L,"is-sortable")&&(L.style.cursor="pointer"),v.value=null)}},C=()=>{Vn&&(document.body.style.cursor="")},w=({order:R,sortOrders:N})=>{if(R==="")return N[0];const O=N.indexOf(R||null);return N[O>N.length-2?0:O+1]},I=(R,N,O)=>{var V;R.stopPropagation();const L=N.order===O?null:O||w(N),D=(V=R.target)==null?void 0:V.closest("th");if(D&&Fi(D,"noclick")){ti(D,"noclick");return}if(!N.sortable)return;const M=R.currentTarget;if(["ascending","descending"].some(Y=>Fi(M,Y)&&!N.sortOrders.includes(Y)))return;const F=t.store.states;let W=F.sortProp.value,z;const G=F.sortingColumn.value;(G!==N||G===N&&a_(G.order))&&(G&&(G.order=null),F.sortingColumn.value=N,W=N.property),L?z=N.order=L:z=N.order=null,F.sortProp.value=W,F.sortOrder.value=z,a==null||a.store.commit("changeSortCondition")};return{handleHeaderClick:d,handleHeaderContextMenu:h,handleMouseDown:b,handleMouseMove:S,handleMouseOut:C,handleSortClick:I,handleFilterClick:l}}function LLe(t){const o=It(Oc),s=Qe("table");return{getHeaderRowStyle:v=>{const g=o==null?void 0:o.props.headerRowStyle;return Ft(g)?g.call(null,{rowIndex:v}):g},getHeaderRowClass:v=>{const g=[],E=o==null?void 0:o.props.headerRowClassName;return Mt(E)?g.push(E):Ft(E)&&g.push(E.call(null,{rowIndex:v})),g.join(" ")},getHeaderCellStyle:(v,g,E,b)=>{var S;let C=(S=o==null?void 0:o.props.headerCellStyle)!=null?S:{};Ft(C)&&(C=C.call(null,{rowIndex:v,columnIndex:g,row:E,column:b}));const w=Bk(g,b.fixed,t.store,E);return tm(w,"left"),tm(w,"right"),Object.assign({},C,w)},getHeaderCellClass:(v,g,E,b)=>{const S=Fk(s.b(),g,b.fixed,t.store,E),C=[b.id,b.order,b.headerAlign,b.className,b.labelClassName,...S];b.children||C.push("is-leaf"),b.sortable&&C.push("is-sortable");const w=o==null?void 0:o.props.headerCellClassName;return Mt(w)?C.push(w):Ft(w)&&C.push(w.call(null,{rowIndex:v,columnIndex:g,row:E,column:b})),C.push(s.e("cell")),C.filter(I=>!!I).join(" ")}}}const Jz=t=>{const o=[];return t.forEach(s=>{s.children?(o.push(s),o.push.apply(o,Jz(s.children))):o.push(s)}),o},Zz=t=>{let o=1;const s=(d,h)=>{if(h&&(d.level=h.level+1,o<d.level&&(o=d.level)),d.children){let v=0;d.children.forEach(g=>{s(g,d),v+=g.colSpan}),d.colSpan=v}else d.colSpan=1};t.forEach(d=>{d.level=1,s(d,void 0)});const a=[];for(let d=0;d<o;d++)a.push([]);return Jz(t).forEach(d=>{d.children?(d.rowSpan=1,d.children.forEach(h=>h.isSubColumn=!0)):d.rowSpan=o-d.level+1,a[d.level-1].push(d)}),a};function MLe(t){const o=It(Oc),s=U(()=>Zz(t.store.states.originColumns.value));return{isGroup:U(()=>{const d=s.value.length>1;return d&&o&&(o.state.isGroup.value=!0),d}),toggleAllSelection:d=>{d.stopPropagation(),o==null||o.store.commit("toggleAllSelection")},columnRows:s}}var xLe=me({name:"ElTableHeader",components:{ElCheckbox:Wa},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String},allowDragLastColumn:{type:Boolean}},setup(t,{emit:o}){const s=mn(),a=It(Oc),l=Qe("table"),d=ee({}),{onColumnsChange:h,onScrollableChange:v}=jk(a),g=(a==null?void 0:a.props.tableLayout)==="auto",E=er(new Map),b=ee(),S=()=>{setTimeout(()=>{E.size>0&&(E.forEach((Y,te)=>{const Z=b.value.querySelector(`.${te.replace(/\s/g,".")}`);if(Z){const fe=Z.getBoundingClientRect().width;Y.width=fe}}),E.clear())})};ze(E,S),dn(async()=>{await Vt(),await Vt();const{prop:Y,order:te}=t.defaultSort;a==null||a.store.commit("sort",{prop:Y,order:te,init:!0}),S()});const{handleHeaderClick:C,handleHeaderContextMenu:w,handleMouseDown:I,handleMouseMove:R,handleMouseOut:N,handleSortClick:O,handleFilterClick:V}=DLe(t,o),{getHeaderRowStyle:L,getHeaderRowClass:D,getHeaderCellStyle:M,getHeaderCellClass:F}=LLe(t),{isGroup:W,toggleAllSelection:z,columnRows:G}=MLe(t);return s.state={onColumnsChange:h,onScrollableChange:v},s.filterPanels=d,{ns:l,filterPanels:d,onColumnsChange:h,onScrollableChange:v,columnRows:G,getHeaderRowClass:D,getHeaderRowStyle:L,getHeaderCellClass:F,getHeaderCellStyle:M,handleHeaderClick:C,handleHeaderContextMenu:w,handleMouseDown:I,handleMouseMove:R,handleMouseOut:N,handleSortClick:O,handleFilterClick:V,isGroup:W,toggleAllSelection:z,saveIndexSelection:E,isTableLayoutAuto:g,theadRef:b,updateFixedColumnStyle:S}},render(){const{ns:t,isGroup:o,columnRows:s,getHeaderCellStyle:a,getHeaderCellClass:l,getHeaderRowClass:d,getHeaderRowStyle:h,handleHeaderClick:v,handleHeaderContextMenu:g,handleMouseDown:E,handleMouseMove:b,handleSortClick:S,handleMouseOut:C,store:w,$parent:I,saveIndexSelection:R,isTableLayoutAuto:N}=this;let O=1;return Ht("thead",{ref:"theadRef",class:{[t.is("group")]:o}},s.map((V,L)=>Ht("tr",{class:d(L),key:L,style:h(L)},V.map((D,M)=>{D.rowSpan>O&&(O=D.rowSpan);const F=l(L,M,V,D);return N&&D.fixed&&R.set(F,D),Ht("th",{class:F,colspan:D.colSpan,key:`${D.id}-thead`,rowspan:D.rowSpan,style:a(L,M,V,D),onClick:W=>{W.currentTarget.classList.contains("noclick")||v(W,D)},onContextmenu:W=>g(W,D),onMousedown:W=>E(W,D),onMousemove:W=>b(W,D),onMouseout:C},[Ht("div",{class:["cell",D.filteredValue&&D.filteredValue.length>0?"highlight":""]},[D.renderHeader?D.renderHeader({column:D,$index:M,store:w,_self:I}):D.label,D.sortable&&Ht("span",{onClick:W=>S(W,D),class:"caret-wrapper"},[Ht("i",{onClick:W=>S(W,D,"ascending"),class:"sort-caret ascending"}),Ht("i",{onClick:W=>S(W,D,"descending"),class:"sort-caret descending"})]),D.filterable&&Ht(PLe,{store:w,placement:D.filterPlacement||"bottom-start",appendTo:I.appendFilterPanelTo,column:D,upDataColumn:(W,z)=>{D[W]=z}},{"filter-icon":()=>D.renderFilterIcon?D.renderFilterIcon({filterOpened:D.filterOpened}):null})])])}))))}});function _A(t,o,s=.03){return t-o>s}function ULe(t){const o=It(Oc),s=ee(""),a=ee(Ht("div")),l=(I,R,N)=>{var O;const V=o,L=gA(I);let D;const M=(O=V==null?void 0:V.vnode.el)==null?void 0:O.dataset.prefix;L&&(D=HH({columns:t.store.states.columns.value},L,M),D&&(V==null||V.emit(`cell-${N}`,R,D,L,I))),V==null||V.emit(`row-${N}`,R,D,I)},d=(I,R)=>{l(I,R,"dblclick")},h=(I,R)=>{t.store.commit("setCurrentRow",R),l(I,R,"click")},v=(I,R)=>{l(I,R,"contextmenu")},g=Hi(I=>{t.store.commit("setHoverRow",I)},30),E=Hi(()=>{t.store.commit("setHoverRow",null)},30),b=I=>{const R=window.getComputedStyle(I,null),N=Number.parseInt(R.paddingLeft,10)||0,O=Number.parseInt(R.paddingRight,10)||0,V=Number.parseInt(R.paddingTop,10)||0,L=Number.parseInt(R.paddingBottom,10)||0;return{left:N,right:O,top:V,bottom:L}},S=(I,R,N)=>{let O=R.target.parentNode;for(;I>1&&(O=O==null?void 0:O.nextSibling,!(!O||O.nodeName!=="TR"));)N(O,"hover-row hover-fixed-row"),I--};return{handleDoubleClick:d,handleClick:h,handleContextMenu:v,handleMouseEnter:g,handleMouseLeave:E,handleCellMouseEnter:(I,R,N)=>{var O,V,L;const D=o,M=gA(I),F=(O=D==null?void 0:D.vnode.el)==null?void 0:O.dataset.prefix;let W;if(M){W=HH({columns:t.store.states.columns.value},M,F),M.rowSpan>1&&S(M.rowSpan,I,Ua);const pe=D.hoverState={cell:M,column:W,row:R};D==null||D.emit("cell-mouse-enter",pe.row,pe.column,pe.cell,I)}if(!N)return;const z=I.target.querySelector(".cell");if(!(Fi(z,`${F}-tooltip`)&&z.childNodes.length))return;const G=document.createRange();G.setStart(z,0),G.setEnd(z,z.childNodes.length);const{width:Y,height:te}=G.getBoundingClientRect(),{width:Z,height:fe}=z.getBoundingClientRect(),{top:Ee,left:ae,right:X,bottom:ie}=b(z),se=ae+X,J=Ee+ie;_A(Y+se,Z)||_A(te+J,fe)||_A(z.scrollWidth,Z)?ELe(N,M.innerText||M.textContent,R,W,M,D):((V=Vi)==null?void 0:V.trigger)===M&&((L=Vi)==null||L())},handleCellMouseLeave:I=>{const R=gA(I);if(!R)return;R.rowSpan>1&&S(R.rowSpan,I,ti);const N=o==null?void 0:o.hoverState;o==null||o.emit("cell-mouse-leave",N==null?void 0:N.row,N==null?void 0:N.column,N==null?void 0:N.cell,I)},tooltipContent:s,tooltipTrigger:a}}function VLe(t){const o=It(Oc),s=Qe("table");return{getRowStyle:(E,b)=>{const S=o==null?void 0:o.props.rowStyle;return Ft(S)?S.call(null,{row:E,rowIndex:b}):S||null},getRowClass:(E,b)=>{const S=[s.e("row")];o!=null&&o.props.highlightCurrentRow&&E===t.store.states.currentRow.value&&S.push("current-row"),t.stripe&&b%2===1&&S.push(s.em("row","striped"));const C=o==null?void 0:o.props.rowClassName;return Mt(C)?S.push(C):Ft(C)&&S.push(C.call(null,{row:E,rowIndex:b})),S},getCellStyle:(E,b,S,C)=>{const w=o==null?void 0:o.props.cellStyle;let I=w??{};Ft(w)&&(I=w.call(null,{rowIndex:E,columnIndex:b,row:S,column:C}));const R=Bk(b,t==null?void 0:t.fixed,t.store);return tm(R,"left"),tm(R,"right"),Object.assign({},I,R)},getCellClass:(E,b,S,C,w)=>{const I=Fk(s.b(),b,t==null?void 0:t.fixed,t.store,void 0,w),R=[C.id,C.align,C.className,...I],N=o==null?void 0:o.props.cellClassName;return Mt(N)?R.push(N):Ft(N)&&R.push(N.call(null,{rowIndex:E,columnIndex:b,row:S,column:C})),R.push(s.e("cell")),R.filter(O=>!!O).join(" ")},getSpan:(E,b,S,C)=>{let w=1,I=1;const R=o==null?void 0:o.props.spanMethod;if(Ft(R)){const N=R({row:E,column:b,rowIndex:S,columnIndex:C});st(N)?(w=N[0],I=N[1]):fn(N)&&(w=N.rowspan,I=N.colspan)}return{rowspan:w,colspan:I}},getColspanRealWidth:(E,b,S)=>{if(b<1)return E[S].realWidth;const C=E.map(({realWidth:w,width:I})=>w||I).slice(S,S+b);return Number(C.reduce((w,I)=>Number(w)+Number(I),-1))}}}const FLe=me({name:"TableTdWrapper"}),BLe=me({...FLe,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(t){return(o,s)=>($(),le("td",{colspan:t.colspan,rowspan:t.rowspan},[Ne(o.$slots,"default")],8,["colspan","rowspan"]))}});var jLe=dt(BLe,[["__file","td-wrapper.vue"]]);function $Le(t){const o=It(Oc),s=Qe("table"),{handleDoubleClick:a,handleClick:l,handleContextMenu:d,handleMouseEnter:h,handleMouseLeave:v,handleCellMouseEnter:g,handleCellMouseLeave:E,tooltipContent:b,tooltipTrigger:S}=ULe(t),{getRowStyle:C,getRowClass:w,getCellStyle:I,getCellClass:R,getSpan:N,getColspanRealWidth:O}=VLe(t),V=U(()=>t.store.states.columns.value.findIndex(({type:W})=>W==="default")),L=(W,z)=>{const G=o.props.rowKey;return G?Zs(W,G):z},D=(W,z,G,Y=!1)=>{const{tooltipEffect:te,tooltipOptions:Z,store:fe}=t,{indent:Ee,columns:ae}=fe.states,X=w(W,z);let ie=!0;return G&&(X.push(s.em("row",`level-${G.level}`)),ie=G.display),Ht("tr",{style:[ie?null:{display:"none"},C(W,z)],class:X,key:L(W,z),onDblclick:J=>a(J,W),onClick:J=>l(J,W),onContextmenu:J=>d(J,W),onMouseenter:()=>h(z),onMouseleave:v},ae.value.map((J,pe)=>{const{rowspan:be,colspan:Ae}=N(W,J,z,pe);if(!be||!Ae)return null;const _e=Object.assign({},J);_e.realWidth=O(ae.value,Ae,pe);const Me={store:t.store,_self:t.context||o,column:_e,row:W,$index:z,cellIndex:pe,expanded:Y};pe===V.value&&G&&(Me.treeNode={indent:G.level*Ee.value,level:G.level},wr(G.expanded)&&(Me.treeNode.expanded=G.expanded,"loading"in G&&(Me.treeNode.loading=G.loading),"noLazyChildren"in G&&(Me.treeNode.noLazyChildren=G.noLazyChildren)));const Fe=`${L(W,z)},${pe}`,Le=_e.columnKey||_e.rawColumnKey||"",Pe=J.showOverflowTooltip&&JW({effect:te},Z,J.showOverflowTooltip);return Ht(jLe,{style:I(z,pe,W,J),class:R(z,pe,W,J,Ae-1),key:`${Le}${Fe}`,rowspan:be,colspan:Ae,onMouseenter:He=>g(He,W,Pe),onMouseleave:E},{default:()=>M(pe,J,Me)})}))},M=(W,z,G)=>z.renderCell(G);return{wrappedRowRender:(W,z)=>{const G=t.store,{isRowExpanded:Y,assertRowKey:te}=G,{treeData:Z,lazyTreeNodeMap:fe,childrenColumnName:Ee,rowKey:ae}=G.states,X=G.states.columns.value;if(X.some(({type:se})=>se==="expand")){const se=Y(W),J=D(W,z,void 0,se),pe=o.renderExpanded;if(!pe)return console.error("[Element Error]renderExpanded is required."),J;const be=[[J]];return(o.props.preserveExpandedContent||se)&&be[0].push(Ht("tr",{key:`expanded-row__${J.key}`,style:{display:se?"":"none"}},[Ht("td",{colspan:X.length,class:`${s.e("cell")} ${s.e("expanded-cell")}`},[pe({row:W,$index:z,store:G,expanded:se})])])),be}else if(Object.keys(Z.value).length){te();const se=Zs(W,ae.value);let J=Z.value[se],pe=null;J&&(pe={expanded:J.expanded,level:J.level,display:!0},wr(J.lazy)&&(wr(J.loaded)&&J.loaded&&(pe.noLazyChildren=!(J.children&&J.children.length)),pe.loading=J.loading));const be=[D(W,z,pe)];if(J){let Ae=0;const _e=(Fe,Le)=>{Fe&&Fe.length&&Le&&Fe.forEach(Pe=>{const He={display:Le.display&&Le.expanded,level:Le.level+1,expanded:!1,noLazyChildren:!1,loading:!1},We=Zs(Pe,ae.value);if(Ec(We))throw new Error("For nested data item, row-key is required.");if(J={...Z.value[We]},J&&(He.expanded=J.expanded,J.level=J.level||He.level,J.display=!!(J.expanded&&He.display),wr(J.lazy)&&(wr(J.loaded)&&J.loaded&&(He.noLazyChildren=!(J.children&&J.children.length)),He.loading=J.loading)),Ae++,be.push(D(Pe,z+Ae,He)),J){const yt=fe.value[We]||Pe[Ee.value];_e(yt,J)}})};J.display=!0;const Me=fe.value[se]||W[Ee.value];_e(Me,J)}return be}else return D(W,z,void 0)},tooltipContent:b,tooltipTrigger:S}}const HLe={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var WLe=me({name:"ElTableBody",props:HLe,setup(t){const o=mn(),s=It(Oc),a=Qe("table"),{wrappedRowRender:l,tooltipContent:d,tooltipTrigger:h}=$Le(t),{onColumnsChange:v,onScrollableChange:g}=jk(s),E=[];return ze(t.store.states.hoverRow,(b,S)=>{var C;const w=o==null?void 0:o.vnode.el,I=Array.from((w==null?void 0:w.children)||[]).filter(O=>O==null?void 0:O.classList.contains(`${a.e("row")}`));let R=b;const N=(C=I[R])==null?void 0:C.childNodes;if(N!=null&&N.length){let O=0;Array.from(N).reduce((L,D,M)=>{var F,W;return((F=N[M])==null?void 0:F.colSpan)>1&&(O=(W=N[M])==null?void 0:W.colSpan),D.nodeName!=="TD"&&O===0&&L.push(M),O>0&&O--,L},[]).forEach(L=>{var D;for(R=b;R>0;){const M=(D=I[R-1])==null?void 0:D.childNodes;if(M[L]&&M[L].nodeName==="TD"&&M[L].rowSpan>1){Ua(M[L],"hover-cell"),E.push(M[L]);break}R--}})}else E.forEach(O=>ti(O,"hover-cell")),E.length=0;!t.store.states.isComplex.value||!Vn||ld(()=>{const O=I[S],V=I[b];O&&!O.classList.contains("hover-fixed-row")&&ti(O,"hover-row"),V&&Ua(V,"hover-row")})}),iu(()=>{var b;(b=Vi)==null||b()}),{ns:a,onColumnsChange:v,onScrollableChange:g,wrappedRowRender:l,tooltipContent:d,tooltipTrigger:h}},render(){const{wrappedRowRender:t,store:o}=this,s=o.states.data.value||[];return Ht("tbody",{tabIndex:-1},[s.reduce((a,l)=>a.concat(t(l,a.length)),[])])}});function KLe(){const t=It(Oc),o=t==null?void 0:t.store,s=U(()=>o.states.fixedLeafColumnsLength.value),a=U(()=>o.states.rightFixedColumns.value.length),l=U(()=>o.states.columns.value.length),d=U(()=>o.states.fixedColumns.value.length),h=U(()=>o.states.rightFixedColumns.value.length);return{leftFixedLeafCount:s,rightFixedLeafCount:a,columnsCount:l,leftFixedCount:d,rightFixedCount:h,columns:o.states.columns}}function GLe(t){const{columns:o}=KLe(),s=Qe("table");return{getCellClasses:(d,h)=>{const v=d[h],g=[s.e("cell"),v.id,v.align,v.labelClassName,...Fk(s.b(),h,v.fixed,t.store)];return v.className&&g.push(v.className),v.children||g.push(s.is("leaf")),g},getCellStyles:(d,h)=>{const v=Bk(h,d.fixed,t.store);return tm(v,"left"),tm(v,"right"),v},columns:o}}var zLe=me({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t){const o=It(Oc),s=Qe("table"),{getCellClasses:a,getCellStyles:l,columns:d}=GLe(t),{onScrollableChange:h,onColumnsChange:v}=jk(o);return{ns:s,onScrollableChange:h,onColumnsChange:v,getCellClasses:a,getCellStyles:l,columns:d}},render(){const{columns:t,getCellStyles:o,getCellClasses:s,summaryMethod:a,sumText:l}=this,d=this.store.states.data.value;let h=[];return a?h=a({columns:t,data:d}):t.forEach((v,g)=>{if(g===0){h[g]=l;return}const E=d.map(w=>Number(w[v.property])),b=[];let S=!0;E.forEach(w=>{if(!Number.isNaN(+w)){S=!1;const I=`${w}`.split(".")[1];b.push(I?I.length:0)}});const C=Math.max.apply(null,b);S?h[g]="":h[g]=E.reduce((w,I)=>{const R=Number(I);return Number.isNaN(+R)?w:Number.parseFloat((w+I).toFixed(Math.min(C,20)))},0)}),Ht(Ht("tfoot",[Ht("tr",{},[...t.map((v,g)=>Ht("td",{key:g,colspan:v.colSpan,rowspan:v.rowSpan,class:s(t,g),style:o(v,g)},[Ht("div",{class:["cell",v.labelClassName]},[h[g]])]))])]))}});function YLe(t){return{setCurrentRow:S=>{t.commit("setCurrentRow",S)},getSelectionRows:()=>t.getSelectionRows(),toggleRowSelection:(S,C,w=!0)=>{t.toggleRowSelection(S,C,!1,w),t.updateAllSelected()},clearSelection:()=>{t.clearSelection()},clearFilter:S=>{t.clearFilter(S)},toggleAllSelection:()=>{t.commit("toggleAllSelection")},toggleRowExpansion:(S,C)=>{t.toggleRowExpansionAdapter(S,C)},clearSort:()=>{t.clearSort()},sort:(S,C)=>{t.commit("sort",{prop:S,order:C})},updateKeyChildren:(S,C)=>{t.updateKeyChildren(S,C)}}}function qLe(t,o,s,a){const l=ee(!1),d=ee(null),h=ee(!1),v=se=>{h.value=se},g=ee({width:null,height:null,headerHeight:null}),E=ee(!1),b={display:"inline-block",verticalAlign:"middle"},S=ee(),C=ee(0),w=ee(0),I=ee(0),R=ee(0),N=ee(0);Ms(()=>{o.setHeight(t.height)}),Ms(()=>{o.setMaxHeight(t.maxHeight)}),ze(()=>[t.currentRowKey,s.states.rowKey],([se,J])=>{!p(J)||!p(se)||s.setCurrentRowKey(`${se}`)},{immediate:!0}),ze(()=>t.data,se=>{a.store.commit("setData",se)},{immediate:!0,deep:!0}),Ms(()=>{t.expandRowKeys&&s.setExpandRowKeysAdapter(t.expandRowKeys)});const O=()=>{a.store.commit("setHoverRow",null),a.hoverState&&(a.hoverState=null)},V=(se,J)=>{const{pixelX:pe,pixelY:be}=J;Math.abs(pe)>=Math.abs(be)&&(a.refs.bodyWrapper.scrollLeft+=J.pixelX/5)},L=U(()=>t.height||t.maxHeight||s.states.fixedColumns.value.length>0||s.states.rightFixedColumns.value.length>0),D=U(()=>({width:o.bodyWidth.value?`${o.bodyWidth.value}px`:""})),M=()=>{L.value&&o.updateElsHeight(),o.updateColumnsWidth(),!(typeof window>"u")&&requestAnimationFrame(G)};dn(async()=>{await Vt(),s.updateColumns(),Y(),requestAnimationFrame(M);const se=a.vnode.el,J=a.refs.headerWrapper;t.flexible&&se&&se.parentElement&&(se.parentElement.style.minWidth="0"),g.value={width:S.value=se.offsetWidth,height:se.offsetHeight,headerHeight:t.showHeader&&J?J.offsetHeight:null},s.states.columns.value.forEach(pe=>{pe.filteredValue&&pe.filteredValue.length&&a.store.commit("filterChange",{column:pe,values:pe.filteredValue,silent:!0})}),a.$ready=!0});const F=(se,J)=>{if(!se)return;const pe=Array.from(se.classList).filter(be=>!be.startsWith("is-scrolling-"));pe.push(o.scrollX.value?J:"is-scrolling-none"),se.className=pe.join(" ")},W=se=>{const{tableWrapper:J}=a.refs;F(J,se)},z=se=>{const{tableWrapper:J}=a.refs;return!!(J&&J.classList.contains(se))},G=function(){if(!a.refs.scrollBarRef)return;if(!o.scrollX.value){const Fe="is-scrolling-none";z(Fe)||W(Fe);return}const se=a.refs.scrollBarRef.wrapRef;if(!se)return;const{scrollLeft:J,offsetWidth:pe,scrollWidth:be}=se,{headerWrapper:Ae,footerWrapper:_e}=a.refs;Ae&&(Ae.scrollLeft=J),_e&&(_e.scrollLeft=J);const Me=be-pe-1;J>=Me?W("is-scrolling-right"):W(J===0?"is-scrolling-left":"is-scrolling-middle")},Y=()=>{a.refs.scrollBarRef&&(a.refs.scrollBarRef.wrapRef&&gr(a.refs.scrollBarRef.wrapRef,"scroll",G,{passive:!0}),t.fit?co(a.vnode.el,te):gr(window,"resize",te),co(a.refs.bodyWrapper,()=>{var se,J;te(),(J=(se=a.refs)==null?void 0:se.scrollBarRef)==null||J.update()}))},te=()=>{var se,J,pe,be;const Ae=a.vnode.el;if(!a.$ready||!Ae)return;let _e=!1;const{width:Me,height:Fe,headerHeight:Le}=g.value,Pe=S.value=Ae.offsetWidth;Me!==Pe&&(_e=!0);const He=Ae.offsetHeight;(t.height||L.value)&&Fe!==He&&(_e=!0);const We=t.tableLayout==="fixed"?a.refs.headerWrapper:(se=a.refs.tableHeaderRef)==null?void 0:se.$el;t.showHeader&&(We==null?void 0:We.offsetHeight)!==Le&&(_e=!0),C.value=((J=a.refs.tableWrapper)==null?void 0:J.scrollHeight)||0,I.value=(We==null?void 0:We.scrollHeight)||0,R.value=((pe=a.refs.footerWrapper)==null?void 0:pe.offsetHeight)||0,N.value=((be=a.refs.appendWrapper)==null?void 0:be.offsetHeight)||0,w.value=C.value-I.value-R.value-N.value,_e&&(g.value={width:Pe,height:He,headerHeight:t.showHeader&&(We==null?void 0:We.offsetHeight)||0},M())},Z=xo(),fe=U(()=>{const{bodyWidth:se,scrollY:J,gutterWidth:pe}=o;return se.value?`${se.value-(J.value?pe:0)}px`:""}),Ee=U(()=>t.maxHeight?"fixed":t.tableLayout),ae=U(()=>{if(t.data&&t.data.length)return null;let se="100%";t.height&&w.value&&(se=`${w.value}px`);const J=S.value;return{width:J?`${J}px`:"",height:se}}),X=U(()=>t.height?{height:"100%"}:t.maxHeight?Number.isNaN(Number(t.maxHeight))?{maxHeight:`calc(${t.maxHeight} - ${I.value+R.value}px)`}:{maxHeight:`${t.maxHeight-I.value-R.value}px`}:{});return{isHidden:l,renderExpanded:d,setDragVisible:v,isGroup:E,handleMouseLeave:O,handleHeaderFooterMousewheel:V,tableSize:Z,emptyBlockStyle:ae,handleFixedMousewheel:(se,J)=>{const pe=a.refs.bodyWrapper;if(Math.abs(J.spinY)>0){const be=pe.scrollTop;J.pixelY<0&&be!==0&&se.preventDefault(),J.pixelY>0&&pe.scrollHeight-pe.clientHeight>be&&se.preventDefault(),pe.scrollTop+=Math.ceil(J.pixelY/5)}else pe.scrollLeft+=Math.ceil(J.pixelX/5)},resizeProxyVisible:h,bodyWidth:fe,resizeState:g,doLayout:M,tableBodyStyles:D,tableLayout:Ee,scrollbarViewStyle:b,scrollbarStyle:X}}function XLe(t){const o=ee(),s=()=>{const l=t.vnode.el.querySelector(".hidden-columns"),d={childList:!0,subtree:!0},h=t.store.states.updateOrderFns;o.value=new MutationObserver(()=>{h.forEach(v=>v())}),o.value.observe(l,d)};dn(()=>{s()}),iu(()=>{var a;(a=o.value)==null||a.disconnect()})}var JLe={data:{type:Array,default:()=>[]},size:Ho,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],tooltipFormatter:Function,appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0},allowDragLastColumn:{type:Boolean,default:!0},preserveExpandedContent:{type:Boolean,default:!1}};function Qz(t){const o=t.tableLayout==="auto";let s=t.columns||[];o&&s.every(({width:l})=>Xn(l))&&(s=[]);const a=l=>{const d={key:`${t.tableLayout}_${l.id}`,style:{},name:void 0};return o?d.style={width:`${l.width}px`}:d.name=l.id,d};return Ht("colgroup",{},s.map(l=>Ht("col",a(l))))}Qz.props=["columns","tableLayout"];const ZLe=()=>{const t=ee(),o=(d,h)=>{const v=t.value;v&&v.scrollTo(d,h)},s=(d,h)=>{const v=t.value;v&&$t(h)&&["Top","Left"].includes(d)&&v[`setScroll${d}`](h)};return{scrollBarRef:t,scrollTo:o,setScrollTop:d=>s("Top",d),setScrollLeft:d=>s("Left",d)}};var GH=!1,_h,IO,AO,Xb,Jb,eY,Zb,OO,NO,kO,tY,PO,DO,nY,rY;function Ui(){if(!GH){GH=!0;var t=navigator.userAgent,o=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),s=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(PO=/\b(iPhone|iP[ao]d)/.exec(t),DO=/\b(iP[ao]d)/.exec(t),kO=/Android/i.exec(t),nY=/FBAN\/\w+;/i.exec(t),rY=/Mobile/i.exec(t),tY=!!/Win64/.exec(t),o){_h=o[1]?parseFloat(o[1]):o[5]?parseFloat(o[5]):NaN,_h&&document&&document.documentMode&&(_h=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(t);eY=a?parseFloat(a[1])+4:_h,IO=o[2]?parseFloat(o[2]):NaN,AO=o[3]?parseFloat(o[3]):NaN,Xb=o[4]?parseFloat(o[4]):NaN,Xb?(o=/(?:Chrome\/(\d+\.\d+))/.exec(t),Jb=o&&o[1]?parseFloat(o[1]):NaN):Jb=NaN}else _h=IO=AO=Jb=Xb=NaN;if(s){if(s[1]){var l=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);Zb=l?parseFloat(l[1].replace("_",".")):!0}else Zb=!1;OO=!!s[2],NO=!!s[3]}else Zb=OO=NO=!1}}var LO={ie:function(){return Ui()||_h},ieCompatibilityMode:function(){return Ui()||eY>_h},ie64:function(){return LO.ie()&&tY},firefox:function(){return Ui()||IO},opera:function(){return Ui()||AO},webkit:function(){return Ui()||Xb},safari:function(){return LO.webkit()},chrome:function(){return Ui()||Jb},windows:function(){return Ui()||OO},osx:function(){return Ui()||Zb},linux:function(){return Ui()||NO},iphone:function(){return Ui()||PO},mobile:function(){return Ui()||PO||DO||kO||rY},nativeApp:function(){return Ui()||nY},android:function(){return Ui()||kO},ipad:function(){return Ui()||DO}},QLe=LO,eMe=!!(typeof window<"u"&&window.document&&window.document.createElement),tMe={canUseDOM:eMe},oY=tMe,sY;oY.canUseDOM&&(sY=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function nMe(t,o){if(!oY.canUseDOM||o&&!("addEventListener"in document))return!1;var s="on"+t,a=s in document;if(!a){var l=document.createElement("div");l.setAttribute(s,"return;"),a=typeof l[s]=="function"}return!a&&sY&&t==="wheel"&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a}var rMe=nMe,zH=10,YH=40,qH=800;function iY(t){var o=0,s=0,a=0,l=0;return"detail"in t&&(s=t.detail),"wheelDelta"in t&&(s=-t.wheelDelta/120),"wheelDeltaY"in t&&(s=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(o=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(o=s,s=0),a=o*zH,l=s*zH,"deltaY"in t&&(l=t.deltaY),"deltaX"in t&&(a=t.deltaX),(a||l)&&t.deltaMode&&(t.deltaMode==1?(a*=YH,l*=YH):(a*=qH,l*=qH)),a&&!o&&(o=a<1?-1:1),l&&!s&&(s=l<1?-1:1),{spinX:o,spinY:s,pixelX:a,pixelY:l}}iY.getEventType=function(){return QLe.firefox()?"DOMMouseScroll":rMe("wheel")?"wheel":"mousewheel"};var oMe=iY;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const sMe=function(t,o){if(t&&t.addEventListener){const s=function(a){const l=oMe(a);o&&Reflect.apply(o,this,[a,l])};t.addEventListener("wheel",s,{passive:!0})}},iMe={beforeMount(t,o){sMe(t,o.value)}};let aMe=1;const cMe=me({name:"ElTable",directives:{Mousewheel:iMe},components:{TableHeader:xLe,TableBody:WLe,TableFooter:zLe,ElScrollbar:gl,hColgroup:Qz},props:JLe,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(t){const{t:o}=Fn(),s=Qe("table"),a=mn();wn(Oc,a);const l=RLe(a,t);a.store=l;const d=new ALe({store:a.store,table:a,fit:t.fit,showHeader:t.showHeader});a.layout=d;const h=U(()=>(l.states.data.value||[]).length===0),{setCurrentRow:v,getSelectionRows:g,toggleRowSelection:E,clearSelection:b,clearFilter:S,toggleAllSelection:C,toggleRowExpansion:w,clearSort:I,sort:R,updateKeyChildren:N}=YLe(l),{isHidden:O,renderExpanded:V,setDragVisible:L,isGroup:D,handleMouseLeave:M,handleHeaderFooterMousewheel:F,tableSize:W,emptyBlockStyle:z,handleFixedMousewheel:G,resizeProxyVisible:Y,bodyWidth:te,resizeState:Z,doLayout:fe,tableBodyStyles:Ee,tableLayout:ae,scrollbarViewStyle:X,scrollbarStyle:ie}=qLe(t,d,l,a),{scrollBarRef:se,scrollTo:J,setScrollLeft:pe,setScrollTop:be}=ZLe(),Ae=Hi(fe,50),_e=`${s.namespace.value}-table_${aMe++}`;a.tableId=_e,a.state={isGroup:D,resizeState:Z,doLayout:fe,debouncedUpdateLayout:Ae};const Me=U(()=>{var Pe;return(Pe=t.sumText)!=null?Pe:o("el.table.sumText")}),Fe=U(()=>{var Pe;return(Pe=t.emptyText)!=null?Pe:o("el.table.emptyText")}),Le=U(()=>Zz(l.states.originColumns.value)[0]);return XLe(a),Rr(()=>{Ae.cancel()}),{ns:s,layout:d,store:l,columns:Le,handleHeaderFooterMousewheel:F,handleMouseLeave:M,tableId:_e,tableSize:W,isHidden:O,isEmpty:h,renderExpanded:V,resizeProxyVisible:Y,resizeState:Z,isGroup:D,bodyWidth:te,tableBodyStyles:Ee,emptyBlockStyle:z,debouncedUpdateLayout:Ae,handleFixedMousewheel:G,setCurrentRow:v,getSelectionRows:g,toggleRowSelection:E,clearSelection:b,clearFilter:S,toggleAllSelection:C,toggleRowExpansion:w,clearSort:I,doLayout:fe,sort:R,updateKeyChildren:N,t:o,setDragVisible:L,context:a,computedSumText:Me,computedEmptyText:Fe,tableLayout:ae,scrollbarViewStyle:X,scrollbarStyle:ie,scrollBarRef:se,scrollTo:J,setScrollLeft:pe,setScrollTop:be,allowDragLastColumn:t.allowDragLastColumn}}});function lMe(t,o,s,a,l,d){const h=_n("hColgroup"),v=_n("table-header"),g=_n("table-body"),E=_n("table-footer"),b=_n("el-scrollbar"),S=t0("mousewheel");return $(),le("div",{ref:"tableWrapper",class:K([{[t.ns.m("fit")]:t.fit,[t.ns.m("striped")]:t.stripe,[t.ns.m("border")]:t.border||t.isGroup,[t.ns.m("hidden")]:t.isHidden,[t.ns.m("group")]:t.isGroup,[t.ns.m("fluid-height")]:t.maxHeight,[t.ns.m("scrollable-x")]:t.layout.scrollX.value,[t.ns.m("scrollable-y")]:t.layout.scrollY.value,[t.ns.m("enable-row-hover")]:!t.store.states.isComplex.value,[t.ns.m("enable-row-transition")]:(t.store.states.data.value||[]).length!==0&&(t.store.states.data.value||[]).length<100,"has-footer":t.showSummary},t.ns.m(t.tableSize),t.className,t.ns.b(),t.ns.m(`layout-${t.tableLayout}`)]),style:jt(t.style),"data-prefix":t.ns.namespace.value,onMouseleave:t.handleMouseLeave},[ue("div",{class:K(t.ns.e("inner-wrapper"))},[ue("div",{ref:"hiddenColumns",class:"hidden-columns"},[Ne(t.$slots,"default")],512),t.showHeader&&t.tableLayout==="fixed"?ln(($(),le("div",{key:0,ref:"headerWrapper",class:K(t.ns.e("header-wrapper"))},[ue("table",{ref:"tableHeader",class:K(t.ns.e("header")),style:jt(t.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[ge(h,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),ge(v,{ref:"tableHeaderRef",border:t.border,"default-sort":t.defaultSort,store:t.store,"append-filter-panel-to":t.appendFilterPanelTo,"allow-drag-last-column":t.allowDragLastColumn,onSetDragVisible:t.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","allow-drag-last-column","onSetDragVisible"])],6)],2)),[[S,t.handleHeaderFooterMousewheel]]):De("v-if",!0),ue("div",{ref:"bodyWrapper",class:K(t.ns.e("body-wrapper"))},[ge(b,{ref:"scrollBarRef","view-style":t.scrollbarViewStyle,"wrap-style":t.scrollbarStyle,always:t.scrollbarAlwaysOn,tabindex:t.scrollbarTabindex,onScroll:C=>t.$emit("scroll",C)},{default:Ce(()=>[ue("table",{ref:"tableBody",class:K(t.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:jt({width:t.bodyWidth,tableLayout:t.tableLayout})},[ge(h,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),t.showHeader&&t.tableLayout==="auto"?($(),Ve(v,{key:0,ref:"tableHeaderRef",class:K(t.ns.e("body-header")),border:t.border,"default-sort":t.defaultSort,store:t.store,"append-filter-panel-to":t.appendFilterPanelTo,onSetDragVisible:t.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):De("v-if",!0),ge(g,{context:t.context,highlight:t.highlightCurrentRow,"row-class-name":t.rowClassName,"tooltip-effect":t.tooltipEffect,"tooltip-options":t.tooltipOptions,"row-style":t.rowStyle,store:t.store,stripe:t.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),t.showSummary&&t.tableLayout==="auto"?($(),Ve(E,{key:1,class:K(t.ns.e("body-footer")),border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):De("v-if",!0)],6),t.isEmpty?($(),le("div",{key:0,ref:"emptyBlock",style:jt(t.emptyBlockStyle),class:K(t.ns.e("empty-block"))},[ue("span",{class:K(t.ns.e("empty-text"))},[Ne(t.$slots,"empty",{},()=>[bn(ot(t.computedEmptyText),1)])],2)],6)):De("v-if",!0),t.$slots.append?($(),le("div",{key:1,ref:"appendWrapper",class:K(t.ns.e("append-wrapper"))},[Ne(t.$slots,"append")],2)):De("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),t.showSummary&&t.tableLayout==="fixed"?ln(($(),le("div",{key:1,ref:"footerWrapper",class:K(t.ns.e("footer-wrapper"))},[ue("table",{class:K(t.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:jt(t.tableBodyStyles)},[ge(h,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),ge(E,{border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[Wn,!t.isEmpty],[S,t.handleHeaderFooterMousewheel]]):De("v-if",!0),t.border||t.isGroup?($(),le("div",{key:2,class:K(t.ns.e("border-left-patch"))},null,2)):De("v-if",!0)],2),ln(ue("div",{ref:"resizeProxy",class:K(t.ns.e("column-resize-proxy"))},null,2),[[Wn,t.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var uMe=dt(cMe,[["render",lMe],["__file","table.vue"]]);const dMe={selection:"table-column--selection",expand:"table__expand-column"},hMe={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},fMe=t=>dMe[t]||"",pMe={selection:{renderHeader({store:t,column:o}){function s(){return t.states.data.value&&t.states.data.value.length===0}return Ht(Wa,{disabled:s(),size:t.states.tableSize.value,indeterminate:t.states.selection.value.length>0&&!t.states.isAllSelected.value,"onUpdate:modelValue":t.toggleAllSelection,modelValue:t.states.isAllSelected.value,ariaLabel:o.label})},renderCell({row:t,column:o,store:s,$index:a}){return Ht(Wa,{disabled:o.selectable?!o.selectable.call(null,t,a):!1,size:s.states.tableSize.value,onChange:()=>{s.commit("rowSelectedChanged",t)},onClick:l=>l.stopPropagation(),modelValue:s.isSelected(t),ariaLabel:o.label})},sortable:!1,resizable:!1},index:{renderHeader({column:t}){return t.label||"#"},renderCell({column:t,$index:o}){let s=o+1;const a=t.index;return $t(a)?s=o+a:Ft(a)&&(s=a(o)),Ht("div",{},[s])},sortable:!1},expand:{renderHeader({column:t}){return t.label||""},renderCell({row:t,store:o,expanded:s}){const{ns:a}=o,l=[a.e("expand-icon")];return s&&l.push(a.em("expand-icon","expanded")),Ht("div",{class:l,onClick:function(h){h.stopPropagation(),o.toggleRowExpansion(t)}},{default:()=>[Ht(Dt,null,{default:()=>[Ht(vi)]})]})},sortable:!1,resizable:!1}};function mMe({row:t,column:o,$index:s}){var a;const l=o.property,d=l&&vg(t,l).value;return o&&o.formatter?o.formatter(t,o,d,s):((a=d==null?void 0:d.toString)==null?void 0:a.call(d))||""}function vMe({row:t,treeNode:o,store:s},a=!1){const{ns:l}=s;if(!o)return a?[Ht("span",{class:l.e("placeholder")})]:null;const d=[],h=function(v){v.stopPropagation(),!o.loading&&s.loadOrToggle(t)};if(o.indent&&d.push(Ht("span",{class:l.e("indent"),style:{"padding-left":`${o.indent}px`}})),wr(o.expanded)&&!o.noLazyChildren){const v=[l.e("expand-icon"),o.expanded?l.em("expand-icon","expanded"):""];let g=vi;o.loading&&(g=hl),d.push(Ht("div",{class:v,onClick:h},{default:()=>[Ht(Dt,{class:{[l.is("loading")]:o.loading}},{default:()=>[Ht(g)]})]}))}else d.push(Ht("span",{class:l.e("placeholder")}));return d}function XH(t,o){return t.reduce((s,a)=>(s[a]=a,s),o)}function gMe(t,o){const s=mn();return{registerComplexWatchers:()=>{const d=["fixed"],h={realWidth:"width",realMinWidth:"minWidth"},v=XH(d,h);Object.keys(v).forEach(g=>{const E=h[g];zn(o,E)&&ze(()=>o[E],b=>{let S=b;E==="width"&&g==="realWidth"&&(S=Vk(b)),E==="minWidth"&&g==="realMinWidth"&&(S=Gz(b)),s.columnConfig.value[E]=S,s.columnConfig.value[g]=S;const C=E==="fixed";t.value.store.scheduleLayout(C)})})},registerNormalWatchers:()=>{const d=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip","tooltipFormatter"],h={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},v=XH(d,h);Object.keys(v).forEach(g=>{const E=h[g];zn(o,E)&&ze(()=>o[E],b=>{s.columnConfig.value[g]=b})})}}}function _Me(t,o,s){const a=mn(),l=ee(""),d=ee(!1),h=ee(),v=ee(),g=Qe("table");Ms(()=>{h.value=t.align?`is-${t.align}`:null,h.value}),Ms(()=>{v.value=t.headerAlign?`is-${t.headerAlign}`:h.value,v.value});const E=U(()=>{let D=a.vnode.vParent||a.parent;for(;D&&!D.tableId&&!D.columnId;)D=D.vnode.vParent||D.parent;return D}),b=U(()=>{const{store:D}=a.parent;if(!D)return!1;const{treeData:M}=D.states,F=M.value;return F&&Object.keys(F).length>0}),S=ee(Vk(t.width)),C=ee(Gz(t.minWidth)),w=D=>(S.value&&(D.width=S.value),C.value&&(D.minWidth=C.value),!S.value&&C.value&&(D.width=void 0),D.minWidth||(D.minWidth=80),D.realWidth=Number(Xn(D.width)?D.minWidth:D.width),D),I=D=>{const M=D.type,F=pMe[M]||{};Object.keys(F).forEach(z=>{const G=F[z];z!=="className"&&!Xn(G)&&(D[z]=G)});const W=fMe(M);if(W){const z=`${p(g.namespace)}-${W}`;D.className=D.className?`${D.className} ${z}`:z}return D},R=D=>{st(D)?D.forEach(F=>M(F)):M(D);function M(F){var W;((W=F==null?void 0:F.type)==null?void 0:W.name)==="ElTableColumn"&&(F.vParent=a)}};return{columnId:l,realAlign:h,isSubColumn:d,realHeaderAlign:v,columnOrTableParent:E,setColumnWidth:w,setColumnForcedProps:I,setColumnRenders:D=>{t.renderHeader||D.type!=="selection"&&(D.renderHeader=F=>(a.columnConfig.value.label,Ne(o,"header",F,()=>[D.label]))),o["filter-icon"]&&(D.renderFilterIcon=F=>Ne(o,"filter-icon",F));let M=D.renderCell;return D.type==="expand"?(D.renderCell=F=>Ht("div",{class:"cell"},[M(F)]),s.value.renderExpanded=F=>o.default?o.default(F):o.default):(M=M||mMe,D.renderCell=F=>{let W=null;if(o.default){const fe=o.default(F);W=fe.some(Ee=>Ee.type!==is)?fe:M(F)}else W=M(F);const{columns:z}=s.value.store.states,G=z.value.findIndex(fe=>fe.type==="default"),Y=b.value&&F.cellIndex===G,te=vMe(F,Y),Z={class:"cell",style:{}};return D.showOverflowTooltip&&(Z.class=`${Z.class} ${p(g.namespace)}-tooltip`,Z.style={width:`${(F.column.realWidth||Number(F.column.width))-1}px`}),R(W),Ht("div",Z,[te,W])}),D},getPropsData:(...D)=>D.reduce((M,F)=>(st(F)&&F.forEach(W=>{M[W]=t[W]}),M),{}),getColumnElIndex:(D,M)=>Array.prototype.indexOf.call(D,M),updateColumnOrder:()=>{s.value.store.commit("updateColumnOrder",a.columnConfig.value)}}}var EMe={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},tooltipFormatter:Function,fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:t=>t.every(o=>["ascending","descending",null].includes(o))}};let yMe=1;var aY=me({name:"ElTableColumn",components:{ElCheckbox:Wa},props:EMe,setup(t,{slots:o}){const s=mn(),a=ee({}),l=U(()=>{let L=s.parent;for(;L&&!L.tableId;)L=L.parent;return L}),{registerNormalWatchers:d,registerComplexWatchers:h}=gMe(l,t),{columnId:v,isSubColumn:g,realHeaderAlign:E,columnOrTableParent:b,setColumnWidth:S,setColumnForcedProps:C,setColumnRenders:w,getPropsData:I,getColumnElIndex:R,realAlign:N,updateColumnOrder:O}=_Me(t,o,l),V=b.value;v.value=`${V.tableId||V.columnId}_column_${yMe++}`,e0(()=>{g.value=l.value!==V;const L=t.type||"default",D=t.sortable===""?!0:t.sortable,M=L==="selection"?!1:Xn(t.showOverflowTooltip)?V.props.showOverflowTooltip:t.showOverflowTooltip,F=Xn(t.tooltipFormatter)?V.props.tooltipFormatter:t.tooltipFormatter,W={...hMe[L],id:v.value,type:L,property:t.prop||t.property,align:N,headerAlign:E,showOverflowTooltip:M,tooltipFormatter:F,filterable:t.filters||t.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:D,index:t.index,rawColumnKey:s.vnode.key};let Z=I(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);Z=pLe(W,Z),Z=vLe(w,S,C)(Z),a.value=Z,d(),h()}),dn(()=>{var L;const D=b.value,M=g.value?D.vnode.el.children:(L=D.refs.hiddenColumns)==null?void 0:L.children,F=()=>R(M||[],s.vnode.el);a.value.getColumnIndex=F,F()>-1&&l.value.store.commit("insertColumn",a.value,g.value?D.columnConfig.value:null,O)}),Rr(()=>{const L=a.value.getColumnIndex;(L?L():-1)>-1&&l.value.store.commit("removeColumn",a.value,g.value?V.columnConfig.value:null,O)}),s.columnId=v.value,s.columnConfig=a},render(){var t,o,s;try{const a=(o=(t=this.$slots).default)==null?void 0:o.call(t,{row:{},column:{},$index:-1}),l=[];if(st(a))for(const h of a)((s=h.type)==null?void 0:s.name)==="ElTableColumn"||h.shapeFlag&2?l.push(h):h.type===Ut&&st(h.children)&&h.children.forEach(v=>{(v==null?void 0:v.patchFlag)!==1024&&!Mt(v==null?void 0:v.children)&&l.push(v)});return Ht("div",l)}catch{return Ht("div",[])}}});const bMe=rn(uMe,{TableColumn:aY}),SMe=uo(aY);var zg=(t=>(t.ASC="asc",t.DESC="desc",t))(zg||{}),Yg=(t=>(t.CENTER="center",t.RIGHT="right",t))(Yg||{}),cY=(t=>(t.LEFT="left",t.RIGHT="right",t))(cY||{});const MO={asc:"desc",desc:"asc"},qg=Symbol("placeholder"),TMe=(t,o,s)=>{var a;const l={flexGrow:0,flexShrink:0,...s?{}:{flexGrow:t.flexGrow||0,flexShrink:t.flexShrink||1}};s||(l.flexShrink=1);const d={...(a=t.style)!=null?a:{},...l,flexBasis:"auto",width:t.width};return o||(t.maxWidth&&(d.maxWidth=t.maxWidth),t.minWidth&&(d.minWidth=t.minWidth)),d};function CMe(t,o,s){const a=U(()=>p(o).map((N,O)=>{var V,L;return{...N,key:(L=(V=N.key)!=null?V:N.dataKey)!=null?L:O}})),l=U(()=>p(a).filter(N=>!N.hidden)),d=U(()=>p(l).filter(N=>N.fixed==="left"||N.fixed===!0)),h=U(()=>p(l).filter(N=>N.fixed==="right")),v=U(()=>p(l).filter(N=>!N.fixed)),g=U(()=>{const N=[];return p(d).forEach(O=>{N.push({...O,placeholderSign:qg})}),p(v).forEach(O=>{N.push(O)}),p(h).forEach(O=>{N.push({...O,placeholderSign:qg})}),N}),E=U(()=>p(d).length||p(h).length),b=U(()=>p(a).reduce((N,O)=>(N[O.key]=TMe(O,p(s),t.fixed),N),{})),S=U(()=>p(l).reduce((N,O)=>N+O.width,0)),C=N=>p(a).find(O=>O.key===N),w=N=>p(b)[N],I=(N,O)=>{N.width=O};function R(N){var O;const{key:V}=N.currentTarget.dataset;if(!V)return;const{sortState:L,sortBy:D}=t;let M=zg.ASC;fn(L)?M=MO[L[V]]:M=MO[D.order],(O=t.onColumnSort)==null||O.call(t,{column:C(V),key:V,order:M})}return{columns:a,columnsStyles:b,columnsTotalWidth:S,fixedColumnsOnLeft:d,fixedColumnsOnRight:h,hasFixedColumns:E,mainColumns:g,normalColumns:v,visibleColumns:l,getColumn:C,getColumnStyle:w,updateColumnWidth:I,onColumnSorted:R}}const wMe=(t,{mainTableRef:o,leftTableRef:s,rightTableRef:a,onMaybeEndReached:l})=>{const d=ee({scrollLeft:0,scrollTop:0});function h(w){var I,R,N;const{scrollTop:O}=w;(I=o.value)==null||I.scrollTo(w),(R=s.value)==null||R.scrollToTop(O),(N=a.value)==null||N.scrollToTop(O)}function v(w){d.value=w,h(w)}function g(w){d.value.scrollTop=w,h(p(d))}function E(w){var I,R;d.value.scrollLeft=w,(R=(I=o.value)==null?void 0:I.scrollTo)==null||R.call(I,p(d))}function b(w){var I;v(w),(I=t.onScroll)==null||I.call(t,w)}function S({scrollTop:w}){const{scrollTop:I}=p(d);w!==I&&g(w)}function C(w,I="auto"){var R;(R=o.value)==null||R.scrollToRow(w,I)}return ze(()=>p(d).scrollTop,(w,I)=>{w>I&&l()}),{scrollPos:d,scrollTo:v,scrollToLeft:E,scrollToTop:g,scrollToRow:C,onScroll:b,onVerticalScroll:S}},RMe=(t,{mainTableRef:o,leftTableRef:s,rightTableRef:a,tableInstance:l,ns:d,isScrolling:h})=>{const v=mn(),{emit:g}=v,E=Mr(!1),b=ee(t.defaultExpandedRowKeys||[]),S=ee(-1),C=Mr(null),w=ee({}),I=ee({}),R=Mr({}),N=Mr({}),O=Mr({}),V=U(()=>$t(t.estimatedRowHeight));function L(Y){var te;(te=t.onRowsRendered)==null||te.call(t,Y),Y.rowCacheEnd>p(S)&&(S.value=Y.rowCacheEnd)}function D({hovered:Y,rowKey:te}){if(h.value)return;l.vnode.el.querySelectorAll(`[rowkey="${String(te)}"]`).forEach(Ee=>{Y?Ee.classList.add(d.is("hovered")):Ee.classList.remove(d.is("hovered"))})}function M({expanded:Y,rowData:te,rowIndex:Z,rowKey:fe}){var Ee,ae;const X=[...p(b)],ie=X.indexOf(fe);Y?ie===-1&&X.push(fe):ie>-1&&X.splice(ie,1),b.value=X,g("update:expandedRowKeys",X),(Ee=t.onRowExpand)==null||Ee.call(t,{expanded:Y,rowData:te,rowIndex:Z,rowKey:fe}),(ae=t.onExpandedRowsChange)==null||ae.call(t,X)}const F=Hi(()=>{var Y,te,Z,fe;E.value=!0,w.value={...p(w),...p(I)},W(p(C),!1),I.value={},C.value=null,(Y=o.value)==null||Y.forceUpdate(),(te=s.value)==null||te.forceUpdate(),(Z=a.value)==null||Z.forceUpdate(),(fe=v.proxy)==null||fe.$forceUpdate(),E.value=!1},0);function W(Y,te=!1){p(V)&&[o,s,a].forEach(Z=>{const fe=p(Z);fe&&fe.resetAfterRowIndex(Y,te)})}function z(Y,te,Z){const fe=p(C);(fe===null||fe>Z)&&(C.value=Z),I.value[Y]=te}function G({rowKey:Y,height:te,rowIndex:Z},fe){fe?fe===cY.RIGHT?O.value[Y]=te:R.value[Y]=te:N.value[Y]=te;const Ee=Math.max(...[R,O,N].map(ae=>ae.value[Y]||0));p(w)[Y]!==Ee&&(z(Y,Ee,Z),F())}return{expandedRowKeys:b,lastRenderedRowIndex:S,isDynamic:V,isResetting:E,rowHeights:w,resetAfterIndex:W,onRowExpanded:M,onRowHovered:D,onRowsRendered:L,onRowHeightChange:G}},IMe=(t,{expandedRowKeys:o,lastRenderedRowIndex:s,resetAfterIndex:a})=>{const l=ee({}),d=U(()=>{const v={},{data:g,rowKey:E}=t,b=p(o);if(!b||!b.length)return g;const S=[],C=new Set;b.forEach(I=>C.add(I));let w=g.slice();for(w.forEach(I=>v[I[E]]=0);w.length>0;){const I=w.shift();S.push(I),C.has(I[E])&&st(I.children)&&I.children.length>0&&(w=[...I.children,...w],I.children.forEach(R=>v[R[E]]=v[I[E]]+1))}return l.value=v,S}),h=U(()=>{const{data:v,expandColumnKey:g}=t;return g?p(d):v});return ze(h,(v,g)=>{v!==g&&(s.value=-1,a(0,!0))}),{data:h,depthMap:l}},AMe=(t,o)=>t+o,Qb=t=>st(t)?t.reduce(AMe,0):t,Vh=(t,o,s={})=>Ft(t)?t(o):t??s,nd=t=>(["width","maxWidth","minWidth","height"].forEach(o=>{t[o]=mo(t[o])}),t),lY=t=>Kr(t)?o=>Ht(t,o):t,OMe=(t,{columnsTotalWidth:o,rowsHeight:s,fixedColumnsOnLeft:a,fixedColumnsOnRight:l})=>{const d=U(()=>{const{fixed:V,width:L,vScrollbarSize:D}=t,M=L-D;return V?Math.max(Math.round(p(o)),M):M}),h=U(()=>p(d)+t.vScrollbarSize),v=U(()=>{const{height:V=0,maxHeight:L=0,footerHeight:D,hScrollbarSize:M}=t;if(L>0){const F=p(w),W=p(s),G=p(C)+F+W+M;return Math.min(G,L-D)}return V-D}),g=U(()=>{const{maxHeight:V}=t,L=p(v);if($t(V)&&V>0)return L;const D=p(s)+p(C)+p(w);return Math.min(L,D)}),E=V=>V.width,b=U(()=>Qb(p(a).map(E))),S=U(()=>Qb(p(l).map(E))),C=U(()=>Qb(t.headerHeight)),w=U(()=>{var V;return(((V=t.fixedData)==null?void 0:V.length)||0)*t.rowHeight}),I=U(()=>p(v)-p(C)-p(w)),R=U(()=>{const{style:V={},height:L,width:D}=t;return nd({...V,height:L,width:D})}),N=U(()=>nd({height:t.footerHeight})),O=U(()=>({top:mo(p(C)),bottom:mo(t.footerHeight),width:mo(t.width)}));return{bodyWidth:d,fixedTableHeight:g,mainTableHeight:v,leftTableWidth:b,rightTableWidth:S,headerWidth:h,windowHeight:I,footerHeight:N,emptyStyle:O,rootStyle:R,headerHeight:C}};function NMe(t){const o=ee(),s=ee(),a=ee(),{columns:l,columnsStyles:d,columnsTotalWidth:h,fixedColumnsOnLeft:v,fixedColumnsOnRight:g,hasFixedColumns:E,mainColumns:b,onColumnSorted:S}=CMe(t,lr(t,"columns"),lr(t,"fixed")),{scrollTo:C,scrollToLeft:w,scrollToTop:I,scrollToRow:R,onScroll:N,onVerticalScroll:O,scrollPos:V}=wMe(t,{mainTableRef:o,leftTableRef:s,rightTableRef:a,onMaybeEndReached:Se}),L=Qe("table-v2"),D=mn(),M=Mr(!1),{expandedRowKeys:F,lastRenderedRowIndex:W,isDynamic:z,isResetting:G,rowHeights:Y,resetAfterIndex:te,onRowExpanded:Z,onRowHeightChange:fe,onRowHovered:Ee,onRowsRendered:ae}=RMe(t,{mainTableRef:o,leftTableRef:s,rightTableRef:a,tableInstance:D,ns:L,isScrolling:M}),{data:X,depthMap:ie}=IMe(t,{expandedRowKeys:F,lastRenderedRowIndex:W,resetAfterIndex:te}),se=U(()=>{const{estimatedRowHeight:je,rowHeight:tt}=t,et=p(X);return $t(je)?Object.values(p(Y)).reduce((Ge,Xe)=>Ge+Xe,0):et.length*tt}),{bodyWidth:J,fixedTableHeight:pe,mainTableHeight:be,leftTableWidth:Ae,rightTableWidth:_e,headerWidth:Me,windowHeight:Fe,footerHeight:Le,emptyStyle:Pe,rootStyle:He,headerHeight:We}=OMe(t,{columnsTotalWidth:h,fixedColumnsOnLeft:v,fixedColumnsOnRight:g,rowsHeight:se}),yt=ee(),it=U(()=>{const je=p(X).length===0;return st(t.fixedData)?t.fixedData.length===0&&je:je});function ce(je){const{estimatedRowHeight:tt,rowHeight:et,rowKey:Ge}=t;return tt?p(Y)[p(X)[je][Ge]]||tt:et}function Se(){const{onEndReached:je}=t;if(!je)return;const{scrollTop:tt}=p(V),et=p(se),Ge=p(Fe),Xe=et-(tt+Ge)+t.hScrollbarSize;p(W)>=0&&et===tt+p(be)-p(We)&&je(Xe)}return ze(()=>t.expandedRowKeys,je=>F.value=je,{deep:!0}),{columns:l,containerRef:yt,mainTableRef:o,leftTableRef:s,rightTableRef:a,isDynamic:z,isResetting:G,isScrolling:M,hasFixedColumns:E,columnsStyles:d,columnsTotalWidth:h,data:X,expandedRowKeys:F,depthMap:ie,fixedColumnsOnLeft:v,fixedColumnsOnRight:g,mainColumns:b,bodyWidth:J,emptyStyle:Pe,rootStyle:He,headerWidth:Me,footerHeight:Le,mainTableHeight:be,fixedTableHeight:pe,leftTableWidth:Ae,rightTableWidth:_e,showEmpty:it,getRowHeight:ce,onColumnSorted:S,onRowHovered:Ee,onRowExpanded:Z,onRowsRendered:ae,onRowHeightChange:fe,scrollTo:C,scrollToLeft:w,scrollToTop:I,scrollToRow:R,onScroll:N,onVerticalScroll:O}}const $k=Symbol("tableV2"),uY=String,m_={type:Re(Array),required:!0},Hk={type:Re(Array)},dY={...Hk,required:!0},kMe=String,JH={type:Re(Array),default:()=>lo([])},Eh={type:Number,required:!0},hY={type:Re([String,Number,Symbol]),default:"id"},ZH={type:Re(Object)},Th=ut({class:String,columns:m_,columnsStyles:{type:Re(Object),required:!0},depth:Number,expandColumnKey:kMe,estimatedRowHeight:{...Oh.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:Re(Function)},onRowHover:{type:Re(Function)},onRowHeightChange:{type:Re(Function)},rowData:{type:Re(Object),required:!0},rowEventHandlers:{type:Re(Object)},rowIndex:{type:Number,required:!0},rowKey:hY,style:{type:Re(Object)}}),EA={type:Number,required:!0},Wk=ut({class:String,columns:m_,fixedHeaderData:{type:Re(Array)},headerData:{type:Re(Array),required:!0},headerHeight:{type:Re([Number,Array]),default:50},rowWidth:EA,rowHeight:{type:Number,default:50},height:EA,width:EA}),eS=ut({columns:m_,data:dY,fixedData:Hk,estimatedRowHeight:Th.estimatedRowHeight,width:Eh,height:Eh,headerWidth:Eh,headerHeight:Wk.headerHeight,bodyWidth:Eh,rowHeight:Eh,cache:Dz.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:Oh.scrollbarAlwaysOn,scrollbarStartGap:Oh.scrollbarStartGap,scrollbarEndGap:Oh.scrollbarEndGap,class:uY,style:ZH,containerStyle:ZH,getRowHeight:{type:Re(Function),required:!0},rowKey:Th.rowKey,onRowsRendered:{type:Re(Function)},onScroll:{type:Re(Function)}}),PMe=ut({cache:eS.cache,estimatedRowHeight:Th.estimatedRowHeight,rowKey:hY,headerClass:{type:Re([String,Function])},headerProps:{type:Re([Object,Function])},headerCellProps:{type:Re([Object,Function])},headerHeight:Wk.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:Re([String,Function])},rowProps:{type:Re([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:Re([Object,Function])},columns:m_,data:dY,dataGetter:{type:Re(Function)},fixedData:Hk,expandColumnKey:Th.expandColumnKey,expandedRowKeys:JH,defaultExpandedRowKeys:JH,class:uY,fixed:Boolean,style:{type:Re(Object)},width:Eh,height:Eh,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:Oh.hScrollbarSize,vScrollbarSize:Oh.vScrollbarSize,scrollbarAlwaysOn:xz.alwaysOn,sortBy:{type:Re(Object),default:()=>({})},sortState:{type:Re(Object),default:void 0},onColumnSort:{type:Re(Function)},onExpandedRowsChange:{type:Re(Function)},onEndReached:{type:Re(Function)},onRowExpand:Th.onRowExpand,onScroll:eS.onScroll,onRowsRendered:eS.onRowsRendered,rowEventHandlers:Th.rowEventHandlers}),DMe="ElTableV2Header",LMe=me({name:DMe,props:Wk,setup(t,{slots:o,expose:s}){const a=Qe("table-v2"),l=It("tableV2GridScrollLeft"),d=ee(),h=U(()=>nd({width:t.width,height:t.height})),v=U(()=>nd({width:t.rowWidth,height:t.height})),g=U(()=>Js(p(t.headerHeight))),E=C=>{const w=p(d);Vt(()=>{w!=null&&w.scroll&&w.scroll({left:C})})},b=()=>{const C=a.e("fixed-header-row"),{columns:w,fixedHeaderData:I,rowHeight:R}=t;return I==null?void 0:I.map((N,O)=>{var V;const L=nd({height:R,width:"100%"});return(V=o.fixed)==null?void 0:V.call(o,{class:C,columns:w,rowData:N,rowIndex:-(O+1),style:L})})},S=()=>{const C=a.e("dynamic-header-row"),{columns:w}=t;return p(g).map((I,R)=>{var N;const O=nd({width:"100%",height:I});return(N=o.dynamic)==null?void 0:N.call(o,{class:C,columns:w,headerIndex:R,style:O})})};return wc(()=>{l!=null&&l.value&&E(l.value)}),s({scrollToLeft:E}),()=>{if(!(t.height<=0))return ge("div",{ref:d,class:t.class,style:p(h),role:"rowgroup"},[ge("div",{style:p(v),class:a.e("header")},[S(),b()])])}}});var MMe=LMe;const xMe=({atXEndEdge:t,atXStartEdge:o,atYEndEdge:s,atYStartEdge:a},l)=>{let d=null,h=0,v=0;const g=(b,S)=>{const C=b<=0&&o.value||b>=0&&t.value,w=S<=0&&a.value||S>=0&&s.value;return C&&w};return{hasReachedEdge:g,onWheel:b=>{xh(d);let S=b.deltaX,C=b.deltaY;Math.abs(S)>Math.abs(C)?C=0:S=0,b.shiftKey&&C!==0&&(S=C,C=0),!(g(h,v)&&g(h+S,v+C))&&(h+=S,v+=C,b.preventDefault(),d=ld(()=>{l(h,v),h=0,v=0}))}}},fY=({name:t,clearCache:o,getColumnPosition:s,getColumnStartIndexForOffset:a,getColumnStopIndexForStartIndex:l,getEstimatedTotalHeight:d,getEstimatedTotalWidth:h,getColumnOffset:v,getRowOffset:g,getRowPosition:E,getRowStartIndexForOffset:b,getRowStopIndexForStartIndex:S,initCache:C,injectToInstance:w,validateProps:I})=>me({name:t??"ElVirtualList",props:Oh,emits:[NS,kS],setup(R,{emit:N,expose:O,slots:V}){const L=Qe("vl");I(R);const D=mn(),M=ee(C(R,D));w==null||w(D,M);const F=ee(),W=ee(),z=ee(),G=ee(null),Y=ee({isScrolling:!1,scrollLeft:$t(R.initScrollLeft)?R.initScrollLeft:0,scrollTop:$t(R.initScrollTop)?R.initScrollTop:0,updateRequested:!1,xAxisScrollDir:Rp,yAxisScrollDir:Rp}),te=Nz(),Z=U(()=>Number.parseInt(`${R.height}`,10)),fe=U(()=>Number.parseInt(`${R.width}`,10)),Ee=U(()=>{const{totalColumn:Ge,totalRow:Xe,columnCache:Ye}=R,{isScrolling:ct,xAxisScrollDir:nt,scrollLeft:Ot}=p(Y);if(Ge===0||Xe===0)return[0,0,0,0];const _t=a(R,Ot,p(M)),qe=l(R,_t,Ot,p(M)),wt=!ct||nt===PS?Math.max(1,Ye):1,qt=!ct||nt===Rp?Math.max(1,Ye):1;return[Math.max(0,_t-wt),Math.max(0,Math.min(Ge-1,qe+qt)),_t,qe]}),ae=U(()=>{const{totalColumn:Ge,totalRow:Xe,rowCache:Ye}=R,{isScrolling:ct,yAxisScrollDir:nt,scrollTop:Ot}=p(Y);if(Ge===0||Xe===0)return[0,0,0,0];const _t=b(R,Ot,p(M)),qe=S(R,_t,Ot,p(M)),wt=!ct||nt===PS?Math.max(1,Ye):1,qt=!ct||nt===Rp?Math.max(1,Ye):1;return[Math.max(0,_t-wt),Math.max(0,Math.min(Xe-1,qe+qt)),_t,qe]}),X=U(()=>d(R,p(M))),ie=U(()=>h(R,p(M))),se=U(()=>{var Ge;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:R.direction,height:$t(R.height)?`${R.height}px`:R.height,width:$t(R.width)?`${R.width}px`:R.width},(Ge=R.style)!=null?Ge:{}]}),J=U(()=>{const Ge=`${p(ie)}px`;return{height:`${p(X)}px`,pointerEvents:p(Y).isScrolling?"none":void 0,width:Ge}}),pe=()=>{const{totalColumn:Ge,totalRow:Xe}=R;if(Ge>0&&Xe>0){const[qe,wt,qt,sn]=p(Ee),[tn,Kn,Sn,zr]=p(ae);N(NS,{columnCacheStart:qe,columnCacheEnd:wt,rowCacheStart:tn,rowCacheEnd:Kn,columnVisibleStart:qt,columnVisibleEnd:sn,rowVisibleStart:Sn,rowVisibleEnd:zr})}const{scrollLeft:Ye,scrollTop:ct,updateRequested:nt,xAxisScrollDir:Ot,yAxisScrollDir:_t}=p(Y);N(kS,{xAxisScrollDir:Ot,scrollLeft:Ye,yAxisScrollDir:_t,scrollTop:ct,updateRequested:nt})},be=Ge=>{const{clientHeight:Xe,clientWidth:Ye,scrollHeight:ct,scrollLeft:nt,scrollTop:Ot,scrollWidth:_t}=Ge.currentTarget,qe=p(Y);if(qe.scrollTop===Ot&&qe.scrollLeft===nt)return;let wt=nt;if(xH(R.direction))switch(LS()){case Kg:wt=-nt;break;case Uk:wt=_t-Ye-nt;break}Y.value={...qe,isScrolling:!0,scrollLeft:wt,scrollTop:Math.max(0,Math.min(Ot,ct-Xe)),updateRequested:!0,xAxisScrollDir:Sh(qe.scrollLeft,wt),yAxisScrollDir:Sh(qe.scrollTop,Ot)},Vt(()=>He()),We(),pe()},Ae=(Ge,Xe)=>{const Ye=p(Z),ct=(X.value-Ye)/Xe*Ge;Fe({scrollTop:Math.min(X.value-Ye,ct)})},_e=(Ge,Xe)=>{const Ye=p(fe),ct=(ie.value-Ye)/Xe*Ge;Fe({scrollLeft:Math.min(ie.value-Ye,ct)})},{onWheel:Me}=xMe({atXStartEdge:U(()=>Y.value.scrollLeft<=0),atXEndEdge:U(()=>Y.value.scrollLeft>=ie.value-p(fe)),atYStartEdge:U(()=>Y.value.scrollTop<=0),atYEndEdge:U(()=>Y.value.scrollTop>=X.value-p(Z))},(Ge,Xe)=>{var Ye,ct,nt,Ot;(ct=(Ye=W.value)==null?void 0:Ye.onMouseUp)==null||ct.call(Ye),(Ot=(nt=z.value)==null?void 0:nt.onMouseUp)==null||Ot.call(nt);const _t=p(fe),qe=p(Z);Fe({scrollLeft:Math.min(Y.value.scrollLeft+Ge,ie.value-_t),scrollTop:Math.min(Y.value.scrollTop+Xe,X.value-qe)})});gr(F,"wheel",Me,{passive:!1});const Fe=({scrollLeft:Ge=Y.value.scrollLeft,scrollTop:Xe=Y.value.scrollTop})=>{Ge=Math.max(Ge,0),Xe=Math.max(Xe,0);const Ye=p(Y);Xe===Ye.scrollTop&&Ge===Ye.scrollLeft||(Y.value={...Ye,xAxisScrollDir:Sh(Ye.scrollLeft,Ge),yAxisScrollDir:Sh(Ye.scrollTop,Xe),scrollLeft:Ge,scrollTop:Xe,updateRequested:!0},Vt(()=>He()),We(),pe())},Le=(Ge=0,Xe=0,Ye=Va)=>{const ct=p(Y);Xe=Math.max(0,Math.min(Xe,R.totalColumn-1)),Ge=Math.max(0,Math.min(Ge,R.totalRow-1));const nt=pK(L.namespace.value),Ot=p(M),_t=d(R,Ot),qe=h(R,Ot);Fe({scrollLeft:v(R,Xe,Ye,ct.scrollLeft,Ot,qe>R.width?nt:0),scrollTop:g(R,Ge,Ye,ct.scrollTop,Ot,_t>R.height?nt:0)})},Pe=(Ge,Xe)=>{const{columnWidth:Ye,direction:ct,rowHeight:nt}=R,Ot=te.value(o&&Ye,o&&nt,o&&ct),_t=`${Ge},${Xe}`;if(zn(Ot,_t))return Ot[_t];{const[,qe]=s(R,Xe,p(M)),wt=p(M),qt=xH(ct),[sn,tn]=E(R,Ge,wt),[Kn]=s(R,Xe,wt);return Ot[_t]={position:"absolute",left:qt?void 0:`${qe}px`,right:qt?`${qe}px`:void 0,top:`${tn}px`,height:`${sn}px`,width:`${Kn}px`},Ot[_t]}},He=()=>{Y.value.isScrolling=!1,Vt(()=>{te.value(-1,null,null)})};dn(()=>{if(!Vn)return;const{initScrollLeft:Ge,initScrollTop:Xe}=R,Ye=p(F);Ye&&($t(Ge)&&(Ye.scrollLeft=Ge),$t(Xe)&&(Ye.scrollTop=Xe)),pe()});const We=()=>{const{direction:Ge}=R,{scrollLeft:Xe,scrollTop:Ye,updateRequested:ct}=p(Y),nt=p(F);if(ct&&nt){if(Ge===Up)switch(LS()){case Kg:{nt.scrollLeft=-Xe;break}case xk:{nt.scrollLeft=Xe;break}default:{const{clientWidth:Ot,scrollWidth:_t}=nt;nt.scrollLeft=_t-Ot-Xe;break}}else nt.scrollLeft=Math.max(0,Xe);nt.scrollTop=Math.max(0,Ye)}},{resetAfterColumnIndex:yt,resetAfterRowIndex:it,resetAfter:ce}=D.proxy;O({windowRef:F,innerRef:G,getItemStyleCache:te,scrollTo:Fe,scrollToItem:Le,states:Y,resetAfterColumnIndex:yt,resetAfterRowIndex:it,resetAfter:ce});const Se=()=>{const{scrollbarAlwaysOn:Ge,scrollbarStartGap:Xe,scrollbarEndGap:Ye,totalColumn:ct,totalRow:nt}=R,Ot=p(fe),_t=p(Z),qe=p(ie),wt=p(X),{scrollLeft:qt,scrollTop:sn}=p(Y),tn=Ht(CO,{ref:W,alwaysOn:Ge,startGap:Xe,endGap:Ye,class:L.e("horizontal"),clientSize:Ot,layout:"horizontal",onScroll:_e,ratio:Ot*100/qe,scrollFrom:qt/(qe-Ot),total:nt,visible:!0}),Kn=Ht(CO,{ref:z,alwaysOn:Ge,startGap:Xe,endGap:Ye,class:L.e("vertical"),clientSize:_t,layout:"vertical",onScroll:Ae,ratio:_t*100/wt,scrollFrom:sn/(wt-_t),total:ct,visible:!0});return{horizontalScrollbar:tn,verticalScrollbar:Kn}},je=()=>{var Ge;const[Xe,Ye]=p(Ee),[ct,nt]=p(ae),{data:Ot,totalColumn:_t,totalRow:qe,useIsScrolling:wt,itemKey:qt}=R,sn=[];if(qe>0&&_t>0)for(let tn=ct;tn<=nt;tn++)for(let Kn=Xe;Kn<=Ye;Kn++){const Sn=qt({columnIndex:Kn,data:Ot,rowIndex:tn});sn.push(Ht(Ut,{key:Sn},(Ge=V.default)==null?void 0:Ge.call(V,{columnIndex:Kn,data:Ot,isScrolling:wt?p(Y).isScrolling:void 0,style:Pe(tn,Kn),rowIndex:tn})))}return sn},tt=()=>{const Ge=gn(R.innerElement),Xe=je();return[Ht(Ge,{style:p(J),ref:G},Mt(Ge)?Xe:{default:()=>Xe})]};return()=>{const Ge=gn(R.containerElement),{horizontalScrollbar:Xe,verticalScrollbar:Ye}=Se(),ct=tt();return Ht("div",{key:0,class:L.e("wrapper"),role:R.role},[Ht(Ge,{class:R.className,style:p(se),onScroll:be,ref:F},Mt(Ge)?ct:{default:()=>ct}),Xe,Ye])}}}),{max:US,min:pY,floor:mY}=Math,UMe={column:"columnWidth",row:"rowHeight"},xO={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Gl=(t,o,s,a)=>{const[l,d,h]=[s[a],t[UMe[a]],s[xO[a]]];if(o>h){let v=0;if(h>=0){const g=l[h];v=g.offset+g.size}for(let g=h+1;g<=o;g++){const E=d(g);l[g]={offset:v,size:E},v+=E}s[xO[a]]=o}return l[o]},vY=(t,o,s,a,l,d)=>{for(;s<=a;){const h=s+mY((a-s)/2),v=Gl(t,h,o,d).offset;if(v===l)return h;v<l?s=h+1:a=h-1}return US(0,s-1)},VMe=(t,o,s,a,l)=>{const d=l==="column"?t.totalColumn:t.totalRow;let h=1;for(;s<d&&Gl(t,s,o,l).offset<a;)s+=h,h*=2;return vY(t,o,mY(s/2),pY(s,d-1),a,l)},QH=(t,o,s,a)=>{const[l,d]=[o[a],o[xO[a]]];return(d>0?l[d].offset:0)>=s?vY(t,o,0,d,s,a):VMe(t,o,US(0,d),s,a)},gY=({totalRow:t},{estimatedRowHeight:o,lastVisitedRowIndex:s,row:a})=>{let l=0;if(s>=t&&(s=t-1),s>=0){const v=a[s];l=v.offset+v.size}const h=(t-s-1)*o;return l+h},_Y=({totalColumn:t},{column:o,estimatedColumnWidth:s,lastVisitedColumnIndex:a})=>{let l=0;if(a>t&&(a=t-1),a>=0){const v=o[a];l=v.offset+v.size}const h=(t-a-1)*s;return l+h},FMe={column:_Y,row:gY},e8=(t,o,s,a,l,d,h)=>{const[v,g]=[d==="row"?t.height:t.width,FMe[d]],E=Gl(t,o,l,d),b=g(t,l),S=US(0,pY(b-v,E.offset)),C=US(0,E.offset-v+h+E.size);switch(s===I0&&(a>=C-v&&a<=S+v?s=Va:s=al),s){case Hg:return S;case Wg:return C;case al:return Math.round(C+(S-C)/2);case Va:default:return a>=C&&a<=S?a:C>S||a<C?C:S}},BMe=fY({name:"ElDynamicSizeGrid",getColumnPosition:(t,o,s)=>{const a=Gl(t,o,s,"column");return[a.size,a.offset]},getRowPosition:(t,o,s)=>{const a=Gl(t,o,s,"row");return[a.size,a.offset]},getColumnOffset:(t,o,s,a,l,d)=>e8(t,o,s,a,l,"column",d),getRowOffset:(t,o,s,a,l,d)=>e8(t,o,s,a,l,"row",d),getColumnStartIndexForOffset:(t,o,s)=>QH(t,s,o,"column"),getColumnStopIndexForStartIndex:(t,o,s,a)=>{const l=Gl(t,o,a,"column"),d=s+t.width;let h=l.offset+l.size,v=o;for(;v<t.totalColumn-1&&h<d;)v++,h+=Gl(t,o,a,"column").size;return v},getEstimatedTotalHeight:gY,getEstimatedTotalWidth:_Y,getRowStartIndexForOffset:(t,o,s)=>QH(t,s,o,"row"),getRowStopIndexForStartIndex:(t,o,s,a)=>{const{totalRow:l,height:d}=t,h=Gl(t,o,a,"row"),v=s+d;let g=h.size+h.offset,E=o;for(;E<l-1&&g<v;)E++,g+=Gl(t,E,a,"row").size;return E},injectToInstance:(t,o)=>{const s=({columnIndex:d,rowIndex:h},v)=>{var g,E;v=Xn(v)?!0:v,$t(d)&&(o.value.lastVisitedColumnIndex=Math.min(o.value.lastVisitedColumnIndex,d-1)),$t(h)&&(o.value.lastVisitedRowIndex=Math.min(o.value.lastVisitedRowIndex,h-1)),(g=t.exposed)==null||g.getItemStyleCache.value(-1,null,null),v&&((E=t.proxy)==null||E.$forceUpdate())},a=(d,h)=>{s({columnIndex:d},h)},l=(d,h)=>{s({rowIndex:d},h)};Object.assign(t.proxy,{resetAfterColumnIndex:a,resetAfterRowIndex:l,resetAfter:s})},initCache:({estimatedColumnWidth:t=_O,estimatedRowHeight:o=_O})=>({column:{},estimatedColumnWidth:t,estimatedRowHeight:o,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:t,rowHeight:o})=>{}}),jMe=fY({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:t},o)=>[t,o*t],getRowPosition:({rowHeight:t},o)=>[t,o*t],getEstimatedTotalHeight:({totalRow:t,rowHeight:o})=>o*t,getEstimatedTotalWidth:({totalColumn:t,columnWidth:o})=>o*t,getColumnOffset:({totalColumn:t,columnWidth:o,width:s},a,l,d,h,v)=>{s=Number(s);const g=Math.max(0,t*o-s),E=Math.min(g,a*o),b=Math.max(0,a*o-s+v+o);switch(l==="smart"&&(d>=b-s&&d<=E+s?l=Va:l=al),l){case Hg:return E;case Wg:return b;case al:{const S=Math.round(b+(E-b)/2);return S<Math.ceil(s/2)?0:S>g+Math.floor(s/2)?g:S}case Va:default:return d>=b&&d<=E?d:b>E||d<b?b:E}},getRowOffset:({rowHeight:t,height:o,totalRow:s},a,l,d,h,v)=>{o=Number(o);const g=Math.max(0,s*t-o),E=Math.min(g,a*t),b=Math.max(0,a*t-o+v+t);switch(l===I0&&(d>=b-o&&d<=E+o?l=Va:l=al),l){case Hg:return E;case Wg:return b;case al:{const S=Math.round(b+(E-b)/2);return S<Math.ceil(o/2)?0:S>g+Math.floor(o/2)?g:S}case Va:default:return d>=b&&d<=E?d:b>E||d<b?b:E}},getColumnStartIndexForOffset:({columnWidth:t,totalColumn:o},s)=>Math.max(0,Math.min(o-1,Math.floor(s/t))),getColumnStopIndexForStartIndex:({columnWidth:t,totalColumn:o,width:s},a,l)=>{const d=a*t,h=Math.ceil((s+l-d)/t);return Math.max(0,Math.min(o-1,a+h-1))},getRowStartIndexForOffset:({rowHeight:t,totalRow:o},s)=>Math.max(0,Math.min(o-1,Math.floor(s/t))),getRowStopIndexForStartIndex:({rowHeight:t,totalRow:o,height:s},a,l)=>{const d=a*t,h=Math.ceil((s+l-d)/t);return Math.max(0,Math.min(o-1,a+h-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:t,rowHeight:o})=>{}}),$Me="ElTableV2Grid",HMe=t=>{const o=ee(),s=ee(),a=ee(0),l=U(()=>{const{data:N,rowHeight:O,estimatedRowHeight:V}=t;if(!V)return N.length*O}),d=U(()=>{const{fixedData:N,rowHeight:O}=t;return((N==null?void 0:N.length)||0)*O}),h=U(()=>Qb(t.headerHeight)),v=U(()=>{const{height:N}=t;return Math.max(0,N-p(h)-p(d))}),g=U(()=>p(h)+p(d)>0),E=({data:N,rowIndex:O})=>N[O][t.rowKey];function b({rowCacheStart:N,rowCacheEnd:O,rowVisibleStart:V,rowVisibleEnd:L}){var D;(D=t.onRowsRendered)==null||D.call(t,{rowCacheStart:N,rowCacheEnd:O,rowVisibleStart:V,rowVisibleEnd:L})}function S(N,O){var V;(V=s.value)==null||V.resetAfterRowIndex(N,O)}function C(N,O){const V=p(o),L=p(s);fn(N)?(V==null||V.scrollToLeft(N.scrollLeft),a.value=N.scrollLeft,L==null||L.scrollTo(N)):(V==null||V.scrollToLeft(N),a.value=N,L==null||L.scrollTo({scrollLeft:N,scrollTop:O}))}function w(N){var O;(O=p(s))==null||O.scrollTo({scrollTop:N})}function I(N,O){var V;(V=p(s))==null||V.scrollToItem(N,1,O)}function R(){var N,O;(N=p(s))==null||N.$forceUpdate(),(O=p(o))==null||O.$forceUpdate()}return ze(()=>t.bodyWidth,()=>{var N;$t(t.estimatedRowHeight)&&((N=s.value)==null||N.resetAfter({columnIndex:0},!1))}),{bodyRef:s,forceUpdate:R,fixedRowHeight:d,gridHeight:v,hasHeader:g,headerHeight:h,headerRef:o,totalHeight:l,itemKey:E,onItemRendered:b,resetAfterRowIndex:S,scrollTo:C,scrollToTop:w,scrollToRow:I,scrollLeft:a}},WMe=me({name:$Me,props:eS,setup(t,{slots:o,expose:s}){const{ns:a}=It($k),{bodyRef:l,fixedRowHeight:d,gridHeight:h,hasHeader:v,headerRef:g,headerHeight:E,totalHeight:b,forceUpdate:S,itemKey:C,onItemRendered:w,resetAfterRowIndex:I,scrollTo:R,scrollToTop:N,scrollToRow:O,scrollLeft:V}=HMe(t);wn("tableV2GridScrollLeft",V),s({forceUpdate:S,totalHeight:b,scrollTo:R,scrollToTop:N,scrollToRow:O,resetAfterRowIndex:I});const L=()=>t.bodyWidth;return()=>{const{cache:D,columns:M,data:F,fixedData:W,useIsScrolling:z,scrollbarAlwaysOn:G,scrollbarEndGap:Y,scrollbarStartGap:te,style:Z,rowHeight:fe,bodyWidth:Ee,estimatedRowHeight:ae,headerWidth:X,height:ie,width:se,getRowHeight:J,onScroll:pe}=t,be=$t(ae),Ae=be?BMe:jMe,_e=p(E);return ge("div",{role:"table",class:[a.e("table"),t.class],style:Z},[ge(Ae,{ref:l,data:F,useIsScrolling:z,itemKey:C,columnCache:0,columnWidth:be?L:Ee,totalColumn:1,totalRow:F.length,rowCache:D,rowHeight:be?J:fe,width:se,height:p(h),class:a.e("body"),role:"rowgroup",scrollbarStartGap:te,scrollbarEndGap:Y,scrollbarAlwaysOn:G,onScroll:pe,onItemRendered:w,perfMode:!1},{default:Me=>{var Fe;const Le=F[Me.rowIndex];return(Fe=o.row)==null?void 0:Fe.call(o,{...Me,columns:M,rowData:Le})}}),p(v)&&ge(MMe,{ref:g,class:a.e("header-wrapper"),columns:M,headerData:F,headerHeight:t.headerHeight,fixedHeaderData:W,rowWidth:X,rowHeight:fe,width:se,height:Math.min(_e+p(d),ie)},{dynamic:o.header,fixed:o.row})])}}});var Kk=WMe;function KMe(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const GMe=(t,{slots:o})=>{const{mainTableRef:s,...a}=t;return ge(Kk,En({ref:s},a),KMe(o)?o:{default:()=>[o]})};var zMe=GMe;function YMe(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const qMe=(t,{slots:o})=>{if(!t.columns.length)return;const{leftTableRef:s,...a}=t;return ge(Kk,En({ref:s},a),YMe(o)?o:{default:()=>[o]})};var XMe=qMe;function JMe(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const ZMe=(t,{slots:o})=>{if(!t.columns.length)return;const{rightTableRef:s,...a}=t;return ge(Kk,En({ref:s},a),JMe(o)?o:{default:()=>[o]})};var QMe=ZMe;const e2e=t=>{const{isScrolling:o}=It($k),s=ee(!1),a=ee(),l=U(()=>$t(t.estimatedRowHeight)&&t.rowIndex>=0),d=(g=!1)=>{const E=p(a);if(!E)return;const{columns:b,onRowHeightChange:S,rowKey:C,rowIndex:w,style:I}=t,{height:R}=E.getBoundingClientRect();s.value=!0,Vt(()=>{if(g||R!==Number.parseInt(I.height)){const N=b[0],O=(N==null?void 0:N.placeholderSign)===qg;S==null||S({rowKey:C,height:R,rowIndex:w},N&&!O&&N.fixed)}})},h=U(()=>{const{rowData:g,rowIndex:E,rowKey:b,onRowHover:S}=t,C=t.rowEventHandlers||{},w={};return Object.entries(C).forEach(([I,R])=>{Ft(R)&&(w[I]=N=>{R({event:N,rowData:g,rowIndex:E,rowKey:b})})}),S&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:I,hovered:R})=>{const N=w[I];w[I]=O=>{S({event:O,hovered:R,rowData:g,rowIndex:E,rowKey:b}),N==null||N(O)}}),w}),v=g=>{const{onRowExpand:E,rowData:b,rowIndex:S,rowKey:C}=t;E==null||E({expanded:g,rowData:b,rowIndex:S,rowKey:C})};return dn(()=>{p(l)&&d(!0)}),{isScrolling:o,measurable:l,measured:s,rowRef:a,eventHandlers:h,onExpand:v}},t2e="ElTableV2TableRow",n2e=me({name:t2e,props:Th,setup(t,{expose:o,slots:s,attrs:a}){const{eventHandlers:l,isScrolling:d,measurable:h,measured:v,rowRef:g,onExpand:E}=e2e(t);return o({onExpand:E}),()=>{const{columns:b,columnsStyles:S,expandColumnKey:C,depth:w,rowData:I,rowIndex:R,style:N}=t;let O=b.map((V,L)=>{const D=st(I.children)&&I.children.length>0&&V.key===C;return s.cell({column:V,columns:b,columnIndex:L,depth:w,style:S[V.key],rowData:I,rowIndex:R,isScrolling:p(d),expandIconProps:D?{rowData:I,rowIndex:R,onExpand:E}:void 0})});if(s.row&&(O=s.row({cells:O.map(V=>st(V)&&V.length===1?V[0]:V),style:N,columns:b,depth:w,rowData:I,rowIndex:R,isScrolling:p(d)})),p(h)){const{height:V,...L}=N||{},D=p(v);return ge("div",En({ref:g,class:t.class,style:D?N:L,role:"row"},a,p(l)),[O])}return ge("div",En(a,{ref:g,class:t.class,style:N,role:"row"},p(l)),[O])}}});var r2e=n2e;function o2e(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const s2e=(t,{slots:o})=>{const{columns:s,columnsStyles:a,depthMap:l,expandColumnKey:d,expandedRowKeys:h,estimatedRowHeight:v,hasFixedColumns:g,rowData:E,rowIndex:b,style:S,isScrolling:C,rowProps:w,rowClass:I,rowKey:R,rowEventHandlers:N,ns:O,onRowHovered:V,onRowExpanded:L}=t,D=Vh(I,{columns:s,rowData:E,rowIndex:b},""),M=Vh(w,{columns:s,rowData:E,rowIndex:b}),F=E[R],W=l[F]||0,z=!!d,G=b<0,Y=[O.e("row"),D,{[O.e(`row-depth-${W}`)]:z&&b>=0,[O.is("expanded")]:z&&h.includes(F),[O.is("fixed")]:!W&&G,[O.is("customized")]:!!o.row}],te=g?V:void 0,Z={...M,columns:s,columnsStyles:a,class:Y,depth:W,expandColumnKey:d,estimatedRowHeight:G?void 0:v,isScrolling:C,rowIndex:b,rowData:E,rowKey:F,rowEventHandlers:N,style:S};return ge(r2e,En(Z,{onRowExpand:L,onMouseenter:ae=>{te==null||te({hovered:!0,rowKey:F,event:ae,rowData:E,rowIndex:b})},onMouseleave:ae=>{te==null||te({hovered:!1,rowKey:F,event:ae,rowData:E,rowIndex:b})},rowkey:F}),o2e(o)?o:{default:()=>[o]})};var i2e=s2e;const Gk=(t,{slots:o})=>{var s;const{cellData:a,style:l}=t,d=((s=a==null?void 0:a.toString)==null?void 0:s.call(a))||"",h=Ne(o,"default",t,()=>[d]);return ge("div",{class:t.class,title:d,style:l},[h])};Gk.displayName="ElTableV2Cell";Gk.inheritAttrs=!1;var a2e=Gk;const c2e=t=>{const{expanded:o,expandable:s,onExpand:a,style:l,size:d}=t,h={onClick:s?()=>a(!o):void 0,class:t.class};return ge(Dt,En(h,{size:d,style:l}),{default:()=>[ge(vi,null,null)]})};var l2e=c2e;const EY=({columns:t,column:o,columnIndex:s,depth:a,expandIconProps:l,isScrolling:d,rowData:h,rowIndex:v,style:g,expandedRowKeys:E,ns:b,cellProps:S,expandColumnKey:C,indentSize:w,iconSize:I,rowKey:R},{slots:N})=>{const O=nd(g);if(o.placeholderSign===qg)return ge("div",{class:b.em("row-cell","placeholder"),style:O},null);const{cellRenderer:V,dataKey:L,dataGetter:D}=o,M=Ft(D)?D({columns:t,column:o,columnIndex:s,rowData:h,rowIndex:v}):Oo(h,L??""),F=Vh(S,{cellData:M,columns:t,column:o,columnIndex:s,rowIndex:v,rowData:h}),W={class:b.e("cell-text"),columns:t,column:o,columnIndex:s,cellData:M,isScrolling:d,rowData:h,rowIndex:v},z=lY(V),G=z?z(W):Ne(N,"default",W,()=>[ge(a2e,W,null)]),Y=[b.e("row-cell"),o.class,o.align===Yg.CENTER&&b.is("align-center"),o.align===Yg.RIGHT&&b.is("align-right")],te=v>=0&&C&&o.key===C,Z=v>=0&&E.includes(h[R]);let fe;const Ee=`margin-inline-start: ${a*w}px;`;return te&&(fn(l)?fe=ge(l2e,En(l,{class:[b.e("expand-icon"),b.is("expanded",Z)],size:I,expanded:Z,style:Ee,expandable:!0}),null):fe=ge("div",{style:[Ee,`width: ${I}px; height: ${I}px;`].join(" ")},null)),ge("div",En({class:Y,style:O},F,{role:"cell"}),[fe,G])};EY.inheritAttrs=!1;var t8=EY;const u2e=ut({class:String,columns:m_,columnsStyles:{type:Re(Object),required:!0},headerIndex:Number,style:{type:Re(Object)}}),d2e=me({name:"ElTableV2HeaderRow",props:u2e,setup(t,{slots:o}){return()=>{const{columns:s,columnsStyles:a,headerIndex:l,style:d}=t;let h=s.map((v,g)=>o.cell({columns:s,column:v,columnIndex:g,headerIndex:l,style:a[v.key]}));return o.header&&(h=o.header({cells:h.map(v=>st(v)&&v.length===1?v[0]:v),columns:s,headerIndex:l})),ge("div",{class:t.class,style:d,role:"row"},[h])}}});var h2e=d2e;function f2e(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const p2e=({columns:t,columnsStyles:o,headerIndex:s,style:a,headerClass:l,headerProps:d,ns:h},{slots:v})=>{const g={columns:t,headerIndex:s},E=[h.e("header-row"),Vh(l,g,""),{[h.is("customized")]:!!v.header}],b={...Vh(d,g),columnsStyles:o,class:E,columns:t,headerIndex:s,style:a};return ge(h2e,b,f2e(v)?v:{default:()=>[v]})};var m2e=p2e;const zk=(t,{slots:o})=>Ne(o,"default",t,()=>{var s,a;return[ge("div",{class:t.class,title:(s=t.column)==null?void 0:s.title},[(a=t.column)==null?void 0:a.title])]});zk.displayName="ElTableV2HeaderCell";zk.inheritAttrs=!1;var v2e=zk;const g2e=t=>{const{sortOrder:o}=t;return ge(Dt,{size:14,class:t.class},{default:()=>[o===zg.ASC?ge(Jye,null,null):ge(qye,null,null)]})};var _2e=g2e;const E2e=(t,{slots:o})=>{const{column:s,ns:a,style:l,onColumnSorted:d}=t,h=nd(l);if(s.placeholderSign===qg)return ge("div",{class:a.em("header-row-cell","placeholder"),style:h},null);const{headerCellRenderer:v,headerClass:g,sortable:E}=s,b={...t,class:a.e("header-cell-text")},S=lY(v),C=S?S(b):Ne(o,"default",b,()=>[ge(v2e,b,null)]),{sortBy:w,sortState:I,headerCellProps:R}=t;let N,O;if(I){const D=I[s.key];N=!!MO[D],O=N?D:zg.ASC}else N=s.key===w.key,O=N?w.order:zg.ASC;const V=[a.e("header-cell"),Vh(g,t,""),s.align===Yg.CENTER&&a.is("align-center"),s.align===Yg.RIGHT&&a.is("align-right"),E&&a.is("sortable")],L={...Vh(R,t),onClick:s.sortable?d:void 0,class:V,style:h,"data-key":s.key};return ge("div",En(L,{role:"columnheader"}),[C,E&&ge(_2e,{class:[a.e("sort-icon"),N&&a.is("sorting")],sortOrder:O},null)])};var n8=E2e;const yY=(t,{slots:o})=>{var s;return ge("div",{class:t.class,style:t.style},[(s=o.default)==null?void 0:s.call(o)])};yY.displayName="ElTableV2Footer";var y2e=yY;const bY=(t,{slots:o})=>{const s=Ne(o,"default",{},()=>[ge(mz,null,null)]);return ge("div",{class:t.class,style:t.style},[s])};bY.displayName="ElTableV2Empty";var b2e=bY;const SY=(t,{slots:o})=>{var s;return ge("div",{class:t.class,style:t.style},[(s=o.default)==null?void 0:s.call(o)])};SY.displayName="ElTableV2Overlay";var S2e=SY;function eg(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!Kr(t)}const T2e="ElTableV2",C2e=me({name:T2e,props:PMe,setup(t,{slots:o,expose:s}){const a=Qe("table-v2"),{columnsStyles:l,fixedColumnsOnLeft:d,fixedColumnsOnRight:h,mainColumns:v,mainTableHeight:g,fixedTableHeight:E,leftTableWidth:b,rightTableWidth:S,data:C,depthMap:w,expandedRowKeys:I,hasFixedColumns:R,mainTableRef:N,leftTableRef:O,rightTableRef:V,isDynamic:L,isResetting:D,isScrolling:M,bodyWidth:F,emptyStyle:W,rootStyle:z,headerWidth:G,footerHeight:Y,showEmpty:te,scrollTo:Z,scrollToLeft:fe,scrollToTop:Ee,scrollToRow:ae,getRowHeight:X,onColumnSorted:ie,onRowHeightChange:se,onRowHovered:J,onRowExpanded:pe,onRowsRendered:be,onScroll:Ae,onVerticalScroll:_e}=NMe(t);return s({scrollTo:Z,scrollToLeft:fe,scrollToTop:Ee,scrollToRow:ae}),wn($k,{ns:a,isResetting:D,isScrolling:M}),()=>{const{cache:Me,cellProps:Fe,estimatedRowHeight:Le,expandColumnKey:Pe,fixedData:He,headerHeight:We,headerClass:yt,headerProps:it,headerCellProps:ce,sortBy:Se,sortState:je,rowHeight:tt,rowClass:et,rowEventHandlers:Ge,rowKey:Xe,rowProps:Ye,scrollbarAlwaysOn:ct,indentSize:nt,iconSize:Ot,useIsScrolling:_t,vScrollbarSize:qe,width:wt}=t,qt=p(C),sn={cache:Me,class:a.e("main"),columns:p(v),data:qt,fixedData:He,estimatedRowHeight:Le,bodyWidth:p(F)+qe,headerHeight:We,headerWidth:p(G),height:p(g),mainTableRef:N,rowKey:Xe,rowHeight:tt,scrollbarAlwaysOn:ct,scrollbarStartGap:2,scrollbarEndGap:qe,useIsScrolling:_t,width:wt,getRowHeight:X,onRowsRendered:be,onScroll:Ae},tn=p(b),Kn=p(E),Sn={cache:Me,class:a.e("left"),columns:p(d),data:qt,fixedData:He,estimatedRowHeight:Le,leftTableRef:O,rowHeight:tt,bodyWidth:tn,headerWidth:tn,headerHeight:We,height:Kn,rowKey:Xe,scrollbarAlwaysOn:ct,scrollbarStartGap:2,scrollbarEndGap:qe,useIsScrolling:_t,width:tn,getRowHeight:X,onScroll:_e},Wt=p(S)+qe,Je={cache:Me,class:a.e("right"),columns:p(h),data:qt,fixedData:He,estimatedRowHeight:Le,rightTableRef:V,rowHeight:tt,bodyWidth:Wt,headerWidth:Wt,headerHeight:We,height:Kn,rowKey:Xe,scrollbarAlwaysOn:ct,scrollbarStartGap:2,scrollbarEndGap:qe,width:Wt,style:`--${p(a.namespace)}-table-scrollbar-size: ${qe}px`,useIsScrolling:_t,getRowHeight:X,onScroll:_e},Ie=p(l),Ke={ns:a,depthMap:p(w),columnsStyles:Ie,expandColumnKey:Pe,expandedRowKeys:p(I),estimatedRowHeight:Le,hasFixedColumns:p(R),rowProps:Ye,rowClass:et,rowKey:Xe,rowEventHandlers:Ge,onRowHovered:J,onRowExpanded:pe,onRowHeightChange:se},Te={cellProps:Fe,expandColumnKey:Pe,indentSize:nt,iconSize:Ot,rowKey:Xe,expandedRowKeys:p(I),ns:a},vt={ns:a,headerClass:yt,headerProps:it,columnsStyles:Ie},an={ns:a,sortBy:Se,sortState:je,headerCellProps:ce,onColumnSorted:ie},en={row:No=>ge(i2e,En(No,Ke),{row:o.row,cell:Wo=>{let $r;return o.cell?ge(t8,En(Wo,Te,{style:Ie[Wo.column.key]}),eg($r=o.cell(Wo))?$r:{default:()=>[$r]}):ge(t8,En(Wo,Te,{style:Ie[Wo.column.key]}),null)}}),header:No=>ge(m2e,En(No,vt),{header:o.header,cell:Wo=>{let $r;return o["header-cell"]?ge(n8,En(Wo,an,{style:Ie[Wo.column.key]}),eg($r=o["header-cell"](Wo))?$r:{default:()=>[$r]}):ge(n8,En(Wo,an,{style:Ie[Wo.column.key]}),null)}})},Ir=[t.class,a.b(),a.e("root"),{[a.is("dynamic")]:p(L)}],yi={class:a.e("footer"),style:p(Y)};return ge("div",{class:Ir,style:p(z)},[ge(zMe,sn,eg(en)?en:{default:()=>[en]}),ge(XMe,Sn,eg(en)?en:{default:()=>[en]}),ge(QMe,Je,eg(en)?en:{default:()=>[en]}),o.footer&&ge(y2e,yi,{default:o.footer}),p(te)&&ge(b2e,{class:a.e("empty"),style:p(W)},{default:o.empty}),o.overlay&&ge(S2e,{class:a.e("overlay")},{default:o.overlay})])}}});var w2e=C2e;const R2e=ut({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:Re(Function)}}),I2e=t=>{const o=ee(),s=ee(0),a=ee(0);let l;return dn(()=>{l=co(o,([d])=>{const{width:h,height:v}=d.contentRect,{paddingLeft:g,paddingRight:E,paddingTop:b,paddingBottom:S}=getComputedStyle(d.target),C=Number.parseInt(g)||0,w=Number.parseInt(E)||0,I=Number.parseInt(b)||0,R=Number.parseInt(S)||0;s.value=h-C-w,a.value=v-I-R}).stop}),Rr(()=>{l==null||l()}),ze([s,a],([d,h])=>{var v;(v=t.onResize)==null||v.call(t,{width:d,height:h})}),{sizer:o,width:s,height:a}},A2e=me({name:"ElAutoResizer",props:R2e,setup(t,{slots:o}){const s=Qe("auto-resizer"),{height:a,width:l,sizer:d}=I2e(t),h={width:"100%",height:"100%"};return()=>{var v;return ge("div",{ref:d,class:s.b(),style:h},[(v=o.default)==null?void 0:v.call(o,{height:a.value,width:l.value})])}}});var O2e=A2e;const N2e=rn(w2e),k2e=rn(O2e),A0=Symbol("tabsRootContextKey"),P2e=ut({tabs:{type:Re(Array),default:()=>lo([])}}),TY="ElTabBar",D2e=me({name:TY}),L2e=me({...D2e,props:P2e,setup(t,{expose:o}){const s=t,a=mn(),l=It(A0);l||qo(TY,"<el-tabs><el-tab-bar /></el-tabs>");const d=Qe("tabs"),h=ee(),v=ee(),g=()=>{let w=0,I=0;const R=["top","bottom"].includes(l.props.tabPosition)?"width":"height",N=R==="width"?"x":"y",O=N==="x"?"left":"top";return s.tabs.every(V=>{var L,D;const M=(D=(L=a.parent)==null?void 0:L.refs)==null?void 0:D[`tab-${V.uid}`];if(!M)return!1;if(!V.active)return!0;w=M[`offset${il(O)}`],I=M[`client${il(R)}`];const F=window.getComputedStyle(M);return R==="width"&&(I-=Number.parseFloat(F.paddingLeft)+Number.parseFloat(F.paddingRight),w+=Number.parseFloat(F.paddingLeft)),!1}),{[R]:`${I}px`,transform:`translate${il(N)}(${w}px)`}},E=()=>v.value=g(),b=[],S=()=>{var w;b.forEach(R=>R.stop()),b.length=0;const I=(w=a.parent)==null?void 0:w.refs;if(I){for(const R in I)if(R.startsWith("tab-")){const N=I[R];N&&b.push(co(N,E))}}};ze(()=>s.tabs,async()=>{await Vt(),E(),S()},{immediate:!0});const C=co(h,()=>E());return Rr(()=>{b.forEach(w=>w.stop()),b.length=0,C.stop()}),o({ref:h,update:E}),(w,I)=>($(),le("div",{ref_key:"barRef",ref:h,class:K([p(d).e("active-bar"),p(d).is(p(l).props.tabPosition)]),style:jt(v.value)},null,6))}});var M2e=dt(L2e,[["__file","tab-bar.vue"]]);const x2e=ut({panes:{type:Re(Array),default:()=>lo([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),U2e={tabClick:(t,o,s)=>s instanceof Event,tabRemove:(t,o)=>o instanceof Event},r8="ElTabNav",V2e=me({name:r8,props:x2e,emits:U2e,setup(t,{expose:o,emit:s}){const a=It(A0);a||qo(r8,"<el-tabs><tab-nav /></el-tabs>");const l=Qe("tabs"),d=mEe(),h=IEe(),v=ee(),g=ee(),E=ee(),b=ee(),S=ee(!1),C=ee(0),w=ee(!1),I=ee(!0),R=U(()=>["top","bottom"].includes(a.props.tabPosition)?"width":"height"),N=U(()=>({transform:`translate${R.value==="width"?"X":"Y"}(-${C.value}px)`})),O=()=>{if(!v.value)return;const z=v.value[`offset${il(R.value)}`],G=C.value;if(!G)return;const Y=G>z?G-z:0;C.value=Y},V=()=>{if(!v.value||!g.value)return;const z=g.value[`offset${il(R.value)}`],G=v.value[`offset${il(R.value)}`],Y=C.value;if(z-Y<=G)return;const te=z-Y>G*2?Y+G:z-G;C.value=te},L=async()=>{const z=g.value;if(!S.value||!E.value||!v.value||!z)return;await Vt();const G=E.value.querySelector(".is-active");if(!G)return;const Y=v.value,te=["top","bottom"].includes(a.props.tabPosition),Z=G.getBoundingClientRect(),fe=Y.getBoundingClientRect(),Ee=te?z.offsetWidth-fe.width:z.offsetHeight-fe.height,ae=C.value;let X=ae;te?(Z.left<fe.left&&(X=ae-(fe.left-Z.left)),Z.right>fe.right&&(X=ae+Z.right-fe.right)):(Z.top<fe.top&&(X=ae-(fe.top-Z.top)),Z.bottom>fe.bottom&&(X=ae+(Z.bottom-fe.bottom))),X=Math.max(X,0),C.value=Math.min(X,Ee)},D=()=>{var z;if(!g.value||!v.value)return;t.stretch&&((z=b.value)==null||z.update());const G=g.value[`offset${il(R.value)}`],Y=v.value[`offset${il(R.value)}`],te=C.value;Y<G?(S.value=S.value||{},S.value.prev=te,S.value.next=te+Y<G,G-te<Y&&(C.value=G-Y)):(S.value=!1,te>0&&(C.value=0))},M=z=>{let G=0;switch(z.code){case Ct.left:case Ct.up:G=-1;break;case Ct.right:case Ct.down:G=1;break;default:return}const Y=Array.from(z.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let Z=Y.indexOf(z.target)+G;Z<0?Z=Y.length-1:Z>=Y.length&&(Z=0),Y[Z].focus({preventScroll:!0}),Y[Z].click(),F()},F=()=>{I.value&&(w.value=!0)},W=()=>w.value=!1;return ze(d,z=>{z==="hidden"?I.value=!1:z==="visible"&&setTimeout(()=>I.value=!0,50)}),ze(h,z=>{z?setTimeout(()=>I.value=!0,50):I.value=!1}),co(E,D),dn(()=>setTimeout(()=>L(),0)),wc(()=>D()),o({scrollToActiveTab:L,removeFocus:W}),()=>{const z=S.value?[ge("span",{class:[l.e("nav-prev"),l.is("disabled",!S.value.prev)],onClick:O},[ge(Dt,null,{default:()=>[ge(ud,null,null)]})]),ge("span",{class:[l.e("nav-next"),l.is("disabled",!S.value.next)],onClick:V},[ge(Dt,null,{default:()=>[ge(vi,null,null)]})])]:null,G=t.panes.map((Y,te)=>{var Z,fe,Ee,ae;const X=Y.uid,ie=Y.props.disabled,se=(fe=(Z=Y.props.name)!=null?Z:Y.index)!=null?fe:`${te}`,J=!ie&&(Y.isClosable||t.editable);Y.index=`${te}`;const pe=J?ge(Dt,{class:"is-icon-close",onClick:_e=>s("tabRemove",Y,_e)},{default:()=>[ge(Sc,null,null)]}):null,be=((ae=(Ee=Y.slots).label)==null?void 0:ae.call(Ee))||Y.props.label,Ae=!ie&&Y.active?0:-1;return ge("div",{ref:`tab-${X}`,class:[l.e("item"),l.is(a.props.tabPosition),l.is("active",Y.active),l.is("disabled",ie),l.is("closable",J),l.is("focus",w.value)],id:`tab-${se}`,key:`tab-${X}`,"aria-controls":`pane-${se}`,role:"tab","aria-selected":Y.active,tabindex:Ae,onFocus:()=>F(),onBlur:()=>W(),onClick:_e=>{W(),s("tabClick",Y,se,_e)},onKeydown:_e=>{J&&(_e.code===Ct.delete||_e.code===Ct.backspace)&&s("tabRemove",Y,_e)}},[be,pe])});return ge("div",{ref:E,class:[l.e("nav-wrap"),l.is("scrollable",!!S.value),l.is(a.props.tabPosition)]},[z,ge("div",{class:l.e("nav-scroll"),ref:v},[ge("div",{class:[l.e("nav"),l.is(a.props.tabPosition),l.is("stretch",t.stretch&&["top","bottom"].includes(a.props.tabPosition))],ref:g,style:N.value,role:"tablist",onKeydown:M},[t.type?null:ge(M2e,{ref:b,tabs:[...t.panes]},null),G])])])}}}),F2e=ut({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Re(Function),default:()=>!0},stretch:Boolean}),yA=t=>Mt(t)||$t(t),B2e={[Jt]:t=>yA(t),tabClick:(t,o)=>o instanceof Event,tabChange:t=>yA(t),edit:(t,o)=>["remove","add"].includes(o),tabRemove:t=>yA(t),tabAdd:()=>!0},j2e=me({name:"ElTabs",props:F2e,emits:B2e,setup(t,{emit:o,slots:s,expose:a}){var l;const d=Qe("tabs"),h=U(()=>["left","right"].includes(t.tabPosition)),{children:v,addChild:g,removeChild:E}=hk(mn(),"ElTabPane"),b=ee(),S=ee((l=t.modelValue)!=null?l:"0"),C=async(O,V=!1)=>{var L,D;if(!(S.value===O||Xn(O)))try{let M;if(t.beforeLeave){const F=t.beforeLeave(O,S.value);M=F instanceof Promise?await F:F}else M=!0;M!==!1&&(S.value=O,V&&(o(Jt,O),o("tabChange",O)),(D=(L=b.value)==null?void 0:L.removeFocus)==null||D.call(L))}catch{}},w=(O,V,L)=>{O.props.disabled||(C(V,!0),o("tabClick",O,L))},I=(O,V)=>{O.props.disabled||Xn(O.props.name)||(V.stopPropagation(),o("edit",O.props.name,"remove"),o("tabRemove",O.props.name))},R=()=>{o("edit",void 0,"add"),o("tabAdd")};ze(()=>t.modelValue,O=>C(O)),ze(S,async()=>{var O;await Vt(),(O=b.value)==null||O.scrollToActiveTab()}),wn(A0,{props:t,currentName:S,registerPane:O=>{v.value.push(O)},sortPane:g,unregisterPane:E}),a({currentName:S});const N=({render:O})=>O();return()=>{const O=s["add-icon"],V=t.editable||t.addable?ge("div",{class:[d.e("new-tab"),h.value&&d.e("new-tab-vertical")],tabindex:"0",onClick:R,onKeydown:M=>{[Ct.enter,Ct.numpadEnter].includes(M.code)&&R()}},[O?Ne(s,"add-icon"):ge(Dt,{class:d.is("icon-plus")},{default:()=>[ge(EK,null,null)]})]):null,L=ge("div",{class:[d.e("header"),h.value&&d.e("header-vertical"),d.is(t.tabPosition)]},[ge(N,{render:()=>{const M=v.value.some(F=>F.slots.label);return ge(V2e,{ref:b,currentName:S.value,editable:t.editable,type:t.type,panes:v.value,stretch:t.stretch,onTabClick:w,onTabRemove:I},{$stable:!M})}},null),V]),D=ge("div",{class:d.e("content")},[Ne(s,"default")]);return ge("div",{class:[d.b(),d.m(t.tabPosition),{[d.m("card")]:t.type==="card",[d.m("border-card")]:t.type==="border-card"}]},[D,L])}}});var $2e=j2e;const H2e=ut({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),CY="ElTabPane",W2e=me({name:CY}),K2e=me({...W2e,props:H2e,setup(t){const o=t,s=mn(),a=Jo(),l=It(A0);l||qo(CY,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const d=Qe("tab-pane"),h=ee(),v=U(()=>o.closable||l.props.closable),g=YA(()=>{var w;return l.currentName.value===((w=o.name)!=null?w:h.value)}),E=ee(g.value),b=U(()=>{var w;return(w=o.name)!=null?w:h.value}),S=YA(()=>!o.lazy||E.value||g.value);ze(g,w=>{w&&(E.value=!0)});const C=er({uid:s.uid,slots:a,props:o,paneName:b,active:g,index:h,isClosable:v});return l.registerPane(C),dn(()=>{l.sortPane(C)}),iu(()=>{l.unregisterPane(C.uid)}),(w,I)=>p(S)?ln(($(),le("div",{key:0,id:`pane-${p(b)}`,class:K(p(d).b()),role:"tabpanel","aria-hidden":!p(g),"aria-labelledby":`tab-${p(b)}`},[Ne(w.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Wn,p(g)]]):De("v-if",!0)}});var wY=dt(K2e,[["__file","tab-pane.vue"]]);const G2e=rn($2e,{TabPane:wY}),z2e=uo(wY),Y2e=ut({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:vl,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),q2e=me({name:"ElText"}),X2e=me({...q2e,props:Y2e,setup(t){const o=t,s=ee(),a=xo(),l=Qe("text"),d=U(()=>[l.b(),l.m(o.type),l.m(a.value),l.is("truncated",o.truncated),l.is("line-clamp",!Xn(o.lineClamp))]),h=au().title,v=()=>{var g,E,b,S,C;if(h)return;let w=!1;const I=((g=s.value)==null?void 0:g.textContent)||"";if(o.truncated){const R=(E=s.value)==null?void 0:E.offsetWidth,N=(b=s.value)==null?void 0:b.scrollWidth;R&&N&&N>R&&(w=!0)}else if(!Xn(o.lineClamp)){const R=(S=s.value)==null?void 0:S.offsetHeight,N=(C=s.value)==null?void 0:C.scrollHeight;R&&N&&N>R&&(w=!0)}w?s.value.setAttribute("title",I):s.value.removeAttribute("title")};return dn(v),wc(v),(g,E)=>($(),Ve(gn(g.tag),{ref_key:"textRef",ref:s,class:K(p(d)),style:jt({"-webkit-line-clamp":g.lineClamp})},{default:Ce(()=>[Ne(g.$slots,"default")]),_:3},8,["class","style"]))}});var J2e=dt(X2e,[["__file","text.vue"]]);const Z2e=rn(J2e),Q2e=ut({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:Re(String),default:"light"},clearable:{type:Boolean,default:!0},size:Ho,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,includeEndTime:{type:Boolean,default:!1},name:String,prefixIcon:{type:Re([String,Object]),default:()=>_K},clearIcon:{type:Re([String,Object]),default:()=>du},...pm}),Xl=t=>{const o=(t||"").split(":");if(o.length>=2){let s=Number.parseInt(o[0],10);const a=Number.parseInt(o[1],10),l=t.toUpperCase();return l.includes("AM")&&s===12?s=0:l.includes("PM")&&s!==12&&(s+=12),{hours:s,minutes:a}}return null},bA=(t,o)=>{const s=Xl(t);if(!s)return-1;const a=Xl(o);if(!a)return-1;const l=s.minutes+s.hours*60,d=a.minutes+a.hours*60;return l===d?0:l>d?1:-1},o8=t=>`${t}`.padStart(2,"0"),Sp=t=>`${o8(t.hours)}:${o8(t.minutes)}`,exe=(t,o)=>{const s=Xl(t);if(!s)return"";const a=Xl(o);if(!a)return"";const l={hours:s.hours,minutes:s.minutes};return l.minutes+=a.minutes,l.hours+=a.hours,l.hours+=Math.floor(l.minutes/60),l.minutes=l.minutes%60,Sp(l)},txe=me({name:"ElTimeSelect"}),nxe=me({...txe,props:Q2e,emits:[yn,"blur","focus","clear",Jt],setup(t,{expose:o}){const s=t;on.extend(vk);const{Option:a}=Uh,l=Qe("input"),d=ee(),h=Fs(),{lang:v}=Fn(),g=U(()=>s.modelValue),E=U(()=>{const O=Xl(s.start);return O?Sp(O):null}),b=U(()=>{const O=Xl(s.end);return O?Sp(O):null}),S=U(()=>{const O=Xl(s.step);return O?Sp(O):null}),C=U(()=>{const O=Xl(s.minTime||"");return O?Sp(O):null}),w=U(()=>{const O=Xl(s.maxTime||"");return O?Sp(O):null}),I=U(()=>{var O;const V=[],L=(D,M)=>{V.push({value:D,disabled:bA(M,C.value||"-1:-1")<=0||bA(M,w.value||"100:100")>=0})};if(s.start&&s.end&&s.step){let D=E.value,M;for(;D&&b.value&&bA(D,b.value)<=0;)M=on(D,"HH:mm").locale(v.value).format(s.format),L(M,D),D=exe(D,S.value);if(s.includeEndTime&&b.value&&((O=V[V.length-1])==null?void 0:O.value)!==b.value){const F=on(b.value,"HH:mm").locale(v.value).format(s.format);L(F,b.value)}}return V});return o({blur:()=>{var O,V;(V=(O=d.value)==null?void 0:O.blur)==null||V.call(O)},focus:()=>{var O,V;(V=(O=d.value)==null?void 0:O.focus)==null||V.call(O)}}),(O,V)=>($(),Ve(p(Uh),{ref_key:"select",ref:d,"model-value":p(g),disabled:p(h),clearable:O.clearable,"clear-icon":O.clearIcon,size:O.size,effect:O.effect,placeholder:O.placeholder,"default-first-option":"",filterable:O.editable,"empty-values":O.emptyValues,"value-on-clear":O.valueOnClear,"onUpdate:modelValue":L=>O.$emit(p(Jt),L),onChange:L=>O.$emit(p(yn),L),onBlur:L=>O.$emit("blur",L),onFocus:L=>O.$emit("focus",L),onClear:()=>O.$emit("clear")},{prefix:Ce(()=>[O.prefixIcon?($(),Ve(p(Dt),{key:0,class:K(p(l).e("prefix-icon"))},{default:Ce(()=>[($(),Ve(gn(O.prefixIcon)))]),_:1},8,["class"])):De("v-if",!0)]),default:Ce(()=>[($(!0),le(Ut,null,Cn(p(I),L=>($(),Ve(p(a),{key:L.value,label:L.value,value:L.value,disabled:L.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var rxe=dt(nxe,[["__file","time-select.vue"]]);const oxe=rn(rxe),sxe=me({name:"ElTimeline",setup(t,{slots:o}){const s=Qe("timeline");return wn("timeline",o),()=>Ht("ul",{class:[s.b()]},[Ne(o,"default")])}}),ixe=ut({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:yr},hollow:Boolean}),axe=me({name:"ElTimelineItem"}),cxe=me({...axe,props:ixe,setup(t){const o=t,s=Qe("timeline-item"),a=U(()=>[s.e("node"),s.em("node",o.size||""),s.em("node",o.type||""),s.is("hollow",o.hollow)]);return(l,d)=>($(),le("li",{class:K([p(s).b(),{[p(s).e("center")]:l.center}])},[ue("div",{class:K(p(s).e("tail"))},null,2),l.$slots.dot?De("v-if",!0):($(),le("div",{key:0,class:K(p(a)),style:jt({backgroundColor:l.color})},[l.icon?($(),Ve(p(Dt),{key:0,class:K(p(s).e("icon"))},{default:Ce(()=>[($(),Ve(gn(l.icon)))]),_:1},8,["class"])):De("v-if",!0)],6)),l.$slots.dot?($(),le("div",{key:1,class:K(p(s).e("dot"))},[Ne(l.$slots,"dot")],2)):De("v-if",!0),ue("div",{class:K(p(s).e("wrapper"))},[!l.hideTimestamp&&l.placement==="top"?($(),le("div",{key:0,class:K([p(s).e("timestamp"),p(s).is("top")])},ot(l.timestamp),3)):De("v-if",!0),ue("div",{class:K(p(s).e("content"))},[Ne(l.$slots,"default")],2),!l.hideTimestamp&&l.placement==="bottom"?($(),le("div",{key:1,class:K([p(s).e("timestamp"),p(s).is("bottom")])},ot(l.timestamp),3)):De("v-if",!0)],2)],2))}});var RY=dt(cxe,[["__file","timeline-item.vue"]]);const lxe=rn(sxe,{TimelineItem:RY}),uxe=uo(RY),IY=ut({nowrap:Boolean});var AY=(t=>(t.top="top",t.bottom="bottom",t.left="left",t.right="right",t))(AY||{});const dxe=Object.values(AY),Yk=ut({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:Re(Object),default:null}}),hxe=ut({side:{type:Re(String),values:dxe,required:!0}}),fxe=["absolute","fixed"],pxe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],qk=ut({arrowPadding:{type:Re(Number),default:5},effect:{type:Re(String),default:"light"},contentClass:String,placement:{type:Re(String),values:pxe,default:"bottom"},reference:{type:Re(Object),default:null},offset:{type:Number,default:8},strategy:{type:Re(String),values:fxe,default:"absolute"},showArrow:Boolean,...Cs(["ariaLabel"])}),Xk=ut({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:Re(Function)},"onUpdate:open":{type:Re(Function)}}),gp={type:Re(Function)},Jk=ut({onBlur:gp,onClick:gp,onFocus:gp,onMouseDown:gp,onMouseEnter:gp,onMouseLeave:gp}),mxe=ut({...Xk,...Yk,...Jk,...qk,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:Re(Object),default:null},teleported:Boolean,to:{type:Re(String),default:"body"}}),O0=Symbol("tooltipV2"),OY=Symbol("tooltipV2Content"),SA="tooltip_v2.open",vxe=me({name:"ElTooltipV2Root"}),gxe=me({...vxe,props:Xk,setup(t,{expose:o}){const s=t,a=ee(s.defaultOpen),l=ee(null),d=U({get:()=>Ec(s.open)?a.value:s.open,set:N=>{var O;a.value=N,(O=s["onUpdate:open"])==null||O.call(s,N)}}),h=U(()=>$t(s.delayDuration)&&s.delayDuration>0),{start:v,stop:g}=Mh(()=>{d.value=!0},U(()=>s.delayDuration),{immediate:!1}),E=Qe("tooltip-v2"),b=Ts(),S=()=>{g(),d.value=!0},C=()=>{p(h)?v():S()},w=S,I=()=>{g(),d.value=!1};return ze(d,N=>{var O;N&&(document.dispatchEvent(new CustomEvent(SA)),w()),(O=s.onOpenChange)==null||O.call(s,N)}),dn(()=>{document.addEventListener(SA,I)}),Rr(()=>{g(),document.removeEventListener(SA,I)}),wn(O0,{contentId:b,triggerRef:l,ns:E,onClose:I,onDelayOpen:C,onOpen:w}),o({onOpen:w,onClose:I}),(N,O)=>Ne(N.$slots,"default",{open:p(d)})}});var _xe=dt(gxe,[["__file","root.vue"]]);const Exe=me({name:"ElTooltipV2Arrow"}),yxe=me({...Exe,props:{...Yk,...hxe},setup(t){const o=t,{ns:s}=It(O0),{arrowRef:a}=It(OY),l=U(()=>{const{style:d,width:h,height:v}=o,g=s.namespace.value;return{[`--${g}-tooltip-v2-arrow-width`]:`${h}px`,[`--${g}-tooltip-v2-arrow-height`]:`${v}px`,[`--${g}-tooltip-v2-arrow-border-width`]:`${h/2}px`,[`--${g}-tooltip-v2-arrow-cover-width`]:h/2-1,...d||{}}});return(d,h)=>($(),le("span",{ref_key:"arrowRef",ref:a,style:jt(p(l)),class:K(p(s).e("arrow"))},null,6))}});var s8=dt(yxe,[["__file","arrow.vue"]]);const nm=Math.min,Nh=Math.max,VS=Math.round,Mb=Math.floor,ll=t=>({x:t,y:t}),bxe={left:"right",right:"left",bottom:"top",top:"bottom"},Sxe={start:"end",end:"start"};function UO(t,o,s){return Nh(t,nm(o,s))}function v_(t,o){return typeof t=="function"?t(o):t}function Fh(t){return t.split("-")[0]}function g_(t){return t.split("-")[1]}function NY(t){return t==="x"?"y":"x"}function Zk(t){return t==="y"?"height":"width"}function rm(t){return["top","bottom"].includes(Fh(t))?"y":"x"}function Qk(t){return NY(rm(t))}function Txe(t,o,s){s===void 0&&(s=!1);const a=g_(t),l=Qk(t),d=Zk(l);let h=l==="x"?a===(s?"end":"start")?"right":"left":a==="start"?"bottom":"top";return o.reference[d]>o.floating[d]&&(h=FS(h)),[h,FS(h)]}function Cxe(t){const o=FS(t);return[VO(t),o,VO(o)]}function VO(t){return t.replace(/start|end/g,o=>Sxe[o])}function wxe(t,o,s){const a=["left","right"],l=["right","left"],d=["top","bottom"],h=["bottom","top"];switch(t){case"top":case"bottom":return s?o?l:a:o?a:l;case"left":case"right":return o?d:h;default:return[]}}function Rxe(t,o,s,a){const l=g_(t);let d=wxe(Fh(t),s==="start",a);return l&&(d=d.map(h=>h+"-"+l),o&&(d=d.concat(d.map(VO)))),d}function FS(t){return t.replace(/left|right|bottom|top/g,o=>bxe[o])}function Ixe(t){return{top:0,right:0,bottom:0,left:0,...t}}function kY(t){return typeof t!="number"?Ixe(t):{top:t,right:t,bottom:t,left:t}}function BS(t){const{x:o,y:s,width:a,height:l}=t;return{width:a,height:l,top:s,left:o,right:o+a,bottom:s+l,x:o,y:s}}function i8(t,o,s){let{reference:a,floating:l}=t;const d=rm(o),h=Qk(o),v=Zk(h),g=Fh(o),E=d==="y",b=a.x+a.width/2-l.width/2,S=a.y+a.height/2-l.height/2,C=a[v]/2-l[v]/2;let w;switch(g){case"top":w={x:b,y:a.y-l.height};break;case"bottom":w={x:b,y:a.y+a.height};break;case"right":w={x:a.x+a.width,y:S};break;case"left":w={x:a.x-l.width,y:S};break;default:w={x:a.x,y:a.y}}switch(g_(o)){case"start":w[h]-=C*(s&&E?-1:1);break;case"end":w[h]+=C*(s&&E?-1:1);break}return w}const Axe=async(t,o,s)=>{const{placement:a="bottom",strategy:l="absolute",middleware:d=[],platform:h}=s,v=d.filter(Boolean),g=await(h.isRTL==null?void 0:h.isRTL(o));let E=await h.getElementRects({reference:t,floating:o,strategy:l}),{x:b,y:S}=i8(E,a,g),C=a,w={},I=0;for(let R=0;R<v.length;R++){const{name:N,fn:O}=v[R],{x:V,y:L,data:D,reset:M}=await O({x:b,y:S,initialPlacement:a,placement:C,strategy:l,middlewareData:w,rects:E,platform:h,elements:{reference:t,floating:o}});b=V??b,S=L??S,w={...w,[N]:{...w[N],...D}},M&&I<=50&&(I++,typeof M=="object"&&(M.placement&&(C=M.placement),M.rects&&(E=M.rects===!0?await h.getElementRects({reference:t,floating:o,strategy:l}):M.rects),{x:b,y:S}=i8(E,C,g)),R=-1)}return{x:b,y:S,placement:C,strategy:l,middlewareData:w}};async function eP(t,o){var s;o===void 0&&(o={});const{x:a,y:l,platform:d,rects:h,elements:v,strategy:g}=t,{boundary:E="clippingAncestors",rootBoundary:b="viewport",elementContext:S="floating",altBoundary:C=!1,padding:w=0}=v_(o,t),I=kY(w),N=v[C?S==="floating"?"reference":"floating":S],O=BS(await d.getClippingRect({element:(s=await(d.isElement==null?void 0:d.isElement(N)))==null||s?N:N.contextElement||await(d.getDocumentElement==null?void 0:d.getDocumentElement(v.floating)),boundary:E,rootBoundary:b,strategy:g})),V=S==="floating"?{x:a,y:l,width:h.floating.width,height:h.floating.height}:h.reference,L=await(d.getOffsetParent==null?void 0:d.getOffsetParent(v.floating)),D=await(d.isElement==null?void 0:d.isElement(L))?await(d.getScale==null?void 0:d.getScale(L))||{x:1,y:1}:{x:1,y:1},M=BS(d.convertOffsetParentRelativeRectToViewportRelativeRect?await d.convertOffsetParentRelativeRectToViewportRelativeRect({elements:v,rect:V,offsetParent:L,strategy:g}):V);return{top:(O.top-M.top+I.top)/D.y,bottom:(M.bottom-O.bottom+I.bottom)/D.y,left:(O.left-M.left+I.left)/D.x,right:(M.right-O.right+I.right)/D.x}}const Oxe=t=>({name:"arrow",options:t,async fn(o){const{x:s,y:a,placement:l,rects:d,platform:h,elements:v,middlewareData:g}=o,{element:E,padding:b=0}=v_(t,o)||{};if(E==null)return{};const S=kY(b),C={x:s,y:a},w=Qk(l),I=Zk(w),R=await h.getDimensions(E),N=w==="y",O=N?"top":"left",V=N?"bottom":"right",L=N?"clientHeight":"clientWidth",D=d.reference[I]+d.reference[w]-C[w]-d.floating[I],M=C[w]-d.reference[w],F=await(h.getOffsetParent==null?void 0:h.getOffsetParent(E));let W=F?F[L]:0;(!W||!await(h.isElement==null?void 0:h.isElement(F)))&&(W=v.floating[L]||d.floating[I]);const z=D/2-M/2,G=W/2-R[I]/2-1,Y=nm(S[O],G),te=nm(S[V],G),Z=Y,fe=W-R[I]-te,Ee=W/2-R[I]/2+z,ae=UO(Z,Ee,fe),X=!g.arrow&&g_(l)!=null&&Ee!==ae&&d.reference[I]/2-(Ee<Z?Y:te)-R[I]/2<0,ie=X?Ee<Z?Ee-Z:Ee-fe:0;return{[w]:C[w]+ie,data:{[w]:ae,centerOffset:Ee-ae-ie,...X&&{alignmentOffset:ie}},reset:X}}}),Nxe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(o){var s,a;const{placement:l,middlewareData:d,rects:h,initialPlacement:v,platform:g,elements:E}=o,{mainAxis:b=!0,crossAxis:S=!0,fallbackPlacements:C,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:I="none",flipAlignment:R=!0,...N}=v_(t,o);if((s=d.arrow)!=null&&s.alignmentOffset)return{};const O=Fh(l),V=rm(v),L=Fh(v)===v,D=await(g.isRTL==null?void 0:g.isRTL(E.floating)),M=C||(L||!R?[FS(v)]:Cxe(v)),F=I!=="none";!C&&F&&M.push(...Rxe(v,R,I,D));const W=[v,...M],z=await eP(o,N),G=[];let Y=((a=d.flip)==null?void 0:a.overflows)||[];if(b&&G.push(z[O]),S){const Ee=Txe(l,h,D);G.push(z[Ee[0]],z[Ee[1]])}if(Y=[...Y,{placement:l,overflows:G}],!G.every(Ee=>Ee<=0)){var te,Z;const Ee=(((te=d.flip)==null?void 0:te.index)||0)+1,ae=W[Ee];if(ae)return{data:{index:Ee,overflows:Y},reset:{placement:ae}};let X=(Z=Y.filter(ie=>ie.overflows[0]<=0).sort((ie,se)=>ie.overflows[1]-se.overflows[1])[0])==null?void 0:Z.placement;if(!X)switch(w){case"bestFit":{var fe;const ie=(fe=Y.filter(se=>{if(F){const J=rm(se.placement);return J===V||J==="y"}return!0}).map(se=>[se.placement,se.overflows.filter(J=>J>0).reduce((J,pe)=>J+pe,0)]).sort((se,J)=>se[1]-J[1])[0])==null?void 0:fe[0];ie&&(X=ie);break}case"initialPlacement":X=v;break}if(l!==X)return{reset:{placement:X}}}return{}}}};async function kxe(t,o){const{placement:s,platform:a,elements:l}=t,d=await(a.isRTL==null?void 0:a.isRTL(l.floating)),h=Fh(s),v=g_(s),g=rm(s)==="y",E=["left","top"].includes(h)?-1:1,b=d&&g?-1:1,S=v_(o,t);let{mainAxis:C,crossAxis:w,alignmentAxis:I}=typeof S=="number"?{mainAxis:S,crossAxis:0,alignmentAxis:null}:{mainAxis:S.mainAxis||0,crossAxis:S.crossAxis||0,alignmentAxis:S.alignmentAxis};return v&&typeof I=="number"&&(w=v==="end"?I*-1:I),g?{x:w*b,y:C*E}:{x:C*E,y:w*b}}const Pxe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(o){var s,a;const{x:l,y:d,placement:h,middlewareData:v}=o,g=await kxe(o,t);return h===((s=v.offset)==null?void 0:s.placement)&&(a=v.arrow)!=null&&a.alignmentOffset?{}:{x:l+g.x,y:d+g.y,data:{...g,placement:h}}}}},Dxe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(o){const{x:s,y:a,placement:l}=o,{mainAxis:d=!0,crossAxis:h=!1,limiter:v={fn:N=>{let{x:O,y:V}=N;return{x:O,y:V}}},...g}=v_(t,o),E={x:s,y:a},b=await eP(o,g),S=rm(Fh(l)),C=NY(S);let w=E[C],I=E[S];if(d){const N=C==="y"?"top":"left",O=C==="y"?"bottom":"right",V=w+b[N],L=w-b[O];w=UO(V,w,L)}if(h){const N=S==="y"?"top":"left",O=S==="y"?"bottom":"right",V=I+b[N],L=I-b[O];I=UO(V,I,L)}const R=v.fn({...o,[C]:w,[S]:I});return{...R,data:{x:R.x-s,y:R.y-a,enabled:{[C]:d,[S]:h}}}}}};function N0(){return typeof window<"u"}function Em(t){return PY(t)?(t.nodeName||"").toLowerCase():"#document"}function da(t){var o;return(t==null||(o=t.ownerDocument)==null?void 0:o.defaultView)||window}function El(t){var o;return(o=(PY(t)?t.ownerDocument:t.document)||window.document)==null?void 0:o.documentElement}function PY(t){return N0()?t instanceof Node||t instanceof da(t).Node:!1}function Tc(t){return N0()?t instanceof Element||t instanceof da(t).Element:!1}function ml(t){return N0()?t instanceof HTMLElement||t instanceof da(t).HTMLElement:!1}function a8(t){return!N0()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof da(t).ShadowRoot}function __(t){const{overflow:o,overflowX:s,overflowY:a,display:l}=Cc(t);return/auto|scroll|overlay|hidden|clip/.test(o+a+s)&&!["inline","contents"].includes(l)}function Lxe(t){return["table","td","th"].includes(Em(t))}function k0(t){return[":popover-open",":modal"].some(o=>{try{return t.matches(o)}catch{return!1}})}function tP(t){const o=nP(),s=Tc(t)?Cc(t):t;return["transform","translate","scale","rotate","perspective"].some(a=>s[a]?s[a]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!o&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!o&&(s.filter?s.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(a=>(s.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(s.contain||"").includes(a))}function Mxe(t){let o=pd(t);for(;ml(o)&&!om(o);){if(tP(o))return o;if(k0(o))return null;o=pd(o)}return null}function nP(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function om(t){return["html","body","#document"].includes(Em(t))}function Cc(t){return da(t).getComputedStyle(t)}function P0(t){return Tc(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function pd(t){if(Em(t)==="html")return t;const o=t.assignedSlot||t.parentNode||a8(t)&&t.host||El(t);return a8(o)?o.host:o}function DY(t){const o=pd(t);return om(o)?t.ownerDocument?t.ownerDocument.body:t.body:ml(o)&&__(o)?o:DY(o)}function Xg(t,o,s){var a;o===void 0&&(o=[]),s===void 0&&(s=!0);const l=DY(t),d=l===((a=t.ownerDocument)==null?void 0:a.body),h=da(l);if(d){const v=FO(h);return o.concat(h,h.visualViewport||[],__(l)?l:[],v&&s?Xg(v):[])}return o.concat(l,Xg(l,[],s))}function FO(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function LY(t){const o=Cc(t);let s=parseFloat(o.width)||0,a=parseFloat(o.height)||0;const l=ml(t),d=l?t.offsetWidth:s,h=l?t.offsetHeight:a,v=VS(s)!==d||VS(a)!==h;return v&&(s=d,a=h),{width:s,height:a,$:v}}function rP(t){return Tc(t)?t:t.contextElement}function Vp(t){const o=rP(t);if(!ml(o))return ll(1);const s=o.getBoundingClientRect(),{width:a,height:l,$:d}=LY(o);let h=(d?VS(s.width):s.width)/a,v=(d?VS(s.height):s.height)/l;return(!h||!Number.isFinite(h))&&(h=1),(!v||!Number.isFinite(v))&&(v=1),{x:h,y:v}}const xxe=ll(0);function MY(t){const o=da(t);return!nP()||!o.visualViewport?xxe:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function Uxe(t,o,s){return o===void 0&&(o=!1),!s||o&&s!==da(t)?!1:o}function Bh(t,o,s,a){o===void 0&&(o=!1),s===void 0&&(s=!1);const l=t.getBoundingClientRect(),d=rP(t);let h=ll(1);o&&(a?Tc(a)&&(h=Vp(a)):h=Vp(t));const v=Uxe(d,s,a)?MY(d):ll(0);let g=(l.left+v.x)/h.x,E=(l.top+v.y)/h.y,b=l.width/h.x,S=l.height/h.y;if(d){const C=da(d),w=a&&Tc(a)?da(a):a;let I=C,R=FO(I);for(;R&&a&&w!==I;){const N=Vp(R),O=R.getBoundingClientRect(),V=Cc(R),L=O.left+(R.clientLeft+parseFloat(V.paddingLeft))*N.x,D=O.top+(R.clientTop+parseFloat(V.paddingTop))*N.y;g*=N.x,E*=N.y,b*=N.x,S*=N.y,g+=L,E+=D,I=da(R),R=FO(I)}}return BS({width:b,height:S,x:g,y:E})}function oP(t,o){const s=P0(t).scrollLeft;return o?o.left+s:Bh(El(t)).left+s}function xY(t,o,s){s===void 0&&(s=!1);const a=t.getBoundingClientRect(),l=a.left+o.scrollLeft-(s?0:oP(t,a)),d=a.top+o.scrollTop;return{x:l,y:d}}function Vxe(t){let{elements:o,rect:s,offsetParent:a,strategy:l}=t;const d=l==="fixed",h=El(a),v=o?k0(o.floating):!1;if(a===h||v&&d)return s;let g={scrollLeft:0,scrollTop:0},E=ll(1);const b=ll(0),S=ml(a);if((S||!S&&!d)&&((Em(a)!=="body"||__(h))&&(g=P0(a)),ml(a))){const w=Bh(a);E=Vp(a),b.x=w.x+a.clientLeft,b.y=w.y+a.clientTop}const C=h&&!S&&!d?xY(h,g,!0):ll(0);return{width:s.width*E.x,height:s.height*E.y,x:s.x*E.x-g.scrollLeft*E.x+b.x+C.x,y:s.y*E.y-g.scrollTop*E.y+b.y+C.y}}function Fxe(t){return Array.from(t.getClientRects())}function Bxe(t){const o=El(t),s=P0(t),a=t.ownerDocument.body,l=Nh(o.scrollWidth,o.clientWidth,a.scrollWidth,a.clientWidth),d=Nh(o.scrollHeight,o.clientHeight,a.scrollHeight,a.clientHeight);let h=-s.scrollLeft+oP(t);const v=-s.scrollTop;return Cc(a).direction==="rtl"&&(h+=Nh(o.clientWidth,a.clientWidth)-l),{width:l,height:d,x:h,y:v}}function jxe(t,o){const s=da(t),a=El(t),l=s.visualViewport;let d=a.clientWidth,h=a.clientHeight,v=0,g=0;if(l){d=l.width,h=l.height;const E=nP();(!E||E&&o==="fixed")&&(v=l.offsetLeft,g=l.offsetTop)}return{width:d,height:h,x:v,y:g}}function $xe(t,o){const s=Bh(t,!0,o==="fixed"),a=s.top+t.clientTop,l=s.left+t.clientLeft,d=ml(t)?Vp(t):ll(1),h=t.clientWidth*d.x,v=t.clientHeight*d.y,g=l*d.x,E=a*d.y;return{width:h,height:v,x:g,y:E}}function c8(t,o,s){let a;if(o==="viewport")a=jxe(t,s);else if(o==="document")a=Bxe(El(t));else if(Tc(o))a=$xe(o,s);else{const l=MY(t);a={x:o.x-l.x,y:o.y-l.y,width:o.width,height:o.height}}return BS(a)}function UY(t,o){const s=pd(t);return s===o||!Tc(s)||om(s)?!1:Cc(s).position==="fixed"||UY(s,o)}function Hxe(t,o){const s=o.get(t);if(s)return s;let a=Xg(t,[],!1).filter(v=>Tc(v)&&Em(v)!=="body"),l=null;const d=Cc(t).position==="fixed";let h=d?pd(t):t;for(;Tc(h)&&!om(h);){const v=Cc(h),g=tP(h);!g&&v.position==="fixed"&&(l=null),(d?!g&&!l:!g&&v.position==="static"&&!!l&&["absolute","fixed"].includes(l.position)||__(h)&&!g&&UY(t,h))?a=a.filter(b=>b!==h):l=v,h=pd(h)}return o.set(t,a),a}function Wxe(t){let{element:o,boundary:s,rootBoundary:a,strategy:l}=t;const h=[...s==="clippingAncestors"?k0(o)?[]:Hxe(o,this._c):[].concat(s),a],v=h[0],g=h.reduce((E,b)=>{const S=c8(o,b,l);return E.top=Nh(S.top,E.top),E.right=nm(S.right,E.right),E.bottom=nm(S.bottom,E.bottom),E.left=Nh(S.left,E.left),E},c8(o,v,l));return{width:g.right-g.left,height:g.bottom-g.top,x:g.left,y:g.top}}function Kxe(t){const{width:o,height:s}=LY(t);return{width:o,height:s}}function Gxe(t,o,s){const a=ml(o),l=El(o),d=s==="fixed",h=Bh(t,!0,d,o);let v={scrollLeft:0,scrollTop:0};const g=ll(0);if(a||!a&&!d)if((Em(o)!=="body"||__(l))&&(v=P0(o)),a){const C=Bh(o,!0,d,o);g.x=C.x+o.clientLeft,g.y=C.y+o.clientTop}else l&&(g.x=oP(l));const E=l&&!a&&!d?xY(l,v):ll(0),b=h.left+v.scrollLeft-g.x-E.x,S=h.top+v.scrollTop-g.y-E.y;return{x:b,y:S,width:h.width,height:h.height}}function TA(t){return Cc(t).position==="static"}function l8(t,o){if(!ml(t)||Cc(t).position==="fixed")return null;if(o)return o(t);let s=t.offsetParent;return El(t)===s&&(s=s.ownerDocument.body),s}function VY(t,o){const s=da(t);if(k0(t))return s;if(!ml(t)){let l=pd(t);for(;l&&!om(l);){if(Tc(l)&&!TA(l))return l;l=pd(l)}return s}let a=l8(t,o);for(;a&&Lxe(a)&&TA(a);)a=l8(a,o);return a&&om(a)&&TA(a)&&!tP(a)?s:a||Mxe(t)||s}const zxe=async function(t){const o=this.getOffsetParent||VY,s=this.getDimensions,a=await s(t.floating);return{reference:Gxe(t.reference,await o(t.floating),t.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function Yxe(t){return Cc(t).direction==="rtl"}const qxe={convertOffsetParentRelativeRectToViewportRelativeRect:Vxe,getDocumentElement:El,getClippingRect:Wxe,getOffsetParent:VY,getElementRects:zxe,getClientRects:Fxe,getDimensions:Kxe,getScale:Vp,isElement:Tc,isRTL:Yxe};function FY(t,o){return t.x===o.x&&t.y===o.y&&t.width===o.width&&t.height===o.height}function Xxe(t,o){let s=null,a;const l=El(t);function d(){var v;clearTimeout(a),(v=s)==null||v.disconnect(),s=null}function h(v,g){v===void 0&&(v=!1),g===void 0&&(g=1),d();const E=t.getBoundingClientRect(),{left:b,top:S,width:C,height:w}=E;if(v||o(),!C||!w)return;const I=Mb(S),R=Mb(l.clientWidth-(b+C)),N=Mb(l.clientHeight-(S+w)),O=Mb(b),L={rootMargin:-I+"px "+-R+"px "+-N+"px "+-O+"px",threshold:Nh(0,nm(1,g))||1};let D=!0;function M(F){const W=F[0].intersectionRatio;if(W!==g){if(!D)return h();W?h(!1,W):a=setTimeout(()=>{h(!1,1e-7)},1e3)}W===1&&!FY(E,t.getBoundingClientRect())&&h(),D=!1}try{s=new IntersectionObserver(M,{...L,root:l.ownerDocument})}catch{s=new IntersectionObserver(M,L)}s.observe(t)}return h(!0),d}function Jxe(t,o,s,a){a===void 0&&(a={});const{ancestorScroll:l=!0,ancestorResize:d=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:v=typeof IntersectionObserver=="function",animationFrame:g=!1}=a,E=rP(t),b=l||d?[...E?Xg(E):[],...Xg(o)]:[];b.forEach(O=>{l&&O.addEventListener("scroll",s,{passive:!0}),d&&O.addEventListener("resize",s)});const S=E&&v?Xxe(E,s):null;let C=-1,w=null;h&&(w=new ResizeObserver(O=>{let[V]=O;V&&V.target===E&&w&&(w.unobserve(o),cancelAnimationFrame(C),C=requestAnimationFrame(()=>{var L;(L=w)==null||L.observe(o)})),s()}),E&&!g&&w.observe(E),w.observe(o));let I,R=g?Bh(t):null;g&&N();function N(){const O=Bh(t);R&&!FY(R,O)&&s(),R=O,I=requestAnimationFrame(N)}return s(),()=>{var O;b.forEach(V=>{l&&V.removeEventListener("scroll",s),d&&V.removeEventListener("resize",s)}),S==null||S(),(O=w)==null||O.disconnect(),w=null,g&&cancelAnimationFrame(I)}}const Zxe=eP,BY=Pxe,Qxe=Dxe,eUe=Nxe,jY=Oxe,$Y=(t,o,s)=>{const a=new Map,l={platform:qxe,...s},d={...l.platform,_c:a};return Axe(t,o,{...l,platform:d})},tUe=ut({style:{type:Re([String,Object,Array]),default:()=>({})}}),nUe=me({name:"ElVisuallyHidden"}),rUe=me({...nUe,props:tUe,setup(t){const o=t,s=U(()=>[o.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(a,l)=>($(),le("span",En(a.$attrs,{style:p(s)}),[Ne(a.$slots,"default")],16))}});var oUe=dt(rUe,[["__file","visual-hidden.vue"]]);ut({});const sUe=t=>{if(!Vn)return;if(!t)return t;const o=pi(t);return o||(xr(t)?o:t)},iUe=({middleware:t,placement:o,strategy:s})=>{const a=ee(),l=ee(),d=ee(),h=ee(),v=ee({}),g={x:d,y:h,placement:o,strategy:s,middlewareData:v},E=async()=>{if(!Vn)return;const b=sUe(a),S=pi(l);if(!b||!S)return;const C=await $Y(b,S,{placement:p(o),strategy:p(s),middleware:p(t)});Kp(g).forEach(w=>{g[w].value=C[w]})};return dn(()=>{Ms(()=>{E()})}),{...g,update:E,referenceRef:a,contentRef:l}},aUe=({arrowRef:t,padding:o})=>({name:"arrow",options:{element:t,padding:o},fn(s){const a=p(t);return a?jY({element:a,padding:o}).fn(s):{}}}),cUe=me({name:"ElTooltipV2Content"}),lUe=me({...cUe,props:{...qk,...IY},setup(t){const o=t,{triggerRef:s,contentId:a}=It(O0),l=ee(o.placement),d=ee(o.strategy),h=ee(null),{referenceRef:v,contentRef:g,middlewareData:E,x:b,y:S,update:C}=iUe({placement:l,strategy:d,middleware:U(()=>{const L=[BY(o.offset)];return o.showArrow&&L.push(aUe({arrowRef:h})),L})}),w=fm().nextZIndex(),I=Qe("tooltip-v2"),R=U(()=>l.value.split("-")[0]),N=U(()=>({position:p(d),top:`${p(S)||0}px`,left:`${p(b)||0}px`,zIndex:w})),O=U(()=>{if(!o.showArrow)return{};const{arrow:L}=p(E);return{[`--${I.namespace.value}-tooltip-v2-arrow-x`]:`${L==null?void 0:L.x}px`||"",[`--${I.namespace.value}-tooltip-v2-arrow-y`]:`${L==null?void 0:L.y}px`||""}}),V=U(()=>[I.e("content"),I.is("dark",o.effect==="dark"),I.is(p(d)),o.contentClass]);return ze(h,()=>C()),ze(()=>o.placement,L=>l.value=L),dn(()=>{ze(()=>o.reference||s.value,L=>{v.value=L||void 0},{immediate:!0})}),wn(OY,{arrowRef:h}),(L,D)=>($(),le("div",{ref_key:"contentRef",ref:g,style:jt(p(N)),"data-tooltip-v2-root":""},[L.nowrap?De("v-if",!0):($(),le("div",{key:0,"data-side":p(R),class:K(p(V))},[Ne(L.$slots,"default",{contentStyle:p(N),contentClass:p(V)}),ge(p(oUe),{id:p(a),role:"tooltip"},{default:Ce(()=>[L.ariaLabel?($(),le(Ut,{key:0},[bn(ot(L.ariaLabel),1)],64)):Ne(L.$slots,"default",{key:1})]),_:3},8,["id"]),Ne(L.$slots,"arrow",{style:jt(p(O)),side:p(R)})],10,["data-side"]))],4))}});var u8=dt(lUe,[["__file","content.vue"]]);const uUe=ut({setRef:{type:Re(Function),required:!0},onlyChild:Boolean});var dUe=me({props:uUe,setup(t,{slots:o}){const s=ee(),a=C0(s,l=>{l?t.setRef(l.nextElementSibling):t.setRef(null)});return()=>{var l;const[d]=((l=o.default)==null?void 0:l.call(o))||[],h=t.onlyChild?MCe(d.children):d.children;return ge(Ut,{ref:a},[h])}}});const hUe=me({name:"ElTooltipV2Trigger"}),fUe=me({...hUe,props:{...IY,...Jk},setup(t){const o=t,{onClose:s,onOpen:a,onDelayOpen:l,triggerRef:d,contentId:h}=It(O0);let v=!1;const g=V=>{d.value=V},E=()=>{v=!1},b=Eo(o.onMouseEnter,l),S=Eo(o.onMouseLeave,s),C=Eo(o.onMouseDown,()=>{s(),v=!0,document.addEventListener("mouseup",E,{once:!0})}),w=Eo(o.onFocus,()=>{v||a()}),I=Eo(o.onBlur,s),R=Eo(o.onClick,V=>{V.detail===0&&s()}),N={blur:I,click:R,focus:w,mousedown:C,mouseenter:b,mouseleave:S},O=(V,L,D)=>{V&&Object.entries(L).forEach(([M,F])=>{V[D](M,F)})};return ze(d,(V,L)=>{O(V,N,"addEventListener"),O(L,N,"removeEventListener"),V&&V.setAttribute("aria-describedby",h.value)}),Rr(()=>{O(d.value,N,"removeEventListener"),document.removeEventListener("mouseup",E)}),(V,L)=>V.nowrap?($(),Ve(p(dUe),{key:0,"set-ref":g,"only-child":""},{default:Ce(()=>[Ne(V.$slots,"default")]),_:3})):($(),le("button",En({key:1,ref_key:"triggerRef",ref:d},V.$attrs),[Ne(V.$slots,"default")],16))}});var pUe=dt(fUe,[["__file","trigger.vue"]]);const mUe=me({name:"ElTooltipV2"}),vUe=me({...mUe,props:mxe,setup(t){const s=ds(t),a=er(mc(s,Object.keys(Yk))),l=er(mc(s,Object.keys(qk))),d=er(mc(s,Object.keys(Xk))),h=er(mc(s,Object.keys(Jk)));return(v,g)=>($(),Ve(_xe,sa(ul(d)),{default:Ce(({open:E})=>[ge(pUe,En(h,{nowrap:""}),{default:Ce(()=>[Ne(v.$slots,"trigger")]),_:3},16),ge(p(vm),{to:v.to,disabled:!v.teleported},{default:Ce(()=>[v.fullTransition?($(),Ve(hs,sa(En({key:0},v.transitionProps)),{default:Ce(()=>[v.alwaysOn||E?($(),Ve(u8,sa(En({key:0},l)),{arrow:Ce(({style:b,side:S})=>[v.showArrow?($(),Ve(s8,En({key:0},a,{style:b,side:S}),null,16,["style","side"])):De("v-if",!0)]),default:Ce(()=>[Ne(v.$slots,"default")]),_:3},16)):De("v-if",!0)]),_:2},1040)):($(),le(Ut,{key:1},[v.alwaysOn||E?($(),Ve(u8,sa(En({key:0},l)),{arrow:Ce(({style:b,side:S})=>[v.showArrow?($(),Ve(s8,En({key:0},a,{style:b,side:S}),null,16,["style","side"])):De("v-if",!0)]),default:Ce(()=>[Ne(v.$slots,"default")]),_:3},16)):De("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var gUe=dt(vUe,[["__file","tooltip.vue"]]);const _Ue=rn(gUe),HY="left-check-change",WY="right-check-change",Tp=ut({data:{type:Re(Array),default:()=>[]},titles:{type:Re(Array),default:()=>[]},buttonTexts:{type:Re(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:Re(Function)},leftDefaultChecked:{type:Re(Array),default:()=>[]},rightDefaultChecked:{type:Re(Array),default:()=>[]},renderContent:{type:Re(Function)},modelValue:{type:Re(Array),default:()=>[]},format:{type:Re(Object),default:()=>({})},filterable:Boolean,props:{type:Re(Object),default:()=>lo({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),BO=(t,o)=>[t,o].every(st)||st(t)&&Qo(o),EUe={[yn]:(t,o,s)=>[t,s].every(st)&&["left","right"].includes(o),[Jt]:t=>st(t),[HY]:BO,[WY]:BO},jO="checked-change",yUe=ut({data:Tp.data,optionRender:{type:Re(Function)},placeholder:String,title:String,filterable:Boolean,format:Tp.format,filterMethod:Tp.filterMethod,defaultChecked:Tp.leftDefaultChecked,props:Tp.props}),bUe={[jO]:BO},E_=t=>{const o={label:"label",key:"key",disabled:"disabled"};return U(()=>({...o,...t.props}))},SUe=(t,o,s)=>{const a=E_(t),l=U(()=>t.data.filter(b=>Ft(t.filterMethod)?t.filterMethod(o.query,b):String(b[a.value.label]||b[a.value.key]).toLowerCase().includes(o.query.toLowerCase()))),d=U(()=>l.value.filter(b=>!b[a.value.disabled])),h=U(()=>{const b=o.checked.length,S=t.data.length,{noChecked:C,hasChecked:w}=t.format;return C&&w?b>0?w.replace(/\${checked}/g,b.toString()).replace(/\${total}/g,S.toString()):C.replace(/\${total}/g,S.toString()):`${b}/${S}`}),v=U(()=>{const b=o.checked.length;return b>0&&b<d.value.length}),g=()=>{const b=d.value.map(S=>S[a.value.key]);o.allChecked=b.length>0&&b.every(S=>o.checked.includes(S))},E=b=>{o.checked=b?d.value.map(S=>S[a.value.key]):[]};return ze(()=>o.checked,(b,S)=>{if(g(),o.checkChangeByUser){const C=b.concat(S).filter(w=>!b.includes(w)||!S.includes(w));s(jO,b,C)}else s(jO,b),o.checkChangeByUser=!0}),ze(d,()=>{g()}),ze(()=>t.data,()=>{const b=[],S=l.value.map(C=>C[a.value.key]);o.checked.forEach(C=>{S.includes(C)&&b.push(C)}),o.checkChangeByUser=!1,o.checked=b}),ze(()=>t.defaultChecked,(b,S)=>{if(S&&b.length===S.length&&b.every(I=>S.includes(I)))return;const C=[],w=d.value.map(I=>I[a.value.key]);b.forEach(I=>{w.includes(I)&&C.push(I)}),o.checkChangeByUser=!1,o.checked=C},{immediate:!0}),{filteredData:l,checkableData:d,checkedSummary:h,isIndeterminate:v,updateAllChecked:g,handleAllCheckedChange:E}},TUe=me({name:"ElTransferPanel"}),CUe=me({...TUe,props:yUe,emits:bUe,setup(t,{expose:o,emit:s}){const a=t,l=Jo(),d=({option:L})=>L,{t:h}=Fn(),v=Qe("transfer"),g=er({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),E=E_(a),{filteredData:b,checkedSummary:S,isIndeterminate:C,handleAllCheckedChange:w}=SUe(a,g,s),I=U(()=>!oa(g.query)&&oa(b.value)),R=U(()=>!oa(l.default()[0].children)),{checked:N,allChecked:O,query:V}=ds(g);return o({query:V}),(L,D)=>($(),le("div",{class:K(p(v).b("panel"))},[ue("p",{class:K(p(v).be("panel","header"))},[ge(p(Wa),{modelValue:p(O),"onUpdate:modelValue":M=>xr(O)?O.value=M:null,indeterminate:p(C),"validate-event":!1,onChange:p(w)},{default:Ce(()=>[bn(ot(L.title)+" ",1),ue("span",null,ot(p(S)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),ue("div",{class:K([p(v).be("panel","body"),p(v).is("with-footer",p(R))])},[L.filterable?($(),Ve(p(ei),{key:0,modelValue:p(V),"onUpdate:modelValue":M=>xr(V)?V.value=M:null,class:K(p(v).be("panel","filter")),size:"default",placeholder:L.placeholder,"prefix-icon":p(zye),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):De("v-if",!0),ln(ge(p(gG),{modelValue:p(N),"onUpdate:modelValue":M=>xr(N)?N.value=M:null,"validate-event":!1,class:K([p(v).is("filterable",L.filterable),p(v).be("panel","list")])},{default:Ce(()=>[($(!0),le(Ut,null,Cn(p(b),M=>($(),Ve(p(Wa),{key:M[p(E).key],class:K(p(v).be("panel","item")),value:M[p(E).key],disabled:M[p(E).disabled],"validate-event":!1},{default:Ce(()=>{var F;return[ge(d,{option:(F=L.optionRender)==null?void 0:F.call(L,M)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[Wn,!p(I)&&!p(oa)(L.data)]]),ln(ue("div",{class:K(p(v).be("panel","empty"))},[Ne(L.$slots,"empty",{},()=>[bn(ot(p(I)?p(h)("el.transfer.noMatch"):p(h)("el.transfer.noData")),1)])],2),[[Wn,p(I)||p(oa)(L.data)]])],2),p(R)?($(),le("p",{key:0,class:K(p(v).be("panel","footer"))},[Ne(L.$slots,"default")],2)):De("v-if",!0)],2))}});var d8=dt(CUe,[["__file","transfer-panel.vue"]]);const wUe=t=>{const o=E_(t),s=U(()=>t.data.reduce((d,h)=>(d[h[o.value.key]]=h)&&d,{})),a=U(()=>t.data.filter(d=>!t.modelValue.includes(d[o.value.key]))),l=U(()=>t.targetOrder==="original"?t.data.filter(d=>t.modelValue.includes(d[o.value.key])):t.modelValue.reduce((d,h)=>{const v=s.value[h];return v&&d.push(v),d},[]));return{sourceData:a,targetData:l}},RUe=(t,o,s)=>{const a=E_(t),l=(v,g,E)=>{s(Jt,v),s(yn,v,g,E)};return{addToLeft:()=>{const v=t.modelValue.slice();o.rightChecked.forEach(g=>{const E=v.indexOf(g);E>-1&&v.splice(E,1)}),l(v,"left",o.rightChecked)},addToRight:()=>{let v=t.modelValue.slice();const g=t.data.filter(E=>{const b=E[a.value.key];return o.leftChecked.includes(b)&&!t.modelValue.includes(b)}).map(E=>E[a.value.key]);v=t.targetOrder==="unshift"?g.concat(v):v.concat(g),t.targetOrder==="original"&&(v=t.data.filter(E=>v.includes(E[a.value.key])).map(E=>E[a.value.key])),l(v,"right",o.leftChecked)}}},IUe=(t,o)=>({onSourceCheckedChange:(l,d)=>{t.leftChecked=l,d&&o(HY,l,d)},onTargetCheckedChange:(l,d)=>{t.rightChecked=l,d&&o(WY,l,d)}}),AUe=me({name:"ElTransfer"}),OUe=me({...AUe,props:Tp,emits:EUe,setup(t,{expose:o,emit:s}){const a=t,l=Jo(),{t:d}=Fn(),h=Qe("transfer"),{formItem:v}=Vs(),g=er({leftChecked:[],rightChecked:[]}),E=E_(a),{sourceData:b,targetData:S}=wUe(a),{onSourceCheckedChange:C,onTargetCheckedChange:w}=IUe(g,s),{addToLeft:I,addToRight:R}=RUe(a,g,s),N=ee(),O=ee(),V=z=>{switch(z){case"left":N.value.query="";break;case"right":O.value.query="";break}},L=U(()=>a.buttonTexts.length===2),D=U(()=>a.titles[0]||d("el.transfer.titles.0")),M=U(()=>a.titles[1]||d("el.transfer.titles.1")),F=U(()=>a.filterPlaceholder||d("el.transfer.filterPlaceholder"));ze(()=>a.modelValue,()=>{var z;a.validateEvent&&((z=v==null?void 0:v.validate)==null||z.call(v,"change").catch(G=>void 0))});const W=U(()=>z=>{var G;if(a.renderContent)return a.renderContent(Ht,z);const Y=(((G=l.default)==null?void 0:G.call(l,{option:z}))||[]).filter(te=>te.type!==is);return Y.length?Y:Ht("span",z[E.value.label]||z[E.value.key])});return o({clearQuery:V,leftPanel:N,rightPanel:O}),(z,G)=>($(),le("div",{class:K(p(h).b())},[ge(d8,{ref_key:"leftPanel",ref:N,data:p(b),"option-render":p(W),placeholder:p(F),title:p(D),filterable:z.filterable,format:z.format,"filter-method":z.filterMethod,"default-checked":z.leftDefaultChecked,props:a.props,onCheckedChange:p(C)},{empty:Ce(()=>[Ne(z.$slots,"left-empty")]),default:Ce(()=>[Ne(z.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),ue("div",{class:K(p(h).e("buttons"))},[ge(p(ls),{type:"primary",class:K([p(h).e("button"),p(h).is("with-texts",p(L))]),disabled:p(oa)(g.rightChecked),onClick:p(I)},{default:Ce(()=>[ge(p(Dt),null,{default:Ce(()=>[ge(p(ud))]),_:1}),p(Xn)(z.buttonTexts[0])?De("v-if",!0):($(),le("span",{key:0},ot(z.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),ge(p(ls),{type:"primary",class:K([p(h).e("button"),p(h).is("with-texts",p(L))]),disabled:p(oa)(g.leftChecked),onClick:p(R)},{default:Ce(()=>[p(Xn)(z.buttonTexts[1])?De("v-if",!0):($(),le("span",{key:0},ot(z.buttonTexts[1]),1)),ge(p(Dt),null,{default:Ce(()=>[ge(p(vi))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),ge(d8,{ref_key:"rightPanel",ref:O,data:p(S),"option-render":p(W),placeholder:p(F),filterable:z.filterable,format:z.format,"filter-method":z.filterMethod,title:p(M),"default-checked":z.rightDefaultChecked,props:a.props,onCheckedChange:p(w)},{empty:Ce(()=>[Ne(z.$slots,"right-empty")]),default:Ce(()=>[Ne(z.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var NUe=dt(OUe,[["__file","transfer.vue"]]);const kUe=rn(NUe),Fp="$treeNodeId",h8=function(t,o){!o||o[Fp]||Object.defineProperty(o,Fp,{value:t.id,enumerable:!1,configurable:!1,writable:!1})},sP=(t,o)=>o==null?void 0:o[t||Fp],$O=(t,o,s)=>{const a=t.value.currentNode;s();const l=t.value.currentNode;a!==l&&o("current-change",l?l.data:null,l)},HO=t=>{let o=!0,s=!0,a=!0;for(let l=0,d=t.length;l<d;l++){const h=t[l];(h.checked!==!0||h.indeterminate)&&(o=!1,h.disabled||(a=!1)),(h.checked!==!1||h.indeterminate)&&(s=!1)}return{all:o,none:s,allWithoutDisable:a,half:!o&&!s}},og=function(t){if(t.childNodes.length===0||t.loading)return;const{all:o,none:s,half:a}=HO(t.childNodes);o?(t.checked=!0,t.indeterminate=!1):a?(t.checked=!1,t.indeterminate=!0):s&&(t.checked=!1,t.indeterminate=!1);const l=t.parent;!l||l.level===0||t.store.checkStrictly||og(l)},xb=function(t,o){const s=t.store.props,a=t.data||{},l=s[o];if(Ft(l))return l(a,t);if(Mt(l))return a[l];if(Xn(l)){const d=a[o];return d===void 0?"":d}};let PUe=0,WO=class tS{constructor(o){this.id=PUe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const s in o)zn(o,s)&&(this[s]=o[s]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const o=this.store;if(!o)throw new Error("[Node]store is required!");o.registerNode(this);const s=o.props;if(s&&typeof s.isLeaf<"u"){const d=xb(this,"isLeaf");wr(d)&&(this.isLeafByUser=d)}if(o.lazy!==!0&&this.data?(this.setData(this.data),o.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&o.lazy&&o.defaultExpandAll&&!this.isLeafByUser&&this.expand(),st(this.data)||h8(this,this.data),!this.data)return;const a=o.defaultExpandedKeys,l=o.key;l&&a&&a.includes(this.key)&&this.expand(null,o.autoExpandParent),l&&o.currentNodeKey!==void 0&&this.key===o.currentNodeKey&&(o.currentNode=this,o.currentNode.isCurrent=!0),o.lazy&&o._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(o){st(o)||h8(this,o),this.data=o,this.childNodes=[];let s;this.level===0&&st(this.data)?s=this.data:s=xb(this,"children")||[];for(let a=0,l=s.length;a<l;a++)this.insertChild({data:s[a]})}get label(){return xb(this,"label")}get key(){const o=this.store.key;return this.data?this.data[o]:null}get disabled(){return xb(this,"disabled")}get nextSibling(){const o=this.parent;if(o){const s=o.childNodes.indexOf(this);if(s>-1)return o.childNodes[s+1]}return null}get previousSibling(){const o=this.parent;if(o){const s=o.childNodes.indexOf(this);if(s>-1)return s>0?o.childNodes[s-1]:null}return null}contains(o,s=!0){return(this.childNodes||[]).some(a=>a===o||s&&a.contains(o))}remove(){const o=this.parent;o&&o.removeChild(this)}insertChild(o,s,a){if(!o)throw new Error("InsertChild error: child is required.");if(!(o instanceof tS)){if(!a){const l=this.getChildren(!0);l.includes(o.data)||(Xn(s)||s<0?l.push(o.data):l.splice(s,0,o.data))}Object.assign(o,{parent:this,store:this.store}),o=er(new tS(o)),o instanceof tS&&o.initialize()}o.level=this.level+1,Xn(s)||s<0?this.childNodes.push(o):this.childNodes.splice(s,0,o),this.updateLeafState()}insertBefore(o,s){let a;s&&(a=this.childNodes.indexOf(s)),this.insertChild(o,a)}insertAfter(o,s){let a;s&&(a=this.childNodes.indexOf(s),a!==-1&&(a+=1)),this.insertChild(o,a)}removeChild(o){const s=this.getChildren()||[],a=s.indexOf(o.data);a>-1&&s.splice(a,1);const l=this.childNodes.indexOf(o);l>-1&&(this.store&&this.store.deregisterNode(o),o.parent=null,this.childNodes.splice(l,1)),this.updateLeafState()}removeChildByData(o){let s=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===o){s=this.childNodes[a];break}s&&this.removeChild(s)}expand(o,s){const a=()=>{if(s){let l=this.parent;for(;l.level>0;)l.expanded=!0,l=l.parent}this.expanded=!0,o&&o(),this.childNodes.forEach(l=>{l.canFocus=!0})};this.shouldLoadData()?this.loadData(l=>{st(l)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||og(this),a())}):a()}doCreateChildren(o,s={}){o.forEach(a=>{this.insertChild(Object.assign({data:a},s),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(o=>{o.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const o=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!o||o.length===0;return}this.isLeaf=!1}setChecked(o,s,a,l){if(this.indeterminate=o==="half",this.checked=o===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:h,allWithoutDisable:v}=HO(this.childNodes);!this.isLeaf&&!h&&v&&(this.checked=!1,o=!1);const g=()=>{if(s){const E=this.childNodes;for(let C=0,w=E.length;C<w;C++){const I=E[C];l=l||o!==!1;const R=I.disabled?I.checked:l;I.setChecked(R,s,!0,l)}const{half:b,all:S}=HO(E);S||(this.checked=S,this.indeterminate=b)}};if(this.shouldLoadData()){this.loadData(()=>{g(),og(this)},{checked:o!==!1});return}else g()}const d=this.parent;!d||d.level===0||a||og(d)}getChildren(o=!1){if(this.level===0)return this.data;const s=this.data;if(!s)return null;const a=this.store.props;let l="children";return a&&(l=a.children||"children"),s[l]===void 0&&(s[l]=null),o&&!s[l]&&(s[l]=[]),s[l]}updateChildren(){const o=this.getChildren()||[],s=this.childNodes.map(d=>d.data),a={},l=[];o.forEach((d,h)=>{const v=d[Fp];!!v&&s.findIndex(E=>E[Fp]===v)>=0?a[v]={index:h,data:d}:l.push({index:h,data:d})}),this.store.lazy||s.forEach(d=>{a[d[Fp]]||this.removeChildByData(d)}),l.forEach(({index:d,data:h})=>{this.insertChild({data:h},d)}),this.updateLeafState()}loadData(o,s={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(s).length)){this.loading=!0;const a=d=>{this.childNodes=[],this.doCreateChildren(d,s),this.loaded=!0,this.loading=!1,this.updateLeafState(),o&&o.call(this,d)},l=()=>{this.loading=!1};this.store.load(this,a,l)}else o&&o.call(this)}eachNode(o){const s=[this];for(;s.length;){const a=s.shift();s.unshift(...a.childNodes),o(a)}}reInitChecked(){this.store.checkStrictly||og(this)}};class DUe{constructor(o){this.currentNode=null,this.currentNodeKey=null;for(const s in o)zn(o,s)&&(this[s]=o[s]);this.nodesMap={}}initialize(){if(this.root=new WO({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const o=this.load;o(this.root,s=>{this.root.doCreateChildren(s),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(o){const s=this.filterNodeMethod,a=this.lazy,l=async function(d){const h=d.root?d.root.childNodes:d.childNodes;for(const[v,g]of h.entries())g.visible=s.call(g,o,g.data,g),v%80===0&&v>0&&await Vt(),l(g);if(!d.visible&&h.length){let v=!0;v=!h.some(g=>g.visible),d.root?d.root.visible=v===!1:d.visible=v===!1}o&&d.visible&&!d.isLeaf&&(!a||d.loaded)&&d.expand()};l(this)}setData(o){o!==this.root.data?(this.nodesMap={},this.root.setData(o),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(o){if(o instanceof WO)return o;const s=fn(o)?sP(this.key,o):o;return this.nodesMap[s]||null}insertBefore(o,s){const a=this.getNode(s);a.parent.insertBefore({data:o},a)}insertAfter(o,s){const a=this.getNode(s);a.parent.insertAfter({data:o},a)}remove(o){const s=this.getNode(o);s&&s.parent&&(s===this.currentNode&&(this.currentNode=null),s.parent.removeChild(s))}append(o,s){const a=Ec(s)?this.root:this.getNode(s);a&&a.insertChild({data:o})}_initDefaultCheckedNodes(){const o=this.defaultCheckedKeys||[],s=this.nodesMap;o.forEach(a=>{const l=s[a];l&&l.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(o){(this.defaultCheckedKeys||[]).includes(o.key)&&o.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(o){o!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=o,this._initDefaultCheckedNodes())}registerNode(o){const s=this.key;!o||!o.data||(s?o.key!==void 0&&(this.nodesMap[o.key]=o):this.nodesMap[o.id]=o)}deregisterNode(o){!this.key||!o||!o.data||(o.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[o.key])}getCheckedNodes(o=!1,s=!1){const a=[],l=function(d){(d.root?d.root.childNodes:d.childNodes).forEach(v=>{(v.checked||s&&v.indeterminate)&&(!o||o&&v.isLeaf)&&a.push(v.data),l(v)})};return l(this),a}getCheckedKeys(o=!1){return this.getCheckedNodes(o).map(s=>(s||{})[this.key])}getHalfCheckedNodes(){const o=[],s=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(d=>{d.indeterminate&&o.push(d.data),s(d)})};return s(this),o}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(o=>(o||{})[this.key])}_getAllNodes(){const o=[],s=this.nodesMap;for(const a in s)zn(s,a)&&o.push(s[a]);return o}updateChildren(o,s){const a=this.nodesMap[o];if(!a)return;const l=a.childNodes;for(let d=l.length-1;d>=0;d--){const h=l[d];this.remove(h.data)}for(let d=0,h=s.length;d<h;d++){const v=s[d];this.append(v,a.data)}}_setCheckedKeys(o,s=!1,a){const l=this._getAllNodes().sort((g,E)=>g.level-E.level),d=Object.create(null),h=Object.keys(a);l.forEach(g=>g.setChecked(!1,!1));const v=g=>{g.childNodes.forEach(E=>{var b;d[E.data[o]]=!0,(b=E.childNodes)!=null&&b.length&&v(E)})};for(let g=0,E=l.length;g<E;g++){const b=l[g],S=b.data[o].toString();if(!h.includes(S)){b.checked&&!d[S]&&b.setChecked(!1,!1);continue}if(b.childNodes.length&&v(b),b.isLeaf||this.checkStrictly){b.setChecked(!0,!1);continue}if(b.setChecked(!0,!0),s){b.setChecked(!1,!1);const w=function(I){I.childNodes.forEach(N=>{N.isLeaf||N.setChecked(!1,!1),w(N)})};w(b)}}}setCheckedNodes(o,s=!1){const a=this.key,l={};o.forEach(d=>{l[(d||{})[a]]=!0}),this._setCheckedKeys(a,s,l)}setCheckedKeys(o,s=!1){this.defaultCheckedKeys=o;const a=this.key,l={};o.forEach(d=>{l[d]=!0}),this._setCheckedKeys(a,s,l)}setDefaultExpandedKeys(o){o=o||[],this.defaultExpandedKeys=o,o.forEach(s=>{const a=this.getNode(s);a&&a.expand(null,this.autoExpandParent)})}setChecked(o,s,a){const l=this.getNode(o);l&&l.setChecked(!!s,a)}getCurrentNode(){return this.currentNode}setCurrentNode(o){const s=this.currentNode;s&&(s.isCurrent=!1),this.currentNode=o,this.currentNode.isCurrent=!0}setUserCurrentNode(o,s=!0){const a=o[this.key],l=this.nodesMap[a];this.setCurrentNode(l),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(o,s=!0){if(this.currentNodeKey=o,o==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(o);a&&(this.setCurrentNode(a),s&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const LUe=me({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(t){const o=Qe("tree"),s=It("NodeInstance"),a=It("RootTree");return()=>{const l=t.node,{data:d,store:h}=l;return t.renderContent?t.renderContent(Ht,{_self:s,node:l,data:d,store:h}):Ne(a.ctx.slots,"default",{node:l,data:d},()=>[Ht("span",{class:o.be("node","label")},[l.label])])}}});var MUe=dt(LUe,[["__file","tree-node-content.vue"]]);function KY(t){const o=It("TreeNodeMap",null),s={treeNodeExpand:a=>{t.node!==a&&t.node.collapse()},children:[]};return o&&o.children.push(s),wn("TreeNodeMap",s),{broadcastExpanded:a=>{if(t.accordion)for(const l of s.children)l.treeNodeExpand(a)}}}const GY=Symbol("dragEvents");function xUe({props:t,ctx:o,el$:s,dropIndicator$:a,store:l}){const d=Qe("tree"),h=ee({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return wn(GY,{treeNodeDragStart:({event:b,treeNode:S})=>{if(Ft(t.allowDrag)&&!t.allowDrag(S.node))return b.preventDefault(),!1;b.dataTransfer.effectAllowed="move";try{b.dataTransfer.setData("text/plain","")}catch{}h.value.draggingNode=S,o.emit("node-drag-start",S.node,b)},treeNodeDragOver:({event:b,treeNode:S})=>{const C=S,w=h.value.dropNode;w&&w.node.id!==C.node.id&&ti(w.$el,d.is("drop-inner"));const I=h.value.draggingNode;if(!I||!C)return;let R=!0,N=!0,O=!0,V=!0;Ft(t.allowDrop)&&(R=t.allowDrop(I.node,C.node,"prev"),V=N=t.allowDrop(I.node,C.node,"inner"),O=t.allowDrop(I.node,C.node,"next")),b.dataTransfer.dropEffect=N||R||O?"move":"none",(R||N||O)&&(w==null?void 0:w.node.id)!==C.node.id&&(w&&o.emit("node-drag-leave",I.node,w.node,b),o.emit("node-drag-enter",I.node,C.node,b)),R||N||O?h.value.dropNode=C:h.value.dropNode=null,C.node.nextSibling===I.node&&(O=!1),C.node.previousSibling===I.node&&(R=!1),C.node.contains(I.node,!1)&&(N=!1),(I.node===C.node||I.node.contains(C.node))&&(R=!1,N=!1,O=!1);const L=C.$el.querySelector(`.${d.be("node","content")}`).getBoundingClientRect(),D=s.value.getBoundingClientRect();let M;const F=R?N?.25:O?.45:1:-1,W=O?N?.75:R?.55:0:1;let z=-9999;const G=b.clientY-L.top;G<L.height*F?M="before":G>L.height*W?M="after":N?M="inner":M="none";const Y=C.$el.querySelector(`.${d.be("node","expand-icon")}`).getBoundingClientRect(),te=a.value;M==="before"?z=Y.top-D.top:M==="after"&&(z=Y.bottom-D.top),te.style.top=`${z}px`,te.style.left=`${Y.right-D.left}px`,M==="inner"?Ua(C.$el,d.is("drop-inner")):ti(C.$el,d.is("drop-inner")),h.value.showDropIndicator=M==="before"||M==="after",h.value.allowDrop=h.value.showDropIndicator||V,h.value.dropType=M,o.emit("node-drag-over",I.node,C.node,b)},treeNodeDragEnd:b=>{const{draggingNode:S,dropType:C,dropNode:w}=h.value;if(b.preventDefault(),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),S&&w){const I={data:S.node.data};C!=="none"&&S.node.remove(),C==="before"?w.node.parent.insertBefore(I,w.node):C==="after"?w.node.parent.insertAfter(I,w.node):C==="inner"&&w.node.insertChild(I),C!=="none"&&(l.value.registerNode(I),l.value.key&&S.node.eachNode(R=>{var N;(N=l.value.nodesMap[R.data[l.value.key]])==null||N.setChecked(R.checked,!l.value.checkStrictly)})),ti(w.$el,d.is("drop-inner")),o.emit("node-drag-end",S.node,w.node,C,b),C!=="none"&&o.emit("node-drop",S.node,w.node,C,b)}S&&!w&&o.emit("node-drag-end",S.node,null,C,b),h.value.showDropIndicator=!1,h.value.draggingNode=null,h.value.dropNode=null,h.value.allowDrop=!0}}),{dragState:h}}const UUe=me({name:"ElTreeNode",components:{ElCollapseTransition:S0,ElCheckbox:Wa,NodeContent:MUe,ElIcon:Dt,Loading:hl},props:{node:{type:WO,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(t,o){const s=Qe("tree"),{broadcastExpanded:a}=KY(t),l=It("RootTree"),d=ee(!1),h=ee(!1),v=ee(),g=ee(),E=ee(),b=It(GY),S=mn();wn("NodeInstance",S),t.node.expanded&&(d.value=!0,h.value=!0);const C=l.props.props.children||"children";ze(()=>{var G;const Y=(G=t.node.data)==null?void 0:G[C];return Y&&[...Y]},()=>{t.node.updateChildren()}),ze(()=>t.node.indeterminate,G=>{R(t.node.checked,G)}),ze(()=>t.node.checked,G=>{R(G,t.node.indeterminate)}),ze(()=>t.node.childNodes.length,()=>t.node.reInitChecked()),ze(()=>t.node.expanded,G=>{Vt(()=>d.value=G),G&&(h.value=!0)});const w=G=>sP(l.props.nodeKey,G.data),I=G=>{const Y=t.props.class;if(!Y)return{};let te;if(Ft(Y)){const{data:Z}=G;te=Y(Z,G)}else te=Y;return Mt(te)?{[te]:!0}:te},R=(G,Y)=>{(v.value!==G||g.value!==Y)&&l.ctx.emit("check-change",t.node.data,G,Y),v.value=G,g.value=Y},N=G=>{$O(l.store,l.ctx.emit,()=>{var Y;if((Y=l==null?void 0:l.props)==null?void 0:Y.nodeKey){const Z=w(t.node);l.store.value.setCurrentNodeKey(Z)}else l.store.value.setCurrentNode(t.node)}),l.currentNode.value=t.node,l.props.expandOnClickNode&&V(),(l.props.checkOnClickNode||t.node.isLeaf&&l.props.checkOnClickLeaf)&&!t.node.disabled&&L(!t.node.checked),l.ctx.emit("node-click",t.node.data,t.node,S,G)},O=G=>{var Y;(Y=l.instance.vnode.props)!=null&&Y.onNodeContextmenu&&(G.stopPropagation(),G.preventDefault()),l.ctx.emit("node-contextmenu",G,t.node.data,t.node,S)},V=()=>{t.node.isLeaf||(d.value?(l.ctx.emit("node-collapse",t.node.data,t.node,S),t.node.collapse()):t.node.expand(()=>{o.emit("node-expand",t.node.data,t.node,S)}))},L=G=>{t.node.setChecked(G,!(l!=null&&l.props.checkStrictly)),Vt(()=>{const Y=l.store.value;l.ctx.emit("check",t.node.data,{checkedNodes:Y.getCheckedNodes(),checkedKeys:Y.getCheckedKeys(),halfCheckedNodes:Y.getHalfCheckedNodes(),halfCheckedKeys:Y.getHalfCheckedKeys()})})};return{ns:s,node$:E,tree:l,expanded:d,childNodeRendered:h,oldChecked:v,oldIndeterminate:g,getNodeKey:w,getNodeClass:I,handleSelectChange:R,handleClick:N,handleContextMenu:O,handleExpandIconClick:V,handleCheckChange:L,handleChildNodeExpand:(G,Y,te)=>{a(Y),l.ctx.emit("node-expand",G,Y,te)},handleDragStart:G=>{l.props.draggable&&b.treeNodeDragStart({event:G,treeNode:t})},handleDragOver:G=>{G.preventDefault(),l.props.draggable&&b.treeNodeDragOver({event:G,treeNode:{$el:E.value,node:t.node}})},handleDrop:G=>{G.preventDefault()},handleDragEnd:G=>{l.props.draggable&&b.treeNodeDragEnd(G)},CaretRight:gK}}});function VUe(t,o,s,a,l,d){const h=_n("el-icon"),v=_n("el-checkbox"),g=_n("loading"),E=_n("node-content"),b=_n("el-tree-node"),S=_n("el-collapse-transition");return ln(($(),le("div",{ref:"node$",class:K([t.ns.b("node"),t.ns.is("expanded",t.expanded),t.ns.is("current",t.node.isCurrent),t.ns.is("hidden",!t.node.visible),t.ns.is("focusable",!t.node.disabled),t.ns.is("checked",!t.node.disabled&&t.node.checked),t.getNodeClass(t.node)]),role:"treeitem",tabindex:"-1","aria-expanded":t.expanded,"aria-disabled":t.node.disabled,"aria-checked":t.node.checked,draggable:t.tree.props.draggable,"data-key":t.getNodeKey(t.node),onClick:Gt(t.handleClick,["stop"]),onContextmenu:t.handleContextMenu,onDragstart:Gt(t.handleDragStart,["stop"]),onDragover:Gt(t.handleDragOver,["stop"]),onDragend:Gt(t.handleDragEnd,["stop"]),onDrop:Gt(t.handleDrop,["stop"])},[ue("div",{class:K(t.ns.be("node","content")),style:jt({paddingLeft:(t.node.level-1)*t.tree.props.indent+"px"})},[t.tree.props.icon||t.CaretRight?($(),Ve(h,{key:0,class:K([t.ns.be("node","expand-icon"),t.ns.is("leaf",t.node.isLeaf),{expanded:!t.node.isLeaf&&t.expanded}]),onClick:Gt(t.handleExpandIconClick,["stop"])},{default:Ce(()=>[($(),Ve(gn(t.tree.props.icon||t.CaretRight)))]),_:1},8,["class","onClick"])):De("v-if",!0),t.showCheckbox?($(),Ve(v,{key:1,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:!!t.node.disabled,onClick:Gt(()=>{},["stop"]),onChange:t.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):De("v-if",!0),t.node.loading?($(),Ve(h,{key:2,class:K([t.ns.be("node","loading-icon"),t.ns.is("loading")])},{default:Ce(()=>[ge(g)]),_:1},8,["class"])):De("v-if",!0),ge(E,{node:t.node,"render-content":t.renderContent},null,8,["node","render-content"])],6),ge(S,null,{default:Ce(()=>[!t.renderAfterExpand||t.childNodeRendered?ln(($(),le("div",{key:0,class:K(t.ns.be("node","children")),role:"group","aria-expanded":t.expanded},[($(!0),le(Ut,null,Cn(t.node.childNodes,C=>($(),Ve(b,{key:t.getNodeKey(C),"render-content":t.renderContent,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,node:C,accordion:t.accordion,props:t.props,onNodeExpand:t.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[Wn,t.expanded]]):De("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[Wn,t.node.visible]])}var FUe=dt(UUe,[["render",VUe],["__file","tree-node.vue"]]);function BUe({el$:t},o){const s=Qe("tree"),a=Mr([]),l=Mr([]);dn(()=>{h()}),wc(()=>{a.value=Array.from(t.value.querySelectorAll("[role=treeitem]")),l.value=Array.from(t.value.querySelectorAll("input[type=checkbox]"))}),ze(l,v=>{v.forEach(g=>{g.setAttribute("tabindex","-1")})}),gr(t,"keydown",v=>{const g=v.target;if(!g.className.includes(s.b("node")))return;const E=v.code;a.value=Array.from(t.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`));const b=a.value.indexOf(g);let S;if([Ct.up,Ct.down].includes(E)){if(v.preventDefault(),E===Ct.up){S=b===-1?0:b!==0?b-1:a.value.length-1;const w=S;for(;!o.value.getNode(a.value[S].dataset.key).canFocus;){if(S--,S===w){S=-1;break}S<0&&(S=a.value.length-1)}}else{S=b===-1?0:b<a.value.length-1?b+1:0;const w=S;for(;!o.value.getNode(a.value[S].dataset.key).canFocus;){if(S++,S===w){S=-1;break}S>=a.value.length&&(S=0)}}S!==-1&&a.value[S].focus()}[Ct.left,Ct.right].includes(E)&&(v.preventDefault(),g.click());const C=g.querySelector('[type="checkbox"]');[Ct.enter,Ct.numpadEnter,Ct.space].includes(E)&&C&&(v.preventDefault(),C.click())});const h=()=>{var v;a.value=Array.from(t.value.querySelectorAll(`.${s.is("focusable")}[role=treeitem]`)),l.value=Array.from(t.value.querySelectorAll("input[type=checkbox]"));const g=t.value.querySelectorAll(`.${s.is("checked")}[role=treeitem]`);if(g.length){g[0].setAttribute("tabindex","0");return}(v=a.value[0])==null||v.setAttribute("tabindex","0")}}const jUe=me({name:"ElTree",components:{ElTreeNode:FUe},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkOnClickLeaf:{type:Boolean,default:!0},checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:yr}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(t,o){const{t:s}=Fn(),a=Qe("tree"),l=It(_m,null),d=ee(new DUe({key:t.nodeKey,data:t.data,lazy:t.lazy,props:t.props,load:t.load,currentNodeKey:t.currentNodeKey,checkStrictly:t.checkStrictly,checkDescendants:t.checkDescendants,defaultCheckedKeys:t.defaultCheckedKeys,defaultExpandedKeys:t.defaultExpandedKeys,autoExpandParent:t.autoExpandParent,defaultExpandAll:t.defaultExpandAll,filterNodeMethod:t.filterNodeMethod}));d.value.initialize();const h=ee(d.value.root),v=ee(null),g=ee(null),E=ee(null),{broadcastExpanded:b}=KY(t),{dragState:S}=xUe({props:t,ctx:o,el$:g,dropIndicator$:E,store:d});BUe({el$:g},d);const C=U(()=>{const{childNodes:se}=h.value,J=l?l.hasFilteredOptions!==0:!1;return(!se||se.length===0||se.every(({visible:pe})=>!pe))&&!J});ze(()=>t.currentNodeKey,se=>{d.value.setCurrentNodeKey(se)}),ze(()=>t.defaultCheckedKeys,se=>{d.value.setDefaultCheckedKey(se)}),ze(()=>t.defaultExpandedKeys,se=>{d.value.setDefaultExpandedKeys(se)}),ze(()=>t.data,se=>{d.value.setData(se)},{deep:!0}),ze(()=>t.checkStrictly,se=>{d.value.checkStrictly=se});const w=se=>{if(!t.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");d.value.filter(se)},I=se=>sP(t.nodeKey,se.data),R=se=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const J=d.value.getNode(se);if(!J)return[];const pe=[J.data];let be=J.parent;for(;be&&be!==h.value;)pe.push(be.data),be=be.parent;return pe.reverse()},N=(se,J)=>d.value.getCheckedNodes(se,J),O=se=>d.value.getCheckedKeys(se),V=()=>{const se=d.value.getCurrentNode();return se?se.data:null},L=()=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const se=V();return se?se[t.nodeKey]:null},D=(se,J)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");d.value.setCheckedNodes(se,J)},M=(se,J)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");d.value.setCheckedKeys(se,J)},F=(se,J,pe)=>{d.value.setChecked(se,J,pe)},W=()=>d.value.getHalfCheckedNodes(),z=()=>d.value.getHalfCheckedKeys(),G=(se,J=!0)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");$O(d,o.emit,()=>{b(se),d.value.setUserCurrentNode(se,J)})},Y=(se,J=!0)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");$O(d,o.emit,()=>{b(),d.value.setCurrentNodeKey(se,J)})},te=se=>d.value.getNode(se),Z=se=>{d.value.remove(se)},fe=(se,J)=>{d.value.append(se,J)},Ee=(se,J)=>{d.value.insertBefore(se,J)},ae=(se,J)=>{d.value.insertAfter(se,J)},X=(se,J,pe)=>{b(J),o.emit("node-expand",se,J,pe)},ie=(se,J)=>{if(!t.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");d.value.updateChildren(se,J)};return wn("RootTree",{ctx:o,props:t,store:d,root:h,currentNode:v,instance:mn()}),wn(fl,void 0),{ns:a,store:d,root:h,currentNode:v,dragState:S,el$:g,dropIndicator$:E,isEmpty:C,filter:w,getNodeKey:I,getNodePath:R,getCheckedNodes:N,getCheckedKeys:O,getCurrentNode:V,getCurrentKey:L,setCheckedNodes:D,setCheckedKeys:M,setChecked:F,getHalfCheckedNodes:W,getHalfCheckedKeys:z,setCurrentNode:G,setCurrentKey:Y,t:s,getNode:te,remove:Z,append:fe,insertBefore:Ee,insertAfter:ae,handleNodeExpand:X,updateKeyChildren:ie}}});function $Ue(t,o,s,a,l,d){const h=_n("el-tree-node");return $(),le("div",{ref:"el$",class:K([t.ns.b(),t.ns.is("dragging",!!t.dragState.draggingNode),t.ns.is("drop-not-allow",!t.dragState.allowDrop),t.ns.is("drop-inner",t.dragState.dropType==="inner"),{[t.ns.m("highlight-current")]:t.highlightCurrent}]),role:"tree"},[($(!0),le(Ut,null,Cn(t.root.childNodes,v=>($(),Ve(h,{key:t.getNodeKey(v),node:v,props:t.props,accordion:t.accordion,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,"render-content":t.renderContent,onNodeExpand:t.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),t.isEmpty?($(),le("div",{key:0,class:K(t.ns.e("empty-block"))},[Ne(t.$slots,"empty",{},()=>{var v;return[ue("span",{class:K(t.ns.e("empty-text"))},ot((v=t.emptyText)!=null?v:t.t("el.tree.emptyText")),3)]})],2)):De("v-if",!0),ln(ue("div",{ref:"dropIndicator$",class:K(t.ns.e("drop-indicator"))},null,2),[[Wn,t.dragState.showDropIndicator]])],2)}var HUe=dt(jUe,[["render",$Ue],["__file","tree.vue"]]);const jS=rn(HUe),WUe=(t,{attrs:o,emit:s},{select:a,tree:l,key:d})=>{const h=Qe("tree-select");return ze(()=>t.data,()=>{t.filterable&&Vt(()=>{var g,E;(E=l.value)==null||E.filter((g=a.value)==null?void 0:g.states.inputValue)})},{flush:"post"}),{...mc(ds(t),Object.keys(Uh.props)),...o,class:U(()=>o.class),style:U(()=>o.style),"onUpdate:modelValue":g=>s(Jt,g),valueKey:d,popperClass:U(()=>{const g=[h.e("popper")];return t.popperClass&&g.push(t.popperClass),g.join(" ")}),filterMethod:(g="")=>{var E;t.filterMethod?t.filterMethod(g):t.remoteMethod?t.remoteMethod(g):(E=l.value)==null||E.filter(g)}}},KUe=me({extends:OS,setup(t,o){const s=OS.setup(t,o);delete s.selectOptionClick;const a=mn().proxy;return Vt(()=>{s.select.states.cachedOptions.get(a.value)||s.select.onOptionCreate(a)}),ze(()=>o.attrs.visible,l=>{Vt(()=>{s.states.visible=l})},{immediate:!0}),s},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function KO(t){return t||t===0}function iP(t){return st(t)&&t.length}function _p(t){return st(t)?t:KO(t)?[t]:[]}function nS(t,o,s,a,l){for(let d=0;d<t.length;d++){const h=t[d];if(o(h,d,t,l))return a?a(h,d,t,l):h;{const v=s(h);if(iP(v)){const g=nS(v,o,s,a,h);if(g)return g}}}}function rS(t,o,s,a){for(let l=0;l<t.length;l++){const d=t[l];o(d,l,t,a);const h=s(d);iP(h)&&rS(h,o,s,d)}}const GUe=(t,{attrs:o,slots:s,emit:a},{select:l,tree:d,key:h})=>{ze(()=>t.modelValue,()=>{t.showCheckbox&&Vt(()=>{const C=d.value;C&&!as(C.getCheckedKeys(),_p(t.modelValue))&&C.setCheckedKeys(_p(t.modelValue))})},{immediate:!0,deep:!0});const v=U(()=>({value:h.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...t.props})),g=(C,w)=>{var I;const R=v.value[C];return Ft(R)?R(w,(I=d.value)==null?void 0:I.getNode(g("value",w))):w[R]},E=_p(t.modelValue).map(C=>nS(t.data||[],w=>g("value",w)===C,w=>g("children",w),(w,I,R,N)=>N&&g("value",N))).filter(C=>KO(C)),b=U(()=>{if(!t.renderAfterExpand&&!t.lazy)return[];const C=[];return rS(t.data.concat(t.cacheData),w=>{const I=g("value",w);C.push({value:I,currentLabel:g("label",w),isDisabled:g("disabled",w)})},w=>g("children",w)),C}),S=()=>{var C;return(C=d.value)==null?void 0:C.getCheckedKeys().filter(w=>{var I;const R=(I=d.value)==null?void 0:I.getNode(w);return!Qo(R)&&oa(R.childNodes)})};return{...mc(ds(t),Object.keys(jS.props)),...o,nodeKey:h,expandOnClickNode:U(()=>!t.checkStrictly&&t.expandOnClickNode),defaultExpandedKeys:U(()=>t.defaultExpandedKeys?t.defaultExpandedKeys.concat(E):E),renderContent:(C,{node:w,data:I,store:R})=>C(KUe,{value:g("value",I),label:g("label",I),disabled:g("disabled",I),visible:w.visible},t.renderContent?()=>t.renderContent(C,{node:w,data:I,store:R}):s.default?()=>s.default({node:w,data:I,store:R}):void 0),filterNodeMethod:(C,w,I)=>t.filterNodeMethod?t.filterNodeMethod(C,w,I):C?new RegExp(pk(C),"i").test(g("label",w)||""):!0,onNodeClick:(C,w,I)=>{var R,N,O,V;if((R=o.onNodeClick)==null||R.call(o,C,w,I),!(t.showCheckbox&&t.checkOnClickNode)){if(!t.showCheckbox&&(t.checkStrictly||w.isLeaf)){if(!g("disabled",C)){const L=(N=l.value)==null?void 0:N.states.options.get(g("value",C));(O=l.value)==null||O.handleOptionSelect(L)}}else t.expandOnClickNode&&I.proxy.handleExpandIconClick();(V=l.value)==null||V.focus()}},onCheck:(C,w)=>{var I;if(!t.showCheckbox)return;const R=g("value",C),N={};rS([d.value.store.root],D=>N[D.key]=D,D=>D.childNodes);const O=w.checkedKeys,V=t.multiple?_p(t.modelValue).filter(D=>!(D in N)&&!O.includes(D)):[],L=V.concat(O);if(t.checkStrictly)a(Jt,t.multiple?L:L.includes(R)?R:void 0);else if(t.multiple){const D=S();a(Jt,V.concat(D))}else{const D=nS([C],W=>!iP(g("children",W))&&!g("disabled",W),W=>g("children",W)),M=D?g("value",D):void 0,F=KO(t.modelValue)&&!!nS([C],W=>g("value",W)===t.modelValue,W=>g("children",W));a(Jt,M===t.modelValue||F?void 0:M)}Vt(()=>{var D;const M=_p(t.modelValue);d.value.setCheckedKeys(M),(D=o.onCheck)==null||D.call(o,C,{checkedKeys:d.value.getCheckedKeys(),checkedNodes:d.value.getCheckedNodes(),halfCheckedKeys:d.value.getHalfCheckedKeys(),halfCheckedNodes:d.value.getHalfCheckedNodes()})}),(I=l.value)==null||I.focus()},onNodeExpand:(C,w,I)=>{var R;(R=o.onNodeExpand)==null||R.call(o,C,w,I),Vt(()=>{if(!t.checkStrictly&&t.lazy&&t.multiple&&w.checked){const N={},O=d.value.getCheckedKeys();rS([d.value.store.root],D=>N[D.key]=D,D=>D.childNodes);const V=_p(t.modelValue).filter(D=>!(D in N)&&!O.includes(D)),L=S();a(Jt,V.concat(L))}})},cacheOptions:b}};var zUe=me({props:{data:{type:Array,default:()=>[]}},setup(t){const o=It(_m);return ze(()=>t.data,()=>{var s;t.data.forEach(l=>{o.states.cachedOptions.has(l.value)||o.states.cachedOptions.set(l.value,l)});const a=((s=o.selectRef)==null?void 0:s.querySelectorAll("input"))||[];Vn&&!Array.from(a).includes(document.activeElement)&&o.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const YUe=me({name:"ElTreeSelect",inheritAttrs:!1,props:{...Uh.props,...jS.props,cacheData:{type:Array,default:()=>[]}},setup(t,o){const{slots:s,expose:a}=o,l=ee(),d=ee(),h=U(()=>t.nodeKey||t.valueKey||"value"),v=WUe(t,o,{select:l,tree:d,key:h}),{cacheOptions:g,...E}=GUe(t,o,{select:l,tree:d,key:h}),b=er({});return a(b),dn(()=>{Object.assign(b,{...mc(d.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...mc(l.value,["focus","blur","selectedLabel"])})}),()=>Ht(Uh,er({...v,ref:S=>l.value=S}),{...s,default:()=>[Ht(zUe,{data:g.value}),Ht(jS,er({...E,ref:S=>d.value=S}))]})}});var qUe=dt(YUe,[["__file","tree-select.vue"]]);const XUe=rn(qUe),aP=Symbol(),JUe={key:-1,level:-1,data:{}};var sg=(t=>(t.KEY="id",t.LABEL="label",t.CHILDREN="children",t.DISABLED="disabled",t.CLASS="",t))(sg||{}),GO=(t=>(t.ADD="add",t.DELETE="delete",t))(GO||{});const zY={type:Number,default:26},ZUe=ut({data:{type:Re(Array),default:()=>lo([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:Re(Object),default:()=>lo({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Re(Array),default:()=>lo([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:Re(Array),default:()=>lo([])},indent:{type:Number,default:16},itemSize:zY,icon:{type:yr},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},checkOnClickLeaf:{type:Boolean,default:!0},currentNodeKey:{type:Re([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:Re(Function)},perfMode:{type:Boolean,default:!0}}),QUe=ut({node:{type:Re(Object),default:()=>lo(JUe)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:zY}),eVe=ut({node:{type:Re(Object),required:!0}}),YY="node-click",qY="node-drop",XY="node-expand",JY="node-collapse",ZY="current-change",QY="check",eq="check-change",tq="node-contextmenu",tVe={[YY]:(t,o,s)=>t&&o&&s,[qY]:(t,o,s)=>t&&o&&s,[XY]:(t,o)=>t&&o,[JY]:(t,o)=>t&&o,[ZY]:(t,o)=>t&&o,[QY]:(t,o)=>t&&o,[eq]:(t,o)=>t&&wr(o),[tq]:(t,o,s)=>t&&o&&s},nVe={click:(t,o)=>!!(t&&o),drop:(t,o)=>!!(t&&o),toggle:t=>!!t,check:(t,o)=>t&&wr(o)};function rVe(t,o){const s=ee(new Set),a=ee(new Set),{emit:l}=mn();ze([()=>o.value,()=>t.defaultCheckedKeys],()=>Vt(()=>{V(t.defaultCheckedKeys)}),{immediate:!0});const d=()=>{if(!o.value||!t.showCheckbox||t.checkStrictly)return;const{levelTreeNodeMap:L,maxLevel:D}=o.value,M=s.value,F=new Set;for(let W=D-1;W>=1;--W){const z=L.get(W);z&&z.forEach(G=>{const Y=G.children;if(Y){let te=!0,Z=!1;for(const fe of Y){const Ee=fe.key;if(M.has(Ee))Z=!0;else if(F.has(Ee)){te=!1,Z=!0;break}else te=!1}te?M.add(G.key):Z?(F.add(G.key),M.delete(G.key)):(M.delete(G.key),F.delete(G.key))}})}a.value=F},h=L=>s.value.has(L.key),v=L=>a.value.has(L.key),g=(L,D,M=!0,F=!0)=>{const W=s.value,z=(G,Y)=>{W[Y?GO.ADD:GO.DELETE](G.key);const te=G.children;!t.checkStrictly&&te&&te.forEach(Z=>{Z.disabled||z(Z,Y)})};z(L,D),F&&d(),M&&E(L,D)},E=(L,D)=>{const{checkedNodes:M,checkedKeys:F}=I(),{halfCheckedNodes:W,halfCheckedKeys:z}=R();l(QY,L.data,{checkedKeys:F,checkedNodes:M,halfCheckedKeys:z,halfCheckedNodes:W}),l(eq,L.data,D)};function b(L=!1){return I(L).checkedKeys}function S(L=!1){return I(L).checkedNodes}function C(){return R().halfCheckedKeys}function w(){return R().halfCheckedNodes}function I(L=!1){const D=[],M=[];if(o!=null&&o.value&&t.showCheckbox){const{treeNodeMap:F}=o.value;s.value.forEach(W=>{const z=F.get(W);z&&(!L||L&&z.isLeaf)&&(M.push(W),D.push(z.data))})}return{checkedKeys:M,checkedNodes:D}}function R(){const L=[],D=[];if(o!=null&&o.value&&t.showCheckbox){const{treeNodeMap:M}=o.value;a.value.forEach(F=>{const W=M.get(F);W&&(D.push(F),L.push(W.data))})}return{halfCheckedNodes:L,halfCheckedKeys:D}}function N(L){s.value.clear(),a.value.clear(),Vt(()=>{V(L)})}function O(L,D){if(o!=null&&o.value&&t.showCheckbox){const M=o.value.treeNodeMap.get(L);M&&g(M,D,!1)}}function V(L){if(o!=null&&o.value){const{treeNodeMap:D}=o.value;if(t.showCheckbox&&D&&(L==null?void 0:L.length)>0){for(const M of L){const F=D.get(M);F&&!h(F)&&g(F,!0,!1,!1)}d()}}}return{updateCheckedKeys:d,toggleCheckbox:g,isChecked:h,isIndeterminate:v,getCheckedKeys:b,getCheckedNodes:S,getHalfCheckedKeys:C,getHalfCheckedNodes:w,setChecked:O,setCheckedKeys:N}}function oVe(t,o){const s=ee(new Set([])),a=ee(new Set([])),l=U(()=>Ft(t.filterMethod));function d(v){var g;if(!l.value)return;const E=new Set,b=a.value,S=s.value,C=[],w=((g=o.value)==null?void 0:g.treeNodes)||[],I=t.filterMethod;S.clear();function R(N){N.forEach(O=>{C.push(O),I!=null&&I(v,O.data,O)?C.forEach(L=>{E.add(L.key)}):O.isLeaf&&S.add(O.key);const V=O.children;if(V&&R(V),!O.isLeaf){if(!E.has(O.key))S.add(O.key);else if(V){let L=!0;for(const D of V)if(!S.has(D.key)){L=!1;break}L?b.add(O.key):b.delete(O.key)}}C.pop()})}return R(w),E}function h(v){return a.value.has(v.key)}return{hiddenExpandIconKeySet:a,hiddenNodeKeySet:s,doFilter:d,isForceHiddenExpandIcon:h}}function sVe(t,o){const s=ee(new Set(t.defaultExpandedKeys)),a=ee(),l=Mr(),d=ee();ze(()=>t.currentNodeKey,ce=>{a.value=ce},{immediate:!0}),ze(()=>t.data,ce=>{He(ce)},{immediate:!0});const{isIndeterminate:h,isChecked:v,toggleCheckbox:g,getCheckedKeys:E,getCheckedNodes:b,getHalfCheckedKeys:S,getHalfCheckedNodes:C,setChecked:w,setCheckedKeys:I}=rVe(t,l),{doFilter:R,hiddenNodeKeySet:N,isForceHiddenExpandIcon:O}=oVe(t,l),V=U(()=>{var ce;return((ce=t.props)==null?void 0:ce.value)||sg.KEY}),L=U(()=>{var ce;return((ce=t.props)==null?void 0:ce.children)||sg.CHILDREN}),D=U(()=>{var ce;return((ce=t.props)==null?void 0:ce.disabled)||sg.DISABLED}),M=U(()=>{var ce;return((ce=t.props)==null?void 0:ce.label)||sg.LABEL}),F=U(()=>{var ce;const Se=s.value,je=N.value,tt=[],et=((ce=l.value)==null?void 0:ce.treeNodes)||[],Ge=[];for(let Xe=et.length-1;Xe>=0;--Xe)Ge.push(et[Xe]);for(;Ge.length;){const Xe=Ge.pop();if(!je.has(Xe.key)&&(tt.push(Xe),Xe.children&&Se.has(Xe.key)))for(let Ye=Xe.children.length-1;Ye>=0;--Ye)Ge.push(Xe.children[Ye])}return tt}),W=U(()=>F.value.length>0);function z(ce){const Se=new Map,je=new Map;let tt=1;function et(Xe,Ye=1,ct=void 0){var nt;const Ot=[];for(const _t of Xe){const qe=te(_t),wt={level:Ye,key:qe,data:_t};wt.label=fe(_t),wt.parent=ct;const qt=Y(_t);wt.disabled=Z(_t),wt.isLeaf=!qt||qt.length===0,qt&&qt.length&&(wt.children=et(qt,Ye+1,wt)),Ot.push(wt),Se.set(qe,wt),je.has(Ye)||je.set(Ye,[]),(nt=je.get(Ye))==null||nt.push(wt)}return Ye>tt&&(tt=Ye),Ot}const Ge=et(ce);return{treeNodeMap:Se,levelTreeNodeMap:je,maxLevel:tt,treeNodes:Ge}}function G(ce){const Se=R(ce);Se&&(s.value=Se)}function Y(ce){return ce[L.value]}function te(ce){return ce?ce[V.value]:""}function Z(ce){return ce[D.value]}function fe(ce){return ce[M.value]}function Ee(ce){s.value.has(ce.key)?be(ce):pe(ce)}function ae(ce){const Se=new Set,je=l.value.treeNodeMap;ce.forEach(tt=>{let et=je.get(tt);for(;et&&!Se.has(et.key);)Se.add(et.key),et=et.parent}),s.value=Se}function X(ce,Se){o(YY,ce.data,ce,Se),se(ce),t.expandOnClickNode&&Ee(ce),t.showCheckbox&&(t.checkOnClickNode||ce.isLeaf&&t.checkOnClickLeaf)&&!ce.disabled&&g(ce,!v(ce),!0)}function ie(ce,Se){o(qY,ce.data,ce,Se)}function se(ce){Me(ce)||(a.value=ce.key,o(ZY,ce.data,ce))}function J(ce,Se){g(ce,Se)}function pe(ce){const Se=s.value;if(l.value&&t.accordion){const{treeNodeMap:je}=l.value;Se.forEach(tt=>{const et=je.get(tt);ce&&ce.level===(et==null?void 0:et.level)&&Se.delete(tt)})}Se.add(ce.key),o(XY,ce.data,ce)}function be(ce){s.value.delete(ce.key),o(JY,ce.data,ce)}function Ae(ce){return s.value.has(ce.key)}function _e(ce){return!!ce.disabled}function Me(ce){const Se=a.value;return Se!==void 0&&Se===ce.key}function Fe(){var ce,Se;if(a.value)return(Se=(ce=l.value)==null?void 0:ce.treeNodeMap.get(a.value))==null?void 0:Se.data}function Le(){return a.value}function Pe(ce){a.value=ce}function He(ce){Vt(()=>l.value=z(ce))}function We(ce){var Se;const je=fn(ce)?te(ce):ce;return(Se=l.value)==null?void 0:Se.treeNodeMap.get(je)}function yt(ce,Se="auto"){const je=We(ce);je&&d.value&&d.value.scrollToItem(F.value.indexOf(je),Se)}function it(ce){var Se;(Se=d.value)==null||Se.scrollTo(ce)}return{tree:l,flattenTree:F,isNotEmpty:W,listRef:d,getKey:te,getChildren:Y,toggleExpand:Ee,toggleCheckbox:g,isExpanded:Ae,isChecked:v,isIndeterminate:h,isDisabled:_e,isCurrent:Me,isForceHiddenExpandIcon:O,handleNodeClick:X,handleNodeDrop:ie,handleNodeCheck:J,getCurrentNode:Fe,getCurrentKey:Le,setCurrentKey:Pe,getCheckedKeys:E,getCheckedNodes:b,getHalfCheckedKeys:S,getHalfCheckedNodes:C,setChecked:w,setCheckedKeys:I,filter:G,setData:He,getNode:We,expandNode:pe,collapseNode:be,setExpandedKeys:ae,scrollToNode:yt,scrollTo:it}}var iVe=me({name:"ElTreeNodeContent",props:eVe,setup(t){const o=It(aP),s=Qe("tree");return()=>{const a=t.node,{data:l}=a;return o!=null&&o.ctx.slots.default?o.ctx.slots.default({node:a,data:l}):Ht("span",{class:s.be("node","label")},[a==null?void 0:a.label])}}});const aVe=me({name:"ElTreeNode"}),cVe=me({...aVe,props:QUe,emits:nVe,setup(t,{emit:o}){const s=t,a=It(aP),l=Qe("tree"),d=U(()=>{var w;return(w=a==null?void 0:a.props.indent)!=null?w:16}),h=U(()=>{var w;return(w=a==null?void 0:a.props.icon)!=null?w:gK}),v=w=>{const I=a==null?void 0:a.props.props.class;if(!I)return{};let R;if(Ft(I)){const{data:N}=w;R=I(N,w)}else R=I;return Mt(R)?{[R]:!0}:R},g=w=>{o("click",s.node,w)},E=w=>{o("drop",s.node,w)},b=()=>{o("toggle",s.node)},S=w=>{o("check",s.node,w)},C=w=>{var I,R,N,O;(N=(R=(I=a==null?void 0:a.instance)==null?void 0:I.vnode)==null?void 0:R.props)!=null&&N.onNodeContextmenu&&(w.stopPropagation(),w.preventDefault()),a==null||a.ctx.emit(tq,w,(O=s.node)==null?void 0:O.data,s.node)};return(w,I)=>{var R,N,O;return $(),le("div",{ref:"node$",class:K([p(l).b("node"),p(l).is("expanded",w.expanded),p(l).is("current",w.current),p(l).is("focusable",!w.disabled),p(l).is("checked",!w.disabled&&w.checked),v(w.node)]),role:"treeitem",tabindex:"-1","aria-expanded":w.expanded,"aria-disabled":w.disabled,"aria-checked":w.checked,"data-key":(R=w.node)==null?void 0:R.key,onClick:Gt(g,["stop"]),onContextmenu:C,onDragover:Gt(()=>{},["prevent"]),onDragenter:Gt(()=>{},["prevent"]),onDrop:Gt(E,["stop"])},[ue("div",{class:K(p(l).be("node","content")),style:jt({paddingLeft:`${(w.node.level-1)*p(d)}px`,height:w.itemSize+"px"})},[p(h)?($(),Ve(p(Dt),{key:0,class:K([p(l).is("leaf",!!((N=w.node)!=null&&N.isLeaf)),p(l).is("hidden",w.hiddenExpandIcon),{expanded:!((O=w.node)!=null&&O.isLeaf)&&w.expanded},p(l).be("node","expand-icon")]),onClick:Gt(b,["stop"])},{default:Ce(()=>[($(),Ve(gn(p(h))))]),_:1},8,["class","onClick"])):De("v-if",!0),w.showCheckbox?($(),Ve(p(Wa),{key:1,"model-value":w.checked,indeterminate:w.indeterminate,disabled:w.disabled,onChange:S,onClick:Gt(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):De("v-if",!0),ge(p(iVe),{node:w.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var lVe=dt(cVe,[["__file","tree-node.vue"]]);const uVe=me({name:"ElTreeV2"}),dVe=me({...uVe,props:ZUe,emits:tVe,setup(t,{expose:o,emit:s}){const a=t,l=Jo(),d=U(()=>a.itemSize);wn(aP,{ctx:{emit:s,slots:l},props:a,instance:mn()}),wn(fl,void 0);const{t:h}=Fn(),v=Qe("tree"),{flattenTree:g,isNotEmpty:E,listRef:b,toggleExpand:S,isExpanded:C,isIndeterminate:w,isChecked:I,isDisabled:R,isCurrent:N,isForceHiddenExpandIcon:O,handleNodeClick:V,handleNodeDrop:L,handleNodeCheck:D,toggleCheckbox:M,getCurrentNode:F,getCurrentKey:W,setCurrentKey:z,getCheckedKeys:G,getCheckedNodes:Y,getHalfCheckedKeys:te,getHalfCheckedNodes:Z,setChecked:fe,setCheckedKeys:Ee,filter:ae,setData:X,getNode:ie,expandNode:se,collapseNode:J,setExpandedKeys:pe,scrollToNode:be,scrollTo:Ae}=sVe(a,s);return o({toggleCheckbox:M,getCurrentNode:F,getCurrentKey:W,setCurrentKey:z,getCheckedKeys:G,getCheckedNodes:Y,getHalfCheckedKeys:te,getHalfCheckedNodes:Z,setChecked:fe,setCheckedKeys:Ee,filter:ae,setData:X,getNode:ie,expandNode:se,collapseNode:J,setExpandedKeys:pe,scrollToNode:be,scrollTo:Ae}),(_e,Me)=>($(),le("div",{class:K([p(v).b(),{[p(v).m("highlight-current")]:_e.highlightCurrent}]),role:"tree"},[p(E)?($(),Ve(p(Vz),{key:0,ref_key:"listRef",ref:b,"class-name":p(v).b("virtual-list"),data:p(g),total:p(g).length,height:_e.height,"item-size":p(d),"perf-mode":_e.perfMode},{default:Ce(({data:Fe,index:Le,style:Pe})=>[($(),Ve(lVe,{key:Fe[Le].key,style:jt(Pe),node:Fe[Le],expanded:p(C)(Fe[Le]),"show-checkbox":_e.showCheckbox,checked:p(I)(Fe[Le]),indeterminate:p(w)(Fe[Le]),"item-size":p(d),disabled:p(R)(Fe[Le]),current:p(N)(Fe[Le]),"hidden-expand-icon":p(O)(Fe[Le]),onClick:p(V),onToggle:p(S),onCheck:p(D),onDrop:p(L)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):($(),le("div",{key:1,class:K(p(v).e("empty-block"))},[Ne(_e.$slots,"empty",{},()=>{var Fe;return[ue("span",{class:K(p(v).e("empty-text"))},ot((Fe=_e.emptyText)!=null?Fe:p(h)("el.tree.emptyText")),3)]})],2))],2))}});var hVe=dt(dVe,[["__file","tree.vue"]]);const fVe=rn(hVe),nq=Symbol("uploadContextKey"),pVe="ElUpload";class mVe extends Error{constructor(o,s,a,l){super(o),this.name="UploadAjaxError",this.status=s,this.method=a,this.url=l}}function f8(t,o,s){let a;return s.response?a=`${s.response.error||s.response}`:s.responseText?a=`${s.responseText}`:a=`fail to ${o.method} ${t} ${s.status}`,new mVe(a,s.status,o.method,t)}function vVe(t){const o=t.responseText||t.response;if(!o)return o;try{return JSON.parse(o)}catch{return o}}const gVe=t=>{typeof XMLHttpRequest>"u"&&qo(pVe,"XMLHttpRequest is undefined");const o=new XMLHttpRequest,s=t.action;o.upload&&o.upload.addEventListener("progress",d=>{const h=d;h.percent=d.total>0?d.loaded/d.total*100:0,t.onProgress(h)});const a=new FormData;if(t.data)for(const[d,h]of Object.entries(t.data))st(h)&&h.length?a.append(d,...h):a.append(d,h);a.append(t.filename,t.file,t.file.name),o.addEventListener("error",()=>{t.onError(f8(s,t,o))}),o.addEventListener("load",()=>{if(o.status<200||o.status>=300)return t.onError(f8(s,t,o));t.onSuccess(vVe(o))}),o.open(t.method,s,!0),t.withCredentials&&"withCredentials"in o&&(o.withCredentials=!0);const l=t.headers||{};if(l instanceof Headers)l.forEach((d,h)=>o.setRequestHeader(h,d));else for(const[d,h]of Object.entries(l))Qo(h)||o.setRequestHeader(d,String(h));return o.send(a),o},rq=["text","picture","picture-card"];let _Ve=1;const zO=()=>Date.now()+_Ve++,oq=ut({action:{type:String,default:"#"},headers:{type:Re(Object)},method:{type:String,default:"post"},data:{type:Re([Object,Function,Promise]),default:()=>lo({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:Re(Array),default:()=>lo([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:rq,default:"text"},httpRequest:{type:Re(Function),default:gVe},disabled:Boolean,limit:Number}),EVe=ut({...oq,beforeUpload:{type:Re(Function),default:pr},beforeRemove:{type:Re(Function)},onRemove:{type:Re(Function),default:pr},onChange:{type:Re(Function),default:pr},onPreview:{type:Re(Function),default:pr},onSuccess:{type:Re(Function),default:pr},onProgress:{type:Re(Function),default:pr},onError:{type:Re(Function),default:pr},onExceed:{type:Re(Function),default:pr},crossorigin:{type:Re(String)}}),yVe=ut({files:{type:Re(Array),default:()=>lo([])},disabled:{type:Boolean,default:!1},handlePreview:{type:Re(Function),default:pr},listType:{type:String,values:rq,default:"text"},crossorigin:{type:Re(String)}}),bVe={remove:t=>!!t},SVe=me({name:"ElUploadList"}),TVe=me({...SVe,props:yVe,emits:bVe,setup(t,{emit:o}){const s=t,{t:a}=Fn(),l=Qe("upload"),d=Qe("icon"),h=Qe("list"),v=Fs(),g=ee(!1),E=U(()=>[l.b("list"),l.bm("list",s.listType),l.is("disabled",s.disabled)]),b=S=>{o("remove",S)};return(S,C)=>($(),Ve(oW,{tag:"ul",class:K(p(E)),name:p(h).b()},{default:Ce(()=>[($(!0),le(Ut,null,Cn(S.files,(w,I)=>($(),le("li",{key:w.uid||w.name,class:K([p(l).be("list","item"),p(l).is(w.status),{focusing:g.value}]),tabindex:"0",onKeydown:Cr(R=>!p(v)&&b(w),["delete"]),onFocus:R=>g.value=!0,onBlur:R=>g.value=!1,onClick:R=>g.value=!1},[Ne(S.$slots,"default",{file:w,index:I},()=>[S.listType==="picture"||w.status!=="uploading"&&S.listType==="picture-card"?($(),le("img",{key:0,class:K(p(l).be("list","item-thumbnail")),src:w.url,crossorigin:S.crossorigin,alt:""},null,10,["src","crossorigin"])):De("v-if",!0),w.status==="uploading"||S.listType!=="picture-card"?($(),le("div",{key:1,class:K(p(l).be("list","item-info"))},[ue("a",{class:K(p(l).be("list","item-name")),onClick:Gt(R=>S.handlePreview(w),["prevent"])},[ge(p(Dt),{class:K(p(d).m("document"))},{default:Ce(()=>[ge(p(Tye))]),_:1},8,["class"]),ue("span",{class:K(p(l).be("list","item-file-name")),title:w.name},ot(w.name),11,["title"])],10,["onClick"]),w.status==="uploading"?($(),Ve(p(Az),{key:0,type:S.listType==="picture-card"?"circle":"line","stroke-width":S.listType==="picture-card"?6:2,percentage:Number(w.percentage),style:jt(S.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):De("v-if",!0)],2)):De("v-if",!0),ue("label",{class:K(p(l).be("list","item-status-label"))},[S.listType==="text"?($(),Ve(p(Dt),{key:0,class:K([p(d).m("upload-success"),p(d).m("circle-check")])},{default:Ce(()=>[ge(p(GN))]),_:1},8,["class"])):["picture-card","picture"].includes(S.listType)?($(),Ve(p(Dt),{key:1,class:K([p(d).m("upload-success"),p(d).m("check")])},{default:Ce(()=>[ge(p(l_))]),_:1},8,["class"])):De("v-if",!0)],2),p(v)?De("v-if",!0):($(),Ve(p(Dt),{key:2,class:K(p(d).m("close")),onClick:R=>b(w)},{default:Ce(()=>[ge(p(Sc))]),_:2},1032,["class","onClick"])),De(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),De(" This is a bug which needs to be fixed "),De(" TODO: Fix the incorrect navigation interaction "),p(v)?De("v-if",!0):($(),le("i",{key:3,class:K(p(d).m("close-tip"))},ot(p(a)("el.upload.deleteTip")),3)),S.listType==="picture-card"?($(),le("span",{key:4,class:K(p(l).be("list","item-actions"))},[ue("span",{class:K(p(l).be("list","item-preview")),onClick:R=>S.handlePreview(w)},[ge(p(Dt),{class:K(p(d).m("zoom-in"))},{default:Ce(()=>[ge(p(bK))]),_:1},8,["class"])],10,["onClick"]),p(v)?De("v-if",!0):($(),le("span",{key:0,class:K(p(l).be("list","item-delete")),onClick:R=>b(w)},[ge(p(Dt),{class:K(p(d).m("delete"))},{default:Ce(()=>[ge(p(bye))]),_:1},8,["class"])],10,["onClick"]))],2)):De("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),Ne(S.$slots,"append")]),_:3},8,["class","name"]))}});var p8=dt(TVe,[["__file","upload-list.vue"]]);const CVe=ut({disabled:{type:Boolean,default:!1}}),wVe={file:t=>st(t)},sq="ElUploadDrag",RVe=me({name:sq}),IVe=me({...RVe,props:CVe,emits:wVe,setup(t,{emit:o}){It(nq)||qo(sq,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=Qe("upload"),l=ee(!1),d=Fs(),h=g=>{if(d.value)return;l.value=!1,g.stopPropagation();const E=Array.from(g.dataTransfer.files),b=g.dataTransfer.items||[];E.forEach((S,C)=>{var w;const I=b[C],R=(w=I==null?void 0:I.webkitGetAsEntry)==null?void 0:w.call(I);R&&(S.isDirectory=R.isDirectory)}),o("file",E)},v=()=>{d.value||(l.value=!0)};return(g,E)=>($(),le("div",{class:K([p(a).b("dragger"),p(a).is("dragover",l.value)]),onDrop:Gt(h,["prevent"]),onDragover:Gt(v,["prevent"]),onDragleave:Gt(b=>l.value=!1,["prevent"])},[Ne(g.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var AVe=dt(IVe,[["__file","upload-dragger.vue"]]);const OVe=ut({...oq,beforeUpload:{type:Re(Function),default:pr},onRemove:{type:Re(Function),default:pr},onStart:{type:Re(Function),default:pr},onSuccess:{type:Re(Function),default:pr},onProgress:{type:Re(Function),default:pr},onError:{type:Re(Function),default:pr},onExceed:{type:Re(Function),default:pr}}),NVe=me({name:"ElUploadContent",inheritAttrs:!1}),kVe=me({...NVe,props:OVe,setup(t,{expose:o}){const s=t,a=Qe("upload"),l=Fs(),d=Mr({}),h=Mr(),v=R=>{if(R.length===0)return;const{autoUpload:N,limit:O,fileList:V,multiple:L,onStart:D,onExceed:M}=s;if(O&&V.length+R.length>O){M(R,V);return}L||(R=R.slice(0,1));for(const F of R){const W=F;W.uid=zO(),D(W),N&&g(W)}},g=async R=>{if(h.value.value="",!s.beforeUpload)return b(R);let N,O={};try{const L=s.data,D=s.beforeUpload(R);O=Cg(s.data)?yS(s.data):s.data,N=await D,Cg(s.data)&&as(L,O)&&(O=yS(s.data))}catch{N=!1}if(N===!1){s.onRemove(R);return}let V=R;N instanceof Blob&&(N instanceof File?V=N:V=new File([N],R.name,{type:R.type})),b(Object.assign(V,{uid:R.uid}),O)},E=async(R,N)=>Ft(R)?R(N):R,b=async(R,N)=>{const{headers:O,data:V,method:L,withCredentials:D,name:M,action:F,onProgress:W,onSuccess:z,onError:G,httpRequest:Y}=s;try{N=await E(N??V,R)}catch{s.onRemove(R);return}const{uid:te}=R,Z={headers:O||{},withCredentials:D,file:R,data:N,method:L,filename:M,action:F,onProgress:Ee=>{W(Ee,R)},onSuccess:Ee=>{z(Ee,R),delete d.value[te]},onError:Ee=>{G(Ee,R),delete d.value[te]}},fe=Y(Z);d.value[te]=fe,fe instanceof Promise&&fe.then(Z.onSuccess,Z.onError)},S=R=>{const N=R.target.files;N&&v(Array.from(N))},C=()=>{l.value||(h.value.value="",h.value.click())},w=()=>{C()};return o({abort:R=>{dK(d.value).filter(R?([O])=>String(R.uid)===O:()=>!0).forEach(([O,V])=>{V instanceof XMLHttpRequest&&V.abort(),delete d.value[O]})},upload:g}),(R,N)=>($(),le("div",{class:K([p(a).b(),p(a).m(R.listType),p(a).is("drag",R.drag),p(a).is("disabled",p(l))]),tabindex:p(l)?"-1":"0",onClick:C,onKeydown:Cr(Gt(w,["self"]),["enter","space"])},[R.drag?($(),Ve(AVe,{key:0,disabled:p(l),onFile:v},{default:Ce(()=>[Ne(R.$slots,"default")]),_:3},8,["disabled"])):Ne(R.$slots,"default",{key:1}),ue("input",{ref_key:"inputRef",ref:h,class:K(p(a).e("input")),name:R.name,disabled:p(l),multiple:R.multiple,accept:R.accept,type:"file",onChange:S,onClick:Gt(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var m8=dt(kVe,[["__file","upload-content.vue"]]);const v8="ElUpload",g8=t=>{var o;(o=t.url)!=null&&o.startsWith("blob:")&&URL.revokeObjectURL(t.url)},PVe=(t,o)=>{const s=rK(t,"fileList",void 0,{passive:!0}),a=w=>s.value.find(I=>I.uid===w.uid);function l(w){var I;(I=o.value)==null||I.abort(w)}function d(w=["ready","uploading","success","fail"]){s.value=s.value.filter(I=>!w.includes(I.status))}function h(w){s.value=s.value.filter(I=>I.uid!==w.uid)}const v=(w,I)=>{const R=a(I);R&&(console.error(w),R.status="fail",h(R),t.onError(w,R,s.value),t.onChange(R,s.value))},g=(w,I)=>{const R=a(I);R&&(t.onProgress(w,R,s.value),R.status="uploading",R.percentage=Math.round(w.percent))},E=(w,I)=>{const R=a(I);R&&(R.status="success",R.response=w,t.onSuccess(w,R,s.value),t.onChange(R,s.value))},b=w=>{Qo(w.uid)&&(w.uid=zO());const I={name:w.name,percentage:0,status:"ready",size:w.size,raw:w,uid:w.uid};if(t.listType==="picture-card"||t.listType==="picture")try{I.url=URL.createObjectURL(w)}catch(R){R.message,t.onError(R,I,s.value)}s.value=[...s.value,I],t.onChange(I,s.value)},S=async w=>{const I=w instanceof File?a(w):w;I||qo(v8,"file to be removed not found");const R=N=>{l(N),h(N),t.onRemove(N,s.value),g8(N)};t.beforeRemove?await t.beforeRemove(I,s.value)!==!1&&R(I):R(I)};function C(){s.value.filter(({status:w})=>w==="ready").forEach(({raw:w})=>{var I;return w&&((I=o.value)==null?void 0:I.upload(w))})}return ze(()=>t.listType,w=>{w!=="picture-card"&&w!=="picture"||(s.value=s.value.map(I=>{const{raw:R,url:N}=I;if(!N&&R)try{I.url=URL.createObjectURL(R)}catch(O){t.onError(O,I,s.value)}return I}))}),ze(s,w=>{for(const I of w)I.uid||(I.uid=zO()),I.status||(I.status="success")},{immediate:!0,deep:!0}),{uploadFiles:s,abort:l,clearFiles:d,handleError:v,handleProgress:g,handleStart:b,handleSuccess:E,handleRemove:S,submit:C,revokeFileObjectURL:g8}},DVe=me({name:"ElUpload"}),LVe=me({...DVe,props:EVe,setup(t,{expose:o}){const s=t,a=Fs(),l=Mr(),{abort:d,submit:h,clearFiles:v,uploadFiles:g,handleStart:E,handleError:b,handleRemove:S,handleSuccess:C,handleProgress:w,revokeFileObjectURL:I}=PVe(s,l),R=U(()=>s.listType==="picture-card"),N=U(()=>({...s,fileList:g.value,onStart:E,onProgress:w,onSuccess:C,onError:b,onRemove:S}));return Rr(()=>{g.value.forEach(I)}),wn(nq,{accept:lr(s,"accept")}),o({abort:d,submit:h,clearFiles:v,handleStart:E,handleRemove:S}),(O,V)=>($(),le("div",null,[p(R)&&O.showFileList?($(),Ve(p8,{key:0,disabled:p(a),"list-type":O.listType,files:p(g),crossorigin:O.crossorigin,"handle-preview":O.onPreview,onRemove:p(S)},fa({append:Ce(()=>[ge(m8,En({ref_key:"uploadRef",ref:l},p(N)),{default:Ce(()=>[O.$slots.trigger?Ne(O.$slots,"trigger",{key:0}):De("v-if",!0),!O.$slots.trigger&&O.$slots.default?Ne(O.$slots,"default",{key:1}):De("v-if",!0)]),_:3},16)]),_:2},[O.$slots.file?{name:"default",fn:Ce(({file:L,index:D})=>[Ne(O.$slots,"file",{file:L,index:D})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):De("v-if",!0),!p(R)||p(R)&&!O.showFileList?($(),Ve(m8,En({key:1,ref_key:"uploadRef",ref:l},p(N)),{default:Ce(()=>[O.$slots.trigger?Ne(O.$slots,"trigger",{key:0}):De("v-if",!0),!O.$slots.trigger&&O.$slots.default?Ne(O.$slots,"default",{key:1}):De("v-if",!0)]),_:3},16)):De("v-if",!0),O.$slots.trigger?Ne(O.$slots,"default",{key:2}):De("v-if",!0),Ne(O.$slots,"tip"),!p(R)&&O.showFileList?($(),Ve(p8,{key:3,disabled:p(a),"list-type":O.listType,files:p(g),crossorigin:O.crossorigin,"handle-preview":O.onPreview,onRemove:p(S)},fa({_:2},[O.$slots.file?{name:"default",fn:Ce(({file:L,index:D})=>[Ne(O.$slots,"file",{file:L,index:D})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):De("v-if",!0)]))}});var MVe=dt(LVe,[["__file","upload.vue"]]);const xVe=rn(MVe),UVe=ut({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:Re([String,Array]),default:"Element Plus"},font:{type:Re(Object)},gap:{type:Re(Array),default:()=>[100,100]},offset:{type:Re(Array)}});function VVe(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function FVe(t){return Object.keys(t).map(o=>`${VVe(o)}: ${t[o]};`).join(" ")}function BVe(){return window.devicePixelRatio||1}const jVe=(t,o)=>{let s=!1;return t.removedNodes.length&&o&&(s=Array.from(t.removedNodes).includes(o)),t.type==="attributes"&&t.target===o&&(s=!0),s},iq=3;function CA(t,o,s=1){const a=document.createElement("canvas"),l=a.getContext("2d"),d=t*s,h=o*s;return a.setAttribute("width",`${d}px`),a.setAttribute("height",`${h}px`),l.save(),[l,a,d,h]}function $Ve(){function t(o,s,a,l,d,h,v,g){const[E,b,S,C]=CA(l,d,a);if(o instanceof HTMLImageElement)E.drawImage(o,0,0,S,C);else{const{color:be,fontSize:Ae,fontStyle:_e,fontWeight:Me,fontFamily:Fe,textAlign:Le,textBaseline:Pe}=h,He=Number(Ae)*a;E.font=`${_e} normal ${Me} ${He}px/${d}px ${Fe}`,E.fillStyle=be,E.textAlign=Le,E.textBaseline=Pe;const We=st(o)?o:[o];We==null||We.forEach((yt,it)=>{E.fillText(yt??"",S/2,it*(He+iq*a))})}const w=Math.PI/180*Number(s),I=Math.max(l,d),[R,N,O]=CA(I,I,a);R.translate(O/2,O/2),R.rotate(w),S>0&&C>0&&R.drawImage(b,-S/2,-C/2);function V(be,Ae){const _e=be*Math.cos(w)-Ae*Math.sin(w),Me=be*Math.sin(w)+Ae*Math.cos(w);return[_e,Me]}let L=0,D=0,M=0,F=0;const W=S/2,z=C/2;[[0-W,0-z],[0+W,0-z],[0+W,0+z],[0-W,0+z]].forEach(([be,Ae])=>{const[_e,Me]=V(be,Ae);L=Math.min(L,_e),D=Math.max(D,_e),M=Math.min(M,Me),F=Math.max(F,Me)});const Y=L+O/2,te=M+O/2,Z=D-L,fe=F-M,Ee=v*a,ae=g*a,X=(Z+Ee)*2,ie=fe+ae,[se,J]=CA(X,ie);function pe(be=0,Ae=0){se.drawImage(N,Y,te,Z,fe,be,Ae,Z,fe)}return pe(),pe(Z+Ee,-fe/2-ae/2),pe(Z+Ee,+fe/2+ae/2),[J.toDataURL(),X/a,ie/a]}return t}const HVe=me({name:"ElWatermark"}),WVe=me({...HVe,props:UVe,setup(t){const o=t,s={position:"relative"},a=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.color)!=null?te:"rgba(0,0,0,.15)"}),l=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.fontSize)!=null?te:16}),d=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.fontWeight)!=null?te:"normal"}),h=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.fontStyle)!=null?te:"normal"}),v=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.fontFamily)!=null?te:"sans-serif"}),g=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.textAlign)!=null?te:"center"}),E=U(()=>{var Y,te;return(te=(Y=o.font)==null?void 0:Y.textBaseline)!=null?te:"hanging"}),b=U(()=>o.gap[0]),S=U(()=>o.gap[1]),C=U(()=>b.value/2),w=U(()=>S.value/2),I=U(()=>{var Y,te;return(te=(Y=o.offset)==null?void 0:Y[0])!=null?te:C.value}),R=U(()=>{var Y,te;return(te=(Y=o.offset)==null?void 0:Y[1])!=null?te:w.value}),N=()=>{const Y={zIndex:o.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let te=I.value-C.value,Z=R.value-w.value;return te>0&&(Y.left=`${te}px`,Y.width=`calc(100% - ${te}px)`,te=0),Z>0&&(Y.top=`${Z}px`,Y.height=`calc(100% - ${Z}px)`,Z=0),Y.backgroundPosition=`${te}px ${Z}px`,Y},O=Mr(null),V=Mr(),L=ee(!1),D=()=>{V.value&&(V.value.remove(),V.value=void 0)},M=(Y,te)=>{var Z;O.value&&V.value&&(L.value=!0,V.value.setAttribute("style",FVe({...N(),backgroundImage:`url('${Y}')`,backgroundSize:`${Math.floor(te)}px`})),(Z=O.value)==null||Z.append(V.value),setTimeout(()=>{L.value=!1}))},F=Y=>{let te=120,Z=64;const fe=o.image,Ee=o.content,ae=o.width,X=o.height;if(!fe&&Y.measureText){Y.font=`${Number(l.value)}px ${v.value}`;const ie=st(Ee)?Ee:[Ee],se=ie.map(J=>{const pe=Y.measureText(J);return[pe.width,pe.fontBoundingBoxAscent!==void 0?pe.fontBoundingBoxAscent+pe.fontBoundingBoxDescent:pe.actualBoundingBoxAscent+pe.actualBoundingBoxDescent]});te=Math.ceil(Math.max(...se.map(J=>J[0]))),Z=Math.ceil(Math.max(...se.map(J=>J[1])))*ie.length+(ie.length-1)*iq}return[ae??te,X??Z]},W=$Ve(),z=()=>{const te=document.createElement("canvas").getContext("2d"),Z=o.image,fe=o.content,Ee=o.rotate;if(te){V.value||(V.value=document.createElement("div"));const ae=BVe(),[X,ie]=F(te),se=J=>{const[pe,be]=W(J||"",Ee,ae,X,ie,{color:a.value,fontSize:l.value,fontStyle:h.value,fontWeight:d.value,fontFamily:v.value,textAlign:g.value,textBaseline:E.value},b.value,S.value);M(pe,be)};if(Z){const J=new Image;J.onload=()=>{se(J)},J.onerror=()=>{se(fe)},J.crossOrigin="anonymous",J.referrerPolicy="no-referrer",J.src=Z}else se(fe)}};return dn(()=>{z()}),ze(()=>o,()=>{z()},{deep:!0,flush:"post"}),Rr(()=>{D()}),nK(O,Y=>{L.value||Y.forEach(te=>{jVe(te,V.value)&&(D(),z())})},{attributes:!0,subtree:!0,childList:!0}),(Y,te)=>($(),le("div",{ref_key:"containerRef",ref:O,style:jt([s])},[Ne(Y.$slots,"default")],4))}});var KVe=dt(WVe,[["__file","watermark.vue"]]);const GVe=rn(KVe),zVe=ut({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:Re(Object)},targetAreaClickable:{type:Boolean,default:!0}}),YVe=(t,o,s,a,l)=>{const d=ee(null),h=()=>{let S;return Mt(t.value)?S=document.querySelector(t.value):Ft(t.value)?S=t.value():S=t.value,S},v=()=>{const S=h();if(!S||!o.value){d.value=null;return}qVe(S)||S.scrollIntoView(l.value);const{left:C,top:w,width:I,height:R}=S.getBoundingClientRect();d.value={left:C,top:w,width:I,height:R,radius:0}};dn(()=>{ze([o,t],()=>{v()},{immediate:!0}),window.addEventListener("resize",v)}),Rr(()=>{window.removeEventListener("resize",v)});const g=S=>{var C;return(C=st(s.value.offset)?s.value.offset[S]:s.value.offset)!=null?C:6},E=U(()=>{var S;if(!d.value)return d.value;const C=g(0),w=g(1),I=((S=s.value)==null?void 0:S.radius)||2;return{left:d.value.left-C,top:d.value.top-w,width:d.value.width+C*2,height:d.value.height+w*2,radius:I}}),b=U(()=>{const S=h();return!a.value||!S||!window.DOMRect?S||void 0:{getBoundingClientRect(){var C,w,I,R;return window.DOMRect.fromRect({width:((C=E.value)==null?void 0:C.width)||0,height:((w=E.value)==null?void 0:w.height)||0,x:((I=E.value)==null?void 0:I.left)||0,y:((R=E.value)==null?void 0:R.top)||0})}}});return{mergedPosInfo:E,triggerTarget:b}},D0=Symbol("ElTour");function qVe(t){const o=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight,{top:a,right:l,bottom:d,left:h}=t.getBoundingClientRect();return a>=0&&h>=0&&l<=o&&d<=s}const XVe=(t,o,s,a,l,d,h,v)=>{const g=ee(),E=ee(),b=ee({}),S={x:g,y:E,placement:a,strategy:l,middlewareData:b},C=U(()=>{const O=[BY(p(d)),eUe(),Qxe(),JVe()];return p(v)&&p(s)&&O.push(jY({element:p(s)})),O}),w=async()=>{if(!Vn)return;const O=p(t),V=p(o);if(!O||!V)return;const L=await $Y(O,V,{placement:p(a),strategy:p(l),middleware:p(C)});Kp(S).forEach(D=>{S[D].value=L[D]})},I=U(()=>{if(!p(t))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:p(h)};const{overflow:O}=p(b);return{position:p(l),zIndex:p(h),top:p(E)!=null?`${p(E)}px`:"",left:p(g)!=null?`${p(g)}px`:"",maxWidth:O!=null&&O.maxWidth?`${O==null?void 0:O.maxWidth}px`:""}}),R=U(()=>{if(!p(v))return{};const{arrow:O}=p(b);return{left:(O==null?void 0:O.x)!=null?`${O==null?void 0:O.x}px`:"",top:(O==null?void 0:O.y)!=null?`${O==null?void 0:O.y}px`:""}});let N;return dn(()=>{const O=p(t),V=p(o);O&&V&&(N=Jxe(O,V,w)),Ms(()=>{w()})}),Rr(()=>{N&&N()}),{update:w,contentStyle:I,arrowStyle:R}},JVe=()=>({name:"overflow",async fn(t){const o=await Zxe(t);let s=0;return o.left>0&&(s=o.left),o.right>0&&(s=o.right),{data:{maxWidth:t.rects.floating.width-s}}}}),ZVe=me({name:"ElTourMask",inheritAttrs:!1}),QVe=me({...ZVe,props:zVe,setup(t){const o=t,{ns:s}=It(D0),a=U(()=>{var v,g;return(g=(v=o.pos)==null?void 0:v.radius)!=null?g:2}),l=U(()=>{const v=a.value,g=`a${v},${v} 0 0 1`;return{topRight:`${g} ${v},${v}`,bottomRight:`${g} ${-v},${v}`,bottomLeft:`${g} ${-v},${-v}`,topLeft:`${g} ${v},${-v}`}}),d=U(()=>{const v=window.innerWidth,g=window.innerHeight,E=l.value,b=`M${v},0 L0,0 L0,${g} L${v},${g} L${v},0 Z`,S=a.value;return o.pos?`${b} M${o.pos.left+S},${o.pos.top} h${o.pos.width-S*2} ${E.topRight} v${o.pos.height-S*2} ${E.bottomRight} h${-o.pos.width+S*2} ${E.bottomLeft} v${-o.pos.height+S*2} ${E.topLeft} z`:b}),h=U(()=>({fill:o.fill,pointerEvents:"auto",cursor:"auto"}));return Rk(lr(o,"visible"),{ns:s}),(v,g)=>v.visible?($(),le("div",En({key:0,class:p(s).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:v.zIndex,pointerEvents:v.pos&&v.targetAreaClickable?"none":"auto"}},v.$attrs),[($(),le("svg",{style:{width:"100%",height:"100%"}},[ue("path",{class:K(p(s).e("hollow")),style:jt(p(h)),d:p(d)},null,14,["d"])]))],16)):De("v-if",!0)}});var eFe=dt(QVe,[["__file","mask.vue"]]);const tFe=["absolute","fixed"],nFe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],cP=ut({placement:{type:Re(String),values:nFe,default:"bottom"},reference:{type:Re(Object),default:null},strategy:{type:Re(String),values:tFe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),rFe={close:()=>!0},oFe=me({name:"ElTourContent"}),sFe=me({...oFe,props:cP,emits:rFe,setup(t,{emit:o}){const s=t,a=ee(s.placement),l=ee(s.strategy),d=ee(null),h=ee(null);ze(()=>s.placement,()=>{a.value=s.placement});const{contentStyle:v,arrowStyle:g}=XVe(lr(s,"reference"),d,h,a,l,lr(s,"offset"),lr(s,"zIndex"),lr(s,"showArrow")),E=U(()=>a.value.split("-")[0]),{ns:b}=It(D0),S=()=>{o("close")},C=w=>{w.detail.focusReason==="pointer"&&w.preventDefault()};return(w,I)=>($(),le("div",{ref_key:"contentRef",ref:d,style:jt(p(v)),class:K(p(b).e("content")),"data-side":p(E),tabindex:"-1"},[ge(p(mm),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":d.value||void 0,onReleaseRequested:S,onFocusoutPrevented:C},{default:Ce(()=>[Ne(w.$slots,"default")]),_:3},8,["focus-trap-el"]),w.showArrow?($(),le("span",{key:0,ref_key:"arrowRef",ref:h,style:jt(p(g)),class:K(p(b).e("arrow"))},null,6)):De("v-if",!0)],14,["data-side"]))}});var iFe=dt(sFe,[["__file","content.vue"]]),aFe=me({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(t,{slots:o,emit:s}){let a=0;return()=>{var l,d;const h=(l=o.default)==null?void 0:l.call(o),v=[];let g=0;function E(b){st(b)&&b.forEach(S=>{var C;((C=(S==null?void 0:S.type)||{})==null?void 0:C.name)==="ElTourStep"&&(v.push(S),g+=1)})}return h.length&&E(Jl((d=h[0])==null?void 0:d.children)),a!==g&&(a=g,s("update-total",g)),v.length?v[t.current]:null}}});const cFe=ut({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:yr},placement:cP.placement,contentStyle:{type:Re([Object])},mask:{type:Re([Boolean,Object]),default:!0},gap:{type:Re(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:Re([Boolean,Object]),default:()=>({block:"center"})},type:{type:Re(String)},appendTo:{type:Re([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),lFe={[Jt]:t=>wr(t),"update:current":t=>$t(t),close:t=>$t(t),finish:()=>!0,change:t=>$t(t)},uFe=me({name:"ElTour"}),dFe=me({...uFe,props:cFe,emits:lFe,setup(t,{emit:o}){const s=t,a=Qe("tour"),l=ee(0),d=ee(),h=rK(s,"current",o,{passive:!0}),v=U(()=>{var G;return(G=d.value)==null?void 0:G.target}),g=U(()=>[a.b(),N.value==="primary"?a.m("primary"):""]),E=U(()=>{var G;return((G=d.value)==null?void 0:G.placement)||s.placement}),b=U(()=>{var G,Y;return(Y=(G=d.value)==null?void 0:G.contentStyle)!=null?Y:s.contentStyle}),S=U(()=>{var G,Y;return(Y=(G=d.value)==null?void 0:G.mask)!=null?Y:s.mask}),C=U(()=>!!S.value&&s.modelValue),w=U(()=>wr(S.value)?void 0:S.value),I=U(()=>{var G,Y;return!!v.value&&((Y=(G=d.value)==null?void 0:G.showArrow)!=null?Y:s.showArrow)}),R=U(()=>{var G,Y;return(Y=(G=d.value)==null?void 0:G.scrollIntoViewOptions)!=null?Y:s.scrollIntoViewOptions}),N=U(()=>{var G,Y;return(Y=(G=d.value)==null?void 0:G.type)!=null?Y:s.type}),{nextZIndex:O}=fm(),V=O(),L=U(()=>{var G;return(G=s.zIndex)!=null?G:V}),{mergedPosInfo:D,triggerTarget:M}=YVe(v,lr(s,"modelValue"),lr(s,"gap"),S,R);ze(()=>s.modelValue,G=>{G||(h.value=0)});const F=()=>{s.closeOnPressEscape&&(o(Jt,!1),o("close",h.value))},W=G=>{l.value=G},z=Jo();return wn(D0,{currentStep:d,current:h,total:l,showClose:lr(s,"showClose"),closeIcon:lr(s,"closeIcon"),mergedType:N,ns:a,slots:z,updateModelValue(G){o(Jt,G)},onClose(){o("close",h.value)},onFinish(){o("finish")},onChange(){o(yn,h.value)}}),(G,Y)=>($(),le(Ut,null,[ge(p(vm),{to:G.appendTo},{default:Ce(()=>{var te,Z;return[ue("div",En({class:p(g)},G.$attrs),[ge(eFe,{visible:p(C),fill:(te=p(w))==null?void 0:te.color,style:jt((Z=p(w))==null?void 0:Z.style),pos:p(D),"z-index":p(L),"target-area-clickable":G.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),G.modelValue?($(),Ve(iFe,{key:p(h),reference:p(M),placement:p(E),"show-arrow":p(I),"z-index":p(L),style:jt(p(b)),onClose:F},{default:Ce(()=>[ge(p(aFe),{current:p(h),onUpdateTotal:W},{default:Ce(()=>[Ne(G.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):De("v-if",!0)],16)]}),_:3},8,["to"]),De(" just for IDE "),De("v-if",!0)],64))}});var hFe=dt(dFe,[["__file","tour.vue"]]);const fFe=ut({target:{type:Re([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:yr},showArrow:{type:Boolean,default:void 0},placement:cP.placement,mask:{type:Re([Boolean,Object]),default:void 0},contentStyle:{type:Re([Object])},prevButtonProps:{type:Re(Object)},nextButtonProps:{type:Re(Object)},scrollIntoViewOptions:{type:Re([Boolean,Object]),default:void 0},type:{type:Re(String)}}),pFe={close:()=>!0},mFe=me({name:"ElTourStep"}),vFe=me({...mFe,props:fFe,emits:pFe,setup(t,{emit:o}){const s=t,{Close:a}=qN,{t:l}=Fn(),{currentStep:d,current:h,total:v,showClose:g,closeIcon:E,mergedType:b,ns:S,slots:C,updateModelValue:w,onClose:I,onFinish:R,onChange:N}=It(D0);ze(s,z=>{d.value=z},{immediate:!0});const O=U(()=>{var z;return(z=s.showClose)!=null?z:g.value}),V=U(()=>{var z,G;return(G=(z=s.closeIcon)!=null?z:E.value)!=null?G:a}),L=z=>{if(z)return B_e(z,["children","onClick"])},D=()=>{var z,G;h.value-=1,(z=s.prevButtonProps)!=null&&z.onClick&&((G=s.prevButtonProps)==null||G.onClick()),N()},M=()=>{var z;h.value>=v.value-1?F():h.value+=1,(z=s.nextButtonProps)!=null&&z.onClick&&s.nextButtonProps.onClick(),N()},F=()=>{W(),R()},W=()=>{w(!1),I(),o("close")};return(z,G)=>($(),le(Ut,null,[p(O)?($(),le("button",{key:0,"aria-label":"Close",class:K(p(S).e("closebtn")),type:"button",onClick:W},[ge(p(Dt),{class:K(p(S).e("close"))},{default:Ce(()=>[($(),Ve(gn(p(V))))]),_:1},8,["class"])],2)):De("v-if",!0),ue("header",{class:K([p(S).e("header"),{"show-close":p(g)}])},[Ne(z.$slots,"header",{},()=>[ue("span",{role:"heading",class:K(p(S).e("title"))},ot(z.title),3)])],2),ue("div",{class:K(p(S).e("body"))},[Ne(z.$slots,"default",{},()=>[ue("span",null,ot(z.description),1)])],2),ue("footer",{class:K(p(S).e("footer"))},[ue("div",{class:K(p(S).b("indicators"))},[p(C).indicators?($(),Ve(gn(p(C).indicators),{key:0,current:p(h),total:p(v)},null,8,["current","total"])):($(!0),le(Ut,{key:1},Cn(p(v),(Y,te)=>($(),le("span",{key:Y,class:K([p(S).b("indicator"),te===p(h)?"is-active":""])},null,2))),128))],2),ue("div",{class:K(p(S).b("buttons"))},[p(h)>0?($(),Ve(p(ls),En({key:0,size:"small",type:p(b)},L(z.prevButtonProps),{onClick:D}),{default:Ce(()=>{var Y,te;return[bn(ot((te=(Y=z.prevButtonProps)==null?void 0:Y.children)!=null?te:p(l)("el.tour.previous")),1)]}),_:1},16,["type"])):De("v-if",!0),p(h)<=p(v)-1?($(),Ve(p(ls),En({key:1,size:"small",type:p(b)==="primary"?"default":"primary"},L(z.nextButtonProps),{onClick:M}),{default:Ce(()=>{var Y,te;return[bn(ot((te=(Y=z.nextButtonProps)==null?void 0:Y.children)!=null?te:p(h)===p(v)-1?p(l)("el.tour.finish"):p(l)("el.tour.next")),1)]}),_:1},16,["type"])):De("v-if",!0)],2)],2)],64))}});var aq=dt(vFe,[["__file","step.vue"]]);const gFe=rn(hFe,{TourStep:aq}),_Fe=uo(aq),EFe=ut({container:{type:Re([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:Re(String),default:"default"},direction:{type:Re(String),default:"vertical"},selectScrollTop:{type:Boolean,default:!1}}),yFe={change:t=>Mt(t),click:(t,o)=>t instanceof MouseEvent&&(Mt(o)||Xn(o))},cq=Symbol("anchor"),Ub=t=>{if(!Vn||t==="")return null;if(Mt(t))try{return document.querySelector(t)}catch{return null}return t};function bFe(t){let o=0;const s=(...a)=>{o&&xh(o),o=ld(()=>{t(...a),o=0})};return s.cancel=()=>{xh(o),o=0},s}const SFe=me({name:"ElAnchor"}),TFe=me({...SFe,props:EFe,emits:yFe,setup(t,{expose:o,emit:s}){const a=t,l=ee(""),d=ee(null),h=ee(null),v=ee(),g={};let E=!1,b=0;const S=Qe("anchor"),C=U(()=>[S.b(),a.type==="underline"?S.m("underline"):"",S.m(a.direction)]),w=z=>{g[z.href]=z.el},I=z=>{delete g[z]},R=z=>{l.value!==z&&(l.value=z,s(yn,z))};let N=null;const O=z=>{if(!v.value)return;const G=Ub(z);if(!G)return;N&&N(),E=!0;const Y=A$(G,v.value),te=sO(G,Y),Z=Y.scrollHeight-Y.clientHeight,fe=Math.min(te-a.offset,Z);N=HEe(v.value,b,fe,a.duration,()=>{setTimeout(()=>{E=!1},20)})},V=z=>{z&&(R(z),O(z))},L=(z,G)=>{s("click",z,G),V(G)},D=bFe(()=>{v.value&&(b=O$(v.value));const z=M();E||Xn(z)||R(z)}),M=()=>{if(!v.value)return;const z=O$(v.value),G=[];for(const Y of Object.keys(g)){const te=Ub(Y);if(!te)continue;const Z=A$(te,v.value),fe=sO(te,Z);G.push({top:fe-a.offset-a.bound,href:Y})}G.sort((Y,te)=>Y.top-te.top);for(let Y=0;Y<G.length;Y++){const te=G[Y],Z=G[Y+1];if(Y===0&&z===0)return a.selectScrollTop?te.href:"";if(te.top<=z&&(!Z||Z.top>z))return te.href}},F=()=>{const z=Ub(a.container);!z||h0(z)?v.value=window:v.value=z};gr(v,"scroll",D);const W=U(()=>{if(!d.value||!h.value||!l.value)return{};const z=g[l.value];if(!z)return{};const G=d.value.getBoundingClientRect(),Y=h.value.getBoundingClientRect(),te=z.getBoundingClientRect();return a.direction==="horizontal"?{left:`${te.left-G.left}px`,width:`${te.width}px`,opacity:1}:{top:`${te.top-G.top+(te.height-Y.height)/2}px`,opacity:1}});return dn(()=>{F();const z=decodeURIComponent(window.location.hash);Ub(z)?V(z):D()}),ze(()=>a.container,()=>{F()}),wn(cq,{ns:S,direction:a.direction,currentAnchor:l,addLink:w,removeLink:I,handleClick:L}),o({scrollTo:V}),(z,G)=>($(),le("div",{ref_key:"anchorRef",ref:d,class:K(p(C))},[z.marker?($(),le("div",{key:0,ref_key:"markerRef",ref:h,class:K(p(S).e("marker")),style:jt(p(W))},null,6)):De("v-if",!0),ue("div",{class:K(p(S).e("list"))},[Ne(z.$slots,"default")],2)],2))}});var CFe=dt(TFe,[["__file","anchor.vue"]]);const wFe=ut({title:String,href:String}),RFe=me({name:"ElAnchorLink"}),IFe=me({...RFe,props:wFe,setup(t){const o=t,s=ee(null),{ns:a,direction:l,currentAnchor:d,addLink:h,removeLink:v,handleClick:g}=It(cq),E=U(()=>[a.e("link"),a.is("active",d.value===o.href)]),b=S=>{g(S,o.href)};return ze(()=>o.href,(S,C)=>{Vt(()=>{C&&v(C),S&&h({href:S,el:s.value})})}),dn(()=>{const{href:S}=o;S&&h({href:S,el:s.value})}),Rr(()=>{const{href:S}=o;S&&v(S)}),(S,C)=>($(),le("div",{class:K(p(a).e("item"))},[ue("a",{ref_key:"linkRef",ref:s,class:K(p(E)),href:S.href,onClick:b},[Ne(S.$slots,"default",{},()=>[bn(ot(S.title),1)])],10,["href"]),S.$slots["sub-link"]&&p(l)==="vertical"?($(),le("div",{key:0,class:K(p(a).e("list"))},[Ne(S.$slots,"sub-link")],2)):De("v-if",!0)],2))}});var lq=dt(IFe,[["__file","anchor-link.vue"]]);const AFe=rn(CFe,{AnchorLink:lq}),OFe=uo(lq),NFe=ut({direction:{type:Re(String),default:"horizontal"},options:{type:Re(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:Ho,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...Cs(["ariaLabel"])}),kFe={[Jt]:t=>Mt(t)||$t(t)||wr(t),[yn]:t=>Mt(t)||$t(t)||wr(t)},PFe=me({name:"ElSegmented"}),DFe=me({...PFe,props:NFe,emits:kFe,setup(t,{emit:o}){const s=t,a=Qe("segmented"),l=Ts(),d=xo(),h=Fs(),{formItem:v}=Vs(),{inputId:g,isLabeledByFormItem:E}=Ka(s,{formItemContext:v}),b=ee(null),S=hEe(),C=er({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),w=G=>{const Y=I(G);o(Jt,Y),o(yn,Y)},I=G=>fn(G)?G.value:G,R=G=>fn(G)?G.label:G,N=G=>!!(h.value||fn(G)&&G.disabled),O=G=>s.modelValue===I(G),V=G=>s.options.find(Y=>I(Y)===G),L=G=>[a.e("item"),a.is("selected",O(G)),a.is("disabled",N(G))],D=()=>{if(!b.value)return;const G=b.value.querySelector(".is-selected"),Y=b.value.querySelector(".is-selected input");if(!G||!Y){C.width=0,C.height=0,C.translateX=0,C.translateY=0,C.focusVisible=!1;return}const te=G.getBoundingClientRect();C.isInit=!0,s.direction==="vertical"?(C.height=te.height,C.translateY=G.offsetTop):(C.width=te.width,C.translateX=G.offsetLeft);try{C.focusVisible=Y.matches(":focus-visible")}catch{}},M=U(()=>[a.b(),a.m(d.value),a.is("block",s.block)]),F=U(()=>({width:s.direction==="vertical"?"100%":`${C.width}px`,height:s.direction==="vertical"?`${C.height}px`:"100%",transform:s.direction==="vertical"?`translateY(${C.translateY}px)`:`translateX(${C.translateX}px)`,display:C.isInit?"block":"none"})),W=U(()=>[a.e("item-selected"),a.is("disabled",N(V(s.modelValue))),a.is("focus-visible",C.focusVisible)]),z=U(()=>s.name||l.value);return co(b,D),ze(S,D),ze(()=>s.modelValue,()=>{var G;D(),s.validateEvent&&((G=v==null?void 0:v.validate)==null||G.call(v,"change").catch(Y=>void 0))},{flush:"post"}),(G,Y)=>G.options.length?($(),le("div",{key:0,id:p(g),ref_key:"segmentedRef",ref:b,class:K(p(M)),role:"radiogroup","aria-label":p(E)?void 0:G.ariaLabel||"segmented","aria-labelledby":p(E)?p(v).labelId:void 0},[ue("div",{class:K([p(a).e("group"),p(a).m(s.direction)])},[ue("div",{style:jt(p(F)),class:K(p(W))},null,6),($(!0),le(Ut,null,Cn(G.options,(te,Z)=>($(),le("label",{key:Z,class:K(L(te))},[ue("input",{class:K(p(a).e("item-input")),type:"radio",name:p(z),disabled:N(te),checked:O(te),onChange:fe=>w(te)},null,42,["name","disabled","checked","onChange"]),ue("div",{class:K(p(a).e("item-label"))},[Ne(G.$slots,"default",{item:te},()=>[bn(ot(R(te)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):De("v-if",!0)}});var LFe=dt(DFe,[["__file","segmented.vue"]]);const MFe=rn(LFe),xFe=(t,o)=>{const s=t.toLowerCase();return(o.label||o.value).toLowerCase().includes(s)},UFe=(t,o,s)=>{const{selectionEnd:a}=t;if(a===null)return;const l=t.value,d=Js(o);let h=-1,v;for(let g=a-1;g>=0;--g){const E=l[g];if(E===s||E===`
`||E==="\r"){h=g;continue}if(d.includes(E)){const b=h===-1?a:h;v={pattern:l.slice(g+1,b),start:g+1,end:b,prefix:E,prefixIndex:g,splitIndex:h,selectionEnd:a};break}}return v},VFe=(t,o={debug:!1,useSelectionEnd:!1})=>{const s=t.selectionStart!==null?t.selectionStart:0,a=t.selectionEnd!==null?t.selectionEnd:0,l=o.useSelectionEnd?a:s,d=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(o.debug){const C=document.querySelector("#input-textarea-caret-position-mirror-div");C!=null&&C.parentNode&&C.parentNode.removeChild(C)}const h=document.createElement("div");h.id="input-textarea-caret-position-mirror-div",document.body.appendChild(h);const v=h.style,g=window.getComputedStyle(t),E=t.nodeName==="INPUT";v.whiteSpace=E?"nowrap":"pre-wrap",E||(v.wordWrap="break-word"),v.position="absolute",o.debug||(v.visibility="hidden"),d.forEach(C=>{if(E&&C==="lineHeight")if(g.boxSizing==="border-box"){const w=Number.parseInt(g.height),I=Number.parseInt(g.paddingTop)+Number.parseInt(g.paddingBottom)+Number.parseInt(g.borderTopWidth)+Number.parseInt(g.borderBottomWidth),R=I+Number.parseInt(g.lineHeight);w>R?v.lineHeight=`${w-I}px`:w===R?v.lineHeight=g.lineHeight:v.lineHeight="0"}else v.lineHeight=g.height;else v[C]=g[C]}),_0()?t.scrollHeight>Number.parseInt(g.height)&&(v.overflowY="scroll"):v.overflow="hidden",h.textContent=t.value.slice(0,Math.max(0,l)),E&&h.textContent&&(h.textContent=h.textContent.replace(/\s/g,""));const b=document.createElement("span");b.textContent=t.value.slice(Math.max(0,l))||".",b.style.position="relative",b.style.left=`${-t.scrollLeft}px`,b.style.top=`${-t.scrollTop}px`,h.appendChild(b);const S={top:b.offsetTop+Number.parseInt(g.borderTopWidth),left:b.offsetLeft+Number.parseInt(g.borderLeftWidth),height:Number.parseInt(g.fontSize)*1.5};return o.debug?b.style.backgroundColor="#aaa":document.body.removeChild(h),S.left>=t.clientWidth&&(S.left=t.clientWidth),S},FFe=ut({...JN,options:{type:Re(Array),default:()=>[]},prefix:{type:Re([String,Array]),default:"@",validator:t=>Mt(t)?t.length===1:t.every(o=>Mt(o)&&o.length===1)},split:{type:String,default:" ",validator:t=>t.length===1},filterOption:{type:Re([Boolean,Function]),default:()=>xFe,validator:t=>t===!1?!0:Ft(t)},placement:{type:Re(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:Re(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Re(Object),default:()=>({})}}),BFe={[Jt]:t=>Mt(t),search:(t,o)=>Mt(t)&&Mt(o),select:(t,o)=>Mt(t.value)&&Mt(o),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent},jFe=ut({options:{type:Re(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),$Fe={select:t=>Mt(t.value)},HFe=me({name:"ElMentionDropdown"}),WFe=me({...HFe,props:jFe,emits:$Fe,setup(t,{expose:o,emit:s}){const a=t,l=Qe("mention"),{t:d}=Fn(),h=ee(-1),v=ee(),g=ee(),E=ee(),b=(L,D)=>[l.be("dropdown","item"),l.is("hovering",h.value===D),l.is("disabled",L.disabled||a.disabled)],S=L=>{L.disabled||a.disabled||s("select",L)},C=L=>{h.value=L},w=U(()=>a.disabled||a.options.every(L=>L.disabled)),I=U(()=>a.options[h.value]),R=()=>{I.value&&s("select",I.value)},N=L=>{const{options:D}=a;if(D.length===0||w.value)return;L==="next"?(h.value++,h.value===D.length&&(h.value=0)):L==="prev"&&(h.value--,h.value<0&&(h.value=D.length-1));const M=D[h.value];if(M.disabled){N(L);return}Vt(()=>O(M))},O=L=>{var D,M,F,W;const{options:z}=a,G=z.findIndex(te=>te.value===L.value),Y=(D=g.value)==null?void 0:D[G];if(Y){const te=(F=(M=E.value)==null?void 0:M.querySelector)==null?void 0:F.call(M,`.${l.be("dropdown","wrap")}`);te&&WN(te,Y)}(W=v.value)==null||W.handleScroll()};return ze(()=>a.options,()=>{w.value||a.options.length===0?h.value=-1:h.value=0},{immediate:!0}),o({hoveringIndex:h,navigateOptions:N,selectHoverOption:R,hoverOption:I}),(L,D)=>($(),le("div",{ref_key:"dropdownRef",ref:E,class:K(p(l).b("dropdown"))},[L.$slots.header?($(),le("div",{key:0,class:K(p(l).be("dropdown","header"))},[Ne(L.$slots,"header")],2)):De("v-if",!0),ln(ge(p(gl),{id:L.contentId,ref_key:"scrollbarRef",ref:v,tag:"ul","wrap-class":p(l).be("dropdown","wrap"),"view-class":p(l).be("dropdown","list"),role:"listbox","aria-label":L.ariaLabel,"aria-orientation":"vertical"},{default:Ce(()=>[($(!0),le(Ut,null,Cn(L.options,(M,F)=>($(),le("li",{id:`${L.contentId}-${F}`,ref_for:!0,ref_key:"optionRefs",ref:g,key:F,class:K(b(M,F)),role:"option","aria-disabled":M.disabled||L.disabled||void 0,"aria-selected":h.value===F,onMousemove:W=>C(F),onClick:Gt(W=>S(M),["stop"])},[Ne(L.$slots,"label",{item:M,index:F},()=>{var W;return[ue("span",null,ot((W=M.label)!=null?W:M.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[Wn,L.options.length>0&&!L.loading]]),L.loading?($(),le("div",{key:1,class:K(p(l).be("dropdown","loading"))},[Ne(L.$slots,"loading",{},()=>[bn(ot(p(d)("el.mention.loading")),1)])],2)):De("v-if",!0),L.$slots.footer?($(),le("div",{key:2,class:K(p(l).be("dropdown","footer"))},[Ne(L.$slots,"footer")],2)):De("v-if",!0)],2))}});var KFe=dt(WFe,[["__file","mention-dropdown.vue"]]);const GFe=me({name:"ElMention",inheritAttrs:!1}),zFe=me({...GFe,props:FFe,emits:BFe,setup(t,{expose:o,emit:s}){const a=t,l=U(()=>mc(a,Object.keys(JN))),d=Qe("mention"),h=Fs(),v=Ts(),g=ee(),E=ee(),b=ee(),S=ee(!1),C=ee(),w=ee(),I=U(()=>a.showArrow?a.placement:`${a.placement}-start`),R=U(()=>a.showArrow?["bottom","top"]:["bottom-start","top-start"]),N=U(()=>{const{filterOption:Z,options:fe}=a;return!w.value||!Z?fe:fe.filter(Ee=>Z(w.value.pattern,Ee))}),O=U(()=>S.value&&(!!N.value.length||a.loading)),V=U(()=>{var Z;return`${v.value}-${(Z=b.value)==null?void 0:Z.hoveringIndex}`}),L=Z=>{s(Jt,Z),G()},D=Z=>{var fe,Ee,ae,X;if(!(!("code"in Z)||(fe=g.value)!=null&&fe.isComposing))switch(Z.code){case Ct.left:case Ct.right:G();break;case Ct.up:case Ct.down:if(!S.value)return;Z.preventDefault(),(Ee=b.value)==null||Ee.navigateOptions(Z.code===Ct.up?"prev":"next");break;case Ct.enter:case Ct.numpadEnter:if(!S.value)return;Z.preventDefault(),(ae=b.value)!=null&&ae.hoverOption?(X=b.value)==null||X.selectHoverOption():S.value=!1;break;case Ct.esc:if(!S.value)return;Z.preventDefault(),S.value=!1;break;case Ct.backspace:if(a.whole&&w.value){const{splitIndex:ie,selectionEnd:se,pattern:J,prefixIndex:pe,prefix:be}=w.value,Ae=z();if(!Ae)return;const _e=Ae.value,Me=a.options.find(Le=>Le.value===J);if((Ft(a.checkIsWhole)?a.checkIsWhole(J,be):Me)&&ie!==-1&&ie+1===se){Z.preventDefault();const Le=_e.slice(0,pe)+_e.slice(ie+1);s(Jt,Le);const Pe=pe;Vt(()=>{Ae.selectionStart=Pe,Ae.selectionEnd=Pe,te()})}}}},{wrapperRef:M}=_d(g,{beforeFocus(){return h.value},afterFocus(){G()},beforeBlur(Z){var fe;return(fe=E.value)==null?void 0:fe.isFocusInsideContent(Z)},afterBlur(){S.value=!1}}),F=()=>{G()},W=Z=>{if(!w.value)return;const fe=z();if(!fe)return;const Ee=fe.value,{split:ae}=a,X=Ee.slice(w.value.end),ie=X.startsWith(ae),se=`${Z.value}${ie?"":ae}`,J=Ee.slice(0,w.value.start)+se+X;s(Jt,J),s("select",Z,w.value.prefix);const pe=w.value.start+se.length+(ie?1:0);Vt(()=>{fe.selectionStart=pe,fe.selectionEnd=pe,fe.focus(),te()})},z=()=>{var Z,fe;return a.type==="textarea"?(Z=g.value)==null?void 0:Z.textarea:(fe=g.value)==null?void 0:fe.input},G=()=>{setTimeout(()=>{Y(),te(),Vt(()=>{var Z;return(Z=E.value)==null?void 0:Z.updatePopper()})},0)},Y=()=>{const Z=z();if(!Z)return;const fe=VFe(Z),Ee=Z.getBoundingClientRect(),ae=g.value.$el.getBoundingClientRect();C.value={position:"absolute",width:0,height:`${fe.height}px`,left:`${fe.left+Ee.left-ae.left}px`,top:`${fe.top+Ee.top-ae.top}px`}},te=()=>{const Z=z();if(document.activeElement!==Z){S.value=!1;return}const{prefix:fe,split:Ee}=a;if(w.value=UFe(Z,fe,Ee),w.value&&w.value.splitIndex===-1){S.value=!0,s("search",w.value.pattern,w.value.prefix);return}S.value=!1};return o({input:g,tooltip:E,dropdownVisible:O}),(Z,fe)=>($(),le("div",{ref_key:"wrapperRef",ref:M,class:K([p(d).b(),p(d).is("disabled",p(h))])},[ge(p(ei),En(En(p(l),Z.$attrs),{ref_key:"elInputRef",ref:g,"model-value":Z.modelValue,disabled:p(h),role:p(O)?"combobox":void 0,"aria-activedescendant":p(O)?p(V)||"":void 0,"aria-controls":p(O)?p(v):void 0,"aria-expanded":p(O)||void 0,"aria-label":Z.ariaLabel,"aria-autocomplete":p(O)?"none":void 0,"aria-haspopup":p(O)?"listbox":void 0,onInput:L,onKeydown:D,onMousedown:F}),fa({_:2},[Cn(Z.$slots,(Ee,ae)=>({name:ae,fn:Ce(X=>[Ne(Z.$slots,ae,sa(ul(X)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),ge(p(Us),{ref_key:"tooltipRef",ref:E,visible:p(O),"popper-class":[p(d).e("popper"),Z.popperClass],"popper-options":Z.popperOptions,placement:p(I),"fallback-placements":p(R),effect:"light",pure:"",offset:Z.offset,"show-arrow":Z.showArrow},{default:Ce(()=>[ue("div",{style:jt(C.value)},null,4)]),content:Ce(()=>{var Ee;return[ge(KFe,{ref_key:"dropdownRef",ref:b,options:p(N),disabled:p(h),loading:Z.loading,"content-id":p(v),"aria-label":Z.ariaLabel,onSelect:W,onClick:Gt((Ee=g.value)==null?void 0:Ee.focus,["stop"])},fa({_:2},[Cn(Z.$slots,(ae,X)=>({name:X,fn:Ce(ie=>[Ne(Z.$slots,X,sa(ul(ie)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var YFe=dt(zFe,[["__file","mention.vue"]]);const qFe=rn(YFe);var XFe=[YEe,pbe,cTe,k2e,pTe,bTe,JK,DTe,LTe,ls,oG,CCe,OCe,GCe,zCe,zwe,RG,Qwe,Wa,awe,gG,oRe,yRe,bRe,S0,zRe,XRe,cIe,lIe,uIe,dIe,hIe,TAe,DAe,LAe,GAe,iz,nOe,KOe,GOe,zOe,mz,GNe,zNe,Dt,oke,_z,ei,Ez,Eke,wke,Wke,Kke,Gke,zke,Qke,HPe,qPe,o1e,zK,Az,CG,ywe,Ewe,p1e,E1e,R1e,gl,Uh,OS,TPe,oDe,fDe,pDe,DDe,VDe,jz,qDe,oLe,sLe,dLe,bMe,SMe,N2e,G2e,z2e,Jp,Z2e,HIe,oxe,lxe,uxe,Us,_Ue,kUe,jS,XUe,fVe,xVe,GVe,gFe,_Fe,AFe,OFe,MFe,qFe];const xa="ElInfiniteScroll",JFe=50,ZFe=200,QFe=0,eBe={delay:{type:Number,default:ZFe},distance:{type:Number,default:QFe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},lP=(t,o)=>Object.entries(eBe).reduce((s,[a,l])=>{var d,h;const{type:v,default:g}=l,E=t.getAttribute(`infinite-scroll-${a}`);let b=(h=(d=o[E])!=null?d:E)!=null?h:g;return b=b==="false"?!1:b,b=v(b),s[a]=Number.isNaN(b)?g:b,s},{}),uq=t=>{const{observer:o}=t[xa];o&&(o.disconnect(),delete t[xa].observer)},tBe=(t,o)=>{const{container:s,containerEl:a,instance:l,observer:d,lastScrollTop:h}=t[xa],{disabled:v,distance:g}=lP(t,l),{clientHeight:E,scrollHeight:b,scrollTop:S}=a,C=S-h;if(t[xa].lastScrollTop=S,d||v||C<0)return;let w=!1;if(s===t)w=b-(E+S)<=g;else{const{clientTop:I,scrollHeight:R}=t,N=sO(t,a);w=S+E>=N+I+R-g}w&&o.call(l)};function wA(t,o){const{containerEl:s,instance:a}=t[xa],{disabled:l}=lP(t,a);l||s.clientHeight===0||(s.scrollHeight<=s.clientHeight?o.call(a):uq(t))}const nBe={async mounted(t,o){const{instance:s,value:a}=o;Ft(a)||qo(xa,"'v-infinite-scroll' binding value must be a function"),await Vt();const{delay:l,immediate:d}=lP(t,s),h=HN(t,!0),v=h===window?document.documentElement:h,g=Ih(tBe.bind(null,t,a),l);if(h){if(t[xa]={instance:s,container:h,containerEl:v,delay:l,cb:a,onScroll:g,lastScrollTop:v.scrollTop},d){const E=new MutationObserver(Ih(wA.bind(null,t,a),JFe));t[xa].observer=E,E.observe(t,{childList:!0,subtree:!0}),wA(t,a)}h.addEventListener("scroll",g)}},unmounted(t){if(!t[xa])return;const{container:o,onScroll:s}=t[xa];o==null||o.removeEventListener("scroll",s),uq(t)},async updated(t){if(!t[xa])await Vt();else{const{containerEl:o,cb:s,observer:a}=t[xa];o.clientHeight&&a&&wA(t,s)}}},YO=nBe;YO.install=t=>{t.directive("InfiniteScroll",YO)};const rBe=YO;function oBe(t){let o;const s=ee(!1),a=er({...t,originalPosition:"",originalOverflow:"",visible:!1});function l(C){a.text=C}function d(){const C=a.parent,w=S.ns;if(!C.vLoadingAddClassList){let I=C.getAttribute("loading-number");I=Number.parseInt(I)-1,I?C.setAttribute("loading-number",I.toString()):(ti(C,w.bm("parent","relative")),C.removeAttribute("loading-number")),ti(C,w.bm("parent","hidden"))}h(),b.unmount()}function h(){var C,w;(w=(C=S.$el)==null?void 0:C.parentNode)==null||w.removeChild(S.$el)}function v(){var C;t.beforeClose&&!t.beforeClose()||(s.value=!0,clearTimeout(o),o=setTimeout(g,400),a.visible=!1,(C=t.closed)==null||C.call(t))}function g(){if(!s.value)return;const C=a.parent;s.value=!1,C.vLoadingAddClassList=void 0,d()}const b=lW(me({name:"ElLoading",setup(C,{expose:w}){const{ns:I,zIndex:R}=m0("loading");return w({ns:I,zIndex:R}),()=>{const N=a.spinner||a.svg,O=Ht("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...N?{innerHTML:N}:{}},[Ht("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),V=a.text?Ht("p",{class:I.b("text")},[a.text]):void 0;return Ht(hs,{name:I.b("fade"),onAfterLeave:g},{default:Ce(()=>[ln(ge("div",{style:{backgroundColor:a.background||""},class:[I.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[Ht("div",{class:I.b("spinner")},[O,V])]),[[Wn,a.visible]])])})}}})),S=b.mount(document.createElement("div"));return{...ds(a),setText:l,removeElLoadingChild:h,close:v,handleAfterLeave:g,vm:S,get $el(){return S.$el}}}let Vb;const qO=function(t={}){if(!Vn)return;const o=sBe(t);if(o.fullscreen&&Vb)return Vb;const s=oBe({...o,closed:()=>{var l;(l=o.closed)==null||l.call(o),o.fullscreen&&(Vb=void 0)}});iBe(o,o.parent,s),_8(o,o.parent,s),o.parent.vLoadingAddClassList=()=>_8(o,o.parent,s);let a=o.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",o.parent.setAttribute("loading-number",a),o.parent.appendChild(s.$el),Vt(()=>s.visible.value=o.visible),o.fullscreen&&(Vb=s),s},sBe=t=>{var o,s,a,l;let d;return Mt(t.target)?d=(o=document.querySelector(t.target))!=null?o:document.body:d=t.target||document.body,{parent:d===document.body||t.body?document.body:d,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:d===document.body&&((s=t.fullscreen)!=null?s:!0),lock:(a=t.lock)!=null?a:!1,customClass:t.customClass||"",visible:(l=t.visible)!=null?l:!0,beforeClose:t.beforeClose,closed:t.closed,target:d}},iBe=async(t,o,s)=>{const{nextZIndex:a}=s.vm.zIndex||s.vm._.exposed.zIndex,l={};if(t.fullscreen)s.originalPosition.value=ql(document.body,"position"),s.originalOverflow.value=ql(document.body,"overflow"),l.zIndex=a();else if(t.parent===document.body){s.originalPosition.value=ql(document.body,"position"),await Vt();for(const d of["top","left"]){const h=d==="top"?"scrollTop":"scrollLeft";l[d]=`${t.target.getBoundingClientRect()[d]+document.body[h]+document.documentElement[h]-Number.parseInt(ql(document.body,`margin-${d}`),10)}px`}for(const d of["height","width"])l[d]=`${t.target.getBoundingClientRect()[d]}px`}else s.originalPosition.value=ql(o,"position");for(const[d,h]of Object.entries(l))s.$el.style[d]=h},_8=(t,o,s)=>{const a=s.vm.ns||s.vm._.exposed.ns;["absolute","fixed","sticky"].includes(s.originalPosition.value)?ti(o,a.bm("parent","relative")):Ua(o,a.bm("parent","relative")),t.fullscreen&&t.lock?Ua(o,a.bm("parent","hidden")):ti(o,a.bm("parent","hidden"))},oS=Symbol("ElLoading"),E8=(t,o)=>{var s,a,l,d;const h=o.instance,v=C=>fn(o.value)?o.value[C]:void 0,g=C=>{const w=Mt(C)&&(h==null?void 0:h[C])||C;return w&&ee(w)},E=C=>g(v(C)||t.getAttribute(`element-loading-${ou(C)}`)),b=(s=v("fullscreen"))!=null?s:o.modifiers.fullscreen,S={text:E("text"),svg:E("svg"),svgViewBox:E("svgViewBox"),spinner:E("spinner"),background:E("background"),customClass:E("customClass"),fullscreen:b,target:(a=v("target"))!=null?a:b?void 0:t,body:(l=v("body"))!=null?l:o.modifiers.body,lock:(d=v("lock"))!=null?d:o.modifiers.lock};t[oS]={options:S,instance:qO(S)}},aBe=(t,o)=>{for(const s of Object.keys(o))xr(o[s])&&(o[s].value=t[s])},y8={mounted(t,o){o.value&&E8(t,o)},updated(t,o){const s=t[oS];o.oldValue!==o.value&&(o.value&&!o.oldValue?E8(t,o):o.value&&o.oldValue?fn(o.value)&&aBe(o.value,s.options):s==null||s.instance.close())},unmounted(t){var o;(o=t[oS])==null||o.instance.close(),t[oS]=null}},cBe={install(t){t.directive("loading",y8),t.config.globalProperties.$loading=qO},directive:y8,service:qO},dq=["success","info","warning","error"],Ys=lo({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Vn?document.body:void 0}),lBe=ut({customClass:{type:String,default:Ys.customClass},center:{type:Boolean,default:Ys.center},dangerouslyUseHTMLString:{type:Boolean,default:Ys.dangerouslyUseHTMLString},duration:{type:Number,default:Ys.duration},icon:{type:yr,default:Ys.icon},id:{type:String,default:Ys.id},message:{type:Re([String,Object,Function]),default:Ys.message},onClose:{type:Re(Function),default:Ys.onClose},showClose:{type:Boolean,default:Ys.showClose},type:{type:String,values:dq,default:Ys.type},plain:{type:Boolean,default:Ys.plain},offset:{type:Number,default:Ys.offset},zIndex:{type:Number,default:Ys.zIndex},grouping:{type:Boolean,default:Ys.grouping},repeatNum:{type:Number,default:Ys.repeatNum}}),uBe={destroy:()=>!0},vc=o5([]),dBe=t=>{const o=vc.findIndex(l=>l.id===t),s=vc[o];let a;return o>0&&(a=vc[o-1]),{current:s,prev:a}},hBe=t=>{const{prev:o}=dBe(t);return o?o.vm.exposed.bottom.value:0},fBe=(t,o)=>vc.findIndex(a=>a.id===t)>0?16:o,pBe=me({name:"ElMessage"}),mBe=me({...pBe,props:lBe,emits:uBe,setup(t,{expose:o}){const s=t,{Close:a}=XN,{ns:l,zIndex:d}=m0("message"),{currentZIndex:h,nextZIndex:v}=d,g=ee(),E=ee(!1),b=ee(0);let S;const C=U(()=>s.type?s.type==="error"?"danger":s.type:"info"),w=U(()=>{const W=s.type;return{[l.bm("icon",W)]:W&&fd[W]}}),I=U(()=>s.icon||fd[s.type]||""),R=U(()=>hBe(s.id)),N=U(()=>fBe(s.id,s.offset)+R.value),O=U(()=>b.value+N.value),V=U(()=>({top:`${N.value}px`,zIndex:h.value}));function L(){s.duration!==0&&({stop:S}=Mh(()=>{M()},s.duration))}function D(){S==null||S()}function M(){E.value=!1}function F({code:W}){W===Ct.esc&&M()}return dn(()=>{L(),v(),E.value=!0}),ze(()=>s.repeatNum,()=>{D(),L()}),gr(document,"keydown",F),co(g,()=>{b.value=g.value.getBoundingClientRect().height}),o({visible:E,bottom:O,close:M}),(W,z)=>($(),Ve(hs,{name:p(l).b("fade"),onBeforeLeave:W.onClose,onAfterLeave:G=>W.$emit("destroy"),persisted:""},{default:Ce(()=>[ln(ue("div",{id:W.id,ref_key:"messageRef",ref:g,class:K([p(l).b(),{[p(l).m(W.type)]:W.type},p(l).is("center",W.center),p(l).is("closable",W.showClose),p(l).is("plain",W.plain),W.customClass]),style:jt(p(V)),role:"alert",onMouseenter:D,onMouseleave:L},[W.repeatNum>1?($(),Ve(p(JK),{key:0,value:W.repeatNum,type:p(C),class:K(p(l).e("badge"))},null,8,["value","type","class"])):De("v-if",!0),p(I)?($(),Ve(p(Dt),{key:1,class:K([p(l).e("icon"),p(w)])},{default:Ce(()=>[($(),Ve(gn(p(I))))]),_:1},8,["class"])):De("v-if",!0),Ne(W.$slots,"default",{},()=>[W.dangerouslyUseHTMLString?($(),le(Ut,{key:1},[De(" Caution here, message could've been compromised, never use user's input as message "),ue("p",{class:K(p(l).e("content")),innerHTML:W.message},null,10,["innerHTML"])],2112)):($(),le("p",{key:0,class:K(p(l).e("content"))},ot(W.message),3))]),W.showClose?($(),Ve(p(Dt),{key:2,class:K(p(l).e("closeBtn")),onClick:Gt(M,["stop"])},{default:Ce(()=>[ge(p(a))]),_:1},8,["class","onClick"])):De("v-if",!0)],46,["id"]),[[Wn,E.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var vBe=dt(mBe,[["__file","message.vue"]]);let gBe=1;const hq=t=>{const o=!t||Mt(t)||Kr(t)||Ft(t)?{message:t}:t,s={...Ys,...o};if(!s.appendTo)s.appendTo=document.body;else if(Mt(s.appendTo)){let a=document.querySelector(s.appendTo);mi(a)||(a=document.body),s.appendTo=a}return wr(fc.grouping)&&!s.grouping&&(s.grouping=fc.grouping),$t(fc.duration)&&s.duration===3e3&&(s.duration=fc.duration),$t(fc.offset)&&s.offset===16&&(s.offset=fc.offset),wr(fc.showClose)&&!s.showClose&&(s.showClose=fc.showClose),s},_Be=t=>{const o=vc.indexOf(t);if(o===-1)return;vc.splice(o,1);const{handler:s}=t;s.close()},EBe=({appendTo:t,...o},s)=>{const a=`message_${gBe++}`,l=o.onClose,d=document.createElement("div"),h={...o,id:a,onClose:()=>{l==null||l(),_Be(b)},onDestroy:()=>{ad(null,d)}},v=ge(vBe,h,Ft(h.message)||Kr(h.message)?{default:Ft(h.message)?h.message:()=>h.message}:null);v.appContext=s||sm._context,ad(v,d),t.appendChild(d.firstElementChild);const g=v.component,b={id:a,vnode:v,vm:g,handler:{close:()=>{g.exposed.visible.value=!1}},props:v.component.props};return b},sm=(t={},o)=>{if(!Vn)return{close:()=>{}};const s=hq(t);if(s.grouping&&vc.length){const l=vc.find(({vnode:d})=>{var h;return((h=d.props)==null?void 0:h.message)===s.message});if(l)return l.props.repeatNum+=1,l.props.type=s.type,l.handler}if($t(fc.max)&&vc.length>=fc.max)return{close:()=>{}};const a=EBe(s,o);return vc.push(a),a.handler};dq.forEach(t=>{sm[t]=(o={},s)=>{const a=hq(o);return sm({...a,type:t},s)}});function yBe(t){for(const o of vc)(!t||t===o.props.type)&&o.handler.close()}sm.closeAll=yBe;sm._context=null;const XO=vK(sm,"$message"),JO="_trap-focus-children",Ch=[],b8=t=>{if(Ch.length===0)return;const o=Ch[Ch.length-1][JO];if(o.length>0&&t.code===Ct.tab){if(o.length===1){t.preventDefault(),document.activeElement!==o[0]&&o[0].focus();return}const s=t.shiftKey,a=t.target===o[0],l=t.target===o[o.length-1];a&&s&&(t.preventDefault(),o[o.length-1].focus()),l&&!s&&(t.preventDefault(),o[0].focus())}},bBe={beforeMount(t){t[JO]=L$(t),Ch.push(t),Ch.length<=1&&document.addEventListener("keydown",b8)},updated(t){Vt(()=>{t[JO]=L$(t)})},unmounted(){Ch.shift(),Ch.length===0&&document.removeEventListener("keydown",b8)}},SBe=me({name:"ElMessageBox",directives:{TrapFocus:bBe},components:{ElButton:ls,ElFocusTrap:mm,ElInput:ei,ElOverlay:wk,ElIcon:Dt,...XN},inheritAttrs:!1,props:{buttonSize:{type:String,validator:Hz},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:o}){const{locale:s,zIndex:a,ns:l,size:d}=m0("message-box",U(()=>t.buttonSize)),{t:h}=s,{nextZIndex:v}=a,g=ee(!1),E=er({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:Zl(hl),cancelButtonLoadingIcon:Zl(hl),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:v()}),b=U(()=>{const X=E.type;return{[l.bm("icon",X)]:X&&fd[X]}}),S=Ts(),C=Ts(),w=U(()=>{const X=E.type;return E.icon||X&&fd[X]||""}),I=U(()=>!!E.message),R=ee(),N=ee(),O=ee(),V=ee(),L=ee(),D=U(()=>E.confirmButtonClass);ze(()=>E.inputValue,async X=>{await Vt(),t.boxType==="prompt"&&X&&Z()},{immediate:!0}),ze(()=>g.value,X=>{var ie,se;X&&(t.boxType!=="prompt"&&(E.autofocus?O.value=(se=(ie=L.value)==null?void 0:ie.$el)!=null?se:R.value:O.value=R.value),E.zIndex=v()),t.boxType==="prompt"&&(X?Vt().then(()=>{var J;V.value&&V.value.$el&&(E.autofocus?O.value=(J=fe())!=null?J:R.value:O.value=R.value)}):(E.editorErrorMessage="",E.validateError=!1))});const M=U(()=>t.draggable),F=U(()=>t.overflow);nz(R,N,M,F),dn(async()=>{await Vt(),t.closeOnHashChange&&window.addEventListener("hashchange",W)}),Rr(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",W)});function W(){g.value&&(g.value=!1,Vt(()=>{E.action&&o("action",E.action)}))}const z=()=>{t.closeOnClickModal&&te(E.distinguishCancelAndClose?"close":"cancel")},G=Ck(z),Y=X=>{if(E.inputType!=="textarea")return X.preventDefault(),te("confirm")},te=X=>{var ie;t.boxType==="prompt"&&X==="confirm"&&!Z()||(E.action=X,E.beforeClose?(ie=E.beforeClose)==null||ie.call(E,X,E,W):W())},Z=()=>{if(t.boxType==="prompt"){const X=E.inputPattern;if(X&&!X.test(E.inputValue||""))return E.editorErrorMessage=E.inputErrorMessage||h("el.messagebox.error"),E.validateError=!0,!1;const ie=E.inputValidator;if(Ft(ie)){const se=ie(E.inputValue);if(se===!1)return E.editorErrorMessage=E.inputErrorMessage||h("el.messagebox.error"),E.validateError=!0,!1;if(Mt(se))return E.editorErrorMessage=se,E.validateError=!0,!1}}return E.editorErrorMessage="",E.validateError=!1,!0},fe=()=>{var X,ie;const se=(X=V.value)==null?void 0:X.$refs;return(ie=se==null?void 0:se.input)!=null?ie:se==null?void 0:se.textarea},Ee=()=>{te("close")},ae=()=>{t.closeOnPressEscape&&Ee()};return t.lockScroll&&Rk(g),{...ds(E),ns:l,overlayEvent:G,visible:g,hasMessage:I,typeClass:b,contentId:S,inputId:C,btnSize:d,iconComponent:w,confirmButtonClasses:D,rootRef:R,focusStartRef:O,headerRef:N,inputRef:V,confirmRef:L,doClose:W,handleClose:Ee,onCloseRequested:ae,handleWrapperClick:z,handleInputEnter:Y,handleAction:te,t:h}}});function TBe(t,o,s,a,l,d){const h=_n("el-icon"),v=_n("el-input"),g=_n("el-button"),E=_n("el-focus-trap"),b=_n("el-overlay");return $(),Ve(hs,{name:"fade-in-linear",onAfterLeave:S=>t.$emit("vanish"),persisted:""},{default:Ce(()=>[ln(ge(b,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:Ce(()=>[ue("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:K(`${t.ns.namespace.value}-overlay-message-box`),onClick:t.overlayEvent.onClick,onMousedown:t.overlayEvent.onMousedown,onMouseup:t.overlayEvent.onMouseup},[ge(E,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:Ce(()=>[ue("div",{ref:"rootRef",class:K([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:jt(t.customStyle),tabindex:"-1",onClick:Gt(()=>{},["stop"])},[t.title!==null&&t.title!==void 0?($(),le("div",{key:0,ref:"headerRef",class:K([t.ns.e("header"),{"show-close":t.showClose}])},[ue("div",{class:K(t.ns.e("title"))},[t.iconComponent&&t.center?($(),Ve(h,{key:0,class:K([t.ns.e("status"),t.typeClass])},{default:Ce(()=>[($(),Ve(gn(t.iconComponent)))]),_:1},8,["class"])):De("v-if",!0),ue("span",null,ot(t.title),1)],2),t.showClose?($(),le("button",{key:0,type:"button",class:K(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:S=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),onKeydown:Cr(Gt(S=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[ge(h,{class:K(t.ns.e("close"))},{default:Ce(()=>[($(),Ve(gn(t.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):De("v-if",!0)],2)):De("v-if",!0),ue("div",{id:t.contentId,class:K(t.ns.e("content"))},[ue("div",{class:K(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?($(),Ve(h,{key:0,class:K([t.ns.e("status"),t.typeClass])},{default:Ce(()=>[($(),Ve(gn(t.iconComponent)))]),_:1},8,["class"])):De("v-if",!0),t.hasMessage?($(),le("div",{key:1,class:K(t.ns.e("message"))},[Ne(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?($(),Ve(gn(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):($(),Ve(gn(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:Ce(()=>[bn(ot(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):De("v-if",!0)],2),ln(ue("div",{class:K(t.ns.e("input"))},[ge(v,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":S=>t.inputValue=S,type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:K({invalid:t.validateError}),onKeydown:Cr(t.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),ue("div",{class:K(t.ns.e("errormsg")),style:jt({visibility:t.editorErrorMessage?"visible":"hidden"})},ot(t.editorErrorMessage),7)],2),[[Wn,t.showInput]])],10,["id"]),ue("div",{class:K(t.ns.e("btns"))},[t.showCancelButton?($(),Ve(g,{key:0,loading:t.cancelButtonLoading,"loading-icon":t.cancelButtonLoadingIcon,class:K([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:S=>t.handleAction("cancel"),onKeydown:Cr(Gt(S=>t.handleAction("cancel"),["prevent"]),["enter"])},{default:Ce(()=>[bn(ot(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):De("v-if",!0),ln(ge(g,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,"loading-icon":t.confirmButtonLoadingIcon,class:K([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:S=>t.handleAction("confirm"),onKeydown:Cr(Gt(S=>t.handleAction("confirm"),["prevent"]),["enter"])},{default:Ce(()=>[bn(ot(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[Wn,t.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[Wn,t.visible]])]),_:3},8,["onAfterLeave"])}var CBe=dt(SBe,[["render",TBe],["__file","index.vue"]]);const Jg=new Map,wBe=t=>{let o=document.body;return t.appendTo&&(Mt(t.appendTo)&&(o=document.querySelector(t.appendTo)),mi(t.appendTo)&&(o=t.appendTo),mi(o)||(o=document.body)),o},RBe=(t,o,s=null)=>{const a=ge(CBe,t,Ft(t.message)||Kr(t.message)?{default:Ft(t.message)?t.message:()=>t.message}:null);return a.appContext=s,ad(a,o),wBe(t).appendChild(o.firstElementChild),a.component},IBe=()=>document.createElement("div"),ABe=(t,o)=>{const s=IBe();t.onVanish=()=>{ad(null,s),Jg.delete(l)},t.onAction=d=>{const h=Jg.get(l);let v;t.showInput?v={value:l.inputValue,action:d}:v=d,t.callback?t.callback(v,a.proxy):d==="cancel"||d==="close"?t.distinguishCancelAndClose&&d!=="cancel"?h.reject("close"):h.reject("cancel"):h.resolve(v)};const a=RBe(t,s,o),l=a.proxy;for(const d in t)zn(t,d)&&!zn(l.$props,d)&&(d==="closeIcon"&&fn(t[d])?l[d]=Zl(t[d]):l[d]=t[d]);return l.visible=!0,l};function ym(t,o=null){if(!Vn)return Promise.reject();let s;return Mt(t)||Kr(t)?t={message:t}:s=t.callback,new Promise((a,l)=>{const d=ABe(t,o??ym._context);Jg.set(d,{options:t,callback:s,resolve:a,reject:l})})}const OBe=["alert","confirm","prompt"],NBe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};OBe.forEach(t=>{ym[t]=kBe(t)});function kBe(t){return(o,s,a,l)=>{let d="";return fn(s)?(a=s,d=""):Xn(s)?d="":d=s,ym(Object.assign({title:d,message:o,type:"",...NBe[t]},a,{boxType:t}),l)}}ym.close=()=>{Jg.forEach((t,o)=>{o.doClose()}),Jg.clear()};ym._context=null;const Xu=ym;Xu.install=t=>{Xu._context=t._context,t.config.globalProperties.$msgbox=Xu,t.config.globalProperties.$messageBox=Xu,t.config.globalProperties.$alert=Xu.alert,t.config.globalProperties.$confirm=Xu.confirm,t.config.globalProperties.$prompt=Xu.prompt};const PBe=Xu,fq=["success","info","warning","error"],DBe=ut({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:yr},id:{type:String,default:""},message:{type:Re([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:Re(Function),default:()=>{}},onClose:{type:Re(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...fq,""],default:""},zIndex:Number}),LBe={destroy:()=>!0},MBe=me({name:"ElNotification"}),xBe=me({...MBe,props:DBe,emits:LBe,setup(t,{expose:o}){const s=t,{ns:a,zIndex:l}=m0("notification"),{nextZIndex:d,currentZIndex:h}=l,{Close:v}=qN,g=ee(!1);let E;const b=U(()=>{const L=s.type;return L&&fd[s.type]?a.m(L):""}),S=U(()=>s.type&&fd[s.type]||s.icon),C=U(()=>s.position.endsWith("right")?"right":"left"),w=U(()=>s.position.startsWith("top")?"top":"bottom"),I=U(()=>{var L;return{[w.value]:`${s.offset}px`,zIndex:(L=s.zIndex)!=null?L:h.value}});function R(){s.duration>0&&({stop:E}=Mh(()=>{g.value&&O()},s.duration))}function N(){E==null||E()}function O(){g.value=!1}function V({code:L}){L===Ct.delete||L===Ct.backspace?N():L===Ct.esc?g.value&&O():R()}return dn(()=>{R(),d(),g.value=!0}),gr(document,"keydown",V),o({visible:g,close:O}),(L,D)=>($(),Ve(hs,{name:p(a).b("fade"),onBeforeLeave:L.onClose,onAfterLeave:M=>L.$emit("destroy"),persisted:""},{default:Ce(()=>[ln(ue("div",{id:L.id,class:K([p(a).b(),L.customClass,p(C)]),style:jt(p(I)),role:"alert",onMouseenter:N,onMouseleave:R,onClick:L.onClick},[p(S)?($(),Ve(p(Dt),{key:0,class:K([p(a).e("icon"),p(b)])},{default:Ce(()=>[($(),Ve(gn(p(S))))]),_:1},8,["class"])):De("v-if",!0),ue("div",{class:K(p(a).e("group"))},[ue("h2",{class:K(p(a).e("title")),textContent:ot(L.title)},null,10,["textContent"]),ln(ue("div",{class:K(p(a).e("content")),style:jt(L.title?void 0:{margin:0})},[Ne(L.$slots,"default",{},()=>[L.dangerouslyUseHTMLString?($(),le(Ut,{key:1},[De(" Caution here, message could've been compromised, never use user's input as message "),ue("p",{innerHTML:L.message},null,8,["innerHTML"])],2112)):($(),le("p",{key:0},ot(L.message),1))])],6),[[Wn,L.message]]),L.showClose?($(),Ve(p(Dt),{key:0,class:K(p(a).e("closeBtn")),onClick:Gt(O,["stop"])},{default:Ce(()=>[ge(p(v))]),_:1},8,["class","onClick"])):De("v-if",!0)],2)],46,["id","onClick"]),[[Wn,g.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var UBe=dt(xBe,[["__file","notification.vue"]]);const $S={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},ZO=16;let VBe=1;const im=function(t={},o){if(!Vn)return{close:()=>{}};(Mt(t)||Kr(t))&&(t={message:t});const s=t.position||"top-right";let a=t.offset||0;$S[s].forEach(({vm:b})=>{var S;a+=(((S=b.el)==null?void 0:S.offsetHeight)||0)+ZO}),a+=ZO;const l=`notification_${VBe++}`,d=t.onClose,h={...t,offset:a,id:l,onClose:()=>{FBe(l,s,d)}};let v=document.body;mi(t.appendTo)?v=t.appendTo:Mt(t.appendTo)&&(v=document.querySelector(t.appendTo)),mi(v)||(v=document.body);const g=document.createElement("div"),E=ge(UBe,h,Ft(h.message)?h.message:Kr(h.message)?()=>h.message:null);return E.appContext=Xn(o)?im._context:o,E.props.onDestroy=()=>{ad(null,g)},ad(E,g),$S[s].push({vm:E}),v.appendChild(g.firstElementChild),{close:()=>{E.component.exposed.visible.value=!1}}};fq.forEach(t=>{im[t]=(o={},s)=>((Mt(o)||Kr(o))&&(o={message:o}),im({...o,type:t},s))});function FBe(t,o,s){const a=$S[o],l=a.findIndex(({vm:E})=>{var b;return((b=E.component)==null?void 0:b.props.id)===t});if(l===-1)return;const{vm:d}=a[l];if(!d)return;s==null||s(d);const h=d.el.offsetHeight,v=o.split("-")[0];a.splice(l,1);const g=a.length;if(!(g<1))for(let E=l;E<g;E++){const{el:b,component:S}=a[E].vm,C=Number.parseInt(b.style[v],10)-h-ZO;S.props.offset=C}}function BBe(){for(const t of Object.values($S))t.forEach(({vm:o})=>{o.component.exposed.visible.value=!1})}im.closeAll=BBe;im._context=null;const jBe=vK(im,"$notify");var $Be=[rBe,cBe,XO,PBe,jBe,Iz],HBe=VEe([...XFe,...$Be]);function pq(t,o){return function(){return t.apply(o,arguments)}}const{toString:WBe}=Object.prototype,{getPrototypeOf:uP}=Object,L0=(t=>o=>{const s=WBe.call(o);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Nc=t=>(t=t.toLowerCase(),o=>L0(o)===t),M0=t=>o=>typeof o===t,{isArray:bm}=Array,Zg=M0("undefined");function KBe(t){return t!==null&&!Zg(t)&&t.constructor!==null&&!Zg(t.constructor)&&ha(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const mq=Nc("ArrayBuffer");function GBe(t){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(t):o=t&&t.buffer&&mq(t.buffer),o}const zBe=M0("string"),ha=M0("function"),vq=M0("number"),x0=t=>t!==null&&typeof t=="object",YBe=t=>t===!0||t===!1,sS=t=>{if(L0(t)!=="object")return!1;const o=uP(t);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},qBe=Nc("Date"),XBe=Nc("File"),JBe=Nc("Blob"),ZBe=Nc("FileList"),QBe=t=>x0(t)&&ha(t.pipe),e3e=t=>{let o;return t&&(typeof FormData=="function"&&t instanceof FormData||ha(t.append)&&((o=L0(t))==="formdata"||o==="object"&&ha(t.toString)&&t.toString()==="[object FormData]"))},t3e=Nc("URLSearchParams"),[n3e,r3e,o3e,s3e]=["ReadableStream","Request","Response","Headers"].map(Nc),i3e=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function y_(t,o,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let a,l;if(typeof t!="object"&&(t=[t]),bm(t))for(a=0,l=t.length;a<l;a++)o.call(null,t[a],a,t);else{const d=s?Object.getOwnPropertyNames(t):Object.keys(t),h=d.length;let v;for(a=0;a<h;a++)v=d[a],o.call(null,t[v],v,t)}}function gq(t,o){o=o.toLowerCase();const s=Object.keys(t);let a=s.length,l;for(;a-- >0;)if(l=s[a],o===l.toLowerCase())return l;return null}const wh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_q=t=>!Zg(t)&&t!==wh;function QO(){const{caseless:t}=_q(this)&&this||{},o={},s=(a,l)=>{const d=t&&gq(o,l)||l;sS(o[d])&&sS(a)?o[d]=QO(o[d],a):sS(a)?o[d]=QO({},a):bm(a)?o[d]=a.slice():o[d]=a};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&y_(arguments[a],s);return o}const a3e=(t,o,s,{allOwnKeys:a}={})=>(y_(o,(l,d)=>{s&&ha(l)?t[d]=pq(l,s):t[d]=l},{allOwnKeys:a}),t),c3e=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),l3e=(t,o,s,a)=>{t.prototype=Object.create(o.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:o.prototype}),s&&Object.assign(t.prototype,s)},u3e=(t,o,s,a)=>{let l,d,h;const v={};if(o=o||{},t==null)return o;do{for(l=Object.getOwnPropertyNames(t),d=l.length;d-- >0;)h=l[d],(!a||a(h,t,o))&&!v[h]&&(o[h]=t[h],v[h]=!0);t=s!==!1&&uP(t)}while(t&&(!s||s(t,o))&&t!==Object.prototype);return o},d3e=(t,o,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=o.length;const a=t.indexOf(o,s);return a!==-1&&a===s},h3e=t=>{if(!t)return null;if(bm(t))return t;let o=t.length;if(!vq(o))return null;const s=new Array(o);for(;o-- >0;)s[o]=t[o];return s},f3e=(t=>o=>t&&o instanceof t)(typeof Uint8Array<"u"&&uP(Uint8Array)),p3e=(t,o)=>{const a=(t&&t[Symbol.iterator]).call(t);let l;for(;(l=a.next())&&!l.done;){const d=l.value;o.call(t,d[0],d[1])}},m3e=(t,o)=>{let s;const a=[];for(;(s=t.exec(o))!==null;)a.push(s);return a},v3e=Nc("HTMLFormElement"),g3e=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,l){return a.toUpperCase()+l}),S8=(({hasOwnProperty:t})=>(o,s)=>t.call(o,s))(Object.prototype),_3e=Nc("RegExp"),Eq=(t,o)=>{const s=Object.getOwnPropertyDescriptors(t),a={};y_(s,(l,d)=>{let h;(h=o(l,d,t))!==!1&&(a[d]=h||l)}),Object.defineProperties(t,a)},E3e=t=>{Eq(t,(o,s)=>{if(ha(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=t[s];if(ha(a)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},y3e=(t,o)=>{const s={},a=l=>{l.forEach(d=>{s[d]=!0})};return bm(t)?a(t):a(String(t).split(o)),s},b3e=()=>{},S3e=(t,o)=>t!=null&&Number.isFinite(t=+t)?t:o;function T3e(t){return!!(t&&ha(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const C3e=t=>{const o=new Array(10),s=(a,l)=>{if(x0(a)){if(o.indexOf(a)>=0)return;if(!("toJSON"in a)){o[l]=a;const d=bm(a)?[]:{};return y_(a,(h,v)=>{const g=s(h,l+1);!Zg(g)&&(d[v]=g)}),o[l]=void 0,d}}return a};return s(t,0)},w3e=Nc("AsyncFunction"),R3e=t=>t&&(x0(t)||ha(t))&&ha(t.then)&&ha(t.catch),yq=((t,o)=>t?setImmediate:o?((s,a)=>(wh.addEventListener("message",({source:l,data:d})=>{l===wh&&d===s&&a.length&&a.shift()()},!1),l=>{a.push(l),wh.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ha(wh.postMessage)),I3e=typeof queueMicrotask<"u"?queueMicrotask.bind(wh):typeof process<"u"&&process.nextTick||yq,Tt={isArray:bm,isArrayBuffer:mq,isBuffer:KBe,isFormData:e3e,isArrayBufferView:GBe,isString:zBe,isNumber:vq,isBoolean:YBe,isObject:x0,isPlainObject:sS,isReadableStream:n3e,isRequest:r3e,isResponse:o3e,isHeaders:s3e,isUndefined:Zg,isDate:qBe,isFile:XBe,isBlob:JBe,isRegExp:_3e,isFunction:ha,isStream:QBe,isURLSearchParams:t3e,isTypedArray:f3e,isFileList:ZBe,forEach:y_,merge:QO,extend:a3e,trim:i3e,stripBOM:c3e,inherits:l3e,toFlatObject:u3e,kindOf:L0,kindOfTest:Nc,endsWith:d3e,toArray:h3e,forEachEntry:p3e,matchAll:m3e,isHTMLForm:v3e,hasOwnProperty:S8,hasOwnProp:S8,reduceDescriptors:Eq,freezeMethods:E3e,toObjectSet:y3e,toCamelCase:g3e,noop:b3e,toFiniteNumber:S3e,findKey:gq,global:wh,isContextDefined:_q,isSpecCompliantForm:T3e,toJSONObject:C3e,isAsyncFn:w3e,isThenable:R3e,setImmediate:yq,asap:I3e};function ar(t,o,s,a,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",o&&(this.code=o),s&&(this.config=s),a&&(this.request=a),l&&(this.response=l,this.status=l.status?l.status:null)}Tt.inherits(ar,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Tt.toJSONObject(this.config),code:this.code,status:this.status}}});const bq=ar.prototype,Sq={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Sq[t]={value:t}});Object.defineProperties(ar,Sq);Object.defineProperty(bq,"isAxiosError",{value:!0});ar.from=(t,o,s,a,l,d)=>{const h=Object.create(bq);return Tt.toFlatObject(t,h,function(g){return g!==Error.prototype},v=>v!=="isAxiosError"),ar.call(h,t.message,o,s,a,l),h.cause=t,h.name=t.name,d&&Object.assign(h,d),h};const A3e=null;function eN(t){return Tt.isPlainObject(t)||Tt.isArray(t)}function Tq(t){return Tt.endsWith(t,"[]")?t.slice(0,-2):t}function T8(t,o,s){return t?t.concat(o).map(function(l,d){return l=Tq(l),!s&&d?"["+l+"]":l}).join(s?".":""):o}function O3e(t){return Tt.isArray(t)&&!t.some(eN)}const N3e=Tt.toFlatObject(Tt,{},null,function(o){return/^is[A-Z]/.test(o)});function U0(t,o,s){if(!Tt.isObject(t))throw new TypeError("target must be an object");o=o||new FormData,s=Tt.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,N){return!Tt.isUndefined(N[R])});const a=s.metaTokens,l=s.visitor||b,d=s.dots,h=s.indexes,g=(s.Blob||typeof Blob<"u"&&Blob)&&Tt.isSpecCompliantForm(o);if(!Tt.isFunction(l))throw new TypeError("visitor must be a function");function E(I){if(I===null)return"";if(Tt.isDate(I))return I.toISOString();if(!g&&Tt.isBlob(I))throw new ar("Blob is not supported. Use a Buffer instead.");return Tt.isArrayBuffer(I)||Tt.isTypedArray(I)?g&&typeof Blob=="function"?new Blob([I]):Buffer.from(I):I}function b(I,R,N){let O=I;if(I&&!N&&typeof I=="object"){if(Tt.endsWith(R,"{}"))R=a?R:R.slice(0,-2),I=JSON.stringify(I);else if(Tt.isArray(I)&&O3e(I)||(Tt.isFileList(I)||Tt.endsWith(R,"[]"))&&(O=Tt.toArray(I)))return R=Tq(R),O.forEach(function(L,D){!(Tt.isUndefined(L)||L===null)&&o.append(h===!0?T8([R],D,d):h===null?R:R+"[]",E(L))}),!1}return eN(I)?!0:(o.append(T8(N,R,d),E(I)),!1)}const S=[],C=Object.assign(N3e,{defaultVisitor:b,convertValue:E,isVisitable:eN});function w(I,R){if(!Tt.isUndefined(I)){if(S.indexOf(I)!==-1)throw Error("Circular reference detected in "+R.join("."));S.push(I),Tt.forEach(I,function(O,V){(!(Tt.isUndefined(O)||O===null)&&l.call(o,O,Tt.isString(V)?V.trim():V,R,C))===!0&&w(O,R?R.concat(V):[V])}),S.pop()}}if(!Tt.isObject(t))throw new TypeError("data must be an object");return w(t),o}function C8(t){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return o[a]})}function dP(t,o){this._pairs=[],t&&U0(t,this,o)}const Cq=dP.prototype;Cq.append=function(o,s){this._pairs.push([o,s])};Cq.toString=function(o){const s=o?function(a){return o.call(this,a,C8)}:C8;return this._pairs.map(function(l){return s(l[0])+"="+s(l[1])},"").join("&")};function k3e(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wq(t,o,s){if(!o)return t;const a=s&&s.encode||k3e;Tt.isFunction(s)&&(s={serialize:s});const l=s&&s.serialize;let d;if(l?d=l(o,s):d=Tt.isURLSearchParams(o)?o.toString():new dP(o,s).toString(a),d){const h=t.indexOf("#");h!==-1&&(t=t.slice(0,h)),t+=(t.indexOf("?")===-1?"?":"&")+d}return t}class w8{constructor(){this.handlers=[]}use(o,s,a){return this.handlers.push({fulfilled:o,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){Tt.forEach(this.handlers,function(a){a!==null&&o(a)})}}const Rq={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},P3e=typeof URLSearchParams<"u"?URLSearchParams:dP,D3e=typeof FormData<"u"?FormData:null,L3e=typeof Blob<"u"?Blob:null,M3e={isBrowser:!0,classes:{URLSearchParams:P3e,FormData:D3e,Blob:L3e},protocols:["http","https","file","blob","url","data"]},hP=typeof window<"u"&&typeof document<"u",tN=typeof navigator=="object"&&navigator||void 0,x3e=hP&&(!tN||["ReactNative","NativeScript","NS"].indexOf(tN.product)<0),U3e=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",V3e=hP&&window.location.href||"http://localhost",F3e=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:hP,hasStandardBrowserEnv:x3e,hasStandardBrowserWebWorkerEnv:U3e,navigator:tN,origin:V3e},Symbol.toStringTag,{value:"Module"})),Qs={...F3e,...M3e};function B3e(t,o){return U0(t,new Qs.classes.URLSearchParams,Object.assign({visitor:function(s,a,l,d){return Qs.isNode&&Tt.isBuffer(s)?(this.append(a,s.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},o))}function j3e(t){return Tt.matchAll(/\w+|\[(\w*)]/g,t).map(o=>o[0]==="[]"?"":o[1]||o[0])}function $3e(t){const o={},s=Object.keys(t);let a;const l=s.length;let d;for(a=0;a<l;a++)d=s[a],o[d]=t[d];return o}function Iq(t){function o(s,a,l,d){let h=s[d++];if(h==="__proto__")return!0;const v=Number.isFinite(+h),g=d>=s.length;return h=!h&&Tt.isArray(l)?l.length:h,g?(Tt.hasOwnProp(l,h)?l[h]=[l[h],a]:l[h]=a,!v):((!l[h]||!Tt.isObject(l[h]))&&(l[h]=[]),o(s,a,l[h],d)&&Tt.isArray(l[h])&&(l[h]=$3e(l[h])),!v)}if(Tt.isFormData(t)&&Tt.isFunction(t.entries)){const s={};return Tt.forEachEntry(t,(a,l)=>{o(j3e(a),l,s,0)}),s}return null}function H3e(t,o,s){if(Tt.isString(t))try{return(o||JSON.parse)(t),Tt.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(t)}const b_={transitional:Rq,adapter:["xhr","http","fetch"],transformRequest:[function(o,s){const a=s.getContentType()||"",l=a.indexOf("application/json")>-1,d=Tt.isObject(o);if(d&&Tt.isHTMLForm(o)&&(o=new FormData(o)),Tt.isFormData(o))return l?JSON.stringify(Iq(o)):o;if(Tt.isArrayBuffer(o)||Tt.isBuffer(o)||Tt.isStream(o)||Tt.isFile(o)||Tt.isBlob(o)||Tt.isReadableStream(o))return o;if(Tt.isArrayBufferView(o))return o.buffer;if(Tt.isURLSearchParams(o))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let v;if(d){if(a.indexOf("application/x-www-form-urlencoded")>-1)return B3e(o,this.formSerializer).toString();if((v=Tt.isFileList(o))||a.indexOf("multipart/form-data")>-1){const g=this.env&&this.env.FormData;return U0(v?{"files[]":o}:o,g&&new g,this.formSerializer)}}return d||l?(s.setContentType("application/json",!1),H3e(o)):o}],transformResponse:[function(o){const s=this.transitional||b_.transitional,a=s&&s.forcedJSONParsing,l=this.responseType==="json";if(Tt.isResponse(o)||Tt.isReadableStream(o))return o;if(o&&Tt.isString(o)&&(a&&!this.responseType||l)){const h=!(s&&s.silentJSONParsing)&&l;try{return JSON.parse(o)}catch(v){if(h)throw v.name==="SyntaxError"?ar.from(v,ar.ERR_BAD_RESPONSE,this,null,this.response):v}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qs.classes.FormData,Blob:Qs.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Tt.forEach(["delete","get","head","post","put","patch"],t=>{b_.headers[t]={}});const W3e=Tt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),K3e=t=>{const o={};let s,a,l;return t&&t.split(`
`).forEach(function(h){l=h.indexOf(":"),s=h.substring(0,l).trim().toLowerCase(),a=h.substring(l+1).trim(),!(!s||o[s]&&W3e[s])&&(s==="set-cookie"?o[s]?o[s].push(a):o[s]=[a]:o[s]=o[s]?o[s]+", "+a:a)}),o},R8=Symbol("internals");function tg(t){return t&&String(t).trim().toLowerCase()}function iS(t){return t===!1||t==null?t:Tt.isArray(t)?t.map(iS):String(t)}function G3e(t){const o=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(t);)o[a[1]]=a[2];return o}const z3e=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function RA(t,o,s,a,l){if(Tt.isFunction(a))return a.call(this,o,s);if(l&&(o=s),!!Tt.isString(o)){if(Tt.isString(a))return o.indexOf(a)!==-1;if(Tt.isRegExp(a))return a.test(o)}}function Y3e(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,s,a)=>s.toUpperCase()+a)}function q3e(t,o){const s=Tt.toCamelCase(" "+o);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+s,{value:function(l,d,h){return this[a].call(this,o,l,d,h)},configurable:!0})})}let $i=class{constructor(o){o&&this.set(o)}set(o,s,a){const l=this;function d(v,g,E){const b=tg(g);if(!b)throw new Error("header name must be a non-empty string");const S=Tt.findKey(l,b);(!S||l[S]===void 0||E===!0||E===void 0&&l[S]!==!1)&&(l[S||g]=iS(v))}const h=(v,g)=>Tt.forEach(v,(E,b)=>d(E,b,g));if(Tt.isPlainObject(o)||o instanceof this.constructor)h(o,s);else if(Tt.isString(o)&&(o=o.trim())&&!z3e(o))h(K3e(o),s);else if(Tt.isHeaders(o))for(const[v,g]of o.entries())d(g,v,a);else o!=null&&d(s,o,a);return this}get(o,s){if(o=tg(o),o){const a=Tt.findKey(this,o);if(a){const l=this[a];if(!s)return l;if(s===!0)return G3e(l);if(Tt.isFunction(s))return s.call(this,l,a);if(Tt.isRegExp(s))return s.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,s){if(o=tg(o),o){const a=Tt.findKey(this,o);return!!(a&&this[a]!==void 0&&(!s||RA(this,this[a],a,s)))}return!1}delete(o,s){const a=this;let l=!1;function d(h){if(h=tg(h),h){const v=Tt.findKey(a,h);v&&(!s||RA(a,a[v],v,s))&&(delete a[v],l=!0)}}return Tt.isArray(o)?o.forEach(d):d(o),l}clear(o){const s=Object.keys(this);let a=s.length,l=!1;for(;a--;){const d=s[a];(!o||RA(this,this[d],d,o,!0))&&(delete this[d],l=!0)}return l}normalize(o){const s=this,a={};return Tt.forEach(this,(l,d)=>{const h=Tt.findKey(a,d);if(h){s[h]=iS(l),delete s[d];return}const v=o?Y3e(d):String(d).trim();v!==d&&delete s[d],s[v]=iS(l),a[v]=!0}),this}concat(...o){return this.constructor.concat(this,...o)}toJSON(o){const s=Object.create(null);return Tt.forEach(this,(a,l)=>{a!=null&&a!==!1&&(s[l]=o&&Tt.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([o,s])=>o+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o,...s){const a=new this(o);return s.forEach(l=>a.set(l)),a}static accessor(o){const a=(this[R8]=this[R8]={accessors:{}}).accessors,l=this.prototype;function d(h){const v=tg(h);a[v]||(q3e(l,h),a[v]=!0)}return Tt.isArray(o)?o.forEach(d):d(o),this}};$i.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Tt.reduceDescriptors($i.prototype,({value:t},o)=>{let s=o[0].toUpperCase()+o.slice(1);return{get:()=>t,set(a){this[s]=a}}});Tt.freezeMethods($i);function IA(t,o){const s=this||b_,a=o||s,l=$i.from(a.headers);let d=a.data;return Tt.forEach(t,function(v){d=v.call(s,d,l.normalize(),o?o.status:void 0)}),l.normalize(),d}function Aq(t){return!!(t&&t.__CANCEL__)}function Sm(t,o,s){ar.call(this,t??"canceled",ar.ERR_CANCELED,o,s),this.name="CanceledError"}Tt.inherits(Sm,ar,{__CANCEL__:!0});function Oq(t,o,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?t(s):o(new ar("Request failed with status code "+s.status,[ar.ERR_BAD_REQUEST,ar.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function X3e(t){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return o&&o[1]||""}function J3e(t,o){t=t||10;const s=new Array(t),a=new Array(t);let l=0,d=0,h;return o=o!==void 0?o:1e3,function(g){const E=Date.now(),b=a[d];h||(h=E),s[l]=g,a[l]=E;let S=d,C=0;for(;S!==l;)C+=s[S++],S=S%t;if(l=(l+1)%t,l===d&&(d=(d+1)%t),E-h<o)return;const w=b&&E-b;return w?Math.round(C*1e3/w):void 0}}function Z3e(t,o){let s=0,a=1e3/o,l,d;const h=(E,b=Date.now())=>{s=b,l=null,d&&(clearTimeout(d),d=null),t.apply(null,E)};return[(...E)=>{const b=Date.now(),S=b-s;S>=a?h(E,b):(l=E,d||(d=setTimeout(()=>{d=null,h(l)},a-S)))},()=>l&&h(l)]}const HS=(t,o,s=3)=>{let a=0;const l=J3e(50,250);return Z3e(d=>{const h=d.loaded,v=d.lengthComputable?d.total:void 0,g=h-a,E=l(g),b=h<=v;a=h;const S={loaded:h,total:v,progress:v?h/v:void 0,bytes:g,rate:E||void 0,estimated:E&&v&&b?(v-h)/E:void 0,event:d,lengthComputable:v!=null,[o?"download":"upload"]:!0};t(S)},s)},I8=(t,o)=>{const s=t!=null;return[a=>o[0]({lengthComputable:s,total:t,loaded:a}),o[1]]},A8=t=>(...o)=>Tt.asap(()=>t(...o)),Q3e=Qs.hasStandardBrowserEnv?((t,o)=>s=>(s=new URL(s,Qs.origin),t.protocol===s.protocol&&t.host===s.host&&(o||t.port===s.port)))(new URL(Qs.origin),Qs.navigator&&/(msie|trident)/i.test(Qs.navigator.userAgent)):()=>!0,e4e=Qs.hasStandardBrowserEnv?{write(t,o,s,a,l,d){const h=[t+"="+encodeURIComponent(o)];Tt.isNumber(s)&&h.push("expires="+new Date(s).toGMTString()),Tt.isString(a)&&h.push("path="+a),Tt.isString(l)&&h.push("domain="+l),d===!0&&h.push("secure"),document.cookie=h.join("; ")},read(t){const o=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function t4e(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function n4e(t,o){return o?t.replace(/\/?\/$/,"")+"/"+o.replace(/^\/+/,""):t}function Nq(t,o,s){let a=!t4e(o);return t&&(a||s==!1)?n4e(t,o):o}const O8=t=>t instanceof $i?{...t}:t;function jh(t,o){o=o||{};const s={};function a(E,b,S,C){return Tt.isPlainObject(E)&&Tt.isPlainObject(b)?Tt.merge.call({caseless:C},E,b):Tt.isPlainObject(b)?Tt.merge({},b):Tt.isArray(b)?b.slice():b}function l(E,b,S,C){if(Tt.isUndefined(b)){if(!Tt.isUndefined(E))return a(void 0,E,S,C)}else return a(E,b,S,C)}function d(E,b){if(!Tt.isUndefined(b))return a(void 0,b)}function h(E,b){if(Tt.isUndefined(b)){if(!Tt.isUndefined(E))return a(void 0,E)}else return a(void 0,b)}function v(E,b,S){if(S in o)return a(E,b);if(S in t)return a(void 0,E)}const g={url:d,method:d,data:d,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:v,headers:(E,b,S)=>l(O8(E),O8(b),S,!0)};return Tt.forEach(Object.keys(Object.assign({},t,o)),function(b){const S=g[b]||l,C=S(t[b],o[b],b);Tt.isUndefined(C)&&S!==v||(s[b]=C)}),s}const kq=t=>{const o=jh({},t);let{data:s,withXSRFToken:a,xsrfHeaderName:l,xsrfCookieName:d,headers:h,auth:v}=o;o.headers=h=$i.from(h),o.url=wq(Nq(o.baseURL,o.url,o.allowAbsoluteUrls),t.params,t.paramsSerializer),v&&h.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):"")));let g;if(Tt.isFormData(s)){if(Qs.hasStandardBrowserEnv||Qs.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if((g=h.getContentType())!==!1){const[E,...b]=g?g.split(";").map(S=>S.trim()).filter(Boolean):[];h.setContentType([E||"multipart/form-data",...b].join("; "))}}if(Qs.hasStandardBrowserEnv&&(a&&Tt.isFunction(a)&&(a=a(o)),a||a!==!1&&Q3e(o.url))){const E=l&&d&&e4e.read(d);E&&h.set(l,E)}return o},r4e=typeof XMLHttpRequest<"u",o4e=r4e&&function(t){return new Promise(function(s,a){const l=kq(t);let d=l.data;const h=$i.from(l.headers).normalize();let{responseType:v,onUploadProgress:g,onDownloadProgress:E}=l,b,S,C,w,I;function R(){w&&w(),I&&I(),l.cancelToken&&l.cancelToken.unsubscribe(b),l.signal&&l.signal.removeEventListener("abort",b)}let N=new XMLHttpRequest;N.open(l.method.toUpperCase(),l.url,!0),N.timeout=l.timeout;function O(){if(!N)return;const L=$i.from("getAllResponseHeaders"in N&&N.getAllResponseHeaders()),M={data:!v||v==="text"||v==="json"?N.responseText:N.response,status:N.status,statusText:N.statusText,headers:L,config:t,request:N};Oq(function(W){s(W),R()},function(W){a(W),R()},M),N=null}"onloadend"in N?N.onloadend=O:N.onreadystatechange=function(){!N||N.readyState!==4||N.status===0&&!(N.responseURL&&N.responseURL.indexOf("file:")===0)||setTimeout(O)},N.onabort=function(){N&&(a(new ar("Request aborted",ar.ECONNABORTED,t,N)),N=null)},N.onerror=function(){a(new ar("Network Error",ar.ERR_NETWORK,t,N)),N=null},N.ontimeout=function(){let D=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const M=l.transitional||Rq;l.timeoutErrorMessage&&(D=l.timeoutErrorMessage),a(new ar(D,M.clarifyTimeoutError?ar.ETIMEDOUT:ar.ECONNABORTED,t,N)),N=null},d===void 0&&h.setContentType(null),"setRequestHeader"in N&&Tt.forEach(h.toJSON(),function(D,M){N.setRequestHeader(M,D)}),Tt.isUndefined(l.withCredentials)||(N.withCredentials=!!l.withCredentials),v&&v!=="json"&&(N.responseType=l.responseType),E&&([C,I]=HS(E,!0),N.addEventListener("progress",C)),g&&N.upload&&([S,w]=HS(g),N.upload.addEventListener("progress",S),N.upload.addEventListener("loadend",w)),(l.cancelToken||l.signal)&&(b=L=>{N&&(a(!L||L.type?new Sm(null,t,N):L),N.abort(),N=null)},l.cancelToken&&l.cancelToken.subscribe(b),l.signal&&(l.signal.aborted?b():l.signal.addEventListener("abort",b)));const V=X3e(l.url);if(V&&Qs.protocols.indexOf(V)===-1){a(new ar("Unsupported protocol "+V+":",ar.ERR_BAD_REQUEST,t));return}N.send(d||null)})},s4e=(t,o)=>{const{length:s}=t=t?t.filter(Boolean):[];if(o||s){let a=new AbortController,l;const d=function(E){if(!l){l=!0,v();const b=E instanceof Error?E:this.reason;a.abort(b instanceof ar?b:new Sm(b instanceof Error?b.message:b))}};let h=o&&setTimeout(()=>{h=null,d(new ar(`timeout ${o} of ms exceeded`,ar.ETIMEDOUT))},o);const v=()=>{t&&(h&&clearTimeout(h),h=null,t.forEach(E=>{E.unsubscribe?E.unsubscribe(d):E.removeEventListener("abort",d)}),t=null)};t.forEach(E=>E.addEventListener("abort",d));const{signal:g}=a;return g.unsubscribe=()=>Tt.asap(v),g}},i4e=function*(t,o){let s=t.byteLength;if(s<o){yield t;return}let a=0,l;for(;a<s;)l=a+o,yield t.slice(a,l),a=l},a4e=async function*(t,o){for await(const s of c4e(t))yield*i4e(s,o)},c4e=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const o=t.getReader();try{for(;;){const{done:s,value:a}=await o.read();if(s)break;yield a}}finally{await o.cancel()}},N8=(t,o,s,a)=>{const l=a4e(t,o);let d=0,h,v=g=>{h||(h=!0,a&&a(g))};return new ReadableStream({async pull(g){try{const{done:E,value:b}=await l.next();if(E){v(),g.close();return}let S=b.byteLength;if(s){let C=d+=S;s(C)}g.enqueue(new Uint8Array(b))}catch(E){throw v(E),E}},cancel(g){return v(g),l.return()}},{highWaterMark:2})},V0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Pq=V0&&typeof ReadableStream=="function",l4e=V0&&(typeof TextEncoder=="function"?(t=>o=>t.encode(o))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Dq=(t,...o)=>{try{return!!t(...o)}catch{return!1}},u4e=Pq&&Dq(()=>{let t=!1;const o=new Request(Qs.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!o}),k8=64*1024,nN=Pq&&Dq(()=>Tt.isReadableStream(new Response("").body)),WS={stream:nN&&(t=>t.body)};V0&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(o=>{!WS[o]&&(WS[o]=Tt.isFunction(t[o])?s=>s[o]():(s,a)=>{throw new ar(`Response type '${o}' is not supported`,ar.ERR_NOT_SUPPORT,a)})})})(new Response);const d4e=async t=>{if(t==null)return 0;if(Tt.isBlob(t))return t.size;if(Tt.isSpecCompliantForm(t))return(await new Request(Qs.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(Tt.isArrayBufferView(t)||Tt.isArrayBuffer(t))return t.byteLength;if(Tt.isURLSearchParams(t)&&(t=t+""),Tt.isString(t))return(await l4e(t)).byteLength},h4e=async(t,o)=>{const s=Tt.toFiniteNumber(t.getContentLength());return s??d4e(o)},f4e=V0&&(async t=>{let{url:o,method:s,data:a,signal:l,cancelToken:d,timeout:h,onDownloadProgress:v,onUploadProgress:g,responseType:E,headers:b,withCredentials:S="same-origin",fetchOptions:C}=kq(t);E=E?(E+"").toLowerCase():"text";let w=s4e([l,d&&d.toAbortSignal()],h),I;const R=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let N;try{if(g&&u4e&&s!=="get"&&s!=="head"&&(N=await h4e(b,a))!==0){let M=new Request(o,{method:"POST",body:a,duplex:"half"}),F;if(Tt.isFormData(a)&&(F=M.headers.get("content-type"))&&b.setContentType(F),M.body){const[W,z]=I8(N,HS(A8(g)));a=N8(M.body,k8,W,z)}}Tt.isString(S)||(S=S?"include":"omit");const O="credentials"in Request.prototype;I=new Request(o,{...C,signal:w,method:s.toUpperCase(),headers:b.normalize().toJSON(),body:a,duplex:"half",credentials:O?S:void 0});let V=await fetch(I);const L=nN&&(E==="stream"||E==="response");if(nN&&(v||L&&R)){const M={};["status","statusText","headers"].forEach(G=>{M[G]=V[G]});const F=Tt.toFiniteNumber(V.headers.get("content-length")),[W,z]=v&&I8(F,HS(A8(v),!0))||[];V=new Response(N8(V.body,k8,W,()=>{z&&z(),R&&R()}),M)}E=E||"text";let D=await WS[Tt.findKey(WS,E)||"text"](V,t);return!L&&R&&R(),await new Promise((M,F)=>{Oq(M,F,{data:D,headers:$i.from(V.headers),status:V.status,statusText:V.statusText,config:t,request:I})})}catch(O){throw R&&R(),O&&O.name==="TypeError"&&/fetch/i.test(O.message)?Object.assign(new ar("Network Error",ar.ERR_NETWORK,t,I),{cause:O.cause||O}):ar.from(O,O&&O.code,t,I)}}),rN={http:A3e,xhr:o4e,fetch:f4e};Tt.forEach(rN,(t,o)=>{if(t){try{Object.defineProperty(t,"name",{value:o})}catch{}Object.defineProperty(t,"adapterName",{value:o})}});const P8=t=>`- ${t}`,p4e=t=>Tt.isFunction(t)||t===null||t===!1,Lq={getAdapter:t=>{t=Tt.isArray(t)?t:[t];const{length:o}=t;let s,a;const l={};for(let d=0;d<o;d++){s=t[d];let h;if(a=s,!p4e(s)&&(a=rN[(h=String(s)).toLowerCase()],a===void 0))throw new ar(`Unknown adapter '${h}'`);if(a)break;l[h||"#"+d]=a}if(!a){const d=Object.entries(l).map(([v,g])=>`adapter ${v} `+(g===!1?"is not supported by the environment":"is not available in the build"));let h=o?d.length>1?`since :
`+d.map(P8).join(`
`):" "+P8(d[0]):"as no adapter specified";throw new ar("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return a},adapters:rN};function AA(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Sm(null,t)}function D8(t){return AA(t),t.headers=$i.from(t.headers),t.data=IA.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Lq.getAdapter(t.adapter||b_.adapter)(t).then(function(a){return AA(t),a.data=IA.call(t,t.transformResponse,a),a.headers=$i.from(a.headers),a},function(a){return Aq(a)||(AA(t),a&&a.response&&(a.response.data=IA.call(t,t.transformResponse,a.response),a.response.headers=$i.from(a.response.headers))),Promise.reject(a)})}const Mq="1.8.4",F0={};["object","boolean","number","function","string","symbol"].forEach((t,o)=>{F0[t]=function(a){return typeof a===t||"a"+(o<1?"n ":" ")+t}});const L8={};F0.transitional=function(o,s,a){function l(d,h){return"[Axios v"+Mq+"] Transitional option '"+d+"'"+h+(a?". "+a:"")}return(d,h,v)=>{if(o===!1)throw new ar(l(h," has been removed"+(s?" in "+s:"")),ar.ERR_DEPRECATED);return s&&!L8[h]&&(L8[h]=!0,console.warn(l(h," has been deprecated since v"+s+" and will be removed in the near future"))),o?o(d,h,v):!0}};F0.spelling=function(o){return(s,a)=>(console.warn(`${a} is likely a misspelling of ${o}`),!0)};function m4e(t,o,s){if(typeof t!="object")throw new ar("options must be an object",ar.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let l=a.length;for(;l-- >0;){const d=a[l],h=o[d];if(h){const v=t[d],g=v===void 0||h(v,d,t);if(g!==!0)throw new ar("option "+d+" must be "+g,ar.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new ar("Unknown option "+d,ar.ERR_BAD_OPTION)}}const aS={assertOptions:m4e,validators:F0},nl=aS.validators;let kh=class{constructor(o){this.defaults=o,this.interceptors={request:new w8,response:new w8}}async request(o,s){try{return await this._request(o,s)}catch(a){if(a instanceof Error){let l={};Error.captureStackTrace?Error.captureStackTrace(l):l=new Error;const d=l.stack?l.stack.replace(/^.+\n/,""):"";try{a.stack?d&&!String(a.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+d):a.stack=d}catch{}}throw a}}_request(o,s){typeof o=="string"?(s=s||{},s.url=o):s=o||{},s=jh(this.defaults,s);const{transitional:a,paramsSerializer:l,headers:d}=s;a!==void 0&&aS.assertOptions(a,{silentJSONParsing:nl.transitional(nl.boolean),forcedJSONParsing:nl.transitional(nl.boolean),clarifyTimeoutError:nl.transitional(nl.boolean)},!1),l!=null&&(Tt.isFunction(l)?s.paramsSerializer={serialize:l}:aS.assertOptions(l,{encode:nl.function,serialize:nl.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),aS.assertOptions(s,{baseUrl:nl.spelling("baseURL"),withXsrfToken:nl.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let h=d&&Tt.merge(d.common,d[s.method]);d&&Tt.forEach(["delete","get","head","post","put","patch","common"],I=>{delete d[I]}),s.headers=$i.concat(h,d);const v=[];let g=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(s)===!1||(g=g&&R.synchronous,v.unshift(R.fulfilled,R.rejected))});const E=[];this.interceptors.response.forEach(function(R){E.push(R.fulfilled,R.rejected)});let b,S=0,C;if(!g){const I=[D8.bind(this),void 0];for(I.unshift.apply(I,v),I.push.apply(I,E),C=I.length,b=Promise.resolve(s);S<C;)b=b.then(I[S++],I[S++]);return b}C=v.length;let w=s;for(S=0;S<C;){const I=v[S++],R=v[S++];try{w=I(w)}catch(N){R.call(this,N);break}}try{b=D8.call(this,w)}catch(I){return Promise.reject(I)}for(S=0,C=E.length;S<C;)b=b.then(E[S++],E[S++]);return b}getUri(o){o=jh(this.defaults,o);const s=Nq(o.baseURL,o.url,o.allowAbsoluteUrls);return wq(s,o.params,o.paramsSerializer)}};Tt.forEach(["delete","get","head","options"],function(o){kh.prototype[o]=function(s,a){return this.request(jh(a||{},{method:o,url:s,data:(a||{}).data}))}});Tt.forEach(["post","put","patch"],function(o){function s(a){return function(d,h,v){return this.request(jh(v||{},{method:o,headers:a?{"Content-Type":"multipart/form-data"}:{},url:d,data:h}))}}kh.prototype[o]=s(),kh.prototype[o+"Form"]=s(!0)});let v4e=class xq{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(d){s=d});const a=this;this.promise.then(l=>{if(!a._listeners)return;let d=a._listeners.length;for(;d-- >0;)a._listeners[d](l);a._listeners=null}),this.promise.then=l=>{let d;const h=new Promise(v=>{a.subscribe(v),d=v}).then(l);return h.cancel=function(){a.unsubscribe(d)},h},o(function(d,h,v){a.reason||(a.reason=new Sm(d,h,v),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const s=this._listeners.indexOf(o);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const o=new AbortController,s=a=>{o.abort(a)};return this.subscribe(s),o.signal.unsubscribe=()=>this.unsubscribe(s),o.signal}static source(){let o;return{token:new xq(function(l){o=l}),cancel:o}}};function g4e(t){return function(s){return t.apply(null,s)}}function _4e(t){return Tt.isObject(t)&&t.isAxiosError===!0}const oN={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(oN).forEach(([t,o])=>{oN[o]=t});function Uq(t){const o=new kh(t),s=pq(kh.prototype.request,o);return Tt.extend(s,kh.prototype,o,{allOwnKeys:!0}),Tt.extend(s,o,null,{allOwnKeys:!0}),s.create=function(l){return Uq(jh(t,l))},s}const Xo=Uq(b_);Xo.Axios=kh;Xo.CanceledError=Sm;Xo.CancelToken=v4e;Xo.isCancel=Aq;Xo.VERSION=Mq;Xo.toFormData=U0;Xo.AxiosError=ar;Xo.Cancel=Xo.CanceledError;Xo.all=function(o){return Promise.all(o)};Xo.spread=g4e;Xo.isAxiosError=_4e;Xo.mergeConfig=jh;Xo.AxiosHeaders=$i;Xo.formToJSON=t=>Iq(Tt.isHTMLForm(t)?new FormData(t):t);Xo.getAdapter=Lq.getAdapter;Xo.HttpStatusCode=oN;Xo.default=Xo;const{Axios:yje,AxiosError:bje,CanceledError:Sje,isCancel:Tje,CancelToken:Cje,VERSION:wje,all:Rje,Cancel:Ije,isAxiosError:Aje,spread:Oje,toFormData:Nje,AxiosHeaders:kje,HttpStatusCode:Pje,formToJSON:Dje,getAdapter:Lje,mergeConfig:Mje}=Xo,E4e="https://aw.aoscdn.com/base",y4e=()=>({language:"zh-CN",device_hash:b4e(),product_id:"apowermirror_tv",os_version:"1.0",os_name:"Android",platform:"5"}),b4e=()=>"web_"+Math.random().toString(36).substr(2,9),B0=Xo.create({baseURL:E4e,timeout:1e4,headers:{"Content-Type":"application/json"}});B0.interceptors.request.use(t=>{const o=y4e();return t.method==="post"&&(t.data={...o,...t.data}),t},t=>Promise.reject(t));B0.interceptors.response.use(t=>t.data,t=>Promise.reject(t));const S4e=()=>B0({url:"/passport/v2/login/anonymous",method:"post",data:{cli_os:"android",os_name:"android",os_version:"1.0",device_hash:Vq()}}),T4e=t=>B0({url:"/support/apowermirror/mirror/code",method:"post",data:{api_token:t,hash:Vq(),device:"android",region:"cn",name:"Web Browser"}}),Vq=()=>"web_"+Math.random().toString(36).substr(2,9);class C4e{constructor(){this.ws=null,this.reconnectTimer=null,this.reconnectCount=0,this.maxReconnectCount=5,this.reconnectInterval=3e3,this.status="disconnected",this.messageHandlers=new Map,this.auth=null,this.heartbeatTimer=null,this.heartbeatInterval=3e4,this.lastPongTime=null,this.pingTimeout=5e4,this.pingCheckTimer=null,this.rtcService=null,this.mirrorCode=0}setRTCService(o){this.rtcService=o}connect(o,s){this.ws&&this.disconnect(),this.auth=o,this.status="connecting",this.mirrorCode=s,this.ws=new WebSocket(`wss://aw.aoscdn.com/base/support/apowermirror?auth=${encodeURIComponent(o)}`);const a=setTimeout(()=>{this.ws.readyState!==WebSocket.OPEN&&(this.ws.close(),this.status="error")},5e3);this.ws.onopen=()=>{clearTimeout(a),this.status="connected",this.reconnectCount=0,this.startHeartbeat()},this.ws.onmessage=l=>{var d,h,v,g,E,b,S,C;try{if(l.data==="PONG"){this.lastPongTime=Date.now(),(d=this.messageHandlers.get("heartbeat"))==null||d({action:"PONG"}),(h=this.messageHandlers.get("raw"))==null||h(l.data);return}const w=JSON.parse(l.data);if(w.status===201){this.ws.send(JSON.stringify({action:"acceptShare",data:{channel_name:w.data.channel_name}})),(v=this.messageHandlers.get("raw"))==null||v(l.data);return}if(w.status===110){if(this.rtcService){const I=w.data.channel_name,R=w.data.token;if(console.log(":",{channel:I,token:R}),(g=this.messageHandlers.get("message"))==null||g({type:"channel",data:{channel:I,token:R}}),!I||!R){console.error(":",w.data);return}this.rtcService.joinChannel(s,I,R).then(N=>{var O,V;N?(console.log(""),(O=this.messageHandlers.get("message"))==null||O({type:"rtc",data:""})):(console.error(""),(V=this.messageHandlers.get("message"))==null||V({type:"error",data:""}))}).catch(N=>{var O;console.error(":",N),(O=this.messageHandlers.get("message"))==null||O({type:"error",data:`: ${N.message}`})})}(E=this.messageHandlers.get("raw"))==null||E(l.data);return}if(w.status===200&&w.message==="connected"){this.status="connected",(b=this.messageHandlers.get("raw"))==null||b(l.data);return}this.messageHandlers.forEach((I,R)=>{w.action===R&&I(w)}),(S=this.messageHandlers.get("raw"))==null||S(l.data)}catch(w){console.error("WebSocket message parse error:",w),(C=this.messageHandlers.get("raw"))==null||C(l.data)}},this.ws.onerror=l=>{console.error("WebSocket error:",l),this.status="error",this.stopHeartbeat(),this.reconnect()},this.ws.onclose=()=>{clearTimeout(a),this.status="disconnected",this.stopHeartbeat(),this.reconnect()}}startHeartbeat(){this.stopHeartbeat(),this.lastPongTime=Date.now(),this.heartbeatTimer=setInterval(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN&&(this.ws.send("PING"),this.pingCheckTimer&&clearTimeout(this.pingCheckTimer),this.pingCheckTimer=setTimeout(()=>{Date.now()-this.lastPongTime>this.pingTimeout&&(console.error("Heartbeat timeout"),this.ws.close(),this.status="error")},this.pingTimeout))},this.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.pingCheckTimer&&(clearTimeout(this.pingCheckTimer),this.pingCheckTimer=null)}reconnect(){if(this.reconnectCount>=this.maxReconnectCount){this.status="error";return}this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectCount++,this.reconnectTimer=setTimeout(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN||this.connect(this.auth)},this.reconnectInterval)}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.stopHeartbeat(),this.status="disconnected",this.reconnectCount=0}on(o,s){this.messageHandlers.set(o,s)}off(o){this.messageHandlers.delete(o)}send(o){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify(o))}getStatus(){return this.status}getLastPongTime(){return this.lastPongTime}}var Fq={exports:{}};(function(t,o){(function(s,a){t.exports=a()})(aa,function(){function s(e,n){return n.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(i){if(i!=="default"&&!(i in e)){var c=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,c.get?c:{enumerable:!0,get:function(){return r[i]}})}})}),Object.freeze(e)}var a=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof aa<"u"?aa:typeof self<"u"?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var d=function(e){try{return!!e()}catch{return!0}},h=!d(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),v=h,g=Function.prototype,E=g.call,b=v&&g.bind.bind(E,E),S=v?b:function(e){return function(){return E.apply(e,arguments)}},C=S({}.isPrototypeOf),w=function(e){return e&&e.Math==Math&&e},I=w(typeof globalThis=="object"&&globalThis)||w(typeof window=="object"&&window)||w(typeof self=="object"&&self)||w(typeof a=="object"&&a)||function(){return this}()||a||Function("return this")(),R=h,N=Function.prototype,O=N.apply,V=N.call,L=typeof Reflect=="object"&&Reflect.apply||(R?V.bind(O):function(){return V.apply(O,arguments)}),D=S,M=D({}.toString),F=D("".slice),W=function(e){return F(M(e),8,-1)},z=W,G=S,Y=function(e){if(z(e)==="Function")return G(e)},te=typeof document=="object"&&document.all,Z={all:te,IS_HTMLDDA:te===void 0&&te!==void 0},fe=Z.all,Ee=Z.IS_HTMLDDA?function(e){return typeof e=="function"||e===fe}:function(e){return typeof e=="function"},ae={},X=!d(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ie=h,se=Function.prototype.call,J=ie?se.bind(se):function(){return se.apply(se,arguments)},pe={},be={}.propertyIsEnumerable,Ae=Object.getOwnPropertyDescriptor,_e=Ae&&!be.call({1:2},1);pe.f=_e?function(e){var n=Ae(this,e);return!!n&&n.enumerable}:be;var Me,Fe,Le=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}},Pe=d,He=W,We=Object,yt=S("".split),it=Pe(function(){return!We("z").propertyIsEnumerable(0)})?function(e){return He(e)=="String"?yt(e,""):We(e)}:We,ce=function(e){return e==null},Se=ce,je=TypeError,tt=function(e){if(Se(e))throw je("Can't call method on "+e);return e},et=it,Ge=tt,Xe=function(e){return et(Ge(e))},Ye=Ee,ct=Z.all,nt=Z.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Ye(e)||e===ct}:function(e){return typeof e=="object"?e!==null:Ye(e)},Ot={},_t=Ot,qe=I,wt=Ee,qt=function(e){return wt(e)?e:void 0},sn=function(e,n){return arguments.length<2?qt(_t[e])||qt(qe[e]):_t[e]&&_t[e][n]||qe[e]&&qe[e][n]},tn=typeof navigator<"u"&&String(navigator.userAgent)||"",Kn=I,Sn=tn,zr=Kn.process,Wt=Kn.Deno,Je=zr&&zr.versions||Wt&&Wt.version,Ie=Je&&Je.v8;Ie&&(Fe=(Me=Ie.split("."))[0]>0&&Me[0]<4?1:+(Me[0]+Me[1])),!Fe&&Sn&&(!(Me=Sn.match(/Edge\/(\d+)/))||Me[1]>=74)&&(Me=Sn.match(/Chrome\/(\d+)/))&&(Fe=+Me[1]);var Ke=Fe,Te=Ke,vt=d,an=I.String,en=!!Object.getOwnPropertySymbols&&!vt(function(){var e=Symbol();return!an(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Te&&Te<41}),Ir=en&&!Symbol.sham&&typeof Symbol.iterator=="symbol",yi=sn,No=Ee,Wo=C,$r=Object,_r=Ir?function(e){return typeof e=="symbol"}:function(e){var n=yi("Symbol");return No(n)&&Wo(n.prototype,$r(e))},ws=String,Ga=function(e){try{return ws(e)}catch{return"Object"}},yd=Ee,yl=Ga,Gh=TypeError,Rs=function(e){if(yd(e))return e;throw Gh(yl(e)+" is not a function")},fu=Rs,zh=ce,pu=function(e,n){var r=e[n];return zh(r)?void 0:fu(r)},Yh=J,qh=Ee,Xh=nt,mt=TypeError,Zt={exports:{}},Zn=I,ko=Object.defineProperty,ps=function(e,n){try{ko(Zn,e,{value:n,configurable:!0,writable:!0})}catch{Zn[e]=n}return n},za="__core-js_shared__",bi=I[za]||ps(za,{}),Ya=bi;(Zt.exports=function(e,n){return Ya[e]||(Ya[e]=n!==void 0?n:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Si=Zt.exports,bd=tt,pt=Object,zt=function(e){return pt(bd(e))},On=zt,Gn=S({}.hasOwnProperty),mr=Object.hasOwn||function(e,n){return Gn(On(e),n)},ni=S,bl=0,mu=Math.random(),Jh=ni(1 .toString),S_=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Jh(++bl+mu,36)},j0=Si,T_=mr,$0=S_,Wq=en,Kq=Ir,Zh=I.Symbol,H0=j0("wks"),Gq=Kq?Zh.for||Zh:Zh&&Zh.withoutSetter||$0,Zr=function(e){return T_(H0,e)||(H0[e]=Wq&&T_(Zh,e)?Zh[e]:Gq("Symbol."+e)),H0[e]},zq=J,fP=nt,pP=_r,Yq=pu,qq=function(e,n){var r,i;if(qh(r=e.toString)&&!Xh(i=Yh(r,e))||qh(r=e.valueOf)&&!Xh(i=Yh(r,e)))return i;throw mt("Can't convert object to primitive value")},Xq=TypeError,Jq=Zr("toPrimitive"),Zq=function(e,n){if(!fP(e)||pP(e))return e;var r,i=Yq(e,Jq);if(i){if(r=zq(i,e,n),!fP(r)||pP(r))return r;throw Xq("Can't convert object to primitive value")}return qq(e)},Qq=_r,C_=function(e){var n=Zq(e,"string");return Qq(n)?n:n+""},mP=nt,W0=I.document,e9=mP(W0)&&mP(W0.createElement),K0=function(e){return e9?W0.createElement(e):{}},t9=K0,vP=!X&&!d(function(){return Object.defineProperty(t9("div"),"a",{get:function(){return 7}}).a!=7}),n9=X,r9=J,o9=pe,s9=Le,i9=Xe,a9=C_,c9=mr,l9=vP,gP=Object.getOwnPropertyDescriptor;ae.f=n9?gP:function(e,n){if(e=i9(e),n=a9(n),l9)try{return gP(e,n)}catch{}if(c9(e,n))return s9(!r9(o9.f,e,n),e[n])};var u9=d,d9=Ee,h9=/#|\.prototype\./,Tm=function(e,n){var r=p9[f9(e)];return r==v9||r!=m9&&(d9(n)?u9(n):!!n)},f9=Tm.normalize=function(e){return String(e).replace(h9,".").toLowerCase()},p9=Tm.data={},m9=Tm.NATIVE="N",v9=Tm.POLYFILL="P",_P=Tm,g9=Rs,_9=h,E9=Y(Y.bind),vu=function(e,n){return g9(e),n===void 0?e:_9?E9(e,n):function(){return e.apply(n,arguments)}},pa={},EP=X&&d(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),y9=nt,b9=String,S9=TypeError,Bs=function(e){if(y9(e))return e;throw S9(b9(e)+" is not an object")},T9=X,C9=vP,w9=EP,w_=Bs,yP=C_,R9=TypeError,G0=Object.defineProperty,I9=Object.getOwnPropertyDescriptor,z0="enumerable",Y0="configurable",q0="writable";pa.f=T9?w9?function(e,n,r){if(w_(e),n=yP(n),w_(r),typeof e=="function"&&n==="prototype"&&"value"in r&&q0 in r&&!r[q0]){var i=I9(e,n);i&&i[q0]&&(e[n]=r.value,r={configurable:Y0 in r?r[Y0]:i[Y0],enumerable:z0 in r?r[z0]:i[z0],writable:!1})}return G0(e,n,r)}:G0:function(e,n,r){if(w_(e),n=yP(n),w_(r),C9)try{return G0(e,n,r)}catch{}if("get"in r||"set"in r)throw R9("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var A9=pa,O9=Le,gu=X?function(e,n,r){return A9.f(e,n,O9(1,r))}:function(e,n,r){return e[n]=r,e},R_=I,N9=L,k9=Y,P9=Ee,D9=ae.f,L9=_P,Qh=Ot,M9=vu,ef=gu,bP=mr,x9=function(e){var n=function(r,i,c){if(this instanceof n){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,i)}return new e(r,i,c)}return N9(e,this,arguments)};return n.prototype=e.prototype,n},rr=function(e,n){var r,i,c,u,f,m,_,y,T,A=e.target,k=e.global,P=e.stat,q=e.proto,j=k?R_:P?R_[A]:(R_[A]||{}).prototype,H=k?Qh:Qh[A]||ef(Qh,A,{})[A],ne=H.prototype;for(u in n)i=!(r=L9(k?u:A+(P?".":"#")+u,e.forced))&&j&&bP(j,u),m=H[u],i&&(_=e.dontCallGetSet?(T=D9(j,u))&&T.value:j[u]),f=i&&_?_:n[u],i&&typeof m==typeof f||(y=e.bind&&i?M9(f,R_):e.wrap&&i?x9(f):q&&P9(f)?k9(f):f,(e.sham||f&&f.sham||m&&m.sham)&&ef(y,"sham",!0),ef(H,u,y),q&&(bP(Qh,c=A+"Prototype")||ef(Qh,c,{}),ef(Qh[c],u,f),e.real&&ne&&(r||!ne[u])&&ef(ne,u,f)))},U9=Math.ceil,V9=Math.floor,F9=Math.trunc||function(e){var n=+e;return(n>0?V9:U9)(n)},B9=F9,X0=function(e){var n=+e;return n!=n||n===0?0:B9(n)},j9=X0,$9=Math.max,H9=Math.min,J0=function(e,n){var r=j9(e);return r<0?$9(r+n,0):H9(r,n)},W9=X0,K9=Math.min,SP=function(e){return e>0?K9(W9(e),9007199254740991):0},G9=SP,Sl=function(e){return G9(e.length)},z9=Xe,Y9=J0,q9=Sl,TP=function(e){return function(n,r,i){var c,u=z9(n),f=q9(u),m=Y9(i,f);if(e&&r!=r){for(;f>m;)if((c=u[m++])!=c)return!0}else for(;f>m;m++)if((e||m in u)&&u[m]===r)return e||m||0;return!e&&-1}},Z0={includes:TP(!0),indexOf:TP(!1)},X9=Z0.includes;rr({target:"Array",proto:!0,forced:d(function(){return!Array(1).includes()})},{includes:function(e){return X9(this,e,arguments.length>1?arguments[1]:void 0)}});var J9=Ot,ma=function(e){return J9[e+"Prototype"]},Z9=ma("Array").includes,Q9=nt,e7=W,t7=Zr("match"),CP=function(e){var n;return Q9(e)&&((n=e[t7])!==void 0?!!n:e7(e)=="RegExp")},n7=CP,r7=TypeError,wP={};wP[Zr("toStringTag")]="z";var Q0=String(wP)==="[object z]",o7=Q0,s7=Ee,I_=W,i7=Zr("toStringTag"),a7=Object,c7=I_(function(){return arguments}())=="Arguments",kc=o7?I_:function(e){var n,r,i;return e===void 0?"Undefined":e===null?"Null":typeof(r=function(c,u){try{return c[u]}catch{}}(n=a7(e),i7))=="string"?r:c7?I_(n):(i=I_(n))=="Object"&&s7(n.callee)?"Arguments":i},l7=kc,u7=String,Wi=function(e){if(l7(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return u7(e)},d7=Zr("match"),h7=rr,f7=function(e){if(n7(e))throw r7("The method doesn't accept regular expressions");return e},p7=tt,RP=Wi,m7=function(e){var n=/./;try{"/./"[e](n)}catch{try{return n[d7]=!1,"/./"[e](n)}catch{}}return!1},v7=S("".indexOf);h7({target:"String",proto:!0,forced:!m7("includes")},{includes:function(e){return!!~v7(RP(p7(this)),RP(f7(e)),arguments.length>1?arguments[1]:void 0)}});var g7=ma("String").includes,IP=C,_7=Z9,E7=g7,eT=Array.prototype,tT=String.prototype,y7=function(e){var n=e.includes;return e===eT||IP(eT,e)&&n===eT.includes?_7:typeof e=="string"||e===tT||IP(tT,e)&&n===tT.includes?E7:n},gt=l(y7),b7=Rs,S7=zt,T7=it,C7=Sl,w7=TypeError,R7=function(e){return function(n,r,i,c){b7(r);var u=S7(n),f=T7(u),m=C7(u),_=e?m-1:0,y=e?-1:1;if(i<2)for(;;){if(_ in f){c=f[_],_+=y;break}if(_+=y,e?_<0:m<=_)throw w7("Reduce of empty array with no initial value")}for(;e?_>=0:m>_;_+=y)_ in f&&(c=r(c,f[_],_,u));return c}},I7={left:R7(!1)},A7=d,A_=function(e,n){var r=[][e];return!!r&&A7(function(){r.call(null,n||function(){return 1},1)})},tf=typeof process<"u"&&W(process)=="process",O7=I7.left;rr({target:"Array",proto:!0,forced:!tf&&Ke>79&&Ke<83||!A_("reduce")},{reduce:function(e){var n=arguments.length;return O7(this,e,n,n>1?arguments[1]:void 0)}});var N7=ma("Array").reduce,k7=C,P7=N7,nT=Array.prototype,D7=function(e){var n=e.reduce;return e===nT||k7(nT,e)&&n===nT.reduce?P7:n},AP=D7,qa=l(AP),L7=W,Cm=Array.isArray||function(e){return L7(e)=="Array"},M7=rr,x7=Cm,U7=S([].reverse),OP=[1,2];M7({target:"Array",proto:!0,forced:String(OP)===String(OP.reverse())},{reverse:function(){return x7(this)&&(this.length=this.length),U7(this)}});var V7=ma("Array").reverse,F7=C,B7=V7,rT=Array.prototype,j7=function(e){var n=e.reverse;return e===rT||F7(rT,e)&&n===rT.reverse?B7:n},NP=j7,kP=l(NP),$7=S_,PP=Si("keys"),O_=function(e){return PP[e]||(PP[e]=$7(e))},H7=!d(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),W7=mr,K7=Ee,G7=zt,z7=H7,DP=O_("IE_PROTO"),oT=Object,Y7=oT.prototype,sT=z7?oT.getPrototypeOf:function(e){var n=G7(e);if(W7(n,DP))return n[DP];var r=n.constructor;return K7(r)&&n instanceof r?r.prototype:n instanceof oT?Y7:null},q7=S,X7=Rs,J7=Ee,Z7=String,Q7=TypeError,eX=function(e,n,r){try{return q7(X7(Object.getOwnPropertyDescriptor(e,n)[r]))}catch{}},tX=Bs,nX=function(e){if(typeof e=="object"||J7(e))return e;throw Q7("Can't set "+Z7(e)+" as a prototype")},rX=Object.setPrototypeOf||("__proto__"in{}?function(){var e,n=!1,r={};try{(e=eX(Object.prototype,"__proto__","set"))(r,[]),n=r instanceof Array}catch{}return function(i,c){return tX(i),nX(c),n?e(i,c):i.__proto__=c,i}}():void 0),N_={},k_={},iT=mr,oX=Xe,sX=Z0.indexOf,iX=k_,LP=S([].push),MP=function(e,n){var r,i=oX(e),c=0,u=[];for(r in i)!iT(iX,r)&&iT(i,r)&&LP(u,r);for(;n.length>c;)iT(i,r=n[c++])&&(~sX(u,r)||LP(u,r));return u},aT=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],aX=MP,cX=aT.concat("length","prototype");N_.f=Object.getOwnPropertyNames||function(e){return aX(e,cX)};var wm={};wm.f=Object.getOwnPropertySymbols;var lX=sn,uX=N_,dX=wm,hX=Bs,fX=S([].concat),pX=lX("Reflect","ownKeys")||function(e){var n=uX.f(hX(e)),r=dX.f;return r?fX(n,r(e)):n},xP=mr,mX=pX,vX=ae,gX=pa,cT={},_X=MP,EX=aT,P_=Object.keys||function(e){return _X(e,EX)},yX=X,bX=EP,SX=pa,TX=Bs,CX=Xe,wX=P_;cT.f=yX&&!bX?Object.defineProperties:function(e,n){TX(e);for(var r,i=CX(n),c=wX(n),u=c.length,f=0;u>f;)SX.f(e,r=c[f++],i[r]);return e};var D_,UP=sn("document","documentElement"),RX=Bs,IX=cT,VP=aT,AX=k_,OX=UP,NX=K0,lT="prototype",uT="script",FP=O_("IE_PROTO"),dT=function(){},BP=function(e){return"<"+uT+">"+e+"</"+uT+">"},jP=function(e){e.write(BP("")),e.close();var n=e.parentWindow.Object;return e=null,n},L_=function(){try{D_=new ActiveXObject("htmlfile")}catch{}var e,n,r;L_=typeof document<"u"?document.domain&&D_?jP(D_):(n=NX("iframe"),r="java"+uT+":",n.style.display="none",OX.appendChild(n),n.src=String(r),(e=n.contentWindow.document).open(),e.write(BP("document.F=Object")),e.close(),e.F):jP(D_);for(var i=VP.length;i--;)delete L_[lT][VP[i]];return L_()};AX[FP]=!0;var Rm=Object.create||function(e,n){var r;return e!==null?(dT[lT]=RX(e),r=new dT,dT[lT]=null,r[FP]=e):r=L_(),n===void 0?r:IX.f(r,n)},kX=nt,PX=gu,$P=Error,DX=S("".replace),LX=String($P("zxcasd").stack),HP=/\n\s*at [^:]*:[^\n]*/,MX=HP.test(LX),xX=Le,UX=!d(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",xX(1,7)),e.stack!==7)}),VX=gu,FX=function(e,n){if(MX&&typeof e=="string"&&!$P.prepareStackTrace)for(;n--;)e=DX(e,HP,"");return e},BX=UX,WP=Error.captureStackTrace,Sd={},jX=Sd,$X=Zr("iterator"),HX=Array.prototype,KP=function(e){return e!==void 0&&(jX.Array===e||HX[$X]===e)},WX=kc,GP=pu,KX=ce,GX=Sd,zX=Zr("iterator"),M_=function(e){if(!KX(e))return GP(e,zX)||GP(e,"@@iterator")||GX[WX(e)]},YX=J,qX=Rs,XX=Bs,JX=Ga,ZX=M_,QX=TypeError,hT=function(e,n){var r=arguments.length<2?ZX(e):n;if(qX(r))return XX(YX(r,e));throw QX(JX(e)+" is not iterable")},eJ=J,zP=Bs,tJ=pu,YP=function(e,n,r){var i,c;zP(e);try{if(!(i=tJ(e,"return"))){if(n==="throw")throw r;return r}i=eJ(i,e)}catch(u){c=!0,i=u}if(n==="throw")throw r;if(c)throw i;return zP(i),r},nJ=vu,rJ=J,oJ=Bs,sJ=Ga,iJ=KP,aJ=Sl,qP=C,cJ=hT,lJ=M_,XP=YP,uJ=TypeError,x_=function(e,n){this.stopped=e,this.result=n},JP=x_.prototype,Im=function(e,n,r){var i,c,u,f,m,_,y,T=r&&r.that,A=!(!r||!r.AS_ENTRIES),k=!(!r||!r.IS_RECORD),P=!(!r||!r.IS_ITERATOR),q=!(!r||!r.INTERRUPTED),j=nJ(n,T),H=function(re){return i&&XP(i,"normal",re),new x_(!0,re)},ne=function(re){return A?(oJ(re),q?j(re[0],re[1],H):j(re[0],re[1])):q?j(re,H):j(re)};if(k)i=e.iterator;else if(P)i=e;else{if(!(c=lJ(e)))throw uJ(sJ(e)+" is not iterable");if(iJ(c)){for(u=0,f=aJ(e);f>u;u++)if((m=ne(e[u]))&&qP(JP,m))return m;return new x_(!1)}i=cJ(e,c)}for(_=k?e.next:i.next;!(y=rJ(_,i)).done;){try{m=ne(y.value)}catch(re){XP(i,"throw",re)}if(typeof m=="object"&&m&&qP(JP,m))return m}return new x_(!1)},dJ=Wi,hJ=rr,fJ=C,pJ=sT,U_=rX,mJ=function(e,n,r){for(var i=mX(n),c=gX.f,u=vX.f,f=0;f<i.length;f++){var m=i[f];xP(e,m)||r&&xP(r,m)||c(e,m,u(n,m))}},ZP=Rm,fT=gu,pT=Le,vJ=function(e,n){kX(n)&&"cause"in n&&PX(e,"cause",n.cause)},gJ=function(e,n,r,i){BX&&(WP?WP(e,n):VX(e,"stack",FX(r,i)))},_J=Im,EJ=function(e,n){return e===void 0?arguments.length<2?"":n:dJ(e)},yJ=Zr("toStringTag"),V_=Error,bJ=[].push,nf=function(e,n){var r,i=fJ(mT,this);U_?r=U_(V_(),i?pJ(this):mT):(r=i?this:ZP(mT),fT(r,yJ,"Error")),n!==void 0&&fT(r,"message",EJ(n)),gJ(r,nf,r.stack,1),arguments.length>2&&vJ(r,arguments[2]);var c=[];return _J(e,bJ,{that:c}),fT(r,"errors",c),r};U_?U_(nf,V_):mJ(nf,V_,{name:!0});var mT=nf.prototype=ZP(V_.prototype,{constructor:pT(1,nf),message:pT(1,""),name:pT(1,"AggregateError")});hJ({global:!0},{AggregateError:nf});var F_,Am,B_,SJ=Ee,QP=I.WeakMap,TJ=SJ(QP)&&/native code/.test(String(QP)),e1=I,CJ=nt,wJ=gu,vT=mr,gT=bi,RJ=O_,IJ=k_,t1="Object already initialized",_T=e1.TypeError,AJ=e1.WeakMap;if(TJ||gT.state){var Pc=gT.state||(gT.state=new AJ);Pc.get=Pc.get,Pc.has=Pc.has,Pc.set=Pc.set,F_=function(e,n){if(Pc.has(e))throw _T(t1);return n.facade=e,Pc.set(e,n),n},Am=function(e){return Pc.get(e)||{}},B_=function(e){return Pc.has(e)}}else{var rf=RJ("state");IJ[rf]=!0,F_=function(e,n){if(vT(e,rf))throw _T(t1);return n.facade=e,wJ(e,rf,n),n},Am=function(e){return vT(e,rf)?e[rf]:{}},B_=function(e){return vT(e,rf)}}var Td,n1,r1,Cd={set:F_,get:Am,has:B_,enforce:function(e){return B_(e)?Am(e):F_(e,{})},getterFor:function(e){return function(n){var r;if(!CJ(n)||(r=Am(n)).type!==e)throw _T("Incompatible receiver, "+e+" required");return r}}},ET=X,OJ=mr,o1=Function.prototype,NJ=ET&&Object.getOwnPropertyDescriptor,s1=OJ(o1,"name"),i1={PROPER:s1&&(function(){}).name==="something",CONFIGURABLE:s1&&(!ET||ET&&NJ(o1,"name").configurable)},kJ=gu,_u=function(e,n,r,i){return i&&i.enumerable?e[n]=r:kJ(e,n,r),e},PJ=d,DJ=Ee,LJ=nt,MJ=Rm,a1=sT,xJ=_u,yT=Zr("iterator"),c1=!1;[].keys&&("next"in(r1=[].keys())?(n1=a1(a1(r1)))!==Object.prototype&&(Td=n1):c1=!0);var UJ=!LJ(Td)||PJ(function(){var e={};return Td[yT].call(e)!==e});DJ((Td=UJ?{}:MJ(Td))[yT])||xJ(Td,yT,function(){return this});var l1={IteratorPrototype:Td,BUGGY_SAFARI_ITERATORS:c1},VJ=kc,FJ=Q0?{}.toString:function(){return"[object "+VJ(this)+"]"},BJ=Q0,jJ=pa.f,$J=gu,HJ=mr,WJ=FJ,u1=Zr("toStringTag"),Eu=function(e,n,r,i){if(e){var c=r?e:e.prototype;HJ(c,u1)||jJ(c,u1,{configurable:!0,value:n}),i&&!BJ&&$J(c,"toString",WJ)}},KJ=l1.IteratorPrototype,GJ=Rm,zJ=Le,YJ=Eu,qJ=Sd,XJ=function(){return this},bT=function(e,n,r,i){var c=n+" Iterator";return e.prototype=GJ(KJ,{next:zJ(+!i,r)}),YJ(e,c,!1,!0),qJ[c]=XJ,e},JJ=rr,ZJ=J,QJ=i1,eZ=bT,tZ=sT,nZ=Eu,d1=_u,h1=Sd,rZ=l1,oZ=QJ.PROPER,j_=rZ.BUGGY_SAFARI_ITERATORS,ST=Zr("iterator"),f1="keys",$_="values",p1="entries",sZ=function(){return this},m1=function(e,n,r,i,c,u,f){eZ(r,n,i);var m,_,y,T=function(ne){if(ne===c&&j)return j;if(!j_&&ne in P)return P[ne];switch(ne){case f1:case $_:case p1:return function(){return new r(this,ne)}}return function(){return new r(this)}},A=n+" Iterator",k=!1,P=e.prototype,q=P[ST]||P["@@iterator"]||c&&P[c],j=!j_&&q||T(c),H=n=="Array"&&P.entries||q;if(H&&(m=tZ(H.call(new e)))!==Object.prototype&&m.next&&(nZ(m,A,!0,!0),h1[A]=sZ),oZ&&c==$_&&q&&q.name!==$_&&(k=!0,j=function(){return ZJ(q,this)}),c)if(_={values:T($_),keys:u?j:T(f1),entries:T(p1)},f)for(y in _)(j_||k||!(y in P))&&d1(P,y,_[y]);else JJ({target:n,proto:!0,forced:j_||k},_);return f&&P[ST]!==j&&d1(P,ST,j,{}),h1[n]=j,_},TT=function(e,n){return{value:e,done:n}},iZ=Xe,v1=Sd,g1=Cd;pa.f;var aZ=m1,_1=TT,E1="Array Iterator",cZ=g1.set,lZ=g1.getterFor(E1);aZ(Array,"Array",function(e,n){cZ(this,{type:E1,target:iZ(e),index:0,kind:n})},function(){var e=lZ(this),n=e.target,r=e.kind,i=e.index++;return!n||i>=n.length?(e.target=void 0,_1(void 0,!0)):_1(r=="keys"?i:r=="values"?n[i]:[i,n[i]],!1)},"values"),v1.Arguments=v1.Array;var uZ=pa,H_=function(e,n,r){return uZ.f(e,n,r)},dZ=sn,hZ=H_,fZ=X,y1=Zr("species"),pZ=C,mZ=TypeError,CT=function(e,n){if(pZ(n,e))return e;throw mZ("Incorrect invocation")},vZ=Ee,wT=bi,gZ=S(Function.toString);vZ(wT.inspectSource)||(wT.inspectSource=function(e){return gZ(e)});var b1=wT.inspectSource,_Z=S,EZ=d,S1=Ee,yZ=kc,bZ=b1,T1=function(){},SZ=[],C1=sn("Reflect","construct"),RT=/^\s*(?:class|function)\b/,TZ=_Z(RT.exec),CZ=!RT.exec(T1),Om=function(e){if(!S1(e))return!1;try{return C1(T1,SZ,e),!0}catch{return!1}},w1=function(e){if(!S1(e))return!1;switch(yZ(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return CZ||!!TZ(RT,bZ(e))}catch{return!0}};w1.sham=!0;var Nm,of,R1,IT,W_=!C1||EZ(function(){var e;return Om(Om.call)||!Om(Object)||!Om(function(){e=!0})||e})?w1:Om,wZ=W_,RZ=Ga,IZ=TypeError,I1=Bs,AZ=function(e){if(wZ(e))return e;throw IZ(RZ(e)+" is not a constructor")},OZ=ce,NZ=Zr("species"),AT=function(e,n){var r,i=I1(e).constructor;return i===void 0||OZ(r=I1(i)[NZ])?n:AZ(r)},K_=S([].slice),kZ=TypeError,sf=function(e,n){if(e<n)throw kZ("Not enough arguments");return e},A1=/(?:ipad|iphone|ipod).*applewebkit/i.test(tn),Ki=I,PZ=L,DZ=vu,O1=Ee,LZ=mr,N1=d,k1=UP,MZ=K_,P1=K0,xZ=sf,UZ=A1,VZ=tf,OT=Ki.setImmediate,NT=Ki.clearImmediate,FZ=Ki.process,kT=Ki.Dispatch,BZ=Ki.Function,D1=Ki.MessageChannel,jZ=Ki.String,PT=0,km={},L1="onreadystatechange";N1(function(){Nm=Ki.location});var DT=function(e){if(LZ(km,e)){var n=km[e];delete km[e],n()}},LT=function(e){return function(){DT(e)}},M1=function(e){DT(e.data)},x1=function(e){Ki.postMessage(jZ(e),Nm.protocol+"//"+Nm.host)};OT&&NT||(OT=function(e){xZ(arguments.length,1);var n=O1(e)?e:BZ(e),r=MZ(arguments,1);return km[++PT]=function(){PZ(n,void 0,r)},of(PT),PT},NT=function(e){delete km[e]},VZ?of=function(e){FZ.nextTick(LT(e))}:kT&&kT.now?of=function(e){kT.now(LT(e))}:D1&&!UZ?(IT=(R1=new D1).port2,R1.port1.onmessage=M1,of=DZ(IT.postMessage,IT)):Ki.addEventListener&&O1(Ki.postMessage)&&!Ki.importScripts&&Nm&&Nm.protocol!=="file:"&&!N1(x1)?(of=x1,Ki.addEventListener("message",M1,!1)):of=L1 in P1("script")?function(e){k1.appendChild(P1("script"))[L1]=function(){k1.removeChild(this),DT(e)}}:function(e){setTimeout(LT(e),0)});var G_={set:OT,clear:NT},U1=function(){this.head=null,this.tail=null};U1.prototype={add:function(e){var n={item:e,next:null},r=this.tail;r?r.next=n:this.head=n,this.tail=n},get:function(){var e=this.head;if(e)return(this.head=e.next)===null&&(this.tail=null),e.item}};var af,MT,xT,UT,V1,F1=U1,$Z=/ipad|iphone|ipod/i.test(tn)&&typeof Pebble<"u",HZ=/web0s(?!.*chrome)/i.test(tn),wd=I,B1=vu,WZ=ae.f,VT=G_.set,KZ=F1,GZ=A1,zZ=$Z,YZ=HZ,FT=tf,j1=wd.MutationObserver||wd.WebKitMutationObserver,$1=wd.document,H1=wd.process,z_=wd.Promise,W1=WZ(wd,"queueMicrotask"),BT=W1&&W1.value;if(!BT){var Y_=new KZ,q_=function(){var e,n;for(FT&&(e=H1.domain)&&e.exit();n=Y_.get();)try{n()}catch(r){throw Y_.head&&af(),r}e&&e.enter()};GZ||FT||YZ||!j1||!$1?!zZ&&z_&&z_.resolve?((UT=z_.resolve(void 0)).constructor=z_,V1=B1(UT.then,UT),af=function(){V1(q_)}):FT?af=function(){H1.nextTick(q_)}:(VT=B1(VT,wd),af=function(){VT(q_)}):(MT=!0,xT=$1.createTextNode(""),new j1(q_).observe(xT,{characterData:!0}),af=function(){xT.data=MT=!MT}),BT=function(e){Y_.head||af(),Y_.add(e)}}var K1=BT,cf=function(e){try{return{error:!1,value:e()}}catch(n){return{error:!0,value:n}}},Rd=I.Promise,G1=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",qZ=!G1&&!tf&&typeof window=="object"&&typeof document=="object",XZ=I,Pm=Rd,JZ=Ee,ZZ=_P,QZ=b1,eQ=Zr,tQ=qZ,nQ=G1,jT=Ke,z1=Pm&&Pm.prototype,rQ=eQ("species"),Y1=JZ(XZ.PromiseRejectionEvent),oQ=ZZ("Promise",function(){var e=QZ(Pm),n=e!==String(Pm);if(!n&&jT===66||!z1.catch||!z1.finally)return!0;if(!jT||jT<51||!/native code/.test(e)){var r=new Pm(function(c){c(1)}),i=function(c){c(function(){},function(){})};if((r.constructor={})[rQ]=i,!(r.then(function(){})instanceof i))return!0}return!n&&(tQ||nQ)&&!Y1}),Dm={CONSTRUCTOR:oQ,REJECTION_EVENT:Y1},Dc={},q1=Rs,sQ=TypeError,iQ=function(e){var n,r;this.promise=new e(function(i,c){if(n!==void 0||r!==void 0)throw sQ("Bad Promise constructor");n=i,r=c}),this.resolve=q1(n),this.reject=q1(r)};Dc.f=function(e){return new iQ(e)};var $T,X1,aQ=rr,X_=tf,yu=I,Lm=J,cQ=_u,lQ=Eu,uQ=function(e){var n=dZ(e);fZ&&n&&!n[y1]&&hZ(n,y1,{configurable:!0,get:function(){return this}})},dQ=Rs,HT=Ee,hQ=nt,fQ=CT,pQ=AT,J1=G_.set,WT=K1,mQ=function(e,n){try{arguments.length==1?console.error(e):console.error(e,n)}catch{}},vQ=cf,gQ=F1,Z1=Cd,KT=Rd,Q1=Dm,eD=Dc,J_="Promise",tD=Q1.CONSTRUCTOR,_Q=Q1.REJECTION_EVENT,GT=Z1.getterFor(J_),EQ=Z1.set,yQ=KT&&KT.prototype,Mm=KT,zT=yQ,nD=yu.TypeError,YT=yu.document,qT=yu.process,XT=eD.f,bQ=XT,SQ=!!(YT&&YT.createEvent&&yu.dispatchEvent),rD="unhandledrejection",oD=function(e){var n;return!(!hQ(e)||!HT(n=e.then))&&n},sD=function(e,n){var r,i,c,u=n.value,f=n.state==1,m=f?e.ok:e.fail,_=e.resolve,y=e.reject,T=e.domain;try{m?(f||(n.rejection===2&&CQ(n),n.rejection=1),m===!0?r=u:(T&&T.enter(),r=m(u),T&&(T.exit(),c=!0)),r===e.promise?y(nD("Promise-chain cycle")):(i=oD(r))?Lm(i,r,_,y):_(r)):y(u)}catch(A){T&&!c&&T.exit(),y(A)}},iD=function(e,n){e.notified||(e.notified=!0,WT(function(){for(var r,i=e.reactions;r=i.get();)sD(r,e);e.notified=!1,n&&!e.rejection&&TQ(e)}))},aD=function(e,n,r){var i,c;SQ?((i=YT.createEvent("Event")).promise=n,i.reason=r,i.initEvent(e,!1,!0),yu.dispatchEvent(i)):i={promise:n,reason:r},!_Q&&(c=yu["on"+e])?c(i):e===rD&&mQ("Unhandled promise rejection",r)},TQ=function(e){Lm(J1,yu,function(){var n,r=e.facade,i=e.value;if(cD(e)&&(n=vQ(function(){X_?qT.emit("unhandledRejection",i,r):aD(rD,r,i)}),e.rejection=X_||cD(e)?2:1,n.error))throw n.value})},cD=function(e){return e.rejection!==1&&!e.parent},CQ=function(e){Lm(J1,yu,function(){var n=e.facade;X_?qT.emit("rejectionHandled",n):aD("rejectionhandled",n,e.value)})},lf=function(e,n,r){return function(i){e(n,i,r)}},uf=function(e,n,r){e.done||(e.done=!0,r&&(e=r),e.value=n,e.state=2,iD(e,!0))},JT=function(e,n,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===n)throw nD("Promise can't be resolved itself");var i=oD(n);i?WT(function(){var c={done:!1};try{Lm(i,n,lf(JT,c,e),lf(uf,c,e))}catch(u){uf(c,u,e)}}):(e.value=n,e.state=1,iD(e,!1))}catch(c){uf({done:!1},c,e)}}};tD&&(zT=(Mm=function(e){fQ(this,zT),dQ(e),Lm($T,this);var n=GT(this);try{e(lf(JT,n),lf(uf,n))}catch(r){uf(n,r)}}).prototype,($T=function(e){EQ(this,{type:J_,done:!1,notified:!1,parent:!1,reactions:new gQ,rejection:!1,state:0,value:void 0})}).prototype=cQ(zT,"then",function(e,n){var r=GT(this),i=XT(pQ(this,Mm));return r.parent=!0,i.ok=!HT(e)||e,i.fail=HT(n)&&n,i.domain=X_?qT.domain:void 0,r.state==0?r.reactions.add(i):WT(function(){sD(i,r)}),i.promise}),X1=function(){var e=new $T,n=GT(e);this.promise=e,this.resolve=lf(JT,n),this.reject=lf(uf,n)},eD.f=XT=function(e){return e===Mm||e===void 0?new X1(e):bQ(e)}),aQ({global:!0,wrap:!0,forced:tD},{Promise:Mm}),lQ(Mm,J_,!1,!0),uQ(J_);var lD=Zr("iterator"),uD=!1;try{var wQ=0,dD={next:function(){return{done:!!wQ++}},return:function(){uD=!0}};dD[lD]=function(){return this},Array.from(dD,function(){throw 2})}catch{}var RQ=Rd,IQ=function(e,n){if(!uD)return!1;var r=!1;try{var i={};i[lD]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch{}return r},Z_=Dm.CONSTRUCTOR||!IQ(function(e){RQ.all(e).then(void 0,function(){})}),AQ=J,OQ=Rs,NQ=Dc,kQ=cf,PQ=Im;rr({target:"Promise",stat:!0,forced:Z_},{all:function(e){var n=this,r=NQ.f(n),i=r.resolve,c=r.reject,u=kQ(function(){var f=OQ(n.resolve),m=[],_=0,y=1;PQ(e,function(T){var A=_++,k=!1;y++,AQ(f,n,T).then(function(P){k||(k=!0,m[A]=P,--y||i(m))},c)}),--y||i(m)});return u.error&&c(u.value),r.promise}});var DQ=rr,LQ=Dm.CONSTRUCTOR;Rd&&Rd.prototype,DQ({target:"Promise",proto:!0,forced:LQ,real:!0},{catch:function(e){return this.then(void 0,e)}});var MQ=J,xQ=Rs,UQ=Dc,VQ=cf,FQ=Im;rr({target:"Promise",stat:!0,forced:Z_},{race:function(e){var n=this,r=UQ.f(n),i=r.reject,c=VQ(function(){var u=xQ(n.resolve);FQ(e,function(f){MQ(u,n,f).then(r.resolve,i)})});return c.error&&i(c.value),r.promise}});var BQ=J,jQ=Dc;rr({target:"Promise",stat:!0,forced:Dm.CONSTRUCTOR},{reject:function(e){var n=jQ.f(this);return BQ(n.reject,void 0,e),n.promise}});var $Q=Bs,HQ=nt,WQ=Dc,hD=function(e,n){if($Q(e),HQ(n)&&n.constructor===e)return n;var r=WQ.f(e);return(0,r.resolve)(n),r.promise},KQ=rr,GQ=Rd,zQ=Dm.CONSTRUCTOR,YQ=hD,qQ=sn("Promise"),XQ=!zQ;KQ({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return YQ(XQ&&this===qQ?GQ:this,e)}});var JQ=J,ZQ=Rs,QQ=Dc,eee=cf,tee=Im;rr({target:"Promise",stat:!0,forced:Z_},{allSettled:function(e){var n=this,r=QQ.f(n),i=r.resolve,c=r.reject,u=eee(function(){var f=ZQ(n.resolve),m=[],_=0,y=1;tee(e,function(T){var A=_++,k=!1;y++,JQ(f,n,T).then(function(P){k||(k=!0,m[A]={status:"fulfilled",value:P},--y||i(m))},function(P){k||(k=!0,m[A]={status:"rejected",reason:P},--y||i(m))})}),--y||i(m)});return u.error&&c(u.value),r.promise}});var nee=J,ree=Rs,oee=sn,see=Dc,iee=cf,aee=Im,fD="No one promise resolved";rr({target:"Promise",stat:!0,forced:Z_},{any:function(e){var n=this,r=oee("AggregateError"),i=see.f(n),c=i.resolve,u=i.reject,f=iee(function(){var m=ree(n.resolve),_=[],y=0,T=1,A=!1;aee(e,function(k){var P=y++,q=!1;T++,nee(m,n,k).then(function(j){q||A||(A=!0,c(j))},function(j){q||A||(q=!0,_[P]=j,--T||u(new r(_,fD)))})}),--T||u(new r(_,fD))});return f.error&&u(f.value),i.promise}});var cee=rr,ZT=Rd,lee=d,uee=sn,dee=Ee,hee=AT,pD=hD,fee=ZT&&ZT.prototype;cee({target:"Promise",proto:!0,real:!0,forced:!!ZT&&lee(function(){fee.finally.call({then:function(){}},function(){})})},{finally:function(e){var n=hee(this,uee("Promise")),r=dee(e);return this.then(r?function(i){return pD(n,e()).then(function(){return i})}:e,r?function(i){return pD(n,e()).then(function(){throw i})}:e)}});var QT=S,pee=X0,mee=Wi,vee=tt,gee=QT("".charAt),mD=QT("".charCodeAt),_ee=QT("".slice),vD=function(e){return function(n,r){var i,c,u=mee(vee(n)),f=pee(r),m=u.length;return f<0||f>=m?e?"":void 0:(i=mD(u,f))<55296||i>56319||f+1===m||(c=mD(u,f+1))<56320||c>57343?e?gee(u,f):i:e?_ee(u,f,f+2):c-56320+(i-55296<<10)+65536}},eC={codeAt:vD(!1),charAt:vD(!0)},Eee=eC.charAt,yee=Wi,gD=Cd,bee=m1,_D=TT,ED="String Iterator",See=gD.set,Tee=gD.getterFor(ED);bee(String,"String",function(e){See(this,{type:ED,string:yee(e),index:0})},function(){var e,n=Tee(this),r=n.string,i=n.index;return i>=r.length?_D(void 0,!0):(e=Eee(r,i),n.index+=e.length,_D(e,!1))});var Cee=Ot.Promise,wee={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ree=I,Iee=kc,Aee=gu,yD=Sd,bD=Zr("toStringTag");for(var tC in wee){var SD=Ree[tC],nC=SD&&SD.prototype;nC&&Iee(nC)!==bD&&Aee(nC,bD,tC),yD[tC]=yD.Array}var TD=Cee,bt=l(TD),Oee=ma("Array").values,Nee=kc,kee=mr,Pee=C,Dee=Oee,rC=Array.prototype,Lee={DOMTokenList:!0,NodeList:!0},Mee=function(e){var n=e.values;return e===rC||Pee(rC,e)&&n===rC.values||kee(Lee,Nee(e))?Dee:n},Ti=l(Mee),xee=d,Uee=Zr("iterator"),oC=!xee(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),n=e.searchParams,r=new URLSearchParams("a=1&a=2"),i="";return e.pathname="c%20d",n.forEach(function(c,u){n.delete("b"),i+=u+c}),r.delete("a",2),!e.toJSON||!r.has("a",1)||r.has("a",2)||!n.size&&!0||!n.sort||e.href!=="http://a/c%20d?a=1&c=3"||n.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!n[Uee]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||i!=="a1c3"||new URL("http://x",void 0).host!=="x"}),Vee=_u,Fee=C_,Bee=pa,jee=Le,Q_=function(e,n,r){var i=Fee(n);i in e?Bee.f(e,i,jee(0,r)):e[i]=r},CD=J0,$ee=Sl,Hee=Q_,Wee=Array,Kee=Math.max,sC=function(e,n,r){for(var i=$ee(e),c=CD(n,i),u=CD(r===void 0?i:r,i),f=Wee(Kee(u-c,0)),m=0;c<u;c++,m++)Hee(f,m,e[c]);return f.length=m,f},wD=sC,Gee=Math.floor,iC=function(e,n){var r=e.length,i=Gee(r/2);return r<8?zee(e,n):Yee(e,iC(wD(e,0,i),n),iC(wD(e,i),n),n)},zee=function(e,n){for(var r,i,c=e.length,u=1;u<c;){for(i=u,r=e[u];i&&n(e[i-1],r)>0;)e[i]=e[--i];i!==u++&&(e[i]=r)}return e},Yee=function(e,n,r,i){for(var c=n.length,u=r.length,f=0,m=0;f<c||m<u;)e[f+m]=f<c&&m<u?i(n[f],r[m])<=0?n[f++]:r[m++]:f<c?n[f++]:r[m++];return e},RD=iC,aC=rr,df=I,eE=J,Lc=S,hf=X,ID=oC,AD=_u,qee=H_,Xee=function(e,n,r){for(var i in n)r&&r.unsafe&&e[i]?e[i]=n[i]:Vee(e,i,n[i],r);return e},Jee=Eu,Zee=bT,cC=Cd,OD=CT,lC=Ee,Qee=mr,ete=vu,tte=kc,nte=Bs,ND=nt,ri=Wi,rte=Rm,kD=Le,uC=hT,ote=M_,ff=sf,ste=RD,ite=Zr("iterator"),xm="URLSearchParams",PD=xm+"Iterator",DD=cC.set,va=cC.getterFor(xm),ate=cC.getterFor(PD),cte=Object.getOwnPropertyDescriptor,dC=function(e){if(!hf)return df[e];var n=cte(df,e);return n&&n.value},LD=dC("fetch"),tE=dC("Request"),Um=dC("Headers"),hC=tE&&tE.prototype,MD=Um&&Um.prototype,lte=df.RegExp,ute=df.TypeError,xD=df.decodeURIComponent,dte=df.encodeURIComponent,hte=Lc("".charAt),UD=Lc([].join),Id=Lc([].push),fC=Lc("".replace),fte=Lc([].shift),VD=Lc([].splice),FD=Lc("".split),pte=Lc("".slice),mte=/\+/g,BD=Array(4),vte=function(e){return BD[e-1]||(BD[e-1]=lte("((?:%[\\da-f]{2}){"+e+"})","gi"))},gte=function(e){try{return xD(e)}catch{return e}},jD=function(e){var n=fC(e,mte," "),r=4;try{return xD(n)}catch{for(;r;)n=fC(n,vte(r--),gte);return n}},_te=/[!'()~]|%20/g,Ete={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},yte=function(e){return Ete[e]},$D=function(e){return fC(dte(e),_te,yte)},pC=Zee(function(e,n){DD(this,{type:PD,iterator:uC(va(e).entries),kind:n})},"Iterator",function(){var e=ate(this),n=e.kind,r=e.iterator.next(),i=r.value;return r.done||(r.value=n==="keys"?i.key:n==="values"?i.value:[i.key,i.value]),r},!0),HD=function(e){this.entries=[],this.url=null,e!==void 0&&(ND(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?hte(e,0)==="?"?pte(e,1):e:ri(e)))};HD.prototype={type:xm,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var n,r,i,c,u,f,m,_=ote(e);if(_)for(r=(n=uC(e,_)).next;!(i=eE(r,n)).done;){if(u=(c=uC(nte(i.value))).next,(f=eE(u,c)).done||(m=eE(u,c)).done||!eE(u,c).done)throw ute("Expected sequence with length 2");Id(this.entries,{key:ri(f.value),value:ri(m.value)})}else for(var y in e)Qee(e,y)&&Id(this.entries,{key:y,value:ri(e[y])})},parseQuery:function(e){if(e)for(var n,r,i=FD(e,"&"),c=0;c<i.length;)(n=i[c++]).length&&(r=FD(n,"="),Id(this.entries,{key:jD(fte(r)),value:jD(UD(r,"="))}))},serialize:function(){for(var e,n=this.entries,r=[],i=0;i<n.length;)e=n[i++],Id(r,$D(e.key)+"="+$D(e.value));return UD(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var nE=function(){OD(this,pf);var e=DD(this,new HD(arguments.length>0?arguments[0]:void 0));hf||(this.size=e.entries.length)},pf=nE.prototype;if(Xee(pf,{append:function(e,n){var r=va(this);ff(arguments.length,2),Id(r.entries,{key:ri(e),value:ri(n)}),hf||this.length++,r.updateURL()},delete:function(e){for(var n=va(this),r=ff(arguments.length,1),i=n.entries,c=ri(e),u=r<2?void 0:arguments[1],f=u===void 0?u:ri(u),m=0;m<i.length;){var _=i[m];if(_.key!==c||f!==void 0&&_.value!==f)m++;else if(VD(i,m,1),f!==void 0)break}hf||(this.size=i.length),n.updateURL()},get:function(e){var n=va(this).entries;ff(arguments.length,1);for(var r=ri(e),i=0;i<n.length;i++)if(n[i].key===r)return n[i].value;return null},getAll:function(e){var n=va(this).entries;ff(arguments.length,1);for(var r=ri(e),i=[],c=0;c<n.length;c++)n[c].key===r&&Id(i,n[c].value);return i},has:function(e){for(var n=va(this).entries,r=ff(arguments.length,1),i=ri(e),c=r<2?void 0:arguments[1],u=c===void 0?c:ri(c),f=0;f<n.length;){var m=n[f++];if(m.key===i&&(u===void 0||m.value===u))return!0}return!1},set:function(e,n){var r=va(this);ff(arguments.length,1);for(var i,c=r.entries,u=!1,f=ri(e),m=ri(n),_=0;_<c.length;_++)(i=c[_]).key===f&&(u?VD(c,_--,1):(u=!0,i.value=m));u||Id(c,{key:f,value:m}),hf||(this.size=c.length),r.updateURL()},sort:function(){var e=va(this);ste(e.entries,function(n,r){return n.key>r.key?1:-1}),e.updateURL()},forEach:function(e){for(var n,r=va(this).entries,i=ete(e,arguments.length>1?arguments[1]:void 0),c=0;c<r.length;)i((n=r[c++]).value,n.key,this)},keys:function(){return new pC(this,"keys")},values:function(){return new pC(this,"values")},entries:function(){return new pC(this,"entries")}},{enumerable:!0}),AD(pf,ite,pf.entries,{}),AD(pf,"toString",function(){return va(this).serialize()},{enumerable:!0}),hf&&qee(pf,"size",{get:function(){return va(this).entries.length},configurable:!0,enumerable:!0}),Jee(nE,xm),aC({global:!0,forced:!ID},{URLSearchParams:nE}),!ID&&lC(Um)){var bte=Lc(MD.has),Ste=Lc(MD.set),WD=function(e){if(ND(e)){var n,r=e.body;if(tte(r)===xm)return n=e.headers?new Um(e.headers):new Um,bte(n,"content-type")||Ste(n,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),rte(e,{body:kD(0,ri(r)),headers:kD(0,n)})}return e};if(lC(LD)&&aC({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return LD(e,arguments.length>1?WD(arguments[1]):{})}}),lC(tE)){var mC=function(e){return OD(this,hC),new tE(e,arguments.length>1?WD(arguments[1]):{})};hC.constructor=mC,mC.prototype=hC,aC({global:!0,dontCallGetSet:!0,forced:!0},{Request:mC})}}var ga,Tte={URLSearchParams:nE,getState:va},Cte=Ot.URLSearchParams,KD=X,wte=S,Rte=J,Ite=d,vC=P_,Ate=wm,Ote=pe,Nte=zt,kte=it,mf=Object.assign,GD=Object.defineProperty,Pte=wte([].concat),Dte=!mf||Ite(function(){if(KD&&mf({b:1},mf(GD({},"a",{enumerable:!0,get:function(){GD(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},n={},r=Symbol(),i="abcdefghijklmnopqrst";return e[r]=7,i.split("").forEach(function(c){n[c]=c}),mf({},e)[r]!=7||vC(mf({},n)).join("")!=i})?function(e,n){for(var r=Nte(e),i=arguments.length,c=1,u=Ate.f,f=Ote.f;i>c;)for(var m,_=kte(arguments[c++]),y=u?Pte(vC(_),u(_)):vC(_),T=y.length,A=0;T>A;)m=y[A++],KD&&!Rte(f,_,m)||(r[m]=_[m]);return r}:mf,Lte=Bs,Mte=YP,xte=vu,Ute=J,Vte=zt,Fte=function(e,n,r,i){try{return i?n(Lte(r)[0],r[1]):n(r)}catch(c){Mte(e,"throw",c)}},Bte=KP,jte=W_,$te=Sl,zD=Q_,Hte=hT,Wte=M_,YD=Array,Ad=S,gC=2147483647,Kte=/[^\0-\u007E]/,qD=/[.\u3002\uFF0E\uFF61]/g,XD="Overflow: input needs wider integers to process",JD=RangeError,Gte=Ad(qD.exec),vf=Math.floor,_C=String.fromCharCode,ZD=Ad("".charCodeAt),QD=Ad([].join),bu=Ad([].push),zte=Ad("".replace),Yte=Ad("".split),qte=Ad("".toLowerCase),eL=function(e){return e+22+75*(e<26)},Xte=function(e,n,r){var i=0;for(e=r?vf(e/700):e>>1,e+=vf(e/n);e>455;)e=vf(e/35),i+=36;return vf(i+36*e/(e+38))},Jte=function(e){var n=[];e=function(ne){for(var re=[],ve=0,Oe=ne.length;ve<Oe;){var ke=ZD(ne,ve++);if(ke>=55296&&ke<=56319&&ve<Oe){var we=ZD(ne,ve++);(64512&we)==56320?bu(re,((1023&ke)<<10)+(1023&we)+65536):(bu(re,ke),ve--)}else bu(re,ke)}return re}(e);var r,i,c=e.length,u=128,f=0,m=72;for(r=0;r<e.length;r++)(i=e[r])<128&&bu(n,_C(i));var _=n.length,y=_;for(_&&bu(n,"-");y<c;){var T=gC;for(r=0;r<e.length;r++)(i=e[r])>=u&&i<T&&(T=i);var A=y+1;if(T-u>vf((gC-f)/A))throw JD(XD);for(f+=(T-u)*A,u=T,r=0;r<e.length;r++){if((i=e[r])<u&&++f>gC)throw JD(XD);if(i==u){for(var k=f,P=36;;){var q=P<=m?1:P>=m+26?26:P-m;if(k<q)break;var j=k-q,H=36-q;bu(n,_C(eL(q+j%H))),k=vf(j/H),P+=36}bu(n,_C(eL(k))),m=Xte(f,A,y==_),f=0,y++}}f++,u++}return QD(n,"")},Zte=rr,EC=X,Qte=oC,yC=I,tL=vu,_a=S,rE=_u,Ea=H_,ene=CT,bC=mr,SC=Dte,gf=function(e){var n=Vte(e),r=jte(this),i=arguments.length,c=i>1?arguments[1]:void 0,u=c!==void 0;u&&(c=xte(c,i>2?arguments[2]:void 0));var f,m,_,y,T,A,k=Wte(n),P=0;if(!k||this===YD&&Bte(k))for(f=$te(n),m=r?new this(f):YD(f);f>P;P++)A=u?c(n[P],P):n[P],zD(m,P,A);else for(T=(y=Hte(n,k)).next,m=r?new this:[];!(_=Ute(T,y)).done;P++)A=u?Fte(y,c,[_.value,P],!0):_.value,zD(m,P,A);return m.length=P,m},Xa=sC,tne=eC.codeAt,nne=function(e){var n,r,i=[],c=Yte(zte(qte(e),qD,"."),".");for(n=0;n<c.length;n++)r=c[n],bu(i,Gte(Kte,r)?"xn--"+Jte(r):r);return QD(i,".")},Tl=Wi,rne=Eu,one=sf,nL=Tte,rL=Cd,sne=rL.set,oE=rL.getterFor("URL"),ine=nL.URLSearchParams,ane=nL.getState,Vm=yC.URL,TC=yC.TypeError,sE=yC.parseInt,cne=Math.floor,oL=Math.pow,ya=_a("".charAt),Ja=_a(/./.exec),Fm=_a([].join),lne=_a(1 .toString),une=_a([].pop),_f=_a([].push),CC=_a("".replace),dne=_a([].shift),hne=_a("".split),Bm=_a("".slice),iE=_a("".toLowerCase),fne=_a([].unshift),wC="Invalid scheme",Od="Invalid host",sL="Invalid port",iL=/[a-z]/i,pne=/[\d+-.a-z]/i,RC=/\d/,mne=/^0x/i,vne=/^[0-7]+$/,gne=/^\d+$/,aL=/^[\da-f]+$/i,_ne=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Ene=/[\0\t\n\r #/:<>?@[\\\]^|]/,yne=/^[\u0000-\u0020]+/,bne=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,Sne=/[\t\n\r]/g,jm=function(e){var n,r,i,c;if(typeof e=="number"){for(n=[],r=0;r<4;r++)fne(n,e%256),e=cne(e/256);return Fm(n,".")}if(typeof e=="object"){for(n="",i=function(u){for(var f=null,m=1,_=null,y=0,T=0;T<8;T++)u[T]!==0?(y>m&&(f=_,m=y),_=null,y=0):(_===null&&(_=T),++y);return y>m&&(f=_,m=y),f}(e),r=0;r<8;r++)c&&e[r]===0||(c&&(c=!1),i===r?(n+=r?":":"::",c=!0):(n+=lne(e[r],16),r<7&&(n+=":")));return"["+n+"]"}return e},aE={},cL=SC({},aE,{" ":1,'"':1,"<":1,">":1,"`":1}),lL=SC({},cL,{"#":1,"?":1,"{":1,"}":1}),IC=SC({},lL,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Su=function(e,n){var r=tne(e,0);return r>32&&r<127&&!bC(n,e)?e:encodeURIComponent(e)},cE={ftp:21,file:null,http:80,https:443,ws:80,wss:443},$m=function(e,n){var r;return e.length==2&&Ja(iL,ya(e,0))&&((r=ya(e,1))==":"||!n&&r=="|")},uL=function(e){var n;return e.length>1&&$m(Bm(e,0,2))&&(e.length==2||(n=ya(e,2))==="/"||n==="\\"||n==="?"||n==="#")},Tne=function(e){return e==="."||iE(e)==="%2e"},AC={},dL={},OC={},hL={},fL={},NC={},pL={},mL={},lE={},uE={},kC={},PC={},DC={},LC={},vL={},MC={},Ef={},Mc={},gL={},Nd={},Cl={},xC=function(e,n,r){var i,c,u,f=Tl(e);if(n){if(c=this.parse(f))throw TC(c);this.searchParams=null}else{if(r!==void 0&&(i=new xC(r,!0)),c=this.parse(f,null,i))throw TC(c);(u=ane(new ine)).bindURL(this),this.searchParams=u}};xC.prototype={type:"URL",parse:function(e,n,r){var i,c,u,f,m,_=this,y=n||AC,T=0,A="",k=!1,P=!1,q=!1;for(e=Tl(e),n||(_.scheme="",_.username="",_.password="",_.host=null,_.port=null,_.path=[],_.query=null,_.fragment=null,_.cannotBeABaseURL=!1,e=CC(e,yne,""),e=CC(e,bne,"$1")),e=CC(e,Sne,""),i=gf(e);T<=i.length;){switch(c=i[T],y){case AC:if(!c||!Ja(iL,c)){if(n)return wC;y=OC;continue}A+=iE(c),y=dL;break;case dL:if(c&&(Ja(pne,c)||c=="+"||c=="-"||c=="."))A+=iE(c);else{if(c!=":"){if(n)return wC;A="",y=OC,T=0;continue}if(n&&(_.isSpecial()!=bC(cE,A)||A=="file"&&(_.includesCredentials()||_.port!==null)||_.scheme=="file"&&!_.host))return;if(_.scheme=A,n)return void(_.isSpecial()&&cE[_.scheme]==_.port&&(_.port=null));A="",_.scheme=="file"?y=LC:_.isSpecial()&&r&&r.scheme==_.scheme?y=hL:_.isSpecial()?y=mL:i[T+1]=="/"?(y=fL,T++):(_.cannotBeABaseURL=!0,_f(_.path,""),y=gL)}break;case OC:if(!r||r.cannotBeABaseURL&&c!="#")return wC;if(r.cannotBeABaseURL&&c=="#"){_.scheme=r.scheme,_.path=Xa(r.path),_.query=r.query,_.fragment="",_.cannotBeABaseURL=!0,y=Cl;break}y=r.scheme=="file"?LC:NC;continue;case hL:if(c!="/"||i[T+1]!="/"){y=NC;continue}y=lE,T++;break;case fL:if(c=="/"){y=uE;break}y=Mc;continue;case NC:if(_.scheme=r.scheme,c==ga)_.username=r.username,_.password=r.password,_.host=r.host,_.port=r.port,_.path=Xa(r.path),_.query=r.query;else if(c=="/"||c=="\\"&&_.isSpecial())y=pL;else if(c=="?")_.username=r.username,_.password=r.password,_.host=r.host,_.port=r.port,_.path=Xa(r.path),_.query="",y=Nd;else{if(c!="#"){_.username=r.username,_.password=r.password,_.host=r.host,_.port=r.port,_.path=Xa(r.path),_.path.length--,y=Mc;continue}_.username=r.username,_.password=r.password,_.host=r.host,_.port=r.port,_.path=Xa(r.path),_.query=r.query,_.fragment="",y=Cl}break;case pL:if(!_.isSpecial()||c!="/"&&c!="\\"){if(c!="/"){_.username=r.username,_.password=r.password,_.host=r.host,_.port=r.port,y=Mc;continue}y=uE}else y=lE;break;case mL:if(y=lE,c!="/"||ya(A,T+1)!="/")continue;T++;break;case lE:if(c!="/"&&c!="\\"){y=uE;continue}break;case uE:if(c=="@"){k&&(A="%40"+A),k=!0,u=gf(A);for(var j=0;j<u.length;j++){var H=u[j];if(H!=":"||q){var ne=Su(H,IC);q?_.password+=ne:_.username+=ne}else q=!0}A=""}else if(c==ga||c=="/"||c=="?"||c=="#"||c=="\\"&&_.isSpecial()){if(k&&A=="")return"Invalid authority";T-=gf(A).length+1,A="",y=kC}else A+=c;break;case kC:case PC:if(n&&_.scheme=="file"){y=MC;continue}if(c!=":"||P){if(c==ga||c=="/"||c=="?"||c=="#"||c=="\\"&&_.isSpecial()){if(_.isSpecial()&&A=="")return Od;if(n&&A==""&&(_.includesCredentials()||_.port!==null))return;if(f=_.parseHost(A))return f;if(A="",y=Ef,n)return;continue}c=="["?P=!0:c=="]"&&(P=!1),A+=c}else{if(A=="")return Od;if(f=_.parseHost(A))return f;if(A="",y=DC,n==PC)return}break;case DC:if(!Ja(RC,c)){if(c==ga||c=="/"||c=="?"||c=="#"||c=="\\"&&_.isSpecial()||n){if(A!=""){var re=sE(A,10);if(re>65535)return sL;_.port=_.isSpecial()&&re===cE[_.scheme]?null:re,A=""}if(n)return;y=Ef;continue}return sL}A+=c;break;case LC:if(_.scheme="file",c=="/"||c=="\\")y=vL;else{if(!r||r.scheme!="file"){y=Mc;continue}if(c==ga)_.host=r.host,_.path=Xa(r.path),_.query=r.query;else if(c=="?")_.host=r.host,_.path=Xa(r.path),_.query="",y=Nd;else{if(c!="#"){uL(Fm(Xa(i,T),""))||(_.host=r.host,_.path=Xa(r.path),_.shortenPath()),y=Mc;continue}_.host=r.host,_.path=Xa(r.path),_.query=r.query,_.fragment="",y=Cl}}break;case vL:if(c=="/"||c=="\\"){y=MC;break}r&&r.scheme=="file"&&!uL(Fm(Xa(i,T),""))&&($m(r.path[0],!0)?_f(_.path,r.path[0]):_.host=r.host),y=Mc;continue;case MC:if(c==ga||c=="/"||c=="\\"||c=="?"||c=="#"){if(!n&&$m(A))y=Mc;else if(A==""){if(_.host="",n)return;y=Ef}else{if(f=_.parseHost(A))return f;if(_.host=="localhost"&&(_.host=""),n)return;A="",y=Ef}continue}A+=c;break;case Ef:if(_.isSpecial()){if(y=Mc,c!="/"&&c!="\\")continue}else if(n||c!="?")if(n||c!="#"){if(c!=ga&&(y=Mc,c!="/"))continue}else _.fragment="",y=Cl;else _.query="",y=Nd;break;case Mc:if(c==ga||c=="/"||c=="\\"&&_.isSpecial()||!n&&(c=="?"||c=="#")){if((m=iE(m=A))===".."||m==="%2e."||m===".%2e"||m==="%2e%2e"?(_.shortenPath(),c=="/"||c=="\\"&&_.isSpecial()||_f(_.path,"")):Tne(A)?c=="/"||c=="\\"&&_.isSpecial()||_f(_.path,""):(_.scheme=="file"&&!_.path.length&&$m(A)&&(_.host&&(_.host=""),A=ya(A,0)+":"),_f(_.path,A)),A="",_.scheme=="file"&&(c==ga||c=="?"||c=="#"))for(;_.path.length>1&&_.path[0]==="";)dne(_.path);c=="?"?(_.query="",y=Nd):c=="#"&&(_.fragment="",y=Cl)}else A+=Su(c,lL);break;case gL:c=="?"?(_.query="",y=Nd):c=="#"?(_.fragment="",y=Cl):c!=ga&&(_.path[0]+=Su(c,aE));break;case Nd:n||c!="#"?c!=ga&&(c=="'"&&_.isSpecial()?_.query+="%27":_.query+=c=="#"?"%23":Su(c,aE)):(_.fragment="",y=Cl);break;case Cl:c!=ga&&(_.fragment+=Su(c,cL))}T++}},parseHost:function(e){var n,r,i;if(ya(e,0)=="["){if(ya(e,e.length-1)!="]"||(n=function(c){var u,f,m,_,y,T,A,k=[0,0,0,0,0,0,0,0],P=0,q=null,j=0,H=function(){return ya(c,j)};if(H()==":"){if(ya(c,1)!=":")return;j+=2,q=++P}for(;H();){if(P==8)return;if(H()!=":"){for(u=f=0;f<4&&Ja(aL,H());)u=16*u+sE(H(),16),j++,f++;if(H()=="."){if(f==0||(j-=f,P>6))return;for(m=0;H();){if(_=null,m>0){if(!(H()=="."&&m<4))return;j++}if(!Ja(RC,H()))return;for(;Ja(RC,H());){if(y=sE(H(),10),_===null)_=y;else{if(_==0)return;_=10*_+y}if(_>255)return;j++}k[P]=256*k[P]+_,++m!=2&&m!=4||P++}if(m!=4)return;break}if(H()==":"){if(j++,!H())return}else if(H())return;k[P++]=u}else{if(q!==null)return;j++,q=++P}}if(q!==null)for(T=P-q,P=7;P!=0&&T>0;)A=k[P],k[P--]=k[q+T-1],k[q+--T]=A;else if(P!=8)return;return k}(Bm(e,1,-1)),!n))return Od;this.host=n}else if(this.isSpecial()){if(e=nne(e),Ja(_ne,e)||(n=function(c){var u,f,m,_,y,T,A,k=hne(c,".");if(k.length&&k[k.length-1]==""&&k.length--,(u=k.length)>4)return c;for(f=[],m=0;m<u;m++){if((_=k[m])=="")return c;if(y=10,_.length>1&&ya(_,0)=="0"&&(y=Ja(mne,_)?16:8,_=Bm(_,y==8?1:2)),_==="")T=0;else{if(!Ja(y==10?gne:y==8?vne:aL,_))return c;T=sE(_,y)}_f(f,T)}for(m=0;m<u;m++)if(T=f[m],m==u-1){if(T>=oL(256,5-u))return null}else if(T>255)return null;for(A=une(f),m=0;m<f.length;m++)A+=f[m]*oL(256,3-m);return A}(e),n===null))return Od;this.host=n}else{if(Ja(Ene,e))return Od;for(n="",r=gf(e),i=0;i<r.length;i++)n+=Su(r[i],aE);this.host=n}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return bC(cE,this.scheme)},shortenPath:function(){var e=this.path,n=e.length;!n||this.scheme=="file"&&n==1&&$m(e[0],!0)||e.length--},serialize:function(){var e=this,n=e.scheme,r=e.username,i=e.password,c=e.host,u=e.port,f=e.path,m=e.query,_=e.fragment,y=n+":";return c!==null?(y+="//",e.includesCredentials()&&(y+=r+(i?":"+i:"")+"@"),y+=jm(c),u!==null&&(y+=":"+u)):n=="file"&&(y+="//"),y+=e.cannotBeABaseURL?f[0]:f.length?"/"+Fm(f,"/"):"",m!==null&&(y+="?"+m),_!==null&&(y+="#"+_),y},setHref:function(e){var n=this.parse(e);if(n)throw TC(n);this.searchParams.update()},getOrigin:function(){var e=this.scheme,n=this.port;if(e=="blob")try{return new yf(e.path[0]).origin}catch{return"null"}return e!="file"&&this.isSpecial()?e+"://"+jm(this.host)+(n!==null?":"+n:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Tl(e)+":",AC)},getUsername:function(){return this.username},setUsername:function(e){var n=gf(Tl(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<n.length;r++)this.username+=Su(n[r],IC)}},getPassword:function(){return this.password},setPassword:function(e){var n=gf(Tl(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<n.length;r++)this.password+=Su(n[r],IC)}},getHost:function(){var e=this.host,n=this.port;return e===null?"":n===null?jm(e):jm(e)+":"+n},setHost:function(e){this.cannotBeABaseURL||this.parse(e,kC)},getHostname:function(){var e=this.host;return e===null?"":jm(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,PC)},getPort:function(){var e=this.port;return e===null?"":Tl(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||((e=Tl(e))==""?this.port=null:this.parse(e,DC))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+Fm(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Ef))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){(e=Tl(e))==""?this.query=null:(ya(e,0)=="?"&&(e=Bm(e,1)),this.query="",this.parse(e,Nd)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){(e=Tl(e))!=""?(ya(e,0)=="#"&&(e=Bm(e,1)),this.fragment="",this.parse(e,Cl)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var yf=function(e){var n=ene(this,oi),r=one(arguments.length,1)>1?arguments[1]:void 0,i=sne(n,new xC(e,!1,r));EC||(n.href=i.serialize(),n.origin=i.getOrigin(),n.protocol=i.getProtocol(),n.username=i.getUsername(),n.password=i.getPassword(),n.host=i.getHost(),n.hostname=i.getHostname(),n.port=i.getPort(),n.pathname=i.getPathname(),n.search=i.getSearch(),n.searchParams=i.getSearchParams(),n.hash=i.getHash())},oi=yf.prototype,ba=function(e,n){return{get:function(){return oE(this)[e]()},set:n&&function(r){return oE(this)[n](r)},configurable:!0,enumerable:!0}};if(EC&&(Ea(oi,"href",ba("serialize","setHref")),Ea(oi,"origin",ba("getOrigin")),Ea(oi,"protocol",ba("getProtocol","setProtocol")),Ea(oi,"username",ba("getUsername","setUsername")),Ea(oi,"password",ba("getPassword","setPassword")),Ea(oi,"host",ba("getHost","setHost")),Ea(oi,"hostname",ba("getHostname","setHostname")),Ea(oi,"port",ba("getPort","setPort")),Ea(oi,"pathname",ba("getPathname","setPathname")),Ea(oi,"search",ba("getSearch","setSearch")),Ea(oi,"searchParams",ba("getSearchParams")),Ea(oi,"hash",ba("getHash","setHash"))),rE(oi,"toJSON",function(){return oE(this).serialize()},{enumerable:!0}),rE(oi,"toString",function(){return oE(this).serialize()},{enumerable:!0}),Vm){var _L=Vm.createObjectURL,EL=Vm.revokeObjectURL;_L&&rE(yf,"createObjectURL",tL(_L,Vm)),EL&&rE(yf,"revokeObjectURL",tL(EL,Vm))}rne(yf,"URL"),Zte({global:!0,forced:!Qte,sham:!EC},{URL:yf});var Cne=rr,wne=d,Rne=sf,yL=Wi,Ine=oC,bL=sn("URL");Cne({target:"URL",stat:!0,forced:!(Ine&&wne(function(){bL.canParse()}))},{canParse:function(e){var n=Rne(arguments.length,1),r=yL(e),i=n<2||arguments[1]===void 0?void 0:yL(arguments[1]);try{return!!new bL(r,i)}catch{return!1}}});var dE=l(Ot.URL);let SL=!0,TL=!0;function hE(e,n,r){const i=e.match(n);return i&&i.length>=r&&parseInt(i[r],10)}function kd(e,n,r){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,c=i.addEventListener;i.addEventListener=function(f,m){if(f!==n)return c.apply(this,arguments);const _=y=>{const T=r(y);T&&(m.handleEvent?m.handleEvent(T):m(T))};return this._eventMap=this._eventMap||{},this._eventMap[n]||(this._eventMap[n]=new Map),this._eventMap[n].set(m,_),c.apply(this,[f,_])};const u=i.removeEventListener;i.removeEventListener=function(f,m){if(f!==n||!this._eventMap||!this._eventMap[n])return u.apply(this,arguments);if(!this._eventMap[n].has(m))return u.apply(this,arguments);const _=this._eventMap[n].get(m);return this._eventMap[n].delete(m),this._eventMap[n].size===0&&delete this._eventMap[n],Object.keys(this._eventMap).length===0&&delete this._eventMap,u.apply(this,[f,_])},Object.defineProperty(i,"on"+n,{get(){return this["_on"+n]},set(f){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),f&&this.addEventListener(n,this["_on"+n]=f)},enumerable:!0,configurable:!0})}function Ane(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(SL=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function One(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(TL=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function CL(){if(typeof window=="object"){if(SL)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function UC(e,n){TL&&console.warn(e+" is deprecated, please use "+n+" instead.")}function wL(e){return Object.prototype.toString.call(e)==="[object Object]"}function RL(e){var n;return wL(e)?qa(n=Object.keys(e)).call(n,function(r,i){const c=wL(e[i]),u=c?RL(e[i]):e[i],f=c&&!Object.keys(u).length;return u===void 0||f?r:Object.assign(r,{[i]:u})},{}):e}function VC(e,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(i=>{i.endsWith("Id")?VC(e,e.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach(c=>{VC(e,e.get(c),r)})}))}function IL(e,n,r){const i=r?"outbound-rtp":"inbound-rtp",c=new Map;if(n===null)return c;const u=[];return e.forEach(f=>{f.type==="track"&&f.trackIdentifier===n.id&&u.push(f)}),u.forEach(f=>{e.forEach(m=>{m.type===i&&m.trackId===f.id&&VC(e,m,c)})}),c}const AL=CL;function OL(e,n){const r=e&&e.navigator;if(!r.mediaDevices)return;const i=function(f){if(typeof f!="object"||f.mandatory||f.optional)return f;const m={};return Object.keys(f).forEach(_=>{if(_==="require"||_==="advanced"||_==="mediaSource")return;const y=typeof f[_]=="object"?f[_]:{ideal:f[_]};y.exact!==void 0&&typeof y.exact=="number"&&(y.min=y.max=y.exact);const T=function(A,k){return A?A+k.charAt(0).toUpperCase()+k.slice(1):k==="deviceId"?"sourceId":k};if(y.ideal!==void 0){m.optional=m.optional||[];let A={};typeof y.ideal=="number"?(A[T("min",_)]=y.ideal,m.optional.push(A),A={},A[T("max",_)]=y.ideal,m.optional.push(A)):(A[T("",_)]=y.ideal,m.optional.push(A))}y.exact!==void 0&&typeof y.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[T("",_)]=y.exact):["min","max"].forEach(A=>{y[A]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[T(A,_)]=y[A])})}),f.advanced&&(m.optional=(m.optional||[]).concat(f.advanced)),m},c=function(f,m){if(n.version>=61)return m(f);if((f=JSON.parse(JSON.stringify(f)))&&typeof f.audio=="object"){const _=function(y,T,A){T in y&&!(A in y)&&(y[A]=y[T],delete y[T])};_((f=JSON.parse(JSON.stringify(f))).audio,"autoGainControl","googAutoGainControl"),_(f.audio,"noiseSuppression","googNoiseSuppression"),f.audio=i(f.audio)}if(f&&typeof f.video=="object"){let _=f.video.facingMode;_=_&&(typeof _=="object"?_:{ideal:_});const y=n.version<66;if(_&&(_.exact==="user"||_.exact==="environment"||_.ideal==="user"||_.ideal==="environment")&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||y)){let T;if(delete f.video.facingMode,_.exact==="environment"||_.ideal==="environment"?T=["back","rear"]:_.exact!=="user"&&_.ideal!=="user"||(T=["front"]),T)return r.mediaDevices.enumerateDevices().then(A=>{let k=(A=A.filter(P=>P.kind==="videoinput")).find(P=>T.some(q=>{var j;return gt(j=P.label.toLowerCase()).call(j,q)}));return!k&&A.length&&gt(T).call(T,"back")&&(k=A[A.length-1]),k&&(f.video.deviceId=_.exact?{exact:k.deviceId}:{ideal:k.deviceId}),f.video=i(f.video),AL("chrome: "+JSON.stringify(f)),m(f)})}f.video=i(f.video)}return AL("chrome: "+JSON.stringify(f)),m(f)},u=function(f){return n.version>=64?f:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[f.name]||f.name,message:f.message,constraint:f.constraint||f.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(r.getUserMedia=(function(f,m,_){c(f,y=>{r.webkitGetUserMedia(y,m,T=>{_&&_(u(T))})})}).bind(r),r.mediaDevices.getUserMedia){const f=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(m){return c(m,_=>f(_).then(y=>{if(_.audio&&!y.getAudioTracks().length||_.video&&!y.getVideoTracks().length)throw y.getTracks().forEach(T=>{T.stop()}),new DOMException("","NotFoundError");return y},y=>bt.reject(u(y))))}}}function NL(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function kL(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(r){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=r)},enumerable:!0,configurable:!0});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let c;c=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(f=>f.track&&f.track.id===i.track.id):{track:i.track};const u=new Event("track");u.track=i.track,u.receiver=c,u.transceiver={receiver:c},u.streams=[r.stream],this.dispatchEvent(u)}),r.stream.getTracks().forEach(i=>{let c;c=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(f=>f.track&&f.track.id===i.id):{track:i};const u=new Event("track");u.track=i,u.receiver=c,u.transceiver={receiver:c},u.streams=[r.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),n.apply(this,arguments)}}else kd(e,"track",n=>(n.transceiver||Object.defineProperty(n,"transceiver",{value:{receiver:n.receiver}}),n))}function PL(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const n=function(c,u){return{track:u,get dtmf(){return this._dtmf===void 0&&(u.kind==="audio"?this._dtmf=c.createDTMFSender(u):this._dtmf=null),this._dtmf},_pc:c}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(f,m){let _=c.apply(this,arguments);return _||(_=n(this,f),this._senders.push(_)),_};const u=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(f){u.apply(this,arguments);const m=this._senders.indexOf(f);m!==-1&&this._senders.splice(m,1)}}const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],r.apply(this,[c]),c.getTracks().forEach(u=>{this._senders.push(n(this,u))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],i.apply(this,[c]),c.getTracks().forEach(u=>{const f=this._senders.find(m=>m.track===u);f&&this._senders.splice(this._senders.indexOf(f),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const n=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const r=n.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function DL(e){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[r,i,c]=arguments;if(arguments.length>0&&typeof r=="function")return n.apply(this,arguments);if(n.length===0&&(arguments.length===0||typeof r!="function"))return n.apply(this,[]);const u=function(m){const _={};return m.result().forEach(y=>{const T={id:y.id,timestamp:y.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[y.type]||y.type};y.names().forEach(A=>{T[A]=y.stat(A)}),_[T.id]=T}),_},f=function(m){return new Map(Object.keys(m).map(_=>[_,m[_]]))};if(arguments.length>=2){const m=function(_){i(f(u(_)))};return n.apply(this,[m,r])}return new bt((m,_)=>{n.apply(this,[function(y){m(f(u(y)))},_])}).then(i,c)}}function LL(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const c=r.apply(this,[]);return c.forEach(u=>u._pc=this),c});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const c=i.apply(this,arguments);return c._pc=this,c}),e.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(u=>IL(u,c.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const i=r.apply(this,[]);return i.forEach(c=>c._pc=this),i}),kd(e,"track",i=>(i.receiver._pc=i.srcElement,i)),e.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(c=>IL(c,i.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const r=arguments[0];let i,c,u;return this.getSenders().forEach(f=>{f.track===r&&(i?u=!0:i=f)}),this.getReceivers().forEach(f=>(f.track===r&&(c?u=!0:c=f),f.track===r)),u||i&&c?bt.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():c?c.getStats():bt.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}function ML(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(u,f){if(!f)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const m=n.apply(this,arguments);return this._shimmedLocalStreams[f.id]?this._shimmedLocalStreams[f.id].indexOf(m)===-1&&this._shimmedLocalStreams[f.id].push(m):this._shimmedLocalStreams[f.id]=[f,m],m};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(_=>{if(this.getSenders().find(T=>T.track===_))throw new DOMException("Track already exists.","InvalidAccessError")});const f=this.getSenders();r.apply(this,arguments);const m=this.getSenders().filter(_=>f.indexOf(_)===-1);this._shimmedLocalStreams[u.id]=[u].concat(m)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],i.apply(this,arguments)};const c=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(f=>{const m=this._shimmedLocalStreams[f].indexOf(u);m!==-1&&this._shimmedLocalStreams[f].splice(m,1),this._shimmedLocalStreams[f].length===1&&delete this._shimmedLocalStreams[f]}),c.apply(this,arguments)}}function xL(e,n){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&n.version>=65)return ML(e);const r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const _=r.apply(this);return this._reverseStreams=this._reverseStreams||{},_.map(y=>this._reverseStreams[y.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(_){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_.getTracks().forEach(y=>{if(this.getSenders().find(A=>A.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_.id]){const y=new e.MediaStream(_.getTracks());this._streams[_.id]=y,this._reverseStreams[y.id]=_,_=y}i.apply(this,[_])};const c=e.RTCPeerConnection.prototype.removeStream;function u(_,y){let T=y.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const k=_._reverseStreams[A],P=_._streams[k.id];T=T.replace(new RegExp(P.id,"g"),k.id)}),new RTCSessionDescription({type:y.type,sdp:T})}e.RTCPeerConnection.prototype.removeStream=function(_){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[_.id]||_]),delete this._reverseStreams[this._streams[_.id]?this._streams[_.id].id:_.id],delete this._streams[_.id]},e.RTCPeerConnection.prototype.addTrack=function(_,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const T=[].slice.call(arguments,1);if(T.length!==1||!T[0].getTracks().find(P=>P===_))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(P=>P.track===_))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[y.id];if(k)k.addTrack(_),bt.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const P=new e.MediaStream([_]);this._streams[y.id]=P,this._reverseStreams[P.id]=y,this.addStream(P)}return this.getSenders().find(P=>P.track===_)},["createOffer","createAnswer"].forEach(function(_){const y=e.RTCPeerConnection.prototype[_],T={[_](){const A=arguments;return arguments.length&&typeof arguments[0]=="function"?y.apply(this,[k=>{const P=u(this,k);A[0].apply(null,[P])},k=>{A[1]&&A[1].apply(null,k)},arguments[2]]):y.apply(this,arguments).then(k=>u(this,k))}};e.RTCPeerConnection.prototype[_]=T[_]});const f=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(_,y){let T=y.sdp;return Object.keys(_._reverseStreams||[]).forEach(A=>{const k=_._reverseStreams[A],P=_._streams[k.id];T=T.replace(new RegExp(k.id,"g"),P.id)}),new RTCSessionDescription({type:y.type,sdp:T})}(this,arguments[0]),f.apply(this,arguments)):f.apply(this,arguments)};const m=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const _=m.get.apply(this);return _.type===""?_:u(this,_)}}),e.RTCPeerConnection.prototype.removeTrack=function(_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let y;this._streams=this._streams||{},Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(A=>_.track===A)&&(y=this._streams[T])}),y&&(y.getTracks().length===1?this.removeStream(this._reverseStreams[y.id]):y.removeTrack(_.track),this.dispatchEvent(new Event("negotiationneeded")))}}function FC(e,n){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const i=e.RTCPeerConnection.prototype[r],c={[r](){return arguments[0]=new(r==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[r]=c[r]})}function UL(e,n){kd(e,"negotiationneeded",r=>{const i=r.target;if(!(n.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")||i.signalingState==="stable")return r})}var VL=Object.freeze({__proto__:null,fixNegotiationNeeded:UL,shimAddTrackRemoveTrack:xL,shimAddTrackRemoveTrackWithNative:ML,shimGetDisplayMedia:function(e,n){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(typeof n=="function"?e.navigator.mediaDevices.getDisplayMedia=function(r){return n(r).then(i=>{const c=r.video&&r.video.width,u=r.video&&r.video.height,f=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:f||3}},c&&(r.video.mandatory.maxWidth=c),u&&(r.video.mandatory.maxHeight=u),e.navigator.mediaDevices.getUserMedia(r)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:PL,shimGetStats:DL,shimGetUserMedia:OL,shimMediaStream:NL,shimOnTrack:kL,shimPeerConnection:FC,shimSenderReceiverGetStats:LL});function FL(e,n){const r=e&&e.navigator,i=e&&e.MediaStreamTrack;if(r.getUserMedia=function(c,u,f){UC("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(c).then(u,f)},!(n.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){const c=function(f,m,_){m in f&&!(_ in f)&&(f[_]=f[m],delete f[m])},u=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(f){return typeof f=="object"&&typeof f.audio=="object"&&(f=JSON.parse(JSON.stringify(f)),c(f.audio,"autoGainControl","mozAutoGainControl"),c(f.audio,"noiseSuppression","mozNoiseSuppression")),u(f)},i&&i.prototype.getSettings){const f=i.prototype.getSettings;i.prototype.getSettings=function(){const m=f.apply(this,arguments);return c(m,"mozAutoGainControl","autoGainControl"),c(m,"mozNoiseSuppression","noiseSuppression"),m}}if(i&&i.prototype.applyConstraints){const f=i.prototype.applyConstraints;i.prototype.applyConstraints=function(m){return this.kind==="audio"&&typeof m=="object"&&(m=JSON.parse(JSON.stringify(m)),c(m,"autoGainControl","mozAutoGainControl"),c(m,"noiseSuppression","mozNoiseSuppression")),f.apply(this,[m])}}}}function BL(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function BC(e,n){if(typeof e!="object"||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),n.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const u=e.RTCPeerConnection.prototype[c],f={[c](){return arguments[0]=new(c==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),u.apply(this,arguments)}};e.RTCPeerConnection.prototype[c]=f[c]});const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[c,u,f]=arguments;return i.apply(this,[c||null]).then(m=>{if(n.version<53&&!u)try{m.forEach(_=>{_.type=r[_.type]||_.type})}catch(_){if(_.name!=="TypeError")throw _;m.forEach((y,T)=>{m.set(T,Object.assign({},y,{type:r[y.type]||y.type}))})}return m}).then(u,f)}}function jL(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const n=e.RTCPeerConnection.prototype.getSenders;n&&(e.RTCPeerConnection.prototype.getSenders=function(){const i=n.apply(this,[]);return i.forEach(c=>c._pc=this),i});const r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){const i=r.apply(this,arguments);return i._pc=this,i}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):bt.resolve(new Map)}}function $L(e){if(typeof e!="object"||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(i=>i._pc=this),r}),kd(e,"track",r=>(r.receiver._pc=r.srcElement,r)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function HL(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(n){UC("removeStream","removeTrack"),this.getSenders().forEach(r=>{var i;r.track&&gt(i=n.getTracks()).call(i,r.track)&&this.removeTrack(r)})})}function WL(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function KL(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype.addTransceiver;n&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=n.apply(this,arguments);if(i){const{sender:u}=c,f=u.getParameters();(!("encodings"in f)||f.encodings.length===1&&Object.keys(f.encodings[0]).length===0)&&(f.encodings=r,u.sendEncodings=r,this.setParametersPromises.push(u.setParameters(f).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return c})}function GL(e){if(typeof e!="object"||!e.RTCRtpSender)return;const n=e.RTCRtpSender.prototype.getParameters;n&&(e.RTCRtpSender.prototype.getParameters=function(){const r=n.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function zL(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?bt.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}function YL(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?bt.all(this.setParametersPromises).then(()=>n.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):n.apply(this,arguments)}}var qL=Object.freeze({__proto__:null,shimAddTransceiver:KL,shimCreateAnswer:YL,shimCreateOffer:zL,shimGetDisplayMedia:function(e,n){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,bt.reject(i)}return r.video===!0?r.video={mediaSource:n}:r.video.mediaSource=n,e.navigator.mediaDevices.getUserMedia(r)})},shimGetParameters:GL,shimGetUserMedia:FL,shimOnTrack:BL,shimPeerConnection:BC,shimRTCDataChannel:WL,shimReceiverGetStats:$L,shimRemoveStream:HL,shimSenderGetStats:jL});function XL(e){if(typeof e=="object"&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(r){var i;this._localStreams||(this._localStreams=[]),gt(i=this._localStreams).call(i,r)||this._localStreams.push(r),r.getAudioTracks().forEach(c=>n.call(this,c,r)),r.getVideoTracks().forEach(c=>n.call(this,c,r))},e.RTCPeerConnection.prototype.addTrack=function(r){for(var i=arguments.length,c=new Array(i>1?i-1:0),u=1;u<i;u++)c[u-1]=arguments[u];return c&&c.forEach(f=>{var m;this._localStreams?gt(m=this._localStreams).call(m,f)||this._localStreams.push(f):this._localStreams=[f]}),n.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const i=n.getTracks();this.getSenders().forEach(c=>{gt(i).call(i,c.track)&&this.removeTrack(c)})})}}function JL(e){if(typeof e=="object"&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(r){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=r),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(c=>{var u;if(this._remoteStreams||(this._remoteStreams=[]),gt(u=this._remoteStreams).call(u,c))return;this._remoteStreams.push(c);const f=new Event("addstream");f.stream=c,this.dispatchEvent(f)})})}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(c=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(c)>=0)return;r._remoteStreams.push(c);const u=new Event("addstream");u.stream=c,r.dispatchEvent(u)})}),n.apply(r,arguments)}}}function ZL(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,r=n.createOffer,i=n.createAnswer,c=n.setLocalDescription,u=n.setRemoteDescription,f=n.addIceCandidate;n.createOffer=function(_,y){const T=arguments.length>=2?arguments[2]:arguments[0],A=r.apply(this,[T]);return y?(A.then(_,y),bt.resolve()):A},n.createAnswer=function(_,y){const T=arguments.length>=2?arguments[2]:arguments[0],A=i.apply(this,[T]);return y?(A.then(_,y),bt.resolve()):A};let m=function(_,y,T){const A=c.apply(this,[_]);return T?(A.then(y,T),bt.resolve()):A};n.setLocalDescription=m,m=function(_,y,T){const A=u.apply(this,[_]);return T?(A.then(y,T),bt.resolve()):A},n.setRemoteDescription=m,m=function(_,y,T){const A=f.apply(this,[_]);return T?(A.then(y,T),bt.resolve()):A},n.addIceCandidate=m}function QL(e){const n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){const r=n.mediaDevices,i=r.getUserMedia.bind(r);n.mediaDevices.getUserMedia=c=>i(eM(c))}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=(function(r,i,c){n.mediaDevices.getUserMedia(r).then(i,c)}).bind(n))}function eM(e){return e&&e.video!==void 0?Object.assign({},e,{video:RL(e.video)}):e}function tM(e){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection;e.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const c=[];for(let u=0;u<r.iceServers.length;u++){let f=r.iceServers[u];!f.hasOwnProperty("urls")&&f.hasOwnProperty("url")?(UC("RTCIceServer.url","RTCIceServer.urls"),f=JSON.parse(JSON.stringify(f)),f.urls=f.url,delete f.url,c.push(f)):c.push(r.iceServers[u])}r.iceServers=c}return new n(r,i)},e.RTCPeerConnection.prototype=n.prototype,"generateCertificate"in n&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>n.generateCertificate})}function nM(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function rM(e){const n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(r){if(r){r.offerToReceiveAudio!==void 0&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio!==!0||i||this.addTransceiver("audio",{direction:"recvonly"}),r.offerToReceiveVideo!==void 0&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const c=this.getTransceivers().find(u=>u.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):r.offerToReceiveVideo!==!0||c||this.addTransceiver("video",{direction:"recvonly"})}return n.apply(this,arguments)}}function oM(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var sM=Object.freeze({__proto__:null,shimAudioContext:oM,shimCallbacksAPI:ZL,shimConstraints:eM,shimCreateOfferLegacy:rM,shimGetUserMedia:QL,shimLocalStreamsAPI:XL,shimRTCIceServerUrls:tM,shimRemoteStreamsAPI:JL,shimTrackEventTransceiver:nM}),iM=`	
\v\f\r \u2028\u2029\uFEFF`,Nne=tt,kne=Wi,jC=iM,aM=S("".replace),Pne=RegExp("^["+jC+"]+"),Dne=RegExp("(^|[^"+jC+"])["+jC+"]+$"),Lne=function(e){return function(n){var r=kne(Nne(n));return 1&e&&(r=aM(r,Pne,"")),2&e&&(r=aM(r,Dne,"$1")),r}},Mne={trim:Lne(3)},xne=i1.PROPER,Une=d,cM=iM,Vne=Mne.trim;rr({target:"String",proto:!0,forced:function(e){return Une(function(){return!!cM[e]()||""[e]()!==""||xne&&cM[e].name!==e})}("trim")},{trim:function(){return Vne(this)}});var Fne=ma("String").trim,Bne=C,jne=Fne,$C=String.prototype,$ne=function(e){var n=e.trim;return typeof e=="string"||e===$C||Bne($C,e)&&n===$C.trim?jne:n},es=l($ne),lM={exports:{}};(function(e){const n={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};n.localCName=n.generateIdentifier(),n.splitLines=function(r){return r.trim().split(`
`).map(i=>i.trim())},n.splitSections=function(r){return r.split(`
m=`).map((i,c)=>(c>0?"m="+i:i).trim()+`\r
`)},n.getDescription=function(r){const i=n.splitSections(r);return i&&i[0]},n.getMediaSections=function(r){const i=n.splitSections(r);return i.shift(),i},n.matchPrefix=function(r,i){return n.splitLines(r).filter(c=>c.indexOf(i)===0)},n.parseCandidate=function(r){let i;i=r.indexOf("a=candidate:")===0?r.substring(12).split(" "):r.substring(10).split(" ");const c={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let u=8;u<i.length;u+=2)switch(i[u]){case"raddr":c.relatedAddress=i[u+1];break;case"rport":c.relatedPort=parseInt(i[u+1],10);break;case"tcptype":c.tcpType=i[u+1];break;case"ufrag":c.ufrag=i[u+1],c.usernameFragment=i[u+1];break;default:c[i[u]]===void 0&&(c[i[u]]=i[u+1])}return c},n.writeCandidate=function(r){const i=[];i.push(r.foundation);const c=r.component;c==="rtp"?i.push(1):c==="rtcp"?i.push(2):i.push(c),i.push(r.protocol.toUpperCase()),i.push(r.priority),i.push(r.address||r.ip),i.push(r.port);const u=r.type;return i.push("typ"),i.push(u),u!=="host"&&r.relatedAddress&&r.relatedPort&&(i.push("raddr"),i.push(r.relatedAddress),i.push("rport"),i.push(r.relatedPort)),r.tcpType&&r.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(i.push("ufrag"),i.push(r.usernameFragment||r.ufrag)),"candidate:"+i.join(" ")},n.parseIceOptions=function(r){return r.substring(14).split(" ")},n.parseRtpMap=function(r){let i=r.substring(9).split(" ");const c={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),c.name=i[0],c.clockRate=parseInt(i[1],10),c.channels=i.length===3?parseInt(i[2],10):1,c.numChannels=c.channels,c},n.writeRtpMap=function(r){let i=r.payloadType;r.preferredPayloadType!==void 0&&(i=r.preferredPayloadType);const c=r.channels||r.numChannels||1;return"a=rtpmap:"+i+" "+r.name+"/"+r.clockRate+(c!==1?"/"+c:"")+`\r
`},n.parseExtmap=function(r){const i=r.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},n.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&r.direction!=="sendrecv"?"/"+r.direction:"")+" "+r.uri+(r.attributes?" "+r.attributes:"")+`\r
`},n.parseFmtp=function(r){const i={};let c;const u=r.substring(r.indexOf(" ")+1).split(";");for(let f=0;f<u.length;f++)c=u[f].trim().split("="),i[c[0].trim()]=c[1];return i},n.writeFmtp=function(r){let i="",c=r.payloadType;if(r.preferredPayloadType!==void 0&&(c=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){const u=[];Object.keys(r.parameters).forEach(f=>{r.parameters[f]!==void 0?u.push(f+"="+r.parameters[f]):u.push(f)}),i+="a=fmtp:"+c+" "+u.join(";")+`\r
`}return i},n.parseRtcpFb=function(r){const i=r.substring(r.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},n.writeRtcpFb=function(r){let i="",c=r.payloadType;return r.preferredPayloadType!==void 0&&(c=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(u=>{i+="a=rtcp-fb:"+c+" "+u.type+(u.parameter&&u.parameter.length?" "+u.parameter:"")+`\r
`}),i},n.parseSsrcMedia=function(r){const i=r.indexOf(" "),c={ssrc:parseInt(r.substring(7,i),10)},u=r.indexOf(":",i);return u>-1?(c.attribute=r.substring(i+1,u),c.value=r.substring(u+1)):c.attribute=r.substring(i+1),c},n.parseSsrcGroup=function(r){const i=r.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(c=>parseInt(c,10))}},n.getMid=function(r){const i=n.matchPrefix(r,"a=mid:")[0];if(i)return i.substring(6)},n.parseFingerprint=function(r){const i=r.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},n.getDtlsParameters=function(r,i){return{role:"auto",fingerprints:n.matchPrefix(r+i,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(r,i){let c="a=setup:"+i+`\r
`;return r.fingerprints.forEach(u=>{c+="a=fingerprint:"+u.algorithm+" "+u.value+`\r
`}),c},n.parseCryptoLine=function(r){const i=r.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},n.writeCryptoLine=function(r){return"a=crypto:"+r.tag+" "+r.cryptoSuite+" "+(typeof r.keyParams=="object"?n.writeCryptoKeyParams(r.keyParams):r.keyParams)+(r.sessionParams?" "+r.sessionParams.join(" "):"")+`\r
`},n.parseCryptoKeyParams=function(r){if(r.indexOf("inline:")!==0)return null;const i=r.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},n.writeCryptoKeyParams=function(r){return r.keyMethod+":"+r.keySalt+(r.lifeTime?"|"+r.lifeTime:"")+(r.mkiValue&&r.mkiLength?"|"+r.mkiValue+":"+r.mkiLength:"")},n.getCryptoParameters=function(r,i){return n.matchPrefix(r+i,"a=crypto:").map(n.parseCryptoLine)},n.getIceParameters=function(r,i){const c=n.matchPrefix(r+i,"a=ice-ufrag:")[0],u=n.matchPrefix(r+i,"a=ice-pwd:")[0];return c&&u?{usernameFragment:c.substring(12),password:u.substring(10)}:null},n.writeIceParameters=function(r){let i="a=ice-ufrag:"+r.usernameFragment+`\r
a=ice-pwd:`+r.password+`\r
`;return r.iceLite&&(i+=`a=ice-lite\r
`),i},n.parseRtpParameters=function(r){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=n.splitLines(r)[0].split(" ");i.profile=c[2];for(let f=3;f<c.length;f++){const m=c[f],_=n.matchPrefix(r,"a=rtpmap:"+m+" ")[0];if(_){const y=n.parseRtpMap(_),T=n.matchPrefix(r,"a=fmtp:"+m+" ");switch(y.parameters=T.length?n.parseFmtp(T[0]):{},y.rtcpFeedback=n.matchPrefix(r,"a=rtcp-fb:"+m+" ").map(n.parseRtcpFb),i.codecs.push(y),y.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(y.name.toUpperCase())}}}n.matchPrefix(r,"a=extmap:").forEach(f=>{i.headerExtensions.push(n.parseExtmap(f))});const u=n.matchPrefix(r,"a=rtcp-fb:* ").map(n.parseRtcpFb);return i.codecs.forEach(f=>{u.forEach(m=>{f.rtcpFeedback.find(_=>_.type===m.type&&_.parameter===m.parameter)||f.rtcpFeedback.push(m)})}),i},n.writeRtpDescription=function(r,i){let c="";c+="m="+r+" ",c+=i.codecs.length>0?"9":"0",c+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",c+=i.codecs.map(f=>f.preferredPayloadType!==void 0?f.preferredPayloadType:f.payloadType).join(" ")+`\r
`,c+=`c=IN IP4 0.0.0.0\r
`,c+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(f=>{c+=n.writeRtpMap(f),c+=n.writeFmtp(f),c+=n.writeRtcpFb(f)});let u=0;return i.codecs.forEach(f=>{f.maxptime>u&&(u=f.maxptime)}),u>0&&(c+="a=maxptime:"+u+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(f=>{c+=n.writeExtmap(f)}),c},n.parseRtpEncodingParameters=function(r){const i=[],c=n.parseRtpParameters(r),u=c.fecMechanisms.indexOf("RED")!==-1,f=c.fecMechanisms.indexOf("ULPFEC")!==-1,m=n.matchPrefix(r,"a=ssrc:").map(k=>n.parseSsrcMedia(k)).filter(k=>k.attribute==="cname"),_=m.length>0&&m[0].ssrc;let y;const T=n.matchPrefix(r,"a=ssrc-group:FID").map(k=>k.substring(17).split(" ").map(P=>parseInt(P,10)));T.length>0&&T[0].length>1&&T[0][0]===_&&(y=T[0][1]),c.codecs.forEach(k=>{if(k.name.toUpperCase()==="RTX"&&k.parameters.apt){let P={ssrc:_,codecPayloadType:parseInt(k.parameters.apt,10)};_&&y&&(P.rtx={ssrc:y}),i.push(P),u&&(P=JSON.parse(JSON.stringify(P)),P.fec={ssrc:_,mechanism:f?"red+ulpfec":"red"},i.push(P))}}),i.length===0&&_&&i.push({ssrc:_});let A=n.matchPrefix(r,"b=");return A.length&&(A=A[0].indexOf("b=TIAS:")===0?parseInt(A[0].substring(7),10):A[0].indexOf("b=AS:")===0?1e3*parseInt(A[0].substring(5),10)*.95-16e3:void 0,i.forEach(k=>{k.maxBitrate=A})),i},n.parseRtcpParameters=function(r){const i={},c=n.matchPrefix(r,"a=ssrc:").map(m=>n.parseSsrcMedia(m)).filter(m=>m.attribute==="cname")[0];c&&(i.cname=c.value,i.ssrc=c.ssrc);const u=n.matchPrefix(r,"a=rtcp-rsize");i.reducedSize=u.length>0,i.compound=u.length===0;const f=n.matchPrefix(r,"a=rtcp-mux");return i.mux=f.length>0,i},n.writeRtcpParameters=function(r){let i="";return r.reducedSize&&(i+=`a=rtcp-rsize\r
`),r.mux&&(i+=`a=rtcp-mux\r
`),r.ssrc!==void 0&&r.cname&&(i+="a=ssrc:"+r.ssrc+" cname:"+r.cname+`\r
`),i},n.parseMsid=function(r){let i;const c=n.matchPrefix(r,"a=msid:");if(c.length===1)return i=c[0].substring(7).split(" "),{stream:i[0],track:i[1]};const u=n.matchPrefix(r,"a=ssrc:").map(f=>n.parseSsrcMedia(f)).filter(f=>f.attribute==="msid");return u.length>0?(i=u[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},n.parseSctpDescription=function(r){const i=n.parseMLine(r),c=n.matchPrefix(r,"a=max-message-size:");let u;c.length>0&&(u=parseInt(c[0].substring(19),10)),isNaN(u)&&(u=65536);const f=n.matchPrefix(r,"a=sctp-port:");if(f.length>0)return{port:parseInt(f[0].substring(12),10),protocol:i.fmt,maxMessageSize:u};const m=n.matchPrefix(r,"a=sctpmap:");if(m.length>0){const _=m[0].substring(10).split(" ");return{port:parseInt(_[0],10),protocol:_[1],maxMessageSize:u}}},n.writeSctpDescription=function(r,i){let c=[];return c=r.protocol!=="DTLS/SCTP"?["m="+r.kind+" 9 "+r.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:["m="+r.kind+" 9 "+r.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&c.push("a=max-message-size:"+i.maxMessageSize+`\r
`),c.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,22)},n.writeSessionBoilerplate=function(r,i,c){let u;const f=i!==void 0?i:2;return u=r||n.generateSessionId(),`v=0\r
o=`+(c||"thisisadapterortc")+" "+u+" "+f+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},n.getDirection=function(r,i){const c=n.splitLines(r);for(let u=0;u<c.length;u++)switch(c[u]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[u].substring(2)}return i?n.getDirection(i):"sendrecv"},n.getKind=function(r){return n.splitLines(r)[0].split(" ")[0].substring(2)},n.isRejected=function(r){return r.split(" ",2)[1]==="0"},n.parseMLine=function(r){const i=n.splitLines(r)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},n.parseOLine=function(r){const i=n.matchPrefix(r,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},n.isValidSDP=function(r){if(typeof r!="string"||r.length===0)return!1;const i=n.splitLines(r);for(let c=0;c<i.length;c++)if(i[c].length<2||i[c].charAt(1)!=="=")return!1;return!0},e.exports=n})(lM);var uM=lM.exports,bf=l(uM),Hne=s({__proto__:null,default:bf},[uM]);function fE(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const n=e.RTCIceCandidate;e.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&((r=JSON.parse(JSON.stringify(r))).candidate=r.candidate.substr(2)),r.candidate&&r.candidate.length){const i=new n(r),c=bf.parseCandidate(r.candidate),u=Object.assign(i,c);return u.toJSON=function(){return{candidate:u.candidate,sdpMid:u.sdpMid,sdpMLineIndex:u.sdpMLineIndex,usernameFragment:u.usernameFragment}},u}return new n(r)},e.RTCIceCandidate.prototype=n.prototype,kd(e,"icecandidate",r=>(r.candidate&&Object.defineProperty(r,"candidate",{value:new e.RTCIceCandidate(r.candidate),writable:"false"}),r))}function HC(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||kd(e,"icecandidate",n=>{if(n.candidate){const r=bf.parseCandidate(n.candidate.candidate);r.type==="relay"&&(n.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[r.priority>>24])}return n})}function pE(e,n){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const r=function(m){if(!m||!m.sdp)return!1;const _=bf.splitSections(m.sdp);return _.shift(),_.some(y=>{const T=bf.parseMLine(y);return T&&T.kind==="application"&&T.protocol.indexOf("SCTP")!==-1})},i=function(m){const _=m.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_===null||_.length<2)return-1;const y=parseInt(_[1],10);return y!=y?-1:y},c=function(m){let _=65536;return n.browser==="firefox"&&(_=n.version<57?m===-1?16384:2147483637:n.version<60?n.version===57?65535:65536:2147483637),_},u=function(m,_){let y=65536;n.browser==="firefox"&&n.version===57&&(y=65535);const T=bf.matchPrefix(m.sdp,"a=max-message-size:");return T.length>0?y=parseInt(T[0].substr(19),10):n.browser==="firefox"&&_!==-1&&(y=2147483637),y},f=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,n.browser==="chrome"&&n.version>=76){const{sdpSemantics:m}=this.getConfiguration();m==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){const m=i(arguments[0]),_=c(m),y=u(arguments[0],m);let T;T=_===0&&y===0?Number.POSITIVE_INFINITY:_===0||y===0?Math.max(_,y):Math.min(_,y);const A={};Object.defineProperty(A,"maxMessageSize",{get:()=>T}),this._sctp=A}return f.apply(this,arguments)}}function mE(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function n(i,c){const u=i.send;i.send=function(){const f=arguments[0],m=f.length||f.size||f.byteLength;if(i.readyState==="open"&&c.sctp&&m>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return u.apply(i,arguments)}}const r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const i=r.apply(this,arguments);return n(i,this),i},kd(e,"datachannel",i=>(n(i.channel,i.target),i))}function WC(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype;Object.defineProperty(n,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(r){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),r&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=r)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(r=>{const i=n[r];n[r]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const u=c.target;if(u._lastConnectionState!==u.connectionState){u._lastConnectionState=u.connectionState;const f=new Event("connectionstatechange",c);u.dispatchEvent(f)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function KC(e,n){if(!e.RTCPeerConnection||n.browser==="chrome"&&n.version>=71||n.browser==="safari"&&n.version>=605)return;const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const c=i.sdp.split(`
`).filter(u=>es(u).call(u)!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&i instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:i.type,sdp:c}):i.sdp=c}return r.apply(this,arguments)}}function vE(e,n){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.addIceCandidate;r&&r.length!==0&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(n.browser==="chrome"&&n.version<78||n.browser==="firefox"&&n.version<68||n.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?bt.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),bt.resolve())})}function gE(e,n){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype.setLocalDescription;r&&r.length!==0&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return r.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer"}return i.sdp||i.type!=="offer"&&i.type!=="answer"?r.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(c=>r.apply(this,[c]))})}var Wne=Object.freeze({__proto__:null,removeExtmapAllowMixed:KC,shimAddIceCandidateNullOrEmpty:vE,shimConnectionState:WC,shimMaxMessageSize:pE,shimParameterlessSetLocalDescription:gE,shimRTCIceCandidate:fE,shimRTCIceCandidateRelayProtocol:HC,shimSendThrowTypeError:mE});(function(){let{window:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const r=CL,i=function(u){const f={browser:null,version:null};if(u===void 0||!u.navigator)return f.browser="Not a browser.",f;const{navigator:m}=u;if(m.mozGetUserMedia)f.browser="firefox",f.version=hE(m.userAgent,/Firefox\/(\d+)\./,1);else if(m.webkitGetUserMedia||u.isSecureContext===!1&&u.webkitRTCPeerConnection)f.browser="chrome",f.version=hE(m.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!u.RTCPeerConnection||!m.userAgent.match(/AppleWebKit\/(\d+)\./))return f.browser="Not a supported browser.",f;f.browser="safari",f.version=hE(m.userAgent,/AppleWebKit\/(\d+)\./,1),f.supportsUnifiedPlan=u.RTCRtpTransceiver&&"currentDirection"in u.RTCRtpTransceiver.prototype}return f}(e),c={browserDetails:i,commonShim:Wne,extractVersion:hE,disableLog:Ane,disableWarnings:One,sdp:Hne};switch(i.browser){case"chrome":if(!VL||!FC||!n.shimChrome)return r("Chrome shim is not included in this adapter release."),c;if(i.version===null)return r("Chrome shim can not determine version, not shimming."),c;r("adapter.js shimming chrome."),c.browserShim=VL,vE(e,i),gE(e),OL(e,i),NL(e),FC(e,i),kL(e),xL(e,i),PL(e),DL(e),LL(e),UL(e,i),fE(e),HC(e),WC(e),pE(e,i),mE(e),KC(e,i);break;case"firefox":if(!qL||!BC||!n.shimFirefox)return r("Firefox shim is not included in this adapter release."),c;r("adapter.js shimming firefox."),c.browserShim=qL,vE(e,i),gE(e),FL(e,i),BC(e,i),BL(e),HL(e),jL(e),$L(e),WL(e),KL(e),GL(e),zL(e),YL(e),fE(e),WC(e),pE(e,i),mE(e);break;case"safari":if(!sM||!n.shimSafari)return r("Safari shim is not included in this adapter release."),c;r("adapter.js shimming safari."),c.browserShim=sM,vE(e,i),gE(e),tM(e),rM(e),ZL(e),XL(e),JL(e),nM(e),QL(e),oM(e),fE(e),HC(e),pE(e,i),mE(e),KC(e,i);break;default:r("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var dM=Ga,Kne=TypeError,hM=tn.match(/firefox\/(\d+)/i),Gne=!!hM&&+hM[1],zne=/MSIE|Trident/.test(tn),fM=tn.match(/AppleWebKit\/(\d+)\./),Yne=!!fM&&+fM[1],qne=rr,pM=S,Xne=Rs,Jne=zt,mM=Sl,Zne=function(e,n){if(!delete e[n])throw Kne("Cannot delete property "+dM(n)+" of "+dM(e))},vM=Wi,GC=d,Qne=RD,ere=A_,gM=Gne,tre=zne,_M=Ke,EM=Yne,Tu=[],yM=pM(Tu.sort),nre=pM(Tu.push),rre=GC(function(){Tu.sort(void 0)}),ore=GC(function(){Tu.sort(null)}),sre=ere("sort"),bM=!GC(function(){if(_M)return _M<70;if(!(gM&&gM>3)){if(tre)return!0;if(EM)return EM<603;var e,n,r,i,c="";for(e=65;e<76;e++){switch(n=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(i=0;i<47;i++)Tu.push({k:n+i,v:r})}for(Tu.sort(function(u,f){return f.v-u.v}),i=0;i<Tu.length;i++)n=Tu[i].k.charAt(0),c.charAt(c.length-1)!==n&&(c+=n);return c!=="DGBEFHACIJK"}});qne({target:"Array",proto:!0,forced:rre||!ore||!sre||!bM},{sort:function(e){e!==void 0&&Xne(e);var n=Jne(this);if(bM)return e===void 0?yM(n):yM(n,e);var r,i,c=[],u=mM(n);for(i=0;i<u;i++)i in n&&nre(c,n[i]);for(Qne(c,function(f){return function(m,_){return _===void 0?-1:m===void 0?1:f!==void 0?+f(m,_)||0:vM(m)>vM(_)?1:-1}}(e)),r=mM(c),i=0;i<r;)n[i]=c[i++];for(;i<u;)Zne(n,i++);return n}});var ire=ma("Array").sort,are=C,cre=ire,zC=Array.prototype,lre=function(e){var n=e.sort;return e===zC||are(zC,e)&&n===zC.sort?cre:n},Hm=l(lre),YC=I;rr({global:!0,forced:YC.globalThis!==YC},{globalThis:YC});var SM=l(I),qC={exports:{}};(function(e,n){(function(r,i){var c="function",u="undefined",f="object",m="string",_="major",y="model",T="name",A="type",k="vendor",P="version",q="architecture",j="console",H="mobile",ne="tablet",re="smarttv",ve="wearable",Oe="embedded",ke="Amazon",we="Apple",Be="ASUS",lt="BlackBerry",St="Browser",At="Chrome",Nn="Firefox",kn="Google",fr="Huawei",Xr="LG",Wr="Microsoft",Ds="Motorola",Ze="Opera",ft="Samsung",xt="Sharp",rt="Sony",B="Xiaomi",he="Zebra",ye="Facebook",ht="Chromium OS",hn="Mac OS",ir=function(ao){for(var Co={},Ar=0;Ar<ao.length;Ar++)Co[ao[Ar].toUpperCase()]=ao[Ar];return Co},To=function(ao,Co){return typeof ao===m&&Gs(Co).indexOf(Gs(ao))!==-1},Gs=function(ao){return ao.toLowerCase()},jl=function(ao,Co){if(typeof ao===m)return ao=ao.replace(/^\s\s*/,""),typeof Co===u?ao:ao.substring(0,350)},ch=function(ao,Co){for(var Ar,ai,el,Jr,Hn,zs,Ku=0;Ku<Co.length&&!Hn;){var dc=Co[Ku],qj=Co[Ku+1];for(Ar=ai=0;Ar<dc.length&&!Hn&&dc[Ar];)if(Hn=dc[Ar++].exec(ao))for(el=0;el<qj.length;el++)zs=Hn[++ai],typeof(Jr=qj[el])===f&&Jr.length>0?Jr.length===2?typeof Jr[1]==c?this[Jr[0]]=Jr[1].call(this,zs):this[Jr[0]]=Jr[1]:Jr.length===3?typeof Jr[1]!==c||Jr[1].exec&&Jr[1].test?this[Jr[0]]=zs?zs.replace(Jr[1],Jr[2]):i:this[Jr[0]]=zs?Jr[1].call(this,zs,Jr[2]):i:Jr.length===4&&(this[Jr[0]]=zs?Jr[3].call(this,zs.replace(Jr[1],Jr[2])):i):this[Jr]=zs||i;Ku+=2}},Gv=function(ao,Co){for(var Ar in Co)if(typeof Co[Ar]===f&&Co[Ar].length>0){for(var ai=0;ai<Co[Ar].length;ai++)if(To(Co[Ar][ai],ao))return Ar==="?"?i:Ar}else if(To(Co[Ar],ao))return Ar==="?"?i:Ar;return ao},pb={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},mb={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[P,[T,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[P,[T,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[T,P],[/opios[\/ ]+([\w\.]+)/i],[P,[T,Ze+" Mini"]],[/\bopr\/([\w\.]+)/i],[P,[T,Ze]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[T,P],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[P,[T,"UC"+St]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[P,[T,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[P,[T,"WeChat"]],[/konqueror\/([\w\.]+)/i],[P,[T,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[P,[T,"IE"]],[/yabrowser\/([\w\.]+)/i],[P,[T,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[T,/(.+)/,"$1 Secure "+St],P],[/\bfocus\/([\w\.]+)/i],[P,[T,Nn+" Focus"]],[/\bopt\/([\w\.]+)/i],[P,[T,Ze+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[P,[T,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[P,[T,"Dolphin"]],[/coast\/([\w\.]+)/i],[P,[T,Ze+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[P,[T,"MIUI "+St]],[/fxios\/([-\w\.]+)/i],[P,[T,Nn]],[/\bqihu|(qi?ho?o?|360)browser/i],[[T,"360 "+St]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[T,/(.+)/,"$1 "+St],P],[/(comodo_dragon)\/([\w\.]+)/i],[[T,/_/g," "],P],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[T,P],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[T],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[T,ye],P],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[T,P],[/\bgsa\/([\w\.]+) .*safari\//i],[P,[T,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[P,[T,At+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[T,At+" WebView"],P],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[P,[T,"Android "+St]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[T,P],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[P,[T,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[P,T],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[T,[P,Gv,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[T,P],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[T,"Netscape"],P],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[P,[T,Nn+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[T,P],[/(cobalt)\/([\w\.]+)/i],[T,[P,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[q,"amd64"]],[/(ia32(?=;))/i],[[q,Gs]],[/((?:i[346]|x)86)[;\)]/i],[[q,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[q,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[q,"armhf"]],[/windows (ce|mobile); ppc;/i],[[q,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[q,/ower/,"",Gs]],[/(sun4\w)[;\)]/i],[[q,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[q,Gs]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[y,[k,ft],[A,ne]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[y,[k,ft],[A,H]],[/\((ip(?:hone|od)[\w ]*);/i],[y,[k,we],[A,H]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[y,[k,we],[A,ne]],[/(macintosh);/i],[y,[k,we]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[y,[k,xt],[A,H]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[y,[k,fr],[A,ne]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[y,[k,fr],[A,H]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[y,/_/g," "],[k,B],[A,H]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[y,/_/g," "],[k,B],[A,ne]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[y,[k,"OPPO"],[A,H]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[y,[k,"Vivo"],[A,H]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[y,[k,"Realme"],[A,H]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[y,[k,Ds],[A,H]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[y,[k,Ds],[A,ne]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[y,[k,Xr],[A,ne]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[y,[k,Xr],[A,H]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[y,[k,"Lenovo"],[A,ne]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[y,/_/g," "],[k,"Nokia"],[A,H]],[/(pixel c)\b/i],[y,[k,kn],[A,ne]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[y,[k,kn],[A,H]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[y,[k,rt],[A,H]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[y,"Xperia Tablet"],[k,rt],[A,ne]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[y,[k,"OnePlus"],[A,H]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[y,[k,ke],[A,ne]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[y,/(.+)/g,"Fire Phone $1"],[k,ke],[A,H]],[/(playbook);[-\w\),; ]+(rim)/i],[y,k,[A,ne]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[y,[k,lt],[A,H]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[y,[k,Be],[A,ne]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[y,[k,Be],[A,H]],[/(nexus 9)/i],[y,[k,"HTC"],[A,ne]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[k,[y,/_/g," "],[A,H]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[y,[k,"Acer"],[A,ne]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[y,[k,"Meizu"],[A,H]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[k,y,[A,H]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[k,y,[A,ne]],[/(surface duo)/i],[y,[k,Wr],[A,ne]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[y,[k,"Fairphone"],[A,H]],[/(u304aa)/i],[y,[k,"AT&T"],[A,H]],[/\bsie-(\w*)/i],[y,[k,"Siemens"],[A,H]],[/\b(rct\w+) b/i],[y,[k,"RCA"],[A,ne]],[/\b(venue[\d ]{2,7}) b/i],[y,[k,"Dell"],[A,ne]],[/\b(q(?:mv|ta)\w+) b/i],[y,[k,"Verizon"],[A,ne]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[y,[k,"Barnes & Noble"],[A,ne]],[/\b(tm\d{3}\w+) b/i],[y,[k,"NuVision"],[A,ne]],[/\b(k88) b/i],[y,[k,"ZTE"],[A,ne]],[/\b(nx\d{3}j) b/i],[y,[k,"ZTE"],[A,H]],[/\b(gen\d{3}) b.+49h/i],[y,[k,"Swiss"],[A,H]],[/\b(zur\d{3}) b/i],[y,[k,"Swiss"],[A,ne]],[/\b((zeki)?tb.*\b) b/i],[y,[k,"Zeki"],[A,ne]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[k,"Dragon Touch"],y,[A,ne]],[/\b(ns-?\w{0,9}) b/i],[y,[k,"Insignia"],[A,ne]],[/\b((nxa|next)-?\w{0,9}) b/i],[y,[k,"NextBook"],[A,ne]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[k,"Voice"],y,[A,H]],[/\b(lvtel\-)?(v1[12]) b/i],[[k,"LvTel"],y,[A,H]],[/\b(ph-1) /i],[y,[k,"Essential"],[A,H]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[y,[k,"Envizen"],[A,ne]],[/\b(trio[-\w\. ]+) b/i],[y,[k,"MachSpeed"],[A,ne]],[/\btu_(1491) b/i],[y,[k,"Rotor"],[A,ne]],[/(shield[\w ]+) b/i],[y,[k,"Nvidia"],[A,ne]],[/(sprint) (\w+)/i],[k,y,[A,H]],[/(kin\.[onetw]{3})/i],[[y,/\./g," "],[k,Wr],[A,H]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[y,[k,he],[A,ne]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[y,[k,he],[A,H]],[/smart-tv.+(samsung)/i],[k,[A,re]],[/hbbtv.+maple;(\d+)/i],[[y,/^/,"SmartTV"],[k,ft],[A,re]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[k,Xr],[A,re]],[/(apple) ?tv/i],[k,[y,we+" TV"],[A,re]],[/crkey/i],[[y,At+"cast"],[k,kn],[A,re]],[/droid.+aft(\w)( bui|\))/i],[y,[k,ke],[A,re]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[y,[k,xt],[A,re]],[/(bravia[\w ]+)( bui|\))/i],[y,[k,rt],[A,re]],[/(mitv-\w{5}) bui/i],[y,[k,B],[A,re]],[/Hbbtv.*(technisat) (.*);/i],[k,y,[A,re]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[k,jl],[y,jl],[A,re]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[A,re]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[k,y,[A,j]],[/droid.+; (shield) bui/i],[y,[k,"Nvidia"],[A,j]],[/(playstation [345portablevi]+)/i],[y,[k,rt],[A,j]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[y,[k,Wr],[A,j]],[/((pebble))app/i],[k,y,[A,ve]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[y,[k,we],[A,ve]],[/droid.+; (glass) \d/i],[y,[k,kn],[A,ve]],[/droid.+; (wt63?0{2,3})\)/i],[y,[k,he],[A,ve]],[/(quest( 2| pro)?)/i],[y,[k,ye],[A,ve]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[k,[A,Oe]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[y,[A,H]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[y,[A,ne]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[A,ne]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[A,H]],[/(android[-\w\. ]{0,9});.+buil/i],[y,[k,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[P,[T,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[P,[T,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[T,P],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[P,T]],os:[[/microsoft (windows) (vista|xp)/i],[T,P],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[T,[P,Gv,pb]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[T,"Windows"],[P,Gv,pb]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[P,/_/g,"."],[T,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[T,hn],[P,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[P,T],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[T,P],[/\(bb(10);/i],[P,[T,lt]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[P,[T,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[P,[T,Nn+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[P,[T,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[P,[T,"watchOS"]],[/crkey\/([\d\.]+)/i],[P,[T,At+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[T,ht],P],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[T,P],[/(sunos) ?([\w\.\d]*)/i],[[T,"Solaris"],P],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[T,P]]},na=function(ao,Co){if(typeof ao===f&&(Co=ao,ao=i),!(this instanceof na))return new na(ao,Co).getResult();var Ar=typeof r!==u&&r.navigator?r.navigator:i,ai=ao||(Ar&&Ar.userAgent?Ar.userAgent:""),el=Ar&&Ar.userAgentData?Ar.userAgentData:i,Jr=Co?function(Hn,zs){var Ku={};for(var dc in Hn)zs[dc]&&zs[dc].length%2==0?Ku[dc]=zs[dc].concat(Hn[dc]):Ku[dc]=Hn[dc];return Ku}(mb,Co):mb;return this.getBrowser=function(){var Hn={};return Hn[T]=i,Hn[P]=i,ch.call(Hn,ai,Jr.browser),Hn[_]=function(zs){return typeof zs===m?zs.replace(/[^\d\.]/g,"").split(".")[0]:i}(Hn[P]),Ar&&Ar.brave&&typeof Ar.brave.isBrave==c&&(Hn[T]="Brave"),Hn},this.getCPU=function(){var Hn={};return Hn[q]=i,ch.call(Hn,ai,Jr.cpu),Hn},this.getDevice=function(){var Hn={};return Hn[k]=i,Hn[y]=i,Hn[A]=i,ch.call(Hn,ai,Jr.device),!Hn[A]&&el&&el.mobile&&(Hn[A]=H),Hn[y]=="Macintosh"&&Ar&&typeof Ar.standalone!==u&&Ar.maxTouchPoints&&Ar.maxTouchPoints>2&&(Hn[y]="iPad",Hn[A]=ne),Hn},this.getEngine=function(){var Hn={};return Hn[T]=i,Hn[P]=i,ch.call(Hn,ai,Jr.engine),Hn},this.getOS=function(){var Hn={};return Hn[T]=i,Hn[P]=i,ch.call(Hn,ai,Jr.os),!Hn[T]&&el&&el.platform!="Unknown"&&(Hn[T]=el.platform.replace(/chrome os/i,ht).replace(/macos/i,hn)),Hn},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ai},this.setUA=function(Hn){return ai=typeof Hn===m&&Hn.length>350?jl(Hn,350):Hn,this},this.setUA(ai),this};na.VERSION="0.7.34",na.BROWSER=ir([T,P,_]),na.CPU=ir([q]),na.DEVICE=ir([y,k,A,j,H,re,ne,ve,Oe]),na.ENGINE=na.OS=ir([T,P]),e.exports&&(n=e.exports=na),n.UAParser=na;var Wu=typeof r!==u&&(r.jQuery||r.Zepto);if(Wu&&!Wu.ua){var lh=new na;Wu.ua=lh.getResult(),Wu.ua.get=function(){return lh.getUA()},Wu.ua.set=function(ao){lh.setUA(ao);var Co=lh.getResult();for(var Ar in Co)Wu.ua[Ar]=Co[Ar]}}})(typeof window=="object"?window:a)})(qC,qC.exports);var ure=l(qC.exports),dre=kc,hre=mr,fre=ce,pre=Sd,mre=Zr("iterator"),vre=Object,gre=function(e){if(fre(e))return!1;var n=vre(e);return n[mre]!==void 0||"@@iterator"in n||hre(pre,dre(n))},_re=l(gre),TM=G_.clear;rr({global:!0,bind:!0,forced:I.clearImmediate!==TM},{clearImmediate:TM});var Ere=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",CM=I,yre=L,bre=Ee,Sre=Ere,Tre=tn,Cre=K_,wre=sf,Rre=CM.Function,Ire=/MSIE .\./.test(Tre)||Sre&&function(){var e=CM.Bun.version.split(".");return e.length<3||e[0]==0&&(e[1]<3||e[1]==3&&e[2]==0)}(),Are=rr,wM=I,RM=G_.set,Ore=function(e,n){var r=1;return Ire?function(i,c){var u=wre(arguments.length,1)>r,f=bre(i)?i:Rre(i),m=u?Cre(arguments,r):[],_=u?function(){yre(f,this,m)}:f;return e(_)}:e},IM=wM.setImmediate?Ore(RM):RM;Are({global:!0,bind:!0,forced:wM.setImmediate!==IM},{setImmediate:IM});var AM=l(Ot.setImmediate),Nre=rr,kre=K1,Pre=Rs,Dre=sf,Lre=tf,Mre=I.process;Nre({global:!0,dontCallGetSet:!0},{queueMicrotask:function(e){Dre(arguments.length,1),Pre(e);var n=Lre&&Mre.domain;kre(n?n.bind(e):e)}});var OM=l(Ot.queueMicrotask);function NM(e,n){return function(){return e.apply(n,arguments)}}const{toString:xre}=Object.prototype,{getPrototypeOf:XC}=Object,_E=(JC=Object.create(null),e=>{const n=xre.call(e);return JC[n]||(JC[n]=n.slice(8,-1).toLowerCase())});var JC;const Za=e=>(e=e.toLowerCase(),n=>_E(n)===e),EE=e=>n=>typeof n===e,{isArray:Sf}=Array,Wm=EE("undefined"),kM=Za("ArrayBuffer"),Ure=EE("string"),Gi=EE("function"),PM=EE("number"),yE=e=>e!==null&&typeof e=="object",bE=e=>{if(_E(e)!=="object")return!1;const n=XC(e);return!(n!==null&&n!==Object.prototype&&Object.getPrototypeOf(n)!==null||Symbol.toStringTag in e||_re(e))},Vre=Za("Date"),Fre=Za("File"),Bre=Za("Blob"),jre=Za("FileList"),$re=Za("URLSearchParams"),[Hre,Wre,Kre,Gre]=["ReadableStream","Request","Response","Headers"].map(Za);function Km(e,n){let r,i,{allOwnKeys:c=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e!=null)if(typeof e!="object"&&(e=[e]),Sf(e))for(r=0,i=e.length;r<i;r++)n.call(null,e[r],r,e);else{const u=c?Object.getOwnPropertyNames(e):Object.keys(e),f=u.length;let m;for(r=0;r<f;r++)m=u[r],n.call(null,e[m],m,e)}}function DM(e,n){n=n.toLowerCase();const r=Object.keys(e);let i,c=r.length;for(;c-- >0;)if(i=r[c],n===i.toLowerCase())return i;return null}const Pd=SM!==void 0?SM:typeof self<"u"?self:typeof window<"u"?window:aa,LM=e=>!Wm(e)&&e!==Pd,zre=(ZC=typeof Uint8Array<"u"&&XC(Uint8Array),e=>ZC&&e instanceof ZC);var ZC;const Yre=Za("HTMLFormElement"),MM=(e=>{let{hasOwnProperty:n}=e;return(r,i)=>n.call(r,i)})(Object.prototype),qre=Za("RegExp"),xM=(e,n)=>{const r=Object.getOwnPropertyDescriptors(e),i={};Km(r,(c,u)=>{let f;(f=n(c,u,e))!==!1&&(i[u]=f||c)}),Object.defineProperties(e,i)},QC="abcdefghijklmnopqrstuvwxyz",UM="0123456789",VM={DIGIT:UM,ALPHA:QC,ALPHA_DIGIT:QC+QC.toUpperCase()+UM},Xre=Za("AsyncFunction"),FM=(BM=typeof AM=="function",jM=Gi(Pd.postMessage),BM?AM:jM?(ew="axios@".concat(Math.random()),SE=[],Pd.addEventListener("message",e=>{let{source:n,data:r}=e;n===Pd&&r===ew&&SE.length&&SE.shift()()},!1),e=>{SE.push(e),Pd.postMessage(ew,"*")}):e=>setTimeout(e));var BM,jM,ew,SE;const Jre=OM!==void 0?OM.bind(Pd):typeof process<"u"&&process.nextTick||FM;var Et={isArray:Sf,isArrayBuffer:kM,isBuffer:function(e){return e!==null&&!Wm(e)&&e.constructor!==null&&!Wm(e.constructor)&&Gi(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Gi(e.append)&&((n=_E(e))==="formdata"||n==="object"&&Gi(e.toString)&&e.toString()==="[object FormData]"))},isArrayBufferView:function(e){let n;return n=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&kM(e.buffer),n},isString:Ure,isNumber:PM,isBoolean:e=>e===!0||e===!1,isObject:yE,isPlainObject:bE,isReadableStream:Hre,isRequest:Wre,isResponse:Kre,isHeaders:Gre,isUndefined:Wm,isDate:Vre,isFile:Fre,isBlob:Bre,isRegExp:qre,isFunction:Gi,isStream:e=>yE(e)&&Gi(e.pipe),isURLSearchParams:$re,isTypedArray:zre,isFileList:jre,forEach:Km,merge:function e(){const{caseless:n}=LM(this)&&this||{},r={},i=(c,u)=>{const f=n&&DM(r,u)||u;bE(r[f])&&bE(c)?r[f]=e(r[f],c):bE(c)?r[f]=e({},c):Sf(c)?r[f]=c.slice():r[f]=c};for(let c=0,u=arguments.length;c<u;c++)arguments[c]&&Km(arguments[c],i);return r},extend:function(e,n,r){let{allOwnKeys:i}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Km(n,(c,u)=>{r&&Gi(c)?e[u]=NM(c,r):e[u]=c},{allOwnKeys:i}),e},trim:e=>es(e)?es(e).call(e):e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits:(e,n,r,i)=>{e.prototype=Object.create(n.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,n,r,i)=>{let c,u,f;const m={};if(n=n||{},e==null)return n;do{for(c=Object.getOwnPropertyNames(e),u=c.length;u-- >0;)f=c[u],i&&!i(f,e,n)||m[f]||(n[f]=e[f],m[f]=!0);e=r!==!1&&XC(e)}while(e&&(!r||r(e,n))&&e!==Object.prototype);return n},kindOf:_E,kindOfTest:Za,endsWith:(e,n,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=n.length;const i=e.indexOf(n,r);return i!==-1&&i===r},toArray:e=>{if(!e)return null;if(Sf(e))return e;let n=e.length;if(!PM(n))return null;const r=new Array(n);for(;n-- >0;)r[n]=e[n];return r},forEachEntry:(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const c=i.value;n.call(e,c[0],c[1])}},matchAll:(e,n)=>{let r;const i=[];for(;(r=e.exec(n))!==null;)i.push(r);return i},isHTMLForm:Yre,hasOwnProperty:MM,hasOwnProp:MM,reduceDescriptors:xM,freezeMethods:e=>{xM(e,(n,r)=>{if(Gi(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];Gi(i)&&(n.enumerable=!1,"writable"in n?n.writable=!1:n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,n)=>{const r={},i=c=>{c.forEach(u=>{r[u]=!0})};return Sf(e)?i(e):i(String(e).split(n)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),noop:()=>{},toFiniteNumber:(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n,findKey:DM,global:Pd,isContextDefined:LM,ALPHABET:VM,generateString:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:VM.ALPHA_DIGIT,r="";const{length:i}=n;for(;e--;)r+=n[Math.random()*i|0];return r},isSpecCompliantForm:function(e){return!!(e&&Gi(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])},toJSONObject:e=>{const n=new Array(10),r=(i,c)=>{if(yE(i)){if(n.indexOf(i)>=0)return;if(!("toJSON"in i)){n[c]=i;const u=Sf(i)?[]:{};return Km(i,(f,m)=>{const _=r(f,c+1);!Wm(_)&&(u[m]=_)}),n[c]=void 0,u}}return i};return r(e,0)},isAsyncFn:Xre,isThenable:e=>e&&(yE(e)||Gi(e))&&Gi(e.then)&&Gi(e.catch),setImmediate:FM,asap:Jre};function or(e,n,r,i,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),r&&(this.config=r),i&&(this.request=i),c&&(this.response=c,this.status=c.status?c.status:null)}Et.inherits(or,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Et.toJSONObject(this.config),code:this.code,status:this.status}}});const $M=or.prototype,HM={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{HM[e]={value:e}}),Object.defineProperties(or,HM),Object.defineProperty($M,"isAxiosError",{value:!0}),or.from=(e,n,r,i,c,u)=>{const f=Object.create($M);return Et.toFlatObject(e,f,function(m){return m!==Error.prototype},m=>m!=="isAxiosError"),or.call(f,e.message,n,r,i,c),f.cause=e,f.name=e.name,u&&Object.assign(f,u),f};function tw(e){return Et.isPlainObject(e)||Et.isArray(e)}function WM(e){return Et.endsWith(e,"[]")?e.slice(0,-2):e}function KM(e,n,r){return e?e.concat(n).map(function(i,c){return i=WM(i),!r&&c?"["+i+"]":i}).join(r?".":""):n}const Zre=Et.toFlatObject(Et,{},null,function(e){return/^is[A-Z]/.test(e)});function TE(e,n,r){if(!Et.isObject(e))throw new TypeError("target must be an object");n=n||new FormData;const i=(r=Et.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,P){return!Et.isUndefined(P[k])})).metaTokens,c=r.visitor||y,u=r.dots,f=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&Et.isSpecCompliantForm(n);if(!Et.isFunction(c))throw new TypeError("visitor must be a function");function _(k){if(k===null)return"";if(Et.isDate(k))return k.toISOString();if(!m&&Et.isBlob(k))throw new or("Blob is not supported. Use a Buffer instead.");return Et.isArrayBuffer(k)||Et.isTypedArray(k)?m&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function y(k,P,q){let j=k;if(k&&!q&&typeof k=="object"){if(Et.endsWith(P,"{}"))P=i?P:P.slice(0,-2),k=JSON.stringify(k);else if(Et.isArray(k)&&function(H){return Et.isArray(H)&&!H.some(tw)}(k)||(Et.isFileList(k)||Et.endsWith(P,"[]"))&&(j=Et.toArray(k)))return P=WM(P),j.forEach(function(H,ne){!Et.isUndefined(H)&&H!==null&&n.append(f===!0?KM([P],ne,u):f===null?P:P+"[]",_(H))}),!1}return!!tw(k)||(n.append(KM(q,P,u),_(k)),!1)}const T=[],A=Object.assign(Zre,{defaultVisitor:y,convertValue:_,isVisitable:tw});if(!Et.isObject(e))throw new TypeError("data must be an object");return function k(P,q){if(!Et.isUndefined(P)){if(T.indexOf(P)!==-1)throw Error("Circular reference detected in "+q.join("."));T.push(P),Et.forEach(P,function(j,H){(!(Et.isUndefined(j)||j===null)&&c.call(n,j,Et.isString(H)?es(H).call(H):H,q,A))===!0&&k(j,q?q.concat(H):[H])}),T.pop()}}(e),n}function GM(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function nw(e,n){this._pairs=[],e&&TE(e,this,n)}const zM=nw.prototype;function Qre(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function YM(e,n,r){if(!n)return e;const i=r&&r.encode||Qre;Et.isFunction(r)&&(r={serialize:r});const c=r&&r.serialize;let u;if(u=c?c(n,r):Et.isURLSearchParams(n)?n.toString():new nw(n,r).toString(i),u){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+u}return e}zM.append=function(e,n){this._pairs.push([e,n])},zM.toString=function(e){const n=e?function(r){return e.call(this,r,GM)}:GM;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};var qM=class{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Et.forEach(this.handlers,function(n){n!==null&&e(n)})}},XM={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},JM={exports:{}},eoe=rr,toe=X,ZM=pa.f;eoe({target:"Object",stat:!0,forced:Object.defineProperty!==ZM,sham:!toe},{defineProperty:ZM});var QM=Ot.Object,noe=JM.exports=function(e,n,r){return QM.defineProperty(e,n,r)};QM.defineProperty.sham&&(noe.sham=!0);var e2=l(JM.exports),roe=TypeError,t2=Cm,ooe=W_,soe=nt,ioe=Zr("species"),n2=Array,aoe=function(e){var n;return t2(e)&&(n=e.constructor,(ooe(n)&&(n===n2||t2(n.prototype))||soe(n)&&(n=n[ioe])===null)&&(n=void 0)),n===void 0?n2:n},r2=function(e,n){return new(aoe(e))(n===0?0:n)},coe=d,loe=Ke,uoe=Zr("species"),o2=function(e){return loe>=51||!coe(function(){var n=[];return(n.constructor={})[uoe]=function(){return{foo:1}},n[e](Boolean).foo!==1})},doe=rr,hoe=d,foe=Cm,poe=nt,moe=zt,voe=Sl,s2=function(e){if(e>9007199254740991)throw roe("Maximum allowed index exceeded");return e},i2=Q_,goe=r2,_oe=o2,Eoe=Ke,a2=Zr("isConcatSpreadable"),yoe=Eoe>=51||!hoe(function(){var e=[];return e[a2]=!1,e.concat()[0]!==e}),boe=function(e){if(!poe(e))return!1;var n=e[a2];return n!==void 0?!!n:foe(e)};doe({target:"Array",proto:!0,forced:!yoe||!_oe("concat")},{concat:function(e){var n,r,i,c,u,f=moe(this),m=goe(f,0),_=0;for(n=-1,i=arguments.length;n<i;n++)if(boe(u=n===-1?f:arguments[n]))for(c=voe(u),s2(_+c),r=0;r<c;r++,_++)r in u&&i2(m,_,u[r]);else s2(_+1),i2(m,_++,u);return m.length=_,m}});var c2={},Soe=W,Toe=Xe,l2=N_.f,Coe=sC,u2=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];c2.f=function(e){return u2&&Soe(e)=="Window"?function(n){try{return l2(n)}catch{return Coe(u2)}}(e):l2(Toe(e))};var Tf={},woe=Zr;Tf.f=woe;var d2=Ot,Roe=mr,Ioe=Tf,Aoe=pa.f,Uo=function(e){var n=d2.Symbol||(d2.Symbol={});Roe(n,e)||Aoe(n,e,{value:Ioe.f(e)})},Ooe=J,Noe=sn,koe=Zr,Poe=_u,h2=function(){var e=Noe("Symbol"),n=e&&e.prototype,r=n&&n.valueOf,i=koe("toPrimitive");n&&!n[i]&&Poe(n,i,function(c){return Ooe(r,this)},{})},Doe=vu,Loe=it,Moe=zt,xoe=Sl,Uoe=r2,f2=S([].push),Voe=function(e){var n=e==1,r=e==2,i=e==3,c=e==4,u=e==6,f=e==7,m=e==5||u;return function(_,y,T,A){for(var k,P,q=Moe(_),j=Loe(q),H=Doe(y,T),ne=xoe(j),re=0,ve=A||Uoe,Oe=n?ve(_,ne):r||f?ve(_,0):void 0;ne>re;re++)if((m||re in j)&&(P=H(k=j[re],re,q),e))if(n)Oe[re]=P;else if(P)switch(e){case 3:return!0;case 5:return k;case 6:return re;case 2:f2(Oe,k)}else switch(e){case 4:return!1;case 7:f2(Oe,k)}return u?-1:i||c?c:Oe}},p2={forEach:Voe(0)},CE=rr,rw=I,ow=J,Foe=S,Cf=X,wf=en,Boe=d,ms=mr,joe=C,sw=Bs,wE=Xe,iw=C_,$oe=Wi,aw=Le,Gm=Rm,m2=P_,Hoe=N_,v2=c2,Woe=wm,g2=ae,_2=pa,Koe=cT,E2=pe,y2=_u,Goe=H_,cw=Si,b2=k_,S2=S_,zoe=Zr,Yoe=Tf,qoe=Uo,Xoe=h2,Joe=Eu,T2=Cd,RE=p2.forEach,Ci=O_("hidden"),IE="Symbol",zm="prototype",Zoe=T2.set,C2=T2.getterFor(IE),Qa=Object[zm],Dd=rw.Symbol,AE=Dd&&Dd[zm],Qoe=rw.TypeError,lw=rw.QObject,w2=g2.f,Ld=_2.f,R2=v2.f,ese=E2.f,I2=Foe([].push),wl=cw("symbols"),Ym=cw("op-symbols"),tse=cw("wks"),uw=!lw||!lw[zm]||!lw[zm].findChild,dw=Cf&&Boe(function(){return Gm(Ld({},"a",{get:function(){return Ld(this,"a",{value:7}).a}})).a!=7})?function(e,n,r){var i=w2(Qa,n);i&&delete Qa[n],Ld(e,n,r),i&&e!==Qa&&Ld(Qa,n,i)}:Ld,hw=function(e,n){var r=wl[e]=Gm(AE);return Zoe(r,{type:IE,tag:e,description:n}),Cf||(r.description=n),r},OE=function(e,n,r){e===Qa&&OE(Ym,n,r),sw(e);var i=iw(n);return sw(r),ms(wl,i)?(r.enumerable?(ms(e,Ci)&&e[Ci][i]&&(e[Ci][i]=!1),r=Gm(r,{enumerable:aw(0,!1)})):(ms(e,Ci)||Ld(e,Ci,aw(1,{})),e[Ci][i]=!0),dw(e,i,r)):Ld(e,i,r)},fw=function(e,n){sw(e);var r=wE(n),i=m2(r).concat(k2(r));return RE(i,function(c){Cf&&!ow(A2,r,c)||OE(e,c,r[c])}),e},A2=function(e){var n=iw(e),r=ow(ese,this,n);return!(this===Qa&&ms(wl,n)&&!ms(Ym,n))&&(!(r||!ms(this,n)||!ms(wl,n)||ms(this,Ci)&&this[Ci][n])||r)},O2=function(e,n){var r=wE(e),i=iw(n);if(r!==Qa||!ms(wl,i)||ms(Ym,i)){var c=w2(r,i);return!c||!ms(wl,i)||ms(r,Ci)&&r[Ci][i]||(c.enumerable=!0),c}},N2=function(e){var n=R2(wE(e)),r=[];return RE(n,function(i){ms(wl,i)||ms(b2,i)||I2(r,i)}),r},k2=function(e){var n=e===Qa,r=R2(n?Ym:wE(e)),i=[];return RE(r,function(c){!ms(wl,c)||n&&!ms(Qa,c)||I2(i,wl[c])}),i};wf||(Dd=function(){if(joe(AE,this))throw Qoe("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?$oe(arguments[0]):void 0,n=S2(e),r=function(i){this===Qa&&ow(r,Ym,i),ms(this,Ci)&&ms(this[Ci],n)&&(this[Ci][n]=!1),dw(this,n,aw(1,i))};return Cf&&uw&&dw(Qa,n,{configurable:!0,set:r}),hw(n,e)},y2(AE=Dd[zm],"toString",function(){return C2(this).tag}),y2(Dd,"withoutSetter",function(e){return hw(S2(e),e)}),E2.f=A2,_2.f=OE,Koe.f=fw,g2.f=O2,Hoe.f=v2.f=N2,Woe.f=k2,Yoe.f=function(e){return hw(zoe(e),e)},Cf&&Goe(AE,"description",{configurable:!0,get:function(){return C2(this).description}})),CE({global:!0,wrap:!0,forced:!wf,sham:!wf},{Symbol:Dd}),RE(m2(tse),function(e){qoe(e)}),CE({target:IE,stat:!0,forced:!wf},{useSetter:function(){uw=!0},useSimple:function(){uw=!1}}),CE({target:"Object",stat:!0,forced:!wf,sham:!Cf},{create:function(e,n){return n===void 0?Gm(e):fw(Gm(e),n)},defineProperty:OE,defineProperties:fw,getOwnPropertyDescriptor:O2}),CE({target:"Object",stat:!0,forced:!wf},{getOwnPropertyNames:N2}),Xoe(),Joe(Dd,IE),b2[Ci]=!0;var P2=en&&!!Symbol.for&&!!Symbol.keyFor,nse=rr,rse=sn,ose=mr,sse=Wi,D2=Si,ise=P2,pw=D2("string-to-symbol-registry"),ase=D2("symbol-to-string-registry");nse({target:"Symbol",stat:!0,forced:!ise},{for:function(e){var n=sse(e);if(ose(pw,n))return pw[n];var r=rse("Symbol")(n);return pw[n]=r,ase[r]=n,r}});var cse=rr,lse=mr,use=_r,dse=Ga,hse=P2,L2=Si("symbol-to-string-registry");cse({target:"Symbol",stat:!0,forced:!hse},{keyFor:function(e){if(!use(e))throw TypeError(dse(e)+" is not a symbol");if(lse(L2,e))return L2[e]}});var M2=Cm,fse=Ee,x2=W,pse=Wi,U2=S([].push),mse=rr,V2=sn,F2=L,vse=J,qm=S,B2=d,j2=Ee,$2=_r,H2=K_,gse=function(e){if(fse(e))return e;if(M2(e)){for(var n=e.length,r=[],i=0;i<n;i++){var c=e[i];typeof c=="string"?U2(r,c):typeof c!="number"&&x2(c)!="Number"&&x2(c)!="String"||U2(r,pse(c))}var u=r.length,f=!0;return function(m,_){if(f)return f=!1,_;if(M2(this))return _;for(var y=0;y<u;y++)if(r[y]===m)return _}}},_se=en,Ese=String,Cu=V2("JSON","stringify"),NE=qm(/./.exec),W2=qm("".charAt),yse=qm("".charCodeAt),bse=qm("".replace),Sse=qm(1 .toString),Tse=/[\uD800-\uDFFF]/g,K2=/^[\uD800-\uDBFF]$/,G2=/^[\uDC00-\uDFFF]$/,z2=!_se||B2(function(){var e=V2("Symbol")();return Cu([e])!="[null]"||Cu({a:e})!="{}"||Cu(Object(e))!="{}"}),Y2=B2(function(){return Cu("\uDF06\uD834")!=='"\\udf06\\ud834"'||Cu("\uDEAD")!=='"\\udead"'}),Cse=function(e,n){var r=H2(arguments),i=gse(n);if(j2(i)||e!==void 0&&!$2(e))return r[1]=function(c,u){if(j2(i)&&(u=vse(i,this,Ese(c),u)),!$2(u))return u},F2(Cu,null,r)},wse=function(e,n,r){var i=W2(r,n-1),c=W2(r,n+1);return NE(K2,e)&&!NE(G2,c)||NE(G2,e)&&!NE(K2,i)?"\\u"+Sse(yse(e,0),16):e};Cu&&mse({target:"JSON",stat:!0,forced:z2||Y2},{stringify:function(e,n,r){var i=H2(arguments),c=F2(z2?Cse:Cu,null,i);return Y2&&typeof c=="string"?bse(c,Tse,wse):c}});var q2=wm,Rse=zt;rr({target:"Object",stat:!0,forced:!en||d(function(){q2.f(1)})},{getOwnPropertySymbols:function(e){var n=q2.f;return n?n(Rse(e)):[]}}),Uo("asyncIterator"),Uo("hasInstance"),Uo("isConcatSpreadable"),Uo("iterator"),Uo("match"),Uo("matchAll"),Uo("replace"),Uo("search"),Uo("species"),Uo("split");var Ise=h2;Uo("toPrimitive"),Ise();var Ase=sn,Ose=Eu;Uo("toStringTag"),Ose(Ase("Symbol"),"Symbol"),Uo("unscopables"),Eu(I.JSON,"JSON",!0);var Nse=Ot.Symbol,kse=Zr,Pse=pa.f,X2=kse("metadata"),J2=Function.prototype;J2[X2]===void 0&&Pse(J2,X2,{value:null}),Uo("dispose"),Uo("metadata");var Dse=Nse;Uo("asyncDispose");var Lse=S,mw=sn("Symbol"),Mse=mw.keyFor,xse=Lse(mw.prototype.valueOf),Z2=mw.isRegisteredSymbol||function(e){try{return Mse(xse(e))!==void 0}catch{return!1}};rr({target:"Symbol",stat:!0},{isRegisteredSymbol:Z2});for(var Use=Si,Q2=sn,Vse=S,Fse=_r,Bse=Zr,kE=Q2("Symbol"),ex=kE.isWellKnownSymbol,tx=Q2("Object","getOwnPropertyNames"),jse=Vse(kE.prototype.valueOf),nx=Use("wks"),vw=0,rx=tx(kE),$se=rx.length;vw<$se;vw++)try{var ox=rx[vw];Fse(kE[ox])&&Bse(ox)}catch{}var sx=function(e){if(ex&&ex(e))return!0;try{for(var n=jse(e),r=0,i=tx(nx),c=i.length;r<c;r++)if(nx[i[r]]==n)return!0}catch{}return!1};rr({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:sx}),Uo("matcher"),Uo("observable"),rr({target:"Symbol",stat:!0},{isRegistered:Z2}),rr({target:"Symbol",stat:!0,forced:!0},{isWellKnown:sx}),Uo("metadataKey"),Uo("patternMatch"),Uo("replaceAll");var Rf=l(Dse),ix=l(Tf.f("iterator"));function Xm(e){return Xm=typeof Rf=="function"&&typeof ix=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Rf=="function"&&n.constructor===Rf&&n!==Rf.prototype?"symbol":typeof n},Xm(e)}var Hse=l(Tf.f("toPrimitive"));function Wse(e){var n=function(r,i){if(Xm(r)!=="object"||r===null)return r;var c=r[Hse];if(c!==void 0){var u=c.call(r,i);if(Xm(u)!=="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}(e,"string");return Xm(n)==="symbol"?n:String(n)}function Q(e,n,r){return(n=Wse(n))in e?e2(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var ax=l(Cte),Kse={isBrowser:!0,classes:{URLSearchParams:ax!==void 0?ax:nw,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const gw=typeof window<"u"&&typeof document<"u",_w=typeof navigator=="object"&&navigator||void 0,Gse=gw&&(!_w||["ReactNative","NativeScript","NS"].indexOf(_w.product)<0),zse=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Yse=gw&&window.location.href||"http://localhost";function cx(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function lx(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?cx(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cx(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}var js=lx(lx({},Object.freeze({__proto__:null,hasBrowserEnv:gw,hasStandardBrowserEnv:Gse,hasStandardBrowserWebWorkerEnv:zse,navigator:_w,origin:Yse})),Kse),qse=Bs,Xse=J,Jse=mr,Zse=C,Qse=function(){var e=qse(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},ux=RegExp.prototype,dx=function(e){var n=e.flags;return n!==void 0||"flags"in ux||Jse(e,"flags")||!Zse(ux,e)?n:Xse(Qse,e)},eie=eC.charAt,hx=J,tie=Bs,nie=Ee,rie=W,oie=/./.exec,sie=TypeError,iie=rr,fx=J,px=Y,aie=bT,PE=TT,mx=tt,vx=SP,Jm=Wi,cie=Bs,lie=ce,uie=W,die=CP,gx=dx,hie=pu,fie=d,pie=AT,mie=function(e,n,r){return n+(r?eie(e,n).length:1)},vie=function(e,n){var r=e.exec;if(nie(r)){var i=hx(r,e,n);return i!==null&&tie(i),i}if(rie(e)==="RegExp")return hx(oie,e,n);throw sie("RegExp#exec called on incompatible receiver")},_x=Cd,gie=Zr("matchAll"),Ex="RegExp String",yx=Ex+" Iterator",_ie=_x.set,Eie=_x.getterFor(yx),yie=TypeError,Ew=px("".indexOf),DE=px("".matchAll),yw=!!DE&&!fie(function(){DE("a",/./)}),bie=aie(function(e,n,r,i){_ie(this,{type:yx,regexp:e,string:n,global:r,unicode:i,done:!1})},Ex,function(){var e=Eie(this);if(e.done)return PE(void 0,!0);var n=e.regexp,r=e.string,i=vie(n,r);return i===null?(e.done=!0,PE(void 0,!0)):e.global?(Jm(i[0])===""&&(n.lastIndex=mie(r,vx(n.lastIndex),e.unicode)),PE(i,!1)):(e.done=!0,PE(i,!1))}),bx=function(e){var n,r,i,c=cie(this),u=Jm(e),f=pie(c,RegExp),m=Jm(gx(c));return n=new f(f===RegExp?c.source:c,m),r=!!~Ew(m,"g"),i=!!~Ew(m,"u"),n.lastIndex=vx(c.lastIndex),new bie(n,u,r,i)};iie({target:"String",proto:!0,forced:yw},{matchAll:function(e){var n,r,i,c,u=mx(this);if(lie(e)){if(yw)return DE(u,e)}else{if(die(e)&&(n=Jm(mx(gx(e))),!~Ew(n,"g")))throw yie("`.matchAll` does not allow non-global regexes");if(yw)return DE(u,e);if((i=hie(e,gie))===void 0&&uie(e)=="RegExp"&&(i=bx),i)return fx(i,e,u)}return r=Jm(u),c=new RegExp(e,"g"),fx(bx,c,r)}});var Sie=ma("String").matchAll,Tie=C,Cie=Sie,bw=String.prototype,wie=function(e){var n=e.matchAll;return typeof e=="string"||e===bw||Tie(bw,e)&&n===bw.matchAll?Cie:n},Rie=l(wie);function Sx(e){function n(r,i,c,u){let f=r[u++];if(f==="__proto__")return!0;const m=Number.isFinite(+f),_=u>=r.length;return f=!f&&Et.isArray(c)?c.length:f,_?(Et.hasOwnProp(c,f)?c[f]=[c[f],i]:c[f]=i,!m):(c[f]&&Et.isObject(c[f])||(c[f]=[]),n(r,i,c[f],u)&&Et.isArray(c[f])&&(c[f]=function(y){const T={},A=Object.keys(y);let k;const P=A.length;let q;for(k=0;k<P;k++)q=A[k],T[q]=y[q];return T}(c[f])),!m)}if(Et.isFormData(e)&&Et.isFunction(e.entries)){const r={};return Et.forEachEntry(e,(i,c)=>{n(function(u){return Rie(Et).call(Et,/\w+|\[(\w*)]/g,u).map(f=>f[0]==="[]"?"":f[1]||f[0])}(i),c,r,0)}),r}return null}const Sw={transitional:XM,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,c=Et.isObject(e);if(c&&Et.isHTMLForm(e)&&(e=new FormData(e)),Et.isFormData(e))return i?JSON.stringify(Sx(e)):e;if(Et.isArrayBuffer(e)||Et.isBuffer(e)||Et.isStream(e)||Et.isFile(e)||Et.isBlob(e)||Et.isReadableStream(e))return e;if(Et.isArrayBufferView(e))return e.buffer;if(Et.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(c){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(f,m){return TE(f,new js.classes.URLSearchParams,Object.assign({visitor:function(_,y,T,A){return js.isNode&&Et.isBuffer(_)?(this.append(y,_.toString("base64")),!1):A.defaultVisitor.apply(this,arguments)}},m))}(e,this.formSerializer).toString();if((u=Et.isFileList(e))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return TE(u?{"files[]":e}:e,f&&new f,this.formSerializer)}}return c||i?(n.setContentType("application/json",!1),function(f,m,_){if(Et.isString(f))try{return(m||JSON.parse)(f),es(Et).call(Et,f)}catch(y){if(y.name!=="SyntaxError")throw y}return(_||JSON.stringify)(f)}(e)):e}],transformResponse:[function(e){const n=this.transitional||Sw.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Et.isResponse(e)||Et.isReadableStream(e))return e;if(e&&Et.isString(e)&&(r&&!this.responseType||i)){const c=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(u){if(c)throw u.name==="SyntaxError"?or.from(u,or.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:js.classes.FormData,Blob:js.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Et.forEach(["delete","get","head","post","put","patch"],e=>{Sw.headers[e]={}});var Tw=Sw;const Iie=Et.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Tx=Symbol("internals");function Zm(e){var n;return e&&es(n=String(e)).call(n).toLowerCase()}function LE(e){return e===!1||e==null?e:Et.isArray(e)?e.map(LE):String(e)}function Cw(e,n,r,i,c){return Et.isFunction(i)?i.call(this,n,r):(c&&(n=r),Et.isString(n)?Et.isString(i)?n.indexOf(i)!==-1:Et.isRegExp(i)?i.test(n):void 0:void 0)}class ME{constructor(n){n&&this.set(n)}set(n,r,i){const c=this;function u(_,y,T){const A=Zm(y);if(!A)throw new Error("header name must be a non-empty string");const k=Et.findKey(c,A);(!k||c[k]===void 0||T===!0||T===void 0&&c[k]!==!1)&&(c[k||y]=LE(_))}const f=(_,y)=>Et.forEach(_,(T,A)=>u(T,A,y));if(Et.isPlainObject(n)||n instanceof this.constructor)f(n,r);else if(Et.isString(n)&&(n=es(n).call(n))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(es(m=n).call(m)))f((_=>{const y={};let T,A,k;return _&&_.split(`
`).forEach(function(P){var q,j;k=P.indexOf(":"),T=es(q=P.substring(0,k)).call(q).toLowerCase(),A=es(j=P.substring(k+1)).call(j),!T||y[T]&&Iie[T]||(T==="set-cookie"?y[T]?y[T].push(A):y[T]=[A]:y[T]=y[T]?y[T]+", "+A:A)}),y})(n),r);else if(Et.isHeaders(n))for(const[_,y]of n.entries())u(y,_,i);else n!=null&&u(r,n,i);var m;return this}get(n,r){if(n=Zm(n)){const i=Et.findKey(this,n);if(i){const c=this[i];if(!r)return c;if(r===!0)return function(u){const f=Object.create(null),m=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let _;for(;_=m.exec(u);)f[_[1]]=_[2];return f}(c);if(Et.isFunction(r))return r.call(this,c,i);if(Et.isRegExp(r))return r.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,r){if(n=Zm(n)){const i=Et.findKey(this,n);return!(!i||this[i]===void 0||r&&!Cw(0,this[i],i,r))}return!1}delete(n,r){const i=this;let c=!1;function u(f){if(f=Zm(f)){const m=Et.findKey(i,f);!m||r&&!Cw(0,i[m],m,r)||(delete i[m],c=!0)}}return Et.isArray(n)?n.forEach(u):u(n),c}clear(n){const r=Object.keys(this);let i=r.length,c=!1;for(;i--;){const u=r[i];n&&!Cw(0,this[u],u,n,!0)||(delete this[u],c=!0)}return c}normalize(n){const r=this,i={};return Et.forEach(this,(c,u)=>{var f;const m=Et.findKey(i,u);if(m)return r[m]=LE(c),void delete r[u];const _=n?function(y){return es(y).call(y).toLowerCase().replace(/([a-z\d])(\w*)/g,(T,A,k)=>A.toUpperCase()+k)}(u):es(f=String(u)).call(f);_!==u&&delete r[u],r[_]=LE(c),i[_]=!0}),this}concat(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return this.constructor.concat(this,...r)}toJSON(n){const r=Object.create(null);return Et.forEach(this,(i,c)=>{i!=null&&i!==!1&&(r[c]=n&&Et.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(n=>{let[r,i]=n;return r+": "+i}).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n){const r=new this(n);for(var i=arguments.length,c=new Array(i>1?i-1:0),u=1;u<i;u++)c[u-1]=arguments[u];return c.forEach(f=>r.set(f)),r}static accessor(n){const r=(this[Tx]=this[Tx]={accessors:{}}).accessors,i=this.prototype;function c(u){const f=Zm(u);r[f]||(function(m,_){const y=Et.toCamelCase(" "+_);["get","set","has"].forEach(T=>{Object.defineProperty(m,T+y,{value:function(A,k,P){return this[T].call(this,_,A,k,P)},configurable:!0})})}(i,u),r[f]=!0)}return Et.isArray(n)?n.forEach(c):c(n),this}}ME.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Et.reduceDescriptors(ME.prototype,(e,n)=>{let{value:r}=e,i=n[0].toUpperCase()+n.slice(1);return{get:()=>r,set(c){this[i]=c}}}),Et.freezeMethods(ME);var ec=ME;function ww(e,n){const r=this||Tw,i=n||r,c=ec.from(i.headers);let u=i.data;return Et.forEach(e,function(f){u=f.call(r,u,c.normalize(),n?n.status:void 0)}),c.normalize(),u}function Cx(e){return!(!e||!e.__CANCEL__)}function If(e,n,r){or.call(this,e??"canceled",or.ERR_CANCELED,n,r),this.name="CanceledError"}function wx(e,n,r){const i=r.config.validateStatus;r.status&&i&&!i(r.status)?n(new or("Request failed with status code "+r.status,[or.ERR_BAD_REQUEST,or.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}Et.inherits(If,or,{__CANCEL__:!0});const xE=function(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,i=0;const c=function(u,f){u=u||10;const m=new Array(u),_=new Array(u);let y,T=0,A=0;return f=f!==void 0?f:1e3,function(k){const P=Date.now(),q=_[A];y||(y=P),m[T]=k,_[T]=P;let j=A,H=0;for(;j!==T;)H+=m[j++],j%=u;if(T=(T+1)%u,T===A&&(A=(A+1)%u),P-y<f)return;const ne=q&&P-q;return ne?Math.round(1e3*H/ne):void 0}}(50,250);return function(u,f){let m,_,y=0,T=1e3/f;const A=function(k){y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),m=null,_&&(clearTimeout(_),_=null),u.apply(null,k)};return[function(){const k=Date.now(),P=k-y;for(var q=arguments.length,j=new Array(q),H=0;H<q;H++)j[H]=arguments[H];P>=T?A(j,k):(m=j,_||(_=setTimeout(()=>{_=null,A(m)},T-P)))},()=>m&&A(m)]}(u=>{const f=u.loaded,m=u.lengthComputable?u.total:void 0,_=f-i,y=c(_);i=f,e({loaded:f,total:m,progress:m?f/m:void 0,bytes:_,rate:y||void 0,estimated:y&&m&&f<=m?(m-f)/y:void 0,event:u,lengthComputable:m!=null,[n?"download":"upload"]:!0})},r)},Rx=(e,n)=>{const r=e!=null;return[i=>n[0]({lengthComputable:r,total:e,loaded:i}),n[1]]},Ix=e=>function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Et.asap(()=>e(...r))};var Aie=js.hasStandardBrowserEnv?((e,n)=>r=>(r=new dE(r,js.origin),e.protocol===r.protocol&&e.host===r.host&&(n||e.port===r.port)))(new dE(js.origin),js.navigator&&/(msie|trident)/i.test(js.navigator.userAgent)):()=>!0,Oie=js.hasStandardBrowserEnv?{write(e,n,r,i,c,u){const f=[e+"="+encodeURIComponent(n)];Et.isNumber(r)&&f.push("expires="+new Date(r).toGMTString()),Et.isString(i)&&f.push("path="+i),Et.isString(c)&&f.push("domain="+c),u===!0&&f.push("secure"),document.cookie=f.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ax(e,n){return e&&!function(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}(n)?function(r,i){return i?r.replace(/\/?\/$/,"")+"/"+i.replace(/^\/+/,""):r}(e,n):n}function Ox(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}const Nx=e=>e instanceof ec?function(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?Ox(Object(i),!0).forEach(function(c){Q(n,c,i[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Ox(Object(i)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(i,c))})}return n}({},e):e;function Md(e,n){n=n||{};const r={};function i(y,T,A,k){return Et.isPlainObject(y)&&Et.isPlainObject(T)?Et.merge.call({caseless:k},y,T):Et.isPlainObject(T)?Et.merge({},T):Et.isArray(T)?T.slice():T}function c(y,T,A,k){return Et.isUndefined(T)?Et.isUndefined(y)?void 0:i(void 0,y,0,k):i(y,T,0,k)}function u(y,T){if(!Et.isUndefined(T))return i(void 0,T)}function f(y,T){return Et.isUndefined(T)?Et.isUndefined(y)?void 0:i(void 0,y):i(void 0,T)}function m(y,T,A){return A in n?i(y,T):A in e?i(void 0,y):void 0}const _={url:u,method:u,data:u,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:m,headers:(y,T,A)=>c(Nx(y),Nx(T),0,!0)};return Et.forEach(Object.keys(Object.assign({},e,n)),function(y){const T=_[y]||c,A=T(e[y],n[y],y);Et.isUndefined(A)&&T!==m||(r[y]=A)}),r}var kx=e=>{const n=Md({},e);let r,{data:i,withXSRFToken:c,xsrfHeaderName:u,xsrfCookieName:f,headers:m,auth:_}=n;if(n.headers=m=ec.from(m),n.url=YM(Ax(n.baseURL,n.url),e.params,e.paramsSerializer),_&&m.set("Authorization","Basic "+btoa((_.username||"")+":"+(_.password?unescape(encodeURIComponent(_.password)):""))),Et.isFormData(i)){if(js.hasStandardBrowserEnv||js.hasStandardBrowserWebWorkerEnv)m.setContentType(void 0);else if((r=m.getContentType())!==!1){const[y,...T]=r?r.split(";").map(A=>es(A).call(A)).filter(Boolean):[];m.setContentType([y||"multipart/form-data",...T].join("; "))}}if(js.hasStandardBrowserEnv&&(c&&Et.isFunction(c)&&(c=c(n)),c||c!==!1&&Aie(n.url))){const y=u&&f&&Oie.read(f);y&&m.set(u,y)}return n},Nie=typeof XMLHttpRequest<"u"&&function(e){return new bt(function(n,r){const i=kx(e);let c=i.data;const u=ec.from(i.headers).normalize();let f,m,_,y,T,{responseType:A,onUploadProgress:k,onDownloadProgress:P}=i;function q(){y&&y(),T&&T(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let j=new XMLHttpRequest;function H(){if(!j)return;const re=ec.from("getAllResponseHeaders"in j&&j.getAllResponseHeaders());wx(function(ve){n(ve),q()},function(ve){r(ve),q()},{data:A&&A!=="text"&&A!=="json"?j.response:j.responseText,status:j.status,statusText:j.statusText,headers:re,config:e,request:j}),j=null}j.open(i.method.toUpperCase(),i.url,!0),j.timeout=i.timeout,"onloadend"in j?j.onloadend=H:j.onreadystatechange=function(){j&&j.readyState===4&&(j.status!==0||j.responseURL&&j.responseURL.indexOf("file:")===0)&&setTimeout(H)},j.onabort=function(){j&&(r(new or("Request aborted",or.ECONNABORTED,e,j)),j=null)},j.onerror=function(){r(new or("Network Error",or.ERR_NETWORK,e,j)),j=null},j.ontimeout=function(){let re=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const ve=i.transitional||XM;i.timeoutErrorMessage&&(re=i.timeoutErrorMessage),r(new or(re,ve.clarifyTimeoutError?or.ETIMEDOUT:or.ECONNABORTED,e,j)),j=null},c===void 0&&u.setContentType(null),"setRequestHeader"in j&&Et.forEach(u.toJSON(),function(re,ve){j.setRequestHeader(ve,re)}),Et.isUndefined(i.withCredentials)||(j.withCredentials=!!i.withCredentials),A&&A!=="json"&&(j.responseType=i.responseType),P&&([_,T]=xE(P,!0),j.addEventListener("progress",_)),k&&j.upload&&([m,y]=xE(k),j.upload.addEventListener("progress",m),j.upload.addEventListener("loadend",y)),(i.cancelToken||i.signal)&&(f=re=>{j&&(r(!re||re.type?new If(null,e,j):re),j.abort(),j=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const ne=function(re){const ve=/^([-+\w]{1,25})(:?\/\/|:)/.exec(re);return ve&&ve[1]||""}(i.url);ne&&js.protocols.indexOf(ne)===-1?r(new or("Unsupported protocol "+ne+":",or.ERR_BAD_REQUEST,e)):j.send(c||null)})},kie=(e,n)=>{const{length:r}=e=e?e.filter(Boolean):[];if(n||r){let i,c=new AbortController;const u=function(y){if(!i){i=!0,m();const T=y instanceof Error?y:this.reason;c.abort(T instanceof or?T:new If(T instanceof Error?T.message:T))}};let f=n&&setTimeout(()=>{f=null,u(new or("timeout ".concat(n," of ms exceeded"),or.ETIMEDOUT))},n);const m=()=>{e&&(f&&clearTimeout(f),f=null,e.forEach(y=>{y.unsubscribe?y.unsubscribe(u):y.removeEventListener("abort",u)}),e=null)};e.forEach(y=>y.addEventListener("abort",u));const{signal:_}=c;return _.unsubscribe=()=>Et.asap(m),_}},Pie=TD,Die=Dc;rr({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var e=Die.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Lie=Dc,Mie=cf;rr({target:"Promise",stat:!0,forced:!0},{try:function(e){var n=Lie.f(this),r=Mie(e);return(r.error?n.reject:n.resolve)(r.value),n.promise}});var Rw=l(Pie),Px=Tf.f("asyncIterator"),xie=l(Px);function Iw(e,n){this.v=e,this.k=n}function Qm(e){var n,r;function i(u,f){try{var m=e[u](f),_=m.value,y=_ instanceof Iw;Rw.resolve(y?_.v:_).then(function(T){if(y){var A=u==="return"?"return":"next";if(!_.k||T.done)return i(A,T);T=e[A](T).value}c(m.done?"return":"normal",T)},function(T){i("throw",T)})}catch(T){c("throw",T)}}function c(u,f){switch(u){case"return":n.resolve({value:f,done:!0});break;case"throw":n.reject(f);break;default:n.resolve({value:f,done:!1})}(n=n.next)?i(n.key,n.arg):r=null}this._invoke=function(u,f){return new Rw(function(m,_){var y={key:u,arg:f,resolve:m,reject:_,next:null};r?r=r.next=y:(n=r=y,i(u,f))})},typeof e.return!="function"&&(this.return=void 0)}function zi(e){return function(){return new Qm(e.apply(this,arguments))}}function Ln(e){return new Iw(e,0)}function UE(e){var n={},r=!1;function i(c,u){return r=!0,{done:!1,value:new Iw(u=new Rw(function(f){f(e[c](u))}),1)}}return n[Rf!==void 0&&ix||"@@iterator"]=function(){return this},n.next=function(c){return r?(r=!1,c):i("next",c)},typeof e.throw=="function"&&(n.throw=function(c){if(r)throw r=!1,c;return i("throw",c)}),typeof e.return=="function"&&(n.return=function(c){return r?(r=!1,c):i("return",c)}),n}Qm.prototype[typeof Rf=="function"&&xie||"@@asyncIterator"]=function(){return this},Qm.prototype.next=function(e){return this._invoke("next",e)},Qm.prototype.throw=function(e){return this._invoke("throw",e)},Qm.prototype.return=function(e){return this._invoke("return",e)};var Aw=l(Px);function Ow(e){var n,r,i,c=2;for(typeof Symbol<"u"&&(r=Aw,i=Symbol.iterator);c--;){if(r&&(n=e[r])!=null)return n.call(e);if(i&&(n=e[i])!=null)return new VE(n.call(e));r="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function VE(e){function n(r){if(Object(r)!==r)return bt.reject(new TypeError(r+" is not an object."));var i=r.done;return bt.resolve(r.value).then(function(c){return{value:c,done:i}})}return VE=function(r){this.s=r,this.n=r.next},VE.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return i===void 0?bt.resolve({value:r,done:!0}):n(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return i===void 0?bt.reject(r):n(i.apply(this.s,arguments))}},new VE(e)}const Uie=function*(e,n){let r=e.byteLength;if(!n||r<n)return void(yield e);let i,c=0;for(;c<r;)i=c+n,yield e.slice(c,i),c=i},Vie=function(){var e=zi(function*(n,r){var i,c=!1,u=!1;try{for(var f,m=Ow(Fie(n));c=!(f=yield Ln(m.next())).done;c=!1){const _=f.value;yield*UE(Ow(Uie(_,r)))}}catch(_){u=!0,i=_}finally{try{c&&m.return!=null&&(yield Ln(m.return()))}finally{if(u)throw i}}});return function(n,r){return e.apply(this,arguments)}}(),Fie=function(){var e=zi(function*(n){if(n[Aw])return void(yield*UE(Ow(n)));const r=n.getReader();try{for(;;){const{done:i,value:c}=yield Ln(r.read());if(i)break;yield c}}finally{yield Ln(r.cancel())}});return function(n){return e.apply(this,arguments)}}(),Dx=(e,n,r,i)=>{const c=Vie(e,n);let u,f=0,m=_=>{u||(u=!0,i&&i(_))};return new ReadableStream({async pull(_){try{const{done:y,value:T}=await c.next();if(y)return m(),void _.close();let A=T.byteLength;if(r){let k=f+=A;r(k)}_.enqueue(new Uint8Array(T))}catch(y){throw m(y),y}},cancel:_=>(m(_),c.return())},{highWaterMark:2})};function Lx(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Mx(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Lx(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lx(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const FE=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",xx=FE&&typeof ReadableStream=="function",Bie=FE&&(typeof TextEncoder=="function"?(Ux=new TextEncoder,e=>Ux.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ux;const Vx=function(e){try{for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return!!e(...r)}catch{return!1}},jie=xx&&Vx(()=>{let e=!1;const n=new Request(js.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),Nw=xx&&Vx(()=>Et.isReadableStream(new Response("").body)),BE={stream:Nw&&(e=>e.body)};var Fx;FE&&(Fx=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!BE[e]&&(BE[e]=Et.isFunction(Fx[e])?n=>n[e]():(n,r)=>{throw new or("Response type '".concat(e,"' is not supported"),or.ERR_NOT_SUPPORT,r)})}));const $ie=async(e,n)=>{const r=Et.toFiniteNumber(e.getContentLength());return r??(async i=>i==null?0:Et.isBlob(i)?i.size:Et.isSpecCompliantForm(i)?(await new Request(js.origin,{method:"POST",body:i}).arrayBuffer()).byteLength:Et.isArrayBufferView(i)||Et.isArrayBuffer(i)?i.byteLength:(Et.isURLSearchParams(i)&&(i+=""),Et.isString(i)?(await Bie(i)).byteLength:void 0))(n)};var Hie=FE&&(async e=>{let{url:n,method:r,data:i,signal:c,cancelToken:u,timeout:f,onDownloadProgress:m,onUploadProgress:_,responseType:y,headers:T,withCredentials:A="same-origin",fetchOptions:k}=kx(e);y=y?(y+"").toLowerCase():"text";let P,q=kie([c,u&&u.toAbortSignal()],f);const j=q&&q.unsubscribe&&(()=>{q.unsubscribe()});let H;try{if(_&&jie&&r!=="get"&&r!=="head"&&(H=await $ie(T,i))!==0){let ke,we=new Request(n,{method:"POST",body:i,duplex:"half"});if(Et.isFormData(i)&&(ke=we.headers.get("content-type"))&&T.setContentType(ke),we.body){const[Be,lt]=Rx(H,xE(Ix(_)));i=Dx(we.body,65536,Be,lt)}}Et.isString(A)||(A=A?"include":"omit");const ne="credentials"in Request.prototype;P=new Request(n,Mx(Mx({},k),{},{signal:q,method:r.toUpperCase(),headers:T.normalize().toJSON(),body:i,duplex:"half",credentials:ne?A:void 0}));let re=await fetch(P);const ve=Nw&&(y==="stream"||y==="response");if(Nw&&(m||ve&&j)){const ke={};["status","statusText","headers"].forEach(St=>{ke[St]=re[St]});const we=Et.toFiniteNumber(re.headers.get("content-length")),[Be,lt]=m&&Rx(we,xE(Ix(m),!0))||[];re=new Response(Dx(re.body,65536,Be,()=>{lt&&lt(),j&&j()}),ke)}y=y||"text";let Oe=await BE[Et.findKey(BE,y)||"text"](re,e);return!ve&&j&&j(),await new bt((ke,we)=>{wx(ke,we,{data:Oe,headers:ec.from(re.headers),status:re.status,statusText:re.statusText,config:e,request:P})})}catch(ne){throw j&&j(),ne&&ne.name==="TypeError"&&/fetch/i.test(ne.message)?Object.assign(new or("Network Error",or.ERR_NETWORK,e,P),{cause:ne.cause||ne}):or.from(ne,ne&&ne.code,e,P)}});const kw={http:null,xhr:Nie,fetch:Hie};Et.forEach(kw,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const Bx=e=>"- ".concat(e),Wie=e=>Et.isFunction(e)||e===null||e===!1;var jx={getAdapter:e=>{e=Et.isArray(e)?e:[e];const{length:n}=e;let r,i;const c={};for(let u=0;u<n;u++){let f;if(r=e[u],i=r,!Wie(r)&&(i=kw[(f=String(r)).toLowerCase()],i===void 0))throw new or("Unknown adapter '".concat(f,"'"));if(i)break;c[f||"#"+u]=i}if(!i){const u=Object.entries(c).map(f=>{let[m,_]=f;return"adapter ".concat(m," ")+(_===!1?"is not supported by the environment":"is not available in the build")});throw new or("There is no suitable adapter to dispatch the request "+(n?u.length>1?`since :
`+u.map(Bx).join(`
`):" "+Bx(u[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i},adapters:kw};function Pw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new If(null,e)}function $x(e){return Pw(e),e.headers=ec.from(e.headers),e.data=ww.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),jx.getAdapter(e.adapter||Tw.adapter)(e).then(function(n){return Pw(e),n.data=ww.call(e,e.transformResponse,n),n.headers=ec.from(n.headers),n},function(n){return Cx(n)||(Pw(e),n&&n.response&&(n.response.data=ww.call(e,e.transformResponse,n.response),n.response.headers=ec.from(n.response.headers))),bt.reject(n)})}const Hx="1.7.9",jE={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{jE[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const Wx={};jE.transitional=function(e,n,r){function i(c,u){return"[Axios v"+Hx+"] Transitional option '"+c+"'"+u+(r?". "+r:"")}return(c,u,f)=>{if(e===!1)throw new or(i(u," has been removed"+(n?" in "+n:"")),or.ERR_DEPRECATED);return n&&!Wx[u]&&(Wx[u]=!0,console.warn(i(u," has been deprecated since v"+n+" and will be removed in the near future"))),!e||e(c,u,f)}},jE.spelling=function(e){return(n,r)=>(console.warn("".concat(r," is likely a misspelling of ").concat(e)),!0)};var $E={assertOptions:function(e,n,r){if(typeof e!="object")throw new or("options must be an object",or.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let c=i.length;for(;c-- >0;){const u=i[c],f=n[u];if(f){const m=e[u],_=m===void 0||f(m,u,e);if(_!==!0)throw new or("option "+u+" must be "+_,or.ERR_BAD_OPTION_VALUE)}else if(r!==!0)throw new or("Unknown option "+u,or.ERR_BAD_OPTION)}},validators:jE};const xc=$E.validators;let HE=class{constructor(e){this.defaults=e,this.interceptors={request:new qM,response:new qM}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const c=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?c&&!String(r.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+c):r.stack=c}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{}).url=e:n=e||{},n=Md(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:c}=n;r!==void 0&&$E.assertOptions(r,{silentJSONParsing:xc.transitional(xc.boolean),forcedJSONParsing:xc.transitional(xc.boolean),clarifyTimeoutError:xc.transitional(xc.boolean)},!1),i!=null&&(Et.isFunction(i)?n.paramsSerializer={serialize:i}:$E.assertOptions(i,{encode:xc.function,serialize:xc.function},!0)),$E.assertOptions(n,{baseUrl:xc.spelling("baseURL"),withXsrfToken:xc.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let u=c&&Et.merge(c.common,c[n.method]);c&&Et.forEach(["delete","get","head","post","put","patch","common"],P=>{delete c[P]}),n.headers=ec.concat(u,c);const f=[];let m=!0;this.interceptors.request.forEach(function(P){typeof P.runWhen=="function"&&P.runWhen(n)===!1||(m=m&&P.synchronous,f.unshift(P.fulfilled,P.rejected))});const _=[];let y;this.interceptors.response.forEach(function(P){_.push(P.fulfilled,P.rejected)});let T,A=0;if(!m){const P=[$x.bind(this),void 0];for(P.unshift.apply(P,f),P.push.apply(P,_),T=P.length,y=bt.resolve(n);A<T;)y=y.then(P[A++],P[A++]);return y}T=f.length;let k=n;for(A=0;A<T;){const P=f[A++],q=f[A++];try{k=P(k)}catch(j){q.call(this,j);break}}try{y=$x.call(this,k)}catch(P){return bt.reject(P)}for(A=0,T=_.length;A<T;)y=y.then(_[A++],_[A++]);return y}getUri(e){return YM(Ax((e=Md(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}};Et.forEach(["delete","get","head","options"],function(e){HE.prototype[e]=function(n,r){return this.request(Md(r||{},{method:e,url:n,data:(r||{}).data}))}}),Et.forEach(["post","put","patch"],function(e){function n(r){return function(i,c,u){return this.request(Md(u||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:c}))}}HE.prototype[e]=n(),HE.prototype[e+"Form"]=n(!0)});var WE=HE;class Dw{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let r;this.promise=new bt(function(c){r=c});const i=this;this.promise.then(c=>{if(!i._listeners)return;let u=i._listeners.length;for(;u-- >0;)i._listeners[u](c);i._listeners=null}),this.promise.then=c=>{let u;const f=new bt(m=>{i.subscribe(m),u=m}).then(c);return f.cancel=function(){i.unsubscribe(u)},f},n(function(c,u,f){i.reason||(i.reason=new If(c,u,f),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){this.reason?n(this.reason):this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const r=this._listeners.indexOf(n);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const n=new AbortController,r=i=>{n.abort(i)};return this.subscribe(r),n.signal.unsubscribe=()=>this.unsubscribe(r),n.signal}static source(){let n;return{token:new Dw(function(i){n=i}),cancel:n}}}var Kie=Dw;const Lw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Lw).forEach(e=>{let[n,r]=e;Lw[r]=n});var Gie=Lw;const Zo=function e(n){const r=new WE(n),i=NM(WE.prototype.request,r);return Et.extend(i,WE.prototype,r,{allOwnKeys:!0}),Et.extend(i,r,null,{allOwnKeys:!0}),i.create=function(c){return e(Md(n,c))},i}(Tw);Zo.Axios=WE,Zo.CanceledError=If,Zo.CancelToken=Kie,Zo.isCancel=Cx,Zo.VERSION=Hx,Zo.toFormData=TE,Zo.AxiosError=or,Zo.Cancel=Zo.CanceledError,Zo.all=function(e){return bt.all(e)},Zo.spread=function(e){return function(n){return e.apply(null,n)}},Zo.isAxiosError=function(e){return Et.isObject(e)&&e.isAxiosError===!0},Zo.mergeConfig=Md,Zo.AxiosHeaders=ec,Zo.formToJSON=e=>Sx(Et.isHTMLForm(e)?new FormData(e):e),Zo.getAdapter=jx.getAdapter,Zo.HttpStatusCode=Gie,Zo.default=Zo;var Is=Zo;const zie=()=>{};function ev(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:zie};return e.promise=new bt((n,r)=>{e.resolve=i=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,n(i),e.value=i)},e.reject=i=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,r(i))}}),e}const KE=new Map,GE=new Map,Uc=new Map;let yo=function(e){return e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot",e}({}),jn=function(e){return e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger",e}({});const Kx=new ure;let tc=Kx.getResult(),Mw=null;function Mn(e){if(!Mw){tc=Kx.getResult();const n=function(m){if(m.engine.name==="Blink"&&m.browser.name!=="WeChat")return jn.CHROME;switch(m.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return jn.CHROME;case"Safari":case"Mobile Safari":return jn.SAFARI;case"Edge":return jn.EDGE;case"Firefox":return jn.FIREFOX;case"QQ":case"QQBrowser":return jn.QQ;case"Opera":return jn.OPERA;case"WeChat":return jn.WECHAT;default:return m.browser.name||""}}(tc),r=Gx(tc),i=function(m){return m.os.name==="Windows"?m.os.version?m.os.name+" "+m.os.version:m.os.name:m.os.name||""}(tc),c=tc.os.version,u=Gx(tc,!1),f=tc.device.type;if(!(n&&r&&i&&c))return{name:n,version:r,os:i,osVersion:c,browserVersion:u,deviceType:f};Mw={name:n,version:r,os:i,osVersion:c,browserVersion:u,deviceType:f}}return Mw}function Gx(e){let n,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return n=e.engine.name==="Blink"?e.engine.version||"":e.browser.version||"",r?n.split(".")[0]:n}function zE(){return Mn().os}function zx(){const e=Mn();return"".concat(e.os," ").concat(e.osVersion)}function YE(){const e=Mn();return!!(tc.engine.name==="WebKit"&&e.os===yo.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==jn.SAFARI||vs()&&e.name!==jn.SAFARI)}function Rl(){return Mn().name===jn.CHROME}function Vo(){return Mn().name===jn.SAFARI}function Yx(){return Mn().name===jn.EDGE}function Ur(){return Mn().name===jn.FIREFOX}function vs(){return Mn().os===yo.IOS}function tv(e){const n=Mn();return!(n.name!==jn.CHROME||!n.osVersion)&&Number(n.version)>=e}function qx(e){const n=Mn();return!(n.name!==jn.CHROME||!n.osVersion)&&Number(n.version)<e}function xw(e,n,r){const i=Mn();return!(i.name!==e||!i.osVersion)&&(r?Number(i.version)>=n&&Number(i.version)<=r:Number(i.version)===n)}function Uw(e){const n=Mn();return!(n.name!==jn.EDGE||!n.osVersion)&&Number(n.version)>=e}function Xx(e){const n=Mn();return!(n.name!==jn.SAFARI||!n.osVersion)&&Number(n.version)>=e}function Jx(e,n,r){const i=Mn();if(i.os!==yo.IOS||!i.osVersion)return!1;const c=i.osVersion.split(".");return n&&Number(c[0])===e&&Number(c[1])<n||Number(c[0])<e}function Zx(e,n,r){const i=Mn();if(i.name!==jn.SAFARI||!i.osVersion||!i.browserVersion)return!1;const c=i.browserVersion.split(".");return r?n&&Number(c[0])===e&&Number(c[1])<n||Number(c[0])<e:n?Number(c[0])===e&&Number(c[1])<=n||Number(c[0])<e:Number(c[0])<=e}function Vw(e){const n=Mn();return!(n.name!==jn.OPERA||!n.osVersion)&&Number(n.version)>=e}function Qx(){const e=Mn();if(e.os!==yo.IOS||!e.osVersion)return!1;const n=e.osVersion.split(".");return Number(n[0])<14||Number(n[0])===14&&Number(n[1])<=6}function Af(){const e=Mn();if(e.os!==yo.IOS||!e.osVersion)return!1;const n=e.osVersion.split(".");return Number(n[0])===15}function Fw(){const e=Mn();if(e.os!==yo.IOS||!e.osVersion)return!1;const n=e.osVersion.split(".");return Number(n[0])===16}function eU(){const e=Mn();if(e.os!==yo.IOS||!e.osVersion)return!1;const n=e.osVersion.split(".");return Number(n[0])===15&&Number(n[1])>=1}function Sa(){return Vo()&&navigator.maxTouchPoints>0}function tU(){return Mn().name===jn.WECHAT}function nU(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function Bw(){const e=zE();return function(){const{deviceType:n}=Mn();return n==="mobile"||n==="tablet"}()||e===yo.ANDROID||e===yo.IOS||e===yo.HARMONY_OS}function Il(){const e=Mn();return e.name!==jn.EDGE&&e.name!==jn.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function qE(){return zE()===yo.ANDROID}function nv(){const e=Mn();return qE()&&(e.name===jn.CHROME||e.name===jn.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function rU(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Nt(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?rU(Object(r),!0).forEach(function(i){un(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rU(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function un(e,n,r){return(n=function(i){var c=function(u,f){if(typeof u!="object"||u===null)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var _=m.call(u,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(i);return typeof c=="symbol"?c:String(c)}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}let oe=function(e){return e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",e}({}),$e=class extends Error{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;super(n),un(this,"code",void 0),un(this,"message",void 0),un(this,"data",void 0),un(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(n),this.data=r}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",n=arguments.length>1?arguments[1]:void 0;return e==="error"&&(n||console).error(this.toString()),e==="warning"&&(n||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function Al(e,n){if(typeof e!="boolean")throw new $e(oe.INVALID_PARAMS,"Invalid ".concat(n,": The value is of the boolean type."))}function vo(e,n,r){if(!gt(r).call(r,e))throw new $e(oe.INVALID_PARAMS,"".concat(n," can only be set as ").concat(JSON.stringify(r)))}function sr(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(e<r||e>i||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(c){return typeof c=="number"&&c%1==0}(e))throw new $e(oe.INVALID_PARAMS,"invalid ".concat(n,": the value range is [").concat(r,", ").concat(i,"]. integer only"))}function jw(e,n){if(typeof e!="number"){if(!(e.min||e.max||e.ideal||e.exact))throw new $e(oe.INVALID_PARAMS,"".concat(n," is not a valid ConstrainLong"));e.min!==void 0&&sr(e.min,"".concat(n,".min"),0,1/0),e.max!==void 0&&sr(e.max,"".concat(n,".max"),1,1/0),e.exact!==void 0&&sr(e.exact,"".concat(n,".exact"),1,1/0),e.ideal!==void 0&&sr(e.ideal,"".concat(n,".ideal"),1,1/0)}else sr(e,n,1,1/0)}function Po(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,c=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(e==null)throw new $e(oe.INVALID_PARAMS,"".concat(n||"param"," cannot be empty"));if(!oU(e,r,i,c))throw new $e(oe.INVALID_PARAMS,"Invalid ".concat(n||"string param",": Length of the string: [").concat(r,",").concat(i,"].").concat(c?" ASCII characters only.":""))}function Ol(e,n){if(!Array.isArray(e))throw new $e(oe.INVALID_PARAMS,"".concat(n," should be an array"))}function Vr(e){return e==null}function oU(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof e=="string"&&e.length<=r&&e.length>=n&&(!i||function(c){if(typeof c!="string")return!1;for(let u=0;u<c.length;u+=1){const f=c.charCodeAt(u);if(f<0||f>255)return!1}return!0}(e))}var rv=function(e){return e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE",e}(rv||{}),$w=function(e){return e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",e}($w||{});const sU=new class{constructor(){un(this,"_clientSize",null),un(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),un(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),un(this,"getStyle",e=>window.getComputedStyle(e,null)),un(this,"checkCssVisibleProperty",e=>{var n;let r=!0;const i=this.getStyle(e),{display:c,visibility:u,opacity:f,filter:m}=i;return(c==="none"||gt(n=["hidden","collapse"]).call(n,u)||Number(f)<.1)&&(r=!1),!!r&&(m&&m.split(" ").filter(_=>{var y;const T=_.split("(")[0];return gt(y=["brightness","blur","opacity"]).call(y,T)}).map(_=>{const[y,T]=_.split(/\(|\)/);return[y,Number(T.match(/^[0-9\.]+/))]}).forEach(_=>{const[y,T]=_;switch(y){case"brightness":(T<.1||T>3)&&(r=!1);break;case"blur":T>3&&(r=!1);break;case"opacity":T<.1&&(r=!1)}}),r)}),un(this,"checkPropertyUpToAllParentNodes",(e,n)=>{let r=!0,i=!0;const c=f=>n(f);let u=e;for(;u&&i;)c(u)||(r=!1,i=!1),u=u.parentElement,u||(i=!1);return r}),un(this,"checkActualCssVisibleIncludeInherit",e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty)),un(this,"getSizeAboutClient",e=>{const{width:n,height:r,left:i,right:c,top:u,bottom:f}=e.getBoundingClientRect(),m=this.getClientWidth(),_=this.getClientHeight();return{width:n,height:r,left:i,right:c,top:u,bottom:f,clientWidth:m,clientHeight:_,clientMin:Math.min(m,_)}}),un(this,"checkActualSize",()=>{const{width:e,height:n,clientMin:r}=this._clientSize;return this.checkSizeIsVisible(e,n,r)}),un(this,"elementFromPoint",(e,n)=>document.elementFromPoint?document.elementFromPoint(e,n):null),un(this,"checkCoverForAPoint",(e,n,r)=>{const i=this.elementFromPoint(e,n);return i!==null&&i!==r}),un(this,"getPointPositionList",()=>{const{width:e,height:n,left:r,top:i}=this._clientSize,c=e/6,u=n/6,f=[],m=10**6;for(let _=0;_<5;_++)for(let y=0;y<5;y++){const T=(r*m+(_===0?.1:_===4?(c*_*m-1e5)/m:c*_)*m)/m,A=(i*m+(y===0?.1:y===4?(u*y*m-1e5)/m:u*y)*m)/m;f.push({x:T,y:A})}return[...f]}),un(this,"checkElementCover",e=>this.getPointPositionList().map(n=>this.checkCoverForAPoint(n.x,n.y,e)).filter(n=>!!n).length>6),un(this,"checkSizeIsVisible",(e,n,r)=>(e>50||r/e<=10)&&(n>50||r/n<=10)),un(this,"checkSizeOfPartInClient",()=>{const{left:e,right:n,top:r,bottom:i,clientHeight:c,clientWidth:u,clientMin:f}=this._clientSize;let m,_,y,T;if(e<0)m=0;else{if(!(e<u))return!1;m=e}if(n<0)return!1;if(_=n<u?n:u,r<0)y=0;else{if(!(r<c))return!1;y=r}if(i<0)return!1;T=i<c?i:c;const A=_-m,k=T-y;return this.checkSizeIsVisible(A,k,f)}),un(this,"returnHiddenResult",e=>(this._clientSize=null,{visible:!1,reason:e})),un(this,"checkOneElementVisible",e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(rv.COVERED);{const n=this.checkActualSize(),r=this.checkSizeOfPartInClient();return n&&!r?this.returnHiddenResult(rv.POSITION):n?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(rv.SIZE)}}return this.returnHiddenResult(rv.STYLE)}return this.returnHiddenResult($w.UNMOUNTED)}return this.returnHiddenResult($w.INVALID_HTML_ELEMENT)}),un(this,"checkElementIsMountedOnDom",e=>this.checkPropertyUpToAllParentNodes(e,n=>n.nodeName.toUpperCase()!=="HTML"?n.parentElement!==null:!!document.documentElement))}};function Hw(e){return new TextEncoder().encode(e)}const iU=function(e,n){const r=new Uint8Array(e.byteLength+n.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(n),e.byteLength),r},Ww=async e=>function(n,r){let i="";return new Uint8Array(n).forEach(c=>{i+=c.toString(r).padStart(2,"0")}),i}(await crypto.subtle.digest("SHA-256",Hw(e)),16);let Dr=class{constructor(){un(this,"_events",{}),un(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map(n=>n.listener):[]}on(e,n){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,n)===-1&&r.push({listener:n,once:!1})}once(e,n){this._events[e]||(this._events[e]=[]);const r=this._events[e];this._indexOfListener(r,n)===-1&&r.push({listener:n,once:!0})}off(e,n){if(!this._events[e])return;const r=this._events[e],i=this._indexOfListener(r,n);i!==-1&&r.splice(i,1),this._events[e].length===0&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const n=this._events[e].map(u=>u);for(var r=arguments.length,i=new Array(r>1?r-1:0),c=1;c<r;c++)i[c-1]=arguments[c];for(let u=0;u<n.length;u+=1){const f=n[u];f.once&&this.off(e,f.listener),f.listener.apply(this,i||[])}}safeEmit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];[...this._events[e]||[]].forEach(c=>{c.once&&this.off(e,c.listener);try{c.listener.apply(this,r)}catch(u){console.error("safeEmit event:".concat(e," error ").concat(u==null?void 0:u.toString()))}})}_indexOfListener(e,n){let r=e.length;for(;r--;)if(e[r].listener===n)return r;return-1}},ov=null;function aU(){if(ov)return ov;if(window.electron)return ov=window.electron;if(!window.require)return null;try{return ov=window.require("electron"),ov}catch{return null}}let oo=function(e){return e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.PRELOAD="PRELOAD",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload",e.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",e}({}),Fr=function(e){return e.TRACER="tracer",e}({});function cU(e){return sr(e.timeout,"config.timeout",0,1e5),sr(e.timeoutFactor,"config.timeoutFactor",0,100,!1),sr(e.maxRetryCount,"config.maxRetryConfig",0,1/0),sr(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let Yie=function(e){return e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",e}({}),Yn=function(e){return e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.FALLBACK="FALLBACK",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE",e}({});function sv(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach(n=>{if(!n.urls)throw Error()})}catch{return!1}return!0}function lU(e){return Po(e.turnServerURL,"turnServerURL"),Po(e.username,"username"),Po(e.password,"password"),e.udpport&&sr(e.udpport,"udpport",1,99999,!0),e.forceturn&&Al(e.forceturn,"forceturn"),e.security&&Al(e.security,"security"),e.tcpport&&sr(e.tcpport,"tcpport",1,99999,!0),!0}function Kw(e){return e.level!==void 0&&vo(e.level,"level",[1,2,3]),e.delay!==void 0&&sr(e.delay,"delay",0,3e3,!0),!0}let Rn=function(e){return e.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",e.AUDIO_METADATA="audio-metadata",e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",e}({}),Fo=function(e){return e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK",e.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",e}({}),si=function(e){return e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({}),Of=function(e){return e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE",e}({});function Bo(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),c=2;c<r;c++)i[c-2]=arguments[c];return e.getListeners(n).length===0?bt.reject(new $e(oe.UNEXPECTED_ERROR,"can not emit promise")):new bt((u,f)=>{e.emit(n,...i,u,f)})}function ur(e,n){if(e.getListeners(n).length===0)return bt.resolve();for(var r=arguments.length,i=new Array(r>2?r-2:0),c=2;c<r;c++)i[c-2]=arguments[c];return Bo(e,n,...i)}function wi(e,n){if(e.getListeners(n).length===0)return null;for(var r=arguments.length,i=new Array(r>2?r-2:0),c=2;c<r;c++)i[c-2]=arguments[c];return iv(e,n,...i)}function iv(e,n){let r=null,i=null;for(var c=arguments.length,u=new Array(c>2?c-2:0),f=2;f<c;f++)u[f-2]=arguments[f];if(e.emit(n,...u,m=>{r=m},m=>{i=m}),i!==null)throw i;if(r===null)throw new $e(oe.UNEXPECTED_ERROR,"handler is not sync");return r}const Qr=new class extends Dr{set networkState(e){this.emit(Of.NETWORK_STATE_CHANGE,e,this._networkState),e===si.ONLINE?this.emit(Of.ONLINE):e===si.OFFLINE&&(this.onlineWaiter=new bt(n=>{this.once(Of.ONLINE,()=>{this.onlineWaiter=void 0,n(si.ONLINE)})}),this.emit(Of.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===si.ONLINE}constructor(){super(),un(this,"_moduleName","network-indicator"),un(this,"_networkState",si.ONLINE),un(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=si.ONLINE}),window.addEventListener("offline",()=>{this.networkState=si.OFFLINE})}};function XE(e,n){const r=e.indexOf(n);r!==-1&&e.splice(r,1)}function Nf(e){const n=[];return e.forEach(r=>{n.indexOf(r)===-1&&n.push(r)}),n}function JE(e){bt!==void 0?bt.resolve().then(e):setTimeout(e,0)}function Br(e){return JSON.parse(JSON.stringify(e))}function xd(e){try{return Br(e)}catch{return e}}const uU={};function wu(e,n){uU[n]||(uU[n]=!0,e())}function Ud(e){const n=window.atob(e),r=new Uint8Array(new ArrayBuffer(n.length));for(let i=0;i<n.length;i+=1)r[i]=n.charCodeAt(i);return r}function Ru(e){let n="";for(let r=0;r<e.length;r+=1)n+=String.fromCharCode(e[r]);return window.btoa(n)}function dU(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,r=new TextEncoder().encode(e);if(r.length>n)r=r.slice(0,n);else if(r.length<n){const i=new Uint8Array(n);i.set(r),r=i}return r}function hU(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=qa(n).call(n,(f,m)=>f+m.length,0),c=new Uint8Array(new ArrayBuffer(i));let u=0;return n.forEach(f=>{c.set(f,u),u+=f.length}),c}function Vc(e){return window.TextEncoder?new TextEncoder().encode(e).length:e.length}function fU(e){let n=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&e.realFormData&&(e=e.realFormData),e.forEach(r=>{n+=typeof r=="string"?Vc(r):r.size}),n+138}function qie(e){const n=new $e(oe.TIMEOUT,"timeout");return new bt((r,i)=>{window.setTimeout(()=>i(n),e)})}function Do(e){return new bt(n=>{window.setTimeout(n,e)})}function dr(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,n=arguments.length>1?arguments[1]:void 0;const r=Math.random().toString(16).substr(2,e).toLowerCase();return r.length===e?"".concat(n).concat(r):"".concat(n).concat(r)+dr(e-r.length,"")}function Vd(){return dr(32,"").toUpperCase()}const ZE=()=>{},pU=new class{constructor(){un(this,"fnMap",new Map)}throttleByKey(e,n,r,i){for(var c=arguments.length,u=new Array(c>4?c-4:0),f=4;f<c;f++)u[f-4]=arguments[f];if(this.fnMap.has(n)){const m=this.fnMap.get(n);if(m.threshold!==r){m.fn(...m.args),clearTimeout(m.timer);const _=window.setTimeout(()=>{const y=this.fnMap.get(n);y&&y.fn(...y.args),this.fnMap.delete(n)},r);this.fnMap.set(n,{fn:e,threshold:r,timer:_,args:u,skipFn:i})}else m.skipFn&&m.skipFn(...m.args),this.fnMap.set(n,Nt(Nt({},m),{},{fn:e,args:u,skipFn:i}))}else{const m=window.setTimeout(()=>{const _=this.fnMap.get(n);_&&_.fn(..._.args),this.fnMap.delete(n)},r);this.fnMap.set(n,{fn:e,threshold:r,timer:m,args:u,skipFn:i})}}},mU=pU.throttleByKey.bind(pU);function vU(e){return typeof e=="object"&&e!==null&&!(e instanceof RegExp)}function Gw(e,n){if(!vU(e)||!vU(n)||Array.isArray(e)&&!Array.isArray(n)||!Array.isArray(e)&&Array.isArray(n))return n;if(Array.isArray(n)&&Array.isArray(e)){const r=[...e];for(let i=0;i<n.length;i++)r[i]=Gw(e[i],n[i]);return r}{const r=Nt({},e);for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(Object.prototype.hasOwnProperty.call(e,i)?r[i]=Gw(e[i],n[i]):r[i]=n[i]);return r}}function gU(e,n){let r=[0];if(r=new Array(n).fill(0),e===0)return r;let i=0;for(;e>0&&(r[i]=255&e,e>>=8,i++,i!==n););return r}function zw(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function _U(e){const n="0123456789abcdef";function r(ve){let Oe,ke="";for(Oe=0;Oe<=3;Oe++)ke+=n.charAt(ve>>8*Oe+4&15)+n.charAt(ve>>8*Oe&15);return ke}function i(ve,Oe){const ke=(65535&ve)+(65535&Oe);return(ve>>16)+(Oe>>16)+(ke>>16)<<16|65535&ke}function c(ve,Oe,ke,we,Be,lt){return i(function(St,At){return St<<At|St>>>32-At}(i(i(Oe,ve),i(we,lt)),Be),ke)}function u(ve,Oe,ke,we,Be,lt,St){return c(Oe&ke|~Oe&we,ve,Oe,Be,lt,St)}function f(ve,Oe,ke,we,Be,lt,St){return c(Oe&we|ke&~we,ve,Oe,Be,lt,St)}function m(ve,Oe,ke,we,Be,lt,St){return c(Oe^ke^we,ve,Oe,Be,lt,St)}function _(ve,Oe,ke,we,Be,lt,St){return c(ke^(Oe|~we),ve,Oe,Be,lt,St)}const y=function(ve){let Oe;const ke=1+(ve.length+8>>6),we=new Array(16*ke);for(Oe=0;Oe<16*ke;Oe++)we[Oe]=0;for(Oe=0;Oe<ve.length;Oe++)we[Oe>>2]|=ve.charCodeAt(Oe)<<Oe%4*8;return we[Oe>>2]|=128<<Oe%4*8,we[16*ke-2]=8*ve.length,we}(e);let T,A,k,P,q,j=1732584193,H=-271733879,ne=-1732584194,re=271733878;for(T=0;T<y.length;T+=16)A=j,k=H,P=ne,q=re,j=u(j,H,ne,re,y[T+0],7,-680876936),re=u(re,j,H,ne,y[T+1],12,-389564586),ne=u(ne,re,j,H,y[T+2],17,606105819),H=u(H,ne,re,j,y[T+3],22,-1044525330),j=u(j,H,ne,re,y[T+4],7,-176418897),re=u(re,j,H,ne,y[T+5],12,1200080426),ne=u(ne,re,j,H,y[T+6],17,-1473231341),H=u(H,ne,re,j,y[T+7],22,-45705983),j=u(j,H,ne,re,y[T+8],7,1770035416),re=u(re,j,H,ne,y[T+9],12,-1958414417),ne=u(ne,re,j,H,y[T+10],17,-42063),H=u(H,ne,re,j,y[T+11],22,-1990404162),j=u(j,H,ne,re,y[T+12],7,1804603682),re=u(re,j,H,ne,y[T+13],12,-40341101),ne=u(ne,re,j,H,y[T+14],17,-1502002290),H=u(H,ne,re,j,y[T+15],22,1236535329),j=f(j,H,ne,re,y[T+1],5,-165796510),re=f(re,j,H,ne,y[T+6],9,-1069501632),ne=f(ne,re,j,H,y[T+11],14,643717713),H=f(H,ne,re,j,y[T+0],20,-373897302),j=f(j,H,ne,re,y[T+5],5,-701558691),re=f(re,j,H,ne,y[T+10],9,38016083),ne=f(ne,re,j,H,y[T+15],14,-660478335),H=f(H,ne,re,j,y[T+4],20,-405537848),j=f(j,H,ne,re,y[T+9],5,568446438),re=f(re,j,H,ne,y[T+14],9,-1019803690),ne=f(ne,re,j,H,y[T+3],14,-187363961),H=f(H,ne,re,j,y[T+8],20,1163531501),j=f(j,H,ne,re,y[T+13],5,-1444681467),re=f(re,j,H,ne,y[T+2],9,-51403784),ne=f(ne,re,j,H,y[T+7],14,1735328473),H=f(H,ne,re,j,y[T+12],20,-1926607734),j=m(j,H,ne,re,y[T+5],4,-378558),re=m(re,j,H,ne,y[T+8],11,-2022574463),ne=m(ne,re,j,H,y[T+11],16,1839030562),H=m(H,ne,re,j,y[T+14],23,-35309556),j=m(j,H,ne,re,y[T+1],4,-1530992060),re=m(re,j,H,ne,y[T+4],11,1272893353),ne=m(ne,re,j,H,y[T+7],16,-155497632),H=m(H,ne,re,j,y[T+10],23,-1094730640),j=m(j,H,ne,re,y[T+13],4,681279174),re=m(re,j,H,ne,y[T+0],11,-358537222),ne=m(ne,re,j,H,y[T+3],16,-722521979),H=m(H,ne,re,j,y[T+6],23,76029189),j=m(j,H,ne,re,y[T+9],4,-640364487),re=m(re,j,H,ne,y[T+12],11,-421815835),ne=m(ne,re,j,H,y[T+15],16,530742520),H=m(H,ne,re,j,y[T+2],23,-995338651),j=_(j,H,ne,re,y[T+0],6,-198630844),re=_(re,j,H,ne,y[T+7],10,1126891415),ne=_(ne,re,j,H,y[T+14],15,-1416354905),H=_(H,ne,re,j,y[T+5],21,-57434055),j=_(j,H,ne,re,y[T+12],6,1700485571),re=_(re,j,H,ne,y[T+3],10,-1894986606),ne=_(ne,re,j,H,y[T+10],15,-1051523),H=_(H,ne,re,j,y[T+1],21,-2054922799),j=_(j,H,ne,re,y[T+8],6,1873313359),re=_(re,j,H,ne,y[T+15],10,-30611744),ne=_(ne,re,j,H,y[T+6],15,-1560198380),H=_(H,ne,re,j,y[T+13],21,1309151649),j=_(j,H,ne,re,y[T+4],6,-145523070),re=_(re,j,H,ne,y[T+11],10,-1120210379),ne=_(ne,re,j,H,y[T+2],15,718787259),H=_(H,ne,re,j,y[T+9],21,-343485551),j=i(j,A),H=i(H,k),ne=i(ne,P),re=i(re,q);return r(j)+r(H)+r(ne)+r(re)}let Xie=1,EU=console,Ko=class{static setLogger(e){EU=e}constructor(e,n){un(this,"id",void 0),un(this,"lockingPromise",bt.resolve()),un(this,"locks",0),un(this,"name",""),un(this,"lockId",void 0),this.lockId=Xie++,e&&(this.name=e),n&&(this.id=n),this.logger("created")}logger(e,n){const r=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),i=e==="created"?"is ".concat(e,"."):"is ".concat(e,", current queue ").concat(this.locks,". ").concat(n??"");EU.debug("".concat(r," ").concat(i))}setId(e){this.id=e}get isLocked(){return this.locks>0}lock(e){let n;this.locks+=1,this.logger("locked",e);const r=new bt(c=>{n=()=>{this.locks-=1,this.logger("unlocked",e),c()}}),i=this.lockingPromise.then(()=>n);return this.lockingPromise=this.lockingPromise.then(()=>r),i}};function kf(e,n){return function(r,i,c){const u=c.value;if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return c.value=async function(){const f=this[n];if(!f)throw new Error("mutex property key ".concat(n," doesn't exist on ").concat(e));const m=await f.lock("From ".concat(e,".").concat(i));try{for(var _=arguments.length,y=new Array(_),T=0;T<_;T++)y[T]=arguments[T];return await u.apply(this,y)}finally{m()}},c}}const so={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function Yw(e,n){const r=Math.floor(n.timeout*Math.pow(n.timeoutFactor,e));return Math.min(n.maxRetryTimeout,r)}function nc(e,n,r,i){const c=Object.assign({},so,i);let u=c.timeout;const f=async()=>{await function(y){return new bt(T=>{window.setTimeout(T,y)})}(u),u*=c.timeoutFactor,u=Math.min(c.maxRetryTimeout,u)};let m=!1;const _=new bt(async(y,T)=>{n=n||(()=>!1),r=r||(()=>!0);for(let A=0;A<c.maxRetryCount;A+=1){if(m)return T(new $e(oe.OPERATION_ABORTED));try{const k=await e();if(!n(k,A)||A+1===c.maxRetryCount)return y(k);await f()}catch(k){if(!r(k,A)||A+1===c.maxRetryCount)return T(k);await f()}}});return _.cancel=()=>m=!0,_}let QE,yU=class{constructor(e){un(this,"input",[]),un(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return this.input.length===0?0:qa(e=this.input).call(e,(n,r)=>n+r)/this.input.length}},ey=0,qw=0;function Xw(e,n,r,i){return new bt((c,u)=>{n.responseType=n.responseType||"json",n.data&&!r?(n.data=JSON.stringify(n.data),ey+=Vc(n.data)):r&&(n.data.size?ey+=n.data.size:n.data instanceof FormData?ey+=fU(n.data):ey+=Vc(JSON.stringify(n.data))),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.method="POST",n.url=e,Is.request(n).then(f=>{typeof f.data=="string"?qw+=Vc(f.data):f.data instanceof ArrayBuffer||f.data instanceof Uint8Array?qw+=f.data.byteLength:qw+=Vc(JSON.stringify(f.data)),c(f.data)}).catch(f=>{Is.isCancel(f)?u(new $e(oe.OPERATION_ABORTED,"cancel token canceled")):f.code==="ECONNABORTED"?u(new $e(oe.NETWORK_TIMEOUT,f.message)):f.response?u(new $e(oe.NETWORK_RESPONSE_ERROR,f.response.status)):u(new $e(oe.NETWORK_ERROR,f.message))})})}async function Jie(e,n){const r=new Blob([n.data],{type:"buffer"});return await Xw(e,Nt(Nt({},n),{},{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0)}const bU=()=>window.isSecureContext!==void 0;function Ta(e){if(Array.isArray(e))return e.map(r=>r);if(!SU(e))return e;const n={};for(const r in e){const i=e[r];SU(i)||Array.isArray(i)?n[r]=Ta(i):n[r]=i}return n}function SU(e){return!(typeof e!="object"||Array.isArray(e)||!e)}let Jw=class{constructor(e){un(this,"input",[]),un(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const Fc={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},av={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Fc,remoteCandidate:Fc},updateInterval:0},TU={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},CU={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},wU={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},RU={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0};let Zw=class{constructor(e,n){un(this,"onFirstVideoReceived",void 0),un(this,"onFirstVideoDecoded",void 0),un(this,"onFirstAudioReceived",void 0),un(this,"onFirstVideoDecodedTimeout",void 0),un(this,"onFirstAudioDecoded",void 0),un(this,"onSelectedLocalCandidateChanged",void 0),un(this,"onSelectedRemoteCandidateChanged",void 0),un(this,"videoIsReady",!1),un(this,"videoIsReady2",{}),un(this,"pc",void 0),un(this,"options",void 0),un(this,"intervalTimer",void 0),un(this,"stats",Ta(av)),un(this,"isFirstVideoReceived",{}),un(this,"isFirstVideoDecoded",{}),un(this,"isFirstAudioReceived",{}),un(this,"isFirstAudioDecoded",{}),un(this,"isFirstVideoDecodedTimeout",{}),un(this,"lossRateWindowStats",[]),this.pc=e,this.options=n,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new bt(e=>{e({local:Nt({},Fc),remote:Nt({},Fc)})})}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,n){this.videoIsReady2[e]=n}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const n=this.lossRateWindowStats.length,r=["videoSend","audioSend","videoRecv","audioRecv"];let i=0,c=0,u=0,f=0;for(const m of r)e[m].forEach((_,y)=>{if(!this.lossRateWindowStats[n-1][m][y]||!this.lossRateWindowStats[0][m][y])return;const T=this.lossRateWindowStats[n-1][m][y].packets-this.lossRateWindowStats[0][m][y].packets,A=this.lossRateWindowStats[n-1][m][y].packetsLost-this.lossRateWindowStats[0][m][y].packetsLost;m==="videoSend"||m==="audioSend"?(i+=T,u+=A):(c+=T,f+=A),Number.isNaN(T)||Number.isNaN(T)?_.packetLostRate=0:_.packetLostRate=T<=0||A<=0?0:A/(T+A)});e.sendPacketLossRate=i<=0||u<=0?0:u/(i+u),e.recvPacketLossRate=c<=0||f<=0?0:f/(c+f)}},Zie=class extends Zw{constructor(){super(...arguments),un(this,"_stats",av),un(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),n=this.statsResponsesToObjects(e);this._stats=Ta(av);const r=n.filter(c=>c.type==="ssrc");this.processSSRCStats(r);const i=n.find(c=>c.type==="VideoBwe");i&&this.processBandwidthStats(i),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach(n=>{var r;const i=gt(r=n.id).call(r,"send");switch("".concat(n.mediaType,"_").concat(i?"send":"recv")){case"video_send":{const c=Ta(CU);c.codec=n.googCodecName,c.adaptionChangeReason="none",n.googCpuLimitedResolution&&(c.adaptionChangeReason="cpu"),n.googBandwidthLimitedResolution&&(c.adaptionChangeReason="bandwidth"),c.avgEncodeMs=Number(n.googAvgEncodeMs),c.inputFrame={width:Number(n.googFrameWidthInput)||Number(n.googFrameWidthSent),height:Number(n.googFrameHeightInput)||Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},c.sentFrame={width:Number(n.googFrameWidthSent),height:Number(n.googFrameHeightSent),frameRate:Number(n.googFrameRateInput)},c.firsCount=Number(n.googFirReceived),c.nacksCount=Number(n.googNacksReceived),c.plisCount=Number(n.googPlisReceived),c.frameCount=Number(n.framesEncoded),c.bytes=Number(n.bytesSent),c.packets=Number(n.packetsSent),c.packetsLost=Number(n.packetsLost),c.ssrc=Number(n.ssrc),c.rttMs=Number(n.googRtt||0),this._stats.videoSend.push(c),this._stats.rtt=c.rttMs;break}case"video_recv":{const c=Ta(TU),u=this.lastDecodeVideoReceiverStats.get(Number(n.ssrc));if(c.codec=n.googCodecName,c.targetDelayMs=Number(n.googTargetDelayMs),c.renderDelayMs=Number(n.googRenderDelayMs),c.currentDelayMs=Number(n.googCurrentDelayMs),c.minPlayoutDelayMs=Number(n.googMinPlayoutDelayMs),c.decodeMs=Number(n.googDecodeMs),c.maxDecodeMs=Number(n.googMaxDecodeMs),c.receivedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateReceived)},c.decodedFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateDecoded)},c.decodeFrameRate=Number(n.googFrameRateDecoded),c.outputFrame={width:Number(n.googFrameWidthReceived),height:Number(n.googFrameHeightReceived),frameRate:Number(n.googFrameRateOutput)},c.jitterBufferMs=Number(n.googJitterBufferMs),c.firsCount=Number(n.googFirsSent),c.nacksCount=Number(n.googNacksSent),c.plisCount=Number(n.googPlisSent),c.framesDecodeCount=Number(n.framesDecoded),c.bytes=Number(n.bytesReceived),c.packets=Number(n.packetsReceived),c.packetsLost=Number(n.packetsLost),c.ssrc=Number(n.ssrc),c.packets>0&&!this.isFirstVideoReceived[c.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(c.ssrc),this.isFirstVideoReceived[c.ssrc]=!0),c.framesDecodeCount>0&&!this.isFirstVideoDecoded[c.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(c.ssrc,c.decodedFrame.width,c.decodedFrame.height),this.isFirstVideoDecoded[c.ssrc]=!0),u){const f=u.stats,m=Date.now()-u.lts;c.framesDecodeFreezeTime=f.framesDecodeFreezeTime,c.framesDecodeInterval=f.framesDecodeInterval,c.framesDecodeCount>f.framesDecodeCount&&this.isFirstVideoDecoded[c.ssrc]?(u.lts=Date.now(),c.framesDecodeInterval=m,c.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(n.ssrc,10))?c.framesDecodeFreezeTime+=c.framesDecodeInterval:this.setVideoIsReady2(parseInt(n.ssrc,10),!0))):c.framesDecodeCount<u.stats.framesDecodeCount&&(c.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(c.ssrc,{stats:Nt({},c),lts:Date.now()}),this._stats.videoRecv.push(c);break}case"audio_recv":{const c=Ta(RU);c.codec=n.googCodecName,c.outputLevel=Math.abs(Number(n.audioOutputLevel))/32767,c.decodingCNG=Number(n.googDecodingCNG),c.decodingCTN=Number(n.googDecodingCTN),c.decodingCTSG=Number(n.googDecodingCTSG),c.decodingNormal=Number(n.googDecodingNormal),c.decodingPLC=Number(n.googDecodingPLC),c.decodingPLCCNG=Number(n.googDecodingPLCCNG),c.expandRate=Number(n.googExpandRate),c.accelerateRate=Number(n.googAccelerateRate),c.preemptiveExpandRate=Number(n.googPreemptiveExpandRate),c.secondaryDecodedRate=Number(n.googSecondaryDecodedRate),c.speechExpandRate=Number(n.googSpeechExpandRate),c.preferredJitterBufferMs=Number(n.googPreferredJitterBufferMs),c.jitterBufferMs=Number(n.googJitterBufferMs),c.jitterMs=Number(n.googJitterReceived),c.bytes=Number(n.bytesReceived),c.packets=Number(n.packetsReceived),c.packetsLost=Number(n.packetsLost),c.ssrc=Number(n.ssrc),c.receivedFrames=Number(n.googDecodingCTN)||Number(n.packetsReceived),c.droppedFrames=Number(n.googDecodingPLC)+Number(n.googDecodingPLCCNG)||Number(n.packetsLost),c.receivedFrames>0&&!this.isFirstAudioReceived[c.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(c.ssrc),this.isFirstAudioReceived[c.ssrc]=!0),c.decodingNormal>0&&!this.isFirstAudioDecoded[c.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(c.ssrc),this.isFirstAudioDecoded[c.ssrc]=!0),this._stats.audioRecv.push(c);break}case"audio_send":{const c=Ta(wU);c.codec=n.googCodecName,c.inputLevel=Math.abs(Number(n.audioInputLevel))/32767,c.aecReturnLoss=Number(n.googEchoCancellationReturnLoss||0),c.aecReturnLossEnhancement=Number(n.googEchoCancellationReturnLossEnhancement||0),c.residualEchoLikelihood=Number(n.googResidualEchoLikelihood||0),c.residualEchoLikelihoodRecentMax=Number(n.googResidualEchoLikelihoodRecentMax||0),c.bytes=Number(n.bytesSent),c.packets=Number(n.packetsSent),c.packetsLost=Number(n.packetsLost),c.ssrc=Number(n.ssrc),c.rttMs=Number(n.googRtt||0),this._stats.rtt=c.rttMs,this._stats.audioSend.push(c);break}}})}_getStats(){return new bt((e,n)=>{this.pc.getStats(e,n)})}statsResponsesToObjects(e){const n=[];return e.result().forEach(r=>{const i={id:r.id,timestamp:r.timestamp.valueOf().toString(),type:r.type};r.names().forEach(c=>{i[c]=r.stat(c)}),n.push(i)}),n}},cv=function(e){return e.BANDWIDTH="bandwidth",e.CPU="cpu",e.NONE="none",e.OTHER="other",e}({}),ty=function(e){return e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L1T3_KEY="L1T3_KEY",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY",e}({}),Qw=function(e){return e[e.new=0]="new",e[e.connecting=1]="connecting",e[e.connected=2]="connected",e[e.disconnected=3]="disconnected",e[e.failed=4]="failed",e[e.closed=5]="closed",e}({}),Ri=function(e){return e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver",e}({});var Pf=function(e){return e[e.kNone=1]="kNone",e[e.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",e[e.kBytesToBits=8]="kBytesToBits",e}(Pf||{});function lv(e,n,r,i){let c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Pf.kNone;if(!n)return;const u=Number(n[r]);if(typeof u!="number")return;const f=Number(n[i]);if(typeof f!="number")return;if(!e)return f?u/f*c:void 0;const m=Number(e[r]);if(typeof m!="number")return;const _=Number(e[i]);if(typeof _!="number")return;const y=f-_;return y?(u-m)/y*c:void 0}let IU=class extends Zw{constructor(){super(...arguments),un(this,"_stats",av),un(this,"report",void 0),un(this,"lastDecodeVideoReceiverStats",new Map),un(this,"lastVideoFramesRecv",new Map),un(this,"lastVideoFramesSent",new Map),un(this,"lastVideoFramesDecode",new Map),un(this,"lastVideoFramesOutput",new Map),un(this,"lastVideoJBDelay",new Map),un(this,"lastAudioJBDelay",new Map),un(this,"mediaBytesSent",new Map),un(this,"mediaBytesRetransmit",new Map),un(this,"mediaBytesTargetEncode",new Map),un(this,"lastDecodeAudioReceiverStats",new Map),un(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Ta(av),this.report.forEach(e=>{switch(e.type){case Ri.OUTBOUND:case Ri.INBOUND:{const n=e.mediaType||e.kind,r=!n&&"frameWidth"in e,i=!n&&!("frameWidth"in e);e.type===Ri.OUTBOUND?n==="audio"||i?this.processAudioOutboundStats(e):(n==="video"||r)&&this.processVideoOutboundStats(e):e.type===Ri.INBOUND&&(n==="audio"||i?this.processAudioInboundStats(e):(n==="video"||r)&&this.processVideoInboundStats(e));break}case Ri.TRANSPORT:{const n=this.report.get(e.selectedCandidatePairId);n&&this.processCandidatePairStats(n);break}case Ri.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),n={local:Nt({},Fc),remote:Nt({},Fc)};return e.forEach(r=>{let i;if(r.type===Ri.TRANSPORT&&(i=e.get(r.selectedCandidatePairId)),r.type===Ri.CANDIDATE_PAIR&&r.selected&&(i=r),i){const c=(u,f)=>{u.type=f.type,u.id=f.id,f.address&&(u.address=f.address),f.candidateType&&(u.candidateType=f.candidateType),f.port&&(u.port=f.port),f.priority&&(u.priority=f.priority),f.protocol&&(u.protocol=f.protocol),f.relayProtocol&&(u.relayProtocol=f.relayProtocol)};if(i.localCandidateId){const u=e.get(i.localCandidateId);u&&c(n.local,u)}if(i.remoteCandidateId){const u=e.get(i.remoteCandidateId);u&&c(n.remote,u)}}}),n}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach(n=>{e.currentRoundTripTime&&(n.rttMs=1e3*e.currentRoundTripTime)}),this._stats.audioSend.forEach(n=>{e.currentRoundTripTime&&(n.rttMs=1e3*e.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const n=this.report.get(e.localCandidateId);n&&this.processCandidateStats(n)}if(e.remoteCandidateId){const n=this.report.get(e.remoteCandidateId);n&&this.processCandidateStats(n)}}processCandidateStats(e){let n;e.type===Ri.LOCAL_CANDIDATE&&(n=this._stats.selectedCandidatePair.localCandidate),e.type===Ri.REMOTE_CANDIDATE&&(n=this._stats.selectedCandidatePair.remoteCandidate),n&&(n.type=e.type,n.id=e.id,e.address&&(n.address=e.address),e.candidateType&&(n.candidateType=e.candidateType),e.port&&(n.port=e.port),e.priority&&(n.priority=e.priority),e.protocol&&(n.protocol=e.protocol),e.relayProtocol&&(n.relayProtocol=e.relayProtocol),e.type===Ri.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==n.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Nt({},n),Nt({},this.stats.selectedCandidatePair.localCandidate)),e.type===Ri.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==n.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Nt({},n),Nt({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let n=this._stats.audioRecv.find(i=>i.ssrc===e.ssrc);n||(n=Ta(RU),this._stats.audioRecv.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsReceived,n.packetsLost=e.packetsLost,n.packetsDiscarded=e.packetsDiscarded,n.bytes=e.bytesReceived,n.jitterMs=1e3*e.jitter,n.retransmittedBytesReceived=e.retransmittedBytesReceived,n.retransmittedPacketsReceived=e.retransmittedPacketsReceived,n.totalProcessingDelay=e.totalProcessingDelay,n.jitterBufferEmittedCount=e.jitterBufferEmittedCount;const r=this.lastDecodeAudioReceiverStats.get(n.ssrc);n.avgProcessingDelayMs=lv(r,n,"totalProcessingDelay","jitterBufferEmittedCount",Pf.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(e,e.trackId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),n.receivedFrames||(n.receivedFrames=e.packetsReceived),n.droppedFrames||(n.droppedFrames=e.packetsLost),n.receivedFrames>0&&!this.isFirstAudioReceived[n.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(n.ssrc),this.isFirstAudioReceived[n.ssrc]=!0),n.outputLevel&&n.outputLevel>0&&!this.isFirstAudioDecoded[n.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(n.ssrc),this.isFirstAudioDecoded[n.ssrc]=!0),typeof e.concealedSamples=="number"&&(n.concealedSamples=e.concealedSamples),this.lastDecodeAudioReceiverStats.set(n.ssrc,Nt({},n))}processVideoInboundStats(e){let n=this._stats.videoRecv.find(f=>f.ssrc===e.ssrc);n||(n=Ta(TU),this._stats.videoRecv.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsReceived,n.packetsLost=e.packetsLost,n.bytes=e.bytesReceived,n.firsCount=e.firCount,n.nacksCount=e.nackCount,n.plisCount=e.pliCount,n.framesDecodeCount=e.framesDecoded,n.framesDroppedCount=e.framesDropped,n.totalInterFrameDelay=e.totalInterFrameDelay,n.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay,n.totalFreezesDuration=e.totalFreezesDuration,n.totalProcessingDelay=e.totalProcessingDelay,n.packetsDiscarded=e.packetsDiscarded,n.framesAssembledFromMultiplePackets=e.framesAssembledFromMultiplePackets,n.totalAssemblyTime=e.totalAssemblyTime,n.keyFramesDecoded=e.keyFramesDecoded,n.retransmittedBytesReceived=e.retransmittedBytesReceived,n.retransmittedPacketsReceived=e.retransmittedPacketsReceived;const r=this.lastDecodeVideoReceiverStats.get(n.ssrc),i=this.lastVideoFramesDecode.get(n.ssrc),c=this.lastVideoFramesOutput.get(n.ssrc),u=Date.now();if(n.framesDecodeCount>0&&!this.isFirstVideoDecoded[n.ssrc]){const f=n.decodedFrame?n.decodedFrame.width:0,m=n.decodedFrame?n.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(n.ssrc,f,m),this.isFirstVideoDecoded[n.ssrc]=!0}if(r){const f=r.stats,m=u-r.lts;n.framesDecodeFreezeTime=f.framesDecodeFreezeTime,n.framesDecodeInterval=f.framesDecodeInterval,!this.isFirstVideoDecoded[n.ssrc]&&m>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[n.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(n.ssrc),this.isFirstVideoDecodedTimeout[n.ssrc]=!0),n.framesDecodeCount>f.framesDecodeCount&&this.isFirstVideoDecoded[n.ssrc]?(r.lts=Date.now(),n.framesDecodeInterval=m,n.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?n.framesDecodeFreezeTime+=n.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):n.framesDecodeCount<f.framesDecodeCount&&(n.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(r.stats.framesDecodeCount>e.framesDecoded?n.qpSumPerFrame=e.qpSum/e.framesDecoded:n.qpSumPerFrame=(e.qpSum-r.qpSum)/(e.framesDecoded-r.stats.framesDecodeCount))}e.totalDecodeTime&&(n.decodeMs=1e3*e.totalDecodeTime,n.avgDecodeMs=lv(r==null?void 0:r.stats,n,"decodeMs","framesDecodeCount")),n.avgProcessingDelayMs=lv(r==null?void 0:r.stats,n,"totalProcessingDelay","framesDecodeCount",Pf.kMillisecondsFromSeconds),n.avgFramesAssembledFromMultiplePacketsMs=lv(r==null?void 0:r.stats,n,"totalAssemblyTime","framesAssembledFromMultiplePackets",Pf.kMillisecondsFromSeconds),n.avgInterFrameDelayMs=lv(r==null?void 0:r.stats,n,"totalInterFrameDelay","framesDecodeCount",Pf.kMillisecondsFromSeconds),i&&u-i.lts>=800?(n.decodeFrameRate=Math.round((n.framesDecodeCount-i.count)/((u-i.lts)/1e3)),this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:u,rate:n.decodeFrameRate})):i?n.decodeFrameRate=i.rate:this.lastVideoFramesDecode.set(n.ssrc,{count:n.framesDecodeCount,lts:u,rate:0}),n.framesDroppedCount&&e.framesReceived&&(c&&u-c.lts>=800?(n.outputFrameRate=Math.round((e.framesReceived-n.framesDroppedCount-c.count)/((u-c.lts)/1e3)),this.lastVideoFramesOutput.set(n.ssrc,{count:e.framesReceived-n.framesDroppedCount,lts:u,rate:Math.max(n.outputFrameRate,0)})):c?n.outputFrameRate=c.rate:this.lastVideoFramesOutput.set(n.ssrc,{count:e.framesReceived-n.framesDroppedCount,lts:u,rate:0})),this.processVideoTrackReceiverStats(e,e.trackId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(n.framesRateFirefox=e.framerateMean),n.packets>0&&!this.isFirstVideoReceived[n.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(n.ssrc),this.isFirstVideoReceived[n.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:Nt({},n),lts:r?r.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let n=this._stats.videoSend.find(i=>i.ssrc===e.ssrc);n||(n=Ta(CU),this._stats.videoSend.push(n));const r=this.mediaBytesSent.get(e.ssrc);if(r)r.add(e.bytesSent);else{const i=new Jw(10);i.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,i)}if(e.retransmittedBytesSent!==void 0){const i=this.mediaBytesRetransmit.get(e.ssrc);if(i)i.add(e.retransmittedBytesSent);else{const c=new Jw(10);c.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,c)}}if(e.totalEncodedBytesTarget){const i=this.mediaBytesTargetEncode.get(e.ssrc);if(i)i.add(e.totalEncodedBytesTarget);else{const c=new Jw(10);c.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,c)}}if(n.ssrc=e.ssrc,n.bytes=e.bytesSent,n.packets=e.packetsSent,n.firsCount=e.firCount,n.nacksCount=e.nackCount,n.plisCount=e.pliCount,n.frameCount=e.framesEncoded,n.adaptionChangeReason=e.qualityLimitationReason,n.scalabilityMode=e.scalabilityMode,n.retransmittedBytesSent=e.retransmittedBytesSent,n.retransmittedPacketsSent=e.retransmittedPacketsSent,n.hugeFramesSent=e.hugeFramesSent,n.keyFramesEncoded=e.keyFramesEncoded,e.totalEncodeTime&&e.framesEncoded){const i=this.lastEncoderMs.get(e.ssrc);if(!i||i.lastFrameCount>e.framesEncoded)n.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const c=e.framesEncoded-i.lastFrameCount,u=e.totalEncodeTime-i.lastEncoderTime;n.avgEncodeMs=1e3*u/c}}if(e.framesEncoded&&e.qpSum){const i=this.lastEncoderMs.get(e.ssrc);!i||i.lastFrameCount>e.framesEncoded?n.qpSumPerFrame=e.qpSum/e.framesEncoded:n.qpSumPerFrame=(e.qpSum-i.lastQpSum)/(e.framesEncoded-i.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,n),this.processVideoTrackSenderStats(e,e.trackId,n),e.remoteId)this.processRemoteInboundStats(e.remoteId,n);else{const i=this.findRemoteStatsId(e.ssrc,Ri.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,n)}}processAudioOutboundStats(e){let n=this._stats.audioSend.find(r=>r.ssrc===e.ssrc);if(n||(n=Ta(wU),this._stats.audioSend.push(n)),n.ssrc=e.ssrc,n.packets=e.packetsSent,n.bytes=e.bytesSent,n.retransmittedBytesSent=e.retransmittedBytesSent,n.retransmittedPacketsSent=e.retransmittedPacketsSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,n),e.codecId&&(n.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,n),e.remoteId)this.processRemoteInboundStats(e.remoteId,n);else{const r=this.findRemoteStatsId(e.ssrc,Ri.REMOTE_INBOUND);r&&this.processRemoteInboundStats(r,n)}}findRemoteStatsId(e,n){var r;const i=Array.from(Ti(r=this.report).call(r)).find(c=>c.type===n&&c.ssrc===e);return i?i.id:null}processVideoMediaSource(e,n){const r=this.report.get(e);r&&r.width&&r.height&&r.framesPerSecond&&(n.inputFrame={width:r.width,height:r.height,frameRate:r.framesPerSecond})}processAudioMediaSource(e,n){const r=this.report.get(e);r&&(n.inputLevel=r.audioLevel)}processVideoTrackSenderStats(e,n,r){var i,c,u,f;const m=n?this.report.get(n):void 0,_=(i=m==null?void 0:m.framesSent)!==null&&i!==void 0?i:e.framesSent;if(typeof _!="number")return;let y=(c=m==null?void 0:m.frameWidth)!==null&&c!==void 0?c:e.frameWidth,T=(u=m==null?void 0:m.frameHeight)!==null&&u!==void 0?u:e.frameHeight,A=(f=m==null?void 0:m.framesPerSecond)!==null&&f!==void 0?f:e.framesPerSecond;if(typeof y=="number"&&typeof T=="number"||(y=0,T=0),A==null){const k=Date.now(),P=this.lastVideoFramesSent.get(r.ssrc);P&&k-P.lts>=800?(A=Math.round((_-P.count)/((k-P.lts)/1e3)),this.lastVideoFramesSent.set(r.ssrc,{count:_,lts:k,rate:A})):P?A=P.rate:this.lastVideoFramesSent.set(r.ssrc,{count:_,lts:k,rate:0})}r.sentFrame={width:y,height:T,frameRate:Math.max(0,A)}}processVideoTrackReceiverStats(e,n,r){var i,c,u,f,m;const _=n?this.report.get(n):void 0,y=(i=_==null?void 0:_.framesReceived)!==null&&i!==void 0?i:e.framesReceived,T=(c=_==null?void 0:_.frameWidth)!==null&&c!==void 0?c:e.frameWidth,A=(u=_==null?void 0:_.frameHeight)!==null&&u!==void 0?u:e.frameHeight,k=(f=_==null?void 0:_.jitterBufferDelay)!==null&&f!==void 0?f:e.jitterBufferDelay,P=(m=_==null?void 0:_.jitterBufferEmittedCount)!==null&&m!==void 0?m:e.jitterBufferEmittedCount;if(typeof y=="number"){const q=this.lastVideoFramesRecv.get(r.ssrc),j=Date.now();r.framesReceivedCount=y;let H=0;q&&j-q.lts>=800?(H=Math.round((y-q.count)/((j-q.lts)/1e3)),this.lastVideoFramesRecv.set(r.ssrc,{count:y,lts:j,rate:H})):q?H=q.rate:this.lastVideoFramesRecv.set(r.ssrc,{count:y,lts:j,rate:0}),r.receivedFrame={width:T||0,height:A||0,frameRate:H||0},r.decodedFrame={width:T||0,height:A||0,frameRate:r.decodeFrameRate||0},r.outputFrame={width:T||0,height:A||0,frameRate:r.outputFrameRate||r.decodeFrameRate||0}}if(k&&P){const q=this.lastVideoJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let j=q.jitterBufferMs;const H=P-q.jitterBufferEmittedCount;H>0&&(j=1e3*(k-q.jitterBufferDelay)/H),r.jitterBufferMs=j,r.currentDelayMs=Math.round(j),this.lastVideoJBDelay.set(r.ssrc,{jitterBufferDelay:k,jitterBufferEmittedCount:P,jitterBufferMs:r.currentDelayMs})}}processAudioTrackSenderStats(e,n,r){var i,c,u,f;const m=n?this.report.get(n):void 0,_=(i=(c=m==null?void 0:m.echoReturnLoss)!==null&&c!==void 0?c:e.echoReturnLoss)!==null&&i!==void 0?i:0,y=(u=(f=m==null?void 0:m.echoReturnLossEnhancement)!==null&&f!==void 0?f:e.echoReturnLossEnhancement)!==null&&u!==void 0?u:0;r.aecReturnLoss=_,r.aecReturnLossEnhancement=y}processAudioTrackReceiverStats(e,n,r){var i,c,u,f,m,_,y;const T=n?this.report.get(n):void 0,A=(i=T==null?void 0:T.removedSamplesForAcceleration)!==null&&i!==void 0?i:e.removedSamplesForAcceleration,k=(c=T==null?void 0:T.totalSamplesReceived)!==null&&c!==void 0?c:e.totalSamplesReceived,P=(u=T==null?void 0:T.jitterBufferDelay)!==null&&u!==void 0?u:e.jitterBufferDelay,q=(f=T==null?void 0:T.jitterBufferEmittedCount)!==null&&f!==void 0?f:e.jitterBufferEmittedCount,j=(m=T==null?void 0:T.audioLevel)!==null&&m!==void 0?m:e==null?void 0:e.audioLevel,H=(_=T==null?void 0:T.totalSamplesDuration)!==null&&_!==void 0?_:e==null?void 0:e.totalSamplesDuration,ne=(y=T==null?void 0:T.concealedSamples)!==null&&y!==void 0?y:e.concealedSamples;if(typeof k=="number"&&(r.totalSamplesReceived=k),A&&k&&(r.accelerateRate=A/k),P&&q){const ve=this.lastAudioJBDelay.get(r.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let Oe=ve.jitterBufferMs;const ke=q-ve.jitterBufferEmittedCount;ke>0&&(Oe=1e3*(P-ve.jitterBufferDelay)/ke),r.jitterBufferMs=Math.round(Oe),this.lastAudioJBDelay.set(r.ssrc,{jitterBufferDelay:P,jitterBufferEmittedCount:q,jitterBufferMs:r.jitterBufferMs})}r.outputLevel=j;let re=1920;H&&k&&(re=k/H/50,r.receivedFrames=Math.round(k/re)),ne&&(r.droppedFrames=Math.round(ne/re))}processRemoteInboundStats(e,n){const r=this.report.get(e);r&&(n.packetsLost=r.packetsLost,r.roundTripTime&&(n.rttMs=1e3*r.roundTripTime),r.jitter&&(n.jitterMs=1e3*r.jitter),r.timestamp&&(n.timestamp=r.timestamp))}getCodecFromCodecStats(e){const n=this.report.get(e);if(!n)return"";const r=n.mimeType.match(/\/(.*)$/);return r&&r[1]?r[1]:""}updateSendBitrate(){let e=0,n=null,r=null;this.mediaBytesSent.forEach(c=>{e+=c.diffMean()}),this.mediaBytesRetransmit.forEach(c=>{n=n===null?c.diffMean():n+c.diffMean()}),this.mediaBytesTargetEncode.forEach(c=>{r=r===null?c.diffMean():r+c.diffMean()});const i=n!==null?e-n:e;this._stats.bitrate={actualEncoded:8*i/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},n!==null&&(this._stats.bitrate.retransmit=8*n/(this.options.updateInterval/1e3)),r!==null&&(this._stats.bitrate.targetEncoded=8*r/(this.options.updateInterval/1e3))}},Qie=class extends Zw{updateStats(){return bt.resolve()}};function eR(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const u=function(){const f=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return f&&f[0]?Number(f[0].split("/")[1]):null}();return u?u<76?new Zie(e,{updateInterval:n,lossRateInterval:r,freezeRateLimit:i,firstVideoDecodedTimeout:c}):new IU(e,{updateInterval:n,lossRateInterval:r,freezeRateLimit:i,firstVideoDecodedTimeout:c}):function(f){if(!window.RTCStatsReport)return!1;const m=f.getStats();return!!(m instanceof bt||function(_){return!!_&&(typeof _=="object"||typeof _=="function")&&typeof _.then=="function"}(m))}(e)?new IU(e,{updateInterval:n,lossRateInterval:r,freezeRateLimit:i,firstVideoDecodedTimeout:c}):new Qie(e,{updateInterval:n,lossRateInterval:r,freezeRateLimit:i,firstVideoDecodedTimeout:c})}const AU="websdk_ng_install_id";function tR(){try{if(de("INSTALL_ID"))return de("INSTALL_ID");let e=window.localStorage.getItem(AU);return e||(e=Vd(),window.localStorage.setItem(AU,e)),tr("INSTALL_ID",e),e}catch{return}}const Yi=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const n=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(n&&n[1]&&n[2]){const r=n[1],i=n[2];return"".concat(r,".").concat(i)}return"4.0.0.999"}("4.23.2"),nR=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let Fd=function(e){return e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn",e}({});const jo=function(){const e="us".concat("erna","me"),n="pa".concat("sswo","rd"),r=["t","s","t"];r.splice(1,0,"e");const i=r.join(""),c=[];for(let m=0;m<6;m++)c.push("1");const u=c.join(""),f={};return f[e]=i,f[n]=u,Object.assign(f,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=jo;const ny={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},rR={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},oR="v4.23.2-0-g1599fdac-dirty(3/4/2025, 5:13:36 PM)",sR={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!1,NEW_TURN_MODE:void 0,NEW_FORCE_TURN:!1},br=Nt(Nt(Nt({},sR),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:rR,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},ny),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""});function tr(e,n,r){var i,c,u;gt(i=Object.keys(br)).call(i,e)&&(!r&&gt(c=Object.keys(rc)).call(c,e)||(br[e]=n,e!=="ENABLE_VIDEO_SEI"&&e!=="ENABLE_AUDIO_TOPN"&&e!=="ENABLE_AUDIO_METADATA"&&e!=="ENABLE_AUDIO_PTS_METADATA"||n!==!0||(br.ENABLE_ENCODED_TRANSFORM=!0,e==="ENABLE_AUDIO_PTS_METADATA"&&(br.ENABLE_AUDIO_METADATA=!0)),e==="USE_NEW_NETWORK_CONFIG"&&n&&(u=!!n,br.USE_NEW_NETWORK_CONFIG=u,u&&(br.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],br.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],br.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],br.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],br.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",br.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",br.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),e==="ENABLE_PRE_SUB"&&n&&(br.ENABLE_INSTANT_VIDEO=!0,br.ENABLE_PREALLOC_PC=!0),e==="ENABLE_SVC"&&n&&(br.ENABLE_AUT_CC=!0),e==="NEW_FORCE_TURN"&&n&&(br.NEW_TURN_MODE||(br.NEW_TURN_MODE=4))))}function de(e){return br[e]}nR||(br.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],br.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],br.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],br.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],br.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],br.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],br.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",br.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",br.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",br.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",br.AREAS=["NORTH_AMERICA","OVERSEA"]);let OU=function(e){return e[e.REALTIME=1]="REALTIME",e}({});const rc={};var In=function(e){return e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",e}(In||{});let ry=function(e){return e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1",e}({});(function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"})({});const NU=128,eae=96,kU=1e3,Df=10;let tae=0;var PU=(()=>{var e={8:(i,c,u)=>{u.r(c),u.d(c,{Parser:()=>St,Printer:()=>Xr,parse:()=>ft,print:()=>xt});const f=`
`,m="".concat("\r").concat(f),_=" ";let y;function T(rt){return rt>="0"&&rt<="9"}function A(rt){return rt>="!"&&rt<="~"}function k(rt){return A(rt)||rt>=""&&rt<=""}function P(rt){return rt==="!"||rt>="#"&&rt<="'"||rt>="*"&&rt<="+"||rt>="-"&&rt<="."||rt>="0"&&rt<="9"||rt>="A"&&rt<="Z"||rt>="^"&&rt<="~"}function q(rt){return rt>="1"&&rt<="9"}function j(rt){return rt>="A"&&rt<="Z"||rt>="a"&&rt<="z"}function H(rt){return rt==="d"||rt==="h"||rt==="m"||rt==="s"}function ne(rt){return rt>""&&rt<"	"||rt>"\v"&&rt<"\f"||rt>""&&rt<""}function re(rt){return j(rt)||T(rt)||rt==="+"||rt==="/"}function ve(rt){return T(rt)||j(rt)||rt==="+"||rt==="/"||rt==="-"||rt==="_"}function Oe(rt){return j(rt)||T(rt)||rt==="+"||rt==="/"}function ke(rt,B){var he=Object.keys(rt);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols(rt);B&&(ye=ye.filter(function(ht){return Object.getOwnPropertyDescriptor(rt,ht).enumerable})),he.push.apply(he,ye)}return he}function we(rt){for(var B=1;B<arguments.length;B++){var he=arguments[B]!=null?arguments[B]:{};B%2?ke(Object(he),!0).forEach(function(ye){Be(rt,ye,he[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rt,Object.getOwnPropertyDescriptors(he)):ke(Object(he)).forEach(function(ye){Object.defineProperty(rt,ye,Object.getOwnPropertyDescriptor(he,ye))})}return rt}function Be(rt,B,he){return B in rt?Object.defineProperty(rt,B,{value:he,enumerable:!0,configurable:!0,writable:!0}):rt[B]=he,rt}(function(rt){rt.VERSION="v",rt.ORIGIN="o",rt.SESSION_NAME="s",rt.INFORMATION="i",rt.URI="u",rt.EMAIL="e",rt.PHONE="p",rt.CONNECTION="c",rt.BANDWIDTH="b",rt.TIME="t",rt.REPEAT="r",rt.ZONE_ADJUSTMENTS="z",rt.KEY="k",rt.ATTRIBUTE="a",rt.MEDIA="m"})(y||(y={}));class lt{consumeText(B,he){let ye=he;for(;ye<B.length;){const ht=B[ye];if(ht==="\0"||ht==="\r"||ht===f)break;ye+=1}if(ye-he==0)throw new Error("Invalid text, at ".concat(B));return ye}consumeUnicastAddress(B,he,ye){return this.consumeTill(B,he,_)}consumeOneOrMore(B,he,ye){let ht=he;for(;ye(B[ht]);)ht++;if(ht-he==0)throw new Error("Invalid rule at ".concat(he,"."));return ht}consumeSpace(B,he){if(B[he]===_)return he+1;throw new Error("Invalid space at ".concat(he,"."))}consumeIP4Address(B,he){let ye=he;for(let ht=0;ht<4;ht++)if(ye=this.consumeDecimalUChar(B,ye),ht!==3){if(B[ye]!==".")throw new Error("Invalid IP4 address.");ye++}return ye}consumeDecimalUChar(B,he){let ye=he;for(let hn=0;hn<3&&T(B[ye]);hn++,ye++);if(ye-he==0)throw new Error("Invalid decimal uchar.");const ht=parseInt(B.slice(he,ye));if(ht>=0&&ht<=255)return ye;throw new Error("Invalid decimal uchar")}consumeIP6Address(B,he){let ye=this.consumeHexpart(B,he);return B[ye]===":"&&(ye+=1,ye=this.consumeIP4Address(B,ye)),ye}consumeHexpart(B,he){let ye=he;if(B[ye]===":"&&B[ye+1]===":"){ye+=2;try{ye=this.consumeHexseq(B,ye)}catch{}return ye}if(ye=this.consumeHexseq(B,ye),B[ye]===":"&&B[ye+1]===":"){ye+=2;try{ye=this.consumeHexseq(B,ye)}catch{}return ye}return ye}consumeHexseq(B,he){let ye=he;for(;ye=this.consumeHex4(B,ye),B[ye]===":"&&B[ye+1]!==":";)ye+=1;return ye}consumeHex4(B,he){let ye=0;for(;ye<4;ye++)if(!((ht=B[he+ye])>="0"&&ht<="9"||ht>="a"&&ht<="f"||ht>="A"&&ht<="F")){if(ye===0)throw new Error("Invalid hex 4");break}var ht;return he+ye}consumeFQDN(B,he){let ye=he;for(;T(B[ye])||j(B[ye])||B[ye]==="-"||B[ye]===".";)ye+=1;if(ye-he<4)throw new Error("Invalid FQDN");return ye}consumeExtnAddr(B,he){return this.consumeOneOrMore(B,he,k)}consumeMulticastAddress(B,he,ye){switch(ye){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(B,he);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(B,he);default:try{return this.consumeFQDN(B,he)}catch{return this.consumeExtnAddr(B,he)}}}consumeIP6MulticastAddress(B,he){const ye=this.consumeHexpart(B,he);return B[ye]==="/"?this.consumeInteger(B,ye+1):ye}consumeIP4MulticastAddress(B,he){let ye=he+3;const ht=B.slice(he,ye),hn=parseInt(ht);if(hn<224||hn>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let ir=0;ir<3;ir++){if(B[ye]!==".")throw new Error("Invalid IP4 multicast address.");ye+=1,ye=this.consumeDecimalUChar(B,ye)}return B[ye]==="/"&&(ye+=1),ye=this.consumeTTL(B,ye),B[ye]==="/"&&(ye=this.consumeInteger(B,ye)),ye}consumeInteger(B,he){if(!q(B[he]))throw new Error("Invalid integer.");for(he+=1;T(B[he]);)he+=1;return he}consumeTTL(B,he){if(B[he]==="0")return he+1;if(!q(B[he]))throw new Error("Invalid TTL.");he+=1;for(let ye=0;ye<2&&T(B[he]);ye++)he+=1;return he}consumeToken(B,he){return this.consumeOneOrMore(B,he,P)}consumeTime(B,he){let ye=he;if(B[ye]==="0")return ye+1;for(q(B[ye])&&(ye+=1);T(B[ye]);)ye++;if(ye-he<10)throw new Error("Invalid time");return ye}consumeAddress(B,he){return this.consumeTill(B,he,_)}consumeTypedTime(B,he){let ye=he;return ye=this.consumeOneOrMore(B,ye,T),H(B[ye])?ye+1:ye}consumeRepeatInterval(B,he){if(!q(B[he]))throw new Error("Invalid repeat interval");for(he+=1;T(B[he]);)he+=1;return H(B[he])&&(he+=1),he}consumePort(B,he){return this.consumeOneOrMore(B,he,T)}consume(B,he,ye){for(let ht=0;ht<ye.length;ht++){if(he+ht>=B.length)throw new Error("consume exceeding value length");if(B[he+ht]!==ye[ht])throw new Error("consume ".concat(ye," failed at ").concat(ht))}return he+ye.length}consumeTill(B,he,ye){let ht=he;for(;ht<B.length&&(typeof ye!="string"||B[ht]!==ye)&&(typeof ye!="function"||!ye(B[ht]));)ht++;return ht}}class St extends lt{constructor(){super(),Be(this,"records",[]),Be(this,"currentLine",0)}parse(B){const he=this.probeEOL(B);this.records=B.split(he).filter(lh=>!!es(lh).call(lh)).map(this.parseLine),this.currentLine=0;const ye=this.parseVersion(),ht=this.parseOrigin(),hn=this.parseSessionName(),ir=this.parseInformation(),To=this.parseUri(),Gs=this.parseEmail(),jl=this.parsePhone(),ch=this.parseConnection(),Gv=this.parseBandWidth(),pb=this.parseTimeFields(),mb=this.parseKey(),na=this.parseSessionAttribute(),Wu=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:ye,origin:ht,sessionName:hn,information:ir,uri:To,emails:Gs,phones:jl,connection:ch,bandwidths:Gv,timeFields:pb,key:mb,attributes:na,mediaDescriptions:Wu}}getCurrentRecord(){const B=this.records[this.currentLine];if(!B)throw new Error("Record doesn't exit.");return B}probeEOL(B){for(let he=0;he<B.length;he++)if(B[he]===f)return B[he-1]==="\r"?m:f;throw new Error("Invalid newline character.")}parseLine(B,he){if(B.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const ye=B[0];if(B[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:ye,value:B.slice(2),line:he,cur:0}}parseSessionAttribute(){const B=new Nn;for(;this.currentLine<this.records.length;){const he=this.getCurrentRecord();if(he.type!==y.ATTRIBUTE)break;const ye={attField:this.extractOneOrMore(he,ht=>P(ht)&&ht!==":"),_cur:0};he.value[he.cur]===":"&&(he.cur+=1,ye.attValue=this.extractOneOrMore(he,ne)),B.parse(ye),this.currentLine++}return B.digest()}parseMediaAttributes(B){const he=new kn(B);for(;this.currentLine<this.records.length;){const ye=this.getCurrentRecord();if(ye.type!==y.ATTRIBUTE)break;const ht={attField:this.extractOneOrMore(ye,hn=>P(hn)&&hn!==":"),_cur:0};ye.value[ye.cur]===":"&&(ye.cur+=1,ht.attValue=this.extractOneOrMore(ye,ne)),he.parse(ht),this.currentLine++}return he.digest()}parseKey(){const B=this.getCurrentRecord();if(B.type===y.KEY){if(B.value==="prompt"||B.value==="clear:"||B.value==="base64:"||B.value==="uri:")return B.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const B=this.getCurrentRecord();if(B.type===y.ZONE_ADJUSTMENTS){const he=[];for(;;)try{const ye=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);let ht=!1;B.value[B.cur]==="-"&&(ht=!0,B.cur+=1);const hn=this.extract(B,this.consumeTypedTime);he.push({time:ye,typedTime:hn,back:ht})}catch{break}if(he.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,he}return[]}parseRepeat(){const B=[];for(;;){const he=this.getCurrentRecord();if(he.type!==y.REPEAT)break;{const ye=this.extract(he,this.consumeRepeatInterval),ht=this.parseTypedTime(he);B.push({repeatInterval:ye,typedTimes:ht}),this.currentLine++}}return B}parseTypedTime(B){const he=[];for(;;)try{this.consumeSpaceForRecord(B),he.push(this.extract(B,this.consumeTypedTime))}catch{break}if(he.length===0)throw new Error("Invalid typed time.");return he}parseTime(){const B=this.getCurrentRecord(),he=this.extract(B,this.consumeTime);this.consumeSpaceForRecord(B);const ye=this.extract(B,this.consumeTime);return this.currentLine++,{startTime:he,stopTime:ye}}parseBandWidth(){const B=[];for(;this.currentLine<this.records.length;){const he=this.getCurrentRecord();if(he.type!==y.BANDWIDTH)break;{const ye=this.extractOneOrMore(he,P);if(he.value[he.cur]!==":")throw new Error("Invalid bandwidth field.");he.cur++;const ht=this.extractOneOrMore(he,T);B.push({bwtype:ye,bandwidth:ht}),this.currentLine++}}return B}parseVersion(){const B=this.getCurrentRecord();if(B.type!==y.VERSION)throw new Error("first sdp record must be version");const he=B.value.slice(0,this.consumeOneOrMore(B.value,0,T));if(he.length!==B.value.length)throw new Error('invalid proto version, "v='.concat(B.value,'"'));return this.currentLine++,he}parseOrigin(){const B=this.getCurrentRecord();if(B.type!==y.ORIGIN)throw new Error("second line of sdp must be origin");const he=this.extractOneOrMore(B,k);this.consumeSpaceForRecord(B);const ye=this.extractOneOrMore(B,T);this.consumeSpaceForRecord(B);const ht=this.extractOneOrMore(B,T);this.consumeSpaceForRecord(B);const hn=this.extractOneOrMore(B,P);this.consumeSpaceForRecord(B);const ir=this.extractOneOrMore(B,P);this.consumeSpaceForRecord(B);const To=this.extract(B,this.consumeUnicastAddress);return this.currentLine++,{username:he,sessId:ye,sessVersion:ht,nettype:hn,addrtype:ir,unicastAddress:To}}parseSessionName(){const B=this.getCurrentRecord();if(B.type===y.SESSION_NAME){const he=this.extract(B,this.consumeText);return this.currentLine++,he}}parseInformation(){const B=this.getCurrentRecord();if(B.type!==y.INFORMATION)return;const he=this.extract(B,this.consumeText);return this.currentLine++,he}parseUri(){const B=this.getCurrentRecord();if(B.type===y.URI)return this.currentLine++,B.value}parseEmail(){const B=[];for(;;){const he=this.getCurrentRecord();if(he.type!==y.EMAIL)break;B.push(he.value),this.currentLine++}return B}parsePhone(){const B=[];for(;;){const he=this.getCurrentRecord();if(he.type!==y.PHONE)break;B.push(he.value),this.currentLine++}return B}parseConnection(){const B=this.getCurrentRecord();if(B.type===y.CONNECTION){const he=this.extractOneOrMore(B,P);this.consumeSpaceForRecord(B);const ye=this.extractOneOrMore(B,P);this.consumeSpaceForRecord(B);const ht=this.extract(B,this.consumeAddress);return this.currentLine++,{nettype:he,addrtype:ye,address:ht}}}parseMedia(){const B=this.getCurrentRecord(),he=this.extract(B,this.consumeToken);this.consumeSpaceForRecord(B);let ye=this.extract(B,this.consumePort);B.value[B.cur]==="/"&&(B.cur+=1,ye+=this.extract(B,this.consumeInteger)),this.consumeSpaceForRecord(B);const ht=[];for(ht.push(this.extract(B,this.consumeToken));B.value[B.cur]==="/";)B.cur+=1,ht.push(this.extract(B,this.consumeToken));if(ht.length===0)throw new Error("Invalid proto");const hn=this.parseFmt(B);return this.currentLine++,{mediaType:he,port:ye,protos:ht,fmts:hn}}parseTimeFields(){const B=[];for(;this.getCurrentRecord().type===y.TIME;){const he=this.parseTime(),ye=this.parseRepeat(),ht=this.parseZone();B.push({time:he,repeats:ye,zones:ht})}return B}parseMediaDescription(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.MEDIA;){const he=this.parseMedia(),ye=this.parseInformation(),ht=this.parseConnections(),hn=this.parseBandWidth(),ir=this.parseKey(),To=this.parseMediaAttributes(he);B.push({media:he,information:ye,connections:ht,bandwidths:hn,key:ir,attributes:To})}return B}parseConnections(){const B=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===y.CONNECTION;)B.push(this.parseConnection());return B}parseFmt(B){const he=[];for(;;)try{this.consumeSpaceForRecord(B),he.push(this.extract(B,this.consumeToken))}catch{break}if(he.length===0)throw new Error("Invalid fmts");return he}extract(B,he){for(var ye=arguments.length,ht=new Array(ye>2?ye-2:0),hn=2;hn<ye;hn++)ht[hn-2]=arguments[hn];const ir=he.call(this,B.value,B.cur,...ht),To=B.value.slice(B.cur,ir);return B.cur=ir,To}extractOneOrMore(B,he){const ye=this.consumeOneOrMore(B.value,B.cur,he),ht=B.value.slice(B.cur,ye);return B.cur=ye,ht}consumeSpaceForRecord(B){if(B.value[B.cur]!==_)throw new Error("Invalid space at ".concat(B.cur,"."));B.cur+=1}}class At extends lt{constructor(){super(...arguments),Be(this,"attributes",void 0),Be(this,"digested",!1)}extractOneOrMore(B,he,ye){const ht=this.consumeOneOrMore(B.attValue,B._cur,he),hn=B.attValue.slice(B._cur,ht),[ir,To]=ye||[];if(typeof ir=="number"&&hn.length<ir)throw new Error("error in length, should be more or equal than ".concat(ir," characters."));if(typeof To=="number"&&hn.length>To)throw new Error("error in length, should be less or equal than ".concat(To," characters."));return B._cur=ht,hn}consumeAttributeSpace(B){if(B.attValue[B._cur]!==_)throw new Error("Invalid space at ".concat(B._cur,"."));B._cur+=1}extract(B,he){if(!B.attValue)throw new Error("Nothing to extract from attValue.");for(var ye=arguments.length,ht=new Array(ye>2?ye-2:0),hn=2;hn<ye;hn++)ht[hn-2]=arguments[hn];const ir=he.call(this,B.attValue,B._cur,...ht),To=B.attValue.slice(B._cur,ir);return B._cur=ir,To}atEnd(B){if(!B.attValue)throw new Error;return B._cur>=B.attValue.length}peekChar(B){if(!B.attValue)throw new Error;return B.attValue[B._cur]}peek(B,he){if(!B.attValue)throw new Error;for(let ye=0;ye<he.length;ye++)if(he[ye]!==B.attValue[B._cur+ye])return!1;return!0}parseIceUfrag(B){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(B,re,[4,256])}parseIcePwd(B){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(B,re,[22,256])}parseIceOptions(B){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const he=[];for(;!this.atEnd(B);){he.push(this.extractOneOrMore(B,re));try{this.consumeAttributeSpace(B)}catch(ye){if(this.atEnd(B))break;throw ye}}this.attributes.iceOptions=he}parseFingerprint(B){const he=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const ye=this.extract(B,this.consumeTill);this.attributes.fingerprints.push({hashFunction:he,fingerprint:ye})}parseExtmap(B){const he=this.extractOneOrMore(B,T);let ye;this.peekChar(B)==="/"&&(this.extract(B,this.consume,"/"),ye=this.extract(B,this.consumeToken)),this.consumeAttributeSpace(B);const ht=this.extract(B,this.consumeTill,_),hn=we(we({entry:parseInt(he,10)},ye&&{direction:ye}),{},{extensionName:ht});this.peekChar(B)===_&&(this.consumeAttributeSpace(B),hn.extensionAttributes=this.extract(B,this.consumeTill)),this.attributes.extmaps.push(hn)}parseSetup(B){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const he=this.extract(B,this.consumeTill);if(he!=="active"&&he!=="passive"&&he!=="actpass"&&he!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=he}}class Nn extends At{constructor(){super(...arguments),Be(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"group":this.parseGroup(B);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"fingerprint":this.parseFingerprint(B);break;case"setup":this.parseSetup(B);break;case"tls-id":this.parseTlsId(B);break;case"identity":this.parseIdentity(B);break;case"extmap":this.parseExtmap(B);break;case"msid-semantic":this.parseMsidSemantic(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(he){throw console.error("parsing session attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),he}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(B){const he=this.extract(B,this.consumeToken),ye=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;)this.consumeAttributeSpace(B),ye.push(this.extract(B,this.consumeToken));this.attributes.groups.push({semantic:he,identificationTag:ye})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(B){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(B,ve)}parseIdentity(B){const he=this.extractOneOrMore(B,Oe),ye=[];for(;!this.atEnd(B)&&this.peekChar(B)===_;){this.consumeAttributeSpace(B);const ht=this.extract(B,this.consumeToken);this.extract(B,this.consume,"=");const hn=this.extractOneOrMore(B,ir=>ir!==_&&ne(ir));ye.push({name:ht,value:hn})}this.attributes.identities.push({assertionValue:he,extensions:ye})}parseMsidSemantic(B){this.peekChar(B)===_&&this.consumeAttributeSpace(B);const he={semantic:this.extract(B,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(B)}catch{break}if(this.peekChar(B)==="*"){this.extract(B,this.consume,"*"),he.applyForAll=!0;break}{const ye=this.extract(B,this.consumeTill,_);he.identifierList.push(ye)}}this.attributes.msidSemantic=he}}class kn extends At{constructor(B){super(),Be(this,"attributes",void 0),B.protos.indexOf("RTP")!==-1||B.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(B){if(this.digested)throw new Error("already digested");try{switch(B.attField){case"extmap":this.parseExtmap(B);break;case"setup":this.parseSetup(B);break;case"ice-ufrag":this.parseIceUfrag(B);break;case"ice-pwd":this.parseIcePwd(B);break;case"ice-options":this.parseIceOptions(B);break;case"candidate":this.parseCandidate(B);break;case"remote-candidate":this.parseRemoteCandidate(B);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(B);break;case"rtpmap":this.parseRtpmap(B);break;case"ptime":this.parsePtime(B);break;case"maxptime":this.parseMaxPtime(B);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(B);break;case"ssrc":this.parseSSRC(B);break;case"fmtp":this.parseFmtp(B);break;case"rtcp-fb":this.parseRtcpFb(B);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(B);break;case"mid":this.parseMid(B);break;case"msid":this.parseMsid(B);break;case"imageattr":this.parseImageAttr(B);break;case"rid":this.parseRid(B);break;case"simulcast":this.parseSimulcast(B);break;case"sctp-port":this.parseSctpPort(B);break;case"max-message-size":this.parseMaxMessageSize(B);break;case"ssrc-group":this.parseSSRCGroup(B);break;default:B.ignored=!0,this.attributes.unrecognized.push(B)}}catch(he){throw console.error("parsing media attribute ".concat(B.attField,' error, "a=').concat(B.attField,":").concat(B.attValue,'"')),he}if(!B.ignored&&B.attValue&&!this.atEnd(B))throw new Error("attribute parsing error")}parseCandidate(B){const he=this.extractOneOrMore(B,re,[1,32]);this.consumeAttributeSpace(B);const ye=this.extractOneOrMore(B,T,[1,5]);this.consumeAttributeSpace(B);const ht=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const hn=this.extractOneOrMore(B,T,[1,10]);this.consumeAttributeSpace(B);const ir=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const To=this.extract(B,this.consumePort);this.consumeAttributeSpace(B),this.extract(B,this.consume,"typ"),this.consumeAttributeSpace(B);const Gs={foundation:he,componentId:ye,transport:ht,priority:hn,connectionAddress:ir,port:To,type:this.extract(B,this.consumeToken),extension:{}};for(this.peek(B," raddr")&&(this.extract(B,this.consume," raddr"),this.consumeAttributeSpace(B),Gs.relAddr=this.extract(B,this.consumeAddress)),this.peek(B," rport")&&(this.extract(B,this.consume," rport"),this.consumeAttributeSpace(B),Gs.relPort=this.extract(B,this.consumePort));this.peekChar(B)===_;){this.consumeAttributeSpace(B);const jl=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B),Gs.extension[jl]=this.extractOneOrMore(B,A)}this.attributes.candidates.push(Gs)}parseRemoteCandidate(B){const he=[];for(;;){const ye=this.extractOneOrMore(B,T,[1,5]);this.consumeAttributeSpace(B);const ht=this.extract(B,this.consumeAddress);this.consumeAttributeSpace(B);const hn=this.extract(B,this.consumePort);he.push({componentId:ye,connectionAddress:ht,port:hn});try{this.consumeAttributeSpace(B)}catch{break}}this.attributes.remoteCandidatesList.push(he)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(B){const he=this.extract(B,this.consumeToken);this.consumeAttributeSpace(B);const ye=this.extract(B,this.consumeTill,"/");this.extract(B,this.consume,"/");const ht={encodingName:ye,clockRate:this.extractOneOrMore(B,T)};this.atEnd(B)||this.peekChar(B)!=="/"||(this.extract(B,this.consume,"/"),ht.encodingParameters=parseInt(this.extract(B,this.consumeTill),10));const hn=this.attributes.payloads.find(ir=>ir.payloadType===parseInt(he,10));hn?hn.rtpMap=ht:this.attributes.payloads.push({payloadType:parseInt(he,10),rtpMap:ht,rtcpFeedbacks:[]})}parsePtime(B){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(B,this.consumeTill)}parseMaxPtime(B){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(B,this.consumeTill)}parseDirection(B){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=B.attField}parseSSRC(B){const he=this.extractOneOrMore(B,T);this.consumeAttributeSpace(B);const ye=this.extract(B,this.consumeTill,":");let ht;this.peekChar(B)===":"&&(this.extract(B,this.consume,":"),ht=this.extract(B,this.consumeTill));const hn=this.attributes.ssrcs.find(ir=>ir.ssrcId===parseInt(he,10));hn?hn.attributes[ye]=ht:this.attributes.ssrcs.push({ssrcId:parseInt(he,10),attributes:{[ye]:ht}})}parseFmtp(B){const he=this.extract(B,this.consumeTill,_);this.consumeAttributeSpace(B);const ye=this.extract(B,this.consumeTill),ht={};ye.split(";").forEach(ir=>{let[To,Gs]=ir.split("=");To=es(To).call(To);const jl=typeof Gs=="string"?es(Gs).call(Gs):null;typeof To=="string"&&To.length>0&&(ht[To]=jl)});const hn=this.attributes.payloads.find(ir=>ir.payloadType===parseInt(he,10));hn?hn.fmtp={parameters:ht}:this.attributes.payloads.push({payloadType:parseInt(he,10),rtcpFeedbacks:[],fmtp:{parameters:ht}})}parseFmtParameters(B){const he={},ye=this.extract(B,this.consumeTill,"=");B._cur++;const ht=this.extract(B,this.consumeTill,";");for(he[ye]=ht;B.attValue[B._cur]===";";){const hn=this.extract(B,this.consumeTill,"=");B._cur++;const ir=this.extract(B,this.consumeTill,";");he[hn]=ir}return he}parseRtcpFb(B){let he="";he=this.peekChar(B)==="*"?this.extract(B,this.consume,"*"):this.extract(B,this.consumeTill,_),this.consumeAttributeSpace(B);const ye=this.extract(B,this.consumeTill,_);let ht;if(ye==="trr-int")ht={type:ye,interval:this.extract(B,this.consumeTill)};else{const hn={type:ye};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),hn.parameter=this.extract(B,this.consumeToken),this.peekChar(B)===_&&(hn.additional=this.extract(B,this.consumeTill))),ht=hn}if(he==="*")this.attributes.rtcpFeedbackWildcards.push(ht);else{const hn=this.attributes.payloads.find(ir=>ir.payloadType===parseInt(he,10));hn?hn.rtcpFeedbacks.push(ht):this.attributes.payloads.push({payloadType:parseInt(he,10),rtcpFeedbacks:[ht]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(B){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const he={port:this.extract(B,this.consumePort)};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),he.netType=this.extractOneOrMore(B,P),this.consumeAttributeSpace(B),he.addressType=this.extractOneOrMore(B,P),this.consumeAttributeSpace(B),he.address=this.extract(B,this.consumeAddress)),this.attributes.rtcp=he}parseMsid(B){const he={id:this.extractOneOrMore(B,P,[1,64])};this.peekChar(B)===_&&(this.consumeAttributeSpace(B),he.appdata=this.extractOneOrMore(B,P,[1,64])),this.attributes.msids.push(he)}parseImageAttr(B){this.attributes.imageattr.push(B.attValue)}parseRid(B){const he=this.extractOneOrMore(B,ht=>j(ht)||T(ht)||ht==="_"||ht==="-");this.consumeAttributeSpace(B);const ye={id:he,direction:this.extract(B,this.consumeToken),params:[]};if(this.peekChar(B)===_){if(this.consumeAttributeSpace(B),this.peek(B,"pt=")){this.extract(B,this.consume,"pt=");const ht=[];for(;;){const hn=this.extract(B,this.consumeToken);ht.push(hn);try{this.extract(B,this.consume,",")}catch{break}}ye.payloads=ht,this.peekChar(B)===_&&this.extract(B,this.consume,_)}for(;;){const ht=this.extract(B,this.consumeToken);switch(ht){case"depend":{const hn={type:ht,rids:this.extract(B,this.consume,"=").split(",")};ye.params.push(hn);break}default:{const hn={type:ht};this.peekChar(B)==="="&&(this.extract(B,this.consume,"="),hn.val=this.extract(B,this.consumeTill,";")),ye.params.push(hn)}}try{this.extract(B,this.consume,";")}catch{break}}}this.attributes.rids.push(ye)}parseSimulcast(B){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=B.attValue,this.extract(B,this.consumeTill)}parseSctpPort(B){this.attributes.sctpPort=this.extractOneOrMore(B,T,[1,5])}parseMaxMessageSize(B){this.attributes.maxMessageSize=this.extractOneOrMore(B,T,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(B){this.attributes.mid=this.extract(B,this.consumeToken)}parseSSRCGroup(B){const he=this.extract(B,this.consumeToken),ye=[];for(;;)try{this.consumeAttributeSpace(B);const ht=this.extract(B,this.consumeInteger);ye.push(parseInt(ht,10))}catch{break}this.attributes.ssrcGroups.push({semantic:he,ssrcIds:ye})}}function fr(rt,B,he){return B in rt?Object.defineProperty(rt,B,{value:he,enumerable:!0,configurable:!0,writable:!0}):rt[B]=he,rt}class Xr{constructor(){fr(this,"eol",m)}print(B,he){let ye="";return he&&(this.eol=he),ye+=this.printVersion(B.version),ye+=this.printOrigin(B.origin),ye+=this.printSessionName(B.sessionName),ye+=this.printInformation(B.information),ye+=this.printUri(B.uri),ye+=this.printEmail(B.emails),ye+=this.printPhone(B.phones),ye+=this.printConnection(B.connection),ye+=this.printBandwidth(B.bandwidths),ye+=this.printTimeFields(B.timeFields),ye+=this.printKey(B.key),ye+=this.printSessionAttributes(B.attributes),ye+=this.printMediaDescription(B.mediaDescriptions),ye}printVersion(B){return"v=".concat(B).concat(this.eol)}printOrigin(B){return"o=".concat(B.username," ").concat(B.sessId," ").concat(B.sessVersion," ").concat(B.nettype," ").concat(B.addrtype," ").concat(B.unicastAddress).concat(this.eol)}printSessionName(B){return B?"s=".concat(B).concat(this.eol):""}printInformation(B){return B?"i=".concat(B).concat(this.eol):""}printUri(B){return B?"u=".concat(B).concat(this.eol):""}printEmail(B){let he="";for(const ye of B)he+="e=".concat(ye).concat(this.eol);return he}printPhone(B){let he="";for(const ye of B)he+="e=".concat(ye).concat(this.eol);return he}printConnection(B){return B?"c=".concat(B.nettype," ").concat(B.addrtype," ").concat(B.address).concat(this.eol):""}printBandwidth(B){let he="";for(const ye of B)he+="b=".concat(ye.bwtype,":").concat(ye.bandwidth).concat(this.eol);return he}printTimeFields(B){let he="";for(const ye of B){he+="t=".concat(ye.time.startTime," ").concat(ye.time.startTime).concat(this.eol);for(const ht of ye.repeats)he+="r=".concat(ht.repeatInterval," ").concat(ht.typedTimes.join(" ")).concat(this.eol);ye.zoneAdjustments&&(he+="z=",he+="z=".concat(ye.zoneAdjustments.map(ht=>"".concat(ht.time," ").concat(ht.back?"-":""," ").concat(ht.typedTime)).join(" ")).concat(this.eol),he+=this.eol)}return he}printKey(B){return B?"k=".concat(B).concat(this.eol):""}printAttributes(B){let he="";for(const ye of B)he+="a=".concat(ye.attField).concat(ye.attValue?":".concat(ye.attValue):"").concat(this.eol);return he}printMediaDescription(B){let he="";for(const ye of B)he+=this.printMedia(ye.media),he+=this.printInformation(ye.information),he+=this.printConnections(ye.connections),he+=this.printBandwidth(ye.bandwidths),he+=this.printKey(ye.key),he+=this.printMediaAttributes(ye);return he}printConnections(B){let he="";for(const ye of B)he+=this.printConnection(ye);return he}printMedia(B){return"m=".concat(B.mediaType," ").concat(B.port," ").concat(B.protos.join("/")," ").concat(B.fmts.join(" ")).concat(this.eol)}printSessionAttributes(B){return new Ds(this.eol).print(B)}printMediaAttributes(B){return new Ze(this.eol).print(B)}}class Wr{constructor(B){fr(this,"eol",void 0),this.eol=B}printIceUfrag(B){return B===void 0?"":"a=ice-ufrag:".concat(B).concat(this.eol)}printIcePwd(B){return B===void 0?"":"a=ice-pwd:".concat(B).concat(this.eol)}printIceOptions(B){return B===void 0?"":"a=ice-options:".concat(B.join(_)).concat(this.eol)}printFingerprints(B){return B.length>0?B.map(he=>"a=fingerprint:".concat(he.hashFunction).concat(_).concat(he.fingerprint)).join(this.eol)+this.eol:""}printExtmap(B){return B.map(he=>"a=extmap:".concat(he.entry).concat(he.direction?"/".concat(he.direction):"").concat(_).concat(he.extensionName).concat(he.extensionAttributes?"".concat(_).concat(he.extensionAttributes):"").concat(this.eol)).join("")}printSetup(B){return B===void 0?"":"a=setup:".concat(B).concat(this.eol)}printUnrecognized(B){return B.map(he=>"a=".concat(he.attField).concat(he.attValue?":".concat(he.attValue):"").concat(this.eol)).join("")}}class Ds extends Wr{print(B){let he="";return he+=this.printGroups(B.groups),he+=this.printMsidSemantic(B.msidSemantic),he+=this.printIceLite(B.iceLite),he+=this.printIceUfrag(B.iceUfrag),he+=this.printIcePwd(B.icePwd),he+=this.printIceOptions(B.iceOptions),he+=this.printFingerprints(B.fingerprints),he+=this.printSetup(B.setup),he+=this.printTlsId(B.tlsId),he+=this.printIdentity(B.identities),he+=this.printExtmap(B.extmaps),he+=this.printUnrecognized(B.unrecognized),he}printGroups(B){let he="";return B.length>0&&(he+=B.map(ye=>"a=group:".concat(ye.semantic).concat(ye.identificationTag.map(ht=>"".concat(_).concat(ht)).join("")).concat(this.eol)).join("")),he}printIceLite(B){return B===void 0?"":"a=ice-lite"+this.eol}printTlsId(B){return B?"a=tls-id:".concat(B).concat(this.eol):""}printIdentity(B){return B.length===0?"":B.map(he=>"a=identity:".concat(he.assertionValue).concat(he.extensions.map(ye=>"".concat(_).concat(ye.name).concat(ye.value?"=".concat(ye.value):"")))).join(this.eol)+this.eol}printMsidSemantic(B){if(!B)return"";let he="a=msid-semantic:".concat(B.semantic);return B.applyForAll?he+="".concat(_,"*"):B.identifierList.length>0&&(he+=B.identifierList.map(ye=>"".concat(_).concat(ye))),he+this.eol}}class Ze extends Wr{print(B){const he=B.attributes;let ye="";return ye+=this.printRTCP(he.rtcp),ye+=this.printIceUfrag(he.iceUfrag),ye+=this.printIcePwd(he.icePwd),ye+=this.printIceOptions(he.iceOptions),ye+=this.printCandidates(he.candidates),ye+=this.printRemoteCandidatesList(he.remoteCandidatesList),ye+=this.printEndOfCandidates(he.endOfCandidates),ye+=this.printFingerprints(he.fingerprints),ye+=this.printSetup(he.setup),ye+=this.printMid(he.mid),ye+=this.printExtmap(he.extmaps),ye+=this.printRTPRelated(he),ye+=this.printPtime(he.ptime),ye+=this.printMaxPtime(he.maxPtime),ye+=this.printDirection(he.direction),ye+=this.printSSRCGroups(he.ssrcGroups),ye+=this.printSSRC(he.ssrcs),ye+=this.printRTCPMux(he.rtcpMux),ye+=this.printRTCPMuxOnly(he.rtcpMuxOnly),ye+=this.printRTCPRsize(he.rtcpRsize),ye+=this.printMSId(he.msids),ye+=this.printImageattr(he.imageattr),ye+=this.printRid(he.rids),ye+=this.printSimulcast(he.simulcast),ye+=this.printSCTPPort(he.sctpPort),ye+=this.printMaxMessageSize(he.maxMessageSize),ye+=this.printUnrecognized(he.unrecognized),ye}printCandidates(B){return B.map(he=>"a=candidate:".concat(he.foundation).concat(_).concat(he.componentId).concat(_).concat(he.transport).concat(_).concat(he.priority).concat(_).concat(he.connectionAddress).concat(_).concat(he.port).concat(_,"typ").concat(_).concat(he.type).concat(he.relAddr?"".concat(_,"raddr").concat(_).concat(he.relAddr):"").concat(he.relPort?"".concat(_,"rport").concat(_).concat(he.relPort):"").concat(Object.keys(he.extension).map(ye=>"".concat(_).concat(ye).concat(_).concat(he.extension[ye])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(B){return B.map(he=>"a=remote-candidates:".concat(he.join(_)).concat(this.eol)).join("")}printEndOfCandidates(B){return B===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(B){if(!B.payloads)return"";const he=B.payloads;let ye="";ye+=B.rtcpFeedbackWildcards.map(ht=>this.printRTCPFeedback("*",ht)).join("");for(const ht of he)ye+=this.printRtpMap(ht.payloadType,ht.rtpMap),ye+=this.printFmtp(ht.payloadType,ht.fmtp),ye+=ht.rtcpFeedbacks.map(hn=>this.printRTCPFeedback(ht.payloadType,hn)).join("");return ye}printFmtp(B,he){if(!he)return"";const ye=Object.keys(he.parameters);return ye.length===1&&he.parameters[ye[0]]===null?"a=fmtp:".concat(B).concat(_).concat(ye[0]).concat(this.eol):"a=fmtp:".concat(B).concat(_).concat(Object.keys(he.parameters).map(ht=>"".concat(ht,"=").concat(he.parameters[ht])).join(";")).concat(this.eol)}printRtpMap(B,he){return he?"a=rtpmap:".concat(B).concat(_).concat(he.encodingName,"/").concat(he.clockRate).concat(he.encodingParameters?"/".concat(he.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(B,he){let ye="a=rtcp-fb:".concat(B).concat(_),ht=he;return ht.type==="trr-int"?ye+="ttr-int".concat(_).concat(ht.interval):(ye+="".concat(ht.type),ht.parameter&&(ye+="".concat(_).concat(ht.parameter),ht.additional&&(ye+="".concat(_).concat(ht.additional)))),ye+this.eol}printPtime(B){return B===void 0?"":"a=ptime:".concat(B).concat(this.eol)}printMaxPtime(B){return B===void 0?"":"a=maxptime:".concat(B).concat(this.eol)}printDirection(B){return B===void 0?"":"a=".concat(B).concat(this.eol)}printSSRC(B){return B.map(he=>Object.keys(he.attributes).map(ye=>"a=ssrc:".concat(he.ssrcId.toString(10)).concat(_).concat(ye).concat(he.attributes[ye]?":".concat(he.attributes[ye]):"").concat(this.eol)).join("")).join("")}printRTCPMux(B){return B===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(B){return B===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(B){return B===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(B){if(B===void 0)return"";let he="a=rtcp:".concat(B.port);return B.netType&&(he+="".concat(_).concat(B.netType)),B.addressType&&(he+="".concat(_).concat(B.addressType)),B.address&&(he+="".concat(_).concat(B.address)),he+this.eol}printMSId(B){return B.map(he=>"a=msid:".concat(he.id).concat(he.appdata?"".concat(_).concat(he.appdata):"").concat(this.eol)).join("")}printImageattr(B){return B.map(he=>"a=imageattr:".concat(he).concat(this.eol)).join("")}printRid(B){return B.map(he=>{let ye="a=rid:".concat(he.id).concat(_).concat(he.direction);return he.payloads&&(ye+="".concat(_,"pt=").concat(he.payloads.join(","))),he.params.length>0&&(ye+="".concat(_).concat(he.params.map(ht=>ht.type==="depend"?"depend=".concat(ht.rids.join(",")):"".concat(ht.type,"=").concat(ht.val)).join(";"))),ye+this.eol}).join("")}printSimulcast(B){return B===void 0?"":"a=simulcast:".concat(B).concat(this.eol)}printSCTPPort(B){return B===void 0?"":"a=sctp-port:".concat(B).concat(this.eol)}printMaxMessageSize(B){return B===void 0?"":"a=max-message-size:".concat(B).concat(this.eol)}printMid(B){return B===void 0?"":"a=mid:".concat(B).concat(this.eol)}printSSRCGroups(B){return B.map(he=>"a=ssrc-group:".concat(he.semantic).concat(he.ssrcIds.map(ye=>"".concat(_).concat(ye.toString(10))).join("")).concat(this.eol)).join("")}}function ft(rt){return new St().parse(rt)}function xt(rt,B){return new Xr().print(rt,B)}}},n={};function r(i){if(n[i])return n[i].exports;var c=n[i]={exports:{}};return e[i](c,c.exports,r),c.exports}return r.d=(i,c)=>{for(var u in c)r.o(c,u)&&!r.o(i,u)&&Object.defineProperty(i,u,{enumerable:!0,get:c[u]})},r.o=(i,c)=>Object.prototype.hasOwnProperty.call(i,c),r.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r(8)})();function $s(e){return PU.parse(e)}function Iu(e,n){return PU.print(e,n)}var nae=ma("Array").keys,rae=kc,oae=mr,sae=C,iae=nae,iR=Array.prototype,aae={DOMTokenList:!0,NodeList:!0},cae=function(e){var n=e.keys;return e===iR||sae(iR,e)&&n===iR.keys||oae(aae,rae(e))?iae:n},Ii=l(cae);function DU(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function vn(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?DU(Object(r),!0).forEach(function(i){jr(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DU(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function jr(e,n,r){return(n=function(i){var c=function(u,f){if(typeof u!="object"||u===null)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var _=m.call(u,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(i);return typeof c=="symbol"?c:String(c)}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}const LU=new class extends Dr{constructor(){super(...arguments),jr(this,"currentUploadLogID",0)}reportLogUploadError(e){const{errorRange:n}=e;n[n.length-1]&&n[n.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=n[n.length-1],this.emit("REPORT_LOG_UPLOAD",e))}};class lae{constructor(n){jr(this,"logger",void 0),jr(this,"prefixLists",[]),this.logger=n}debug(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];this.logger.debug(...this.prefixLists,...r)}info(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];this.logger.info(...this.prefixLists,...r)}warning(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];this.logger.warning(...this.prefixLists,...r)}error(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];this.logger.error(...this.prefixLists,...r)}prefix(n){return this.prefixLists.push(n),this}popPrefix(){return this.prefixLists.pop(),this}}function aR(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function MU(){const e=new Date,n=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return n?(n==null?void 0:n[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const qi={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},oy=Date.now(),uv=e=>{for(const n in qi)if(Object.prototype.hasOwnProperty.call(qi,n)&&qi[n]===e)return n;return"DEFAULT"},x=new class{constructor(){jr(this,"proxyServerURL",void 0),jr(this,"logLevel",qi.DEBUG),jr(this,"uploadState","collecting"),jr(this,"uploadLogWaitingList",[]),jr(this,"uploadLogUploadingList",[]),jr(this,"uploadErrorCount",0),jr(this,"currentLogID",0),jr(this,"url",void 0),jr(this,"extLog",(e,n)=>{this.appendLogToWaitingList(e,...n)})}debug(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=[qi.DEBUG].concat(n);this.log.apply(this,i)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=[qi.INFO].concat(n);this.log.apply(this,i)}warning(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=[qi.WARNING].concat(n);this.log.apply(this,i)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=[qi.ERROR].concat(n);this.log.apply(this,i)}upload(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=[qi.DEBUG].concat(n);this.uploadLog.apply(this,i)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){tr("UPLOAD_LOG",!0)}disableLogUpload(){tr("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new lae(this).prefix(e)}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(Date.now()-oy<100)return void setTimeout(()=>{this.log(...n)},Date.now()-oy);const i=Math.max(0,Math.min(4,n[0]));if(n[0]=aR()+" Agora-SDK [".concat(uv(i),"]:"),this.appendLogToWaitingList(i,...n),i<this.logLevel)return;const c=aR()+" %cAgora-SDK [".concat(uv(i),"]:");let u=[];if(!de("USE_NEW_LOG"))switch(i){case qi.DEBUG:u=[c,"color: #64B5F6;"].concat(n.slice(1)),console.log.apply(console,u);break;case qi.INFO:u=[c,"color: #1E88E5; font-weight: bold;"].concat(n.slice(1)),console.log.apply(console,u);break;case qi.WARNING:u=[c,"color: #FB8C00; font-weight: bold;"].concat(n.slice(1)),console.warn.apply(console,u);break;case qi.ERROR:u=[c,"color: #B00020; font-weight: bold;"].concat(n.slice(1)),console.error.apply(console,u)}}uploadLog(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(Date.now()-oy<100)return void setTimeout(()=>{this.uploadLog(...n)},Date.now()-oy);const i=Math.max(0,Math.min(4,n[0]));n[0]=aR()+" Agora-SDK [".concat(uv(i),"]:"),this.appendLogToWaitingList(i,...n)}appendLogToWaitingList(e){if(!de("UPLOAD_LOG"))return;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Array.isArray(r[0])?r[0][0]=MU()+" Agora-SDK [".concat(uv(e),"]:"):r[0]=MU()+" Agora-SDK [".concat(uv(e),"]:");let c="";r.forEach(u=>{typeof u=="object"&&(u=JSON.stringify(u)),c+="".concat(u," ")}),this.uploadLogWaitingList.push({payload_str:c,log_level:e,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,n={sdk_version:Yi,process_id:de("PROCESS_ID"),payload:JSON.stringify(e)};return nc(async()=>{const r=await Is.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(de("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(de("LOG_UPLOAD_SERVER"),"/upload/v1")),n,{responseType:"text"});if(r.data!=="OK"){const i=new Error("unexpected upload log response");throw i.response=r,i}},()=>(this.uploadLogUploadingList=[],!1),r=>{const i={status:-1,message:r.message,errorRange:e.map(c=>c.log_item_id)};return r.response?(i.status=r.response.status,i.data=r.response.data,i.headers=r.response.headers):r.request&&(i.status=r.request.status),LU.reportLogUploadError(i),!0},{timeout:de("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:de("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,de("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),de("UPLOAD_LOG_INTERVAL"))}).catch(e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),de("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),de("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var xU;function uae(e){return Po(e.reportId,"params.reportId",0,100,!1),Po(e.category,"params.category",0,100,!1),Po(e.event,"params.event",0,100,!1),Po(e.label,"params.label",0,100,!1),sr(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(xU={}).FREE="free",xU.UPLOADING="uploading",function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}({});const dae={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let bo=function(e){return e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",e.AB_TEST="ab_test",e}({}),Nr=function(e){return e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",e.AB_TEST="io.agora.pb.Wrtc.ABTest",e}({});(function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let hae=function(e){return e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",e}({});function Xt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(n,r,i){const c=i.value;if(typeof c=="function"){const u=e.className||n.__className__||(n.constructor.name==="AgoraRTCClient"?"Client":n.constructor.name);i.value=function(){for(var f,m=arguments.length,_=new Array(m),y=0;y<m;y++)_[y]=arguments[y];let T=_;if(e.argsMap)try{T=e.argsMap(this,..._)}catch(k){x.warning(k),T=[]}try{JSON.stringify(T)}catch{x.warning("arguments for method ".concat(u,".").concat(String(r)," not serializable for apiInvoke.")),T=[]}const A=(e.report||Bt).reportApiInvoke(this._sessionId||null,{id:this._clientId||((f=this.store)===null||f===void 0?void 0:f.clientId)||this._ID,name:"".concat(u,".").concat(String(r)),options:T,tag:Fr.TRACER,reportResult:e.reportResult},e.throttleTime);try{const k=c.apply(this,_);return k instanceof bt?k.then(P=>(A.onSuccess(e.reportResult&&P),P)).catch(P=>{throw A.onError(P),P}):(A.onSuccess(e.reportResult&&k),k)}catch(k){throw A.onError(k),k}}}return i}}const Bt=new class{constructor(){jr(this,"baseInfoMap",new Map),jr(this,"proxyServer",void 0),jr(this,"eventUploadTimer",void 0),jr(this,"setSessionIdTimer",void 0),jr(this,"url",void 0),jr(this,"sids",new Set),jr(this,"backupUrl",void 0),jr(this,"_appId",void 0),jr(this,"_aid",0),jr(this,"keyEventUploadPendingItems",[]),jr(this,"normalEventUploadPendingItems",[]),jr(this,"apiInvokeUploadPendingItems",[]),jr(this,"apiInvokeCount",0),jr(this,"apiInvokeLoggedCount",0),jr(this,"ltsList",[]),jr(this,"lastSendNormalEventTime",Date.now()),jr(this,"customReportCounterTimer",void 0),jr(this,"customReportCount",0),jr(this,"extApiInvoke",async e=>{for(const n of e){const r=vn(vn({},n),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Fr.TRACER});this.sendApiInvoke(r)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),de("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),de("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}setAppId(e){this._appId=e,this._aid=parseInt(e.replace(/[a-fA-F0-9]{8}/g,n=>{let[r,i]=n;return r+i}),16)||0}reportApiInvoke(e,n,r){n.timeout=n.timeout||6e4,n.reportResult=n.reportResult===void 0||n.reportResult;const i=Date.now();this.apiInvokeCount+=1;const c=this.apiInvokeCount,u=!!de("SHOW_REPORT_INVOKER_LOG"),f=!!de("SHOW_REPORT_USER_INVOKER_LOG"),m=u||f&&n.id;m&&(this.apiInvokeLoggedCount+=1);const _=this.apiInvokeLoggedCount;function y(P,q){if(m){let j="[apiInvoke-".concat(_,"]");n.id&&(j+="[".concat(n.id,"]")),n.name&&(j+="[".concat(n.name,"]")),x.info("".concat(j," ").concat(P),P==="start"?n.options:q||"")}}const T=()=>({tag:n.tag,invokeId:c,sid:e,name:n.name,apiInvokeTime:i,options:n.options,states:n.states||null});y("start");let A=!1;Do(n.timeout).then(()=>{A||(this.sendApiInvoke(vn(vn({},T()),{},{error:oe.API_INVOKE_TIMEOUT,success:!1})),y("timeout"))});const k=new $e(oe.UNEXPECTED_ERROR,"".concat(n.name,": this api invoke is end"));return{onSuccess:P=>{const q=()=>{if(A)throw k;return A=!0,this.sendApiInvoke(vn(vn({},T()),{},{success:!0},n.reportResult&&{result:P})),y("onSuccess"),P};return r?mU(q,n.name+"Success",r,()=>A=!0):q()},onError:P=>{const q=()=>{if(A)throw P;A=!0,this.sendApiInvoke(vn(vn({},T()),{},{success:!1,error:P})),y("onFailure",P.toString())};return r?mU(q,n.name+"Error",r,()=>A=!0):q()}}}sessionInit(e,n){if(this.baseInfoMap.has(e))return;const r=Date.now(),i=this.createBaseInfo(e,r);i.cname=n.cname;const c=Object.assign({},{willUploadConsoleLog:de("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:nR?"global":"oversea",areas:de("AREAS")&&de("AREAS").join(",")},n.extend),{stringUid:u,channelProfile:f,channelMode:m,isABTestSuccess:_,lsid:y,clientRole:T}=n,A=Date.now(),k=vn(vn({},i),{},{eventType:bo.SESSION_INIT,appid:n.appid,browser:navigator.userAgent,buildFormat:n.buildFormat,build:oR,lts:A,elapse:A-r,extend:JSON.stringify(c),mode:n.mode,process:de("PROCESS_ID"),appType:de("APP_TYPE"),success:!0,version:Yi,stringUid:u,channelProfile:f,channelMode:m,isABTestSuccess:_,lsid:y,clientType:gt(P=window.navigator.userAgent).call(P,"AgoraWebView")?42:20,clientRole:T,serviceId:de("PROCESS_ID"),extensionID:de("PLUGIN_INFO").join(",")||""});var P;this.send({type:Nr.SESSION,data:k},!0)}joinChooseServer(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{role:n.role,eventType:bo.JOIN_CHOOSE_SERVER,lts:c,eventElapse:n.elapse||c-n.lts,chooseServerAddr:n.csAddr,errorCode:n.ec,elapse:c-r.startTime,success:n.succ,chooseServerAddrList:JSON.stringify(n.serverList),uid:n.uid?parseInt(n.uid):null,cid:n.cid?parseInt(n.cid):null,chooseServerIp:n.csIp||"",opid:n.opid,unilbsServerIds:n.unilbsServerIds,extend:n.extend||void 0,isHttp3:n.isHttp3,corssRegionTagReq:n.corssRegionTagReq||void 0,corssRegionTagRes:n.corssRegionTagRes||void 0});this.send({type:Nr.JOIN_CHOOSE_SERVER,data:u},!0)}reqUserAccount(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{eventType:bo.REQ_USER_ACCOUNT,lts:c,success:n.success,serverAddress:n.serverAddr,stringUid:n.stringUid,uid:n.uid,errorCode:n.errorCode,elapse:n.elapse||c-r.startTime,eventElapse:c-n.lts,extend:JSON.stringify(n.extend)});this.send({type:Nr.REQ_USER_ACCOUNT,data:u},!0)}joinGateway(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info;n.vid&&(i.vid=n.vid),i.uid=n.uid,i.cid=n.cid;const c=Date.now(),{firstSuccess:u,avoidJoinStartTime:f,addr:m,isProxy:_}=n,y=c-(u&&f?f:r.startTime),T=vn(vn({},i),{},{eventType:bo.JOIN_GATEWAY,lts:c,gatewayAddr:n.addr,success:n.succ,errorCode:n.ec,errorMsg:n.errorMsg||"",elapse:y,eventElapse:c-n.lts,firstSuccess:u,signalChannel:n.signalChannel,preload:n.preload?1:0,installId:tR(),isABTestSuccess:n.isABTestSuccess?1:0}),A=T.success?1:0;if(n.succ&&(r.lastJoinSuccessTime=c),u)this.send({type:Nr.JOIN_GATEWAY,data:T},!0);else{let k;if(m)if(_){const q=m.match(/h=(\d{1,3}-){3}\d{1,3}/g),j=m.match(/p=[0-9]{1,6}/g);k={isSuccess:A,gatewayIp:q&&q.length?q[0].split("=")[1].replace(/-/g,"."):"",port:j&&j.length?j[0].split("=")[1]:"",isProxy:_?1:0}}else{const q=m.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),j=m.match(/(:|p=)[0-9]{1,6}/g);k={isSuccess:A,gatewayIp:q&&q.length?q[0].split("//")[1].replace(/-/g,"."):"",port:j&&j.length?j[0].split(/:|p=/g)[1]:"",isProxy:_?1:0}}else k={isSuccess:A,gatewayIp:"",port:"",isProxy:_?1:0};delete T.success,delete T.eventType,delete T.firstSuccess,T.vid=Number(T.vid);const P=Object.assign({},T,k,{eventType:bo.REJOIN_GATEWAY});this.send({type:Nr.RE_JOIN_GATEWAY,data:P},!0)}}joinChannelTimeout(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=Date.now(),c=vn(vn({},r.info),{},{lts:i,timeout:n,elapse:i-r.startTime});this.send({type:Nr.JOIN_CHANNEL_TIMEOUT,data:c},!0)}publish(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{eventType:bo.PUBLISH,lts:c,eventElapse:n.eventElapse,elapse:c-r.startTime,success:n.succ,errorCode:n.ec,videoName:n.videoName,audioName:n.audioName,screenName:n.screenName,screenshare:n.screenshare,audio:n.audio,video:n.video,p2pid:n.p2pid,publishRequestid:n.publishRequestid});this.send({type:Nr.PUBLISH,data:u},!0)}subscribe(e,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const c=i.info,u=Date.now(),f=vn(vn({},c),{},{eventType:bo.SUBSCRIBE,lts:u,eventElapse:n.eventElapse,elapse:u-i.startTime,success:n.succ,errorCode:n.ec,video:n.video,audio:n.audio,subscribeRequestid:n.subscribeRequestid,p2pid:n.p2pid,preSsrc:n.preSsrc?1:0},r&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof n.peerid=="string"?f.peerSuid=n.peerid:f.peer=n.peerid,this.send({type:Nr.SUBSCRIBE,data:f},!0)}wsCompressorInit(e){var n;const r=[...Ii(n=this.baseInfoMap).call(n)],i=r.length?r[0]:"UnableToGetSid",c=this.baseInfoMap.get(i);if(!c)return;const u=c.info,f=Date.now(),m=vn(vn({},u),{},{eventType:bo.WS_COMPRESSOR_INIT,lts:f,eventElapse:e.eventElapse,elapse:f-c.startTime,status:e.status?1:2});this.send({type:Nr.WS_COMPRESSOR_INIT,data:m},!0)}firstRemoteVideoDecode(e,n,r,i){const c=this.baseInfoMap.get(e);if(!c)return;const u=c.info,f=Date.now(),m=vn(vn(vn({},u),i),{},{elapse:f-c.startTime,eventType:n,lts:f,firstDecodeFrame:Math.max((i.firstFrame||f)-c.startTime,0),apEnd:Math.max(i.apEnd-c.startTime,0),apStart:Math.max(i.apStart-c.startTime,0),joinGwEnd:Math.max(i.joinGwEnd-c.startTime,0),joinGwStart:Math.max(i.joinGwStart-c.startTime,0),pcEnd:Math.max(i.pcEnd-c.startTime,0),pcStart:Math.max(i.pcStart-c.startTime,0),subscriberEnd:Math.max(i.subscriberEnd-c.startTime,0),subscriberStart:Math.max(i.subscriberStart-c.startTime,0),videoAddNotify:Math.max(i.videoAddNotify-c.startTime,0)});this.send({type:r,data:m},!0)}firstRemoteFrame(e,n,r,i){const c=this.baseInfoMap.get(e);if(!c)return;const u=c.info,f=Date.now(),m=vn(vn(vn({},u),i),{},{elapse:f-c.startTime,eventType:n,lts:f});this.send({type:r,data:m},!0)}abTest(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{vid:i.vid===void 0?0:Number(i.vid),elapse:c-r.startTime,eventType:bo.AB_TEST,lts:c});this.send({type:Nr.AB_TEST,data:u},!0)}pcStats(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{vid:i.vid===void 0?0:Number(i.vid),elapse:c-r.startTime,eventType:bo.PC_STATS,lts:c,preallocation:n.preallocation?1:0});this.send({type:Nr.PC_STATS,data:u},!0)}updateRemoteRTPCapabilities(e,n){if(e){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{vid:i.vid===void 0?0:Number(i.vid),eventType:bo.UPDATE_REMOTE_RTPCAPABILITIES,lts:c});this.send({type:Nr.UPDATE_REMOTE_RTPCAPABILITIES,data:u},!0)}}onGatewayStream(e,n,r,i){const c=this.baseInfoMap.get(e);if(!c)return;const u=c.info,f=Date.now(),m=vn(vn(vn({},u),i),{},{eventType:n,lts:f});this.send({type:r,data:m},!0)}streamSwitch(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{eventType:bo.STREAM_SWITCH,lts:c,isDual:n.isdual,elapse:c-r.startTime,success:n.succ});this.send({type:Nr.STREAM_SWITCH,data:u},!0)}requestProxyAppCenter(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{eventType:bo.REQUEST_PROXY_APPCENTER,lts:c,eventElapse:c-n.lts,elapse:c-r.startTime,APAddr:n.APAddr,workerManagerList:n.workerManagerList,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:Nr.REQUEST_PROXY_APPCENTER,data:u},!0)}requestProxyWorkerManager(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{eventType:bo.REQUEST_PROXY_WORKER_MANAGER,lts:c,eventElapse:c-n.lts,elapse:c-r.startTime,workerManagerAddr:n.workerManagerAddr,response:n.response,errorCode:n.ec,success:n.succ});this.send({type:Nr.REQUEST_PROXY_WORKER_MANAGER,data:u},!0)}setProxyServer(e){this.proxyServer=e,e?x.debug("reportProxyServerurl: ".concat(e)):x.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn({},i),{},{subscribeElapse:n.subscribeElapse,peer:n.peer,peerPublishDuration:Math.max(n.audioPublishDuration,n.videoPublishDuration),audiotag:n.audioPublishDuration>0?1:-1,videotag:n.videoPublishDuration>0?1:-1,lts:c,elapse:c-r.startTime,joinChannelSuccessElapse:c-(r.lastJoinSuccessTime||c),peerPublishDurationVideo:n.videoPublishDuration,peerPublishDurationAudio:n.audioPublishDuration});this.send({type:Nr.PEER_PUBLISH_STATUS,data:u},!0)}workerEvent(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now();(function(u,f,m){const _=u[f];if(!_||typeof _!="string")return[u];u[f]="";const y=Vc(JSON.stringify(u));let T=0;const A=[];let k=0;for(let P=0;P<_.length;P++)k+=_.charCodeAt(P)<=127?1:3,k<=m-y||(A[A.length]=Nt(Nt({},u),{},{[f]:_.substring(T,P)}),T=P,k=_.charCodeAt(P)<=127?1:3);return T!==_.length-1&&(A[A.length]=Nt(Nt({},u),{},{[f]:_.substring(T)})),A})(vn(vn(vn({},i),n),{},{elapse:c-r.startTime,lts:c,productType:"WebRTC"}),"payload",1300).forEach(u=>this.send({type:Nr.WORKER_EVENT,data:u},!0))}apworkerEvent(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{elapse:c-r.startTime,lts:c});this.send({type:Nr.AP_WORKER_EVENT,data:u},!0)}joinWebProxyAP(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{elapse:c-r.startTime,lts:c,extend:n.extend||void 0});this.send({type:Nr.JOIN_WEB_PROXY_AP,data:u},!0)}WebSocketQuit(e,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,c=Date.now(),u=vn(vn(vn({},i),n),{},{elapse:c-r.startTime,lts:c});this.send({type:Nr.WEBSOCKET_QUIT,data:u},!0)}async sendCustomReportMessage(e,n){if(this.customReportCount+=n.length,this.customReportCount>de("CUSTOM_REPORT_LIMIT"))throw new $e(oe.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const r=Date.now(),i=n.map(c=>({type:Nr.USER_ANALYTICS,data:vn(vn({sid:e},c),{},{lts:r})}));try{de("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(i):await this.postDataToStatsCollector(i)}catch(c){throw x.error("send custom report message failed",c.toString()),new $e(oe.CUSTOM_REPORT_SEND_FAILED,c.message)}}sendApiInvoke(e){const n=de("NOT_REPORT_EVENT");if(e.tag&&gt(n)&&gt(n).call(n,e.tag))return!1;if(e.sid===null)return this.apiInvokeUploadPendingItems.push(e),!1;const r=this.baseInfoMap.get(e.sid);if(!r)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:i,uid:c,cid:u}=r.info;let f;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof $e){const{code:_,message:y}=e.error;f=_||y||e.error.toString()}else f=e.error.toString();const m={invokeId:e.invokeId,sid:e.sid,cname:i,cid:u,uid:c,lts:e.lts,success:e.success,elapse:e.lts-r.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?f:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:Nr.API_INVOKE,data:m},!1),!0}addSid(e){this.sids.add(e)}removeSid(e){this.sids.delete(e)}appendSessionId(){const e=this.apiInvokeUploadPendingItems;if(e.length===0)return;const n=Array.from(this.sids).find(r=>r!==null);n&&e.forEach(r=>{r&&(r.sid=n,this.sendApiInvoke(Object.assign({},r)))}),e.length=0}send(e,n){if(n)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>de("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,n){const r=[],i=[];for(;e.length;){const u=e.shift();r.length<20?r.push(u):i.push(u)}e.push(...i);for(const u of[...r]){var c;this.ltsList.indexOf(u.data.lts)!==-1?(u.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(u.data.lts)):(this.ltsList.push(u.data.lts),Hm(c=this.ltsList).call(c,(f,m)=>f-m))}return n||(this.lastSendNormalEventTime=Date.now()),de("ENABLE_EVENT_REPORT")&&r.length&&(de("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(r):this.postDataToStatsCollector(r)).catch((u=>f=>{de("EVENT_REPORT_RETRY")&&(n?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(u):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(u),this.normalEventUploadPendingItems.length>de("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-de("NORMAL_EVENT_QUEUE_CAPACITY")),x.warning("report: drop normal events"))))})(r)),e}async postDataToStatsCollector2(e){Qr.networkState===si.OFFLINE&&await bt.race([Qr.onlineWaiter,Do(2*so.maxRetryTimeout)]);const n=c=>{let u=new Uint8Array;return c.forEach(f=>{const m=Hw(JSON.stringify(f.data)),_=new ArrayBuffer(5),y=(A=>{let k=0;return Object.entries(Nr).forEach(P=>{let[q,j]=P;j===A.type&&(k=hae[q])}),k})(f),T=new DataView(_);T.setUint16(0,m.byteLength,!0),T.setUint8(2,255&y),T.setUint8(3,y>>>8&255),T.setUint8(4,y>>>16&255),u=iU(u,new Uint8Array(_)),u=iU(u,m)}),u},r="event";let i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(de("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(r):"https://".concat(de("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(r);for(let c=0;c<2;c+=1){c===1&&(i=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(de("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(r):"https://".concat(de("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(r));try{await Xw(i,{timeout:1e4,data:n(e),headers:vn(vn({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(u){if(c===1)throw u;continue}return}}async postDataToStatsCollector(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=(m=>{const _=m&&m.data.sid&&this.baseInfoMap.get(m.data.sid);return _&&_.info.vid&&+_.info.vid||0})(e[0]),i=r?void 0:this._aid,c={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map(m=>JSON.stringify(m)),vid:r,aid:i};Qr.networkState===si.OFFLINE&&await bt.race([Qr.onlineWaiter,Do(2*so.maxRetryTimeout)]);const u=n?"/events/proto-raws":"/events/messages";let f=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(de("EVENT_REPORT_DOMAIN"),"&p=").concat(de("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(de("EVENT_REPORT_DOMAIN"),":").concat(de("STATS_COLLECTOR_PORT")).concat(u));for(let m=0;m<2;m+=1){m===1&&(f=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(de("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(de("STATS_COLLECTOR_PORT"),"&d=").concat(u):"https://".concat(de("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(de("STATS_COLLECTOR_PORT")).concat(u)));try{n?await Jie(f,{timeout:1e4,data:c}):await Xw(f,{timeout:1e4,data:c})}catch(_){if(m===1)throw _;continue}return}}createBaseInfo(e,n){const r=Object.assign({},dae);return r.sid=e,this.baseInfoMap.set(e,{info:r,startTime:n}),r}reportResourceTiming(e,n){const r=performance.getEntriesByName(e),i=r[r.length-1];i&&this.reportApiInvoke(n,{name:"Client.resourceTiming",options:i,tag:Fr.TRACER}).onSuccess()}};LU.on("REPORT_LOG_UPLOAD",e=>{e.networkState=Qr.networkState,Bt.reportApiInvoke(null,{name:"logUploadError",options:e,tag:Fr.TRACER}).onSuccess("logUploadError")});class Ue extends $e{constructor(n){super(n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),jr(this,"name","AgoraRTCException")}print(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(n,x)}throw(){super.throw(x)}}const Lo={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function Bn(){return Lo}function UU(){return"setSinkId"in HTMLAudioElement.prototype&&(!de("RESTRICTION_SET_PLAYBACK_DEVICE")||(Rl()||Yx())&&!Bw())}function VU(){return!Lo.supportUnifiedPlan||de("CHROME_FORCE_PLAN_B")&&Il()}let Mo=function(e){return e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change",e}({});function Lf(e,n,r){return{sampleRate:e,stereo:n,bitrate:r}}function xn(e,n,r,i,c){return{width:e,height:n,frameRate:r,bitrateMin:i,bitrateMax:c}}function Ca(e,n,r,i,c){return{width:{max:e},height:{max:n},frameRate:r,bitrateMin:i,bitrateMax:c}}function cR(e,n){return{numSpatialLayers:e,numTemporalLayers:n}}const fae={"90p":xn(160,90),"90p_1":xn(160,90),"120p":xn(160,120,15,30,65),"120p_1":xn(160,120,15,30,65),"120p_3":xn(120,120,15,30,50),"120p_4":xn(212,120),"180p":xn(320,180,15,30,140),"180p_1":xn(320,180,15,30,140),"180p_3":xn(180,180,15,30,100),"180p_4":xn(240,180,15,30,120),"240p":xn(320,240,15,40,200),"240p_1":xn(320,240,15,40,200),"240p_3":xn(240,240,15,40,140),"240p_4":xn(424,240,15,40,220),"360p":xn(640,360,15,80,400),"360p_1":xn(640,360,15,80,400),"360p_3":xn(360,360,15,80,260),"360p_4":xn(640,360,30,80,600),"360p_6":xn(360,360,30,80,400),"360p_7":xn(480,360,15,80,320),"360p_8":xn(480,360,30,80,490),"360p_9":xn(640,360,15,80,800),"360p_10":xn(640,360,24,80,800),"360p_11":xn(640,360,24,80,1e3),"480p":xn(640,480,15,100,500),"480p_1":xn(640,480,15,100,500),"480p_2":xn(640,480,30,100,1e3),"480p_3":xn(480,480,15,100,400),"480p_4":xn(640,480,30,100,750),"480p_6":xn(480,480,30,100,600),"480p_8":xn(848,480,15,100,610),"480p_9":xn(848,480,30,100,930),"480p_10":xn(640,480,10,100,400),"720p":xn(1280,720,15,120,1130),"720p_auto":xn(1280,720,30,900,3e3),"720p_1":xn(1280,720,15,120,1130),"720p_2":xn(1280,720,30,120,2e3),"720p_3":xn(1280,720,30,120,1710),"720p_5":xn(960,720,15,120,910),"720p_6":xn(960,720,30,120,1380),"1080p":xn(1920,1080,15,120,2080),"1080p_1":xn(1920,1080,15,120,2080),"1080p_2":xn(1920,1080,30,120,3e3),"1080p_3":xn(1920,1080,30,120,3150),"1080p_5":xn(1920,1080,60,120,4780),"1440p":xn(2560,1440,30,120,4850),"1440p_1":xn(2560,1440,30,120,4850),"1440p_2":xn(2560,1440,60,120,7350),"4k":xn(3840,2160,30,120,8910),"4k_1":xn(3840,2160,30,120,8910),"4k_3":xn(3840,2160,60,120,13500)},pae={"480p":Ca(640,480,5),"480p_1":Ca(640,480,5),"480p_2":Ca(640,480,30),"480p_3":Ca(640,480,15),"720p":Ca(1280,720,5),"720p_auto":xn(1280,720,30,900,3e3),"720p_1":Ca(1280,720,5),"720p_2":Ca(1280,720,30),"720p_3":Ca(1280,720,15),"1080p":Ca(1920,1080,5),"1080p_1":Ca(1920,1080,5),"1080p_2":Ca(1920,1080,30),"1080p_3":Ca(1920,1080,15)},mae={"1SL1TL":cR(1,1),"3SL3TL":cR(3,3),"2SL3TL":cR(2,3)};function Bc(e){return e||(e="480p_1"),typeof e=="string"?Object.assign({},fae[e]):e}function lR(e){return typeof e=="string"?Object.assign({},pae[e]):e}function sy(e){return typeof e=="string"?Object.assign({},mae[e]):e}const vae={speech_low_quality:Lf(16e3,!1),speech_standard:Lf(32e3,!1,18),music_standard:Lf(48e3,!1),standard_stereo:Lf(48e3,!0,56),high_quality:Lf(48e3,!1,128),high_quality_stereo:Lf(48e3,!0,192)};function iy(e){return typeof e=="string"?Object.assign({},vae[e]):e}const Mf=[];function FU(e){return vo(e,"mediaSource",["screen","window","application"]),!0}let Pt=function(e){return e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track",e}({}),hr=function(e){return e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream",e.SCREEN_LOW_TRACK="screen_low_track",e}({}),xf=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e}({}),gae=function(e){return e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",e}({}),_ae=function(e){return e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY",e[e.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",e[e.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",e[e.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",e[e.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",e[e.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",e[e.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",e}({}),Bd=function(e){return e.TRANSCEIVER_UPDATED="transceiver-updated",e.SEI_TO_SEND="sei-to-send",e.SEI_RECEIVED="sei-received",e.TRACK_UPDATED="track-updated",e}({}),Uf=function(e){return e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed",e}({}),Vf=function(e){return e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.VIDEO_STATE_CHANGED="video-state-changed",e}({}),Ff=function(e){return e.AUDIO="audio",e.VIDEO="video",e.DATA="data",e}({}),Ai=function(e){return e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source",e}({});(function(e){e.UPDATE_TRACK_SOURCE="update-track-source"})({});const uR={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},dR={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},BU={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},Eae={uplinkNetworkQuality:0,downlinkNetworkQuality:0},jU={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let gs=function(e){return e.ON_TRACK="on_track",e.ON_NODE="on_node",e}({}),Oi=function(e){return e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints",e}({}),dv=function(e){return e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND",e}({}),jd=function(e){return e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",e}({}),ts=function(e){return e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata",e}({}),jc=function(e){return e[e.VideoStateStopped=0]="VideoStateStopped",e[e.VideoStateStarting=1]="VideoStateStarting",e[e.VideoStateDecoding=2]="VideoStateDecoding",e[e.VideoStateFrozen=3]="VideoStateFrozen",e}({});const hR={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let ay=function(e){return e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error",e}({});function $U(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function kr(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?$U(Object(r),!0).forEach(function(i){xe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$U(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function xe(e,n,r){return(n=function(i){var c=function(u,f){if(typeof u!="object"||u===null)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var _=m.call(u,"string");if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(i);return typeof c=="symbol"?c:String(c)}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Un(e,n,r,i,c){var u,f,m={};return Object.keys(i).forEach(function(_){m[_]=i[_]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=qa(u=kP(f=r.slice()).call(f)).call(u,function(_,y){return y(e,n,_)||_},m),c&&m.initializer!==void 0&&(m.value=m.initializer?m.initializer.call(c):void 0,m.initializer=void 0),m.initializer===void 0&&(Object.defineProperty(e,n,m),m=null),m}class HU extends Dr{set _mediaStreamTrack(n){n!==this.mediaStreamTrack&&(this.safeEmit(Bd.TRACK_UPDATED,n),this.mediaStreamTrack=n)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(n,r){super(),xe(this,"trackMediaType",void 0),xe(this,"_ID",void 0),xe(this,"_rtpTransceiver",void 0),xe(this,"_lowRtpTransceiver",void 0),xe(this,"_hints",[]),xe(this,"_isClosed",!1),xe(this,"_originMediaStreamTrack",void 0),xe(this,"mediaStreamTrack",void 0),xe(this,"_external",{}),this._ID=r||dr(8,"track-"),this._originMediaStreamTrack=n,this.mediaStreamTrack=n,function(i){gt(Mf).call(Mf,i)||Mf.push(i)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(n){return n||wu(()=>{var r;Bt.reportApiInvoke(null,{name:oo.GET_MEDIA_STREAM_TRACK,options:[],tag:Fr.TRACER}).onSuccess(((r=this._mediaStreamTrack)===null||r===void 0?void 0:r.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(n){return n===xf.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(n){const r=Mf.indexOf(n);r!==-1&&Mf.splice(r,1)}(this),this.emit(Uf.CLOSED),this.removeAllListeners(Bd.SEI_RECEIVED)}_updateRtpTransceiver(n,r){if(r===xf.LOW_STREAM){if(this._lowRtpTransceiver===n)return;this._lowRtpTransceiver=n}else{if(this._rtpTransceiver===n)return;this._rtpTransceiver=n}this.emit(Bd.TRANSCEIVER_UPDATED,n,r)}}class Bf extends HU{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(n,r){super(n,r),xe(this,"_enabled",!0),xe(this,"_muted",!1),xe(this,"_isExternalTrack",!1),xe(this,"_isClosed",!1),xe(this,"_enabledMutex",void 0),xe(this,"processor",void 0),xe(this,"_processorContext",void 0),xe(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new Ko("".concat(this.getTrackId())),n.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var n,r;return(n=(r=this._originMediaStreamTrack)===null||r===void 0?void 0:r.label)!==null&&n!==void 0?n:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,x.debug("[".concat(this.getTrackId(),"] close")),this.emit(Pt.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(n,r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=i,n!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),r&&this._originMediaStreamTrack.stop()),n.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=n,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ur(this,Pt.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){x.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Uf.TRACK_ENDED)}stateCheck(n,r){if(x.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(n,": ").concat(r,"]")),Al(r,n),this._enabled&&this._muted&&n==="enabled"&&r===!1)throw new $e(oe.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",x);if(!this._enabled&&!this._muted&&n==="muted"&&r===!0)throw new $e(oe.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",x)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():bt.resolve([])}}const WU=window.AudioContext||window.webkitAudioContext;let Ni=null;const nr=new class extends Dr{constructor(){super(...arguments),xe(this,"prevState",void 0),xe(this,"curState",void 0),xe(this,"currentTime",void 0),xe(this,"currentTimeStuckAt",void 0),xe(this,"interruptDetectorTrack",void 0),xe(this,"onLocalAudioTrackMute",()=>{x.info("ios15-interruption-start"),this.emit(Mo.IOS_15_16_INTERRUPTION_START)}),xe(this,"onLocalAudioTrackUnmute",async()=>{x.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?x.info("ios15-interruption-end-canceled"):(Ni&&await Ni.suspend(),this.emit(Mo.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(e){x.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){x.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function jf(){if(!Ni){if(function(){if(!WU)return void x.error("your browser is not support web audio");x.info("create audio context");const e=kr({},de("WEBAUDIO_INIT_OPTIONS"));x.debug("audio context init option:",JSON.stringify(e)),Ni=new WU(e),nr.curState=Ni.state,Ni.onstatechange=()=>{nr.prevState=nr.curState,nr.curState=Ni?Ni.state:void 0;const{prevState:n,curState:r}=nr,i=r==="running",c=r==="interrupted",u=n==="running",f=n==="suspended",m=n==="interrupted",_=Mn().osVersion;(vs()||Sa())&&u&&c&&(x.info("ios".concat(_,"-interruption-start")),nr.emit(Mo.IOS_INTERRUPTION_START)),(vs()||Sa())&&(f||m)&&i&&(x.info("ios".concat(_,"-interruption-end")),nr.emit(Mo.IOS_INTERRUPTION_END)),n!==r&&nr.emit(Mo.STATE_CHANGE,r,n)},setInterval(()=>{var n;const r=(n=Ni)===null||n===void 0?void 0:n.currentTime;nr.currentTime!==r?(nr.currentTimeStuckAt&&(x.debug("AudioContext current time resume at ".concat(r)),nr.currentTimeStuckAt=void 0),nr.currentTime=r):(r!==nr.currentTimeStuckAt&&(Bt.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:r},tag:Fr.TRACER}).onSuccess(),x.warning("AudioContext current time stuck at ".concat(r))),nr.currentTimeStuckAt=r)},5e3),async function(n){const r=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let i,c=!1,u=!1,f=!1;function m(j){n.state==="running"?_(!1):vs()||Sa()?n.state==="suspended"&&(_(!0),j&&n.resume().then(y,y)):n.state!=="closed"&&(_(!0),j&&n.resume().then(y,y))}function _(j){if(c!==j){c=j;for(let H=0,ne=r;H<ne.length;H+=1){const re=ne[H];j?window.addEventListener(re,T,{capture:!0,passive:!0}):window.removeEventListener(re,T,{capture:!0,passive:!0})}}}function y(){m(!1)}function T(){m(!0)}function A(j){if(!f)if(i.paused)if(j){let H;k(!1),f=!0;try{H=i.play(),H?H.then(P,P):(i.addEventListener("playing",P),i.addEventListener("abort",P),i.addEventListener("error",P))}catch{P()}}else k(!0);else k(!1)}function k(j){if(u!==j){u=j;for(let H=0,ne=r;H<ne.length;H++){const re=ne[H];j?window.addEventListener(re,q,{capture:!0,passive:!0}):window.removeEventListener(re,q,{capture:!0,passive:!0})}}}function P(){i.removeEventListener("playing",P),i.removeEventListener("abort",P),i.removeEventListener("error",P),f=!1,A(!1)}function q(){A(!0)}if(vs()){const j=n.createMediaStreamDestination(),H=document.createElement("div");H.innerHTML="<audio x-webkit-airplay='deny'></audio>",i=H.children.item(0),i.controls=!1,i.disableRemotePlayback=!0,i.preload="auto",i.srcObject=j.stream,A(!0)}nr.on(Mo.STATE_CHANGE,function(){m(!0)}),m(!1)}(Ni)}(),!Ni)throw new $e(oe.NOT_SUPPORTED,"can not create audio context");return Ni}return Ni}function $d(e){if(function(){if(fR!==null)return fR;const i=jf(),c=i.createBufferSource(),u=i.createGain(),f=i.createGain();c.connect(u),c.connect(f),c.disconnect(u);let m=!1;try{c.disconnect(u)}catch{m=!0}return c.disconnect(),fR=m,m}())return;const n=e.connect,r=e.disconnect;e.connect=(i,c,u)=>{var f;return e._inputNodes||(e._inputNodes=[]),gt(f=e._inputNodes).call(f,i)||(i instanceof AudioNode?(e._inputNodes.push(i),n.call(e,i,c,u)):n.call(e,i,c)),e},e.disconnect=(i,c,u)=>{r.call(e),i?XE(e._inputNodes,i):e._inputNodes=[];for(const f of e._inputNodes)n.call(e,f)}}let fR=null;function pR(e,n){let r=!1;const i=1/n;if(de("DISABLE_WEBAUDIO")){const c=window.setInterval(()=>{r?window.clearInterval(c):e(performance.now()/1e3)},1e3*i)}else{const c=jf();let u=c.createGain();u.gain.value=0,u.connect(c.destination);const f=()=>{if(r)return void(u=null);const m=c.createOscillator();m.onended=f,m.connect(u),m.start(0),m.stop(c.currentTime+i),e(c.currentTime)};f()}return()=>{r=!0}}class KU{constructor(){xe(this,"context",void 0),xe(this,"analyserNode",void 0),xe(this,"sourceNode",void 0),this.context=jf(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(n){if(n!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=n,n==null||n.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||vs()||Sa()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const n=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(n);else{const i=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(i);for(let c=0;c<n.length;++c)n[c]=i[c]/128-1}const r=qa(n).call(n,(i,c)=>i+c*c,0)/n.length;return Math.max(10*Math.log10(r)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var n,r;(n=this.sourceNode)===null||n===void 0||n.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(r=this.sourceNode)===null||r===void 0||r.connect(this.analyserNode)}catch{x.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class GU extends Dr{get processSourceNode(){return this.sourceNode}set processedNode(n){var r;if(!this.isDestroyed&&this._processedNode!==n){try{var i;(i=this.sourceNode)===null||i===void 0||i.disconnect(this.outputNode)}catch{}(r=this._processedNode)===null||r===void 0||r.disconnect(),this._processedNode=n,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),xe(this,"outputNode",void 0),xe(this,"outputTrack",void 0),xe(this,"isPlayed",!1),xe(this,"sourceNode",void 0),xe(this,"context",void 0),xe(this,"audioBufferNode",void 0),xe(this,"destNode",void 0),xe(this,"audioOutputLevel",0),xe(this,"volumeLevelAnalyser",void 0),xe(this,"_processedNode",void 0),xe(this,"playNode",void 0),xe(this,"isDestroyed",!1),xe(this,"onNoAudioInput",void 0),xe(this,"isNoAudioInput",!1),xe(this,"_noAudioInputCount",0),this.context=jf(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),$d(this.outputNode),this.volumeLevelAnalyser=new KU}startGetAudioBuffer(n){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(n),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=r=>{this.emit(Ai.ON_AUDIO_BUFFER,function(i){for(let c=0;c<i.outputBuffer.numberOfChannels;c+=1){const u=i.outputBuffer.getChannelData(c);for(let f=0;f<u.length;f+=1)u[f]=0}return i.inputBuffer}(r))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Bn().webAudioMediaStreamDest)throw new $e(oe.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(n){this.context.state!=="running"&&JE(()=>{nr.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=n||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(n>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;vs()||Sa()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const r=this.volumeLevelAnalyser.getAnalyserNode();let i;r.getFloatTimeDomainData?(i=new Float32Array(r.fftSize),r.getFloatTimeDomainData(i)):(i=new Uint8Array(r.fftSize),r.getByteTimeDomainData(i));let c=!1;for(let u=0;u<i.length;u++)i[u]!==0&&(c=!0);return c?(this.isNoAudioInput=!1,!0):(await Do(200),await this.checkHasAudioInput(n?n+1:1)&&c)}getAudioVolume(){return this.outputNode.gain.value}setVolume(n){this.outputNode.gain.setValueAtTime(n,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var n,r;(n=this.processedNode)===null||n===void 0||n.disconnect(),(r=this.sourceNode)===null||r===void 0||r.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var n;this.processedNode?(n=this.processedNode)===null||n===void 0||n.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class zU extends GU{get isFreeze(){return!1}constructor(n,r,i){var c;if(super(),xe(this,"sourceNode",void 0),xe(this,"track",void 0),xe(this,"clonedTrack",void 0),xe(this,"audioElement",void 0),xe(this,"isCurrentTrackCloned",!1),xe(this,"isRemoteTrack",!1),xe(this,"originVolumeLevelAnalyser",void 0),xe(this,"rebuildWebAudio",async()=>{if(x.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void x.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>x.info("resume success")),x.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const m=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?m.stop():this.isCurrentTrackCloned=!0;const _=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_),$d(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const y=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(y,this.context.currentTime),$d(this.outputNode),this.emit(Ai.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),n.kind!=="audio")throw new $e(oe.UNEXPECTED_ERROR);this.track=n;const u=new MediaStream([this.track]);if(this.isRemoteTrack=!!r,this.sourceNode=this.context.createMediaStreamSource(u),$d(this.sourceNode),i){const m=i.clone();m.enabled=!0,this.clonedTrack=m,x.debug("create an unmuted track ".concat(m.id," from the original track ").concat(i.id," to get the volume"));const _=this.context.createMediaStreamSource(new MediaStream([m]));$d(_),this.originVolumeLevelAnalyser=new KU,this.originVolumeLevelAnalyser.updateSource(_)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=u;const f=Mn();r&&f.os===yo.IOS&&Number((c=f.osVersion)===null||c===void 0?void 0:c.split(".")[0])<15&&(nr.on(Mo.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(m=>{m||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(n){this.sourceNode.disconnect(),this.track=n,this.isCurrentTrackCloned=!1;const r=new MediaStream([n]);this.sourceNode=this.context.createMediaStreamSource(r),$d(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(Ai.UPDATE_SOURCE),this.audioElement.srcObject=r}destroy(){var n;this.audioElement.srcObject=null,this.audioElement.remove(),nr.off("state-change",this.rebuildWebAudio),(n=this.originVolumeLevelAnalyser)===null||n===void 0||n.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(n){return this.context.createMediaStreamSource(new MediaStream([n]))}updateOriginTrack(n){const r=n.clone();r.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=r),x.debug("create an unmuted track ".concat(r.id," from the original track ").concat(n.id," to get the volume"));const i=this.context.createMediaStreamSource(new MediaStream([r]));$d(i),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(i)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function YU(e,n,r){const i=(u,f)=>u?typeof u!="number"?u.max||u.exact||u.ideal||u.min||f:u:f,c={audio:!!r&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:i(n.height,1080),maxWidth:i(n.width,1920)}}};return n.frameRate&&typeof n.frameRate!="number"?(c.video.mandatory.maxFrameRate=n.frameRate.max,c.video.mandatory.minFrameRate=n.frameRate.min):typeof n.frameRate=="number"&&(c.video.mandatory.maxFrameRate=n.frameRate),await navigator.mediaDevices.getUserMedia(c)}async function yae(e,n){const r=await qU(e.mediaSource),{sourceId:i,audio:c}=await function(u){let f=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new bt((m,_)=>{const y=document.createElement("div");y.innerText="share screen",y.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const T=document.createElement("div");T.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const A=document.createElement("div");A.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",A.setAttribute("style","height: 12%;");const k=document.createElement("div");k.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const P=document.createElement("div");P.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const q=document.createElement("button");q.innerHTML="cancel",q.setAttribute("style","width: 85px;"),q.onclick=()=>{document.body.removeChild(ne);const re=new Error("NotAllowedError");re.name="NotAllowedError",_(re)};let j=f;const H=document.createElement("div");if(f){const re=document.createElement("input");re.setAttribute("type","checkbox");const ve=document.createElement("span");re.setAttribute("style","margin-right: 6px;"),ve.innerText="Share audio",re.checked=j,re.onchange=()=>{j=re.checked},H.appendChild(re),H.appendChild(ve)}P.appendChild(H),P.appendChild(q),T.appendChild(A),T.appendChild(k),T.appendChild(P);const ne=document.createElement("div");ne.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),ne.appendChild(y),ne.appendChild(T),document.body.appendChild(ne),u.map(re=>{if(re.id){const ve=document.createElement("div");ve.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let Oe=re.thumbnail;try{const{width:ke}=Oe.getSize();ke>1920&&(Oe=Oe.resize({width:1920}))}catch(ke){throw ke&&ke.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),ke}ve.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Oe.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+re.name.replace(/[\u00A0-\u9999<>\&]/g,function(ke){return"&#"+ke.charCodeAt(0)+";"})+"</span>",ve.onclick=()=>{document.body.removeChild(ne),m({sourceId:re.id,audio:j})},k.appendChild(ve)}})})}(r,n);return await YU(i,e,c)}async function qU(e){let n=["window","screen"];e!=="application"&&e!=="window"||(n=["window"]),e==="screen"&&(n=["screen"]);const r=aU();if(!r)throw console.error("failed to fetch electron, please mount it to window"),new $e(oe.ELECTRON_IS_NULL);let i=null;try{var c;i=((c=r.desktopCapturer)===null||c===void 0?void 0:c.getSources({types:n}))||r.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:n})}catch{i=null}i&&i.then||(i=new bt((u,f)=>{r.desktopCapturer.getSources({types:n},(m,_)=>{m?f(m):u(_)})}));try{return await i}catch(u){throw new $e(oe.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,u.toString())}}const mR=new Ko("safari");let XU=!1,JU=!1;async function ki(e,n){let r=0,i=null;for(;r<2;)try{i=await bae(e,n,r>0);break}catch(c){if(c instanceof $e)throw x.error("[".concat(n,"] ").concat(c.toString())),c;const u=cy(c.name||c.code||c,c.message);if(u.code===oe.MEDIA_OPTION_INVALID){x.debug("[".concat(n,"] detect media option invalid, retry")),r+=1,await Do(500);continue}throw x.error("[".concat(n,"] ").concat(u.toString())),u}if(!i)throw new $e(oe.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return i}async function bae(e,n,r){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new $e(oe.NOT_SUPPORTED,"can not find getUserMedia");r&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const i=Bn(),c=new MediaStream;if(e.audioSource&&c.addTrack(e.audioSource),e.videoSource&&c.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return x.debug("Using Video Source/ Audio Source"),c;if(e.screen)if(aU())e.screen.sourceId?$f(c,await YU(e.screen.sourceId,e.screen,!!e.screenAudio)):$f(c,await yae(e.screen,!!e.screenAudio));else if(Rl()&&e.screen.extensionId&&e.screen.mandatory){if(!i.getStreamFromExtension)throw new $e(oe.NOT_SUPPORTED,"This browser does not support screen sharing");x.debug("[".concat(n,'] Screen access on chrome stable, looking for extension"'));const k=await(f=e.screen.extensionId,m=n,new bt((P,q)=>{try{chrome.runtime.sendMessage(f,{getStream:!0},j=>{if(!j||!j.streamId)return x.error("[".concat(m,"] No response from Chrome Plugin. Plugin not installed properly"),j),void q(new $e(oe.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));P(j.streamId)})}catch(j){x.error("[".concat(m,"] AgoraRTC screensharing plugin is not accessible(").concat(f,")"),j.toString()),q(new $e(oe.CHROME_PLUGIN_NOT_INSTALL))}}));e.screen.mandatory.chromeMediaSourceId=k,$f(c,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(i.getDisplayMedia){var u;e.screen.mediaSource&&FU(e.screen.mediaSource);const k={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:(u=e.screen.displaySurface)!==null&&u!==void 0?u:e.screen.mediaSource==="screen"?"monitor":e.screen.mediaSource},{selfBrowserSurface:P,surfaceSwitching:q,systemAudio:j,preferCurrentTab:H}=e.screen,ne={selfBrowserSurface:P,surfaceSwitching:q,systemAudio:j,preferCurrentTab:H};!P&&delete ne.selfBrowserSurface,!q&&delete ne.surfaceSwitching,!j&&delete ne.systemAudio,!H&&delete ne.preferCurrentTab,x.debug("[".concat(n,"] getDisplayMedia:"),JSON.stringify({video:k,audio:e.screenAudio,controls:ne})),$f(c,await navigator.mediaDevices.getDisplayMedia(kr({video:k,audio:e.screenAudio},ne)))}else{if(!Ur())throw x.error("[".concat(n,"] This browser does not support screenSharing")),new $e(oe.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&FU(e.screen.mediaSource);const k={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};x.debug("[".concat(n,"] getUserMedia: ").concat(JSON.stringify(k))),$f(c,await navigator.mediaDevices.getUserMedia(k))}}var f,m;if(!e.video&&!e.audio)return c;let _={video:e.video,audio:e.audio},y=de("MEDIA_DEVICE_CONSTRAINTS");if(y)try{typeof y=="string"&&(y=JSON.parse(y)),_=Gw(_,y)}catch{}x.debug("[".concat(n,"] GetUserMedia"),JSON.stringify(_)),Mn();let T,A=null;(Vo()||vs()||YE())&&(A=await mR.lock());try{T=await navigator.mediaDevices.getUserMedia(_)}catch(k){throw A&&A(),k}return _.audio&&(XU=!0),_.video&&(JU=!0),$f(c,T),A&&A(),c}function cy(e,n){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new $e(oe.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(n));case"NotFoundError":case"DevicesNotFoundError":return new $e(oe.DEVICE_NOT_FOUND,"".concat(e,": ").concat(n));case"NotSupportedError":return new $e(oe.NOT_SUPPORTED,"".concat(e,": ").concat(n));case"NotReadableError":return new $e(oe.NOT_READABLE,"".concat(e,": ").concat(n));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new $e(oe.PERMISSION_DENIED,"".concat(e,": ").concat(n));case"ConstraintNotSatisfiedError":return new $e(oe.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(n));default:return x.error("getUserMedia unexpected error",e),new $e(oe.UNEXPECTED_ERROR,"".concat(e,": ").concat(n))}}function $f(e,n){const r=e.getVideoTracks()[0],i=e.getAudioTracks()[0],c=n.getVideoTracks()[0],u=n.getAudioTracks()[0];u&&(i&&e.removeTrack(i),e.addTrack(u)),c&&(r&&e.removeTrack(r),e.addTrack(c))}const Pi=new class extends Dr{get state(){return this._state}set state(e){e!==this._state&&(this.emit(jd.STATE_CHANGE,e),this._state=e)}constructor(){super(),xe(this,"_state",dv.IDLE),xe(this,"isAccessMicrophonePermission",!1),xe(this,"isAccessCameraPermission",!1),xe(this,"lastAccessMicrophonePermission",!1),xe(this,"lastAccessCameraPermission",!1),xe(this,"checkdeviceMatched",!1),xe(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(de("ENUMERATE_DEVICES_INTERVAL")||(qE()||zE()===yo.HARMONY_OS)&&Il())&&this.updateDevicesInfo()},de("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(e=>x.error(e.toString()))}async enumerateDevices(e,n){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new $e(oe.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const i=await navigator.mediaDevices.enumerateDevices(),c=this.checkMediaDeviceInfoIsOk(i);let u=!this.isAccessMicrophonePermission&&e,f=!this.isAccessCameraPermission&&n;c.audio&&(u=!1),c.video&&(f=!1);let m=null,_=null,y=null;if(!r&&(u||f)){if(mR.isLocked&&(x.debug("[device manager] wait GUM lock"),(await mR.lock())(),x.debug("[device manager] GUM unlock")),XU&&(u=!1,this.isAccessMicrophonePermission=!0),JU&&(f=!1,this.isAccessCameraPermission=!0),x.debug("[device manager] check media device permissions",e,n,u,f),u&&f){try{y=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(T){const A=cy(T.name||T.code||T,T.message);if(A.code===oe.PERMISSION_DENIED)throw A;x.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(u){try{m=await navigator.mediaDevices.getUserMedia({audio:e})}catch(T){const A=cy(T.name||T.code||T,T.message);if(A.code===oe.PERMISSION_DENIED)throw A;x.warning("getUserMedia failed in getDevices",A)}this.isAccessMicrophonePermission=!0}else if(f){try{_=await navigator.mediaDevices.getUserMedia({video:n})}catch(T){const A=cy(T.name||T.code||T,T.message);if(A.code===oe.PERMISSION_DENIED)throw A;x.warning("getUserMedia failed in getDevices",A)}this.isAccessCameraPermission=!0}x.debug("[device manager] mic permission",e,"cam permission",n)}try{const T=await navigator.mediaDevices.enumerateDevices();return m&&m.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),y&&y.getTracks().forEach(A=>A.stop()),m=null,_=null,y=null,T}catch(T){return m&&m.getTracks().forEach(A=>A.stop()),_&&_.getTracks().forEach(A=>A.stop()),y&&y.getTracks().forEach(A=>A.stop()),m=null,_=null,y=null,new $e(oe.ENUMERATE_DEVICES_FAILED,T.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(n=>n.kind==="audioinput")}async getCamerasDevices(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter(n=>n.kind==="videoinput")}async getSpeakers(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter(n=>n.kind==="audiooutput")}searchDeviceIdByName(e){let n=null;return this.deviceInfoMap.forEach(r=>{r.device.label===e&&(n=r.device.deviceId)}),n}async getDeviceById(e){const n=(await this.enumerateDevices(!0,!0,!0)).find(r=>r.deviceId===e);if(!n)throw new $e(oe.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return n}async init(){this.state=dv.INITING;try{await this.updateDevicesInfo(),this.state=dv.INITEND}catch(e){throw x.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=dv.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new $e(oe.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),n=Date.now(),r=[];if(e[0]&&e[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const c=e.find(f=>f.kind==="audioinput"&&f.deviceId==="default"),u=e.find(f=>f.kind==="audiooutput"&&f.deviceId==="default");c&&u?u.groupId===c.groupId?x.debug("[device-check] default input ".concat(c.label," and output ").concat(u.label," is the same group")):x.debug("[device-check] default input ".concat(c.label," and output ").concat(u.label," is not the same group")):x.debug("[device-check] default input or output not found")}const i=this.checkMediaDeviceInfoIsOk(e);if(e.forEach(c=>{if(!c.deviceId)return;const u=this.deviceInfoMap.get("".concat(c.kind,"_").concat(c.deviceId));if((u?u.state:"INACTIVE")!=="ACTIVE"){const f={initAt:n,updateAt:n,device:c,state:"ACTIVE"};this.deviceInfoMap.set("".concat(c.kind,"_").concat(c.deviceId),f),r.push(f)}u&&(u.updateAt=n)}),this.deviceInfoMap.forEach((c,u)=>{c.state==="ACTIVE"&&c.updateAt!==n&&(c.state="INACTIVE",r.push(c))}),this.state!==dv.INITEND)return i.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(i.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));r.forEach(c=>{switch(c.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(jd.RECORDING_DEVICE_CHANGED,c);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(jd.CAMERA_DEVICE_CHANGED,c);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(jd.PLAYOUT_DEVICE_CHANGED,c)}}),i.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),i.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const n=e.filter(c=>c.kind==="audioinput"),r=e.filter(c=>c.kind==="videoinput"),i={audio:!1,video:!1};for(const c of n)if(c.label&&c.deviceId){i.audio=!0;break}for(const c of r)if(c.label&&c.deviceId){i.video=!0;break}return i}};let vR=!1;const Di=new class extends Dr{constructor(){super(...arguments),xe(this,"onAutoplayFailed",void 0),xe(this,"onAudioAutoplayFailed",void 0)}};function ZU(){if(Mn(),!vR){const e=n=>{n.preventDefault(),vR=!1,nv()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};vR=!0,nv()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),x.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),Di.onAutoplayFailed?Di.onAutoplayFailed():Di.onAudioAutoplayFailed?x.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):x.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),Di.emit("autoplay-failed")}}function QU(e,n,r,i){if(!e)return;const c=Bt.getBaseInfoBySessionId(e);if(!c)return;const u=c.info,f=Date.now(),m=kr(kr({},u),{},{vid:u.vid===void 0?0:Number(u.vid),lts:f,elapse:f-c.startTime,cbRegistered:Di.onAutoplayFailed||Di.onAudioAutoplayFailed?1:-1,errorMsg:r,mediaType:n,trackId:i,extend:void 0});Bt.send({type:Nr.AUTOPLAY_FAILED,data:m},!0)}const Sae=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],As=new class{constructor(){xe(this,"onAutoplayFailed",void 0),xe(this,"elementMap",new Map),xe(this,"elementStateMap",new Map),xe(this,"elementsNeedToResume",[]),xe(this,"sinkIdMap",new Map),xe(this,"autoResumeAfterInterruption",e=>{Array.from(this.elementMap.entries()).forEach(n=>{let[r,i]=n;const c=this.elementStateMap.get(r),u=i.srcObject.getAudioTracks()[0],f=u&&u.readyState;if(x.debug("resume after interrupted, ele: ".concat(c," audio: ").concat(f," ").concat(e)),f==="live"){if(e)return i.pause(),void i.play();if(nr.curState==="running")return Af()?(i.pause(),void i.play()):void(c&&c==="paused"&&i.play())}})}),xe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(e=>{let[n,r]=e;const i=r.srcObject.getAudioTracks()[0];i&&i.readyState==="live"&&(x.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),r.pause(),r.play())})}),this.autoResumeAudioElement(),nr.on(Mo.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nr.on(Mo.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),nr.on(Mo.STATE_CHANGE,()=>{vs()&&nr.prevState==="suspended"&&nr.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(e,n){const r=this.elementMap.get(e);if(this.sinkIdMap.set(e,n),r)try{await r.setSinkId(n)}catch(i){throw new $e(oe.PERMISSION_DENIED,"can not set sink id: "+i.toString())}}play(e,n,r,i){if(this.elementMap.has(n))return;const c=document.createElement("audio");c.autoplay=!0,c.srcObject=new MediaStream([e]),this.bindAudioElementEvents(n,c),this.elementMap.set(n,c),this.elementStateMap.set(n,ts.INIT),this.setVolume(n,r);const u=this.sinkIdMap.get(n);if(u)try{c.setSinkId(u).catch(m=>{x.warning("[".concat(n,"] set sink id failed"),m.toString())})}catch(m){x.warning("[".concat(n,"] set sink id failed"),m.toString())}const f=c.play();f&&f.then&&f.catch(m=>{i&&QU(i,"audio",m.message,n),x.warning("audio element play warning",m.toString()),this.elementMap.has(n)&&m.name==="NotAllowedError"&&(x.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(c),JE(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),ZU()}))})}updateTrack(e,n){const r=this.elementMap.get(e);r&&(r.srcObject=new MediaStream([n]))}isPlaying(e){return this.elementMap.has(e)&&this.elementStateMap.get(e)==="playing"}setVolume(e,n){const r=this.elementMap.get(e);r&&(n=Math.max(0,Math.min(100,n)),r.volume=n/100)}stop(e){const n=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!n)return;const r=this.elementsNeedToResume.indexOf(n);this.elementsNeedToResume.splice(r,1),n.srcObject=null,n.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,n){Sae.forEach(r=>{n.addEventListener(r,i=>{const c=this.elementStateMap.get(e),u=i.type==="pause"?"paused":i.type;if(x.debug("[".concat(e,"] audio-element-status change ").concat(c," => ").concat(u)),i.type==="error"){const f=n==null?void 0:n.error;f&&x.error("[".concat(e,"] media error, code: ").concat(f.code,", message: ").concat(f.message))}this.elementStateMap.set(e,u)})})}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach(n=>{n.play().then(r=>{x.debug("Auto resume audio element success")}).catch(r=>{x.warning("Auto resume audio element failed!",r)})}),this.elementsNeedToResume=[]};new bt(n=>{document.body?n():window.addEventListener("load",()=>n())}).then(()=>{nv()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))})}};function Yr(){return function(e,n,r){const i=r.value;return typeof i=="function"&&(r.value=function(){this._isClosed&&new $e(oe.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",x);for(var c=arguments.length,u=new Array(c),f=0;f<c;f++)u[f]=arguments[f];const m=i.apply(this,u);return m instanceof bt?new bt((_,y)=>{m.then(_).catch(y)}):m}),r}}class eV extends Dr{constructor(n){super(),xe(this,"name","VideoProcessorDestination"),xe(this,"ID","0"),xe(this,"_source",void 0),xe(this,"videoContext",void 0),xe(this,"inputTrack",void 0),this.videoContext=n}get kind(){return"video"}get enabled(){return!0}pipe(){throw new $e(oe.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new $e(oe.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(n){if(n.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);n.track&&n.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=n.track,this.emit(gs.ON_TRACK,n.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(gs.ON_TRACK,void 0)}}class tV extends Dr{set chained(n){this._chained=n}get chained(){return this._chained}constructor(n,r){super(),xe(this,"constraintsMap",new Map),xe(this,"statsRegistry",[]),xe(this,"usageRegistry",[]),xe(this,"trackId",void 0),xe(this,"direction",void 0),xe(this,"_chained",!1),this.trackId=n,this.direction=r}async getConstraints(){return await Bo(this,Oi.REQUEST_CONSTRAINTS)}async requestApplyConstraints(n,r){var i;return x.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),n&&this.constraintsMap.set(r,n),ur(this,Oi.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ti(i=this.constraintsMap).call(i)))}async requestRevertConstraints(n){var r;if(this.constraintsMap.has(n))return x.info("processor ".concat(n.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(n),ur(this,Oi.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ti(r=this.constraintsMap).call(r)))}registerStats(n,r,i){this.statsRegistry.find(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r)||this.statsRegistry.push({processorName:n.name,processorID:n.ID,type:r,cb:i})}unregisterStats(n,r){const i=this.statsRegistry.findIndex(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r);i!==-1&&this.statsRegistry.splice(i,1)}gatherStats(){const n=[];for(const{processorID:r,processorName:i,type:c,cb:u}of this.statsRegistry)try{const f=u();n.push({processorID:r,processorName:i,type:c,stats:f})}catch(f){x.error(new $e(oe.UNEXPECTED_ERROR,f.message))}return n}registerUsage(n,r){this.usageRegistry.find(i=>i.processorID===n.ID&&i.processorName===n.name)||this.usageRegistry.push({processorID:n.ID,processorName:n.name,cb:r})}unregisterUsage(n){const r=this.usageRegistry.findIndex(i=>i.processorID===n.ID&&i.processorName===n.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const n=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let i=r();i instanceof bt&&(i=await i),n.push(kr(kr({},i),{},{direction:this.direction}))}catch(i){x.error("gather extension usage error",i)}return n}getDirection(){return this.direction}}class nV extends Dr{constructor(n){super(),xe(this,"name","AudioProcessorDestination"),xe(this,"ID","0"),xe(this,"inputTrack",void 0),xe(this,"inputNode",void 0),xe(this,"audioProcessorContext",void 0),xe(this,"_source",void 0),this.audioProcessorContext=n}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new $e(oe.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new $e(oe.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(gs.ON_TRACK,void 0),this.emit(gs.ON_NODE,void 0)}updateInput(n){if(n.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);n.track&&this.inputTrack!==n.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=n.track,this.emit(gs.ON_TRACK,this.inputTrack)),n.node&&this.inputNode!==n.node&&(this.audioProcessorContext.chained=!0,this.inputNode=n.node,this.emit(gs.ON_NODE,this.inputNode))}}class rV extends Dr{set chained(n){this._chained=n}get chained(){return this._chained}constructor(n,r,i){super(),xe(this,"constraintsMap",new Map),xe(this,"statsRegistry",[]),xe(this,"audioContext",void 0),xe(this,"trackId",void 0),xe(this,"direction",void 0),xe(this,"usageRegistry",[]),xe(this,"_chained",!1),this.audioContext=n,this.trackId=r,this.direction=i}async getConstraints(){return Bo(this,Oi.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(n,r){var i;return x.info("processor ".concat(r.name," requestApplyConstraints for ").concat(this.trackId)),n&&this.constraintsMap.set(r,n),ur(this,Oi.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ti(i=this.constraintsMap).call(i)))}async requestRevertConstraints(n){var r;if(this.constraintsMap.has(n))return this.constraintsMap.delete(n),ur(this,Oi.REQUEST_UPDATE_CONSTRAINTS,Array.from(Ti(r=this.constraintsMap).call(r)))}registerStats(n,r,i){this.statsRegistry.find(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r)||this.statsRegistry.push({processorName:n.name,processorID:n.ID,type:r,cb:i})}unregisterStats(n,r){const i=this.statsRegistry.findIndex(c=>c.processorID===n.ID&&c.processorName===n.name&&c.type===r);i!==-1&&this.statsRegistry.splice(i,1)}gatherStats(){const n=[];for(const{processorID:r,processorName:i,type:c,cb:u}of this.statsRegistry)try{const f=u();n.push({processorID:r,processorName:i,type:c,stats:f})}catch(f){x.error(new $e(oe.UNEXPECTED_ERROR,f.message))}return n}registerUsage(n,r){this.usageRegistry.find(i=>i.processorID===n.ID&&i.processorName===n.name)||this.usageRegistry.push({processorID:n.ID,processorName:n.name,cb:r})}unregisterUsage(n){const r=this.usageRegistry.findIndex(i=>i.processorID===n.ID&&i.processorName===n.name);r!==-1&&this.usageRegistry.splice(r,1)}async gatherUsage(){const n=[];if(!this.chained)return[];for(const{cb:r}of this.usageRegistry)try{let i=r();i instanceof bt&&(i=await i),n.push(kr(kr({},i),{},{direction:this.direction}))}catch(i){x.error("gather extension usage error",i)}return n}getDirection(){return this.direction}}class gR extends Dr{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),xe(this,"context",void 0),xe(this,"processSourceNode",void 0),xe(this,"outputTrack",void 0),xe(this,"processedNode",void 0),xe(this,"clonedTrack",void 0),xe(this,"outputNode",void 0),this.outputNode=new Tae}setVolume(){}createOutputTrack(){throw new $e(oe.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class Tae{disconnect(){}connect(){}}function oV(e){return new bt((n,r)=>{let i=!1;const c=document.createElement("video");c.setAttribute("autoplay",""),c.setAttribute("muted",""),c.muted=!0,c.autoplay=!0,c.setAttribute("playsinline",""),c.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(c);const u=vs()?"canplay":"playing";c.addEventListener(u,()=>{const f=c.videoWidth,m=c.videoHeight;!f&&Ur()||(i=!0,c.srcObject=null,c.remove(),n([f,m]))}),c.srcObject=new MediaStream([e]),c.play().catch(ZE),setTimeout(()=>{i||(c.srcObject=null,c.remove(),n([c.videoWidth,c.videoHeight]))},4e3)})}function ly(e){const n={};e.facingMode&&(n.facingMode=e.facingMode),e.cameraId&&(n.deviceId={exact:e.cameraId});const r=Bc(e.encoderConfig);return r.width!=null&&(n.width=r.width),r.height!=null&&(n.height=r.height),!nU()&&r.frameRate&&(n.frameRate=r.frameRate),Yx()&&typeof n.frameRate=="object"&&(n.frameRate.max=60),Ur()&&(n.frameRate={ideal:30,max:30}),n}function sV(e){const n={};return nU()||(e.AGC!==void 0&&(n.autoGainControl=e.AGC),e.AEC!==void 0&&(n.echoCancellation=e.AEC),e.ANS!==void 0&&(n.noiseSuppression=e.ANS,Rl()&&e.ANS&&(n.googHighpassFilter=e.ANS))),n}function iV(e){const n=sV(e);if(e.encoderConfig){const r=iy(e.encoderConfig);n.channelCount=r.stereo?2:1,n.sampleRate=r.sampleRate,n.sampleSize=r.sampleSize}return e.microphoneId&&(n.deviceId={exact:e.microphoneId}),qE()&&(n.sampleRate=void 0),n}const Cae=e=>{const n=e._encoderConfig;if(!n)return;const{frameRate:r,width:i,height:c}=e.getMediaStreamTrackSettings();let{frameRate:u=r,width:f=i,height:m=c}=n;if(!u||!f||!m)return;f=zw(f),m=zw(m),u=zw(u);const{max:_,min:y}=function(P,q,j){const H=200*Math.pow(j/15,.6)*Math.pow(P*q/640/360,.75);return{min:Math.floor(H),max:Math.floor(4*H)}}(f,m,u),{bitrateMax:T,bitrateMin:A}=n||{};T||x.debug("calculate bitrate: [w: ".concat(f,", h: ").concat(m,", fps: ").concat(u,"] => [brMax: ").concat(T,", brMin: ").concat(A,"]"));const{maxFramerate:k}=de("ENCODER_CONFIG_LIMIT");return k&&typeof k=="number"&&(u=Math.min(u,k)),{frameRate:u,bitrateMax:T||_,bitrateMin:A||y,scaleResolutionDownBy:1,scale:0}},aV=async(e,n,r)=>await(async(i,c,u)=>{const f=function(y){const T=[];for(let A=0;A<y.length;A+=2)T.push(parseInt(y.slice(A,A+2),16));return Uint8Array.from(T)}(_U(""+c+u)).slice(0,16),m=f.slice(0,12),_=await window.crypto.subtle.importKey("raw",f,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:m},_,i))})(e.buffer,n,r),_R=e=>{const n=document.createElement("canvas");return n.width=2,n.height=2,new bt((r,i)=>{n.toBlob(async c=>{if(n.remove(),c){const u=await cV(c);r({buffer:u,width:n.width,height:n.height})}else i(new $e(oe.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},e,1)})},cV=async e=>{const n=await e.arrayBuffer();return new Uint8Array(n)};var lV,uV,dV,hV,fV,pV,mV,vV,gV,_V,EV,yV,bV,SV,TV,CV,wV,RV,Lr,IV,AV,OV,NV,kV,PV,$c,DV,LV,MV,xV,UV,VV,FV,BV,jV,$V,HV,WV,KV,$o;let Hr=(lV=Xt({argsMap:(e,n)=>[e.getTrackId(),n],throttleTime:300}),uV=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),dV=Yr(),hV=kf("LocalAudioTrack","_enabledMutex"),fV=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),pV=Yr(),mV=kf("LocalAudioTrack","_enabledMutex"),vV=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),gV=Yr(),_V=Yr(),EV=Yr(),yV=Xt({argsMap:e=>[e.getTrackId()]}),bV=Yr(),SV=Xt({argsMap:e=>[e.getTrackId()]}),TV=Yr(),CV=Xt({argsMap:e=>[e.getTrackId()]}),wV=Xt({argsMap:(e,n)=>[e.getTrackId(),n.name]}),RV=Xt({argsMap:e=>[e.getTrackId()]}),Un((Lr=class extends Bf{get _source(){return this.initWebAudio()}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?As.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,n,r,i){super(e,r),xe(this,"trackMediaType",Ff.AUDIO),xe(this,"_encoderConfig",void 0),xe(this,"_trackSource",void 0),xe(this,"metadata",[]),xe(this,"_enabled",!0),xe(this,"_volume",100),xe(this,"_useAudioElement",!0),xe(this,"_bypassWebAudio",!1),xe(this,"processor",void 0),xe(this,"_processorContext",void 0),xe(this,"_processorDestination",void 0),xe(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=n,this._getOriginVolumeLevel=!!i,this._trackSource=new gR,de("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),de("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),Vo()&&!Ni?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(e){sr(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&As.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void x.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const n=this._source.createOutputTrack();this._mediaStreamTrack!==n&&(this._mediaStreamTrack=n,ur(this,Pt.NEED_REPLACE_TRACK,this).then(()=>{x.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(r=>{x.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),r)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!UU())throw new $e(oe.NOT_SUPPORTED,"your browser does not support setting the audio output device");await As.setSinkID(this.getTrackId(),e)}async setEnabled(e,n,r){return this._setEnabled(e,n,r)}async _setEnabled(e,n,r){if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(x.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{r||(this._enabled=!0),await ur(this,Pt.NEED_ENABLE_TRACK,this),x.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(i){throw r||(this._enabled=!1),x.error("[".concat(this.getTrackId(),"] setEnabled to true error"),i.toString()),i}}else{this._originMediaStreamTrack.enabled=!1,r||(this._enabled=!1);try{await ur(this,Pt.NEED_DISABLE_TRACK,this)}catch(i){throw r||(this._enabled=!0),x.error("[".concat(this.getTrackId(),"] setEnabled to false error"),i.toString()),i}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,x.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await ur(this,Pt.NEED_MUTE_TRACK,this):await ur(this,Pt.NEED_UNMUTE_TRACK,this))}getStats(){return wu(()=>{x.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),wi(this,Pt.GET_STATS)||kr({},uR)}setAudioFrameCallback(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Ai.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(Ai.ON_AUDIO_BUFFER),this._source.on(Ai.ON_AUDIO_BUFFER,r=>e(r))}play(){x.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(x.debug("[".concat(this.getTrackId(),"] start audio playback in element")),As.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){x.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?As.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];x.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&As.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,n){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:e,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ur(this,Pt.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return bt.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new $e(oe.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new $e(oe.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const n=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(e){e.on(gs.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(n),await ur(this,Pt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ur(this,Pt.NEED_REPLACE_TRACK,this))}),e.on(gs.ON_NODE,n=>{this._source.processedNode=n})}unbindProcessorDestinationEvents(e){e.removeAllListeners(gs.ON_TRACK),e.removeAllListeners(gs.ON_NODE)}bindProcessorContextEvents(e){e.on(Oi.REQUEST_CONSTRAINTS,async n=>{n(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(e){e.removeAllListeners(Oi.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof gR&&(this._trackSource=new zU(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const e=new rV(this._source.context,this.getTrackId(),"local"),n=new nV(e);return this._processorContext=e,this._processorDestination=n,this.bindProcessorContextEvents(e),this.bindProcessorDestinationEvents(n),this._source.on(Ai.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:e})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(As.stop(this.getTrackId()),this._source.play()),ur(this,Pt.NEED_REPLACE_MIXING_TRACK,this).then(()=>{x.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(r=>{x.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),r)})),{processorContext:e,processorDestination:n}}}).prototype,"setVolume",[lV],Object.getOwnPropertyDescriptor(Lr.prototype,"setVolume"),Lr.prototype),Un(Lr.prototype,"setPlaybackDevice",[uV,dV],Object.getOwnPropertyDescriptor(Lr.prototype,"setPlaybackDevice"),Lr.prototype),Un(Lr.prototype,"setEnabled",[hV,fV,pV],Object.getOwnPropertyDescriptor(Lr.prototype,"setEnabled"),Lr.prototype),Un(Lr.prototype,"setMuted",[mV,vV,gV],Object.getOwnPropertyDescriptor(Lr.prototype,"setMuted"),Lr.prototype),Un(Lr.prototype,"getStats",[_V],Object.getOwnPropertyDescriptor(Lr.prototype,"getStats"),Lr.prototype),Un(Lr.prototype,"setAudioFrameCallback",[EV],Object.getOwnPropertyDescriptor(Lr.prototype,"setAudioFrameCallback"),Lr.prototype),Un(Lr.prototype,"play",[yV,bV],Object.getOwnPropertyDescriptor(Lr.prototype,"play"),Lr.prototype),Un(Lr.prototype,"stop",[SV,TV],Object.getOwnPropertyDescriptor(Lr.prototype,"stop"),Lr.prototype),Un(Lr.prototype,"close",[CV],Object.getOwnPropertyDescriptor(Lr.prototype,"close"),Lr.prototype),Un(Lr.prototype,"pipe",[wV],Object.getOwnPropertyDescriptor(Lr.prototype,"pipe"),Lr.prototype),Un(Lr.prototype,"unpipe",[RV],Object.getOwnPropertyDescriptor(Lr.prototype,"unpipe"),Lr.prototype),Lr),uy=(IV=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),AV=Yr(),OV=kf("MicrophoneAudioTrack","_enabledMutex"),NV=Xt({argsMap:(e,n,r)=>[e.getTrackId(),n,r]}),kV=Yr(),PV=Xt({argsMap:e=>[e.getTrackId()]}),Un(($c=class extends Hr{get __className__(){return"MicrophoneAudioTrack"}constructor(e,n,r,i){super(e,n.encoderConfig?iy(n.encoderConfig):{},i,de("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),xe(this,"_config",void 0),xe(this,"_deviceName","default"),xe(this,"_constraints",void 0),xe(this,"_originalConstraints",void 0),xe(this,"_enabled",!0),this._config=n,this._constraints=r,this._originalConstraints=r,this._deviceName=e.label,typeof n.bypassWebAudio=="boolean"&&(this._bypassWebAudio=n.bypassWebAudio),(Af()||Fw())&&nr.bindInterruptDetectorTrack(this)}async setDevice(e){if(x.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const n=await Pi.getDeviceById(e),r={};r.audio=kr({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let i=null;try{i=await ki(r,this.getTrackId())}catch(c){throw x.error("[".concat(this.getTrackId(),"] setDevice failed"),c.toString()),i=await ki({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),c}await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),this._deviceName=n.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw x.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}else try{const n=await Pi.getDeviceById(e);this._deviceName=n.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw x.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),n}x.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,n,r){if(n)return x.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!r){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(x.info("[".concat(this.getTrackId(),"] start setEnabled"),e),de("AUTO_RESET_AUDIO_ROUTE")&&(vs()||Sa())){const f=navigator.audioSession;f&&(e||(f.type="playback"),f.type="auto")}if(!e){var i;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(i=this._source.clonedTrack)===null||i===void 0||i.stop(),r||(this._enabled=!1);try{await ur(this,Pt.NEED_DISABLE_TRACK,this)}catch(f){throw x.error("[".concat(this.getTrackId(),"] setEnabled false failed"),f.toString()),f}return}const c=kr({},this._constraints),u=Pi.searchDeviceIdByName(this._deviceName);u&&!c.deviceId&&(c.deviceId=u);try{r||(this._enabled=!0);const f=await ki({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(f.getAudioTracks()[0],!1),await ur(this,Pt.NEED_ENABLE_TRACK,this)}catch(f){throw r||(this._enabled=!1),x.error("[".concat(this.getTrackId(),"] setEnabled true failed"),f.toString()),f}x.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Af()||Fw())&&nr.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((vs()||Sa())&&this._enabled&&!this._isClosed&&nr.duringInterruption){const e=async()=>{nr.off(Mo.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(x.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};nr.on(Mo.IOS_INTERRUPTION_END,e)}else x.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Uf.TRACK_ENDED)}async renewMediaStreamTrack(e){const n=e||this._constraints,r=Pi.searchDeviceIdByName(this._deviceName);if(r&&!n.deviceId&&(n.deviceId=r),this._constraints=n,this._enabled){this._originMediaStreamTrack.stop();const i=await ki({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!0)}}bindProcessorContextEvents(e){super.bindProcessorContextEvents(e),e.on(Oi.REQUEST_UPDATE_CONSTRAINTS,async(n,r,i)=>{try{const c=Object.assign({},this._originalConstraints,...n);await this.renewMediaStreamTrack(c),r()}catch(c){i(c)}})}unbindProcessorContextEvents(e){super.unbindProcessorContextEvents(e),e.removeAllListeners(Oi.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[IV,AV],Object.getOwnPropertyDescriptor($c.prototype,"setDevice"),$c.prototype),Un($c.prototype,"setEnabled",[OV,NV,kV],Object.getOwnPropertyDescriptor($c.prototype,"setEnabled"),$c.prototype),Un($c.prototype,"close",[PV],Object.getOwnPropertyDescriptor($c.prototype,"close"),$c.prototype),$c),wae=(DV=Xt({argsMap:(e,n)=>[e.getTrackId(),n,e.duration]}),LV=Yr(),MV=Xt({argsMap:e=>[e.getTrackId()]}),xV=Yr(),UV=Xt({argsMap:e=>[e.getTrackId()]}),VV=Yr(),FV=Xt({argsMap:e=>[e.getTrackId()]}),BV=Yr(),jV=Xt({argsMap:e=>[e.getTrackId()]}),$V=Yr(),HV=Xt({argsMap:e=>[e.getTrackId()]}),WV=Xt({argsMap:e=>[e.getTrackId()]}),KV=Yr(),Un(($o=class extends Hr{get __className__(){return"BufferSourceAudioTrack"}constructor(e,n,r,i){super(n.createOutputTrack(),r,i),xe(this,"source",void 0),xe(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=e,this._bufferSource=n,this._bufferSource.on(Ai.AUDIO_SOURCE_STATE_CHANGE,c=>{this.safeEmit(Uf.SOURCE_STATE_CHANGE,c)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){sr(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}).prototype,"startProcessAudioBuffer",[DV,LV],Object.getOwnPropertyDescriptor($o.prototype,"startProcessAudioBuffer"),$o.prototype),Un($o.prototype,"pauseProcessAudioBuffer",[MV,xV],Object.getOwnPropertyDescriptor($o.prototype,"pauseProcessAudioBuffer"),$o.prototype),Un($o.prototype,"seekAudioBuffer",[UV,VV],Object.getOwnPropertyDescriptor($o.prototype,"seekAudioBuffer"),$o.prototype),Un($o.prototype,"resumeProcessAudioBuffer",[FV,BV],Object.getOwnPropertyDescriptor($o.prototype,"resumeProcessAudioBuffer"),$o.prototype),Un($o.prototype,"stopProcessAudioBuffer",[jV,$V],Object.getOwnPropertyDescriptor($o.prototype,"stopProcessAudioBuffer"),$o.prototype),Un($o.prototype,"close",[HV],Object.getOwnPropertyDescriptor($o.prototype,"close"),$o.prototype),Un($o.prototype,"setAudioBufferPlaybackSpeed",[WV,KV],Object.getOwnPropertyDescriptor($o.prototype,"setAudioBufferPlaybackSpeed"),$o.prototype),$o);class ho extends Hr{get __className__(){return"MixingAudioTrack"}get isActive(){for(const n of this.trackList)if(n._enabled&&!n._isClosed&&!n.muted)return!0;return!1}constructor(){const n=jf().createMediaStreamDestination();super(n.stream.getAudioTracks()[0],void 0,dr(8,"track-mix-")),xe(this,"trackList",void 0),xe(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=n,this.trackList=[]}hasAudioTrack(n){return this.trackList.indexOf(n)!==-1}addAudioTrack(n){this.trackList.indexOf(n)===-1?(x.debug("add ".concat(n.getTrackId()," to mixing track")),n._source.outputNode.connect(this.destNode),this.trackList.push(n),this.updateEncoderConfig()):x.debug("track ".concat(n.getTrackId()," is already added"))}removeAudioTrack(n){if(this.trackList.indexOf(n)!==-1){x.debug("remove ".concat(n.getTrackId()," from mixing track"));try{n._source.outputNode.disconnect(this.destNode)}catch{}XE(this.trackList,n),this.updateEncoderConfig()}}updateEncoderConfig(){const n={};this.trackList.forEach(r=>{r._encoderConfig&&((r._encoderConfig.bitrate||0)>(n.bitrate||0)&&(n.bitrate=r._encoderConfig.bitrate),(r._encoderConfig.sampleRate||0)>(n.sampleRate||0)&&(n.sampleRate=r._encoderConfig.sampleRate),(r._encoderConfig.sampleSize||0)>(n.sampleSize||0)&&(n.sampleSize=r._encoderConfig.sampleSize),r._encoderConfig.stereo&&(n.stereo=!0))}),this._encoderConfig=n}_updateRtpTransceiver(n){this._rtpTransceiver!==n&&(this._rtpTransceiver=n,this.trackList.forEach(r=>{r instanceof ho?r.emit(Bd.TRANSCEIVER_UPDATED,n):r._updateRtpTransceiver(n)}))}}class Rae extends GU{set currentState(n){n!==this._currentState&&(this._currentState=n,this.safeEmit(Ai.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),xe(this,"audioBuffer",void 0),xe(this,"sourceNode",void 0),xe(this,"startPlayTime",0),xe(this,"startPlayOffset",0),xe(this,"pausePlayTime",0),xe(this,"options",void 0),xe(this,"currentLoopCount",0),xe(this,"currentPlaybackSpeed",100),xe(this,"_currentState","stopped"),this.audioBuffer=n,this.options=r,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(n){this.currentState==="stopped"?(this.options=n,this.startPlayOffset=this.options.startPlayTime||0):x.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(n){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=n,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=n))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(n){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=n/100),this.currentPlaybackSpeed=n}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const n=this.context.createBufferSource();return n.buffer=this.audioBuffer,n.loop=!!this.options.loop,n.connect(this.outputNode),n.playbackRate.value=this.currentPlaybackSpeed/100,n}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const GV=new Map;class ER{get rendFrameRate(){if(this.renderStats&&this.renderStats.curTs!==this.renderStats.lastTs){const n=this.renderStats.curTs-this.renderStats.lastTs,r=(this.renderStats.renderNum-this.renderStats.lastRenderNum)/n;return this.renderStats.lastRenderNum=this.renderStats.renderNum,this.renderStats.lastTs=this.renderStats.curTs,r}return 0}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(n){n!==this._videoElementStatus&&(x.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(n)),this._videoElementStatus=n)}get videoState(){return this._videoState}set videoState(n){var r;n!==this._videoState&&(this._videoState=n,(r=this.onVideoStateChanged)===null||r===void 0||r.call(this,this.videoState))}constructor(n){xe(this,"trackId",void 0),xe(this,"config",void 0),xe(this,"onFirstVideoFrameDecoded",void 0),xe(this,"onVideoStateChanged",void 0),xe(this,"freezeTimeCounterList",[]),xe(this,"renderFreezeAccTime",0),xe(this,"isKeepLastFrame",!1),xe(this,"timeUpdatedCount",0),xe(this,"freezeTime",0),xe(this,"playbackTime",0),xe(this,"lastTimeUpdatedTime",0),xe(this,"autoplayFailed",!1),xe(this,"videoTrack",void 0),xe(this,"videoElement",void 0),xe(this,"cacheVideoElement",void 0),xe(this,"renderStats",void 0),xe(this,"_videoState",jc.VideoStateStopped),xe(this,"videoElementCheckInterval",void 0),xe(this,"videoElementFreezeTimeout",void 0),xe(this,"_videoElementStatus",ts.NONE),xe(this,"isGettingVideoDimensions",!1),xe(this,"startGetVideoDimensions",()=>{const r=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return x.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(r,500)};!this.isGettingVideoDimensions&&r()}),xe(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&nr.curState==="running"&&(x.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(zx())),eU()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),xe(this,"handleVideoEvents",r=>{switch(r.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=ts.PLAYING;break;case"loadeddata":if(this.videoState=jc.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=ts.CANPLAY;break;case"stalled":this.videoElementStatus=ts.STALLED;break;case"suspend":this.videoElementStatus=ts.SUSPEND;break;case"pause":this.videoElementStatus=ts.PAUSED,vs()||Sa()||Vo()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(x.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=ts.WAITING;break;case"abort":this.videoElementStatus=ts.ABORT;break;case"ended":this.videoElementStatus=ts.ENDED;break;case"emptied":this.videoElementStatus=ts.EMPTIED;break;case"error":{const i=this.videoElement.error;i&&(this.videoElementStatus=ts.ERROR,x.error("[".concat(this.trackId,"] media error: ").concat(i.message," (").concat(i.code,")")));break}case"timeupdate":{const i=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=i);const c=i-this.lastTimeUpdatedTime,u=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=i,Nl.lastVisibleTime<Nl.lastHiddenTime||u<Nl.lastHiddenTime||u<Nl.lastVisibleTime)return;for(c>de("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=c),this.playbackTime+=c;this.playbackTime>=6e3;){this.playbackTime-=6e3;const f=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(f),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),xe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(x.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(zx())),eU()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=n.trackId,this.config=n,n.element instanceof HTMLVideoElement?this.videoElement=n.element:this.videoElement=document.createElement("video"),nr.on(Mo.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nr.on(Mo.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var n;return(n=this.videoElement.parentElement)!==null&&n!==void 0?n:void 0}updateConfig(n){this.config=n,this.trackId=n.trackId,n.element!==this.videoElement&&(this.destroy(),this.videoElement=n.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(n){this.videoTrack!==n&&(this.videoTrack=n,this.initVideoElement())}play(n){const r=this.videoElement.play();r&&r.catch&&r.catch(c=>{n&&QU(n,"video",c.message,this.trackId),c.name==="NotAllowedError"?(x.warning("detected video element autoplay failed",c),this.autoplayFailed=!0,this.handleAutoPlayFailed()):x.warning("[".concat(this.trackId,"] play warning: "),c)});const i=Mn();if((i.name==="Safari"&&Number(i.version)===15||Af())&&r&&r.then){const c=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};r.then(c).catch(c)}}getCurrentFrame(){const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");if(!r)return x.error("create canvas context failed!"),new ImageData(2,2);r.drawImage(this.videoElement,0,0,n.width,n.height);const i=r.getImageData(0,0,n.width,n.height);return n.remove(),i}async getCurrentFrameToUint8Array(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.createElement("canvas");i.width=this.videoElement.videoWidth,i.height=this.videoElement.videoHeight;const c=i.getContext("2d");return c?(c.drawImage(this.videoElement,0,0,i.width,i.height),new bt((u,f)=>{i.toBlob(async m=>{if(i.remove(),m){const _=await cV(m);u({buffer:_,width:i.width,height:i.height})}else f(new $e(oe.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},n,r<0?.1:r>1?1:r)})):await _R(n)}destroy(){this.renderStats=void 0,nr.off(Mo.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),nr.off(Mo.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=jc.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=ts.INIT,!this.videoElementCheckInterval&&(zV.forEach(u=>{this.videoElement.addEventListener(u,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(u){return u!==document.body&&document.body.contains(u)})(this.videoElement)||(this.videoElementStatus=ts.DESTROYED)},1e3),de("ENABLE_VIDEO_FRAME_CALLBACK"))){var n,r;let u;const f=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",f),this.videoElementFreezeTimeout=window.setTimeout(m,de("VIDEO_FREEZE_DURATION")))},m=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===jc.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=jc.VideoStateFrozen:document.addEventListener("visibilitychange",f))},_=(y,T)=>{if(this.videoElementStatus===ts.PLAYING){if(this.renderStats?(this.renderStats.renderNum++,this.renderStats.curTs=T.mediaTime):this.renderStats={lastTs:T.mediaTime,curTs:T.mediaTime,lastRenderNum:0,renderNum:0},u){const P=T.presentationTime-u.presentationTime;this.videoState===jc.VideoStateStarting&&(this.videoState=jc.VideoStateDecoding),this.videoState===jc.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(m,de("VIDEO_FREEZE_DURATION"))),P<de("VIDEO_FREEZE_DURATION")&&this.videoState===jc.VideoStateFrozen&&(this.videoState=jc.VideoStateDecoding),P>de("VIDEO_FREEZE_DURATION")&&Nl.lastVisibleTime>=Nl.lastHiddenTime&&u.timestamp>Nl.lastVisibleTime&&u.timestamp>Nl.lastHiddenTime&&(this.renderFreezeAccTime+=P)}u=kr(kr({},T),{},{timestamp:y})}var A,k;de("ENABLE_VIDEO_FRAME_CALLBACK")&&((A=(k=this.videoElement).requestVideoFrameCallback)===null||A===void 0||A.call(k,_))};(n=(r=this.videoElement).requestVideoFrameCallback)===null||n===void 0||n.call(r,_)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),qE()&&!de("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const i=Mn();i.name==="Safari"&&Number(i.version)===15||Af()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ur()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ur()&&this.videoElement.load());const c=this.videoElement.play();c!==void 0&&c.catch(u=>{x.debug("[".concat(this.trackId,"] playback interrupted"),u.toString())})}resetVideoElement(){zV.forEach(n=>{this.videoElement&&this.videoElement.removeEventListener(n,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=ts.NONE}handleAutoPlayFailed(){const n=r=>{r.preventDefault(),this.videoElement.play().then(()=>{x.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(i=>{x.error(i)}),this.autoplayFailed=!1,nv()?document.body.removeEventListener("click",n,!0):(document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0))};nv()?document.body.addEventListener("click",n,!0):(document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)),ZU()}}const zV=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class YV extends ER{constructor(n){super(n),xe(this,"container",void 0),xe(this,"slot",void 0),this.slot=n.element,this.updateConfig(n)}updateConfig(n){this.config=n,this.trackId=n.trackId;const r=n.element;r!==this.slot&&(this.destroy(),this.slot=r),this.createElements()}updateVideoTrack(n){this.videoTrack!==n&&(this.videoTrack=n,this.createElements())}play(n){var r;(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)&&super.play(n)}getCurrentFrame(){var n;return(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(n){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(r=this.container)!==null&&r!==void 0&&r.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(n,i):await _R(n)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",de("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var n;!this.container||(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var n;if((n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var n;(n=this.container)!==null&&n!==void 0&&n.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var qV,XV,JV,ZV,QV,eF,tF,nF,rF,oF,sF,iF,aF,cF,lF,uF,dF,hF,fF,pF,mF,vF,gF,_F,Pn,EF,yF,bF,SF,TF,CF,wF,RF,Li;let Sr=(qV=Xt({argsMap:(e,n,r)=>[e.getTrackId(),typeof n=="string"?n:n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),XV=Yr(),JV=Xt({argsMap:e=>[e.getTrackId()]}),ZV=kf("LocalVideoTrack","_enabledMutex"),QV=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),eF=Yr(),tF=kf("LocalVideoTrack","_enabledMutex"),nF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),rF=Yr(),oF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),sF=Yr(),iF=Yr(),aF=Xt({argsMap:(e,n,r)=>[e.getTrackId(),n,r]}),cF=Yr(),lF=Yr(),uF=Yr(),dF=Yr(),hF=Yr(),fF=Yr(),pF=Yr(),mF=Xt({argsMap:(e,n)=>[e.getTrackId(),n.name]}),vF=Xt({argsMap:e=>[e.getTrackId()]}),gF=Xt({argsMap:e=>[e.getTrackId()]}),_F=Xt({argsMap:(e,n,r)=>[e.getTrackId(),n.label,r]}),Pn=class Bq extends Bf{get videoHeight(){if(Vo()){const{height:n}=this._mediaStreamTrack.getSettings();return this._videoHeight=n,this._videoHeight}return this._videoHeight}get videoWidth(){if(Vo()){const{width:n}=this._mediaStreamTrack.getSettings();return this._videoWidth=n,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ts.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(n){this._processorContext=n}get __className__(){return"LocalVideoTrack"}constructor(n,r,i,c,u,f){if(super(n,u),xe(this,"trackMediaType",Ff.VIDEO),xe(this,"_player",void 0),xe(this,"isUseScaleResolutionDownBy",!1),xe(this,"_videoVisibleTimer",null),xe(this,"_previousVideoVisibleStatus",void 0),xe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),xe(this,"_encoderConfig",void 0),xe(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),xe(this,"_optimizationMode",void 0),xe(this,"_videoHeight",void 0),xe(this,"_videoWidth",void 0),xe(this,"_forceBitrateLimit",void 0),xe(this,"_enabled",!0),xe(this,"_processorDestination",void 0),xe(this,"_processorContext",void 0),Vo()){const{width:m,height:_}=n.getSettings();this._videoWidth=m,this._videoHeight=_}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=r,this._scalabilityMode=i,this._optimizationMode=c,this._hints=f||[],this._hints.indexOf(hr.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(xw(jn.CHROME,115)&&zE().indexOf("Windows")!==-1){const m=function(_,y){if("VideoFrame"in window&&"TransformStream"in window&&Bn().supportWebRTCInsertableStream){const T=new MediaStreamTrackProcessor(_),A=new MediaStreamTrackGenerator({kind:"video"});let k,P,q=Date.now();const j=()=>{H&&(clearInterval(H),H=void 0),k&&(k.close(),k=void 0),_.stop(),P=void 0,A.removeEventListener("ended",j)};let H=window.setInterval(()=>{if(P&&k&&Date.now()-q>1e3)try{A.readyState==="live"?P.enqueue(k.clone()):j()}catch{j()}},1e3);const ne=new TransformStream({transform:(re,ve)=>{A.readyState==="live"?(P=ve,q=Date.now(),k===void 0?(k=re,ve.enqueue(re.clone())):(ve.enqueue(k),k=re)):re.close()}});return A.addEventListener("ended",j),T.readable.pipeThrough(ne).pipeTo(A.writable),A}}(n);m&&(x.info("local screen video track begin to inject frame"),this._mediaStreamTrack=m)}r&&this._hints.indexOf(hr.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(r),this._processorContext=new tV(this.getTrackId(),"local"),this._processorDestination=new eV(this.processorContext),this.bindProcessorDestinationEvents()}play(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof n=="string"){const c=document.getElementById(n);c?n=c:(x.warning("[".concat(this.getTrackId(),'] can not find "#').concat(n,'" element, use document.body')),n=document.body)}x.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(r));const i=kr(kr(kr({},this._getDefaultPlayerConfig()),r),{},{trackId:this.getTrackId(),element:n});this._player?this._player.updateConfig(i):(n instanceof HTMLVideoElement?this._player=new ER(i):this._player=new YV(i),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.safeEmit(Uf.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},de("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,x.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(n,r){if(!r){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(x.info("[".concat(this.getTrackId(),"] start setEnabled"),n),!n){this._originMediaStreamTrack.enabled=!1;try{await ur(this,Pt.NEED_DISABLE_TRACK,this)}catch(i){throw x.error("[".concat(this.getTrackId(),"] setEnabled to false error"),i.toString()),i}return r||(this._enabled=!1),void x.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await ur(this,Pt.NEED_ENABLE_TRACK,this)}catch(i){throw x.error("[".concat(this.getTrackId(),"] setEnabled to true error"),i.toString()),i}x.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}async setMuted(n){n!==this._muted&&(this.stateCheck("muted",n),this._muted=n,this._originMediaStreamTrack.enabled=!n,x.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(n)),n?await ur(this,Pt.NEED_MUTE_TRACK,this):await ur(this,Pt.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(n,r){if(!this._enabled)throw new $e(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(n=Bc(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:n.bitrateMin),n.width||n.height||n.frameRate){const i=ly({encoderConfig:n});(Vo()||vs()||Sa())&&(i.deviceId=void 0),x.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(n),JSON.stringify(i));try{await this._originMediaStreamTrack.applyConstraints(i),this.updateMediaStreamTrackResolution()}catch(c){const u=new $e(oe.UNEXPECTED_ERROR,c.toString());throw x.error("[".concat(this.getTrackId(),"] applyConstraints error"),u.toString()),u}}this._encoderConfig=n,this._hints.indexOf(hr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ur(this,Pt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(i){return i.throw(x)}}getStats(){return wu(()=>{x.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),wi(this,Pt.GET_STATS)||kr({},dR)}async setBeautyEffect(n){x.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(n,r):await _R(n)}async setBitrateLimit(n){x.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(n))),n&&(this._forceBitrateLimit=n,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<n.max_bitrate?this._encoderConfig.bitrateMax:n.max_bitrate:this._encoderConfig.bitrateMax=n.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=n.min_bitrate))}async setOptimizationMode(n){if(n!=="motion"&&n!=="detail"&&n!=="balanced")return void x.error(oe.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const r=this._optimizationMode;try{this._optimizationMode=n,await ur(this,Pt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(i){throw this._optimizationMode=r,x.error("[".concat(this.getTrackId(),"] set optimization mode failed"),i.toString()),i}x.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(n,")"))}setScalabiltyMode(n){if(n.numSpatialLayers===1&&n.numTemporalLayers!==1)return x.error(oe.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=n,x.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(n,")"))}updateMediaStreamTrackResolution(){oV(this._originMediaStreamTrack).then(n=>{let[r,i]=n;this._videoHeight=i,this._videoWidth=r}).catch(ZE)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(n){if(!this._enabled)throw new $e(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");x.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(n)),n=Bc(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:n.bitrateMin),this._encoderConfig=n,this._hints.indexOf(hr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ur(this,Pt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(r){return r.throw(x)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:n,height:r,frameRate:i}=this.getMediaStreamTrackSettings();if(!n||!r||!i)return;const{bitrateMax:c,bitrateMin:u}=this._encoderConfig;if(u==null||c==null){const{max:f,min:m}=function(_,y,T,A,k){const P=de("BITRATE_ADAPTER_TYPE");if(P==="DEFAULT_BITRATE")return{min:A,max:k};if(k===void 0){var q;const H=Math.floor(200*Math.pow(T/15,.6)*Math.pow(_*y/640/360,.75));k=P==="STANDARD_BITRATE"?4*H:2*H,A=(q=A)!==null&&q!==void 0?q:H}else{var j;A=(j=A)!==null&&j!==void 0?j:Math.floor(k/10)}return{min:A,max:k}}(n,r,i,u,c);this._encoderConfig.bitrateMin=m,this._encoderConfig.bitrateMax=f,x.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(n,", h: ").concat(r,", fps: ").concat(i,"] => [brMax: ").concat(f,", brMin: ").concat(m,"]"))}}getVideoElementVisibleStatus(){try{var n,r;const i=this==null||(n=this._player)===null||n===void 0?void 0:n.getContainerElement(),c={track:this,element:this==null||(r=this._player)===null||r===void 0?void 0:r.getVideoElement(),slot:i==null?void 0:i.parentElement},{element:u,slot:f}=c;if(this.isPlaying&&u instanceof HTMLVideoElement&&f instanceof HTMLElement){const m=sU.checkOneElementVisible(u),_=Object.assign({},m);if(_.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_.visible;const y=Bt.reportApiInvoke(null,{tag:Fr.TRACER,name:oo.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_.visible?y.onSuccess("Video is visible"):y.onSuccess("Invisible because of ".concat(_.reason))}return _}return}catch(i){throw new $e(oe.GET_VIDEO_ELEMENT_VISIBLE_ERROR,i.message)}}async renewMediaStreamTrack(n){}pipe(n){if(this.processor===n)return n;if(n._source)throw new $e(oe.INVALID_OPERATION,"Processor ".concat(n.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=n,this.processor._source=this,n.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),n}unpipe(){if(!this.processor)return;const n=this.processor;this.processor._source=void 0,this.processor=void 0,n.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this._encoderConfig;n&&(i=kr(kr({},i),Bc(n))),i=xd(i);const c=dr(8,"track-video-cloned-"),u=new Bq(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,i,xd(this._scalabilityMode),this._optimizationMode,c,xd(this._hints));return n&&i&&u.setEncoderConfiguration(i),x.debug("clone video track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(r)),u}async replaceTrack(n,r){if(!(n instanceof MediaStreamTrack))throw new $e(oe.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(n.kind!=="video")throw new $e(oe.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(n,r,!0),this.updateMediaStreamTrackResolution()}sendSeiData(n){if(wu(()=>{Bt.reportApiInvoke(null,{name:oo.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Fr.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!de("ENABLE_VIDEO_SEI")||!de("ENABLE_ENCODED_TRANSFORM"))return void x.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(n instanceof Uint8Array==0)return new $e(oe.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const r=this.getRTCRtpTransceiver();if(!r)return void x.warning("Video track is not published, SEI can not be send");const i=r.sender.getParameters();if(i.codecs.length===0)return;const c=i.codecs[0].mimeType.toLocaleLowerCase();c==="video/h264"?this.safeEmit("sei-to-send",n):x.warning("SEI is not supported by ".concat(c))}bindProcessorDestinationEvents(){this.processorDestination.on(gs.ON_TRACK,async n=>{n?n!==this._mediaStreamTrack&&(this._mediaStreamTrack=n,this._updatePlayerSource(),await ur(this,Pt.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await ur(this,Pt.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(gs.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Oi.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Oi.REQUEST_CONSTRAINTS)}},Un(Pn.prototype,"play",[qV,XV],Object.getOwnPropertyDescriptor(Pn.prototype,"play"),Pn.prototype),Un(Pn.prototype,"stop",[JV],Object.getOwnPropertyDescriptor(Pn.prototype,"stop"),Pn.prototype),Un(Pn.prototype,"setEnabled",[ZV,QV,eF],Object.getOwnPropertyDescriptor(Pn.prototype,"setEnabled"),Pn.prototype),Un(Pn.prototype,"setMuted",[tF,nF,rF],Object.getOwnPropertyDescriptor(Pn.prototype,"setMuted"),Pn.prototype),Un(Pn.prototype,"setEncoderConfiguration",[oF,sF],Object.getOwnPropertyDescriptor(Pn.prototype,"setEncoderConfiguration"),Pn.prototype),Un(Pn.prototype,"getStats",[iF],Object.getOwnPropertyDescriptor(Pn.prototype,"getStats"),Pn.prototype),Un(Pn.prototype,"setBeautyEffect",[aF,cF],Object.getOwnPropertyDescriptor(Pn.prototype,"setBeautyEffect"),Pn.prototype),Un(Pn.prototype,"getCurrentFrameData",[lF],Object.getOwnPropertyDescriptor(Pn.prototype,"getCurrentFrameData"),Pn.prototype),Un(Pn.prototype,"getCurrentFrameImage",[uF],Object.getOwnPropertyDescriptor(Pn.prototype,"getCurrentFrameImage"),Pn.prototype),Un(Pn.prototype,"setBitrateLimit",[dF],Object.getOwnPropertyDescriptor(Pn.prototype,"setBitrateLimit"),Pn.prototype),Un(Pn.prototype,"setOptimizationMode",[hF],Object.getOwnPropertyDescriptor(Pn.prototype,"setOptimizationMode"),Pn.prototype),Un(Pn.prototype,"setScalabiltyMode",[fF],Object.getOwnPropertyDescriptor(Pn.prototype,"setScalabiltyMode"),Pn.prototype),Un(Pn.prototype,"updateMediaStreamTrackResolution",[pF],Object.getOwnPropertyDescriptor(Pn.prototype,"updateMediaStreamTrackResolution"),Pn.prototype),Un(Pn.prototype,"pipe",[mF],Object.getOwnPropertyDescriptor(Pn.prototype,"pipe"),Pn.prototype),Un(Pn.prototype,"unpipe",[vF],Object.getOwnPropertyDescriptor(Pn.prototype,"unpipe"),Pn.prototype),Un(Pn.prototype,"close",[gF],Object.getOwnPropertyDescriptor(Pn.prototype,"close"),Pn.prototype),Un(Pn.prototype,"replaceTrack",[_F],Object.getOwnPropertyDescriptor(Pn.prototype,"replaceTrack"),Pn.prototype),Pn),yR=(EF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),yF=Yr(),bF=kf("CameraVideoTrack","_enabledMutex"),SF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),TF=Yr(),CF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),wF=Yr(),RF=Xt({argsMap:e=>[e.getTrackId()]}),Li=class jq extends Sr{get __className__(){return"CameraVideoTrack"}constructor(n,r,i,c,u,f){super(n,Bc(r.encoderConfig),c,u,f),xe(this,"_config",void 0),xe(this,"_originalConstraints",void 0),xe(this,"_constraints",void 0),xe(this,"_enabled",!0),xe(this,"_deviceName","default"),xe(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(Af()||Fw())&&!function(){const m=Mn();if(m.os!==yo.IOS||!m.osVersion)return!1;const _=m.osVersion.split(".");return Number(_[0])===15&&Number(_[1])>=2}()&&tU()&&this._enabled&&!this._isClosed&&(x.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=r,this._originalConstraints=i,this._constraints=i,this._deviceName=n.label,this._encoderConfig=Bc(this._config.encoderConfig),nr.on(Mo.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),nr.on(Mo.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(n){return typeof n=="string"?this._setDeviceById(n):n.deviceId?this._setDeviceById(n.deviceId):n.facingMode?this._setDeviceByFacingModel(n.facingMode):void 0}async _setDeviceById(n){if(x.info("[".concat(this.getTrackId(),"] set device to ").concat(n)),this._enabled)try{const r=await Pi.getDeviceById(n),i={};i.video=kr({},this._constraints),i.video.deviceId={exact:n},i.video.facingMode=void 0,this._originMediaStreamTrack.stop();let c=null;try{c=await ki(i,this.getTrackId())}catch(u){throw x.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),c=await ki({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=r.label,this._config.cameraId=n,this._constraints.deviceId={exact:n}}catch(r){throw x.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}else try{const r=await Pi.getDeviceById(n);this._deviceName=r.label,this._config.cameraId=n,this._constraints.deviceId={exact:n}}catch(r){throw x.error("[".concat(this.getTrackId(),"] setDevice error"),r.toString()),r}x.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(n){x.info("[".concat(this.getTrackId(),"] set facingMode ").concat(n));const r={video:kr(kr({},this._constraints),{},{deviceId:void 0,facingMode:{exact:n}})};if(this._enabled){this._originMediaStreamTrack.stop();let i=null;try{i=await ki(r,this.getTrackId())}catch(c){throw x.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),c.toString()),i=await ki({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),c}await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=n,this._config.cameraId=void 0,this._constraints=kr({},r.video),x.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(n,r){if(!r){if(n===this._enabled)return;this.stateCheck("enabled",n)}if(x.info("[".concat(this.getTrackId(),"] start setEnabled"),n),n){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const i=await ki({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1)}await ur(this,Pt.NEED_ENABLE_TRACK,this)}catch(i){throw x.error("[".concat(this.getTrackId(),"] setEnabled true error"),i.toString()),i}this.updateMediaStreamTrackResolution(),x.info("[".concat(this.getTrackId(),"] setEnabled to true success")),r||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),r||(this._enabled=!1);try{await ur(this,Pt.NEED_DISABLE_TRACK,this)}catch(i){throw x.error("[".concat(this.getTrackId(),"] setEnabled to false error"),i.toString()),i}x.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(n,r){if(!this._enabled)throw new $e(oe.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");n=Bc(n),this._forceBitrateLimit&&(n.bitrateMax=this._forceBitrateLimit.max_bitrate||n.bitrateMax,n.bitrateMin=this._forceBitrateLimit.min_bitrate||n.bitrateMin);const i=Br(this._config);i.encoderConfig=n;const c=ly(i);(Vo()||vs()||Sa())&&(c.deviceId=void 0),x.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(n),JSON.stringify(c));try{await this._originMediaStreamTrack.applyConstraints(c),this.updateMediaStreamTrackResolution()}catch(u){const f=new $e(oe.UNEXPECTED_ERROR,u.toString());throw x.error("[".concat(this.getTrackId(),"] applyConstraints error"),f.toString()),f}this._config=i,this._constraints=c,this._originalConstraints=c,this._encoderConfig=n,this._hints.indexOf(hr.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await ur(this,Pt.NEED_UPDATE_VIDEO_ENCODER,this)}catch(u){return u.throw(x)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((vs()||Sa())&&this._enabled&&!this._isClosed&&nr.duringInterruption){const n=async()=>{nr.off(Mo.IOS_INTERRUPTION_END,n),this._enabled&&!this._isClosed&&(x.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};nr.on(Mo.IOS_INTERRUPTION_END,n)}else x.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Uf.TRACK_ENDED)}async renewMediaStreamTrack(n){const r=n||this._constraints,i=Pi.searchDeviceIdByName(this._deviceName);if(i&&!r.deviceId&&(r.deviceId={exact:i}),this._enabled){const c=await ki({video:r},this.getTrackId());this._constraints=r,await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),nr.off(Mo.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),nr.off(Mo.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],i=this._encoderConfig;n&&(i=kr(kr({},i),Bc(n))),i=xd(i);const c=dr(8,"track-cam-cloned-"),u=new jq(r?this._mediaStreamTrack.clone():this._mediaStreamTrack,xd(kr(kr({},this._config),{},{encoderConfig:i})),xd(this._constraints),xd(this._scalabilityMode),this._optimizationMode,c);return n&&i&&u.setEncoderConfiguration(i),x.debug("clone track from ".concat(this.getTrackId()," to ").concat(c,", clone ").concat(r)),u}bindProcessorContextEvents(){this.processorContext.on(Oi.REQUEST_UPDATE_CONSTRAINTS,async(n,r,i)=>{try{const c=Object.assign({},this._originalConstraints,...n);await this.renewMediaStreamTrack(c),r()}catch(c){i(c)}}),this.processorContext.on(Oi.REQUEST_CONSTRAINTS,async n=>{n(this._originMediaStreamTrack.getSettings())})}},Un(Li.prototype,"setDevice",[EF,yF],Object.getOwnPropertyDescriptor(Li.prototype,"setDevice"),Li.prototype),Un(Li.prototype,"setEnabled",[bF,SF,TF],Object.getOwnPropertyDescriptor(Li.prototype,"setEnabled"),Li.prototype),Un(Li.prototype,"setEncoderConfiguration",[CF,wF],Object.getOwnPropertyDescriptor(Li.prototype,"setEncoderConfiguration"),Li.prototype),Un(Li.prototype,"close",[RF],Object.getOwnPropertyDescriptor(Li.prototype,"close"),Li.prototype),Li);function bR(e,n,r,i){r.optimizationMode&&(i&&i.width&&i.height?(r.encoderConfig=kr(kr({},i),{},{bitrateMin:i.bitrateMin,bitrateMax:i.bitrateMax}),r.optimizationMode!=="motion"&&r.optimizationMode!=="detail"||(n.contentHint=r.optimizationMode,n.contentHint===r.optimizationMode?x.debug("[".concat(e,"] set content hint to"),r.optimizationMode):x.debug("[".concat(e,"] set content hint failed")))):x.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}var IF,AF,OF,NF,Xi,kF,PF,DF,LF,MF,xF,ns;class UF extends HU{getUserId(){return this._userId}constructor(n,r,i,c){super(n,"track-".concat(n.kind,"-").concat(r,"-").concat(c.clientId,"_").concat(dr(5,""))),xe(this,"_userId",void 0),xe(this,"_uintId",void 0),xe(this,"_isDestroyed",!1),xe(this,"store",void 0),xe(this,"processor",void 0),xe(this,"processorContext",void 0),this._userId=r,this._uintId=i,this.store=c}_updateOriginMediaStreamTrack(n){this._originMediaStreamTrack=n,this._mediaStreamTrack=n,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,x.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let Hf=(IF=Xt({argsMap:(e,n,r)=>[e.getTrackId(),typeof n=="string"?n:n instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",r]}),AF=Xt({argsMap:e=>[e.getTrackId()]}),OF=Xt({argsMap:(e,n)=>[e.getTrackId(),n.name]}),NF=Xt({argsMap:e=>[e.getTrackId()]}),Un((Xi=class extends UF{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==ts.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,n,r,i){super(e,n,r,i),xe(this,"_videoVisibleTimer",null),xe(this,"_previousVideoVisibleStatus",void 0),xe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),xe(this,"trackMediaType",Ff.VIDEO),xe(this,"_videoWidth",void 0),xe(this,"_videoHeight",void 0),xe(this,"_player",void 0),xe(this,"processorDestination",void 0),xe(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new tV(this.getTrackId(),"remote"),this.processorDestination=new eV(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return wu(()=>{x.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),wi(this,Pt.GET_STATS)||kr({},jU)}play(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string"){const i=document.getElementById(e);i?e=i:(x.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}x.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(n));const r=kr(kr({fit:"cover"},n),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(e instanceof HTMLVideoElement?this._player=new ER(r):this._player=new YV(r),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Vf.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=i=>{this.safeEmit(Vf.VIDEO_STATE_CHANGED,i)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const i=this.getVideoElementVisibleStatus();this.safeEmit(Vf.VIDEO_ELEMENT_VISIBLE_STATUS,i)}catch{}},de("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,x.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){oV(this._originMediaStreamTrack).then(e=>{let[n,r]=e;this._videoHeight=r,this._videoWidth=n}).catch(ZE)}_updatePlayerSource(){x.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,n;const r=this==null||(e=this._player)===null||e===void 0?void 0:e.getContainerElement(),i={track:this,element:this==null||(n=this._player)===null||n===void 0?void 0:n.getVideoElement(),slot:r==null?void 0:r.parentElement},{element:c,slot:u}=i;if(this.isPlaying&&c instanceof HTMLVideoElement&&u instanceof HTMLElement){const f=sU.checkOneElementVisible(c),m=Object.assign({},f);if(m.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=m.visible;const _=Bt.reportApiInvoke(null,{tag:Fr.TRACER,name:oo.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});m.visible?_.onSuccess("Video is visible"):_.onSuccess("Invisible because of ".concat(m.reason))}return m}return}catch(r){throw new $e(oe.GET_VIDEO_ELEMENT_VISIBLE_ERROR,r.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new $e(oe.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(gs.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(gs.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(e){this.emit(Bd.SEI_RECEIVED,e)}}).prototype,"play",[IF],Object.getOwnPropertyDescriptor(Xi.prototype,"play"),Xi.prototype),Un(Xi.prototype,"stop",[AF],Object.getOwnPropertyDescriptor(Xi.prototype,"stop"),Xi.prototype),Un(Xi.prototype,"pipe",[OF],Object.getOwnPropertyDescriptor(Xi.prototype,"pipe"),Xi.prototype),Un(Xi.prototype,"unpipe",[NF],Object.getOwnPropertyDescriptor(Xi.prototype,"unpipe"),Xi.prototype),Xi),Wf=(kF=Xt({argsMap:(e,n)=>[e.getTrackId(),n],throttleTime:300}),PF=Xt({argsMap:(e,n)=>[e.getTrackId(),n]}),DF=Xt({argsMap:e=>[e.getTrackId()]}),LF=Xt({argsMap:e=>[e.getTrackId()]}),MF=Xt({argsMap:(e,n)=>[e.getTrackId(),n.name]}),xF=Xt({argsMap:e=>[e.getTrackId()]}),Un((ns=class extends UF{get isPlaying(){return this._useAudioElement?As.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,n,r,i){super(e,n,r,i),xe(this,"trackMediaType",Ff.AUDIO),xe(this,"_source",void 0),xe(this,"_useAudioElement",!0),xe(this,"_volume",100),xe(this,"processorContext",void 0),xe(this,"processorDestination",void 0),xe(this,"_played",!1),xe(this,"_bypassWebAudio",!1),de("DISABLE_WEBAUDIO")?(this._source=new gR,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new zU(e,!0),de("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(Ai.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Vf.FIRST_FRAME_DECODED)}),this.processorContext=new rV(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new nV(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(Ai.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Ai.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(n),this._source.removeAllListeners(Ai.ON_AUDIO_BUFFER),this._source.on(Ai.ON_AUDIO_BUFFER,r=>e(r))}setVolume(e){this._volume=e,this._useAudioElement?As.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!UU())throw new $e(oe.NOT_SUPPORTED,"your browser does not support setting the audio output device");await As.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return wu(()=>{x.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),wi(this,Pt.GET_STATS)||kr({},BU)}play(){x.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(x.debug("[".concat(this.getTrackId(),"] use audio element to play")),As.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){x.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?As.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];x.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&As.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new $e(oe.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new $e(oe.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new $e(oe.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const n=this.processor;(e=this._source.processSourceNode)===null||e===void 0||e.disconnect(),this.processor._source=!1,this.processor=void 0,n.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(gs.ON_TRACK,async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(gs.ON_NODE,e=>{this._source.processedNode=e;const n=!e;this._useAudioElement!==n&&(this._played?(this.stop(),this._useAudioElement=n,this.play()):this._useAudioElement=n)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(gs.ON_TRACK),this.processorDestination.removeAllListeners(gs.ON_NODE)}}).prototype,"setVolume",[kF],Object.getOwnPropertyDescriptor(ns.prototype,"setVolume"),ns.prototype),Un(ns.prototype,"setPlaybackDevice",[PF],Object.getOwnPropertyDescriptor(ns.prototype,"setPlaybackDevice"),ns.prototype),Un(ns.prototype,"play",[DF],Object.getOwnPropertyDescriptor(ns.prototype,"play"),ns.prototype),Un(ns.prototype,"stop",[LF],Object.getOwnPropertyDescriptor(ns.prototype,"stop"),ns.prototype),Un(ns.prototype,"pipe",[MF],Object.getOwnPropertyDescriptor(ns.prototype,"pipe"),ns.prototype),Un(ns.prototype,"unpipe",[xF],Object.getOwnPropertyDescriptor(ns.prototype,"unpipe"),ns.prototype),ns);const Nl=new class extends Dr{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),xe(this,"_lastHiddenTime",0),xe(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),x.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class VF extends Dr{constructor(n,r){super(),xe(this,"trackMediaType",Ff.DATA),xe(this,"_version",1),xe(this,"_type",3),xe(this,"_config",void 0),xe(this,"_originDataChannel",void 0),xe(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),xe(this,"_dataStreamPacketHandler",{serialize:i=>i,deserialize:i=>i}),xe(this,"_datachannelEventMap",new Map),this._config=n,r&&(this._originDataChannel=r,this._bandDataChannelEvents(r)),this._initPacketHeader()}useDataStream(n){this._dataStreamPacketHandler=n}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return de("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var n,r;return(n=(r=this._originDataChannel)===null||r===void 0?void 0:r.readyState)!==null&&n!==void 0?n:"connecting"}get _originDataChannelId(){var n,r;return(n=(r=this._originDataChannel)===null||r===void 0?void 0:r.id)!==null&&n!==void 0?n:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new bt((n,r)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&n();const i=setTimeout(()=>{var c;r(new $e(oe.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((c=this._originDataChannel)===null||c===void 0?void 0:c.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(i),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),n()},this._originDataChannel.onerror=()=>{throw clearTimeout(i),new $e(oe.DATACHANNEL_CONNECTION_TIMEOUT)}}else r(new $e(oe.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(n){this._originDataChannel=n,this._bandDataChannelEvents(n)}_initPacketHeader(){const n=new DataView(this._dataStreamPacketHeader);n.setUint16(0,this._version),n.setUint8(2,this._type),n.setUint8(3,this._config.id)}_bandDataChannelEvents(n){this._unbindDataChannelEvents(n),[ay.OPEN,ay.CLOSE,ay.ERROR].forEach(r=>{const i=()=>{this.emit(r)};this._datachannelEventMap.set(r,i),n.addEventListener(r,i)})}_unbindDataChannelEvents(n){Array.from(this._datachannelEventMap.entries()).forEach(r=>{let[i,c]=r;n.removeEventListener(i,c)}),this._datachannelEventMap.clear()}}class Iae extends VF{constructor(n){super(n),xe(this,"_messageListener",void 0),this._messageListener=r=>{if(r.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const i=r.data.slice(0,this._dataStreamPacketHeader.byteLength),c=new DataView(i).getUint8(3);if(c!==this.id)return void(de("SHOW_DATASTREAM2_LOG")&&x.debug("invalid datachannel id: ".concat(c," !== ").concat(this.id)));let u=r.data.slice(this._dataStreamPacketHeader.byteLength);u=this._dataStreamPacketHandler.deserialize(u),this.emit(ay.MESSAGE,u)}}_updateOriginDataChannel(n){super._updateOriginDataChannel(n),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class Aae extends VF{send(n){if(this._originDataChannel){let r=n;r=this._dataStreamPacketHandler.serialize(n);const i=new Uint8Array(this._dataStreamPacketHeader.byteLength+r.byteLength);i.set(new Uint8Array(this._dataStreamPacketHeader),0),i.set(new Uint8Array(r),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(i.buffer)}}}function dy(){const e=new Blob([atob("ZnVuY3Rpb24gdCh0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLG89W10scj0wO2Zvcig7by5sZW5ndGg8bjspciszPG4mJjA9PT1hW3JdJiYwPT09YVtyKzFdJiYzPT09YVtyKzJdJiYoMD09PWFbciszXXx8MT09PWFbciszXXx8Mj09PWFbciszXXx8Mz09PWFbciszXSk/KG8ucHVzaChhW3JdLGFbcisxXSxhW3IrM10pLHIrPTQpOihvLnB1c2goYVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobyl9ZnVuY3Rpb24gZSh0LGUpe2NvbnN0IG49ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgbj1bXSxhPTA7Zm9yKDthPGU7KWErMjxlJiYwPT09dFthXSYmMD09PXRbYSsxXSYmKDA9PT10W2ErMl18fDE9PT10W2ErMl18fDI9PT10W2ErMl18fDM9PT10W2ErMl0pPyhuLnB1c2godFthXSx0W2ErMV0sMyx0W2ErMl0pLGErPTMpOihuLnB1c2godFthXSksYSsrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxyPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNitvKzErYSt0LmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8bzspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1yLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNitpK2EpLHMuYnVmZmVyfWNvbnN0IG49NzEsYT0xLG89MixyPTEscz0yO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQVVESU9fTEVWRUw9MV09IkFVRElPX0xFVkVMIix0W3QuTUVUQURBVEE9Ml09Ik1FVEFEQVRBIix0W3QuQVVESU9fNjRfQklUX1BUUz0zXT0iQVVESU9fNjRfQklUX1BUUyJ9KGl8fChpPXt9KSk7bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKT4tMSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpJiYoc2VsZi5vbnJ0Y3RyYW5zZm9ybT1mPT57Y29uc3QgdT1mLnRyYW5zZm9ybWVyO2xldCBkPVtdLGw9W107dS5vcHRpb25zLnBvcnQub25tZXNzYWdlPXQ9Pnt0LmRhdGEuc2VpJiZkLnB1c2godC5kYXRhLnNlaSksdC5kYXRhLm1ldGFkYXRhJiZsLnB1c2godC5kYXRhLm1ldGFkYXRhKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IGc9dS5yZWFkYWJsZS5nZXRSZWFkZXIoKSxjPXUud3JpdGFibGUuZ2V0V3JpdGVyKCk7InNlaS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiBlKG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IGU9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5kYXRhKTtsZXQgYT0wO2Zvcig7YSs0PGUuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PW4uZ2V0VWludDgoYSswKSYmMD09PW4uZ2V0VWludDgoYSsxKSYmMD09PW4uZ2V0VWludDgoYSsyKSYmMT09PW4uZ2V0VWludDgoYSszKSYmNj09PW4uZ2V0VWludDgoYSs0KSl7bGV0IG89YSs2LHI9MCxzPTA7Zm9yKDsyNTU9PT0ocz1uLmdldFVpbnQ4KG8rKykpOylyKz0yNTU7cis9cztjb25zdCBpPXQoZS5kYXRhLG8scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGkpfWErK31yZXR1cm4gbnVsbH0oYS52YWx1ZSk7ZSYmbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTplfSl9Yy53cml0ZShhLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0odSk6InNlaS10eCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZC5zaGlmdCgpO3QmJihhLnZhbHVlLmRhdGE9ZShhLnZhbHVlLmRhdGEsdCkpfWMud3JpdGUoYS52YWx1ZSksbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChuKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2cucmVhZCgpLnRoZW4oKGY9PntpZighZi5kb25lKXtpZihmLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZEF1ZGlvRnJhbWUpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlPSExKXtjb25zdCBmPXQuZ2V0VWludDgoMCk7aWYoZiE9PW4pcmV0dXJuO2NvbnN0IHU9dC5nZXRVaW50MTYoMSksZD1hK28rdSxsPW5ldyBVaW50OEFycmF5KHQuYnl0ZUxlbmd0aC1kKTtsLnNldChuZXcgVWludDhBcnJheSh0LmJ1ZmZlcixkLHQuYnl0ZUxlbmd0aC1kKSk7Y29uc3QgZz17bTpmLHRsdkxlbjp1LHRsdjpbXSxmcmFtZTpsfTtsZXQgYz1hK287Zm9yKDtjPGQ7KXtjb25zdCBuPXQuZ2V0VWludDgoYyksYT10LmdldFVpbnQxNihjK3IpLG89citzO2lmKG49PT1pLkFVRElPX0xFVkVMKXtsZXQgcj10LmdldFVpbnQ4KGMrbyk7Zm9yKGxldCBlPTE7ZTxhO2UrKylyPXI8PDh8dC5nZXRVaW50OChjK28rZSk7Zy50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZT8xMjdecj4+MToxMjcmcn0pfWVsc2UgaWYobj09PWkuTUVUQURBVEF8fG49PT1pLkFVRElPXzY0X0JJVF9QVFMpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoYSk7Zm9yKGxldCBuPTA7bjxhO24rKyllW25dPXQuZ2V0VWludDgoYytvK24pO2cudGx2LnB1c2goe3RhZzpuLGxlbmd0aDphLHZhbHVlOmV9KX1jKz1vK2F9cmV0dXJuIGd9KG5ldyBEYXRhVmlldyhmLnZhbHVlLmRhdGEpKTtpZih0KXtjb25zdCBuPXQudGx2LmZpbmQoKHQ9PnQudGFnPT09aS5NRVRBREFUQXx8dC50YWc9PT1pLkFVRElPXzY0X0JJVF9QVFMpKTtuJiZuLnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe21ldGFkYXRhOm4udmFsdWV9KSxmLnZhbHVlLmRhdGE9dC5mcmFtZS5idWZmZXJ9fWMud3JpdGUoZi52YWx1ZSksZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChlKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS10eCI9PT11Lm9wdGlvbnMubmFtZSYmZnVuY3Rpb24gdChlKXtnLnJlYWQoKS50aGVuKChmPT57aWYoIWYuZG9uZSl7aWYoZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe2dldE1ldGFkYXRhOiEwfSksZi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PWwuc2hpZnQoKTt0JiYoZi52YWx1ZS5kYXRhPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBmPWkuYnl0ZUxlbmd0aCx1PWYrcitzLGQ9YStvK3UsbD1uZXcgQXJyYXlCdWZmZXIodC5ieXRlTGVuZ3RoK2QpLGc9bmV3IERhdGFWaWV3KGwpO2cuc2V0VWludDgoMCxuKSxnLnNldFVpbnQxNigxLHUpLGcuc2V0VWludDgoMyxlKSxnLnNldFVpbnQxNig0LGYpO2ZvcihsZXQgdD0wO3Q8Zjt0KyspZy5zZXRVaW50OCg2K3QsaVt0XSk7Y29uc3QgYz1uZXcgVWludDhBcnJheShnLmJ1ZmZlcik7cmV0dXJuIGMuc2V0KG5ldyBVaW50OEFycmF5KHQpLGQpLGMuYnVmZmVyfShmLnZhbHVlLmRhdGEsaS5BVURJT182NF9CSVRfUFRTLHQpKX1jLndyaXRlKGYudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfSh1KX0sc2VsZi5wb3N0TWVzc2FnZSgicmVnaXN0ZXJlZCIpKTsK")],{type:"text/javascript"});return setTimeout(()=>dE.revokeObjectURL(e),0),new Worker(dE.createObjectURL(e))}const FF=71,SR=1,TR=2,CR=1,BF=2;var kl=function(e){return e[e.AUDIO_LEVEL=1]="AUDIO_LEVEL",e[e.METADATA=2]="METADATA",e[e.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",e}(kl||{});function jF(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=e.getUint8(0);if(r!==FF)return;const i=e.getUint16(1),c=SR+TR+i,u=new Uint8Array(e.byteLength-c);u.set(new Uint8Array(e.buffer,c,e.byteLength-c));const f={m:r,tlvLen:i,tlv:[],frame:u};let m=SR+TR;for(;m<c;){const _=e.getUint8(m),y=e.getUint16(m+CR),T=CR+BF;if(_===kl.AUDIO_LEVEL){let A=e.getUint8(m+T);for(let k=1;k<y;k++)A=A<<8|e.getUint8(m+T+k);f.tlv.push({tag:_,length:y,value:n?127^A>>1:127&A})}else if(_===kl.METADATA||_===kl.AUDIO_64_BIT_PTS){const A=new Uint8Array(y);for(let k=0;k<y;k++)A[k]=e.getUint8(m+T+k);f.tlv.push({tag:_,length:y,value:A})}m+=T+y}return f}const hy=new Map,fy=127,Hd=1e-10,wR=139/13,py=new Map;function RR(e,n,r){const i="".concat(e,"-").concat(n,"-").concat(r);let c=0;return py.has(i)?c=py.get(i):(c=Math.log(function(f,m){const _=f-m;m<_&&(m=_);let y=1;for(let T=f,A=1;T>m;T--,A++)y=y*T/A;return y}(n,e))+e*Math.log(.5)+(n-e)*Math.log(1-.5)-Math.log(r)+r*e,py.set(i,c)),c<Hd&&(c=Hd),c}function $F(e,n,r){const i=n.length,c=e.length/i;let u=!1;for(let f=0,m=0;f<i;f++){let _=0;for(let y=m+c;m<y;m++)e[m]>r&&_++;n[f]!==_&&(n[f]=_,u=!0)}return u}window.cache=py;let Oae=0;class HF{constructor(n){xe(this,"id",void 0),xe(this,"immediates",[]),xe(this,"lastNonSilence",-1),xe(this,"immediateSpeechActivityScore",Hd),xe(this,"lastLevelChangedTime",Date.now()),xe(this,"levels",[]),xe(this,"longs",[]),xe(this,"longSpeechActivityScore",Hd),xe(this,"mediums",[]),xe(this,"mediumSpeechActivityScore",Hd),xe(this,"minLevel",0),xe(this,"nextMinLevel",0),xe(this,"nextMinLevelWindowLength",0),xe(this,"energyScore",0),this.id=n||"".concat(Oae++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const n=this.immediates,r=this.levels,i=this.minLevel+wR;let c=!1;for(let u=0;u<n.length;++u){let f=r[u];f<i&&(f=0);const m=Math.floor(f/wR);n[u]!==m&&(n[u]=m,c=!0)}return c}computeLongs(){return $F(this.mediums,this.longs,4)}computeMediums(){return $F(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=RR(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(n){this.longSpeechActivityScore=RR(this.longs[0],10,47),this.longSpeechActivityScore>Hd&&(this.lastNonSilence=n)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=RR(this.mediums[0],5,24)}evaluateSpeechActivityScores(n){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(n)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var n;return"[".concat(kP(n=[...this.levels]).call(n).join(),"]")}getSpeechActivityScore(n){switch(n){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+n)}}levelChanged(n,r){if(this.lastLevelChangedTime<=r){this.lastLevelChangedTime=r;let i=n;return n<0&&(i=0),n>fy&&(i=fy),this.levels.unshift(i),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(i),i>=this.minLevel+wR?i:i/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(n){if(n!==0){if(this.minLevel===0||this.minLevel>n)return this.minLevel=n,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=n,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>n&&(this.nextMinLevel=n),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let r=Math.sqrt(this.minLevel*this.nextMinLevel);r<0?r=0:r>fy&&(r=fy),this.minLevel=r,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class Nae{constructor(n){xe(this,"algorithm",void 0),this.algorithm=n}execute(){let n=!this.algorithm;if(!n)try{const r=this.algorithm.runInDecisionMaker(this);r<=0?n=!0:setTimeout(this.execute.bind(this),r)}catch{n=!0}n&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class IR{constructor(n,r,i){xe(this,"isDominant",void 0),xe(this,"energyRanking",void 0),xe(this,"energyScore",void 0),this.isDominant=n,this.energyRanking=r,this.energyScore=i}}class kae extends Dr{constructor(n){super(),xe(this,"dominantId",null),xe(this,"lastDecisionTime",0),xe(this,"lastLevelChangedTime",0),xe(this,"lastLevelIdleTime",0),xe(this,"relativeSpeechActivities",[]),xe(this,"speakers",new Map),xe(this,"enableSilence",!1),xe(this,"timeoutToSilenceInterval",0),xe(this,"decisionMaker",null),xe(this,"loudest",[]),xe(this,"numLoudestToTrack",3),xe(this,"energyExpireTimeMs",250),xe(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=n,this.enableSilence=n>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=n,r!=null&&(this.energyExpireTimeMs=r),i!=null&&(this.energyAlphaPct=i),this.loudest.length>n&&this.loudest.splice(n)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(n){return this.loudest.some(r=>r.id===n)}levelChanged(n,r){const i=Date.now(),c=this.getOrCreateSpeaker(n);this.lastLevelChangedTime<i&&(this.lastLevelChangedTime=i,this.maybeStartDecisionMaker());const u=c.levelChanged(r,i);return this.updateLoudestList(c,u,i)}runInDecisionMaker(n){return this.decisionMaker!==n||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(n){this.decisionMaker===n&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(n){n.forEach(r=>{this.speakers.has(r.id)||this.speakers.set(r.id,r)})}removeSpeakers(n){n.forEach(r=>{this.speakers.delete(r.id)})}getOrCreateSpeaker(n){let r=this.speakers.get(n);return r||(r=new HF(n),this.speakers.set(n,r),this.maybeStartDecisionMaker()),r}updateLoudestList(n,r,i){const c=n.id===this.dominantId;if(r<0){let _=0;for(;_<this.loudest.length&&this.loudest[_]!==n;)++_;return new IR(c,_,n.energyScore)}if(n.energyScore=Math.floor((this.energyAlphaPct*r+(100-this.energyAlphaPct)*n.energyScore+50)/100),this.numLoudestToTrack===0)return new IR(c,0,n.energyScore);const u=i-this.energyExpireTimeMs;let f=0;for(;f<this.loudest.length;){const _=this.loudest[f];if(_.getLastLevelChangedTime()<u&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(f,1);else if(_.id!==n.id)++f;else if(this.loudest.splice(f,1),this.loudest.length<this.numLoudestToTrack)break}let m=0;for(;m<this.loudest.length&&!(this.loudest[m].energyScore<n.energyScore);)++m;return m<this.numLoudestToTrack&&(this.loudest.splice(m,0,n),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new IR(c,m,n.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new Nae(this),this.decisionMaker.execute())}makeDecision(n){let r=null,i=null;const c=this.speakers.size;let u=null;if(c===0)u=null;else if(c===1){var f;const m=Ti(f=this.speakers).call(f).next().value;this.enableSilence&&m&&(u=m.id,m.evaluateSpeechActivityScores(n),n-m.lastNonSilence>this.timeoutToSilenceInterval&&(u=null))}else{let m=this.dominantId==null?null:this.speakers.get(this.dominantId);if(m==null){const T=this.speakers.entries().next();T.value&&(u=T.value[0],m=T.value[1])}else u=m.id;m!=null&&m.evaluateSpeechActivityScores(n);const _=this.relativeSpeechActivities;let y=2;for(const T of this.speakers.entries()){const[A,k]=T;if(k===m)continue;k.evaluateSpeechActivityScores(n);for(let H=0;H<_.length;++H){const ne=m==null?Hd:m.getSpeechActivityScore(H);_[H]=Math.log(k.getSpeechActivityScore(H)/ne)}const P=_[0],q=_[1],j=_[2];P>3&&q>2&&j>0&&q>y&&(y=q,u=A)}this.enableSilence&&m!=null&&u===m.id&&n-m.lastNonSilence>this.timeoutToSilenceInterval&&(u=null)}u==null&&!this.enableSilence||u===this.dominantId||(r=this.dominantId,this.dominantId=u,i=this.dominantId),i==null&&!this.enableSilence||i===r||this.emit("ActiveSpeakerChanged",i)}_runInDecisionMaker(){const n=Date.now(),r=300-(n-this.lastLevelIdleTime);let i=0;r<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(n),this.lastLevelIdleTime=n):i=r;let c=300-(n-this.lastDecisionTime);return c<=0&&(this.lastDecisionTime=n,this.makeDecision(n),c=300-(Date.now()-n)),c>0&&i>c&&(i=c),i}timeoutIdleLevels(n){const r=[];for(const c of Ti(i=this.speakers).call(i)){var i;const u=n-c.getLastLevelChangedTime();36e5<u&&(this.dominantId==null||c.id!==this.dominantId)?r.push(c.id):300<u&&c.levelTimedOut()}r.forEach(c=>this.speakers.delete(c))}}const Kf=new Map;let oc=null,my=null;const WF=3;let Wd=[];const sc=new Map,vy=new Map;class Pae{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(n,r){xe(this,"id",void 0),xe(this,"track",void 0),xe(this,"score",0),xe(this,"active",!0),xe(this,"muted",!1),xe(this,"timer",0),xe(this,"actives",0),xe(this,"inactives",0),this.id=n,this.track=r,this.setActive(sc.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const n=this.active;this.active=this.activeRate>=.8;const{actives:r,inactives:i}=function(){const c=[],u=[];return Array.from(Ti(sc).call(sc)).forEach(f=>{f.active?c.push(f):u.push(f)}),{actives:c,inactives:u}}();if(r.length>3){let c;r.forEach(u=>{(!c||c.score>u.score)&&(c=u)}),c&&c.setActive(!1)}if(r.length<3&&i.length>0){let c;i.forEach(u=>{(!c||c.score<u.score)&&u.id!==this.id&&(c=u)}),c&&n&&!this.active&&(c.samples>40&&c.activeRate-this.activeRate>.4?c.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(n){this.active=n,this.resetTimer(),this.setMuted(!n)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const n=function(r){let i;return Array.from(Ti(sc).call(sc)).forEach(c=>{!c.active||c.id===r||c.samples<40||(!i||c.score<i.score)&&(i=c)}),i}(this.id);n&&this.activeRate-n.activeRate>.4&&(n.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const n=function(r){let i;return Array.from(Ti(sc).call(sc)).forEach(c=>{c.active||c.id===r||c.samples<40||(!i||c.score>i.score)&&(i=c)}),i}(this.id);n&&n.activeRate-this.activeRate>.4&&(n.setActive(!0),this.setActive(!1))}addSample(n){n?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(n){this.track&&(this.track.enabled=!n,this.muted=n)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let gy;function KF(e){const n=sc.get(e);n&&(sc.delete(e),n.clearTimer())}const _y=new Map,Dae=new Map;function Lae(e,n,r){let i=new Uint8Array(e,n,r),c=[],u=0;for(;c.length<r;)u+3<r&&i[u]===0&&i[u+1]===0&&i[u+2]===3&&(i[u+3]===0||i[u+3]===1||i[u+3]===2||i[u+3]===3)?(c.push(i[u],i[u+1],i[u+3]),u+=4):(c.push(i[u]),u++);return new Uint8Array(c)}const Ey=new Map,hv=new Map;(function(){const e=Mn();Lo.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Lo.getStreamFromExtension=e.name===jn.CHROME&&Number(e.version)>34,Lo.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const n=new RTCPeerConnection;let r=!1;try{n.addTransceiver("audio"),r=!0}catch{}return n.close(),r}(),Lo.supportMinBitrate=e.name===jn.CHROME||e.name===jn.EDGE,Lo.supportSetRtpSenderParameters=function(){const n=Mn();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Il()||!(!Vo()&&!YE())||n.name===jn.FIREFOX&&Number(n.version)>=64)}(),e.name===jn.SAFARI&&(Number(e.version)>=14?Lo.supportDualStream=!0:Lo.supportDualStream=!1),Lo.webAudioMediaStreamDest=function(){const n=Mn();return!(n.name===jn.SAFARI&&Number(n.version)<12)}(),Lo.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",Lo.supportWebGL=typeof WebGLRenderingContext<"u",Lo.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Il()||(Lo.webAudioWithAEC=!0),Lo.supportShareAudio=function(){const n=Mn();return(n.os===yo.WIN_10||n.os===yo.WIN_81||n.os===yo.WIN_7||n.os===yo.LINUX||n.os===yo.MAC_OS||n.os===yo.CHROMIUM_OS)&&n.name===jn.CHROME&&Number(n.version)>=74}(),Lo.supportDataChannel=!!(tv(76)||function(n){const r=Mn();return!(r.name!==jn.FIREFOX||!r.osVersion)&&Number(r.version)>=n}(68)||Xx(14)),Lo.supportPCSetConfiguration=function(){const n=window.RTCPeerConnection;return!Ur()&&!!n&&n.prototype.setConfiguration instanceof Function}(),Lo.supportWebRTCEncodedTransform=function(){const n=Mn();return n.name==="Chrome"&&Number(n.version)>=87||n.name==="Safari"&&Number(n.version)>=15}(),Lo.supportWebRTCInsertableStream=function(){const n=Mn();return(n.name===jn.CHROME||n.name===jn.EDGE)&&Number(n.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),Lo.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,Lo.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,JE(()=>{Lo.supportDualStreamEncoding=function(){const n=Mn();return!!de("DISABLE_WEBAUDIO")||n.name==="Safari"&&Number(n.version)>=14||!!(n.name==="Chrome"&&/Windows/i.test(n.os||"")&&Number(n.version)>=100&&de("CHROME_DUAL_STREAM_USE_ENCODING"))}(),x.debug("browser ua: ",navigator.userAgent),x.info("browser info: ",e),x.info("browser compatibility: ",Lo)})})();const Mae=["CHINA","GLOBAL"],GF=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Kd=[],Gf=[];function Gd(e,n){return!!n&&Kd.some(r=>r.uid===e&&r.channelName===n)}function AR(){return Gf.length>0}var xae=p2.forEach,zF=A_("forEach")?[].forEach:function(e){return xae(this,e,arguments.length>1?arguments[1]:void 0)};rr({target:"Array",proto:!0,forced:[].forEach!=zF},{forEach:zF});var Uae=ma("Array").forEach,Vae=kc,Fae=mr,Bae=C,jae=Uae,OR=Array.prototype,$ae={DOMTokenList:!0,NodeList:!0},Hae=function(e){var n=e.forEach;return e===OR||Bae(OR,e)&&n===OR.forEach||Fae($ae,Vae(e))?jae:n},Wae=l(Hae),Kae=zt,YF=P_;rr({target:"Object",stat:!0,forced:d(function(){YF(1)})},{keys:function(e){return YF(Kae(e))}});var qF=l(Ot.Object.keys),Gae=l(AP),zae=l(NP),Yae=rr,XF=Cm,qae=W_,Xae=nt,JF=J0,Jae=Sl,Zae=Xe,Qae=Q_,ece=Zr,tce=K_,nce=o2("slice"),rce=ece("species"),NR=Array,oce=Math.max;Yae({target:"Array",proto:!0,forced:!nce},{slice:function(e,n){var r,i,c,u=Zae(this),f=Jae(u),m=JF(e,f),_=JF(n===void 0?f:n,f);if(XF(u)&&(r=u.constructor,(qae(r)&&(r===NR||XF(r.prototype))||Xae(r)&&(r=r[rce])===null)&&(r=void 0),r===NR||r===void 0))return tce(u,m,_);for(i=new(r===void 0?NR:r)(oce(_-m,0)),c=0;m<_;m++,c++)m in u&&Qae(i,c,u[m]);return i.length=c,i}});var sce=ma("Array").slice,ice=C,ace=sce,kR=Array.prototype,cce=function(e){var n=e.slice;return e===kR||ice(kR,e)&&n===kR.slice?ace:n},lce=l(cce);function Lt(e,n,r,i,c){var u,f,m,_={};return Wae(u=qF(i)).call(u,function(y){_[y]=i[y]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=Gae(f=zae(m=lce(r).call(r)).call(m)).call(f,function(y,T){return T(e,n,y)||y},_),c&&_.initializer!==void 0&&(_.value=_.initializer?_.initializer.call(c):void 0,_.initializer=void 0),_.initializer===void 0&&(e2(e,n,_),_=null),_}let yy=function(e){return e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",e}({}),PR=function(e){return e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR",e}({}),wa=function(e){return e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",e}({}),_s=function(e){return e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",e}({}),Yt=function(e){return e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",e}({}),vr=function(e){return e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed",e}({}),cn=function(e){return e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.PRE_CONNECT_PC="pre_connect_pc",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",e.RECOVER_NOTIFICATION="recover_notification",e}({}),nn=function(e){return e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag",e}({}),fv=function(e){return e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats",e}({}),An=function(e){return e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list",e}({}),Es=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({}),pn=function(e){return e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",e}({});function by(e){if(typeof e!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw x.error("Invalid Channel Name ".concat(e)),new Ue(oe.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function Sy(e){if(n=e,!(typeof n=="number"&&Math.floor(n)===n&&0<=n&&n<=4294967295||oU(e,1,255)))throw new Ue(oe.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var n;typeof e=="string"&&x.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let Pl=function(e){return e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e}({});const uce={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},DR={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function LR(e,n){Po(e.url,"".concat(n,".url"),1,1e3,!1),Vr(e.x)||sr(e.x,"".concat(n,".x"),0,1e4),Vr(e.y)||sr(e.y,"".concat(n,".y"),0,1e4),Vr(e.width)||sr(e.width,"".concat(n,".width"),0,1e4),Vr(e.height)||sr(e.height,"".concat(n,".height"),0,1e4),Vr(e.zOrder)||sr(e.zOrder,"".concat(n,".zOrder"),0,255),Vr(e.alpha)||sr(e.alpha,"".concat(n,".alpha"),0,1,!1)}const dce={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let Au=function(e){return e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address",e}({}),MR=function(e){return e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",e}({}),fo=function(e){return e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",e}({});function ZF(e){if(!e.channelName)throw new Ue(oe.INVALID_PARAMS,"invalid channelName in info");if(typeof e.uid!="number")throw new Ue(oe.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&Po(e.token,"info.token",1,2047),Sy(e.uid),by(e.channelName),!0}let ys=function(e){return e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile",e}({}),Dl=function(e){return e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",e}({}),Hs=function(e){return e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",e}({}),zf=function(e){return e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",e}({}),Jn=function(e){return e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low",e}({}),Ro=function(e){return e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.PRE_CONNECT_PC="pre-connect_pc",e.UPDATE_GATEWAY_CONFIG="update-gateway-config",e}({}),Ty=function(e){return e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON",e}({}),So=function(e){return e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7",e}({}),$n=function(e){return e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS",e}({});const QF=[$n.AFRICA,$n.ASIA,$n.CHINA,$n.EUROPE,$n.GLOBAL,$n.INDIA,$n.JAPAN,$n.NORTH_AMERICA,$n.OCEANIA,$n.OVERSEA,$n.SOUTH_AMERICA];let Go=function(e){return e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL",e}({});const Cy={CHINA:{},ASIA:{CODE:Go.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:Go.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:Go.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:Go.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:Go.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:Go.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:Go.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:Go.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:Go.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:Go.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:Go.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:Go.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:Go.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};nR&&(Cy.CHINA={CODE:Go.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let pv=function(e){return e.UPDATE_BITRATE_LIMIT="update_bitrate_limit",e.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",e}({});function eB(e){return!!e&&!(!e.uplink||!e.id)&&e.uplink.max_bitrate!==void 0&&e.uplink.min_bitrate!==void 0}class tB extends Dr{constructor(n,r){super(),Q(this,"onICEConnectionStateChange",void 0),Q(this,"onConnectionStateChange",void 0),Q(this,"onDTLSTransportStateChange",void 0),Q(this,"onDTLSTransportError",void 0),Q(this,"onICETransportStateChange",void 0),Q(this,"onFirstAudioReceived",void 0),Q(this,"onFirstVideoReceived",void 0),Q(this,"onFirstAudioDecoded",void 0),Q(this,"onFirstVideoDecoded",void 0),Q(this,"onFirstVideoDecodedTimeout",void 0),Q(this,"onSelectedLocalCandidateChanged",void 0),Q(this,"onSelectedRemoteCandidateChanged",void 0),Q(this,"onICECandidateError",void 0),Q(this,"getLocalVideoStats",void 0)}}class nB extends tB{constructor(n,r){super(n,r),Q(this,"establishPromise",void 0)}}let kt=function(e){return e.VIDEO="video",e.AUDIO="audio",e}({}),zo=function(e){return e.UDP_RELAY="udp_relay",e.UDP_TCP_RELAY="udp_tcp_relay",e.TCP_RELAY="tcp_relay",e.RELAY="relay",e}({}),Ll=function(e){return e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.TCP_RESTART=3]="TCP_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",e}({});const rB=["disconnected","failed"];let at=function(e){return e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack",e}({}),qn=function(e){return e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected",e}({}),Kt=function(e){return e.AudioMetadata="audioMetadata",e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE",e}({}),Ra=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),Ia=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),Io=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),oB=function(e){return e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback",e.PRE_CONNECT_PC="transmitter:pre_connect_pc",e}({}),Hc=function(e){return e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation",e}({}),Ji=function(e){return e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED",e}({}),ic=function(e){return e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url",e}({}),Yf=function(e){return e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED",e}({}),qr=function(e){return e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check",e}({}),qf=function(e){return e.ABORT="abort",e}({}),Ou=function(e){return e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e}({}),hce=function(e){return e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed",e}({});const fce={[yy.ACCESS_POINT]:{[_s.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[_s.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[_s.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[_s.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[_s.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[_s.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[_s.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[yy.UNILBS]:{[wa.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[wa.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[wa.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[wa.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[wa.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[wa.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[wa.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[wa.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[wa.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[wa.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[wa.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[wa.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[yy.STRING_UID_ALLOCATOR]:{[PR.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[PR.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[PR.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function Xf(e){const n=fce[Math.floor(e/1e4)];if(!n)return{desc:"unknown error",retry:!1};const r=n[e%1e4];if(!r){if(Math.floor(e/1e4)===yy.ACCESS_POINT){const i=e%1e4;if(i.toString()[0]==="1")return{desc:e.toString(),retry:!1};if(i.toString()[0]==="2")return{desc:e.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return r}const pce={[Yt.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Yt.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Yt.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Yt.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Yt.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Yt.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Yt.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Yt.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Yt.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Yt.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Yt.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Yt.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Yt.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Yt.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Yt.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Yt.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Yt.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Yt.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Yt.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Yt.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Yt.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Yt.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Yt.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Yt.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Yt.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Yt.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Yt.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Yt.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Yt.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Yt.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Yt.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Yt.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Yt.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Yt.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Yt.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Yt.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Yt.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Yt.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Yt.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Yt.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Yt.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Yt.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Yt.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Yt.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Yt.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Yt.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Yt.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Yt.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Yt.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Yt.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Yt.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Yt.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Yt.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Yt.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Yt.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Yt.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Yt.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Yt.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Yt.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Yt.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Yt.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Yt.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Yt.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function mv(e){return pce[e]||{desc:"UNKNOWN_ERROR_".concat(e),action:"failed"}}function sB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function xR(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?sB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function iB(e,n){if(typeof e=="string")return e;const{proxy:r,host:i,port:c}=e;if(n){const u=de("JOIN_GATEWAY_FALLBACK_PORT")||443;return u===443?"wss://".concat(i,"/ws/?p=").concat(Number(c)+150):"wss://".concat(i,":").concat(u,"/ws/?p=").concat(Number(c)+150)}return r?"wss://".concat(r,"/ws/?h=").concat(i,"&p=").concat(c):"wss://".concat(i,":").concat(c)}const mce=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,vce=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,gce=/wss:\/\/(.+):([0-9]+)\/?/,_ce=/wss:\/\/(.[^\/]+)\/?/;let Ece=0;class yce{constructor(n,r){Q(this,"id",0),Q(this,"store",void 0),Q(this,"recordIndex",void 0),Q(this,"websockets",[]),Q(this,"try443PortDuration",2e3),Q(this,"forceCloseWSDuration",5e3),Q(this,"try443PortTimeout",null),Q(this,"forceCloseTimeout",null),Q(this,"isTry443PortFailed",!1),Q(this,"isNormalPortFailed",!1),Q(this,"useDoubleDomain",!1),Q(this,"useProxy",!1),Q(this,"startTime",Date.now()),this.id=++Ece,this.try443PortDuration=de("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=n||5e3,this.store=r}closeAllWebsockets(){this.websockets.forEach(n=>{n.onopen=null,n.onclose=null,n.onmessage=null,n.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var n;const r=Date.now()-this.startTime;for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];x.debug("[choose-best-ws ".concat((n=this.store)===null||n===void 0?void 0:n.clientId," ").concat(this.id,"] ").concat(r,"ms:"),...c)}createWebSocket(n,r,i){this.logger("createWebSocket:",n,{isTry443Port:r,hasTimeoutDetection:i});const c=de("GATEWAY_DOMAINS"),u=Date.now(),f=[],m=c.find(k=>{var P;return gt(P=n.host).call(P,k)});m||(this.useDoubleDomain=!1);const _=[];if(this.useDoubleDomain)c.forEach(k=>{_.push(iB(xR(xR({},n),{},{host:n.host.replace(m,k)}),r))});else{const k=xR({},n);if(r&&m){const P=c.find(q=>q!==m);P&&(k.host=k.host.replace(m,P))}_.push(iB(k,r))}try{_.forEach(k=>{const P=new WebSocket(k);P.binaryType="arraybuffer",f.push(P),this.logger("ws is connecting:",P.url)})}catch(k){if(this.logger("ws create failed"),f.forEach(P=>P.close()),f.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(n,r,i);if(!r&&Number(n.port)!==443)return this.createWebSocket(n,!0,i);throw new Ue(oe.WS_ERR,"init websocket failed! Error: ".concat(k.toString()))}const y=ev();this.store&&this.store.recordJoinChannelService({urls:f.map(k=>k.url),service:"gateway"},this.recordIndex),f.forEach(k=>{k.onopen=()=>{this.logger("onopen: ws ".concat(k.url," open cost ").concat(Date.now()-u,"ms")),this.websockets.forEach(P=>{P!==k&&(P.onopen=null,P.onclose=null,P.onmessage=null,P.close(),this.logger("close backup websocket: ".concat(P.url)))}),this.websockets.length=0,y.resolve(k)},k.onclose=P=>{this.logger("onclose: ws ".concat(k.url," closed cost ").concat(Date.now()-u,"ms state: ").concat(k.readyState));const q=f.every(j=>j.readyState===WebSocket.CLOSED||j.readyState===WebSocket.CLOSING);this.logger("".concat(r?"443":"47xx"," websocket closed, all failed: ").concat(q)),q&&(r||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(P.reason)),y.reject({code:P.code,reason:Ty.A_ROUND_WS_FAILED})):!r&&q&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),A()),r?this.isTry443PortFailed=q:this.isNormalPortFailed=q},k.onmessage=P=>this.logger("".concat(k.url," onmessage: ").concat(P.data))}),this.websockets.push(...f);const T=()=>{this.websockets.forEach(k=>k.readyState!==WebSocket.OPEN&&k.close())},A=()=>{if(y.isResolved)return T();Mn().os===yo.MAC_OS&&Ur()&&T(),this.createWebSocket(n,!0,!0).then(k=>{y.resolve(k)}).catch(k=>{this.isNormalPortFailed&&y.reject(k),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",y.isResolved),this.forceCloseTimeout=null,T()},this.forceCloseWSDuration)};return i||(()=>{if(r||this.useProxy)return this.logger("add 5s timeout at ".concat(r?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,T()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",y.isResolved),this.try443PortTimeout=null,A()},this.try443PortDuration)})(),y.promise}chooseBestWebsocket(n,r,i,c){return this.useDoubleDomain=!!r,typeof n=="string"&&(n=function(u){let f,m,_;return[,f,m,_]=u.match(mce)||[],f||([,m,_]=u.match(vce)||[]),m&&_||([,m,_]=u.match(gce)||[]),m&&_||([,m]=u.match(_ce)||[]),m||x.warning("un-destructible url: ",u),{proxy:f,host:m,port:_||"443"}}(n)),this.recordIndex=c,this.useProxy=!!n.proxy,i&&this.useProxy&&(x.warn("cannot use 443 only when use proxy"),i=!1),this.createWebSocket(n,!!i,!1).finally(()=>this.clearTimeout())}}function aB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}class cB extends Dr{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(n){var r;gt(r=["tryNext","recover"]).call(r,n)&&this.resetReconnectCount(n),this._reconnectMode=n}get state(){return this._state}set state(n){n!==this._state&&(this._state=n,this._state==="reconnecting"?this.emit(pn.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(pn.CONNECTED):this._state==="closed"?this.emit(pn.CLOSED):this._state==="failed"&&this.emit(pn.FAILED))}resetReconnectCount(n){x.debug("websocket reset reconnect count, reason: "+n),this.reconnectCount=0}constructor(n,r){let i=arguments.length>2&&arguments[2]!==void 0&&arguments[2],c=arguments.length>3&&arguments[3]!==void 0&&arguments[3],u=arguments.length>4&&arguments[4]!==void 0&&arguments[4],f=arguments.length>5?arguments[5]:void 0;super(),Q(this,"connectionID",0),Q(this,"currentURLIndex",0),Q(this,"urls",[]),Q(this,"_reconnectMode","tryNext"),Q(this,"reconnectReason",void 0),Q(this,"_initMutex",void 0),Q(this,"name",void 0),Q(this,"_state","closed"),Q(this,"reconnectInterrupter",void 0),Q(this,"websocket",void 0),Q(this,"retryConfig",void 0),Q(this,"reconnectCount",0),Q(this,"forceCloseTimeout",5e3),Q(this,"onlineReconnectListener",void 0),Q(this,"useCompress",void 0),Q(this,"tryDoubleDomain",!1),Q(this,"use443PortOnly",!1),Q(this,"wsInflateLength",0),Q(this,"wsDeflateLength",0),Q(this,"closeEstablishingWs",()=>{}),Q(this,"store",void 0),Q(this,"joinGatewayRecordIndex",void 0),this.store=f,this.name=n,this.retryConfig=function(A){for(var k=1;k<arguments.length;k++){var P=arguments[k]!=null?arguments[k]:{};k%2?aB(Object(P),!0).forEach(function(q){Q(A,q,P[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(P)):aB(Object(P)).forEach(function(q){Object.defineProperty(A,q,Object.getOwnPropertyDescriptor(P,q))})}return A}({},r),this.useCompress=i,this.tryDoubleDomain=c,this.use443PortOnly=u,this._initMutex=new Ko("websocket",f?f.clientId:void 0);const{timeout:m,timeoutFactor:_}=r,y=Math.max(300,Math.floor(3*m/5)),T=Math.max(1.2,Math.floor(8*_)/10);si.ONLINE&&(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=T),Qr.on(Of.NETWORK_STATE_CHANGE,(A,k)=>{A!==k&&(this.resetReconnectCount("network state change: ".concat(k," -> ").concat(A)),A===si.ONLINE?(this.retryConfig.timeout=y,this.retryConfig.timeoutFactor=T):(this.retryConfig.timeout=m,this.retryConfig.timeoutFactor=_))})}getConnection(){return this.websocket||void 0}async init(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const i=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=r,this.urls=n,this.state="connecting";try{const c=ev(),u=this.urls[this.currentURLIndex];de("ENABLE_PREALLOC_PC")&&this.emit(oB.PRE_CONNECT_PC),this.createWebSocketConnection(u).then(c.resolve).catch(c.reject),this.once(pn.CLOSED,()=>{c.reject(new $e(oe.WS_DISCONNECT))}),this.once(pn.CONNECTED,c.resolve),await c.promise}catch{}finally{i()}}close(n,r){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const i=this.websocket;r?setTimeout(()=>i.close(),500):i.close(),this.websocket=void 0}this.state=n?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(n,r){if(!this.websocket)return void x.warning("[".concat(this.name,"] can not reconnect, no websocket"));n!==void 0&&(this.reconnectMode=n),x.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(r)]},this.joinGatewayRecordIndex);const i=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),i&&i.bind(this.websocket)({code:9999,reason:r})}sendMessage(n){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new $e(oe.WS_ABORT,"websocket is not ready");try{r||(n=JSON.stringify(n)),this.websocket.send(n)}catch(i){throw new $e(oe.WS_ERR,"send websocket message error"+i.toString())}}setWsInflateData(n){this.wsDeflateLength=this.wsDeflateLength+n.originLength,this.wsInflateLength=this.wsInflateLength+n.compressedLength}getWsInflateData(){const n=this.wsInflateLength,r=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:n,wsDeflateLength:r}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(n){var r;const i=ev();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const c=T=>{var A;(A=this.store)===null||A===void 0||A.signalChannelOpen(),x.debug("[".concat(this.name,"] websocket opened:"),T),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),i.resolve()},u=async T=>{var A;if(x.debug("[".concat(this.name,"] websocket close ").concat((A=this.websocket)===null||A===void 0?void 0:A.url,", code: ").concat(T.code,", reason: ").concat(T.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)i.reject(new $e(oe.WS_DISCONNECT,"websocket close: ".concat(T.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=T.reason,this.state="reconnecting");const k=wi(this,pn.WILL_RECONNECT,this.reconnectMode,T.reason)||this.reconnectMode,P=await this.reconnectWithAction(k);if(this.state==="closed")return void x.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!P)return i.reject(new $e(oe.WS_DISCONNECT,"websocket reconnect failed: ".concat(T.code))),this.close(!0);i.resolve()}},f=T=>{this.emit(pn.ON_MESSAGE,T)},m=T=>{x.warn("[".concat(this.connectionID,"] ws open error ").concat(T))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),de("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(n=de("GATEWAY_WSS_ADDRESS")),x.debug("[".concat(this.name,"] start connect, url:"),n);const _=(r=this.store)===null||r===void 0?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var y;const T=await this.chooseBestWebsocketConnection(n);this.websocket=T,c&&c(this.websocket.url),this.websocket.onclose=u,this.websocket.onmessage=f,this.websocket.onerror=m,(y=this.store)===null||y===void 0||y.recordJoinChannelService({endTs:Date.now(),status:"success"},_),this.joinGatewayRecordIndex=_}catch(T){const A=this.state==="closed",k=T instanceof $e,P=k&&T.code===oe.WS_ABORT,q=k&&T.code===oe.WS_ERR,j=k?T.message:T&&(T.reason||T.toString());x.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(j)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:P?"aborted":"error",errors:[T]},_),A||q?(i.reject(A?new $e(oe.WS_DISCONNECT,"websocket is closed: ".concat(j)):new $e(oe.WS_ERR,"init websocket failed: ".concat(j))),q&&x.error("[".concat(this.name,"] init websocket failed: ").concat(j))):u&&u(T)}return i.promise}async reconnectWithAction(n){let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;x.warning("[choose-best-ws] action: =>",n),this.onlineReconnectListener||Qr.isOnline||!Qr.onlineWaiter||(this.onlineReconnectListener=Qr.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let i=!0;if(this.reconnectInterrupter=()=>i=!1,r){const f=Yw(this.reconnectCount,this.retryConfig);x.debug("[".concat(this.name,"] wait ").concat(f,"ms to reconnect websocket, mode: ").concat(n)),await bt.race([Do(f),this.onlineReconnectListener||new bt(()=>{})])}if(this._state==="closed"||!i)return!1;this.reconnectCount+=1;const c=async(f,m)=>{this.emit(pn.RECONNECT_CREATE_CONNECTION,m),await this.createWebSocketConnection(f)};try{if(n==="retry")await c(this.urls[this.currentURLIndex],n);else if(n==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);x.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await c(this.urls[this.currentURLIndex],n)}else n==="recover"&&(x.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await Bo(this,pn.REQUEST_NEW_URLS),this.currentURLIndex=0,await c(this.urls[this.currentURLIndex],n))}catch(f){var u;x.error("[".concat(this.name,"] reconnect failed ").concat(f&&f.toString()));const m=f==null||(u=f.data)===null||u===void 0?void 0:u.desc;return Array.isArray(m)&&gt(m).call(m,"dynamic key expired")?(this.emit(pn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(n,r)}return!0}}class UR extends cB{constructor(n,r){super(n,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(n,r){const i=ev(),c=function(f,m){return new yce(f,m)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{x.debug("[choose-best-ws] close establishing websockets"),c.closeAllWebsockets(),i.reject(new $e(oe.WS_ABORT,"choose best websocket aborted"))};const u=de("GATEWAY_DOMAINS");return x.debug("[choose-best-ws] currentDomain: ",n,", domains: ",u,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),c.chooseBestWebsocket(n,this.tryDoubleDomain,this.use443PortOnly,r).then(i.resolve).catch(i.reject),i.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class vv extends cB{constructor(n,r){super(n,r,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(n,r){return new bt((i,c)=>{let u=!1;const f=[];this.closeEstablishingWs=()=>{x.debug("[choose-best-ws] close establishing websockets"),f.forEach(q=>{q.onclose=null,q.onopen=null,q.onmessage=null,q.close()}),c(new $e(oe.WS_ABORT,"choose best websocket aborted"))};const m=de("GATEWAY_DOMAINS");let _;const y=n.indexOf("?h="),T=m.find(q=>y!==-1?gt(n).call(n,q,y):gt(n).call(n,q));x.debug("[choose-best-ws] currentDomain: ",T,", domains: ",m);let A=!this.tryDoubleDomain||!T;if(!A&&T){var k;const q=Date.now();try{m.forEach(j=>{const H=y===-1?n.replace(T,j):n.substr(0,y)+n.substr(y).replace(T,j),ne=new WebSocket(H);ne.binaryType="arraybuffer",f.push(ne),x.debug("[choose-best-ws] ws is connecting:",ne.url)})}catch{for(x.debug("[choose-best-ws] ws create failed, fallback to single url"),f.forEach(H=>H.close());f.length;)f.pop();A=!0}(k=this.store)===null||k===void 0||k.recordJoinChannelService({urls:f.map(j=>j.url),service:"gateway"},r),f.forEach(j=>{j.onopen=()=>{if(u)return;const H=Date.now()-q;x.debug("[choose-best-ws] ws open cost ".concat(H,"ms")),f.filter(ne=>ne!==j).forEach(ne=>{x.debug("[choose-best-ws]close backup websocket: ".concat(ne.url)),ne.close()}),u=!0,i(j)},j.onclose=H=>{_=H,!u&&(f.find(ne=>!(ne.readyState===WebSocket.CLOSED||ne.readyState===WebSocket.CLOSING))||(x.debug("[choose-best-ws] all websocket is closed"),u=!0,c(_)))},j.onmessage=H=>{x.debug("[choose-best-ws]".concat(j.url," onmessage: ").concat(H.data))}}),Do(this.forceCloseTimeout).then(()=>{f.forEach(j=>{j.readyState!==WebSocket.OPEN&&j.close()})})}if(A){var P;let q;x.debug("[choose-best-ws] use single url: ",n),(P=this.store)===null||P===void 0||P.recordJoinChannelService({urls:[n],service:"gateway"},r);try{q=new WebSocket(n),f.push(q),q.binaryType="arraybuffer"}catch(j){const H=new $e(oe.WS_ERR,"init websocket failed! Error: ".concat(j.toString()));return x.error("[".concat(this.name,"]").concat(H)),void c(H)}q.onopen=()=>{i(q)},q.onclose=j=>{c(j)},q.onmessage=j=>{x.debug("[choose-best-ws]".concat(q.url," onmessage: ").concat(j.data))},Do(this.forceCloseTimeout).then(()=>{q&&q.readyState!==WebSocket.OPEN&&q.close()})}}).then(i=>(this.closeEstablishingWs=void 0,i)).catch(i=>{throw this.closeEstablishingWs=void 0,i})}}class bce extends Dr{get connectionState(){return this._connectionState}set connectionState(n){n!==this._connectionState&&(this._connectionState=n,n===vr.CONNECTED?this.emit(cn.WS_CONNECTED):n===vr.RECONNECTING?this.emit(cn.WS_RECONNECTING,this._websocketReconnectReason):n===vr.CLOSED&&this.emit(cn.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(n,r){super(),Q(this,"_disconnectedReason",void 0),Q(this,"_websocketReconnectReason",void 0),Q(this,"_connectionState",vr.CLOSED),Q(this,"reconnectToken",void 0),Q(this,"websocket",void 0),Q(this,"openConnectionTime",void 0),Q(this,"clientId",void 0),Q(this,"lastMsgTime",Date.now()),Q(this,"uploadCache",[]),Q(this,"uploadCacheInterval",void 0),Q(this,"rttRolling",new yU(5)),Q(this,"pingpongTimer",void 0),Q(this,"wsInflateDataTimer",void 0),Q(this,"pingpongTimeoutCount",0),Q(this,"joinResponse",void 0),Q(this,"multiIpOption",void 0),Q(this,"initError",void 0),Q(this,"spec",void 0),Q(this,"store",void 0),Q(this,"onWebsocketMessage",i=>{if(i.data instanceof ArrayBuffer)return void this.emit(cn.ON_BINARY_DATA,i.data);const c=JSON.parse(i.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const u="res-@".concat(c._id);this.emit(u,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){if(this.emit(c._type,c._message),c._type===An.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===An.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(Yn.UID_BANNED);break;case 15:this.close(Yn.IP_BANNED);break;case 16:this.close(Yn.CHANNEL_BANNED)}if(c._type===An.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case Yt.ERR_LICENSE_MISSING:this.close(Yn.LICENSE_MISSING);break;case Yt.ERR_LICENSE_EXPIRED:this.close(Yn.LICENSE_EXPIRED);break;case Yt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Yn.LICENSE_MINUTES_EXCEEDED);break;case Yt.ERR_LICENSE_PERIOD_INVALID:this.close(Yn.LICENSE_PERIOD_INVALID);break;case Yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Yn.LICENSE_MULTIPLE_SDK_SERVICE);break;case Yt.ERR_LICENSE_ILLEGAL:this.close(Yn.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=n.clientId,this.spec=n,this.store=r,this.websocket=new UR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,de("JOIN_GATEWAY_USE_DUAL_DOMAIN"),de("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===vr.CONNECTED&&this.reconnect("retry",Fo.OFFLINE)})}async request(n,r,i,c){const u=dr(6,""),f={_id:u,_type:n,_message:r},m=this.websocket.connectionID,_=()=>new bt((q,j)=>{if(this.connectionState===vr.CONNECTED)return q();const H=()=>{this.off(cn.WS_CLOSED,ne),q()},ne=()=>{this.off(cn.WS_CONNECTED,H),j(new Ue(oe.WS_ABORT))};this.once(cn.WS_CONNECTED,H),this.once(cn.WS_CLOSED,ne),n!==nn.PUBLISH&&n!==nn.PUBLISH_DATASTREAM&&n!==nn.SUBSCRIBE&&n!==nn.SUBSCRIBE_DATASTREAM&&n!==nn.UNSUBSCRIBE&&n!==nn.UNSUBSCRIBE_DATASTREAM&&n!==nn.UNPUBLISH&&n!==nn.UNPUBLISH_DATASTREAM&&n!==nn.CONTROL&&n!==nn.RESTART_ICE||this.once(cn.DISCONNECT_P2P,()=>{j(new Ue(oe.DISCONNECT_P2P))}),n!==nn.PUBLISH&&n!==nn.RESTART_ICE||this.once(cn.ABORT_P2P_EXECUTION,()=>{j(new Ue(oe.DISCONNECT_P2P))})});if(this.connectionState!==vr.CONNECTING&&this.connectionState!==vr.RECONNECTING||n===nn.JOIN||n===nn.REJOIN||await _(),this.websocket.sendMessage(f,!0),c)return;const y=new bt((q,j)=>{let H=!1;const ne=(ve,Oe)=>{H=!0,q({isSuccess:ve==="success",message:Oe||{}}),this.off(cn.WS_CLOSED,re),this.off(cn.WS_RECONNECTING,re),this.emit(cn.REQUEST_SUCCESS,n,r)};this.once("res-@".concat(u),ne);const re=()=>{j(new Ue(oe.WS_ABORT,"type: ".concat(n))),this.off(cn.WS_CLOSED,re),this.off(cn.WS_RECONNECTING,re),this.off("res-@".concat(u),ne)};this.once(cn.WS_CLOSED,re),this.once(cn.WS_RECONNECTING,re),Do(de("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==m||H||(x.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(n)),this.emit(cn.REQUEST_TIMEOUT,n,r))})});let T=null;try{T=await y}catch(q){if(this.connectionState===vr.CLOSED||n===nn.LEAVE)throw new Ue(oe.WS_ABORT);return!this.spec.forceWaitGatewayResponse||i?q.throw():n===nn.JOIN||n===nn.REJOIN?null:(await _(),await this.request(n,r))}if(T.isSuccess)return T.message;const A=Number(T.message.error_code||T.message.code),k=mv(A),P=new Ue(oe.UNEXPECTED_RESPONSE,"".concat(k.desc,": ").concat(T.message.error_str),{code:A,data:T.message,desc:k.desc});return k.action==="success"?T.message:(x.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(n,", error_code: ").concat(A,", message: ").concat(k.desc,", action: ").concat(k.action)),A===Yt.ERR_TOO_MANY_BROADCASTERS?((n===nn.JOIN||n===nn.REJOIN)&&(this.initError=P,this.close()),P.throw()):k.action==="failed"?P.throw():k.action==="quit"?(this.initError=P,this.close(),P.throw()):(A===Yt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=T.message.option,x.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Fo.MULTI_IP)):this.reconnect(k.action,Fo.SERVER_ERROR),n===nn.JOIN||n===nn.REJOIN?null:await this.request(n,r)))}waitMessage(n,r){return new bt(i=>{const c=u=>{(!r||r(u))&&(this.off(n,c),i(u))};this.on(n,c)})}uploadWRTCStats(n){if(!this.store.sessionId)return void x.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:n};this.upload(fv.WRTC_STATS,r)}upload(n,r){const i={_type:n,_message:r};try{this.websocket.sendMessage(i)}catch{const u=de("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==vr.CONNECTED)return;const f=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(f._type,f._message)},de("UPLOAD_CACHE_INTERVAL")||2e3))}}send(n,r){const i={_type:n,_message:r};this.websocket.sendMessage(i)}init(n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new bt((r,i)=>{this.once(cn.WS_CONNECTED,()=>r(this.joinResponse)),this.once(cn.WS_CLOSED,c=>i(this.initError||new Ue(oe.WS_ABORT,c))),this.connectionState=vr.CONNECTING,this.websocket.init(n).catch(i),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=n||Yn.LEAVE,this.connectionState=vr.CLOSED,x.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(cn.ABORT_P2P_EXECUTION);const n=await Bo(this,cn.REQUEST_JOIN_INFO),r=await this.request(nn.JOIN,n);if(!r)return this.emit(cn.REPORT_JOIN_GATEWAY,Ty.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(cn.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=vr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new Ue(oe.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const n=iv(this,cn.REQUEST_REJOIN_INFO);n.token=this.reconnectToken;const r=await this.request(nn.REJOIN,n);return!!r&&(this.connectionState=vr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),r.peers&&r.peers.forEach(i=>{this.emit(An.ON_USER_ONLINE,{uid:i.uid}),i.audio&&this.emit(An.ON_ADD_AUDIO_STREAM,{uid:i.uid,uint_id:i.uint_id,audio:!0,ssrcId:i.audio_ssrc}),i.video&&this.emit(An.ON_ADD_VIDEO_STREAM,{uid:i.uid,uint_id:i.uint_id,video:!0,ssrcId:i.video_ssrc}),i.audio_mute?this.emit(An.MUTE_AUDIO,{uid:i.uid}):this.emit(An.UNMUTE_AUDIO,{uid:i.uid}),i.video_mute?this.emit(An.MUTE_VIDEO,{uid:i.uid}):this.emit(An.UNMUTE_VIDEO,{uid:i.uid}),i.audio_enable_local?this.emit(An.ENABLE_LOCAL_AUDIO,{uid:i.uid}):this.emit(An.DISABLE_LOCAL_AUDIO,{uid:i.uid}),i.video_enable_local?this.emit(An.ENABLE_LOCAL_VIDEO,{uid:i.uid}):this.emit(An.DISABLE_LOCAL_VIDEO,{uid:i.uid}),i.audio||i.video||this.emit(An.ON_REMOVE_STREAM,{uid:i.uid,uint_id:i.uint_id})}),!0)}reconnect(n,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(n,r)}handleNotification(n){x.debug("[".concat(this.clientId,"] receive notification: "),n);const r=mv(n.code);if(n.code===28&&"detail"in n&&(x.info("[".concat(this.clientId,"] receive recover notification: "),n.detail),this.emit(cn.RECOVER_NOTIFICATION,n.detail)),r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Yn.UID_BANNED),void this.close()):void this.reconnect(r.action,Fo.SERVER_ERROR);x.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const n=de("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=n&&(x.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>de("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Fo.TIMEOUT):this.request(nn.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const i=Date.now()-r;this.rttRolling.add(i),de("REPORT_STATS")&&this.send(nn.PING_BACK,{pingpongElapse:i})}).catch(i=>{})}handleWsInflateData(){const{wsInflateLength:n,wsDeflateLength:r}=this.websocket.getWsInflateData();n!==0&&r!==0&&this.upload(fv.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:r,ws_inflate_length:n})}handleWebsocketEvents(){this.websocket.on(pn.RECONNECT_CREATE_CONNECTION,n=>{this.emit(cn.WS_RECONNECT_CREATE_CONNECTION,n)}),this.websocket.on(pn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(pn.CLOSED,()=>{this.connectionState=vr.CLOSED}),this.websocket.on(pn.FAILED,()=>{this._disconnectedReason=Yn.NETWORK_ERROR,this.connectionState=vr.CLOSED}),this.websocket.on(pn.RECONNECTING,n=>{this._websocketReconnectReason=n,this.joinResponse=void 0,this.connectionState===vr.CONNECTED?this.connectionState=vr.RECONNECTING:this.connectionState=vr.CONNECTING}),this.websocket.on(pn.WILL_RECONNECT,(n,r,i)=>{const c=iv(this,cn.IS_P2P_DISCONNECTED),u=c||n!=="retry";c&&n==="retry"&&(x.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),n="tryNext",r=Ty.P2P_DISCONNECTED),u&&(x.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(n)),this.emit(cn.REPORT_JOIN_GATEWAY,r||Ty.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(cn.DISCONNECT_P2P)),i(n)}),this.websocket.on(pn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(n=>{x.warning("[".concat(this.clientId,"] rejoin failed ").concat(n)),this.reconnect("tryNext",Fo.SERVER_ERROR)}):this.join().catch(n=>{if(this.emit(cn.REPORT_JOIN_GATEWAY,n,this.url||""),n instanceof Ue){if(n.code===oe.UNEXPECTED_RESPONSE&&n.data.code===Yt.ERR_NO_AUTHORIZED)return this.initError=new Ue(oe.TOKEN_EXPIRE,"dynamic key expired"),void this.close(Yn.TOKEN_EXPIRE);x.error("[".concat(this.clientId,"] join gateway request failed"),n.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Fo.SERVER_ERROR):(this.initError=n,this.close())}})}),this.websocket.on(pn.REQUEST_NEW_URLS,(n,r)=>{Bo(this,cn.REQUEST_RECOVER,this.multiIpOption).then(n).catch(r)}),this.websocket.on(pn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(An.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(oB.PRE_CONNECT_PC,()=>{this.emit(cn.PRE_CONNECT_PC)})}}let Sce=function(e){return e.NATIVE_RTC="native_rtc",e.NATIVE_RTM="native_rtm",e.WEB_RTC="web_rtc",e.WEB_RTM="web_rtm",e}({}),eo=function(e){return e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",e}({});function lB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function wy(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?lB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Nu(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(de("TURN_DOMAIN")):(x.debug("Cannot recognized as ip address: ".concat(e,", use as host")),e)}function VR(e,n){e.addresses||(e.addresses=[]);const r=function(m,_){if(de("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return m.map(A=>{let{ip:k,port:P}=A;return{address:"".concat(k,":").concat(P)}});const y=de("GATEWAY_DOMAINS");let T=y[1]&&gt(_).call(_,y[1])?1:0;return m.map(A=>{let{domain_prefix:k,port:P,ip:q}=A;if(k)return{address:"".concat(k,".").concat(y[T++%y.length],":").concat(P)};const j=/^[\.\:\d]+$/.test(q),H=j?"".concat(q.replace(/[^\d]/g,"-"),".").concat(y[T++%y.length],":").concat(P):"".concat(q,":").concat(P);return j||x.debug("Cannot recognized as ip address: ".concat(q,", use as host")),{ip:q,port:P,address:H}})}(e.addresses,n),i=Array.isArray(e.detail)&&e.detail[18];if(i&&typeof i=="string"){const m=i.split(";");for(let _=0;_<m.length;_++){var c;const y=es(c=m[_]).call(c);r[_]&&y&&(r[_].ip6=y)}}const u=e.detail&&e.detail.candidate;let f;if(u){const[m,_]=u.split(":");m&&_&&(f={port:Number(_),ip:m,address:"".concat(m,":").concat(_)})}return{gatewayAddrs:r,apGatewayAddress:f,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function ii(e){return typeof e=="number"?e:e.exact||e.ideal||e.max||e.min||0}function uB(e){const n=e._encoderConfig;if(!n)return{};const r={resolution:n.width&&n.height?"".concat(ii(n.width),"x").concat(ii(n.height)):void 0,maxVideoBW:n.bitrateMax,minVideoBW:n.bitrateMin};return typeof n.frameRate=="number"?(r.maxFrameRate=n.frameRate,r.minFrameRate=n.frameRate):n.frameRate&&(r.maxFrameRate=n.frameRate.max||n.frameRate.ideal||n.frameRate.exact||n.frameRate.min,r.minFrameRate=n.frameRate.min||n.frameRate.ideal||n.frameRate.exact||n.frameRate.max),r}function dB(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function gv(e,n){let r,i,c;switch(n){case eo.CHOOSE_SERVER:i=4096,c="choose server";break;case eo.CLOUD_PROXY:i=1048576,c="proxy";break;case eo.CLOUD_PROXY_5:i=4194304,c="proxy5";break;case eo.CLOUD_PROXY_FALLBACK:i=4194310,c="proxy fallback";break;default:throw new Ue(oe.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach(u=>{u.buffer&&u.buffer.flag===i&&(r={code:u.buffer.code,addresses:(u.buffer.edges_services||[]).map(f=>wy(wy({},f),{},{ticket:u.buffer.cert})),server_ts:e.enter_ts,uid:u.buffer.uid,cid:u.buffer.cid,cname:u.buffer.cname,detail:wy(wy({},u.buffer.detail),e.detail),flag:u.buffer.flag,opid:e.opid,cert:u.buffer.cert})}),!r)throw new Ue(oe.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(c," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return r}async function hB(e,n){return await bt.all(e.addresses.map(async r=>({address:de("USE_TURN_IP")?r.ip:Nu(r.ip),tcpport:r.port,udpport:r.port,username:n&&de("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?n.toString():jo.username,password:n&&de("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await Ww(n.toString()):jo.password})))}function FR(e,n){const r=n.getMediaStreamTrack(!0).getSettings(),i=n.videoHeight||r.height,c=n.videoWidth||r.width;return i&&c?Math.max(Math.min(i,c)/Math.min(ii(e.height),ii(e.width)),1):(x.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function ku(e){let{candidateType:n,relayProtocol:r,type:i,address:c,port:u,protocol:f}=e;const m={candidateType:n,relayProtocol:r,protocol:f};if(i!=="local-candidate"){const _=c.split(".");_.length>=4&&(_[1]="*",_[2]="*"),m.address=_.join("."),m.port=u}return m}function Ry(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:de("SVC_MODE");if(de("ENABLE_SVC"))return function(n){return n in ty}(e)?e:ty.L1T3}const fB={[kt.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[kt.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function Iy(e,n,r){n.forEach(i=>{var c;const u=fB[e].find(m=>{var _;let{key:y}=m;return gt(_=i.extensionName).call(_,y)});if(!u)return;const f=r.find(m=>{let{extensionName:_}=m;return gt(_).call(_,u.key)});f&&gt(c=f.extensionName).call(c,"gdpr_forbidden")&&(i.extensionName=f.extensionName)})}function Jf(e,n){n.forEach(r=>{var i;const c=fB[e].find(u=>{var f;let{key:m}=u;return gt(f=r.extensionName).call(f,m)});gt(i=r.extensionName).call(i,"gdpr_forbidden")&&c&&(r.extensionName=c.extensionName)})}function pB(e){return e==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||gt(e).call(e,"abs-send-time")}function Ay(e){return e==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||gt(e).call(e,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function mB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function vB(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?mB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function _v(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;const{filterRTX:c,filterVideoFec:u,filterAudioFec:f,filterAudioCodec:m,filterVideoCodec:_}=n,{useXR:y}=r;let T=[],A=[],k=[],P=[],q=!1,j=!1;if($s(e).mediaDescriptions.forEach(ne=>{i&&i!==ne.attributes.direction||(ne.media.mediaType!=="video"||q||(A=ne.attributes.payloads,P=ne.attributes.extmaps,q=!0),ne.media.mediaType!=="audio"||j||(T=ne.attributes.payloads,k=ne.attributes.extmaps,j=!0))}),!P||A.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!k||T.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(A.forEach(ne=>{var re;(re=ne.rtpMap)!==null&&re!==void 0&&re.clockRate&&(ne.rtpMap.clockRate=parseInt(ne.rtpMap.clockRate)),y&&ne.rtcpFeedbacks.push({type:"rrtr"})}),T.forEach(ne=>{var re;(re=ne.rtpMap)!==null&&re!==void 0&&re.clockRate&&(ne.rtpMap.clockRate=parseInt(ne.rtpMap.clockRate)),y&&ne.rtcpFeedbacks.push({type:"rrtr"})}),c&&(T=T.filter(ne=>{var re;return((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName.toLowerCase())!=="rtx"}),A=A.filter(ne=>{var re;return((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName.toLowerCase())!=="rtx"})),u&&(A=A.filter(ne=>{var re;return!/(red)|(ulpfec)|(flexfec)/i.test(((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName)||"")})),f&&(T=T.filter(ne=>{var re;return!/(red)|(ulpfec)|(flexfec)/i.test(((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName)||"")})),m&&(m==null?void 0:m.length)>0&&(T=T.filter(ne=>{var re;return gt(m).call(m,((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName.toLowerCase())||"")})),_&&(_==null?void 0:_.length)>0){const ne=A.filter(re=>{var ve;return gt(_).call(_,((ve=re.rtpMap)===null||ve===void 0?void 0:ve.encodingName.toLowerCase())||"")});A=ne.concat(c?[]:$R(ne,A))}const H=de("UNSUPPORTED_VIDEO_CODEC");return H&&H.length>0&&(A=A.filter(ne=>!(ne.rtpMap&&gt(H).call(H,ne.rtpMap.encodingName.toLowerCase())))),{audioCodecs:T,videoCodecs:A,audioExtensions:k,videoExtensions:P}}function Pu(e){const n=$s(e);let r,i;for(const c of n.mediaDescriptions){if(!r){const u=c.attributes.iceUfrag,f=c.attributes.icePwd;if(!u||!f)throw new Error("Cannot get iceUfrag or icePwd from SDP.");r={iceUfrag:u,icePwd:f}}if(!i){const u=c.attributes.fingerprints;u.length>0&&(i={fingerprints:u})}}if(!i&&n.attributes.fingerprints.length>0&&(i={fingerprints:n.attributes.fingerprints}),!i||!r)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:r,dtlsParameters:i}}function gB(e,n){const r=[],i=e.attributes.ssrcGroups.filter(f=>f.semantic==="FID"),c=e.attributes.ssrcGroups.find(f=>f.semantic==="SIM"),u=e.attributes.ssrcs;if(c)c.ssrcIds.forEach(f=>{var m;const _=(m=i.find(y=>y.ssrcIds[0]===f))===null||m===void 0?void 0:m.ssrcIds[1];r.push({ssrcId:f,rtx:n?_:void 0})});else if(i.length>0){const f=i[0].ssrcIds[0],m=i[0].ssrcIds[1];r.push({ssrcId:f,rtx:n?m:void 0})}else{if(u.length===0)throw new Error("No ssrcs found on local media description.");r.push({ssrcId:u[0].ssrcId})}return r}function _B(e,n,r){const{cname:i}=e;let c=[];n&&(c=EB(n)),c.length===0&&(c=e.iceParameters.candidates.map(T=>({foundation:T.foundation,componentId:"1",transport:T.protocol,priority:T.priority.toString(),connectionAddress:T.ip,port:T.port.toString(),type:T.type,extension:{}})),x.debug("Using candidates from gateway."));const u={fingerprints:e.dtlsParameters.fingerprints.map(T=>({hashFunction:T.algorithm,fingerprint:T.fingerprint}))},f={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let m;switch(e.dtlsParameters.role){case"server":m="passive";break;case"client":m="active";break;case"auto":m="actpass"}const _=Ny(e.rtpCapabilities),y=[];return Array.isArray(r)&&r.length>0&&r.forEach(T=>{y.push({kind:kt.VIDEO,ssrcId:T.v,rtx:T.v_rtx,mslabel:"".concat(T.v,"_").concat(T.a)},{kind:kt.AUDIO,ssrcId:T.a,mslabel:"".concat(T.v,"_").concat(T.a)})}),{dtlsParameters:u,iceParameters:f,candidates:c,rtpCapabilities:_,setup:m,cname:i,preSSRCs:y}}function EB(e){let n=[];return e.ip&&typeof e.port=="number"&&(n=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],x.debug("Using remote candidate from AP ".concat(e.ip,":").concat(e.port)),e.ip6&&(n.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip6,port:e.port.toString(),type:"host",extension:{}}),x.debug("Using IPV6 remote candidate from AP ".concat(e.ip6,":").concat(e.port)))),n}function zd(e,n,r){const i=[],c=[];return e.forEach(u=>{let{ssrcId:f,rtx:m}=u;const _=dr(8,"track-"),y={ssrcId:f,attributes:vB({label:_,mslabel:r=r||dr(10,""),msid:"".concat(r," ").concat(_)},n&&{cname:n})};if(i.push(y),m!==void 0){const T={ssrcId:m,attributes:vB({label:_,mslabel:r,msid:"".concat(r," ").concat(_)},n&&{cname:n})};i.push(T),c.push({semantic:"FID",ssrcIds:[f,m]})}}),e.length>1&&c.push({semantic:"SIM",ssrcIds:e.map(u=>{let{ssrcId:f}=u;return f})}),{ssrcs:i,ssrcGroups:c}}function Zf(e,n){n instanceof Hr&&e.attributes.payloads.forEach(r=>{var i;const c=(i=r.rtpMap)===null||i===void 0?void 0:i.encodingName.toLowerCase();if(!c||["opus","pcmu","pcma","g722"].indexOf(c)===-1)return;r.fmtp||(r.fmtp={parameters:{}}),r.fmtp.parameters.minptime="10",r.fmtp.parameters.useinbandfec="1";const u=n._encoderConfig;u&&c!=="pcmu"&&c!=="pcma"&&c!=="g722"&&(u.bitrate&&!Ur()&&(r.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*u.bitrate))),u.sampleRate&&(r.fmtp.parameters.maxplaybackrate="".concat(u.sampleRate),r.fmtp.parameters["sprop-maxcapturerate"]="".concat(u.sampleRate)),u.stereo&&(r.fmtp.parameters.stereo="1",r.fmtp.parameters["sprop-stereo"]="1"))})}function BR(e){const n=e.attributes.unrecognized.findIndex(r=>r.attField==="x-google-flag"&&r.attValue==="conference");n!==-1&&e.attributes.unrecognized.splice(n,1)}function jR(e,n){var r;if(!(n instanceof Sr&&n._encoderConfig&&n._hints.indexOf(hr.SCREEN_TRACK)===-1))return;const i=n._encoderConfig;Bn().supportMinBitrate&&i.bitrateMin&&e.attributes.payloads.forEach(c=>{var u,f;gt(u=["h264","h265","vp8","vp9","av1"]).call(u,((f=c.rtpMap)===null||f===void 0?void 0:f.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-min-bitrate"]="".concat(i.bitrateMin))}),Bn().supportMinBitrate&&!gt(r=n._hints).call(r,hr.LOW_STREAM)&&i.bitrateMax&&e.attributes.payloads.forEach(c=>{var u,f;gt(u=["h264","h265","vp8","vp9","av1"]).call(u,((f=c.rtpMap)===null||f===void 0?void 0:f.encodingName.toLowerCase())||"")&&(c.fmtp||(c.fmtp={parameters:{}}),c.fmtp.parameters["x-google-start-bitrate"]="".concat(de("X_GOOGLE_START_BITRATE")||Math.floor(i.bitrateMax)))})}function yB(e){if(e.media.mediaType!=="video")return;const n=Mn();if(n.name!==jn.SAFARI&&n.os!==yo.IOS)return;const r=e.attributes.extmaps.findIndex(i=>/video-orientation/g.test(i.extensionName));r!==-1&&e.attributes.extmaps.splice(r,1)}function Oy(e,n,r){if(!n)return;let i,c;if(e.media.mediaType==="video"?(i=r.videoExtensions,c=r.videoCodecs):(i=r.audioExtensions,c=r.audioCodecs),n.twcc===!0){const u=i.find(f=>Ay(f.extensionName));if(u){const f=u.extensionName;e.attributes.extmaps.find(_=>Ay(_.extensionName))||e.attributes.extmaps.push({entry:u.entry,extensionName:f}),function(_,y){return y.filter(T=>!!_.find(A=>A.payloadType===T.payloadType&&!!A.rtcpFeedbacks.find(k=>k.type==="transport-cc")))}(c,e.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(y=>y.type==="transport-cc")||_.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(n.twcc===!1){const u=e.attributes.extmaps.findIndex(f=>Ay(f.extensionName));u!==-1&&e.attributes.extmaps.splice(u,1),e.attributes.payloads.forEach(f=>{const m=f.rtcpFeedbacks.findIndex(_=>_.type==="transport-cc");m!==-1&&f.rtcpFeedbacks.splice(m,1)})}if(n.remb===!0){const u=i.find(f=>pB(f.extensionName));if(u){const f=u.extensionName;e.attributes.extmaps.find(_=>_.extensionName===f)||e.attributes.extmaps.push({entry:u.entry,extensionName:f}),function(_,y){return y.filter(T=>!!_.find(A=>A.payloadType===T.payloadType&&!!A.rtcpFeedbacks.find(k=>k.type==="goog-remb")))}(c,e.attributes.payloads).forEach(_=>{_.rtcpFeedbacks.find(y=>y.type==="goog-remb")||_.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(n.remb===!1){const u=e.attributes.extmaps.findIndex(f=>pB(f.extensionName));u!==-1&&e.attributes.extmaps.splice(u,1),e.attributes.payloads.forEach(f=>{const m=f.rtcpFeedbacks.findIndex(_=>_.type==="goog-remb");m!==-1&&f.rtcpFeedbacks.splice(m,1)})}}function bB(e,n,r){if(Ur()||e.media.mediaType!=="video"||!(n instanceof Sr)||r!=="vp9"&&r!=="vp8"||r==="vp8"&&!de("SIMULCAST")||r==="vp9"&&de("ENABLE_SVC")||n._scalabilityMode===void 0||n._scalabilityMode.numSpatialLayers<=1)return;const i=r==="vp8"?2:n._scalabilityMode.numSpatialLayers,c=e.attributes.ssrcs[0],u=e.attributes.ssrcGroups.find(m=>m.semantic==="FID"&&m.ssrcIds[0]===c.ssrcId),f={semantic:"SIM",ssrcIds:[c.ssrcId]};for(let m=1;m<i;m++)e.attributes.ssrcs.push({ssrcId:c.ssrcId+m,attributes:Br(c.attributes)}),f.ssrcIds.push(c.ssrcId+m),u&&(e.attributes.ssrcs.push({ssrcId:u.ssrcIds[1]+m,attributes:Br(c.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[c.ssrcId+m,u.ssrcIds[1]+m]}));e.attributes.ssrcGroups.unshift(f)}async function SB(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new RTCPeerConnection;r.addTransceiver("video",{direction:"sendonly"}),r.addTransceiver("audio",{direction:"sendonly"}),r.addTransceiver("video",{direction:"recvonly"}),r.addTransceiver("audio",{direction:"recvonly"});const i=(await r.createOffer()).sdp,{send:c,recv:u,sendrecv:f}=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0;const T=_v(y,m,_,"sendonly"),A=_v(y,m,_,"recvonly"),k={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},P={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},q={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Aa(T,A,"videoExtensions",k,P,q),Aa(T,A,"videoCodecs",k,P,q),Aa(T,A,"audioExtensions",k,P,q),Aa(T,A,"audioCodecs",k,P,q),de("RAISE_H264_BASELINE_PRIORITY")){const j=[],H=[];q.videoCodecs.forEach((ne,re)=>{var ve;if(((ve=ne.rtpMap)===null||ve===void 0?void 0:ve.encodingName.toLocaleLowerCase())==="h264"){var Oe,ke;const we=q.videoCodecs[re+1],Be=we&&IB(ne,we),lt=(Oe=ne.fmtp)===null||Oe===void 0?void 0:Oe.parameters["profile-level-id"],St=(ke=ne.fmtp)===null||ke===void 0?void 0:ke.parameters["packetization-mode"];!lt||lt!==de("FIRST_H264_PROFILE_LEVEL_ID")||de("FIRST_PACKETIZATION_MODE")&&St!==de("FIRST_PACKETIZATION_MODE")?Be?H.push([ne,we]):H.push([ne]):Be?j.push([ne,we]):j.push([ne])}}),j.length>0&&H.length>0&&(x.debug("raising H264 baseline profile priority"),q.videoCodecs.forEach((ne,re)=>{var ve;if(((ve=ne.rtpMap)===null||ve===void 0?void 0:ve.encodingName.toLocaleLowerCase())==="h264"){const Oe=IB(ne,q.videoCodecs[re+1]),ke=j.shift()||H.shift()||[];ke.length>0&&(Oe?q.videoCodecs.splice(re,2,...ke):q.videoCodecs.splice(re,1,...ke))}}),P.videoCodecs=P.videoCodecs.filter(ne=>{var re,ve;return!(((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName.toLocaleLowerCase())==="h264"&&((ve=ne.fmtp)===null||ve===void 0?void 0:ve.parameters["profile-level-id"])!==de("FIRST_H264_PROFILE_LEVEL_ID"))}),de("FILTER_SEND_H264_BASELINE")&&(k.videoCodecs=k.videoCodecs.filter(ne=>{var re,ve;return!(((re=ne.rtpMap)===null||re===void 0?void 0:re.encodingName.toLocaleLowerCase())==="h264"&&((ve=ne.fmtp)===null||ve===void 0?void 0:ve.parameters["profile-level-id"])!==de("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:k,recv:P,sendrecv:q}}(e,n,i);try{r.close()}catch{}return{send:c,recv:u,sendrecv:f}}function TB(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},n=_v(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Aa(e,n,"videoExtensions",r,i,c),Aa(e,n,"videoCodecs",r,i,c),Aa(e,n,"audioExtensions",r,i,c),Aa(e,n,"audioCodecs",r,i,c),de("RAISE_H264_BASELINE_PRIORITY")){const u=c.videoCodecs.findIndex(f=>f.rtpMap&&f.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&f.fmtp&&f.fmtp.parameters["profile-level-id"]==="42001f");if(u!==-1){const f=c.videoCodecs.findIndex(m=>m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(f<u){x.debug("raising H264 baseline profile priority");const m=c.videoCodecs[u];c.videoCodecs.splice(u,1),c.videoCodecs.splice(f,0,m)}f!==-1&&(i.videoCodecs=i.videoCodecs.filter(m=>!(m.rtpMap&&m.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&m.fmtp&&m.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:r,recv:i,sendrecv:c}}function Aa(e,n,r,i,c,u){if(r==="videoExtensions"||r==="audioExtensions"){const f=[];return e[r].forEach(m=>{n[r].some((_,y)=>{if(m.entry===_.entry&&m.extensionName===_.extensionName)return f.push(y),!0})?u[r].push(m):i[r].push(m)}),void n[r].forEach((m,_)=>{f.indexOf(_)===-1&&c[r].push(m)})}if(r==="videoCodecs"||r==="audioCodecs"){const f=[];return e[r].forEach(m=>{n[r].some((_,y)=>{if(m.payloadType===_.payloadType&&JSON.stringify(m)===JSON.stringify(_))return f.push(y),!0})?u[r].push(m):i[r].push(m)}),void n[r].forEach((m,_)=>{f.indexOf(_)===-1&&c[r].push(m)})}}function Ny(e){const{send:n,recv:r,sendrecv:i}=e;if(!i){if(!n||!r)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:n,recv:r}}let c,u;return n?(c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c.audioCodecs=[...n.audioCodecs,...i.audioCodecs],c.videoCodecs=[...n.videoCodecs,...i.videoCodecs],c.audioExtensions=[...n.audioExtensions,...i.audioExtensions],c.videoExtensions=[...n.videoExtensions,...i.videoExtensions]):c=i,r?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...r.audioCodecs,...i.audioCodecs],u.videoCodecs=[...r.videoCodecs,...i.videoCodecs],u.audioExtensions=[...r.audioExtensions,...i.audioExtensions],u.videoExtensions=[...r.videoExtensions,...i.videoExtensions]):u=i,{send:c,recv:u}}function Qf(e){e.media.mediaType==="audio"&&e.attributes.payloads.filter(n=>{var r;return((r=n.rtpMap)===null||r===void 0?void 0:r.encodingName.toLowerCase())==="opus"}).forEach(n=>{n.fmtp||(n.fmtp={parameters:{}}),n.fmtp.parameters.stereo="1",n.fmtp.parameters["sprop-stereo"]="1"})}function Ev(e,n,r,i){let c=[];if(e===kt.VIDEO){if(de("H264_PROFILE_LEVEL_ID")&&i==="h264"&&(c=n.videoCodecs.filter(u=>{var f;return gt(f=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(f,i)&&u&&u.fmtp&&u.fmtp.parameters["profile-level-id"]===de("H264_PROFILE_LEVEL_ID")})),!Array.isArray(c)||c.length===0){let u=[];const f=[],m=[],_=[];if(r.videoCodecs.forEach(y=>{const T=y.rtpMap&&y.rtpMap.encodingName.toLowerCase()||"";gt(T).call(T,i)?u.push(y):gt(T).call(T,"vp9")?f.push(y):gt(T).call(T,"vp8")?m.push(y):gt(T).call(T,"h264")&&_.push(y)}),u.length===0){let y="";f.length!==0?(u=f,y="vp9"):m.length!==0?(u=m,y="vp8"):_.length!==0&&(u=_,y="h264"),x.warning("codec ".concat(i," not included in rtpCapabilities, fallback to default payloads: ").concat(y))}u.length!==0&&(c=n.videoCodecs.filter(y=>u.some(T=>T.payloadType===y.payloadType)))}if(c.length===0&&(x.warning("codec ".concat(i," not included in rtpCapabilities, fallback to default payloads: ").concat(n.videoCodecs[0].rtpMap&&n.videoCodecs[0].rtpMap.encodingName)),c=n.videoCodecs),de("USE_PUB_RTX")||de("USE_SUB_RTX")){const u=$R(c,n.videoCodecs);c=[...c,...u]}}else c=n.audioCodecs.filter(u=>{var f;return gt(f=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(f,i)}),c.length===0&&(x.warning("codec ".concat(i," not included in rtpCapabilities, fallback to opus")),c=n.audioCodecs.filter(u=>{var f;return gt(f=u.rtpMap&&u.rtpMap.encodingName.toLowerCase()||"").call(f,"opus")}));return c}function $R(e,n){const r=e.map(i=>i.payloadType.toString());return n.filter(i=>i.rtpMap&&i.rtpMap.encodingName==="rtx"&&i.fmtp&&i.fmtp.parameters.apt&&gt(r).call(r,i.fmtp&&i.fmtp.parameters.apt))}async function yv(e,n,r){const i=n.toString(),c=wB(i,"offer","remote","exchangeSDP");await e.setRemoteDescription({type:"offer",sdp:i});const u=await e.createAnswer();if(!u.sdp)throw new Error("cannot get answer sdp");let f=u.sdp;f=CB(f,r||{}),c==null||c(f||""),await e.setLocalDescription({type:"answer",sdp:f})}function CB(e,n,r){const i=$s(e),{useXR:c}=n;return i.mediaDescriptions.forEach(u=>{var f;u.attributes.mid&&(Array.isArray(r)&&!gt(r).call(r,u.attributes.mid)||(u.media.mediaType==="audio"&&Qf(u),c&&gt(f=["audio","video"]).call(f,u.media.mediaType)&&u.attributes.payloads.forEach(m=>{m.rtcpFeedbacks.findIndex(_=>_.type==="rrtr")===-1&&m.rtcpFeedbacks.push({type:"rrtr"})})))}),Iu(i)}function wB(e,n,r,i){if(de("SDP_LOGGING"))return x.upload("exchanging ".concat(r," ").concat(n," SDP during P2PConnection.").concat(i,`
`),e),n==="offer"?c=>{wB(c,"answer",r==="local"?"remote":"local",i)}:void 0}function RB(e){const n=de("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(n)&&n.length>0)&&n.some(r=>gt(e).call(e,r))}function IB(e,n){try{var r;return((r=e.fmtp)===null||r===void 0?void 0:r.parameters.apt)===n.payloadType.toString()}catch{return!1}}function AB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Zi(e,n){return typeof de(e)===n?de(e):void 0}function Tce(){try{const e=de("EXPERIMENTS")||{};return typeof e=="string"||Array.isArray(e)?{}:function(n){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?AB(Object(i),!0).forEach(function(c){Q(n,c,i[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):AB(Object(i)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(i,c))})}return n}({},e)}catch(e){return x.debug("handle gateway attributes failed: ",e),{}}}const OB={};function Du(e){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&x.debug("install service ".concat(e.name)),OB[e.name]=e}function Ml(e){const n=OB[e];if(!n)throw new $e(oe.INVALID_OPERATION,"".concat(e," not found, please use AgoraRTC.use(").concat(e,"Service) to load it first"));return n}function NB(e,n){return Ml("DataStream").create(e,n)}function ky(){return Ml("InterceptFrame").create()}function kB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function xl(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?kB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const HR=new Map;class Cce extends Dr{get state(){return this._state}set state(n){if(n===this._state)return;const r=this._state;this._state=n,n==="DISCONNECTED"&&this._disconnectedReason?this.emit(Ro.CONNECTION_STATE_CHANGE,n,r,this._disconnectedReason):this.emit(Ro.CONNECTION_STATE_CHANGE,n,r)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(n){x.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(n)),this._joinGatewayStartTime=n}constructor(n,r){var i,c,u;super(),Q(this,"store",void 0),Q(this,"joinInfo",void 0),Q(this,"key",void 0),Q(this,"ntpOffset",0),Q(this,"signal",void 0),Q(this,"role",void 0),Q(this,"inChannelInfo",{joinAt:null,duration:0}),Q(this,"spec",void 0),Q(this,"_state","DISCONNECTED"),Q(this,"_statsCollector",void 0),Q(this,"_disconnectedReason",void 0),Q(this,"isSignalRecover",!1),Q(this,"hasChangeBGPAddress",!1),Q(this,"trafficStatsInterval",void 0),Q(this,"networkQualityInterval",void 0),Q(this,"_joinGatewayStartTime",0),Q(this,"_signalTimeout",!1),Q(this,"_clientRoleOptions",void 0),Q(this,"_isProactiveJoin",!1),this.store=n,this.spec=r,this.signal=this.store.useP2P?(i={spec:xl(xl({},r),{},{retryConfig:r.websocketRetryConfig}),store:n},(c=(u=Ml("P2PChannel")).createSubmodule)===null||c===void 0?void 0:c.call(u,i)):new bce(xl(xl({},r),{},{retryConfig:r.websocketRetryConfig}),n),this._statsCollector=r.statsCollector,this.role=r.role||"audience",this._clientRoleOptions=r.clientRoleOptions,this.handleSignalEvents()}async join(n,r,i){this.store.joinGatewayStart(),n.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const c=Date.now();let u=HR.get(n.cname);if(u||(u=new Map,HR.set(n.cname,u)),this._isProactiveJoin=!0,u.has(n.uid)){const y=new Ue(oe.UID_CONFLICT);throw Bt.joinGateway(n.sid,{lts:c,succ:!1,ec:y.code,addr:null,uid:n.uid,cid:n.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!n.proxyServer,signalChannel:"0",preload:n.preload}),y}u.set(n.uid,!0),this.joinInfo=n,this.key=r;let f=0;this.joinGatewayStartTime=c;const m=n.proxyServer;try{x.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(f));const y=n.gatewayAddrs.map(T=>{let{address:A}=T;const[k,P]=A.split(":"),q={host:k,port:P};return n.proxyServer&&(q.proxy=n.proxyServer),q});f=(await this.signal.init(y)).uid,x.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(f," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(y){var _;throw x.error("[".concat(this.store.clientId,"] User join failed"),y.toString()),Bt.joinGateway(n.sid,{lts:c,succ:!1,ec:((_=y.data)===null||_===void 0?void 0:_.desc)||y.code,errorMsg:y.message,addr:this.signal.url,uid:n.uid,cid:n.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!m,signalChannel:"0",preload:n.preload}),u.delete(n.uid),this.signal.close(),y}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),x.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(y=>{x.warning("[".concat(this.store.clientId,"] get traffic stats error"),y.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(Ro.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(Ro.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(Ro.NETWORK_QUALITY,{uplinkNetworkQuality:dB(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:dB(this._statsCollector.trafficStats.B_dnq)}):this.emit(Ro.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),f}async leave(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){r!==Yn.FALLBACK&&(this.state="DISCONNECTING");try{n||this.signal.connectionState!==vr.CONNECTED||await function(i,c){return c===1/0?i:bt.race([i,qie(c)])}(this.signal.request(nn.LEAVE,void 0,!0),3e3)}catch(i){x.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),i)}this.signal.close(r),r!==Yn.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(n,r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const c={state:"offer",p2p_id:this.store.p2pId,ortc:r,mode:this.spec.mode,extend:de("PUB_EXTEND"),twcc:!!de("PUBLISH_TWCC"),rtx:!!de("USE_PUB_RTX")};try{return(await this.signal.request(nn.PUBLISH,c,!0))._message}catch(u){if(i&&u.data&&u.data.code===Yt.ERR_PUBLISH_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),u.toString()),await this.tryUnpubBeforeRepub(n,r),this.publish(n,r,!1);throw u}}async publishDataChannel(n,r,i){var c;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={stream_id:r.streamId,ordered:r.ordered?1:0,max_retrans_times:(c=r.maxRetransmits)!==null&&c!==void 0?c:10,channel_id:r.channelId,metadata:r.metadata};try{await this.signal.request(nn.PUBLISH_DATASTREAM,u,!0)}catch(f){if(i&&f.data&&f.data.code===Yt.ERR_PUBLISH_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),f.toString()),await this.tryUnpubDataChannelBeforeRepub(n,r),this.publishDataChannel(n,r,!1);throw f}}async unpublish(n,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(nn.UNPUBLISH,{stream_id:r,ortc:n},!0)}catch(i){x.warning("[".concat(this.store.clientId,"] unpublish warning: "),i)}}async unpublishDataChannel(n){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await bt.all(n.map(r=>this.signal.request(nn.UNPUBLISH_DATASTREAM,{channel_id:r},!0)))}catch(r){x.warning("unpublish datachannels warning: ",r)}}async presubscribe(n,r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const c={stream_id:n,stream_type:r,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!de("SUBSCRIBE_TWCC"),rtx:!!de("USE_SUB_RTX")||void 0,extend:de("SUB_EXTEND"),svc:Array.isArray(de("SVC"))&&de("SVC").length!==0?de("SVC"):void 0};try{return await this.signal.request(nn.PRE_SUBSCRIBE,c,!0)}catch(u){if(i&&u.data&&u.data.code===Yt.ERR_SUBSCRIBE_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),u.toString()),this.presubscribe(n,r,!1);throw u}}async subscribe(n,r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const c={stream_id:n,stream_type:r.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!de("SUBSCRIBE_TWCC"),rtx:!!de("USE_SUB_RTX"),extend:de("SUB_EXTEND"),ssrcId:r.ssrcId,svc:Array.isArray(de("SVC"))&&de("SVC").length!==0?de("SVC"):void 0};try{return(await this.signal.request(nn.SUBSCRIBE,c,!0))._message}catch(u){if(i&&u.data&&u.data.code===Yt.ERR_SUBSCRIBE_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),u.toString()),await this.tryUnsubBeforeResub(n,r),await this.subscribe(n,r,!1);throw u}}async subscribeDataChannel(n,r,i){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const c={uid:n,stream_id:r.id,channel_id:r.datachannelId};try{return void await this.signal.request(nn.SUBSCRIBE_DATASTREAM,c,!0)}catch(u){if(i&&u.data&&u.data.code===Yt.ERR_SUBSCRIBE_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),u.toString()),await this.tryUnsubDataChannelBeforeResub(n,r),await this.subscribeDataChannel(n,r,!1);throw u}}async subscribeAll(n,r){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const i={p2p_id:this.store.p2pId,users:n,dtx:!1,rtx:!!de("USE_SUB_RTX"),twcc:!!de("SUBSCRIBE_TWCC"),svc:Array.isArray(de("SVC"))&&de("SVC").length!==0?de("SVC"):void 0};try{return await this.signal.request(nn.SUBSCRIBE_STREAMS,i,!0)}catch(c){if(r&&c.data&&c.data.code===Yt.ERR_SUBSCRIBE_REQUEST_INVALID)return x.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),c.toString()),await this.tryMassUnsubBeforeResub(n),await this.subscribeAll(n,!1);throw c}}async setVideoProfile(n){const r=function(i){if(!(i.bitrateMax&&i.bitrateMin&&i.frameRate&&i.height&&i.width))return;let c=i.frameRate,u=i.width,f=i.height,m=!0;return typeof c!="number"&&(c=c.exact||c.ideal||c.max||c.min||0,c||(m=!1)),typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(m=!1)),typeof f!="number"&&(f=f.exact||f.ideal||f.max||f.min||0,c||(m=!1)),m?{stream_type:0,width:u,height:f,fps:c,start_bps:1e3*i.bitrateMax,min_bps:1e3*i.bitrateMin,target_bps:1e3*i.bitrateMax}:void 0}(n);if(r)return this.signal.request(nn.SET_VIDEO_PROFILE,r);x.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(n,r){try{await this.signal.request(nn.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:n,stream_id:r},!0)}catch(i){x.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),i)}}async unsubscribeDataChannel(n,r){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await bt.all(n.map(i=>this.signal.request(nn.UNSUBSCRIBE_DATASTREAM,{stream_id:i,uid:r},!0)))}catch(i){x.warning("unsubscribeDataChannel warning: ",i)}}async massUnsubscribe(n){try{await this.signal.request(nn.UNSUBSCRIBE_STREAMS,n,!0)}catch(r){x.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),r)}}async reconnectPC(n){const{iceParameters:r,dtlsParameters:i,rtpCapabilities:c}=n;return{gatewayEstablishParams:await this.signal.request(nn.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:r,dtlsParameters:i,rtpCapabilities:c}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(nn.GATEWAY_INFO)}async renewToken(n){await this.signal.request(nn.RENEW_TOKEN,n),this.key=n.token}updateClientRole(n,r){r&&(this._clientRoleOptions=Object.assign({},r)),de("CLIENT_ROLE_OPTIONS")&&(x.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(de("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},de("CLIENT_ROLE_OPTIONS"))),this.role=n}async setClientRole(n,r){if(r&&(this._clientRoleOptions=Object.assign({},r)),de("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},de("CLIENT_ROLE_OPTIONS")),x.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(de("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=n);let i,c=0;n==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(i=this._clientRoleOptions.delay,c=1):c=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:c=0,await this.signal.request(nn.SET_CLIENT_ROLE,{role:n,level:c,delay:i,client_ts:Date.now()}),this.role=n}async setRemoteVideoStreamType(n,r){await this.signal.request(nn.SWITCH_VIDEO_STREAM,{stream_id:n,stream_type:r})}async setDefaultRemoteVideoStreamType(n){await this.signal.request(nn.DEFAULT_VIDEO_STREAM,{stream_type:n})}async setStreamFallbackOption(n,r){await this.signal.request(nn.SET_FALLBACK_OPTION,{stream_id:n,fallback_type:r})}async pickSVCLayer(n,r){await this.signal.request(nn.PICK_SVC_LAYER,{stream_id:n,spatial_layer:r.spatialLayer,temporal_layer:r.temporalLayer})}async setRTM2Flag(n){await this.signal.request(nn.SET_RTM2_FLAG,{rtm2_flag:n})}async sendExtensionMessage(n,r,i){if(this.store.useP2P)return this.signal.sendExtensionMessage(n,r,i)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),xl({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(nn.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const n=HR.get(this.joinInfo.cname);n&&n.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const n=function(r){let i;return i=r.startsWith("dc")?r.match(/(dc\:\/\/)?([^:]+):(\d+)/):r.match(/(wss\:\/\/)?([^:]+):(\d+)/),i?{username:jo.username,password:jo.password,turnServerURL:i[2],tcpport:parseInt(i[3])+30,udpport:parseInt(i[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],n&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(xl(xl({},jo),{},{turnServerURL:n.turnServerURL,tcpport:n.tcpport,udpport:n.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const n=await this.signal.request(nn.TRAFFIC_STATS,void 0,!0);n.timestamp=Date.now(),n.ntp_offset!=null&&(this.ntpOffset=n.ntp_offset),n.peer_delay.forEach(r=>{const i=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(c=>c.peer_uid===r.peer_uid);i&&i.B_st!==r.B_st&&JE(()=>{this.emit(Ro.STREAM_TYPE_CHANGE,r.peer_uid,r.B_st)})}),this._statsCollector.updateTrafficStats(n)}getJoinMessage(n){if(!this.joinInfo||!this.key)throw new Ue(oe.UNEXPECTED_ERROR,"can not generate join message, no join info");const r=Object.assign({},this.joinInfo.apResponse);let i=de("REPORT_APP_SCENARIO");if(typeof i!="string")try{i=JSON.stringify(i)}catch{i=void 0}var c;i&&i.length>128&&(i=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(Ro.UPDATE_GATEWAY_CONFIG),c=this.store.clientId,gt(Gf).call(Gf,c)||Gf.push(c);const u=!(Ur()||qx(87)||VU())&&typeof de("ENABLE_PRE_SUB")=="boolean"&&de("ENABLE_PRE_SUB"),f=!VU()&&Zi("ENABLE_PREALLOC_PC","boolean"),m=Tce(),_=tv(87)||function(){const T=Mn();if(T.name!==jn.SAFARI||!T.browserVersion)return!1;const A=T.browserVersion.split(".");return Number(A[0])>15||Number(A[0])===15&&Number(A[1])>=4}(),y=xl({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Yi,browser:navigator.userAgent,process_id:de("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:r,extend:de("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:i,attributes:{userAttributes:xl({enableEncodedTransform:!!de("ENABLE_AUDIO_METADATA")&&_||!!de("ENABLE_AUDIO_TOPN")&&xw(jn.CHROME,87,116)||void 0,enableAudioMetadata:!!de("ENABLE_AUDIO_METADATA")&&_,enableAudioPts:!!de("ENABLE_AUDIO_PTS_METADATA")&&_,topnSmoothLevel:de("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:de("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:de("TOPN_SWITCH_HOLD_MS"),topnAudioGain:de("TOPN_AUDIO_GAIN"),enablePublishedUserList:de("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:de("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Zi("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Zi("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Zi("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:de("USE_PUB_RTX")===!0||de("USE_SUB_RTX")===!0||void 0,disableFEC:de("DISABLE_FEC"),enableNTPReport:!!de("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!de("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!de("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Zi("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!de("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!de("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Zi("USE_XR","boolean"),enableLossbasedBwe:Zi("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!de("ENABLE_AUT_CC")||void 0,enableCCFallback:Zi("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:f,preSubNum:u?Zi("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Zi("PUBLISH_TWCC","boolean"),enableSubTWCC:Zi("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Zi("USE_PUB_RTX","boolean"),enableSubRTX:Zi("USE_SUB_RTX","boolean"),enableSubSVC:de("ENABLE_SVC")?de("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(de("SVC"))&&de("SVC").length!==0?de("SVC"):void 0,enableSvcExtended:de("ENABLE_SVC")&&Array.isArray(de("SVC_EXTENDED"))&&de("SVC_EXTENDED").length!==0?de("SVC_EXTENDED"):void 0},m)},join_ts:this.joinGatewayStartTime},n);return this.joinInfo.stringUid&&(y.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(y.aes_mode=this.joinInfo.aesmode,de("ENCRYPT_AES")?(y.aes_secret=this.joinInfo.aespassword,y.aes_encrypt=!0):y.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(y.aes_salt=this.joinInfo.aessalt)),r.addresses[this.signal.websocket.currentURLIndex]&&(y.ap_response.ticket=r.addresses[this.signal.websocket.currentURLIndex].ticket,delete r.addresses),this.joinInfo.defaultVideoStream!==void 0&&(y.default_video_stream=this.joinInfo.defaultVideoStream),y}getRejoinMessage(){if(!this.joinInfo)throw new Ue(oe.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(cn.WS_RECONNECT_CREATE_CONNECTION,n=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(cn.WS_RECONNECTING,n=>{this.joinInfo&&Bt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:n||Fo.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",Bt.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(cn.WS_CLOSED,n=>{let r;switch(n){case Yn.LEAVE:r=Fo.LEAVE;break;case Yn.UID_BANNED:case Yn.IP_BANNED:case Yn.CHANNEL_BANNED:case Yn.SERVER_ERROR:r=Fo.SERVER_ERROR;break;case Yn.FALLBACK:r=Fo.FALLBACK;break;case Yn.LICENSE_MISSING:case Yn.LICENSE_EXPIRED:case Yn.LICENSE_MINUTES_EXCEEDED:case Yn.LICENSE_PERIOD_INVALID:case Yn.LICENSE_MULTIPLE_SDK_SERVICE:case Yn.LICENSE_ILLEGAL:case Yn.TOKEN_EXPIRE:r=n;break;default:r=Fo.NETWORK_ERROR}x.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(r||"undefined -> "+Fo.NETWORK_ERROR)),this.joinInfo&&Bt.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:n===Yn.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:r}),this._disconnectedReason=n,n!==Yn.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(cn.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const n=de("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;n&&(n.level||n.delay)&&(x.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(n.level,", delay: ").concat(n.delay)),this.setClientRole(this.role,n))}if(Bt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const n=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!n)return void x.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(n));tr("EVENT_REPORT_DOMAIN",n[1]),tr("EVENT_REPORT_BACKUP_DOMAIN",n[1]),tr("LOG_UPLOAD_SERVER","".concat(n[1],":6444"))}}}),this.signal.on(An.ON_UPLINK_STATS,n=>{this._statsCollector.updateUplinkStats(n)}),this.signal.on(cn.REQUEST_RECOVER,(n,r,i)=>{if(!this.joinInfo)return i(new Ue(oe.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));n&&(this.joinInfo.multiIP=n,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Bo(this,Ro.REQUEST_NEW_GATEWAY_LIST).then(r).catch(i)}),this.signal.on(cn.REQUEST_JOIN_INFO,async(n,r,i)=>{var c;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void n(this.getJoinMessage({ortc:{}}));const u=Br((c=this.joinInfo)===null||c===void 0?void 0:c.turnServer);if(de("NEW_TURN_MODE")&&u){let y=u.servers,T=u.serversFromGateway;const A=this.signal.currentURLIndex;y.length>0&&(y=[y[A%y.length]],u.servers=y),Array.isArray(T)&&T.length>0&&(T=[T[0]],u.serversFromGateway=T),x.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(A))}const{iceParameters:f,dtlsParameters:m,rtpCapabilities:_}=await Bo(this,Ro.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:u});try{n(this.getJoinMessage({ortc:{iceParameters:f,dtlsParameters:m,rtpCapabilities:_,version:"2"}}))}catch(y){r(y)}}),this.signal.on(cn.REQUEST_REJOIN_INFO,n=>{n(this.getRejoinMessage())}),this.signal.on(cn.REPORT_JOIN_GATEWAY,(n,r)=>{if(!this.joinInfo)return;let i,c="";var u;n instanceof Ue?(i=((u=n.data)===null||u===void 0?void 0:u.desc)||n.code,c=n.message):i=n,Bt.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:i,errorMsg:c,addr:r,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(cn.IS_P2P_DISCONNECTED,n=>{n(iv(this,Ro.IS_P2P_DISCONNECTED))}),this.signal.on(cn.DISCONNECT_P2P,()=>{this.emit(Ro.DISCONNECT_P2P)}),this.signal.on(cn.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(cn.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(cn.JOIN_RESPONSE,n=>{const r=this.getCurrentGatewayAddress();this.emit(Ro.JOIN_RESPONSE,n,r)}),this.signal.on(cn.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const n=this.getCurrentGatewayAddress(),r=de("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(n&&r){const i=EB(n);this.emit(Ro.PRE_CONNECT_PC,{candidates:i,fingerprint:r})}}}),this.signal.on(cn.RECOVER_NOTIFICATION,n=>{this.joinInfo&&typeof de("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(de("AP_REQUEST_DETAIL"),";").concat(n))})}async tryUnsubBeforeResub(n,r){try{await this.signal.request(nn.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:n,ortc:[r]},!0)}catch(i){throw x.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),i),i}}async tryUnsubDataChannelBeforeResub(n,r){try{await this.signal.request(nn.UNSUBSCRIBE,{stream_id:r.id},!0)}catch(i){throw x.warning("unsubscribe datachannel warning",i),i}}async tryUnpubBeforeRepub(n,r){try{await this.signal.request(nn.UNPUBLISH,{stream_id:n,ortc:r},!0)}catch(i){throw x.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),i),i}}async tryUnpubDataChannelBeforeRepub(n,r){try{await this.signal.request(nn.UNPUBLISH_DATASTREAM,{channnel_id:r.channelId},!0)}catch(i){throw x.warning("unpublish datastream warning: ",i),i}}async tryMassUnsubBeforeResub(n){const r={users:n.map(i=>({stream_id:i.stream_id,stream_type:i.stream_type}))};try{await this.signal.request(nn.UNSUBSCRIBE_STREAMS,r,!0)}catch(i){throw x.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),i),i}}async muteLocal(n,r){const i={action:n.find(c=>c.stream_type===Jn.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:n,stream_id:r};try{await this.signal.request(nn.CONTROL,i,!0,!0)}catch(c){throw x.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),c),c}}async unmuteLocal(n,r){const i={action:n.find(c=>c.stream_type===Jn.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:n,stream_id:r};try{await this.signal.request(nn.CONTROL,i,!0,!0)}catch(c){throw x.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),c),c}}async muteRemote(n,r){const i={action:n===kt.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(nn.CONTROL,i,!0,!0)}catch(c){throw x.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),c),c}}async unmuteRemote(n,r){const i={action:n===kt.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:r};try{await this.signal.request(nn.CONTROL,i,!0,!0)}catch(c){throw x.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),c),c}}uploadWRTCStats(n){this.signal.uploadWRTCStats(n)}upload(n,r){this.signal.upload(n,r)}getSignalRTT(){return this.signal.rtt}async restartICE(n){const r={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:n};try{return await this.signal.request(nn.RESTART_ICE,r,!0)}catch(i){throw x.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),i),i}}reconnect(n,r){this.state==="CONNECTED"&&this.signal.reconnect(n||void 0,r||Fo.P2P_FAILED)}getCurrentGatewayAddress(){var n,r;if(!de("GATEWAY_WSS_ADDRESS"))return de("USE_CANDIDATE_FROM_AP_DETAIL")&&(n=this.joinInfo)!==null&&n!==void 0&&n.apGatewayAddress?(x.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(r=this.joinInfo)!==null&&r!==void 0&&r.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(n){await this.signal.request(nn.SET_PARAMETER,{enablePublishAudioFilter:n})}}let Py=0,WR=0;function ac(e,n,r,i){return new bt((c,u)=>{n.timeout=n.timeout||de("HTTP_CONNECT_TIMEOUT"),n.responseType=n.responseType||"json",n.data&&!r?(n.data=JSON.stringify(n.data),Py+=Vc(n.data)):r&&(n.data.size?Py+=n.data.size:n.data instanceof FormData?Py+=fU(n.data):Py+=Vc(JSON.stringify(n.data))),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json",n.method="POST",n.url=e,Is.request(n).then(f=>{typeof f.data=="string"?WR+=Vc(f.data):f.data instanceof ArrayBuffer||f.data instanceof Uint8Array?WR+=f.data.byteLength:WR+=Vc(JSON.stringify(f.data)),i&&c({data:f.data,headers:f.headers}),c(f.data)}).catch(f=>{Is.isCancel(f)?u(new Ue(oe.OPERATION_ABORTED,"cancel token canceled")):f.code==="ECONNABORTED"?u(new Ue(oe.NETWORK_TIMEOUT,f.message)):f.response?u(new Ue(oe.NETWORK_RESPONSE_ERROR,f.response.status)):u(new Ue(oe.NETWORK_ERROR,f.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var e;function n(Ze){var ft=0;return function(){return ft<Ze.length?{done:!1,value:Ze[ft++]}:{done:!0}}}var r=typeof Object.defineProperties=="function"?Object.defineProperty:function(Ze,ft,xt){return Ze==Array.prototype||Ze==Object.prototype||(Ze[ft]=xt.value),Ze},i,c=function(Ze){Ze=[typeof globalThis=="object"&&globalThis,Ze,typeof window=="object"&&window,typeof self=="object"&&self,typeof a=="object"&&a];for(var ft=0;ft<Ze.length;++ft){var xt=Ze[ft];if(xt&&xt.Math==Math)return xt}throw Error("Cannot find global object")}(this);function u(Ze,ft){if(ft)e:{var xt=c;Ze=Ze.split(".");for(var rt=0;rt<Ze.length-1;rt++){var B=Ze[rt];if(!(B in xt))break e;xt=xt[B]}(ft=ft(rt=xt[Ze=Ze[Ze.length-1]]))!=rt&&ft!=null&&r(xt,Ze,{configurable:!0,writable:!0,value:ft})}}function f(Ze){return(Ze={next:Ze})[Symbol.iterator]=function(){return this},Ze}function m(Ze){var ft=typeof Symbol<"u"&&Symbol.iterator&&Ze[Symbol.iterator];return ft?ft.call(Ze):{next:n(Ze)}}if(u("Symbol",function(Ze){function ft(B,he){this.A=B,r(this,"description",{configurable:!0,writable:!0,value:he})}if(Ze)return Ze;ft.prototype.toString=function(){return this.A};var xt="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",rt=0;return function B(he){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new ft(xt+(he||"")+"_"+rt++,he)}}),u("Symbol.iterator",function(Ze){if(Ze)return Ze;Ze=Symbol("Symbol.iterator");for(var ft="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),xt=0;xt<ft.length;xt++){var rt=c[ft[xt]];typeof rt=="function"&&typeof rt.prototype[Ze]!="function"&&r(rt.prototype,Ze,{configurable:!0,writable:!0,value:function(){return f(n(this))}})}return Ze}),typeof Object.setPrototypeOf=="function")i=Object.setPrototypeOf;else{var _;e:{var y={};try{y.__proto__={a:!0},_=y.a;break e}catch{}_=!1}i=_?function(Ze,ft){if(Ze.__proto__=ft,Ze.__proto__!==ft)throw new TypeError(Ze+" is not extensible");return Ze}:null}var T=i;function A(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function k(Ze){if(Ze.m)throw new TypeError("Generator is already running");Ze.m=!0}function P(Ze,ft){return Ze.h=3,{value:ft}}function q(Ze){this.g=new A,this.G=Ze}function j(Ze,ft,xt,rt){try{var B=ft.call(Ze.g.j,xt);if(!(B instanceof Object))throw new TypeError("Iterator result "+B+" is not an object");if(!B.done)return Ze.g.m=!1,B;var he=B.value}catch(ye){return Ze.g.j=null,Ze.g.s(ye),H(Ze)}return Ze.g.j=null,rt.call(Ze.g,he),H(Ze)}function H(Ze){for(;Ze.g.h;)try{var ft=Ze.G(Ze.g);if(ft)return Ze.g.m=!1,{value:ft.value,done:!1}}catch(xt){Ze.g.v=void 0,Ze.g.s(xt)}if(Ze.g.m=!1,Ze.g.l){if(ft=Ze.g.l,Ze.g.l=null,ft.F)throw ft.D;return{value:ft.return,done:!0}}return{value:void 0,done:!0}}function ne(Ze){this.next=function(ft){return Ze.o(ft)},this.throw=function(ft){return Ze.s(ft)},this.return=function(ft){return function(xt,rt){k(xt.g);var B=xt.g.j;return B?j(xt,"return"in B?B.return:function(he){return{value:he,done:!0}},rt,xt.g.return):(xt.g.return(rt),H(xt))}(Ze,ft)},this[Symbol.iterator]=function(){return this}}function re(Ze,ft){return ft=new ne(new q(ft)),T&&Ze.prototype&&T(ft,Ze.prototype),ft}if(A.prototype.o=function(Ze){this.v=Ze},A.prototype.s=function(Ze){this.l={D:Ze,F:!0},this.h=this.C||this.u},A.prototype.return=function(Ze){this.l={return:Ze},this.h=this.u},q.prototype.o=function(Ze){return k(this.g),this.g.j?j(this,this.g.j.next,Ze,this.g.o):(this.g.o(Ze),H(this))},q.prototype.s=function(Ze){return k(this.g),this.g.j?j(this,this.g.j.throw,Ze,this.g.o):(this.g.s(Ze),H(this))},u("Array.prototype.entries",function(Ze){return Ze||function(){return function(ft,xt){ft instanceof String&&(ft+="");var rt=0,B=!1,he={next:function(){if(!B&&rt<ft.length){var ye=rt++;return{value:xt(ye,ft[ye]),done:!1}}return B=!0,{done:!0,value:void 0}}};return he[Symbol.iterator]=function(){return he},he}(this,function(ft,xt){return[ft,xt]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var ve=function(Ze,ft){for(var xt=0;xt<Ze.length;xt++)ft(Ze[xt])},Oe=function(Ze){return Ze.replace(/\r?\n|\r/g,`\r
`)},ke=function(Ze,ft,xt){return ft instanceof Blob?(xt=xt!==void 0?xt+"":typeof ft.name=="string"?ft.name:"blob",ft.name===xt&&Object.prototype.toString.call(ft)!=="[object Blob]"||(ft=new File([ft],xt)),[String(Ze),ft]):[String(Ze),String(ft)]},we=function(Ze,ft){if(Ze.length<ft)throw new TypeError(ft+" argument required, but only "+Ze.length+" present.")},Be=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,lt=Be.FormData,St=Be.XMLHttpRequest&&Be.XMLHttpRequest.prototype.send,At=Be.Request&&Be.fetch,Nn=Be.navigator&&Be.navigator.sendBeacon,kn=Be.Element&&Be.Element.prototype,fr=Be.Symbol&&Symbol.toStringTag;fr&&(Blob.prototype[fr]||(Blob.prototype[fr]="Blob"),"File"in Be&&!File.prototype[fr]&&(File.prototype[fr]="File"));try{new File([],"")}catch{Be.File=function(ft,xt,rt){return ft=new Blob(ft,rt||{}),Object.defineProperties(ft,{name:{value:xt},lastModified:{value:+(rt&&rt.lastModified!==void 0?new Date(rt.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),fr&&Object.defineProperty(ft,fr,{value:"File"}),ft}}var Xr=function(Ze){return Ze.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},Wr=function(Ze){this.i=[];var ft=this;Ze&&ve(Ze.elements,function(xt){if(xt.name&&!xt.disabled&&xt.type!=="submit"&&xt.type!=="button"&&!xt.matches("form fieldset[disabled] *"))if(xt.type==="file"){var rt=xt.files&&xt.files.length?xt.files:[new File([],"",{type:"application/octet-stream"})];ve(rt,function(B){ft.append(xt.name,B)})}else xt.type==="select-multiple"||xt.type==="select-one"?ve(xt.options,function(B){!B.disabled&&B.selected&&ft.append(xt.name,B.value)}):xt.type==="checkbox"||xt.type==="radio"?xt.checked&&ft.append(xt.name,xt.value):(rt=xt.type==="textarea"?Oe(xt.value):xt.value,ft.append(xt.name,rt))})};if((e=Wr.prototype).append=function(Ze,ft,xt){we(arguments,2),this.i.push(ke(Ze,ft,xt))},e.delete=function(Ze){we(arguments,1);var ft=[];Ze=String(Ze),ve(this.i,function(xt){xt[0]!==Ze&&ft.push(xt)}),this.i=ft},e.entries=function Ze(){var ft,xt=this;return re(Ze,function(rt){if(rt.h==1&&(ft=0),rt.h!=3)return ft<xt.i.length?rt=P(rt,xt.i[ft]):(rt.h=0,rt=void 0),rt;ft++,rt.h=2})},e.forEach=function(Ze,ft){we(arguments,1);for(var xt=m(this),rt=xt.next();!rt.done;rt=xt.next()){var B=m(rt.value);rt=B.next().value,B=B.next().value,Ze.call(ft,B,rt,this)}},e.get=function(Ze){we(arguments,1);var ft=this.i;Ze=String(Ze);for(var xt=0;xt<ft.length;xt++)if(ft[xt][0]===Ze)return ft[xt][1];return null},e.getAll=function(Ze){we(arguments,1);var ft=[];return Ze=String(Ze),ve(this.i,function(xt){xt[0]===Ze&&ft.push(xt[1])}),ft},e.has=function(Ze){we(arguments,1),Ze=String(Ze);for(var ft=0;ft<this.i.length;ft++)if(this.i[ft][0]===Ze)return!0;return!1},e.keys=function Ze(){var ft,xt,rt,B,he=this;return re(Ze,function(ye){if(ye.h==1&&(ft=m(he),xt=ft.next()),ye.h!=3)return xt.done?void(ye.h=0):(rt=xt.value,B=m(rt),P(ye,B.next().value));xt=ft.next(),ye.h=2})},e.set=function(Ze,ft,xt){we(arguments,2),Ze=String(Ze);var rt=[],B=ke(Ze,ft,xt),he=!0;ve(this.i,function(ye){ye[0]===Ze?he&&(he=!rt.push(B)):rt.push(ye)}),he&&rt.push(B),this.i=rt},e.values=function Ze(){var ft,xt,rt,B,he=this;return re(Ze,function(ye){if(ye.h==1&&(ft=m(he),xt=ft.next()),ye.h!=3)return xt.done?void(ye.h=0):(rt=xt.value,(B=m(rt)).next(),P(ye,B.next().value));xt=ft.next(),ye.h=2})},Wr.prototype._asNative=function(){for(var Ze=new lt,ft=m(this),xt=ft.next();!xt.done;xt=ft.next()){var rt=m(xt.value);xt=rt.next().value,rt=rt.next().value,Ze.append(xt,rt)}return Ze},Wr.prototype._blob=function(){var Ze="----formdata-polyfill-"+Math.random(),ft=[],xt="--"+Ze+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(rt,B){return typeof rt=="string"?ft.push(xt+Xr(Oe(B))+`"\r
\r
`+Oe(rt)+`\r
`):ft.push(xt+Xr(Oe(B))+'"; filename="'+Xr(rt.name)+`"\r
Content-Type: `+(rt.type||"application/octet-stream")+`\r
\r
`,rt,`\r
`)}),ft.push("--"+Ze+"--"),new Blob(ft,{type:"multipart/form-data; boundary="+Ze})},Wr.prototype[Symbol.iterator]=function(){return this.entries()},Wr.prototype.toString=function(){return"[object FormData]"},kn&&!kn.matches&&(kn.matches=kn.matchesSelector||kn.mozMatchesSelector||kn.msMatchesSelector||kn.oMatchesSelector||kn.webkitMatchesSelector||function(Ze){for(var ft=(Ze=(this.document||this.ownerDocument).querySelectorAll(Ze)).length;0<=--ft&&Ze.item(ft)!==this;);return-1<ft}),fr&&(Wr.prototype[fr]="FormData"),St){var Ds=Be.XMLHttpRequest.prototype.setRequestHeader;Be.XMLHttpRequest.prototype.setRequestHeader=function(Ze,ft){Ds.call(this,Ze,ft),Ze.toLowerCase()==="content-type"&&(this.B=!0)},Be.XMLHttpRequest.prototype.send=function(Ze){Ze instanceof Wr?(Ze=Ze._blob(),this.B||this.setRequestHeader("Content-Type",Ze.type),St.call(this,Ze)):St.call(this,Ze)}}At&&(Be.fetch=function(Ze,ft){return ft&&ft.body&&ft.body instanceof Wr&&(ft.body=ft.body._blob()),At.call(this,Ze,ft)}),Nn&&(Be.navigator.sendBeacon=function(Ze,ft){return ft instanceof Wr&&(ft=ft._asNative()),Nn.call(this,Ze,ft)}),Be.FormData=Wr}})();const bv=()=>{const e=de("AREAS");return e.length===0&&e.push($n.GLOBAL),qa(e).call(e,(n,r,i)=>{const c=PB(r);return c?i===0?c:"".concat(n,",").concat(c):n},"")},PB=e=>e===$n.OVERSEA?"".concat(Go.ASIA,",").concat(Go.EUROPE,",").concat(Go.AFRICA,",").concat(Go.NORTH_AMERICA,",").concat(Go.SOUTH_AMERICA,",").concat(Go.OCEANIA):Go[e],wce=e=>{const n={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map(r=>{const i=Cy[r],c=Object.keys(i);c&&c.map(u=>{u!=="CODE"&&(n[u]=n[u].concat(i[u]))})}),n},Dy={GLOBAL:{ASIA:[$n.CHINA,$n.JAPAN,$n.INDIA,$n.KOREA,$n.HKMC],EUROPE:[],NORTH_AMERICA:[$n.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},Ly=Object.keys(Dy[$n.GLOBAL]),KR=[$n.CHINA,$n.NORTH_AMERICA,$n.EUROPE,$n.ASIA,$n.JAPAN,$n.INDIA,$n.OCEANIA,$n.SOUTH_AMERICA,$n.AFRICA,$n.KOREA,$n.HKMC,$n.US],Rce=function(e,n){let r=[];if(gt(e).call(e,$n.GLOBAL)){const u=[$n.GLOBAL,$n.OVERSEA],f=Object.keys(Cy);if(n===$n.GLOBAL)throw new Ue(oe.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(n===$n.CHINA)r=[$n.OVERSEA];else if(c=n,gt(Ly).call(Ly,c)){const m=(i=n,Dy[$n.GLOBAL][i]||[]),_=[...u,n,...m];r=f.filter(y=>!gt(_).call(_,y))}else if(function(m){let _=!1;return Ly.forEach(y=>{var T;gt(T=Dy[$n.GLOBAL][y]).call(T,m)&&(_=!0)}),_}(n)){const m=function(y){let T;return Ly.forEach(A=>{var k;gt(k=Dy[$n.GLOBAL][A]).call(k,y)&&(T=A)}),T}(n),_=[...u,m,n];r=f.filter(y=>!gt(_).call(_,y))}else r=e;r=function(m){const _=[];return KR.forEach(y=>{gt(m).call(m,y)&&_.push(y)}),_.concat(m.filter(y=>!gt(KR).call(KR,y)))}(r)}else r=e;var i,c;return r};function DB(e){var n,r;if(!e&&gt(n=de("AREAS")).call(n,$n.EXTENSIONS))return x.debug("update area from ap : reset"),void GR(Mae,!0);if(!gt(r=de("AREAS")).call(r,$n.GLOBAL)||!e)return;let i=Cy.EXTENSIONS;i&&(i={CODE:PB($n.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},x.debug("update area from ap success: ".concat(e,",config is "),i),tr("AREAS",[$n.EXTENSIONS],!0),Object.keys(i).map(c=>{c==="LOG_UPLOAD_SERVER"||c==="EVENT_REPORT_DOMAIN"||c==="EVENT_REPORT_BACKUP_DOMAIN"||c==="PROXY_SERVER_TYPE3"?tr(c,i[c][0]):tr(c,i[c])}))}function GR(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=Bt.reportApiInvoke(null,{name:oo.SET_AREA,options:e,tag:Fr.TRACER});try{let i=[];if(typeof e=="string"&&(i=[e]),Array.isArray(e)&&(e.forEach(u=>{if(!gt(QF).call(QF,u))throw new Ue(oe.INVALID_PARAMS,"invalid area code")}),i=e),Object.prototype.toString.call(e)==="[object Object]"){const{areaCode:u,excludedArea:f}=e;if(!u)throw new Ue(oe.INVALID_PARAMS,"area code is needed");let m=u;typeof u=="string"&&(m=[u]),i=f?Rce(m,f):m}if(!n){if(rc.AREAS){const u=new Ue(oe.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return r.onError(u),void x.warning("setArea is prohibited because of config-distribute")}if(gt(i).call(i,$n.GLOBAL)&&de("AREAS")===$n.EXTENSIONS){const u=new Ue(oe.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return r.onError(u),void x.warning("setArea is prohibited because of ap extensions")}}tr("AREAS",i,n);const c=wce(i);Object.keys(c).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?tr(u,c[u][0]):tr(u,c[u])}),x.debug("set area success:",i.join(","))}catch(i){throw r.onError(i),i}r.onSuccess()}function LB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Wc(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?LB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}let zR=1;function Ice(e,n,r,i,c){zR+=1;const u={sid:r.sid,command:"convergeAllocateEdge",uid:"666",appId:r.appId,ts:Math.floor(Date.now()/1e3),seq:zR,requestId:zR,version:Yi,cname:r.cname},f={service_name:n,json_body:JSON.stringify(u)};let m,_,y=e[0];return nc(async()=>{m=Date.now();const T=await ac(y,{data:f,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_=Date.now()-m,T.code!==0){const P=new Ue(oe.UNEXPECTED_RESPONSE,"live streaming ap error, code"+T.code,{retry:!0,responseTime:_});throw x.error(P.toString()),P}const A=JSON.parse(T.json_body);if(A.code!==200){const P=new Ue(oe.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(A.code,", reason: ").concat(A.reason),{code:A.code,responseTime:_});throw x.error(P.toString()),P}if(!A.servers||A.servers.length===0){const P=new Ue(oe.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:A.code,responseTime:_});throw x.error(P.toString()),P}const k=function(P,q){return{addressList:P.servers.map(j=>"wss://".concat(j.address.replace(/\./g,"-"),".").concat(de("WORKER_DOMAIN"),":").concat(j.wss,"?serviceName=").concat(encodeURIComponent(q))),workerToken:P.workerToken,vid:P.vid}}(A,n);return de("LIVE_STREAMING_ADDRESS")&&(k.addressList=de("LIVE_STREAMING_ADDRESS")instanceof Array?de("LIVE_STREAMING_ADDRESS"):[de("LIVE_STREAMING_ADDRESS")]),Wc(Wc({},k),{},{responseTime:_})},(T,A)=>(Bt.apworkerEvent(r.sid,{success:!0,sc:200,serviceName:n,responseDetail:JSON.stringify(T.addressList),firstSuccess:A===0,responseTime:_,serverIp:e[A%e.length]}),!1),(T,A)=>(Bt.apworkerEvent(r.sid,{success:!1,sc:T.data&&T.data.code||200,serviceName:n,responseTime:_,serverIp:e[A%e.length]}),!!(T.code!==oe.OPERATION_ABORTED&&T.code!==oe.UNEXPECTED_RESPONSE||T.data&&T.data.retry)&&(y=e[(A+1)%e.length],!0)),c)}let YR=1;function MB(e,n,r,i){let{url:c,areaCode:u}=e;const{clientId:f,sid:m}=n,_=Date.now();let y;const T=n.role,[A,k]=XR(n,u,[eo.CHOOSE_SERVER]);let P=Qr.networkState;return nc(async()=>{P&&Qr.networkState===si.OFFLINE&&Qr.onlineWaiter&&await bt.race([Qr.onlineWaiter,Do(i&&i.maxRetryTimeout||so.maxRetryTimeout)]),P=Qr.networkState;const{data:q,headers:j}=await ac(c,{data:A,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);y=j.http3==="1"?1:-1,Bt.reportResourceTiming(c,m),UB(q,c,n,_,[eo.CHOOSE_SERVER],y);const H=gv(q,eo.CHOOSE_SERVER);return qR(H),VR(H,c)},q=>(q&&Bt.joinChooseServer(m,{role:T,lts:_,succ:!0,csAddr:c,opid:k,serverList:q.gatewayAddrs.map(j=>j.address),ec:null,cid:q.cid.toString(),uid:q.uid.toString(),csIp:q.csIp,unilbsServerIds:[eo.CHOOSE_SERVER].toString(),isHttp3:y,corssRegionTagReq:n.apRequestDetail,corssRegionTagRes:q.res.detail&&q.res.detail[38]}),!1),q=>q.code!==oe.OPERATION_ABORTED&&(q.code===oe.CAN_NOT_GET_GATEWAY_SERVER?q.data.retry:(Bt.joinChooseServer(m,{role:T,lts:_,succ:!1,csAddr:c,serverList:null,opid:k,ec:q.code,csIp:q.data&&q.data.csIp,unilbsServerIds:[eo.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:P}),isHttp3:y,corssRegionTagReq:n.apRequestDetail}),x.warning("[".concat(f||"sid-".concat(m.slice(0,6)),"] Choose server network error, retry"),q),!0)),i)}function xB(e,n,r,i){let c,{url:u,areaCode:f,serviceIds:m}=e;const _=Date.now(),y=n.role,[T,A]=XR(n,f,m);let k;return nc(async()=>{k&&Qr.networkState===si.OFFLINE&&Qr.onlineWaiter&&await bt.race([Qr.onlineWaiter,Do(i&&i.maxRetryTimeout||so.maxRetryTimeout)]),k=Qr.networkState;const{data:P,headers:q}=await ac(u,{data:T,cancelToken:r,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);c=q.http3==="1"?1:-1,Bt.reportResourceTiming(u,n.sid),UB(P,u,n,_,m,c);const j=gv(P,eo.CHOOSE_SERVER),H=gv(P,n.cloudProxyServer==="proxy5"?eo.CLOUD_PROXY_5:n.cloudProxyServer==="proxy3"||n.cloudProxyServer==="proxy4"?eo.CLOUD_PROXY:eo.CLOUD_PROXY_FALLBACK);return qR(j),{gatewayInfo:VR(j,u),proxyInfo:H,url:u}},P=>(P.gatewayInfo&&Bt.joinChooseServer(n.sid,{role:y,lts:_,succ:!0,csAddr:u,serverList:P.gatewayInfo.gatewayAddrs.map(q=>q.address),ec:null,opid:A,cid:P.gatewayInfo.cid.toString(),uid:P.gatewayInfo.uid.toString(),csIp:P.gatewayInfo.csIp,unilbsServerIds:m.toString(),isHttp3:c,corssRegionTagReq:n.apRequestDetail,corssRegionTagRes:P.gatewayInfo.res.detail&&P.gatewayInfo.res.detail[38]}),P.proxyInfo&&Bt.joinWebProxyAP(n.sid,{lts:_,sucess:1,apServerAddr:u,turnServerAddrList:P.proxyInfo.addresses.map(q=>q.ip).join(","),errorCode:null,eventType:n.cloudProxyServer,unilbsServerIds:m.toString()}),!1),P=>P.code!==oe.OPERATION_ABORTED&&(P.code===oe.CAN_NOT_GET_GATEWAY_SERVER?P.data.retry:(Bt.joinWebProxyAP(n.sid,{lts:_,sucess:0,apServerAddr:u,turnServerAddrList:null,errorCode:P.code,eventType:n.cloudProxyServer,unilbsServerIds:m.toString(),extend:JSON.stringify({networkState:k})}),x.warning("[".concat(n.clientId,"] multi unilbs network error, retry"),P),!0)),i)}const UB=(e,n,r,i,c,u)=>{const{sid:f,clientId:m,cloudProxyServer:_}=r,y=[],T=A=>{A.flag===4096?Bt.joinChooseServer(f,{role:r.role,lts:i,succ:!1,csAddr:n,opid:e.opid,serverList:null,ec:A.error.message,csIp:A.error.data&&A.error.data.csIp,unilbsServerIds:c.toString(),isHttp3:u,corssRegionTagReq:r.apRequestDetail}):A.flag!==1048576&&A.flag!==4194304&&A.flag!==4194310||Bt.joinWebProxyAP(f,{lts:i,sucess:0,apServerAddr:n,turnServerAddrList:null,errorCode:A.error.code,eventType:_,unilbsServerIds:c.toString()})};if(e.response_body.forEach(A=>{const k=A.buffer.code;if(A.uri===23&&k===0&&!A.buffer.edges_services)if(A.buffer.flag===4194310)x.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),A.buffer.edges_services=[];else{const P={error:new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:A.buffer.flag};y.push(P),T(P)}if(k!==0){const P=Xf(k),q={error:new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,P.desc,{desc:P.desc,retry:P.retry,csIp:e.detail[502]}),flag:A.buffer.flag};A.buffer.flag===4194310?x.warning(q.error.toString()):y.push(q),T(q)}}),y.length)throw x.warning("[".concat(m||"sid-".concat(f.slice(0,6)),"] multi unilbs ").concat(n," failed, ").concat(y.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message,", retry: ").concat(A.error.data.retry)).join(" | "))),new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,y.map(A=>"flag: ".concat(A.flag,", message: ").concat(A.error.message)).join(" | "),{retry:!!y.find(A=>A.error.data.retry),csIp:e.detail[502],desc:[...new Set(y.map(A=>{var k;return A==null||(k=A.error)===null||k===void 0||(k=k.data)===null||k===void 0?void 0:k.desc}).filter(A=>!!A))]})},qR=e=>{var n,r,i,c;if(e.addresses&&e.addresses.length===0&&e.code===0)throw new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(de("AP_AREA")&&((i=e.detail)!==null&&i!==void 0&&i[23]&&typeof((c=e.detail)===null||c===void 0?void 0:c[23])=="string"?DB(e.detail[23].toLowerCase()):DB()),(n=e.detail)!==null&&n!==void 0&&n[19]&&typeof((r=e.detail)===null||r===void 0?void 0:r[19])=="string"){const f=e.detail[19],m=f==null?void 0:f.split(";");for(let _=0;_<m.length;_++){var u;const y=es(u=m[_]).call(u);e.addresses[_]&&m&&(e.addresses[_].fingerprint=y)}}if(de("GATEWAY_ADDRESS")&&de("GATEWAY_ADDRESS").length>0){x.debug("assign gateway address to",de("GATEWAY_ADDRESS"));const f=de("GATEWAY_ADDRESS").map(m=>{var _,y;const T=(_=(y=e.addresses.find(A=>A.ip===m.ip&&A.port===m.port))===null||y===void 0?void 0:y.fingerprint)!==null&&_!==void 0?_:"";return{ip:m.ip,port:m.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:T}});e.addresses=f}},Ace=(e,n)=>{if(e.response_body&&e.response_body.length){const r=e.response_body[0];if(r.buffer.code!==0){const i=Xf(r.buffer.code);throw new Ue(oe.UPDATE_TICKET_FAILED,"[".concat(r.buffer.code,"]: ").concat(i.desc),{retry:i.retry})}return r.buffer.ticket}throw x.debug("update ticket request received ap response without response body:",n),new Ue(oe.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},XR=(e,n,r)=>{const i=Math.floor(Math.random()*1e12),c=e.role==="host"?"1":e.role==="audience"?"2":void 0,u={appid:e.appId,client_ts:Date.now(),opid:i,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:Wc(Wc(Wc({6:e.stringUid,11:n,12:de("USE_NEW_TOKEN")?"1":void 0},c?{17:c}:{}),{},{22:n},e.apRequestDetail?{33:e.apRequestDetail}:{}),e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:r,uid:e.uid||0}}]};u.request_bodies.forEach(m=>{e.multiIP&&e.multiIP.gateway_ip&&(m.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))});const f=new FormData;return f.append("request",JSON.stringify(u)),[f,i]},Oce=(e,n)=>{const r=Math.floor(Math.random()*1e12),i={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:n,uid:e.uid||0,edges_services:e.apResponse.addresses.map(u=>({ip:u.ip,port:u.port}))}}]},c=new FormData;return c.append("request",JSON.stringify(i)),[c,r]};let ep=0;function tp(e){return bt.all(e.map(n=>n.then(r=>{throw r},r=>r))).then(n=>{throw n},n=>n)}const Sv=async e=>{let{fragementLength:n,referenceList:r,asyncMapHandler:i,allFailedhandler:c,promisesCollector:u}=e,f=0;const m=n;let _,y=0;const T=async()=>{const A=(()=>{const k=f*m,P=k+m;return r.slice(k,P).map(i)})();u&&u.push(...A);try{_=await tp(A)}catch(k){if(y+=m,f++,!(y>=r.length))return void await T();c(k)}A.forEach(k=>k.cancel())};return await T(),_},VB=async e=>{let{referenceList:n,asyncMapHandler:r,closeFn:i}=e;const c=n.length;let u=0;const f=async()=>{const m=r(n.shift());try{return await m}catch(_){if(u++,u>=c||i!=null&&i(_))throw _;return f()}};return f()};async function JR(e,n,r,i){return{gatewayInfo:await async function(u,f,m,_){let y=null;const T=[],A=async()=>{const P=de("WEBCS_DOMAIN").slice(0,de("AJAX_REQUEST_CONCURRENT")).map(H=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(H+"/api/v2/transpond/webrtc?v=2"):"https://".concat(H,"/api/v2/transpond/webrtc?v=2"),areaCode:bv()})),q=_.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(H=>H.url)}),j=await Sv({fragementLength:de("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:H=>(x.debug("[".concat(u.clientId,"] Connect to choose_server:"),H.url),MB(H,u,f,m)),allFailedhandler:H=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},q),H[0]},promisesCollector:T});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},q),j},k=async()=>{if(await Do(1e3),y!==null)return y;const P=de("WEBCS_DOMAIN_BACKUP_LIST").map(H=>({url:u.proxyServer?"https://".concat(u.proxyServer,"/ap/?url=").concat(H+"/api/v2/transpond/webrtc?v=2"):"https://".concat(H,"/api/v2/transpond/webrtc?v=2"),areaCode:bv()})),q=_.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(H=>H.url)}),j=await Sv({fragementLength:de("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:H=>(x.debug("[".concat(u.clientId,"] Connect to backup choose_server:"),H.url),MB(H,u,f,m)),allFailedhandler:H=>{throw _.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},q),H[0]},promisesCollector:T});return _.recordJoinChannelService({endTs:Date.now(),status:"success"},q),j};try{return y=await tp([A(),k()]),T.length&&T.forEach(P=>P.cancel&&typeof P.cancel=="function"&&P.cancel()),y}catch(P){throw P[0]}}(e,n,r,i)}}async function FB(e,n,r,i,c){const u=e.cloudProxyServer;if(u==="disabled"){if(e.useLocalAccessPoint)return await JR(e,n,r,c);if(de("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:k,proxyInfo:P}=await $B(e,n,r,c);if(e.turnServer&&e.turnServer.mode!=="auto")return{gatewayInfo:k};const q=P.map(j=>({turnServerURL:j.address,tcpport:j.tcpport||jo.tcpport,udpport:j.udpport||jo.udpport,username:j.username||jo.username,password:j.password||jo.password,forceturn:!1,security:!0}));if(c.useP2P){var f;const j=(f=e.uid)!==null&&f!==void 0?f:k.uid,H="glb:".concat(j.toString()),ne=await Ww(H),re=P.map(ve=>({turnServerURL:ve.address,tcpport:ve.tcpport||jo.tcpport,udpport:ve.udpport||jo.udpport,username:H,password:ne,forceturn:!1,security:!0}));q.push(...re)}return e.turnServer={mode:"manual",servers:q},{gatewayInfo:k}}return await JR(e,n,r,c)}const{proxyInfo:m,gatewayInfo:_}=await $B(e,n,r,c),y={gatewayInfo:_},T=m.map(k=>({turnServerURL:k.address,tcpport:u==="proxy3"?void 0:k.tcpport?k.tcpport:jo.tcpport,udpport:u==="proxy4"?void 0:k.udpport?k.udpport:jo.udpport,username:k.username||jo.username,password:k.password||jo.password,forceturn:u!=="proxy4",security:u==="proxy5"}));if(c.useP2P){var A;const k=(A=e.uid)!==null&&A!==void 0?A:_.uid,P="glb:".concat(k.toString()),q=await Ww(P),j=m.map(H=>({turnServerURL:H.address,tcpport:u==="proxy3"?void 0:H.tcpport||jo.tcpport,udpport:u==="proxy4"?void 0:H.udpport||jo.udpport,username:P,password:q,forceturn:u!=="proxy4",security:u==="proxy5"}));T.push(...j)}return e.turnServer={mode:"manual",servers:T},x.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(u)),y}async function BB(e,n,r,i,c){const u=de("ACCOUNT_REGISTER").slice(0,de("AJAX_REQUEST_CONCURRENT"));let f=[];f=n.proxyServer?u.map(_=>"https://".concat(n.proxyServer,"/ap/?url=").concat(_+"/api/v1")):u.map(_=>"https://".concat(_,"/api/v1"));const m=c==null?void 0:c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:f});try{const _=await async function(y,T,A,k,P){const q=Date.now(),j={sid:A.sid,opid:10,appid:A.appId,string_uid:T};let H=y[0];const ne=await nc(()=>ac(H+"".concat(H.indexOf("?")===-1?"?":"&","action=stringuid"),{data:j,cancelToken:k,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(re,ve)=>{if(re.code===0){if(re.uid<=0||re.uid>=Math.pow(2,32))throw x.error("Invalid Uint Uid ".concat(T," => ").concat(re.uid),re),Bt.reqUserAccount(j.sid,{lts:q,success:!1,serverAddr:H,stringUid:j.string_uid,uid:re.uid,errorCode:oe.INVALID_UINT_UID_FROM_STRING_UID,extend:j}),new Ue(oe.INVALID_UINT_UID_FROM_STRING_UID);return Bt.reqUserAccount(j.sid,{lts:q,success:!0,serverAddr:H,stringUid:j.string_uid,uid:re.uid,errorCode:null,extend:j}),!1}const Oe=Xf(re.code);return Oe.retry&&(H=y[(ve+1)%y.length]),Bt.reqUserAccount(j.sid,{lts:q,success:!1,serverAddr:H,stringUid:j.string_uid,uid:re.uid,errorCode:Oe.desc,extend:j}),Oe.retry},(re,ve)=>re.code!==oe.OPERATION_ABORTED&&(Bt.reqUserAccount(j.sid,{lts:q,success:!1,serverAddr:H,stringUid:j.string_uid,uid:null,errorCode:re.code,extend:j}),H=y[(ve+1)%y.length],!0),P);if(ne.code!==0){const re=Xf(ne.code);throw new Ue(oe.UNEXPECTED_RESPONSE,re.desc)}return ne}(f,e,n,r,i);return c==null||c.recordJoinChannelService({status:"success",endTs:Date.now()},m),_.uid}catch(_){throw c==null||c.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_]},m),_}}async function Nce(e,n,r){const i=de("ACCOUNT_REGISTER");let c=[];c=n.proxyServer?i.map(u=>"https://".concat(n.proxyServer,"/ap/?url=").concat(u+"/api/v1")):i.map(u=>"https://".concat(u,"/api/v1"));try{return await VB({referenceList:c,asyncMapHandler:f=>async function(m,_,y,T){const A=Date.now(),k={sid:y.sid,opid:10,appid:y.appId,string_uid:_};try{const P=await ac(m+"".concat(m.indexOf("?")===-1?"?":"&","action=stringuid"),{data:k,cancelToken:T,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(P.code!==0){const q=Xf(P.code);throw new Ue(oe.UNEXPECTED_RESPONSE,"preload sua error:".concat(q.desc),q)}if(P.uid<=0||P.uid>=Math.pow(2,32))throw new Ue(oe.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:A,url:m,req:k,uid:P.uid,elapse:Date.now()-A}}catch(P){throw P}}(f,e,n,r),closeFn:f=>f.code===oe.OPERATION_ABORTED||f.code===oe.UNEXPECTED_RESPONSE&&!f.data.retry})}catch(u){throw u}}async function kce(e,n,r){const i=de("CDS_AP").slice(0,de("AJAX_REQUEST_CONCURRENT")).map(_=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(_+"/api/v1"):"https://".concat(_,"/api/v1?action=config")),c=i.map(_=>function(y,T,A,k){const P=Mn(),q={flag:64,cipher_method:0,features:Wc(Wc(Wc(Wc(Wc({install_id:tR(),device:P.name,system:P.os,system_general:navigator.userAgent,vendor:T.appId,version:Yi,cname:T.cname,session_id:T.sid,proxyServer:T.proxyServer,sdk_type:Sce.WEB_RTC,browser_name:P.name,browser_version:P.version,user_agent:navigator.userAgent,channel_name:T.cname},T.stringUid&&{string_uid:T.stringUid}),T.uid&&{uid:T.uid+""}),P.os&&{os_name:P.os}),P.osVersion&&{os_version:P.osVersion}),{},{detail:""})};return nc(()=>ac(y,{data:q,timeout:1e3,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,j=>j.code!==oe.OPERATION_ABORTED,k)}(_,e,n,r));let u=null,f=null,m={};try{u=await tp(c)}catch(_){if(_.code===oe.OPERATION_ABORTED)throw _;f=_}if(c.forEach(_=>_.cancel()),Bt.reportApiInvoke(e.sid,{name:oo.REQUEST_CONFIG_DISTRIBUTE,options:{error:f,res:u}}).onSuccess(),u&&u.test_tags)try{m=function(_){if(!_.test_tags)return{};const y=_.test_tags,T=Object.keys(y),A={};return T.forEach(k=>{var P;const q=es(P=k.slice(4)).call(P),j=JSON.parse(y[k]),H=j[1];A[q]={tag:j[0]||"",value:H}}),A}(u)}catch{}return m}async function jB(e,n){const r=de("WEBCS_DOMAIN").concat(de("WEBCS_DOMAIN_BACKUP_LIST")).map(i=>({url:"https://".concat(i,"/api/v2/transpond/webrtc?v=2"),areaCode:bv(),serviceIds:[eo.CHOOSE_SERVER,eo.CLOUD_PROXY_FALLBACK]}));try{return await VB({referenceList:r,asyncMapHandler:c=>async function(u,f,m){let _,{url:y,areaCode:T,serviceIds:A}=u;const k=Date.now(),[P,q]=XR(f,T,A);let j=Qr.networkState;try{j&&Qr.networkState===si.OFFLINE&&Qr.onlineWaiter&&await bt.race([Qr.onlineWaiter,Do(so.maxRetryTimeout)]),j=Qr.networkState;const{data:H,headers:ne}=await ac(y,{data:P,cancelToken:m,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_=ne.http3==="1"?1:-1,(ke=>{const we=[];if(ke.response_body.forEach(Be=>{const lt=Be.buffer.code;if(Be.uri===23&&lt===0&&!Be.buffer.edges_services)if(Be.buffer.flag===4194310)Be.buffer.edges_services=[];else{const St={error:new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:ke.detail[502]}),flag:Be.buffer.flag};we.push(St)}if(lt!==0){const St=Xf(lt),At={error:new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,St.desc,{desc:St.desc,retry:St.retry,csIp:ke.detail[502]}),flag:Be.buffer.flag};Be.buffer.flag===4194310?x.warning(At.error.toString()):we.push(At)}}),we.length)throw new Ue(oe.CAN_NOT_GET_GATEWAY_SERVER,we.map(Be=>"flag: ".concat(Be.flag,", message: ").concat(Be.error.message)).join(" | "),{retry:!!we.find(Be=>Be.error.data.retry),csIp:ke.detail[502],desc:[...new Set(we.map(Be=>{var lt;return Be==null||(lt=Be.error)===null||lt===void 0||(lt=lt.data)===null||lt===void 0?void 0:lt.desc}).filter(Be=>!!Be))]})})(H);const ve=gv(H,eo.CHOOSE_SERVER),Oe=gv(H,eo.CLOUD_PROXY_FALLBACK);return qR(ve),{gatewayInfo:VR(ve,y),proxyInfo:Oe,opid:q,requestTime:k,url:y,isHttp3:_,elapse:Date.now()-k}}catch(H){throw H}}(c,e,n),closeFn:c=>c.code===oe.OPERATION_ABORTED||c.code===oe.CAN_NOT_GET_GATEWAY_SERVER&&!c.data.retry})}catch(i){throw i}}async function $B(e,n,r,i){const c=de("PROXY_SERVER_TYPE3"),u=(P,q,j)=>{let H=j||c;return Array.isArray(H)&&(H=q%2==0?c[1]:c[0]),"https://".concat(H,"/ap/?url=").concat(P)};let f=null;const m=[],_=async()=>{const P=de("WEBCS_DOMAIN").slice(0,de("AJAX_REQUEST_CONCURRENT")).map((H,ne)=>{let re;return re=e.cloudProxyServer==="disabled"&&e.proxyServer?u("".concat(H,"/api/v2/transpond/webrtc?v=2"),ne,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(H,"/api/v2/transpond/webrtc?v=2"):u("".concat(H,"/api/v2/transpond/webrtc?v=2"),ne),{url:re,areaCode:bv(),serviceIds:[eo.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?eo.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?eo.CLOUD_PROXY:eo.CLOUD_PROXY_FALLBACK]}}),q=i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(H=>H.url)}),j=await Sv({fragementLength:de("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:H=>(x.debug("[".concat(e.clientId,"] Connect to choose_server:"),H.url),xB(H,e,n,r)),allFailedhandler:H=>{throw i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},q),H[0]},promisesCollector:m});return i.recordJoinChannelService({endTs:Date.now(),status:"success"},q),j},y=async()=>{if(await Do(1e3),f!==null)return f;const P=de("WEBCS_DOMAIN_BACKUP_LIST").map((H,ne)=>{let re;return re=e.cloudProxyServer==="disabled"&&e.proxyServer?u("".concat(H,"/api/v2/transpond/webrtc?v=2"),ne,e.proxyServer):e.cloudProxyServer==="disabled"||e.cloudProxyServer==="fallback"?"https://".concat(H,"/api/v2/transpond/webrtc?v=2"):u("".concat(H,"/api/v2/transpond/webrtc?v=2"),ne),{url:re,areaCode:bv(),serviceIds:[eo.CHOOSE_SERVER,e.cloudProxyServer==="proxy5"?eo.CLOUD_PROXY_5:e.cloudProxyServer==="proxy3"||e.cloudProxyServer==="proxy4"?eo.CLOUD_PROXY:eo.CLOUD_PROXY_FALLBACK]}}),q=i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:P.map(H=>H.url)}),j=await Sv({fragementLength:de("FRAGEMENT_LENGTH"),referenceList:P,asyncMapHandler:H=>(x.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),H.url),xB(H,e,n,r)),allFailedhandler:H=>{throw i.recordJoinChannelService({endTs:Date.now(),status:"error",errors:H},q),H[0]},promisesCollector:m});return i.recordJoinChannelService({endTs:Date.now(),status:"success"},q),j};let T,A,k;try{({gatewayInfo:T,proxyInfo:A,url:k}=await tp([_(),y()]))}catch(P){throw P[0]}if(m.length&&m.forEach(P=>P.cancel&&typeof P.cancel=="function"&&P.cancel()),!T||!A)throw new Ue(oe.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=k,e.cloudProxyServer!=="disabled"&&Array.isArray(c)&&k){const P=/^https?:\/\/(.+?)(\/.*)?$/.exec(k)[1];gt(c).call(c,P)&&(e.proxyServer=P,x.setProxyServer(P),Bt.setProxyServer(P))}return f={gatewayInfo:T,proxyInfo:await hB(A,T.uid)},f}async function Pce(e,n,r){const i=de("UAP_AP").slice(0,de("AJAX_REQUEST_CONCURRENT")).map(u=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(u+"/api/v1?action=uap"):"https://".concat(u,"/api/v1?action=uap")),c=i.map(u=>function(f,m,_,y){const T={command:"convergeAllocateEdge",sid:m.sid,appId:m.appId,token:m.token,ts:Date.now(),version:Yi,cname:m.cname,uid:m.uid.toString(),requestId:YR,seq:YR};YR+=1;const A={service_name:"tele_channel",json_body:JSON.stringify(T)};return nc(async()=>{const k=await ac(f,{data:A,cancelToken:_,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(k.code!==0){const q=new Ue(oe.UNEXPECTED_RESPONSE,"cross channel ap error, code"+k.code,{retry:!0});throw x.error(q.toString()),q}const P=JSON.parse(k.json_body);if(P.code!==200){const q=new Ue(oe.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(P.code,", reason: ").concat(P.reason));throw x.error(q.toString()),q}if(!P.servers||P.servers.length===0){const q=new Ue(oe.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw x.error(q.toString()),q}return{vid:P.vid,workerToken:P.workerToken,addressList:(de("CHANNEL_MEDIA_RELAY_SERVERS")||P.servers).map(q=>"wss://".concat(q.address.replace(/\./g,"-"),".").concat(de("WORKER_DOMAIN"),":").concat(q.wss))}},void 0,k=>!!(k.code!==oe.OPERATION_ABORTED&&k.code!==oe.UNEXPECTED_RESPONSE||k.data&&k.data.retry),y)}(u,e,n,r));try{const u=await tp(c);return c.forEach(f=>f.cancel()),u}catch(u){throw u[0]}}async function Dce(e,n,r){let i=null;const c=[],u=async f=>{const m=de(f?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_,"/api/v2/transpond/webrtc?v=2"));return f&&(await Do(1e3),i!==null)?i:await Sv({fragementLength:de("FRAGEMENT_LENGTH"),referenceList:m,asyncMapHandler:_=>(x.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(f?"backup":""," choose_server:"),_),function(y,T,A,k){const[P]=Oce(T,[eo.CHOOSE_SERVER]);let q=Qr.networkState;return nc(async()=>{q&&Qr.networkState===si.OFFLINE&&Qr.onlineWaiter&&await bt.race([Qr.onlineWaiter,Do(k&&k.maxRetryTimeout||so.maxRetryTimeout)]),q=Qr.networkState;const j=await ac(y,{data:P,cancelToken:A,headers:{"Content-Type":"multipart/form-data;"}},!0);return Ace(j,y)},()=>!1,j=>j.code!==oe.OPERATION_ABORTED&&(j.code===oe.UPDATE_TICKET_FAILED?j.data.retry:(x.warning("[".concat(T.clientId,"] update ticket network error, retry"),j),!0)),k)}(_,e,n,r)),allFailedhandler:_=>{throw _[0]},promisesCollector:c})};try{return i=await tp([u(!1),u(!0)]),c.length&&c.forEach(f=>f.cancel&&typeof f.cancel=="function"&&f.cancel()),i}catch(f){throw f[0]}}function HB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function ZR(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?HB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}class Lce extends Dr{get isSuccess(){return!!this.configs}constructor(n,r){super(),Q(this,"configs",void 0),Q(this,"store",void 0),Q(this,"joinInfo",void 0),Q(this,"cancelToken",void 0),Q(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),Q(this,"interval",void 0),Q(this,"mutex",void 0),Q(this,"mutableParamsRead",!1),Q(this,"configCache",{}),Q(this,"limit_bitrate",void 0),this.mutex=new Ko("config-distribute",n),this.store=r}startGetConfigDistribute(n,r){this.joinInfo=n,this.cancelToken=r,this.interval&&this.stopGetConfigDistribute(),de("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},de("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,Bt.reportApiInvoke(null,{options:void 0,name:oo.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Fr.TRACER}).onSuccess(JSON.stringify(rc))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void x.debug("[config-distribute] get config distribute interrupted have no joininfo");let n;const r=await this.mutex.lock();try{n=await kce(this.joinInfo,this.cancelToken,this.retryConfig),x.debug("[config-distribute] get config distribute",JSON.stringify(n));const i=function(c){var u;const f=Hm(u=Object.keys(c).filter(y=>/^webrtc_ng_global_parameter/.test(y))).call(u);for(let y=0;y<f.length;y++)for(let T=f.length-1;T>y;T--){const A=f[T],k=c[A].value;if(typeof k.__priority=="number"){const P=k.__priority,q=f[T-1],j=c[q].value;if(typeof j.__priority=="number"){if(!(P>j.__priority))continue;{const H=A;f[T]=f[T-1],f[T-1]=H}}else{const H=A;f[T]=f[T-1],f[T-1]=H}}}const m=Date.now();let _={};return f.forEach(y=>{const T=c[y].value.__expires;T&&T<=m||(_[y]=c[y])}),_}(n);this.cacheGlobalParameterConfig(i),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=i}catch(i){const c=new Ue(oe.NETWORK_RESPONSE_ERROR,i);x.warning("[config-distribute] ".concat(c.toString()))}finally{r()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(n){eB(n)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==n.id&&this.emit(pv.UPDATE_BITRATE_LIMIT,n):this.emit(pv.UPDATE_BITRATE_LIMIT,n))}getLowStreamConfigDistribute(){return this.limit_bitrate&&ZR({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(n){try{const r={},i=Object.keys(n),c=[];i.forEach(u=>{const f=n[u].value;r[u]=f;const m=f.__id;if(m&&this.configCache[u]&&this.configCache[u].__id===m)return;const _=f.__type,y=n[u].value,T=n[u].tag;let A=0;_?_===OU.REALTIME&&(A=1):Object.keys(y).some(k=>Object.prototype.hasOwnProperty.call(sR,k)||!AR()&&Object.prototype.hasOwnProperty.call(ny,k)?(A=1,!0):void 0),c.push({tag:T,isApplied:A,feature:u,params:JSON.stringify(f)})}),c.forEach(u=>{let{tag:f,feature:m,params:_,isApplied:y}=u;this.store.sessionId&&Bt.abTest(this.store.sessionId,{intSucc:1,isApplied:y,tag:f,feature:m,params:_,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=r}catch(r){x.debug("handleABTestConfigDistribute error",r)}}cacheGlobalParameterConfig(n){const r=function(c){const u={};return Object.keys(c).forEach(f=>{const m=c[f].value,_=m.__expires,y=m.__type;Object.keys(m).forEach(T=>{T==="__id"||T==="__type"||T==="__priority"||T==="__expires"||Object.prototype.hasOwnProperty.call(u,T)||(u[T]=ZR(ZR({value:m[T]},_&&{expires:_}),y&&{type:y}))})}),u}(n);try{var i;const c=(i=r.LIMIT_BITRATE)===null||i===void 0?void 0:i.value;delete r.LIMIT_BITRATE,c&&eB(c)&&this.handleBitrateLimit(c),this.limit_bitrate=c,this.handleGlobalParameterConfig(r),this.handleABTestConfigDistribute(n),function(m){try{const _=Date.now();Object.keys(m).forEach(y=>{const{value:T,type:A,expires:k}=m[y];k&&k<=_||((A===OU.REALTIME||Object.prototype.hasOwnProperty.call(sR,y))&&(rc[y]=T,br[y]=T,x.debug("Update realtime parameters from config distribute",y,T)),A||AR()||!Object.prototype.hasOwnProperty.call(ny,y)||(rc[y]=T,br[y]=T,x.debug("Update gateway parameters from config distribute",y,T)))})}catch(_){x.error("Error update config immediately: ".concat(m),_.message)}}(r);const u=JSON.stringify(r),f=window.btoa(u);window.localStorage.setItem("websdk_ng_global_parameter",f),x.debug("Caching global parameters ".concat(u))}catch(c){x.error("Error caching global parameters:",c.message)}}handleGlobalParameterConfig(n){try{const r=Date.now();Object.keys(n).forEach(i=>{if(i==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(br,i)){const{value:c,expires:u}=n[i];if(u&&u<=r)return;(function(f,m){try{return typeof f=="object"&&typeof m=="object"&&JSON.stringify(f)===JSON.stringify(m)}catch{return!1}})(br[i],c)||(rc[i]=c,br[i]=c,this.emit(pv.UPDATE_CLIENT_ROLE_OPTIONS,c),x.debug("Updating client role options: ".concat(JSON.stringify(c))))}})}catch(r){x.error("Error handling global parameter config:",r.message)}}}class Mce extends Dr{constructor(){super(...arguments),Q(this,"resultStorage",new Map)}setLocalAudioStats(n,r,i){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",n,this.checkAudioInputLevel(i,r)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",n,this.checkSendAudioBitrate(i,r))}setLocalVideoStats(n,r,i){this.record("SEND_VIDEO_BITRATE_TOO_LOW",n,this.checkSendVideoBitrate(i,r)),this.record("FRAMERATE_INPUT_TOO_LOW",n,this.checkFramerateInput(i,r)),this.record("FRAMERATE_SENT_TOO_LOW",n,this.checkFramerateSent(i))}setRemoteAudioStats(n,r){const i=n.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",i,this.checkAudioOutputLevel(r))}setRemoteVideoStats(n,r){const i=n.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",i,this.checkVideoDecode(r))}record(n,r,i){if(de("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(n)||this.resultStorage.set(n,{result:[],isPrevNormal:!0});const c=this.resultStorage.get(n);if(c&&(c.result.push(i),c.result.length>=5)){var u;const f=gt(u=c.result).call(u,!0);c.isPrevNormal&&!f&&this.emit("exception",WB[n],n,r),!c.isPrevNormal&&f&&this.emit("exception",WB[n]+2e3,n+"_RECOVER",r),c.isPrevNormal=f,c.result=[]}}checkAudioOutputLevel(n){return!(n.receiveBitrate>0&&n.receiveLevel===0)}checkAudioInputLevel(n,r){return r instanceof ho&&!r.isActive||!!r.muted||n.sendVolumeLevel!==0}checkFramerateInput(n,r){let i=null;r._encoderConfig&&r._encoderConfig.frameRate&&(i=ii(r._encoderConfig.frameRate));const c=n.captureFrameRate;return!i||!c||!(i>10&&c<5||i<10&&i>=5&&c<=1)}checkFramerateSent(n){return!(n.captureFrameRate&&n.sendFrameRate&&n.captureFrameRate>5&&n.sendFrameRate<=1)}checkSendVideoBitrate(n,r){return!!r.muted||n.sendBitrate!==0}checkSendAudioBitrate(n,r){return r instanceof ho&&!r.isActive||!!r.muted||n.sendBitrate!==0}checkVideoDecode(n){return n.receiveBitrate===0||n.decodeFrameRate!==0}}const WB={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Yo=new class{markSubscribeStart(e,n){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(n))}markPublishStart(e,n){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(n))}measureFromSubscribeStart(e,n){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(n));if(r.length>0){const i=r[r.length-1];return Math.round(performance.now()-i.startTime)}return 0}measureFromPublishStart(e,n){const r=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(n));if(r.length>0){const i=r[r.length-1];return Math.round(performance.now()-i.startTime)}return 0}};function KB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Yd(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?KB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}class Tv{constructor(n){Q(this,"store",void 0),Q(this,"onStatsException",void 0),Q(this,"onUploadPublishDuration",void 0),Q(this,"onStatsChanged",void 0),Q(this,"localStats",new Map),Q(this,"remoteStats",new Map),Q(this,"updateStatsInterval",void 0),Q(this,"trafficStats",void 0),Q(this,"trafficStatsPeerList",[]),Q(this,"uplinkStats",void 0),Q(this,"exceptionMonitor",void 0),Q(this,"p2pChannel",void 0),Q(this,"scalabilityMode",ty.L1T1),Q(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=n,this.exceptionMonitor=new Mce,this.exceptionMonitor.on("exception",(r,i,c)=>{this.onStatsException&&this.onStatsException(r,i,c)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(at.LocalAudioTrack)||Yd({},uR)}getLocalVideoTrackStats(){return this.localStats.get(at.LocalVideoTrack)||Yd({},dR)}getRemoteAudioTrackStats(n){const r=(u,f)=>{if(!this.trafficStats)return f;const m=this.trafficStats.peer_delay.find(_=>_.peer_uid===u);return m&&(f.publishDuration=m.B_ppad+(Date.now()-this.trafficStats.timestamp)),f},i={};if(n){var c;const u=(c=this.remoteStats.get(n))===null||c===void 0?void 0:c.audioStats;u&&(i[n]=r(n,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[f,{audioStats:m}]=u;m&&(i[f]=r(f,m))});return i}getRemoteNetworkQualityStats(n){const r={};if(n){var i;const c=(i=this.remoteStats.get(n))===null||i===void 0?void 0:i.networkStats;c&&(r[n]=c)}else Array.from(this.remoteStats.entries()).forEach(c=>{let[u,{networkStats:f}]=c;f&&(r[u]=f)});return r}getRemoteVideoTrackStats(n){const r=(u,f)=>{if(!this.trafficStats)return f;const m=this.trafficStats.peer_delay.find(_=>_.peer_uid===u);return m&&(f.publishDuration=m.B_ppvd+(Date.now()-this.trafficStats.timestamp)),f},i={};if(n){var c;const u=(c=this.remoteStats.get(n))===null||c===void 0?void 0:c.videoStats;u&&(i[n]=r(n,u))}else Array.from(this.remoteStats.entries()).forEach(u=>{let[f,{videoStats:m}]=u;m&&(i[f]=r(f,m))});return i}getRTCStats(){let n=0,r=0,i=0,c=0;const u=this.localStats.get(at.LocalAudioTrack);u&&(n+=u.sendBytes,r+=u.sendBitrate);const f=this.localStats.get(at.LocalVideoTrack);f&&(n+=f.sendBytes,r+=f.sendBitrate);const m=this.localStats.get(at.LocalVideoLowTrack);m&&(n+=m.sendBytes,r+=m.sendBitrate),this.remoteStats.forEach(y=>{let{audioStats:T,videoStats:A}=y;T&&(i+=T.receiveBytes,c+=T.receiveBitrate),A&&(i+=A.receiveBytes,c+=A.receiveBitrate)});let _=1;return this.trafficStats&&(_+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_,SendBitrate:r,SendBytes:n,RecvBytes:i,RecvBitrate:c,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(n){this.localStats.set(n,void 0)}removeLocalStats(n){n?this.localStats.delete(n):this.localStats.clear()}addRemoteStats(n){this.remoteStats.set(n,{})}removeRemoteStats(n){n?this.remoteStats.delete(n):this.remoteStats.clear()}addP2PChannel(n){this.p2pChannel=n}updateTrafficStats(n){n.peer_delay=n.peer_delay.filter(r=>r.B_ppad!==void 0||r.B_ppvd!==void 0),n.peer_delay.filter(r=>this.trafficStatsPeerList.indexOf(r.peer_uid)===-1).forEach(r=>{var i;const c=(i=this.p2pChannel)===null||i===void 0?void 0:i.getRemoteMedia(r.peer_uid),u=c!=null&&c.videoSSRC?Yo.measureFromSubscribeStart(this.store.clientId,c.videoSSRC):0,f=c!=null&&c.audioSSRC?Yo.measureFromSubscribeStart(this.store.clientId,c.audioSSRC):0;r.B_ppad!==void 0&&r.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(r.peer_uid,r.B_ppad,r.B_ppvd,u>f?u:f),this.trafficStatsPeerList.push(r.peer_uid))}),this.trafficStats=n}updateUplinkStats(n){this.uplinkStats&&this.uplinkStats.B_fir!==n.B_fir&&x.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(n.B_fir)),this.uplinkStats=n}static isRemoteVideoFreeze(n,r,i){if(!n)return!1;const c=!!i&&r.framesDecodeFreezeTime>i.framesDecodeFreezeTime,u=!i||r.framesDecodeCount>i.framesDecodeCount;return c||!u}static isRemoteAudioFreeze(n){return!!n&&n._isFreeze()}isLocalVideoFreeze(n){return!(!n.inputFrame||!n.sentFrame)&&n.inputFrame.frameRate>5&&n.sentFrame.frameRate<3}updateLocalStats(n){Array.from(this.localStats.entries()).forEach(r=>{let[i,c]=r;switch(i){case at.LocalVideoTrack:case at.LocalVideoLowTrack:{const f=c,m=Yd({},dR),_=n.getStats(),y=n.getLocalMedia(i);if(_){const T=_.videoSend.find(A=>A.ssrc===(y==null?void 0:y.ssrcs[0].ssrcId));if(T){const A=n.getLocalVideoSize(),k=n.getEncoderConfig(at.LocalVideoTrack);T.codec!=="H264"&&T.codec!=="H265"&&T.codec!=="VP8"&&T.codec!=="VP9"&&T.codec!=="AV1X"&&T.codec!=="AV1"||(m.codecType=T.codec),m.sendBytes=T.bytes,m.sendBitrate=f?8*Math.max(0,m.sendBytes-f.sendBytes):0,T.inputFrame?(m.captureFrameRate=T.inputFrame.frameRate,m.captureResolutionHeight=T.inputFrame.height,m.captureResolutionWidth=T.inputFrame.width):A&&(m.captureResolutionWidth=A.width,m.captureResolutionHeight=A.height),T.sentFrame?(m.sendFrameRate=T.sentFrame.frameRate,m.sendResolutionHeight=T.sentFrame.height,m.sendResolutionWidth=T.sentFrame.width):A&&(m.sendResolutionWidth=A.width,m.sendResolutionHeight=A.height),T.avgEncodeMs&&(m.encodeDelay=T.avgEncodeMs),k&&k.bitrateMax&&(m.targetSendBitrate=1e3*k.bitrateMax),m.sendPackets=T.packets,m.sendPacketsLost=T.packetsLost,m.sendJitterMs=T.jitterMs,m.sendRttMs=T.rttMs,m.totalDuration=f?f.totalDuration+1:1,m.totalFreezeTime=f?f.totalFreezeTime:0,this.isLocalVideoFreeze(T)&&(m.totalFreezeTime+=1),T.scalabilityMode&&this.scalabilityMode!==T.scalabilityMode&&(x.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(T.scalabilityMode)),this.scalabilityMode=T.scalabilityMode)}this.trafficStats&&(m.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var u;this.localStats.set(i,m),((f==null?void 0:f.sendResolutionWidth)!==m.sendResolutionWidth||(f==null?void 0:f.sendResolutionHeight)!==m.sendResolutionHeight)&&((u=this.onStatsChanged)===null||u===void 0||u.call(this,"resolution",{width:m.sendResolutionWidth,height:m.sendResolutionHeight})),m&&y&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,y.track,m);break}case at.LocalAudioTrack:{const f=c,m=Yd({},uR),_=n.getStats(),y=n.getLocalMedia(i);if(_){const T=_.audioSend.find(A=>A.ssrc===(y==null?void 0:y.ssrcs[0].ssrcId));if(T){if(T.codec!=="opus"&&T.codec!=="aac"&&T.codec!=="PCMU"&&T.codec!=="PCMA"&&T.codec!=="G722"||(m.codecType=T.codec),T.inputLevel)m.sendVolumeLevel=Math.round(32767*T.inputLevel);else{const A=n.getLocalAudioVolume();A&&(m.sendVolumeLevel=Math.round(32767*A))}m.sendBytes=T.bytes,m.sendPackets=T.packets,m.sendPacketsLost=T.packetsLost,m.sendJitterMs=T.jitterMs,m.sendRttMs=T.rttMs,m.sendBitrate=f?8*Math.max(0,m.sendBytes-f.sendBytes):0}}this.trafficStats&&(m.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(at.LocalAudioTrack,m),m&&y&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,y.track,m);break}}})}updateRemoteStats(n){Array.from(this.remoteStats.entries()).forEach(r=>{var i,c;let[u,{videoStats:f,audioStats:m,videoPcStats:_}]=r;const y=m,T=f,A=_,k=Yd({},BU),P=Yd({},jU),q=Yd({},Eae),{audioTrack:j,videoTrack:H,audioSSRC:ne,videoSSRC:re}=n.getRemoteMedia(u);let ve;ve=this.store.useP2P?n.getStats(!0):n.getStats();const Oe=(i=ve)===null||i===void 0?void 0:i.audioRecv.find(lt=>lt.ssrc===ne),ke=(c=ve)===null||c===void 0?void 0:c.videoRecv.find(lt=>lt.ssrc===re),we=this.trafficStats&&this.trafficStats.peer_delay.find(lt=>lt.peer_uid===u);if(Oe&&(Oe.codec!=="opus"&&Oe.codec!=="aac"&&Oe.codec!=="PCMU"&&Oe.codec!=="PCMA"&&Oe.codec!=="G722"||(k.codecType=Oe.codec),Oe.outputLevel?k.receiveLevel=Math.round(32767*Oe.outputLevel):j&&(k.receiveLevel=Math.round(32767*j.getVolumeLevel())),k.receiveBytes=Oe.bytes,k.receivePackets=Oe.packets,k.receivePacketsLost=Oe.packetsLost,k.receivePacketsDiscarded=Oe.packetsDiscarded,k.packetLossRate=k.receivePacketsLost/(k.receivePackets+k.receivePacketsLost),k.receiveBitrate=y?8*Math.max(0,k.receiveBytes-y.receiveBytes):0,k.totalDuration=y?y.totalDuration+1:1,k.totalFreezeTime=y?y.totalFreezeTime:0,k.freezeRate=k.totalFreezeTime/k.totalDuration,k.receiveDelay=Oe.jitterBufferMs,k.totalDuration>10&&Tv.isRemoteAudioFreeze(j)&&(k.totalFreezeTime+=1)),ke){var Be;ke.codec!=="H264"&&ke.codec!=="H265"&&ke.codec!=="VP8"&&ke.codec!=="VP9"&&ke.codec!=="AV1X"&&ke.codec!=="AV1"||(P.codecType=ke.codec),P.receiveBytes=ke.bytes,P.receiveBitrate=T?8*Math.max(0,P.receiveBytes-T.receiveBytes):0,P.decodeFrameRate=ke.decodeFrameRate<0?0:ke.decodeFrameRate,P.renderFrameRate=ke.decodeFrameRate<0?0:ke.decodeFrameRate,ke.outputFrame&&(P.renderFrameRate=ke.outputFrame.frameRate),ke.receivedFrame?(P.receiveFrameRate=ke.receivedFrame.frameRate,P.receiveResolutionHeight=ke.receivedFrame.height,P.receiveResolutionWidth=ke.receivedFrame.width):H&&(P.receiveResolutionHeight=H._videoHeight||0,P.receiveResolutionWidth=H._videoWidth||0),ke.framesRateFirefox!==void 0&&(P.receiveFrameRate=Math.round(ke.framesRateFirefox)),P.receivePackets=ke.packets,P.receivePacketsLost=ke.packetsLost,P.packetLossRate=P.receivePacketsLost/(P.receivePackets+P.receivePacketsLost);const lt=T?T.totalFreezeTime:0,St=T?T.totalDuration:0;P.totalDuration=T?T.totalDuration+1:1,P.totalFreezeTime=(Be=ke.totalFreezesDuration)!==null&&Be!==void 0?Be:lt||0,P.receiveDelay=ke.jitterBufferMs||0;const At=!!re&&n.getRemoteVideoIsReady(re);ke.totalFreezesDuration===void 0&&H&&At&&Tv.isRemoteVideoFreeze(H,ke,A)&&(P.totalFreezeTime+=1),P.freezeRate=Math.max(0,Math.min((P.totalFreezeTime-lt)/(P.totalDuration-St),1))}we&&(k.end2EndDelay=we.B_ad,P.end2EndDelay=we.B_vd,k.transportDelay=we.B_ed,P.transportDelay=we.B_ed,k.currentPacketLossRate=we.B_ealr4/100,P.currentPacketLossRate=we.B_evlr4/100,q.uplinkNetworkQuality=we.B_punq?we.B_punq:0,q.downlinkNetworkQuality=we.B_pdnq?we.B_pdnq:0),this.remoteStats.set(u,{audioStats:k,videoStats:P,videoPcStats:ke,networkStats:q}),j&&this.exceptionMonitor.setRemoteAudioStats(j,k),H&&this.exceptionMonitor.setRemoteVideoStats(H,P)})}}class GB{constructor(){Q(this,"destChannelMediaInfos",new Map),Q(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(n){ZF(n),this.srcChannelMediaInfo=n}addDestChannelInfo(n){ZF(n),this.destChannelMediaInfos.set(n.channelName,n)}removeDestChannelInfo(n){by(n),this.destChannelMediaInfos.delete(n)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function zB(e){if(!(e instanceof GB))return new Ue(oe.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const n=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfo();if(!n)return new Ue(oe.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(r.size===0)return new Ue(oe.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class Lu{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(n,r){Q(this,"uid",void 0),Q(this,"_uintid",void 0),Q(this,"_trust_in_room_",!0),Q(this,"_trust_audio_enabled_state_",!0),Q(this,"_trust_video_enabled_state_",!0),Q(this,"_trust_audio_mute_state_",!0),Q(this,"_trust_video_mute_state_",!0),Q(this,"_audio_muted_",!1),Q(this,"_video_muted_",!1),Q(this,"_audio_enabled_",!0),Q(this,"_video_enabled_",!0),Q(this,"_audio_added_",!1),Q(this,"_video_added_",!1),Q(this,"_is_pre_created",!1),Q(this,"_video_pre_subscribed",!1),Q(this,"_audio_pre_subscribed",!1),Q(this,"_trust_video_stream_added_state_",!0),Q(this,"_trust_audio_stream_added_state_",!0),Q(this,"_audioTrack",void 0),Q(this,"_videoTrack",void 0),Q(this,"_dataChannels",[]),Q(this,"_audioSSRC",void 0),Q(this,"_videoSSRC",void 0),Q(this,"_audioOrtc",void 0),Q(this,"_videoOrtc",void 0),Q(this,"_cname",void 0),Q(this,"_rtxSsrcId",void 0),Q(this,"_videoMid",void 0),Q(this,"_audioMid",void 0),this.uid=n,this._uintid=r}}function YB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function qB(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?YB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const Cv="9",XB=4e4;function JB(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Ul(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?JB(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JB(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}var np=function(e){return e[e.DOWN=0]="DOWN",e[e.UP=1]="UP",e}(np||{});const My=new Map;function ZB(e,n,r,i){let{scale:c}=e;if(c===0&&i===np.UP||c>=n.length-1&&i===np.DOWN)return e;let u=Ul(Ul({},e),{},{scale:i===np.DOWN?++c:--c});switch(r){case"maintain-framerate":u=Ul(Ul({},u),n[c].motion);break;case"maintain-resolution":u=Ul(Ul({},u),n[c].detail);break;case"balanced":u=Ul(Ul({},u),n[c].balanced)}return u}function QB(e,n){if(n){const r={overUse:0,underUse:0,adaptationList:e3(n)};My.set(e,r)}else My.delete(e)}function e3(e){const n=Ul({},e),{bitrateMax:r,frameRate:i,scaleResolutionDownBy:c,bitrateMin:u}=n,{MIN_FRAME_RATE:f,MAX_THRESHOLD_FRAMERATE:m,MAX_SCALE:_,BITRATE_MIN_THRESHOLD:y,BITRATE_MAX_THRESHOLD:T,BWE_SCALE_UP_THRESHOLD:A,BWE_SCALE_DOWN_THRESHOLD:k,PERF_SCALE_DOWN_THRESHOLD:P,PERF_SCALE_UP_THRESHOLD:q,BALANCE_BITRATE_FACTOR:j,BALANCE_FRAMERATE_FACTOR:H,BALANCE_RESOLUTION_FACTOR:ne,MOTION_RESOLUTION_FACTOR:re,MOTION_BITRATE_FACTOR:ve,DETAIL_FRAMERATE_FACTOR:Oe,DETAIL_BITRATE_FACTOR:ke}=rR,we=Math.min(n.frameRate,m),Be=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(k,1)*r),bwe_up:r,fps_down:Math.round(Math.pow(P,1)*we),fps_up:i},balanced:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:r,bitrateMin:u},motion:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:r,bitrateMin:u},detail:{scaleResolutionDownBy:1,frameRate:i,bitrateMax:r,bitrateMin:u}}];for(let lt=1;lt<=_;lt++){const St={bwe_up:Math.round(Math.pow(A,lt)*r),bwe_down:Math.round(Math.pow(k,lt+1)*r),fps_up:Math.round(Math.pow(q,lt)*we),fps_down:Math.round(Math.pow(P,lt+1)*we)},At={scaleResolutionDownBy:c/Math.pow(ne,lt),frameRate:Math.max(Math.round(Math.pow(H,lt)*i),f),bitrateMax:Math.max(Math.round(Math.pow(j,lt)*r),T),bitrateMin:Math.max(Math.round(Math.pow(j,lt)*u),y)},Nn={scaleResolutionDownBy:c/Math.pow(re,lt),frameRate:i,bitrateMax:Math.max(Math.round(Math.pow(ve,lt)*r),T),bitrateMin:Math.max(Math.round(Math.pow(ve,lt)*u),y)},kn={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(Oe,lt)*i),f),bitrateMax:Math.max(Math.round(Math.pow(ke,lt)*r),T),bitrateMin:Math.max(Math.round(Math.pow(ke,lt)*u),y)};Be.push({scale:lt,threshold:St,balanced:At,motion:Nn,detail:kn})}return Be}function xce(e,n,r,i,c,u){const f=My.get(e)||{overUse:0,underUse:0,adaptationList:e3(c)},{adaptationList:m}=f;My.set(e,f);const{OVERUSE_TIMES_THRESHOLD:_,UNDERUSE_TIMES_THRESHOLD:y}=rR,{scale:T}=i;let A,k;return typeof n=="number"&&n>0&&function(P,q,j,H){if(q>=j.length)return!1;let{threshold:{fps_down:ne}}=j[q];return de("FORCE_AG_HIGH_FRAMERATE")&&H==="maintain-framerate"&&(ne=j[0].threshold.fps_down),P<ne}(n,T,m,u)&&(f.overUse++,k=cv.CPU,f.overUse>_)||typeof r=="number"&&r>0&&function(P,q,j){if(q>=j.length)return!1;const{threshold:{bwe_down:H}}=j[q];return P<H}(r,T,m)&&(f.overUse++,k=cv.BANDWIDTH,f.overUse>_)?(f.overUse=0,f.underUse=0,A=ZB(i,m,u,np.DOWN),[A,k]):(typeof n=="number"&&n>0&&typeof r=="number"&&r>0&&function(P,q,j,H){if(q===0)return;let{threshold:{fps_up:ne}}=j[q];return de("FORCE_AG_HIGH_FRAMERATE")&&H==="maintain-framerate"&&(ne=j[1].threshold.fps_up),P>ne}(n,T,m,u)&&function(P,q,j){if(q===0)return;const{threshold:{bwe_up:H}}=j[q];return P>H}(r,T,m)&&(f.underUse++,f.underUse>y&&(f.overUse=0,f.underUse=0,A=ZB(i,m,u,np.UP),A.scale===0&&(k=cv.NONE))),[A,k])}function t3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function QR(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?t3(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Uce(e){var n;return!!de("ENABLE_AG_ADAPTATION")&&!!(e instanceof yR||gt(n=e._hints).call(n,hr.CUSTOM_TRACK))&&(!!de("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(r){const i=Mn();if(i.os!==yo.IOS||!i.osVersion)return!1;const c=i.osVersion.split(".");return Number(c[0])>=r}(14)&&Jx(17,4)||Xx(14)&&Zx(17,4,!0)))}const xy=new Map;function Uy(e,n){const r=xy.get(e);if(r){const{timer:i}=r;window.clearTimeout(i),xy.delete(e)}n.qualityLimitationReason=cv.NONE,QB(e)}function Vce(e,n){var r;let i;switch(n){case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoTrack:i=gt(r=e._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:i=Jn.Low}return i}function eI(e){const n=Bn();if(e.some(r=>r._bypassWebAudio))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!n.webAudioMediaStreamDest)throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function tI(e,n){eI(e);const r=new ho;return e.forEach(i=>r.addAudioTrack(i)),r}const Fce=!Bn().supportUnifiedPlan||de("CHROME_FORCE_PLAN_B")&&Il();function Vy(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;return Fce?(r={spec:n,store:e},Ml("PlanBConnection").create(r)):new Kc(n,e)}function nI(e){return e&&(e.iceConnectionState==="disconnected"||e.iceConnectionState==="checking"||e.iceConnectionState==="failed")}function n3(e){try{if(e.iceServers)return!1;if(e.turnServer&&e.turnServer.mode!=="off"){if(sv(e.turnServer.servers))return!1;if(de("FORCE_TURN_TCP")||e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).some(n=>n.forceturn))return!0}return!1}catch{return!1}}var Dn;function r3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function cc(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?r3(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}let Kc=(Dn=class vh extends nB{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var n,r;return(n=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&n!==void 0?n:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var r;return gt(r=Object.keys(ry)).call(r,n)}))]}constructor(n,r){super(n,r),Q(this,"id",dr(5,"connection-")),Q(this,"store",void 0),Q(this,"peerConnection",void 0),Q(this,"forceTurn",!1),Q(this,"remoteSDP",void 0),Q(this,"initialOffer",void 0),Q(this,"transportEventReceiver",void 0),Q(this,"statsFilter",void 0),Q(this,"extension",{useXR:de("USE_XR")}),Q(this,"localCapabilities",void 0),Q(this,"remoteCodecs",void 0),Q(this,"localCandidateCount",0),Q(this,"allCandidatesReceived",!1),Q(this,"isPreallocation",!1),Q(this,"preSSRCMap",new Map),Q(this,"dataStreamChannelMap",new Map),Q(this,"establishPromise",void 0),Q(this,"recoveredDataChannelIds",[]),Q(this,"currentDataChannelId",1),Q(this,"supportAV1RtpSpec",!1),Q(this,"mutex",void 0),Q(this,"qualityLimitationReason",cv.NONE),Q(this,"isFirstConnected",!1),this.store=r,this.forceTurn=n3(n),this.mutex=new Ko("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(vh.resolvePCConfiguration(n),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=eR(this.peerConnection,de("STATS_UPDATE_INTERVAL"),void 0,Ur()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(n){const r=this.preSSRCMap.get(n);if(r!==void 0){const i=this.peerConnection.getTransceivers().find(c=>c.mid===r);if(i)return{transceiver:i,track:i.receiver.track,id:r}}}async updateRemoteRTPCapabilities(n,r){if(this.remoteCodecs=r,!this.remoteSDP)return void x.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(r));if(this.remoteSDP.updateRemoteCodec(n,r,this.store.codec)){const i=await this.peerConnection.createOffer(),c=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}else x.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const i=await this.peerConnection.createOffer();if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=Pu(i.sdp),u=await SB({filterRTX:!de("USE_PUB_RTX")&&!de("USE_SUB_RTX"),filterVideoFec:de("FILTER_VIDEO_FEC"),filterAudioFec:de("FILTER_AUDIO_FEC"),filterVideoCodec:de("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=Ny(u),this.initialOffer=i,de("ENABLE_SVC")&&this.store.codec=="av1"){const m=await async function(){try{const _=new RTCPeerConnection;_.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:ty.L1T3}]});const y=await _.createOffer();if(!y.sdp)return void _.close();const T=$s(y.sdp).mediaDescriptions[0];if(!T)return;const A=T.attributes.extmaps.find(k=>k.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return _.close(),A}catch{return}}();var n;m&&(this.supportAV1RtpSpec=!0,(n=u.send)===null||n===void 0||n.videoExtensions.push(m))}let f;return i.sdp&&RB(i.sdp)&&(f=Br(u),(r=f).send&&(Jf(kt.VIDEO,r.send.videoExtensions),Jf(kt.AUDIO,r.send.audioExtensions)),r.recv&&(Jf(kt.VIDEO,r.recv.videoExtensions),Jf(kt.AUDIO,r.recv.audioExtensions)),r.sendrecv&&(Jf(kt.VIDEO,r.sendrecv.videoExtensions),Jf(kt.AUDIO,r.sendrecv.audioExtensions))),cc(cc({},c),{},{rtpCapabilities:f||u,offerSDP:i.sdp})}catch(i){throw new $e(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,i.toString())}var r}async connect(n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&RB(this.initialOffer.sdp)&&(r=n.rtpCapabilities,i=this.localCapabilities,r.send&&(Iy(kt.VIDEO,r.send.videoExtensions,i.send.videoExtensions),Iy(kt.AUDIO,r.send.audioExtensions,i.send.audioExtensions)),r.recv&&(Iy(kt.VIDEO,r.recv.videoExtensions,i.recv.videoExtensions),Iy(kt.AUDIO,r.recv.audioExtensions,i.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return Br(this._localCapabilities)}get rtpCapabilities(){return Br(this._rtpCapabilities)}get candidates(){return Br(this._candidates)}get iceParameters(){return Br(this._iceParameters)}get dtlsParameters(){return Br(this._dtlsParameters)}constructor(y){let T=arguments.length>1&&arguments[1]!==void 0&&arguments[1];Q(this,"sessionDesc",void 0),Q(this,"_localCapabilities",void 0),Q(this,"_rtpCapabilities",void 0),Q(this,"_candidates",void 0),Q(this,"_originCandidates",void 0),Q(this,"_iceParameters",void 0),Q(this,"_isUseExtmapAllowMixed",void 0),Q(this,"_dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname",void 0),Q(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=T,y=Br(y);const{iceParameters:A,dtlsParameters:k,candidates:P,rtpCapabilities:q,setup:j,localCapabilities:H,cname:ne}=y;this._rtpCapabilities=q,this._candidates=P,this._originCandidates=Br(P),this._iceParameters=A,this._dtlsParameters=k,this._localCapabilities=H,this.setup=j,this.cname=ne,this.sessionDesc=this.updateRemoteRTPCapabilities(q),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(y){const T=this.candidates,A=this.dtlsParameters,k=this.iceParameters,P=this.rtpCapabilities.send;let q=this.sessionDesc.mediaDescriptions.length-1;for(let j=1;j<y;j++){const H=2*j+2e4,ne=2*j+XB,{ssrcs:re,ssrcGroups:ve}=zd([{ssrcId:H}],this.cname),{ssrcs:Oe,ssrcGroups:ke}=zd([{ssrcId:ne,rtx:de("USE_SUB_RTX")?ne+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:Cv,protos:["UDP","TLS","RTP","SAVPF"],fmts:P.videoCodecs.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:k.iceUfrag,icePwd:k.icePwd,unrecognized:[],candidates:T,extmaps:P.videoExtensions,fingerprints:A.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:Oe,ssrcGroups:ke,rtcpFeedbackWildcards:[],payloads:P.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++q)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:Cv,protos:["UDP","TLS","RTP","SAVPF"],fmts:P.audioCodecs.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:k.iceUfrag,icePwd:k.icePwd,unrecognized:[],candidates:T,extmaps:P.audioExtensions,fingerprints:A.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:re,ssrcGroups:ve,rtcpFeedbackWildcards:[],payloads:P.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++q)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Iu(this.sessionDesc)}send(y,T,A,k){const{ssrcs:P,ssrcGroups:q}=zd(T,this.cname,de("SYNC_GROUP")?A:void 0),j=this.findPreloadMediaDesc(P);if(j){if(Ur()&&this.firefoxSsrcMidMap.set(P[0].ssrcId,j.attributes.mid),k&&(k.twcc||k.remb)){const H=this.sessionDesc.mediaDescriptions.indexOf(j);return this.sessionDesc.mediaDescriptions[H]=this.mungSendMediaDesc(j,k),{mid:j.attributes.mid,needExchangeSDP:!0}}return{mid:j.attributes.mid,needExchangeSDP:!1}}{const H=this.findAvailableMediaIndex(y,P);let ne;return H===-1||H===1&&(Vo()||function(){const re=Mn();return!(re.name!==jn.CHROME||!re.osVersion)&&Number(re.version)<=90}()||de("ENABLE_ENCODED_TRANSFORM")&&Rl())||H===0&&de("USE_SUB_RTX")||Qx()?(ne=this.createOrRecycleSendMedia(y,P,q,"sendonly",k),this.updateBundleMids()):(ne=Br(this.sessionDesc.mediaDescriptions[H]),ne.attributes.direction="sendonly",ne.attributes.ssrcs=P,ne.attributes.ssrcGroups=q,this.sessionDesc.mediaDescriptions[H]=this.mungSendMediaDesc(ne,k)),Ur()&&this.firefoxSsrcMidMap.set(P[0].ssrcId,ne.attributes.mid),{mid:ne.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:y,needExchangeSDP:T}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:y.attributes.mid,needExchangeSDP:T}}batchSend(y){const T=y.map(P=>{let{kind:q,ssrcMsg:j,mslabel:H}=P;return this.send(q,j,H)}),A=[];let k=!1;return T.forEach(P=>{let{mid:q,needExchangeSDP:j}=P;j&&(k=!0),A.push(q)}),{mids:A,needExchangeSDP:k}}stopSending(y){const T=this.sessionDesc.mediaDescriptions.filter(A=>A.attributes.mid&&y.indexOf(A.attributes.mid)!==-1);if(T.length!==y.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");T.forEach(A=>{A.attributes.mid==="0"||Ur()||Qx()?A.attributes.ssrcs=[]:(A.attributes.ssrcs=[],A.attributes.direction="inactive",A.media.port="0")}),this.updateBundleMids()}mute(y){const T=this.sessionDesc.mediaDescriptions.find(A=>A.attributes.mid===y);if(!T)throw new Error("mediaDescription not found with ".concat(y," in remote SDP when calling RemoteSDP.mute."));T.attributes.direction="inactive"}unmute(y){const T=this.sessionDesc.mediaDescriptions.find(A=>A.attributes.mid===y);if(!T)throw new Error("mediaDescription not found with ".concat(y," in remote SDP when calling RemoteSDP.unmute."));T.attributes.direction="sendonly"}muteRemote(y){const T=this.sessionDesc.mediaDescriptions.filter(A=>gt(y).call(y,A.attributes.mid||""));if(T.length!==y.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");T.forEach(A=>{A.attributes.direction="inactive"})}unmuteRemote(y){const T=this.sessionDesc.mediaDescriptions.filter(A=>gt(y).call(y,A.attributes.mid||""));if(T.length!==y.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");T.forEach(A=>{A.attributes.direction="recvonly"})}receive(y,T,A,k){y.forEach((P,q)=>{this.createOrRecycleRecvMedia(P,[],"recvonly",T,A,k[q])}),this.updateBundleMids()}stopReceiving(y){const T=this.sessionDesc.mediaDescriptions.filter(A=>y.indexOf(A.attributes.mid)!==-1);if(T.length!==y.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");T.forEach(A=>{A.media.port="0",A.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(y){const T=this.sessionDesc||$s((A=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(A?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var A;this._rtpCapabilities=y;const k=this.rtpCapabilities.send,P=this.localCapabilities.send;for(const q of T.mediaDescriptions){if(q.attributes.iceUfrag=this._iceParameters.iceUfrag,q.attributes.icePwd=this._iceParameters.icePwd,q.attributes.fingerprints=this._dtlsParameters.fingerprints,q.attributes.candidates=this._candidates,q.attributes.setup=this.setup,q.media.mediaType==="application"&&(q.attributes.sctpPort="5000"),q.media.mediaType==="video"){if(k.videoCodecs.length===0){const j=P.videoCodecs.filter(H=>{var ne,re;return(ne=H.rtpMap)===null||ne===void 0?void 0:gt(re=ne.encodingName.toLowerCase()).call(re,"vp8")})||[P.videoCodecs[0]];q.media.fmts=j.map(H=>H.payloadType.toString(10)),q.attributes.payloads=j,q.attributes.extmaps=[]}else if(q.media.fmts=k.videoCodecs.map(j=>j.payloadType.toString(10)),q.attributes.payloads=k.videoCodecs,q.attributes.extmaps=k.videoExtensions,de("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:j,ssrcGroups:H}=zd([{ssrcId:XB,rtx:de("USE_SUB_RTX")?40001:void 0}],this.cname);q.attributes.ssrcs=j,q.attributes.ssrcGroups=H}}if(q.media.mediaType==="audio"){if(k.audioCodecs.length===0){const j=P.audioCodecs.filter(H=>{var ne,re;return(ne=H.rtpMap)===null||ne===void 0?void 0:gt(re=ne.encodingName.toLowerCase()).call(re,"opus")})||[P.audioCodecs[0]];q.media.fmts=j.map(H=>H.payloadType.toString(10)),q.attributes.payloads=j,q.attributes.extmaps=[]}else if(q.media.fmts=k.audioCodecs.map(j=>j.payloadType.toString(10)),q.attributes.payloads=k.audioCodecs,q.attributes.extmaps=k.audioExtensions,Qf(q),de("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:j,ssrcGroups:H}=zd([{ssrcId:2e4}],this.cname);q.attributes.ssrcs=j,q.attributes.ssrcGroups=H}}}return this.sessionDesc=T,this.currentMidIndex=T.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(y){const T=this._originCandidates.filter(k=>k.transport==="udp"),A=[];if(T.forEach(k=>{A.push(qB(qB({},k),{},{foundation:"tcpcandidate",priority:Number(k.priority)-1+"",transport:"tcp",port:Number(k.port)+90+""}))}),T.length!==0){switch(y){case zo.TCP_RELAY:this._candidates=A;break;case zo.UDP_TCP_RELAY:case zo.RELAY:this._candidates=[...T,...A];break;default:this._candidates=T}for(const k of this.sessionDesc.mediaDescriptions)k.attributes.candidates=this.candidates}}restartICE(y){y=Br(y),this._iceParameters=y,this.sessionDesc.mediaDescriptions.forEach(T=>{T.attributes.iceUfrag=y.iceUfrag,T.attributes.icePwd=y.icePwd})}predictReceivingMids(y){const T=[];for(let A=0;A<y;A++)T.push((this.currentMidIndex+A+1).toString(10));return T}findAvailableMediaIndex(y,T){return this.sessionDesc.mediaDescriptions.findIndex(A=>{const k=A.media.mediaType===y&&A.media.port!=="0"&&(A.attributes.direction==="sendonly"||A.attributes.direction==="sendrecv")&&A.attributes.ssrcs.length===0;if(Ur()){if(k){const P=this.firefoxSsrcMidMap.get(T[0].ssrcId);return!(P||A.attributes.mid!=="0"&&A.attributes.mid!=="1")||!(!P||P!==A.attributes.mid)}return!1}return k})}createOrRecycleDataChannel(){for(const A of this.sessionDesc.mediaDescriptions)if(A.media.mediaType==="application")return{mediaDesc:A,needExchangeSDP:!1};this.currentMidIndex+=1;const y="".concat(this.currentMidIndex),T={media:{mediaType:"application",port:Cv,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(y),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(T),{mediaDesc:T,needExchangeSDP:!0}}createOrRecycleRecvMedia(y,T,A,k,P,q){const j=y._mediaStreamTrack.kind,H=this.rtpCapabilities.recv,ne=Ev(j,H,this.localCapabilities.send,j===kt.VIDEO?k:P),re=j===kt.VIDEO?H.videoExtensions:H.audioExtensions;this.currentMidIndex+=1;const ve="".concat(this.currentMidIndex);let Oe={media:{mediaType:j,port:Cv,protos:["UDP","TLS","RTP","SAVPF"],fmts:ne.map(we=>we.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:re,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:T,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:ne,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:A,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ve)}};Oe=this.mungRecvMediaDsec(Oe,y,q);const ke=this.findFirstClosedMedia(j);if(ke){const we=this.sessionDesc.mediaDescriptions.indexOf(ke);this.sessionDesc.mediaDescriptions[we]=Oe}else this.sessionDesc.mediaDescriptions.push(Oe);return Oe}updateRemoteCodec(y,T,A){const k=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(Oe=>Oe.rtpMap&&Oe.rtpMap.encodingName.toLowerCase()||"").filter(Oe=>{var ke;return gt(ke=Object.keys(ry)).call(ke,Oe)}))],P=new Set(T);if(k.every(Oe=>P.has(Oe)))return x.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(T)),!1;const q=this._rtpCapabilities.recv.videoCodecs.filter(Oe=>T.some(ke=>{var we;return gt(we=Oe.rtpMap&&Oe.rtpMap.encodingName.toLowerCase()||"").call(we,ke)}));if(q.length===0)return x.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(k," codecs: ").concat(T)),!1;const j=[...new Set(q.map(Oe=>Oe.rtpMap&&Oe.rtpMap.encodingName.toLowerCase()||""))];let H;if(x.debug("updateRemoteCodec, from ".concat(k," to ").concat(j)),y.length===0)H=this.sessionDesc.mediaDescriptions.filter(Oe=>Oe.media.mediaType==="video"&&Oe.attributes.direction==="recvonly");else if(H=this.sessionDesc.mediaDescriptions.filter(Oe=>Oe.attributes.mid&&gt(y).call(y,Oe.attributes.mid)&&Oe.attributes.direction==="recvonly"),H.length!==y.length)return x.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(y,", codecs: ").concat(T)),!1;if(de("USE_PUB_RTX")||de("USE_SUB_RTX")){const Oe=$R(q,this.rtpCapabilities.recv.videoCodecs);q.push(...Oe)}this._rtpCapabilities.recv.videoCodecs=q;const ne=this.localCapabilities.send,re=this.rtpCapabilities.recv,ve=Ev(kt.VIDEO,re,ne,A);return H.forEach(Oe=>{const ke=ve.map(we=>we.payloadType.toString(10));x.debug("updateRemoteCodec mid: ".concat(Oe.attributes.mid,", from"),Oe.attributes.payloads,"to",ve),Oe.attributes.payloads=ve,Oe.media.fmts=ke}),!0}createOrRecycleSendMedia(y,T,A,k,P){const q=this.rtpCapabilities.send,j=y===kt.VIDEO?q.videoCodecs:q.audioCodecs,H=y===kt.VIDEO?q.videoExtensions:q.audioExtensions;this.currentMidIndex+=1;const ne="".concat(this.currentMidIndex);let re={media:{mediaType:y,port:Cv,protos:["UDP","TLS","RTP","SAVPF"],fmts:j.map(Oe=>Oe.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:H,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:T,ssrcGroups:A,rtcpFeedbackWildcards:[],payloads:j,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:k,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(ne)}};re=this.mungSendMediaDesc(re,P);const ve=this.findFirstClosedMedia(y);if(ve){const Oe=this.sessionDesc.mediaDescriptions.indexOf(ve);this.sessionDesc.mediaDescriptions[Oe]=re}else this.sessionDesc.mediaDescriptions.push(re);return re}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(y=>y.media.port!=="0").map(y=>y.attributes.mid)}mungRecvMediaDsec(y,T,A){const k=Br(y);return BR(k),Zf(k,T),jR(k,T),yB(k),Oy(k,A,this.localCapabilities.send),k}mungSendMediaDesc(y,T){const A=Br(y);return Oy(A,T,this.localCapabilities.recv),Qf(A),A}updateRecvMedia(y,T){const A=this.sessionDesc.mediaDescriptions.findIndex(k=>k.attributes.mid===y);if(A!==-1){const k=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[A],T);this.sessionDesc.mediaDescriptions[A]=k}}bumpMid(y){this.currentMidIndex+=y}findFirstClosedMedia(y){return this.sessionDesc.mediaDescriptions.find(T=>Ur()?T.media.port==="0"&&T.media.mediaType===y:T.media.port==="0")}findPreloadMediaDesc(y){return this.sessionDesc.mediaDescriptions.find(T=>{var A;return((A=T.attributes)===null||A===void 0||(A=A.ssrcs[0])===null||A===void 0?void 0:A.ssrcId)===y[0].ssrcId})}getSSRC(y){var T;return(T=this.sessionDesc.mediaDescriptions.find(A=>A.attributes.mid===y))===null||T===void 0?void 0:T.attributes.ssrcs}}(cc(cc({},n),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),n.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const c=this.remoteSDP.toString(),u=CB(this.initialOffer.sdp,this.extension),f=this.logSDPExchange(u||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),f==null||f(c),await this.peerConnection.setRemoteDescription({type:"answer",sdp:c});const m=this.peerConnection.getTransceivers()[0];if(m!=null&&m.receiver&&this.tryBindTransportEvents(m.receiver),de("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(de("PRELOAD_MEDIA_COUNT"));const y=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:y});const T=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(T)}const{preSSRCs:_}=n;if(Array.isArray(_)&&_.length>0){const{mids:y}=this.remoteSDP.batchSend(_.map(T=>({kind:T.kind,ssrcMsg:[{ssrcId:T.ssrcId,rtx:T.rtx}],mslabel:T.mslabel})));y.forEach((T,A)=>{this.preSSRCMap.set(_[A].ssrcId,T)}),await yv(this.peerConnection,this.remoteSDP,this.extension),x.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(c){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(c.toString()))}var r,i}async updateRemoteConnect(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:r}=n;this.remoteSDP.updateRemoteRTPCapabilities(r),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:i}=n;if(Array.isArray(i)&&i.length>0){const{mids:c}=this.remoteSDP.batchSend(i.map(u=>Object.assign({},{kind:u.kind,ssrcMsg:[{ssrcId:u.ssrcId,rtx:u.rtx}],mslabel:u.mslabel})));c.forEach((u,f)=>{this.preSSRCMap.set(i[f].ssrcId,u)})}await yv(this.peerConnection,this.remoteSDP,this.extension),x.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(r.toString()))}}send(n,r,i){var c=this;return zi(function*(){const u=yield Ln(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const f=[],m=Ry();n.forEach(H=>{const ne=c.peerConnection.addTransceiver(H._mediaStreamTrack,cc({direction:"sendonly"},H.trackMediaType==="video"&&c.supportAV1RtpSpec&&m?{sendEncodings:[{scalabilityMode:m}]}:{}));f.push(ne),H._updateRtpTransceiver(ne)}),Ur()&&de("SIMULCAST")===!0&&(yield Ln(c.applySimulcastForFirefox(f,n)));const _=yield Ln(c.peerConnection.createOffer()),y=c.remoteSDP.predictReceivingMids(n.length),T=c.mungSendOfferSDP(_.sdp,n,y),A=$s(T),k=y.map(H=>{const ne=A.mediaDescriptions.find(re=>re.attributes.mid===H);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return gB(ne,de("USE_PUB_RTX"))});let P;try{P=yield k}catch(H){P=[],c.remoteSDP.receive(n,r,i,P);const ne=c.remoteSDP.toString();throw yield Ln(c.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield Ln(c.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield Ln(c.stopSending(y,!0)),H}c.remoteSDP.receive(n,r,i,P);const q=c.remoteSDP.toString(),j=c.logSDPExchange(T,"offer","local","send");return yield Ln(c.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield Ln(c.applySimulcastEncodings(f,n)),yield Ln(c.applySendEncodings(f,n)),j==null||j(q),yield Ln(c.peerConnection.setRemoteDescription({type:"answer",sdp:q})),f.map((H,ne)=>{const re=y[ne];return{localSSRC:k[ne],id:re,transceiver:H}})}catch(f){throw f instanceof $e?f:new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(f.toString()))}finally{u()}})()}async createDataChannels(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let i=this.dataStreamChannelMap.get(n);if(i&&i.readyState==="open")x.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const u=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof u!="number")throw new Error("create DataChannel error, because cannot get dc id");i=this.peerConnection.createDataChannel("datastream-channel",{id:u,negotiated:!0,ordered:!1,maxRetransmits:de("DATASTREAM_MAX_RETRANSMITS")}),i.binaryType="arraybuffer",this.dataStreamChannelMap.set(n,i)}r.forEach(u=>{u._updateOriginDataChannel(i)});const{needExchangeSDP:c}=this.remoteSDP.sendDataChannel();if(c){const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:u});const f=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(f),x.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else x.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(i){throw i instanceof $e?i:new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(i.toString()))}}async stopDataChannels(n){try{const r=this.dataStreamChannelMap.get(n);return r&&(r.id&&this.recoveredDataChannelIds.push(r.id),r.close()),void this.dataStreamChannelMap.delete(n)}catch(r){throw r instanceof $e?r:new $e(oe.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(r.toString()))}}async stopSending(n,r){const i=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(_=>n.indexOf(_.mid)!==-1);if(c.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");c.map(_=>{var y;Uy(this.id+_.mid,this),_.direction="inactive",(y=_.stop)===null||y===void 0||y.call(_)});const u=await this.peerConnection.createOffer(),f=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(n);const m=this.remoteSDP.toString();f==null||f(m),await this.peerConnection.setRemoteDescription({type:"answer",sdp:m})}catch(c){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{i&&i()}}async receive(n,r,i,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:u,needExchangeSDP:f}=this.remoteSDP.send(n,r,i,c);f&&(await yv(this.peerConnection,this.remoteSDP,this.extension),x.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP.")));const m=this.peerConnection.getTransceivers().find(_=>_.mid===u);if(!m)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:m.receiver.track,id:u,transceiver:m}}catch(u){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async batchReceive(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:r,needExchangeSDP:i}=this.remoteSDP.batchSend(n);return i&&(await yv(this.peerConnection,this.remoteSDP,this.extension),x.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),r.map(c=>{const u=this.peerConnection.getTransceivers().find(f=>f.mid===c);if(!u)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:u.receiver.track,id:c,transceiver:u}})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");n.forEach(u=>{Array.from(this.preSSRCMap.entries()).some(f=>{let[m,_]=f;if(_===u)return this.preSSRCMap.delete(m),!0})}),this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();i==null||i(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.mute(n);const r=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();i==null||i(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(r.toString()))}}async unmuteRemote(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(n," before remote SDP created."));this.remoteSDP.unmute(n);const r=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();i==null||i(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(r.toString()))}}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(f=>f.mid&&n.indexOf(f.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(f=>{f.direction="inactive"});const i=await this.peerConnection.createOffer(),c=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(n);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(f=>f.mid&&n.indexOf(f.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async(f,m)=>{f.direction="sendonly"});const i=await this.peerConnection.createOffer(),c=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(n),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(n,this.remoteCodecs,this.store.codec);const u=this.remoteSDP.toString();c==null||c(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(n){var r=this;return zi(function*(){const i=yield Ln(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const c=Bn().supportPCSetConfiguration,u=de("FORCE_TURN_TCP")||r.forceTurn;if(n===zo.RELAY&&!c)return;if(c&&!u){const A=n===zo.RELAY?"relay":"all",k=r.peerConnection.getConfiguration();k.iceTransportPolicy!==A&&(x.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(k.iceTransportPolicy,"] to [").concat(A,"]")),k.iceTransportPolicy=A,r.peerConnection.setConfiguration(k))}r.remoteSDP.updateCandidates(n);const f=yield Ln(r.peerConnection.createOffer({iceRestart:!0}));if(!f.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const m=Pu(f.sdp),{remoteIceParameters:_}=yield m.iceParameters;r.remoteSDP.restartICE(_);const y=r.remoteSDP.toString(),T=r.logSDPExchange(f.sdp||"","offer","local","restartICE");r.store.descriptionStart(),yield Ln(r.peerConnection.setLocalDescription(f)),T==null||T(y),yield Ln(r.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(c){x.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),c)}finally{i()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const n=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(zo.TCP_RELAY),await yv(this.peerConnection,this.remoteSDP,this.extension)}catch(r){x.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),r)}finally{n()}}close(){var n;this.peerConnection.getTransceivers().forEach(r=>{Uy(this.id+r.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return cc(cc({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(i.sdp,[r],[n]);this.remoteSDP.updateRecvMedia(n,r);const u=this.remoteSDP.toString(),f=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),f==null||f(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new $e(oe.EXCHANGE_SDP_FAILED,i.toString())}}async updateSendParameters(n,r){const i=this.peerConnection.getTransceivers().filter(c=>c.mid===n);i.length===1&&(this.isVP8Simulcast(r)?Ur()||await this.applySimulcastEncodings(i,[r]):await this.applySendEncodings(i,[r]))}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const i=this.peerConnection.getTransceivers().find(c=>c.mid===r);i&&await i.sender.replaceTrack(n._mediaStreamTrack)}async getSelectedCandidatePair(){const n=this.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const r=n[0].transport.iceTransport,{local:i,remote:c}=r.getSelectedCandidatePair();return{local:cc(cc({},Fc),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port}),remote:cc(cc({},Fc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n;(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=n=>{if(n&&(n.errorCode||n.errorText)){var r;const i="code: ".concat(n.errorCode,", message: ").concat(n.errorText),c=n.port?"local: ".concat(n.port):"";x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(i,"), url: ").concat(n.url||"",", host_candidate:").concat(c)),(r=this.onICECandidateError)===null||r===void 0||r.call(this,i)}},this.peerConnection.onicegatheringstatechange=n=>{n&&n.target&&"iceGatheringState"in n.target&&x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(n.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=n=>{n.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},de("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n){const r={iceServers:[]};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&(sv(n.turnServer.servers)?r.iceServers=n.turnServer.servers:de("NEW_TURN_MODE")&&r.iceServers?(de("USE_TURN_SERVER_OF_GATEWAY")?n.turnServer.serversFromGateway&&r.iceServers.push(...vh.newTurnServerConfigToIceServers(n.turnServer.serversFromGateway)):r.iceServers.push(...vh.newTurnServerConfigToIceServers(n.turnServer.servers)),de("NEW_FORCE_TURN")&&(r.iceTransportPolicy="relay")):n.turnServer.mode!=="off"&&(r.iceServers&&r.iceServers.push(...vh.turnServerConfigToIceServers(n.turnServer.servers)),de("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...vh.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),de("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(i=>{i.forceturn&&(r.iceTransportPolicy="relay")}))),de("ENABLE_ENCODED_TRANSFORM")&&Bn().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(i=>{i.security?i.tcpport&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(Nu(i.turnServerURL),":").concat(i.tcpport,"?transport=tcp")}):(i.udpport&&!de("FORCE_TURN_TCP")&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.udpport,"?transport=udp")}),i.tcpport&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}))}),r}static newTurnServerConfigToIceServers(n){const r=[];return n.forEach(i=>{const c=de("NEW_TURN_MODE");c===1?r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":3478?transport=udp")}):c===2?r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":3478?transport=tcp")}):c===3?r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(Nu(i.turnServerURL),":443?transport=tcp")}):c===4&&(r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":3478?transport=udp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":3478?transport=tcp")}),r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(Nu(i.turnServerURL),":443?transport=tcp")}))}),r}tryBindTransportEvents(n){const r=n.transport;if(r){this.transportEventReceiver=n,r.onstatechange=()=>{var c;r!=null&&r.state&&((c=this.onDTLSTransportStateChange)===null||c===void 0||c.call(this,r.state))},r.onerror=c=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in c?c.error:c)};const i=r.iceTransport;i&&(i.onstatechange=()=>{const c=r==null?void 0:r.iceTransport.state;var u;c&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,c))},i.getSelectedCandidatePair&&(i.onselectedcandidatepairchange=()=>{if(i.getSelectedCandidatePair()){const{local:c,remote:u}=i.getSelectedCandidatePair();x.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(n,r){var i,c;if(r||(r=this.peerConnection.getSenders().find(H=>H.track===n._mediaStreamTrack)),!r)return x.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(n))return x.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Bn().supportSetRtpSenderParameters)return x.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},f={};switch(n._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;case"balanced":u.degradationPreference="balanced"}const m=function(j,H){return j.getTransceivers().find(ne=>ne.sender.track===H||ne.receiver.track===H)}(this.peerConnection,n._mediaStreamTrack),_=Cae(n);if(Uce(n)&&m&&r&&_&&this.getLocalVideoStats&&gt(i=["vp8","vp9"]).call(i,this.store.codec)){var y;const j=u.degradationPreference||(gt(y=n._hints).call(y,hr.CUSTOM_TRACK)?de("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(H,ne,re,ve,Oe,ke){if(Uy(H,re),Oe(ne),ve!=="balanced"&&ve!=="maintain-framerate"&&ve!=="maintain-resolution")return;let we=-1;QB(H,ne);const Be=window.setInterval(()=>{const St=xy.get(H);if(!de("ENABLE_AG_ADAPTATION")||!St)return Uy(H,re),void Oe(ne);const At=ke();if(At.sendPackets>0&&At.OutgoingAvailableBandwidth>0){if(we===-1)return void(we=Date.now());if(Date.now()-we<1e3)return;const Nn=At.sendFrameRate,kn=At.OutgoingAvailableBandwidth,[fr,Xr]=xce(H,Nn,kn,St.adaptationConfig,ne,ve);Xr&&(re.qualityLimitationReason=Xr),fr&&St.adaptationConfig.scale!==fr.scale&&(x.debug("[".concat(H,"] applyAdaptation: ").concat(re.qualityLimitationReason,`
           sendFps `).concat(Nn,", bwe ").concat(kn,", switch from ").concat(St.adaptationConfig.scale," to ").concat(fr.scale," ")),St.adaptationConfig=QR(QR({},St.adaptationConfig),fr),Oe(fr))}},de("CHECK_LOCAL_STATS_INTERVAL")),lt=QR({},ne);xy.set(H,{timer:Be,adaptationConfig:lt,originConfig:ne,adaptationFunc:Oe}),x.debug("[".concat(H,"] start adaptation, originConfig: ").concat(JSON.stringify(ne),", degradationPreference: ").concat(ve))})(this.id+m.mid,_,this,j,H=>{r&&this.updateAdaptation(r,H)},this.getLocalVideoStats.bind(this))}if(n._encoderConfig){var T;const{bitrateMax:j,frameRate:H,scaleResolutionDownBy:ne}=n._encoderConfig;j&&(f.maxBitrate=1e3*j),(gt(T=n._hints).call(T,hr.LOW_STREAM)||n.isUseScaleResolutionDownBy)&&(H&&(f.maxFramerate=ii(H)),ne&&ne>=1&&(f.scaleResolutionDownBy=ne))}const{maxFramerate:A}=de("ENCODER_CONFIG_LIMIT");if(A&&typeof A=="number"&&(f.maxFramerate=f.maxFramerate?Math.min(f.maxFramerate,A):A),de("DSCP_TYPE")&&Il()){var k;const j=de("DSCP_TYPE");gt(k=["very-low","low","medium","high"]).call(k,j)&&(f.networkPriority=j)}const P=r.getParameters(),q=(c=P.encodings)===null||c===void 0?void 0:c[0];Ur()&&!q&&(u.encodings=[f]),q&&Object.assign(q,f),Object.assign(P,u),x.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(P.encodings))),await r.setParameters(P),await async function(j,H,ne){try{var re;if(!Bn().supportSetRtpSenderParameters||!function(Be){return Be==="vp9"||Be==="av1"}(j)||!de("ENABLE_SVC"))return;const ve={},Oe={},ke=H.getParameters(),we=(re=ke.encodings)===null||re===void 0?void 0:re[0];Oe.scalabilityMode=Ry(ne),we&&Object.assign(we,Oe),Object.assign(ke,ve),await H.setParameters(ke),x.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(ke.encodings)))}catch(ve){x.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",ve)}}(this.store.codec,r,de("SVC_MODE"))}async updateAdaptation(n,r){var i,c;if(!n)return x.debug("[updateAdaptation] no rtpSender found");if(!Bn().supportSetRtpSenderParameters)return x.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const u={},{bitrateMax:f,frameRate:m,scaleResolutionDownBy:_}=r;f&&(u.maxBitrate=1e3*f),m&&(u.maxFramerate=ii(m)),_&&_>=1&&gt(i=["vp8","vp9"]).call(i,this.store.codec)&&(u.scaleResolutionDownBy=_);const y=n.getParameters(),T=(c=y.encodings)===null||c===void 0?void 0:c[0];T&&Object.assign(T,u),Object.assign(y,{});try{await n.setParameters(y),x.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(y.encodings)))}catch(A){!("transport"in n)||n.transport&&n.transport.state==="connected"?this.peerConnectionState!=="connected"?x.debug("[updateAdaptation] peerConnection not connected}"):x.debug("[updateAdaptation] updateRtpSenderEncodings failed",A):x.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(n,r){try{if(!Bn().supportSetRtpSenderParameters||n.length!==r.length)return;for(let i=0;i<n.length;i++){const c=n[i],u=r[i];u instanceof Sr&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,c.sender)}}catch{x.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r,i){const c=$s(n);return r.forEach((u,f)=>{const m=i[f],_=c.mediaDescriptions.find(y=>y.attributes.mid===m);_&&(Zf(_,u),bB(_,u,this.store.codec))}),Iu(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,i)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,i)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var i;(i=this.onSelectedLocalCandidateChanged)===null||i===void 0||i.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var i;(i=this.onSelectedRemoteCandidateChanged)===null||i===void 0||i.call(this,n,r)},this.statsFilter.onFirstVideoDecodedTimeout=n=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(n,r){if(n.length===r.length)for(let _=0;_<n.length;_++){var i,c,u,f,m;const y=n[_],T=r[_];if(T instanceof Sr&&!gt(i=T._hints).call(i,hr.LOW_STREAM)&&(c=T._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=T._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(f=T._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=T._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},k={high:1e3*(T._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:k.high}];const P=y.sender.getParameters();await y.sender.setParameters(Object.assign(P,A))}}}async applySimulcastEncodings(n,r){if(!Ur()&&n.length===r.length)for(let i=0;i<n.length;i++){const c=r[i];if(c instanceof Sr&&this.isVP8Simulcast(c)){const u=n[i],f={},m={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};f.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:m.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:m.medium,scaleResolutionDownBy:4}];const _=u.sender.getParameters();await u.sender.setParameters(Object.assign(_,f))}}}isVP8Simulcast(n){var r,i,c,u,f;return!!(n instanceof Sr&&de("SIMULCAST")&&this.store.codec==="vp8"&&!gt(r=n._hints).call(r,hr.LOW_STREAM)&&(i=n._encoderConfig)!==null&&i!==void 0&&i.bitrateMax&&((c=n._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(u=n._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((f=n._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1)}logSDPExchange(n,r,i,c){if(de("SDP_LOGGING"))return x.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(r," SDP during P2PConnection.").concat(c,`
`),n),r==="offer"?u=>{this.logSDPExchange(u,"answer",i==="local"?"remote":"local",c)}:void 0}async getRemoteSSRC(n){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(n);return r&&r.length!==0?r[0].ssrcId:void 0}setConfiguration(n){if(Bn().supportPCSetConfiguration){const r=vh.resolvePCConfiguration(n);this.peerConnection.setConfiguration(r)}}},Lt(Dn.prototype,"updateRemoteRTPCapabilities",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"updateRemoteRTPCapabilities"),Dn.prototype),Lt(Dn.prototype,"connect",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"connect"),Dn.prototype),Lt(Dn.prototype,"updateRemoteConnect",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"updateRemoteConnect"),Dn.prototype),Lt(Dn.prototype,"createDataChannels",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"createDataChannels"),Dn.prototype),Lt(Dn.prototype,"receive",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"receive"),Dn.prototype),Lt(Dn.prototype,"batchReceive",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"batchReceive"),Dn.prototype),Lt(Dn.prototype,"stopReceiving",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"stopReceiving"),Dn.prototype),Lt(Dn.prototype,"muteRemote",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"muteRemote"),Dn.prototype),Lt(Dn.prototype,"unmuteRemote",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"unmuteRemote"),Dn.prototype),Lt(Dn.prototype,"muteLocal",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"muteLocal"),Dn.prototype),Lt(Dn.prototype,"unmuteLocal",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"unmuteLocal"),Dn.prototype),Lt(Dn.prototype,"close",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"close"),Dn.prototype),Lt(Dn.prototype,"updateEncoderConfig",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"updateEncoderConfig"),Dn.prototype),Lt(Dn.prototype,"updateSendParameters",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"updateSendParameters"),Dn.prototype),Lt(Dn.prototype,"replaceTrack",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"replaceTrack"),Dn.prototype),Lt(Dn.prototype,"updateAdaptation",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"updateAdaptation"),Dn.prototype),Lt(Dn.prototype,"getRemoteSSRC",[Os],Object.getOwnPropertyDescriptor(Dn.prototype,"getRemoteSSRC"),Dn.prototype),Dn);function Os(e,n,r){const i=e[n];if(typeof i!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,u=await c.lock("From P2PConnection.".concat(n));try{for(var f=arguments.length,m=new Array(f),_=0;_<f;_++)m[_]=arguments[_];return await i.apply(this,m)}finally{u()}},r}function rI(e,n){let r=document.createElement("video"),i=document.createElement("canvas");r.setAttribute("style","display:none"),i.setAttribute("style","display:none"),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("autoplay",""),r.autoplay=!0,r.setAttribute("playsinline",""),i.width=ii(n.width),i.height=ii(n.height);const c=ii(n.framerate||15);document.body.append(r),document.body.append(i);let u=e._mediaStreamTrack;r.srcObject=new MediaStream([u]),r.play();const f=i.getContext("2d");if(!f)throw new Ue(oe.UNEXPECTED_ERROR,"can not get canvas context");const m=Bn(),_=i.captureStream(m.supportRequestFrame?0:c).getVideoTracks()[0];_.canvas||(_.canvas=i),i.startCapture=()=>{if(!r)return i.stopCapture&&i.stopCapture();if(r.paused&&r.play(),r.videoHeight>2&&r.videoWidth>2){const T=r.videoWidth,A=r.videoHeight/T,k=i.width*A;Math.abs(k-i.height)>=2&&(x.debug("adjust low stream resolution","".concat(i.width,"x").concat(i.height," -> ").concat(i.width,"x").concat(k)),i.height=k)}f.drawImage(r,0,0,i.width,i.height),_.requestFrame&&_.requestFrame(),u!==e._mediaStreamTrack&&(u=e._mediaStreamTrack,r.srcObject=new MediaStream([u]))},i.stopCapture=pR(()=>i.startCapture&&i.startCapture(),c);const y=_.stop;return _.stop=()=>{y.call(_),r&&(r.remove(),r.srcObject=null,r=null),i&&(i.width=0,i.remove(),i.stopCapture&&i.stopCapture(),i.startCapture=void 0,i.stopCapture=void 0,i=null),x.debug("clean low stream renderer")},_}var Fy=function(e){return e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH",e}(Fy||{}),to=function(e){return e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM",e[e.BYTES_RETRANSMIT=2173]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2172]="PACKAGES_RETRANSMIT",e[e.HUGE_FRAME_SENT=2174]="HUGE_FRAME_SENT",e[e.KEY_FRAMES_ENCODED=2207]="KEY_FRAMES_ENCODED",e}(to||{}),qd=function(e){return e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH",e}(qd||{}),no=function(e){return e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY",e[e.FRAMES_DROPPED=2181]="FRAMES_DROPPED",e[e.BYTES_RETRANSMIT=2175]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2176]="PACKAGES_RETRANSMIT",e[e.PACKAGES_DISCARDED=2198]="PACKAGES_DISCARDED",e[e.AVG_DECODE=2200]="AVG_DECODE",e[e.AVG_PROCESSING_DELAY=2202]="AVG_PROCESSING_DELAY",e[e.AVG_ASSEMBLY_TIME=2203]="AVG_ASSEMBLY_TIME",e[e.AVG_INTER_FRAME_DELAY=2204]="AVG_INTER_FRAME_DELAY",e[e.KEY_FRAMES_DECODED=2206]="KEY_FRAMES_DECODED",e}(no||{}),Xd=function(e){return e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FRAME_RATE_OUTPUT=2155]="FRAME_RATE_OUTPUT",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER",e[e.FREEZE_DURATION=2156]="FREEZE_DURATION",e}(Xd||{}),o3=function(e){return e[e.PCM_LEVEL=2104]="PCM_LEVEL",e}(o3||{}),Gc=function(e){return e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED",e[e.BYTES_RETRANSMIT=2179]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2180]="PACKAGES_RETRANSMIT",e}(Gc||{}),Ns=function(e){return e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES",e[e.BYTES_RETRANSMIT=2178]="BYTES_RETRANSMIT",e[e.PACKAGES_RETRANSMIT=2177]="PACKAGES_RETRANSMIT",e[e.PACKAGES_DISCARDED=2199]="PACKAGES_DISCARDED",e[e.AVG_PROCESSING_DELAY=2201]="AVG_PROCESSING_DELAY",e[e.TOTAL_SAMPLES_RECEIVED=2224]="TOTAL_SAMPLES_RECEIVED",e}(Ns||{}),s3=function(e){return e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL",e}(s3||{}),ks=function(e){return e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE",e[e.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",e}(ks||{}),By=function(e){return e[e.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",e}(By||{});const Jd=1e3,Zd=6,jy=3,Bce=Math.max(Zd,jy);function Qt(e,n,r){r!=null&&Number.isFinite(r)&&(e[n]=Math.round(Math.max(0,r)))}function i3(e){const n={[ks.CONN_TYPE]:0,[ks.RTT]:e.rtt,[ks.STATS_UPDATE_INTERVAL]:e.updateInterval?Math.round(Math.max(0,e.updateInterval)):void 0};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const r=e.selectedCandidatePair.localCandidate.relayProtocol;r==="udp"&&(n[ks.CONN_TYPE]=1),r==="tcp"&&(n[ks.CONN_TYPE]=3),r==="tls"&&(n[ks.CONN_TYPE]=4);break}case"srflx":n[ks.CONN_TYPE]=2;break;case"unknown":n[ks.CONN_TYPE]=5;break;default:n[ks.CONN_TYPE]=0}return n}function a3(e){let n=0;switch(e){case"none":n=0;break;case"cpu":n=1;break;case"bandwidth":n=2;break;case"other":n=3}return n}class c3 extends Dr{constructor(n){super(),Q(this,"store",void 0),Q(this,"uploadWRTCStatsTimer",void 0),Q(this,"uploadOutboundDenoiserStatsTimer",void 0),Q(this,"uploadExtStatsTimer",void 0),Q(this,"uploadExtUsageStatsTimer",void 0),Q(this,"uploadInboundExtStatsTimer",void 0),Q(this,"requestStats",void 0),Q(this,"requestTransportStats",void 0),Q(this,"requestLocalMedia",void 0),Q(this,"requestRemoteMedia",void 0),Q(this,"requestAllTracks",void 0),Q(this,"requestVideoIsReady",void 0),Q(this,"requestUploadStats",void 0),Q(this,"requestUpload",void 0),Q(this,"uploadOutboundStarted",!1),Q(this,"uploadInboundStarted",!1),Q(this,"uploadTransportStarted",!1),Q(this,"uploadBaseStatsStarted",!1),Q(this,"uploadExtensionUsageStarted",!1),Q(this,"lastRecvStats",void 0),Q(this,"lastSendStats",void 0),Q(this,"lastRefRecvStats",void 0),Q(this,"lastRefSendStats",void 0),Q(this,"lastFullRecvStats",void 0),Q(this,"lastFullSendStats",void 0),Q(this,"needUploadRenderFreezeTime",!0),this.store=n}uploadWRTCStats(n){if(!this.requestStats||!this.requestUploadStats)return;const r=n%jy==0,i=n%Zd==0;let c,u;if(this.uploadTransportStarted&&(c=this.requestStats(),this.store.useP2P&&(u=this.requestStats(!0))),!c&&this.uploadOutboundStarted&&(c=this.requestStats()),!u&&this.uploadInboundStarted&&(u=this.requestStats(!0)),c||u){var f;const m={};if(this.uploadTransportStarted&&c){const y=this.getTransportStats(c,u,r);y&&(m.misc=[y])}if(this.uploadOutboundStarted&&c){const y=this.getOutboundStats(c,i?this.lastFullSendStats:r?this.lastRefSendStats:this.lastSendStats,r,i);y&&(m.outbound=[y])}if(this.uploadInboundStarted&&u){const y=this.getInboundStats(u,i?this.lastFullRecvStats:r?this.lastRefRecvStats:this.lastRecvStats,r,i);y&&(m.inbound=y)}const _=(f=this.requestTransportStats)===null||f===void 0?void 0:f.call(this).connectState;_&&(Array.isArray(m.misc)?m.misc[0]&&m.misc[0].addition&&(m.misc[0].addition[By.RTC_PEER_CONNECTION_STATE]=Qw[_]):m.misc=[{addition:{[By.RTC_PEER_CONNECTION_STATE]:Qw[_]}}]),this.requestUploadStats(m)}this.lastRecvStats=u,this.lastSendStats=c,i&&(this.lastFullRecvStats=u,this.lastFullSendStats=c),r&&(this.lastRefRecvStats=u,this.lastRefSendStats=c)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let n=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var r,i;const c=(r=this.requestTransportStats)===null||r===void 0?void 0:r.call(this);return void(c&&((i=this.requestUploadStats)===null||i===void 0||i.call(this,{misc:[{addition:{[By.RTC_PEER_CONNECTION_STATE]:Qw[c.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(n),++n===Bce+1&&(n=1)},Jd)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(n,r,i){if(!this.requestStats)return;if(!i)return n.rtt==null?void 0:{addition:{[ks.RTT]:n.rtt,[ks.CONN_TYPE]:void 0,[ks.STATS_UPDATE_INTERVAL]:n.updateInterval||void 0}};const c=i3(n);if(this.store.useP2P){if(r){const u=i3(r);c[ks.CONN_TYPE]+=u[ks.CONN_TYPE]<<3}c[ks.CONN_TYPE]+=110}else c[ks.CONN_TYPE]+=100;return{addition:c}}getOutboundStats(n,r,i,c){if(!this.requestUploadStats||!this.requestLocalMedia)return;const u=this.requestLocalMedia();if(!u||u.length===0)return;let f,m,_;return u.forEach(y=>{let[T,{track:A,ssrcs:k}]=y;switch(T){case at.LocalVideoLowTrack:case at.LocalVideoTrack:if(T===at.LocalVideoTrack){const P=function(H,ne,re,ve,Oe,ke){const we=ne.videoSend.find(At=>At.ssrc===H);if(!we)return;const Be={},{sentFrame:lt,inputFrame:St}=we;if(ke&&(Qt(Be,to.QP_SUM,we.qpSumPerFrame),St&&lt)){const At=St.frameRate,Nn=lt.frameRate;Be[to.FREEZE]=function(kn,fr){let Xr=!0;return Xr=!(kn<=5)&&(kn<=10?fr<3:kn<=20?fr<4:fr<5),Xr}(At,Nn)?1:0}if(Oe){switch(lt&&(Qt(Be,to.HEIGHT,lt.height),Qt(Be,to.WIDTH,lt.width),Qt(Be,to.FRAME_RATE,lt.frameRate)),Be[to.DISABLED]=ve._originMediaStreamTrack&&!ve._originMediaStreamTrack.enabled||ve._mediaStreamTrack&&!ve._mediaStreamTrack.enabled?1:0,we.adaptionChangeReason){case"none":Be[to.ADAPTATION]=0;break;case"cpu":Be[to.ADAPTATION]=1;break;case"bandwidth":Be[to.ADAPTATION]=2;break;case"other":Be[to.ADAPTATION]=3}let At=0;we.adaptionChangeReason&&(At+=a3(we.adaptionChangeReason)),ne.qualityLimitationReason&&(At+=a3(ne.qualityLimitationReason)<<3),Be[to.ADAPTATION]=At,Be[to.PLAYER_STATUS]=hR[ve._player?ve._player.videoElementStatus:"uninit"],Qt(Be,to.NACKS,we.nacksCount),Qt(Be,to.PLIS,we.plisCount),Qt(Be,to.FIRS,we.firsCount),Qt(Be,to.AVG_ENCODE,we.avgEncodeMs),Qt(Be,to.HUGE_FRAME_SENT,we.hugeFramesSent),Qt(Be,to.BYTES_RETRANSMIT,we.retransmittedBytesSent),Qt(Be,to.PACKAGES_RETRANSMIT,we.retransmittedPacketsSent),Qt(Be,to.KEY_FRAMES_ENCODED,we.keyFramesEncoded);const Nn=re&&re.videoSend.find(kn=>kn.ssrc===H);if(Nn){let kn=Oe?Jd:Jd*Zd;Nn.timestamp&&we.timestamp&&(kn=we.timestamp-Nn.timestamp),Nn.packets!=null&&we.packets!=null&&Qt(Be,to.PACKAGE_RATE,1e3*(we.packets-Nn.packets)/kn),we.packetsLost!=null&&Nn.packetsLost!=null&&Qt(Be,to.PACKAGE_LOST,we.packetsLost-Nn.packetsLost),Nn.bytes!=null&&we.bytes!=null&&Qt(Be,to.BITRATE,8*(we.bytes-Nn.bytes)/kn)}}return Be}(k[0].ssrcId,n,r,A,i,c),q=A&&function(H,ne,re,ve){const Oe=ne.videoSend.find(we=>we.ssrc===H);if(!Oe)return null;const ke={};if(ve){const we=Oe.inputFrame,Be=we&&we.height||re.videoHeight||0,lt=we&&we.width||re.videoWidth||0,St=we&&we.frameRate||0;Qt(ke,Fy.HEIGHT,Be),Qt(ke,Fy.WIDTH,lt),Qt(ke,Fy.FRAME_RATE,St)}return ke}(k[0].ssrcId,n,A,i),j=function(H,ne){const re={};return ne&&(Qt(re,to.RETRANSMIT,H.bitrate.retransmit),Qt(re,to.TARGET_ENCODED,H.bitrate.targetEncoded),Qt(re,to.ACTUAL_ENCODED,H.bitrate.actualEncoded),Qt(re,to.TRANSMIT,H.bitrate.transmit),Qt(re,to.BANDWIDTH,H.sendBandwidth)),re}(n,i);m=Object.assign({},P,q,j)}else _=function(P,q,j,H){const ne=q.videoSend.find(ve=>ve.ssrc===P);if(!ne)return;const re={};if(H){const ve=ne.sentFrame;if(ve&&(Qt(re,qd.HEIGHT,ve.height),Qt(re,qd.WIDTH,ve.width),Qt(re,qd.FRAME_RATE,ve.frameRate)),j){const Oe=j.videoSend.find(ke=>ke.ssrc===P);if(Oe){let ke=Jd*Zd;Oe.timestamp&&ne.timestamp&&(ke=ne.timestamp-Oe.timestamp),Oe.packets!=null&&ne.packets!=null&&Qt(re,qd.PACKAGE_RATE,1e3*(ne.packets-Oe.packets)/ke),ne.packetsLost!=null&&Oe.packetsLost!=null&&Qt(re,qd.PACKAGE_LOST,ne.packetsLost-Oe.packetsLost),Oe.bytes!=null&&ne.bytes!=null&&Qt(re,qd.BITRATE,8*(ne.bytes-Oe.bytes)/ke)}}}return re}(k[0].ssrcId,n,r,i);break;case at.LocalAudioTrack:f=A&&function(P,q,j,H,ne){const re=q.audioSend.find(Oe=>Oe.ssrc===P);if(!re)return;const ve={};if(ne){ve[Gc.DISABLED]=H._originMediaStreamTrack&&!H._originMediaStreamTrack.enabled||H._mediaStreamTrack&&!H._mediaStreamTrack.enabled?1:0;const Oe=100*H._source.getAccurateVolumeLevel(),ke=re.inputLevel;if(ke!=null){const Be=Math.ceil(50*Math.log10(100*ke+1));Qt(ve,Gc.LEVEL,Be)}Qt(ve,o3.PCM_LEVEL,Oe),Qt(ve,Gc.AEC_RETURN_LOSS,re.aecReturnLoss),Qt(ve,Gc.AEC_RETURN_LOSS_ENH,re.aecReturnLossEnhancement),Qt(ve,Gc.BYTES_RETRANSMIT,re.retransmittedBytesSent),Qt(ve,Gc.PACKAGES_RETRANSMIT,re.retransmittedPacketsSent),ve[Gc.FREEZE]=0;const we=j&&j.audioSend.find(Be=>Be.ssrc===P);if(we){let Be=Jd*Zd;we.timestamp&&re.timestamp&&(Be=re.timestamp-we.timestamp),we.bytes!=null&&re.bytes!=null&&Qt(ve,Gc.BITRATE,8*(re.bytes-we.bytes)/Be),we.packets!=null&&re.packets!=null&&Qt(ve,Gc.PACKAGE_RATE,1e3*(re.packets-we.packets)/Be)}}return ve}(k[0].ssrcId,n,r,A,i)}}),{high:m,low:_,audio:f}}getInboundStats(n,r,i,c){if(!this.requestRemoteMedia)return;const u=this.requestRemoteMedia()||[],f=[];return u.forEach(m=>{let[_,y]=m;const T={peer:_.uid};if(y.has(kt.VIDEO)&&_.videoTrack){const A=_._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(_._videoSSRC)||!1,k=_.videoTrack?function(P,q,j,H,ne,re,ve,Oe){const ke=q.videoRecv.find(kn=>kn.ssrc===P);if(!ke)return;const we={},{receivedFrame:Be,outputFrame:lt,decodeFrameRate:St}=ke,At=j&&j.videoRecv.find(kn=>kn.ssrc===P);if(Qt(we,Xd.FRAME_RATE_DECODE,St),ke.framesRateFirefox&&Qt(we,no.FRAME_RATE,ke.framesRateFirefox),Be&&Qt(we,no.FRAME_RATE,Be.frameRate),Qt(we,no.FRAMES_DROPPED,ke.framesDroppedCount),Qt(we,no.BYTES_RETRANSMIT,ke.retransmittedBytesReceived),Qt(we,no.PACKAGES_RETRANSMIT,ke.retransmittedPacketsReceived),Qt(we,no.PACKAGES_DISCARDED,ke.packetsDiscarded),Qt(we,no.AVG_DECODE,ke.avgDecodeMs),Qt(we,no.AVG_PROCESSING_DELAY,ke.avgProcessingDelayMs),Qt(we,no.AVG_ASSEMBLY_TIME,ke.avgFramesAssembledFromMultiplePacketsMs),Qt(we,no.AVG_INTER_FRAME_DELAY,ke.avgInterFrameDelayMs),Qt(we,no.KEY_FRAMES_DECODED,ke.keyFramesDecoded),At){const kn=q.timestamp-j.timestamp||Jd*(Oe?Zd:ve?jy:1);ke.packetsLost!=null&&At.packetsLost!=null&&Qt(we,no.PACKAGE_LOST,ke.packetsLost-At.packetsLost),At.bytes!=null&&ke.bytes!=null&&Qt(we,no.BITRATE,8*(ke.bytes-At.bytes)/kn),At.packets!=null&&ke.packets!=null&&Qt(we,no.PACKAGE_RATE,1e3*(ke.packets-At.packets)/kn)}if(Oe&&(Qt(we,no.QP_SUM,ke.qpSumPerFrame),we[no.FREEZE]=ne&&Tv.isRemoteVideoFreeze(H,ke,At)?1:0),ve){var Nn;Be?(Qt(we,no.HEIGHT,Be.height),Qt(we,no.WIDTH,Be.width)):H&&(Qt(we,no.HEIGHT,H._videoHeight||0),Qt(we,no.WIDTH,H._videoWidth||0)),lt&&Qt(we,Xd.FRAME_RATE_OUTPUT,lt.frameRate);const kn=(Nn=H._player)===null||Nn===void 0?void 0:Nn.rendFrameRate.toFixed(0);if(kn&&Qt(we,Xd.FRAME_RATE_RENDER,+kn),Qt(we,no.JITTER_BUFFER,ke.jitterBufferMs),Qt(we,no.CURRENT_DELAY,ke.currentDelayMs),Qt(we,no.FIRS,ke.firsCount),Qt(we,no.NACKS,ke.nacksCount),Qt(we,no.PLIS,ke.plisCount),H){we[no.DISABLED]=H._originMediaStreamTrack.enabled&&H._mediaStreamTrack.enabled?0:1;const fr=H._player;if(fr){const{freezeTimeCounterList:Xr,renderFreezeAccTime:Wr,videoElementStatus:Ds}=fr;if(Xr&&Xr.length>0&&Qt(we,Xd.FREEZE_TIME,Xr.splice(0,1)[0]),re&&Nl.visibility==="visible"&&Ds===ts.PLAYING&&Bn().supportRequestVideoFrameCallback){const Ze=Math.min(6e3,Wr);fr.renderFreezeAccTime=Math.max(0,Wr-Ze),Qt(we,Xd.FREEZE_TIME_RENDER,Ze)}if(typeof ke.totalFreezesDuration=="number"){const Ze=At&&At.totalFreezesDuration?ke.totalFreezesDuration-At.totalFreezesDuration:ke.totalFreezesDuration;Qt(we,Xd.FREEZE_DURATION,1e3*Ze)}}}if(we[no.PLAYER_STATUS]=hR[H._player?H._player.videoElementStatus:"uninit"],At&&ke.totalInterFrameDelay!==void 0&&ke.totalSquaredInterFrameDelay!==void 0&&At.totalInterFrameDelay!==void 0&&At.totalSquaredInterFrameDelay!==void 0){const fr=ke.totalInterFrameDelay-At.totalInterFrameDelay,Xr=ke.totalSquaredInterFrameDelay-At.totalSquaredInterFrameDelay,Wr=ke.framesDecodeCount-At.framesDecodeCount,Ds=fr/Wr*1e3,Ze=Math.round(1e3*Math.sqrt((Xr-Math.pow(fr,2)/Wr)/Wr));!isNaN(Ze)&&Ds+Ze>Math.max(3*Ds,Ds+150)&&(we[no.I_FRAME_DELAY]=Ze)}}return we}(_._videoSSRC,n,r,_.videoTrack,A===!0,this.needUploadRenderFreezeTime,i,c):void 0;k&&(T.video=k)}if(y.has(kt.AUDIO)&&_.audioTrack){const A=_.audioTrack?function(k,P,q,j,H,ne){const re=P.audioRecv.find(we=>we.ssrc===k);if(!re)return;const ve={},Oe=q&&q.audioRecv.find(we=>we.ssrc===k);if(Qt(ve,Ns.JITTER,re.jitterMs),Qt(ve,Ns.BYTES_RETRANSMIT,re.retransmittedBytesReceived),Qt(ve,Ns.PACKAGES_RETRANSMIT,re.retransmittedPacketsReceived),Qt(ve,Ns.PACKAGES_DISCARDED,re.packetsDiscarded),Qt(ve,Ns.AVG_PROCESSING_DELAY,re.avgProcessingDelayMs),Oe){const we=P.timestamp-q.timestamp||Jd*(ne?Zd:H?jy:1);re.packets!=null&&Oe.packets!=null&&Qt(ve,Ns.PACKAGE_RATE,1e3*(re.packets-Oe.packets)/we),H&&Oe.bytes!=null&&re.bytes!=null&&Qt(ve,Ns.BITRATE,8*(re.bytes-Oe.bytes)/we),re.packetsLost!=null&&Oe.packetsLost!=null&&Qt(ve,Ns.PACKAGE_LOST,re.packetsLost-Oe.packetsLost)}if(ne){const{receivedFrames:we,droppedFrames:Be}=re;we!=null&&Be!=null&&(ve[Ns.FREEZE]=(ke=we)===0||100*Be/ke>20?1:0)}var ke;if(H){const we=100*j._source.getAccurateVolumeLevel(),Be=re.outputLevel;if(Be!=null){const lt=Math.ceil(50*Math.log10(100*Be+1));Qt(ve,s3.LEVEL,lt)}if(Qt(ve,Ns.PCM_LEVEL,we),j&&(ve[Ns.DISABLED]=j._originMediaStreamTrack.enabled&&j._mediaStreamTrack.enabled?0:1),Qt(ve,Ns.JITTER_BUFFER,re.jitterBufferMs),Qt(ve,Ns.CURRENT_DELAY,re.jitterBufferMs),ve[Ns.PLAYER_STATUS]=hR[As.getPlayerState(j.getTrackId())],Oe){const lt=re.concealedSamples-Oe.concealedSamples;lt>0&&Qt(ve,Ns.CONCEALED_SAMPLES,lt);const St=re.totalSamplesReceived-Oe.totalSamplesReceived;St>0&&Qt(ve,Ns.TOTAL_SAMPLES_RECEIVED,St)}}return ve}(_._audioSSRC,n,r,_.audioTrack,i,c):void 0;A&&(T.audio=A)}(T.video||T.audio)&&f.push(T)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,f}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const n=(this.requestAllTracks()||[]).find(r=>r instanceof uy);if(n&&n._external.getDenoiserStats){const r=n._external.getDenoiserStats();r&&this.requestUpload(fv.DENOISER_STATS,r)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(n=>{n.getProcessorStats().forEach(r=>{this.requestUpload&&this.requestUpload(r.type,r.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(n=>{let[r,i]=n;i.has(kt.VIDEO)&&r.videoTrack&&r.videoTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)}),i.has(kt.AUDIO)&&r.audioTrack&&r.audioTrack.getProcessorStats().forEach(c=>{this.requestUpload&&this.requestUpload(c.type,c.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const n=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const r=Date.now(),i={connectionInterval:de("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:r};let c=[];const u=this.requestAllTracks&&this.requestAllTracks()||[];for(const y of u)!y.muted&&y.enabled&&(c=c.concat(await y.getProcessorUsage()));const f=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[y,T]of f)T.has(kt.VIDEO)&&y.videoTrack&&(c=c.concat(await y.videoTrack.getProcessorUsage())),T.has(kt.AUDIO)&&y.audioTrack&&(c=c.concat(await y.audioTrack.getProcessorUsage()));if(c.length===0)return;i.details=function(y,T){const A={};for(const{id:j,value:H,level:ne,direction:re}of y){var k;const ve=(k=T.get(j))!==null&&k!==void 0?k:0,Oe=H===2?ve+de("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:ve;var P,q;T.set(j,Oe),A[j]?(H===2&&(A[j].value=H),ne>A[j].level&&(A[j].level=ne),re==="remote"&&(A[j].remoteUidCount+=1),A[j].totalTs=(P=T.get(j))!==null&&P!==void 0?P:0):A[j]={value:H,level:ne,remoteUidCount:re==="local"?0:1,totalTs:(q=T.get(j))!==null&&q!==void 0?q:0}}return Object.keys(A).map(j=>{const{level:H,value:ne,totalTs:re}=A[j];return{id:j,level:H,value:ne,totalTs:re}})}(c,n);const m=Date.now(),_=m>r?m:r+1;this.requestUpload&&this.requestUpload(fv.EXTENSION_USAGE_STATS,{usageStats:i,sendTs:_})},de("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const jce=de("ICE_RESTART_INTERVAL");let $y=new Map,rp=new Map,Mu=[zo.UDP_TCP_RELAY,zo.TCP_RELAY,zo.RELAY],oI=de("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Bn().supportPCSetConfiguration;function l3(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=$y.get(e.id);r&&(window.clearTimeout(r),$y.delete(e.id));const i=rp.get(e.id);n&&i&&i.index===Mu.length-1&&(x.debug("[".concat(e.id,"] reset ICE restart policy")),rp.delete(e.id))}function u3(e,n,r){if($y.size===0&&rp.size===0&&(Array.isArray(de("RESTART_SEQUENCE"))&&de("RESTART_SEQUENCE").length>0&&!function(m,_){if(m.length!==_.length)return!1;for(let y=0;y<m.length;y+=1){const T=m[y];if(m.filter(A=>A===T).length!==_.filter(A=>A===T).length)return!1}return!0}(Mu,de("RESTART_SEQUENCE"))&&(Mu=de("RESTART_SEQUENCE").filter(m=>{var _;if(gt(_=Object.values(zo)).call(_,m))return!0}),x.debug("use reconnection policy from config distribution, queues: ".concat(Mu.join(" => ")))),oI=de("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&Bn().supportPCSetConfiguration),Mu.length===0)return void r();let i,{index:c=0,type:u}=rp.get(e.id)||{};if(oI&&u===zo.RELAY)return void r();let f=u&&c>=Mu.length-1;if(oI)u=zo.RELAY;else{if(f)return void r();u?(c++,u=Mu[c]):(u=Mu[0],c=0)}x.debug("[".concat(e.id,"] choose ICE restart policy: ").concat(u,", index: ").concat(c)),n(u),rp.set(e.id,{index:c,type:u}),i=window.setTimeout(()=>u3(e,n,r),jce),$y.set(e.id,i)}var Tn;function d3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function zc(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?d3(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function h3(e){var n,r,i,c=2;for(typeof Symbol<"u"&&(r=Aw,i=Symbol.iterator);c--;){if(r&&(n=e[r])!=null)return n.call(e);if(i&&(n=e[i])!=null)return new Hy(n.call(e));r="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function Hy(e){function n(r){if(Object(r)!==r)return bt.reject(new TypeError(r+" is not an object."));var i=r.done;return bt.resolve(r.value).then(function(c){return{value:c,done:i}})}return Hy=function(r){this.s=r,this.n=r.next},Hy.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var i=this.s.return;return i===void 0?bt.resolve({value:r,done:!0}):n(i.apply(this.s,arguments))},throw:function(r){var i=this.s.return;return i===void 0?bt.reject(r):n(i.apply(this.s,arguments))}},new Hy(e)}let wv=(Tn=class extends Dr{get state(){return this._state}set state(e){const n=this._state;this._state=e,this.emit(Kt.StateChange,n,this._state)}constructor(e,n){super(),Q(this,"isPlanB",void 0),Q(this,"store",void 0),Q(this,"statsUploader",void 0),Q(this,"connection",void 0),Q(this,"localTrackMap",new Map),Q(this,"remoteUserMap",new Map),Q(this,"localDataChannels",[]),Q(this,"remoteDataChannelMap",new Map),Q(this,"pendingLocalTracks",[]),Q(this,"pendingRemoteTracks",[]),Q(this,"pendingLocalDataChannels",[]),Q(this,"pendingRemoteDataChannels",[]),Q(this,"statsCollector",void 0),Q(this,"shouldForwardP2PCreation",void 0),Q(this,"iceFailedCount",0),Q(this,"dtlsFailedCount",0),Q(this,"mutex",void 0),Q(this,"_state",qn.Disconnected),Q(this,"_pcStatsUploadType",de("NEW_ICE_RESTART")?Ll.FIRST_CONNECTION:Ll.OLD_FIRST_CONNECTION),Q(this,"_isStartRestartIce",!1),Q(this,"_restartTimer",void 0),Q(this,"_isTryConnecting",!1),Q(this,"_iceError",null),Q(this,"_forceTurn",!1),Q(this,"_isWaitPcToRePub",!1),Q(this,"handleMuteLocalTrack",async(r,i,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==qn.Connected)return void c(new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const f=this.filterTobeMutedTracks(r);if(f.length===0)return void i();const m=f.find(y=>y[0]==="videoLowTrack");m&&m[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(f.map(y=>{let[,{id:T}]=y;return T}));const _=this.createMuteMessage(f);await ur(this,Kt.RequestMuteLocal,_),i()}catch(f){c(f)}finally{u()}}),Q(this,"handleUnmuteLocalTrack",async(r,i,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==qn.Connected)return void c(new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const f=this.filterTobeUnmutedTracks(r);if(f.length===0)return void i();const m=f.find(y=>y[0]==="videoLowTrack");if(m){const y=m[1];if(y.track._originMediaStreamTrack.stop(),!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding){const T=r._mediaStreamTrack.clone();y.track._mediaStreamTrack=T,y.track._originMediaStreamTrack=T}else{const T=rI(r,iv(this,Kt.RequestLowStreamParameter));y.track._mediaStreamTrack=T,y.track._originMediaStreamTrack=T}await new bt((T,A)=>{this.handleReplaceTrack(y.track,T,A,!0)})}await this.connection.unmuteLocal(f.map(y=>{let[,{id:T}]=y;return T}));const _=this.createUnmuteMessage(f);await ur(this,Kt.RequestUnmuteLocal,_),i()}catch(f){c(f)}finally{u()}}),Q(this,"handleUpdateVideoEncoder",async(r,i,c,u)=>{let f;u||(f=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(at.LocalVideoTrack);if(!this.connection||!_||_.track!==r||this.state!==qn.Connected)return void i();const{id:y,track:T}=_;await this.connection.updateSendParameters(y,T),await this.connection.updateEncoderConfig(y,T),this.emit(Kt.UpdateVideoEncoder,T),i()}catch(_){c(_)}finally{var m;(m=f)===null||m===void 0||m()}}),Q(this,"handleUpdateVideoSendParameters",async(r,i,c)=>{const u=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const f=this.localTrackMap.get(at.LocalVideoTrack);if(!this.connection||!f||f.track!==r||this.state!==qn.Connected)return void i();const{id:m,track:_}=f;await this.connection.updateSendParameters(m,_),i()}catch(f){c(f)}finally{u()}}),Q(this,"handleReplaceMixingTrack",async(r,i,c,u)=>{if(!this.connection||this.state!==qn.Connected)return void i();const f=tI([r]);let m;x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(f.getTrackId(),"]")),typeof u=="boolean"&&u||(m=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(r,f),i()}catch(y){c(y)}finally{var _;(_=m)===null||_===void 0||_()}}),Q(this,"handleReplaceTrack",async(r,i,c,u)=>{let f;x.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof u=="boolean"&&u||(f=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var m;const y=Array.from(this.localTrackMap.entries()).find(T=>{let[,{track:A}]=T;return r===A});if(!this.connection||!y||this.state!==qn.Connected)return void i();if(await((m=this.connection)===null||m===void 0?void 0:m.replaceTrack(r,y[1].id)),this.isPlanB){const T=y[1];T.id=r._mediaStreamTrack.id,this.localTrackMap.set(y[0],T)}if(y[0]===at.LocalVideoTrack&&!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding){const T=this.localTrackMap.get(at.LocalVideoLowTrack);if(T){const A=r._mediaStreamTrack.clone();T.track._originMediaStreamTrack.stop(),T.track._mediaStreamTrack=A,T.track._originMediaStreamTrack=A,await new bt((k,P)=>{this.handleReplaceTrack(T.track,k,P,!0)})}}i()}catch(y){c(y)}finally{var _;(_=f)===null||_===void 0||_()}}),Q(this,"handleGetRTCStats",r=>{r(this.statsCollector.getRTCStats())}),Q(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),Q(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),Q(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),Q(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new c3(this.store),this.bindStatsUploaderEvents(),this.mutex=new Ko("P2PChannel-mutex",this.store.clientId),this.isPlanB=!Bn().supportUnifiedPlan||de("CHROME_FORCE_PLAN_B")&&Il(),this.shouldForwardP2PCreation=de("FORWARD_P2P_CREATION")&&Bn().supportPCSetConfiguration&&Bw(),this.shouldForwardP2PCreation&&(this.connection=Vy(this.store),this.emit(Kt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(e){var n;this.state=qn.New,this._forceTurn=n3(e),x.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const r=this.shouldForwardP2PCreation&&((n=this.connection)===null||n===void 0?void 0:n.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!r||(r&&this.connection&&(x.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=Vy(this.store,e),this.emit(Kt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new $e(oe.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=de("NEW_ICE_RESTART")?Ll.FIRST_CONNECTION:Ll.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e){if(!this.connection)throw new $e(oe.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");de("ENABLE_PREALLOC_PC")&&this.state===qn.Connected?await this.connection.updateRemoteConnect(e):(this.store.peerConnectionStart(),await this.connection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=qn.Connected)}updateRemoteRTPCapabilities(e){const n=Array.from(this.localTrackMap.entries()).filter(c=>{var u;let[f]=c;return gt(u=[at.LocalVideoLowTrack,at.LocalVideoTrack]).call(u,f)}),r=n.map(c=>{let[,{id:u}]=c;return u}),i=n.map(c=>{let[u]=c;return u});if(this.connection instanceof Kc){if(Bt.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(i),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!gt(e).call(e,this.store.codec)){const c=["vp9","vp8","h264"].find(u=>gt(e).call(e,u));c&&(this.store.codec=c,x.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(c,".")))}this.connection.updateRemoteRTPCapabilities(r,e)}}async getEstablishParams(){var e;if(this.connection instanceof Kc&&this.connection.peerConnectionState!=="closed"&&gt(e=[qn.New,qn.Connected]).call(e,this.state))return this.connection.establishPromise}async publishDataChannel(e){if(!this.connection||this.state!==qn.Connected){if(this.state===qn.Disconnected)throw new $e(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return e.forEach(r=>{var i;gt(i=this.pendingLocalDataChannels).call(i,r)||this.pendingLocalDataChannels.push(r)}),[]}const n=this.filterTobePublishedDataChannels(e);return n.length===0?[]:(n.forEach(r=>{const i=Date.now();this.store.publish(r.id.toString(),"datachannel",i)}),await this.connection.createDataChannels(this.store.uid,n),n.forEach(r=>{this.localDataChannels.push(r);const i=Date.now();this.store.publish(r.id+"","datachannel",void 0,i)}),e.map(r=>({streamId:r.id,ordered:r.ordered,maxRetransmits:r.maxRetransmits,metadata:r.metadata,channelId:r._originDataChannelId})))}publish(e,n,r){var i=this;return zi(function*(){const c=yield Ln(i.mutex.lock("From P2PChannel.publish"));try{var u;const f=i.connection&&gt(u=["disconnected","failed"]).call(u,i.connection.peerConnectionState);if(!i.connection||i.state!==qn.Connected||f){if(i.state===qn.Disconnected)throw new $e(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");i.throwIfTrackTypeNotMatch(e);const _=e.filter(y=>i.pendingLocalTracks.indexOf(y)===-1);return i.pendingLocalTracks=i.pendingLocalTracks.concat(_),void(f&&(i._isWaitPcToRePub=!0))}i.store.pubId=i.store.pubId+1,Yo.markPublishStart(i.store.clientId,i.store.pubId);const m=i.filterTobePublishedTracks(e,n,r);if(m.length===0)return void(yield Ln(i.tryToUnmuteAudio(e)));yield*UE(h3(i.doPublish(i.connection,m)))}finally{c()}})()}doPublish(e,n){var r=this;return zi(function*(){n.forEach(k=>{let{track:P,type:q}=k;const j=Date.now();r.store.publish(P.getTrackId(),q===at.LocalAudioTrack?"audio":"video",j)}),r.bindLocalTrackEvents(n);const i=n.map(k=>{let{track:P}=k;return P}),c=yield Ln(e.send(i,r.store.codec,r.store.audioCodec)),u=(yield Ln(c.next())).value,f=r.createGatewayPublishMessage(n,u);let m;try{m=yield f}catch(k){throw c.throw(k),(k==null?void 0:k.code)===oe.WS_ABORT&&n.forEach(P=>{let{track:q}=P;r.pendingLocalTracks.indexOf(q)===-1&&r.pendingLocalTracks.push(q)}),r.unbindLocalTrackEvents(n),k}const _=r.mapPubResToRemoteConfig(f,m,i),y=(yield Ln(c.next(_))).value;if(r.state===qn.Disconnected)throw new $e(oe.UNEXPECTED_ERROR,"PeerConnection already disconnected.");de("ENABLE_VIDEO_SEI");const T=de("ENABLE_ENCODED_TRANSFORM"),A=de("ENABLE_AUDIO_METADATA");i.forEach(async k=>{const P=k.getRTCRtpTransceiver();if(!P||!T)return;const{interceptLocalVideoFrame:q,interceptLocalAudioFrame:j}=ky();k.trackMediaType===kt.VIDEO?await q(P.sender,k):k.trackMediaType===kt.AUDIO&&await j(P.sender,{metadata:A?()=>{const H=k.metadata.shift();return H&&H.value}:void 0})}),n.forEach(k=>{let{type:P}=k;r.statsCollector.addLocalStats(P)}),r.assignLocalTracks(n,y),r.statsUploader.startUploadOutboundStats(),n.forEach(k=>{let{track:P,type:q}=k;const j=Date.now();r.store.publish(P.getTrackId(),q===at.LocalAudioTrack?"audio":"video",void 0,j)})})()}async updateVideoStreamParameter(e,n){const r=this.localTrackMap.get(n);if(!r||!this.connection)return;if(!(r.track instanceof Sr))return x.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:i}=r,c=function(u,f){const m={};return u.height&&u.width&&(m.scaleResolutionDownBy=FR(u,f)),m.maxFramerate=u.framerate?ii(u.framerate):void 0,m.maxBitrate=u.bitrate?1e3*u.bitrate:void 0,m}(e,i);if(i._encoderConfig||(i._encoderConfig={}),n!==at.LocalVideoLowTrack||!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding)c.scaleResolutionDownBy!=null&&(i._encoderConfig.scaleResolutionDownBy=c.scaleResolutionDownBy);else{const u=i._originMediaStreamTrack;if(!u.canvas)return x.warn("[".concat(i.getTrackId(),"] no canvas on track"));(function(f,m){const _=f.canvas;m.width&&(_.width=ii(m.width)),m.height&&(_.height=ii(m.height)),m.framerate&&(_.stopCapture&&_.stopCapture(),_.stopCapture=pR(()=>{!_.startCapture&&_.stopCapture&&_.stopCapture(),_.startCapture&&_.startCapture()},ii(m.framerate)))})(u,e)}c.maxBitrate!=null&&(i._encoderConfig.bitrateMax=c.maxBitrate/1e3),c.maxFramerate!=null&&(i._encoderConfig.frameRate&&typeof i._encoderConfig.frameRate=="object"?i._encoderConfig.frameRate.max=c.maxFramerate:i._encoderConfig.frameRate={max:c.maxFramerate}),x.debug("[".concat(i.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(i._encoderConfig))),await this.connection.updateRtpSenderEncodings(i)}publishLowStream(e){var n=this;return zi(function*(){if(!n.connection||n.state!==qn.Connected)return;const r=yield Ln(n.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const c=n.localTrackMap.get(at.LocalVideoTrack);if(!c)throw new $e(oe.UNEXPECTED_ERROR,"Could not find high stream");if(n.localTrackMap.has(at.LocalVideoLowTrack))throw new $e(oe.UNEXPECTED_ERROR,"[".concat(n.store.clientId,"] Can't publish low stream when stream already publish"));const u=[{track:n.getLowVideoTrack(c.track,e),type:at.LocalVideoLowTrack}];if(yield*UE(h3(n.doPublish(n.connection,u))),c.track.muted||!c.track.enabled){var i;const f=(i=n.localTrackMap.get(at.LocalVideoLowTrack))===null||i===void 0?void 0:i.id;f!==void 0&&(yield Ln(n.connection.muteLocal([f])))}}finally{r()}})()}async republish(){this.pendingLocalTracks.length>0&&(x.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Bo(this,Kt.RequestRePublish,this.pendingLocalTracks),this.emit(Kt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(x.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await Bo(this,Kt.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(e){for(let n=this.pendingRemoteTracks.length-1;n>=0;n--){const{user:r,kind:i}=this.pendingRemoteTracks[n];(i!==kt.AUDIO||r._audio_added_&&r._audioSSRC)&&(i!==kt.VIDEO||r._video_added_&&r._videoSSRC)||this.pendingRemoteTracks.splice(n,1)}if(e)await Bo(this,Kt.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:n,kind:r}of this.pendingRemoteTracks)await this.subscribe(n,r,r===kt.VIDEO?n._videoSSRC:n._audioSSRC);this.pendingRemoteTracks.forEach(n=>{let{user:r}=n;this.emit(Kt.MediaReconnectEnd,r.uid)}),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==qn.Connected)return void e.forEach(i=>{const c=this.pendingLocalTracks.indexOf(i);c!==-1&&this.pendingLocalTracks.splice(c,1)});const n=this.filterTobeUnpublishedTracks(e);if(n.length===0)return;const r=n.find(i=>i[0]==="videoLowTrack");return r&&r[1].track.close(),this.doUnpublish(this.connection,n)}async unpublishDataChannel(e){if(!this.connection||this.state!==qn.Connected)return void e.forEach(r=>{const i=this.pendingLocalDataChannels.indexOf(r);i!==-1&&this.pendingLocalDataChannels.splice(i,1)});const n=this.filterTobeUnpublishedDataChannels(e);return n.length!==0?(n.forEach(r=>{const i=this.localDataChannels.indexOf(r);i!==-1&&this.localDataChannels.splice(i,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),n.map(r=>r.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==qn.Connected)return;const e=this.localTrackMap.get(at.LocalVideoLowTrack);if(!e)return;e.track.close();const n=[[at.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,n)}async doUnpublish(e,n){const r=this.createGatewayUnpublishMessage(n);return await e.stopSending(n.map(i=>{let[,{id:c}]=i;return c})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(i=>{let[c,{track:u}]=i;return{type:c,track:u}})),n.forEach(i=>{let[c]=i;this.statsCollector.removeLocalStats(c)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),r}async subscribeDataChannel(e,n){if(!this.connection||this.state!==qn.Connected)throw new $e(oe.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const r=n.filter(i=>{var c;return!((c=this.remoteDataChannelMap.get(e))!==null&&c!==void 0&&c.get(i.id))});if(r.length!==0)return await this.connection.createDataChannels(e.uid,r),r.forEach(i=>{var c;this.remoteDataChannelMap.has(e)?(c=this.remoteDataChannelMap.get(e))===null||c===void 0||c.set(i.id,i):this.remoteDataChannelMap.set(e,new Map([[i.id,i]]));const u=this.pendingRemoteDataChannels.findIndex(f=>{let{user:m,id:_}=f;return m.uid===e.uid&&_===i.id});u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),r.map(i=>i.id)}async subscribe(e,n,r,i,c){var u;if(!this.connection||this.state!==qn.Connected)throw new $e(oe.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((u=this.remoteUserMap.get(e))!==null&&u!==void 0&&u.has(n))return;let f,m,_;const y=this.connection.getPreMedia(r);if(y)x.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(r,", no need to send sub to gateway.")),_=y.transceiver,f=y.track,m=y.id;else if(c){const k=c.find(q=>{let{stream_type:j}=q;return j===n});if(!k)throw new $e(oe.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(n," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(n,"."));const P=await this.connection.receive(n,k.ssrcs,String(e._uintid),k.attributes);this.connection instanceof Kc&&(_=P.transceiver),f=P.track,m=P.id}else{const k=await this.connection.receive(n,[{ssrcId:r,rtx:i}],String(e._uintid),void 0);this.connection instanceof Kc&&(_=k.transceiver),f=k.track,m=k.id}if(n===kt.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(f):(e._audioTrack=new Wf(f,e.uid,e._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),_&&e._audioTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(f):(e._videoTrack=new Hf(f,e.uid,e._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),_&&e._videoTrack._updateRtpTransceiver(_),this.bindRemoteTrackEvents(e,e._videoTrack)),_&&de("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:k,interceptRemoteAudioFrame:P}=ky();n==kt.VIDEO?await k(_.receiver,{onSei:de("ENABLE_VIDEO_SEI")&&(q=>{var j;return(j=e._videoTrack)===null||j===void 0?void 0:j._onSei(q)})}):n==kt.AUDIO&&await P(_.receiver,{enableTopn:!!de("ENABLE_AUDIO_TOPN"),enableMetadata:!!de("ENABLE_AUDIO_METADATA"),onMetadata:q=>{this.safeEmit(Kt.AudioMetadata,q)}})}const T=this.remoteUserMap.get(e);T?T.set(n,m):this.remoteUserMap.set(e,new Map([[n,m]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const A=this.pendingRemoteTracks.findIndex(k=>{let{user:P,kind:q}=k;return P.uid===e.uid&&n===q});A!==-1&&(this.pendingRemoteTracks.splice(A,1),this.emit(Kt.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==qn.Connected)throw new $e(oe.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter(c=>{var u;let{user:f,mediaType:m}=c;return!((u=this.remoteUserMap.get(f))!==null&&u!==void 0&&u.has(m))});const n=[],r=new Map;e.forEach(c=>{if(!this.connection)return;const u=this.connection.getPreMedia(c.ssrcId);u?r.set(c.ssrcId,u):n.push(c)});const i=await this.connection.batchReceive(n.map(c=>{let{user:u,mediaType:f,ssrcId:m,rtxSsrcId:_}=c;return{kind:f,ssrcMsg:[{ssrcId:m,rtx:_}],mslabel:String(u._uintid)}}));n.forEach((c,u)=>{r.set(c.ssrcId,i[u])});for(const{user:c,mediaType:u,ssrcId:f}of e){const m=r.get(f);if(!m)return void x.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(c.uid," subscribe data,").concat(u,", ").concat(f));const{track:_,id:y,transceiver:T}=m;if(T&&de("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:P,interceptRemoteAudioFrame:q}=ky();u==kt.VIDEO?await P(T.receiver,{onSei:de("ENABLE_VIDEO_SEI")&&(j=>{var H;return(H=c._videoTrack)===null||H===void 0?void 0:H._onSei(j)})}):u==kt.AUDIO&&await q(T.receiver,{enableTopn:!!de("ENABLE_AUDIO_TOPN"),enableMetadata:!!de("ENABLE_AUDIO_METADATA"),onMetadata:j=>{this.safeEmit(Kt.AudioMetadata,j)}})}if(u===kt.AUDIO?(c._audioTrack?c._audioTrack._updateOriginMediaStreamTrack(_):(c._audioTrack=new Wf(_,c.uid,c._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(c._audioTrack.getTrackId()))),T&&c._audioTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(c,c._audioTrack)):(c._videoTrack?c._videoTrack._updateOriginMediaStreamTrack(_):(c._videoTrack=new Hf(_,c.uid,c._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(c._videoTrack.getTrackId()))),T&&c._videoTrack._updateRtpTransceiver(T),this.bindRemoteTrackEvents(c,c._videoTrack)),de("ENABLE_VIDEO_SEI")&&T){const{interceptRemoteVideoFrame:P,interceptRemoteAudioFrame:q}=ky();u==kt.VIDEO?await P(T.receiver,{onSei:j=>{var H;(H=c._videoTrack)===null||H===void 0||H._onSei(j)}}):u==kt.AUDIO&&await q(T.receiver)}const A=this.remoteUserMap.get(c);A?A.set(u,y):this.remoteUserMap.set(c,new Map([[u,y]])),this.statsCollector.addRemoteStats(c.uid),this.statsUploader.startUploadInboundStats();const k=this.pendingRemoteTracks.findIndex(P=>{let{user:q,kind:j}=P;return q.uid===c.uid&&u===j});k!==-1&&(this.pendingRemoteTracks.splice(k,1),this.emit(Kt.MediaReconnectEnd,c.uid))}}async unsubscribe(e,n,r){const i=this.pendingRemoteTracks.filter(f=>{let{user:m,kind:_}=f;return n!==void 0?m.uid===e.uid&&n===_:m.uid===e.uid});if(i.forEach(f=>{const m=this.pendingRemoteTracks.indexOf(f);this.pendingRemoteTracks.splice(m,1)}),this.connection&&this.state===qn.Connected||r||i.forEach(f=>{let{kind:m}=f;var _;if(m===kt.AUDIO)(_=e._audioTrack)===null||_===void 0||_._destroy(),e._audioTrack=void 0;else if(m===kt.VIDEO){var y;(y=e._videoTrack)===null||y===void 0||y._destroy(),e._videoTrack=void 0}}),!this.connection||this.state!==qn.Connected)return;const c=this.filterTobeUnSubscribedTracks(e,n);if(c.length===0)return;await this.connection.stopReceiving(c.map(f=>{let[,{id:m}]=f;return m}));const u=this.createUnsubscribeMessage(c);return this.withdrawRemoteTracks(c),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),c.forEach(f=>{let[m,{kind:_}]=f;var y,T;if(_===kt.VIDEO&&m._videoSSRC&&((y=this.connection)===null||y===void 0||y.setStatsRemoteVideoIsReady(m._videoSSRC,!1)),_===kt.VIDEO)this.unbindRemoteTrackEvents(m._videoTrack),r||((T=m._videoTrack)===null||T===void 0||T._destroy(),m._videoTrack=void 0);else if(_===kt.AUDIO){var A;this.unbindRemoteTrackEvents(m._audioTrack),!r&&((A=m._audioTrack)===null||A===void 0||A._destroy(),m._audioTrack=void 0)}}),u}async unsubscribeDataChannel(e,n){if(n.forEach(c=>{const u=this.pendingRemoteDataChannels.findIndex(f=>f.id===c.id);u!==-1&&this.pendingRemoteDataChannels.splice(u,1)}),!this.connection)return;const r=this.filterTobeUnSubscribedDataChannels(e,n);if(r.length===0)return;n.forEach(c=>{c._close()});const i=this.remoteDataChannelMap.get(e);return r.forEach(c=>{i&&i.delete(c.id)}),i&&i.size===0&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),r.map(c=>c.id)}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let n=[];for(const{user:c,mediaType:u}of e){const f=this.pendingRemoteTracks.filter(m=>{let{user:_,kind:y}=m;return u!==void 0?_.uid===c.uid&&u===y:_.uid===c.uid});f.forEach(m=>{const _=this.pendingRemoteTracks.indexOf(m);this.pendingRemoteTracks.splice(_,1)}),n=n.concat(f)}if(!this.connection||this.state!==qn.Connected)return void n.forEach(c=>{let{user:u,kind:f}=c;var m;if(f===kt.AUDIO)(m=u._audioTrack)===null||m===void 0||m._destroy(),u._audioTrack=void 0;else if(f===kt.VIDEO){var _;(_=u._videoTrack)===null||_===void 0||_._destroy(),u._videoTrack=void 0}});const r=qa(e).call(e,(c,u)=>{let{user:f,mediaType:m}=u;const _=this.filterTobeUnSubscribedTracks(f,m);return c.concat(_)},[]);if(r.length===0)return;await this.connection.stopReceiving(r.map(c=>{let[,{id:u}]=c;return u}));const i=this.createUnsubscribeAllMessage(r);return this.withdrawRemoteTracks(r),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),r.forEach(c=>{let[u,{kind:f}]=c;var m,_;if(f===kt.VIDEO&&u._videoSSRC&&((m=this.connection)===null||m===void 0||m.setStatsRemoteVideoIsReady(u._videoSSRC,!1)),f===kt.VIDEO)this.unbindRemoteTrackEvents(u._videoTrack),(_=u._videoTrack)===null||_===void 0||_._destroy(),u._videoTrack=void 0;else if(f===kt.AUDIO){var y;this.unbindRemoteTrackEvents(u._audioTrack),(y=u._audioTrack)===null||y===void 0||y._destroy(),u._audioTrack=void 0}}),i}isPreSubScribe(e){return!this.connection||this.state!==qn.Connected?!1:!!this.connection.getPreMedia(e)}async muteRemote(e,n){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void x.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(n))return void x.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."));const i=n===kt.VIDEO?e._videoSSRC:e._audioSSRC;i!==void 0&&this.connection.setStatsRemoteVideoIsReady(i,!1)}async unmuteRemote(e,n){return this.unmuteRemoteNoLock(e,n)}async unmuteRemoteNoLock(e,n){if(!this.connection)return;const r=this.remoteUserMap.get(e);if(!r)return void x.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(n)||x.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."))}addAudioMetadata(e){const n=this.localTrackMap.get(at.LocalAudioTrack),r=n&&n.track;r&&r.metadata.push(e)}getAllTracks(e){const n=this.localTrackMap.get(at.LocalAudioTrack);if((n==null?void 0:n.track)instanceof ho){const r=n.track;return Array.from(this.localTrackMap.entries()).filter(i=>{let[c]=i;return c!==at.LocalAudioTrack}).filter(i=>{let[c]=i;return!(e&&c===at.LocalVideoLowTrack)}).map(i=>{let[,{track:c}]=i;return c}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[i]=r;return!(e&&i===at.LocalVideoLowTrack)}).map(r=>{let[,{track:i}]=r;return i})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,n,r,i,c){if(e){const f=this.localTrackMap.get(at.LocalAudioTrack),m=i?this.localTrackMap.get(at.LocalVideoLowTrack):this.localTrackMap.get(at.LocalVideoTrack);Bt.publish(this.store.sessionId,{eventElapse:Yo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(hr.SCREEN_TRACK))!==-1,audio:!!f,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}else{var u;r||(r=[]);const f=r.find(_=>_ instanceof Hr),m=i?(u=this.localTrackMap.get(at.LocalVideoTrack))===null||u===void 0?void 0:u.track:r.find(_=>_ instanceof Sr);Bt.publish(this.store.sessionId,{eventElapse:Yo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:f==null?void 0:f.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(hr.SCREEN_TRACK))!==-1,audio:!!f,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}}reportSubscribeEvent(e,n,r,i){const c=i===kt.VIDEO?r._videoSSRC:r._audioSSRC;c&&Bt.subscribe(this.store.sessionId,{succ:e,ec:n,video:i===kt.VIDEO,audio:i===kt.AUDIO,peerid:r.uid,subscribeRequestid:c,p2pid:this.store.p2pId,eventElapse:Yo.measureFromSubscribeStart(this.store.clientId,c),preSsrc:this.isPreSubScribe(c)})}reset(){x.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new Ko("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=Vy(this.store),this.emit(Kt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(at.LocalAudioTrack);if((e==null?void 0:e.track)instanceof ho){if(e.track.trackList.length>0){const n=e.track;e.track.trackList.forEach(r=>{n.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=qn.Disconnected}getStats(){var e;return(e=this.connection)===null||e===void 0?void 0:e.getStats()}getRemoteVideoIsReady(e){var n;return((n=this.connection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(at.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(at.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const n=this.localTrackMap.get(e);return n&&n.track instanceof Sr||n&&n.track instanceof Hr?n.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,n){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!n||r.has(n))}async hasRemoteMediaWithLock(e,n){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!n||r.has(n))}getRemoteMedia(e){var n;const r=Array.from(Ii(n=this.remoteUserMap).call(n)).find(i=>i.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[i]=r;return{uid:i.uid,level:i.audioTrack?100*i.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(at.LocalAudioTrack);return n&&e.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Hm(e).call(e,(r,i)=>r.level-i.level),e}async disconnectForReconnect(){this.connection&&(x.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=qn.Reconnecting,de("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n]=e;var r;n._videoTrack&&n._videoTrack._player&&((r=n._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=Vy(this.store),this.emit(Kt.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var n;let[r,{track:i}]=e;switch(r){case at.LocalVideoTrack:gt(n=i._hints).call(n,hr.LOW_STREAM)?i.close():this.pendingLocalTracks.push(i);break;case at.LocalAudioTrack:i instanceof ho?this.pendingLocalTracks=this.pendingLocalTracks.concat(i.trackList):this.pendingLocalTracks.push(i);case at.LocalVideoLowTrack:}}),this.emit(Kt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,r]=e;Array.from(Ii(r).call(r)).forEach(i=>{this.setPendingRemoteMedia(n,i)}),this.emit(Kt.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(e=>{this.pendingLocalDataChannels.push(e)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(e=>{let[n,r]=e;Array.from(Ii(r).call(r)).forEach(i=>{this.setPendingRemoteDataChannel(n,i)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),x.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,n){for(const r of this.pendingRemoteDataChannels){const{user:i,id:c}=r;if((e instanceof Lu?e.uid:e)===i.uid&&c===n)return!0}return!1}setPendingRemoteDataChannel(e,n){this.hasPendingRemoteDataChannel(e,n)||this.pendingRemoteDataChannels.push({user:e,id:n})}hasPendingRemoteMedia(e,n){for(const r of this.pendingRemoteTracks){const{user:i,kind:c}=r;if((e instanceof Lu?e.uid:e)===i.uid&&n===c)return!0}return!1}setPendingRemoteMedia(e,n){this.hasPendingRemoteMedia(e,n)||this.pendingRemoteTracks.push({user:e,kind:n})}restartICE(e){var n=this;return zi(function*(){if(!n.connection||n.state!==qn.Connected)return;const r=yield Ln(n.mutex.lock("From P2PChannel.restartICE"));let i;try{i=yield Ln(n.connection.restartICE(e));const u=yield Ln(i.next());if(u.done)return;const f=u.value,m=yield f;switch(nI(n.connection)&&n.reportPCStats(Date.now(),!1,n._pcStatsUploadType),e){case zo.UDP_TCP_RELAY:n._pcStatsUploadType=Ll.UDP_TCP_RESTART;break;case zo.TCP_RELAY:n._pcStatsUploadType=Ll.TCP_RESTART;break;case zo.RELAY:n._pcStatsUploadType=Ll.RELAY_RESTART;break;default:n._pcStatsUploadType=Ll.OLD_RESTART}n._isTryConnecting=!0,i.next(m)}catch(u){var c;(c=i)===null||c===void 0||c.throw(u)}finally{r()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),n=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalAudioTrack),i=e.videoSend.find(P=>P.ssrc===(n==null?void 0:n.ssrcs[0].ssrcId)),c=e.audioSend.find(P=>P.ssrc===(r==null?void 0:r.ssrcs[0].ssrcId));if(!i||!c)return 1;const u=wi(this,Kt.NeedSignalRTT),f=i?i.rttMs:void 0,m=c?c.rttMs:void 0,_=f&&m?(f+m)/2:f||m,y=(_&&u?(_+u)/2:_||u)||0,T=100*e.sendPacketLossRate*.7/50+.3*y/1500,A=T<.17?1:T<.36?2:T<.59?3:T<.1?4:5,k=n==null?void 0:n.track;if(k&&k._encoderConfig&&k._hints.indexOf(hr.SCREEN_TRACK)===-1){const P=k._encoderConfig.bitrateMax,q=e.bitrate.actualEncoded;if(P&&q){const j=(1e3*P-q)/(1e3*P);return GF[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[i]=r;const c=i._audioSSRC,u=i._videoSSRC,f=e.audioRecv.find(q=>q.ssrc===c),m=e.videoRecv.find(q=>q.ssrc===u);if(!f&&!m)return void(n+=1);const _=wi(this,Kt.NeedSignalRTT),y=e.rtt,T=(y&&_?(y+_)/2:y||_)||0,A=f?f.jitterMs:void 0,k=e.recvPacketLossRate;let P=.7*k*100/50+.3*T/1500;A&&(P=.6*k*100/50+.2*T/1500+.2*A/400),n+=P<.1?1:P<.17?2:P<.36?3:P<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(e){return new bt((n,r)=>{this.handleMuteLocalTrack(e,n,r)})}async replaceTrack(e,n){var r;if(x.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(e.getTrackId(),"] to [").concat(n.getTrackId(),"]")),!this.connection||this.state!==qn.Connected)return;const i=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:f}]=u;return e===f});if(!i)return;const c=i[0];if(e!==n&&(this.unbindLocalTrackEvents([{track:e,type:c}]),this.bindLocalTrackEvents([{track:n,type:c}]),i[1].track=n),await((r=this.connection)===null||r===void 0?void 0:r.replaceTrack(n,i[1].id)),this.isPlanB){const u=i[1];u.id=n._mediaStreamTrack.id,this.localTrackMap.set(c,u)}if(c===at.LocalVideoTrack&&!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding){const u=this.localTrackMap.get(at.LocalVideoLowTrack);if(u){const f=e._mediaStreamTrack.clone();u.track._originMediaStreamTrack.stop(),u.track._mediaStreamTrack=f,u.track._originMediaStreamTrack=f,await new bt((m,_)=>{this.handleReplaceTrack(u.track,m,_,!0)})}}}filterTobePublishedTracks(e,n,r){const i=[],c=this.getAllTracks();e=Nf(e=e.filter(_=>c.indexOf(_)===-1));let u,f=!1;const m=this.localTrackMap.get(at.LocalAudioTrack);for(const _ of e){if(_ instanceof Sr&&(this.localTrackMap.has(at.LocalVideoTrack)||f?new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(i.push({track:_,type:at.LocalVideoTrack}),f=!0),n)){const y=this.getLowVideoTrack(_,r);i.push({track:y,type:at.LocalVideoLowTrack})}if(_ instanceof Hr)if(m){const y=m.track;if(y instanceof ho)eI([_]),y.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0);else{const T=tI([y,_]);x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(T.getTrackId(),"]")),this.replaceTrack(y,T)}}else u instanceof ho?(eI([_]),u.addAudioTrack(_)):u||!_._useAudioElement&&Bn().webAudioMediaStreamDest&&!_._bypassWebAudio?u=tI(u?[_,u]:[_]):u=_}return u&&(x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(u.getTrackId(),"]")),i.push({track:u,type:at.LocalAudioTrack})),i}filterTobeUnpublishedTracks(e){const n=[],r=this.getAllTracks();e=Nf(e=e.filter(i=>r.indexOf(i)!==-1));for(const i of e){if(i instanceof Hr){const c=this.localTrackMap.get(at.LocalAudioTrack);if(!c)continue;c.track instanceof ho?(c.track.removeAudioTrack(i),this.unbindLocalAudioTrackEvents(i),c.track.trackList.length===0&&(n.push([at.LocalAudioTrack,c]),c.track.close())):n.push([at.LocalAudioTrack,c])}if(i instanceof Sr){const c=this.localTrackMap.get(at.LocalVideoTrack);if(!c)continue;n.push([at.LocalVideoTrack,c]);const u=this.localTrackMap.get(at.LocalVideoLowTrack);u&&n.push([at.LocalVideoLowTrack,u])}}return n}filterTobePublishedDataChannels(e){return e=(e=Nf(e)).filter(n=>this.localDataChannels.findIndex(r=>r.id===n.id)===-1)}filterTobeUnpublishedDataChannels(e){return e=(e=(e=Nf(e)).filter(n=>this.localDataChannels.indexOf(n)!==-1)).filter(n=>n._originDataChannel)}bindLocalTrackEvents(e){e.forEach(n=>{let{track:r,type:i}=n;switch(i){case at.LocalVideoTrack:r.addListener(Pt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(Pt.GET_RTC_STATS,this.handleGetRTCStats),r.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Pt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(Pt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,n){e instanceof ho?e.trackList.forEach(r=>{r.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Pt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Pt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||(e.addListener(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(Pt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(n=>{let[r,{track:i}]=n;return{track:i,type:r}})),e.forEach(n=>{let{track:r,type:i}=n;switch(i){case at.LocalVideoTrack:r.off(Pt.GET_STATS,this.handleGetLocalVideoStats),r.off(Pt.GET_RTC_STATS,this.handleGetRTCStats),r.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Pt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(Pt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof ho?e.trackList.forEach(n=>{n.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Pt.GET_STATS,this.handleGetLocalAudioStats),n.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Pt.GET_STATS,this.handleGetLocalAudioStats),e.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Pt.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),e.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,n){n instanceof Hf&&n.addListener(Pt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),n instanceof Wf&&n.addListener(Pt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Pt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,r]=e;r.has(kt.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),r.has(kt.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(e,n){return e.map((r,i)=>{var c;let u,f,{track:m,type:_}=r;switch(_){case at.LocalAudioTrack:u=Jn.Audio,f={dtx:m instanceof uy&&m._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case at.LocalVideoTrack:u=gt(c=m._hints).call(c,hr.SCREEN_TRACK)?Jn.Screen:Jn.High,f=zc(zc({},uB(m)),{},{codec:this.store.codec,svc_mode:Ry()});break;case at.LocalVideoLowTrack:u=Jn.Low,f=zc(zc({},uB(m)),{},{codec:this.store.codec,svc_mode:Ry()})}return{stream_type:u,attributes:f,ssrcs:n[i]}})}createGatewayUnpublishMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}assignLocalTracks(e,n){e.forEach((r,i)=>{let{track:c,type:u}=r;this.localTrackMap.set(u,{track:c,id:n[i].id,ssrcs:n[i].localSSRC})})}withdrawLocalTracks(e){e.forEach(n=>{let[r]=n;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async n=>{if(x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(n,")")),this.emit(Kt.PeerConnectionStateChange,n),n==="connecting"&&e instanceof Kc&&!Ur()&&de("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{n==="connecting"&&e.extendCandidate()},de("FIRST_TCP_CANDIDATE_INTERVAL")),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),e instanceof Kc&&l3(e,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=Ll.DISCONNECTED_OR_FAILED,wi(this,Kt.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const r=this.pendingLocalTracks.map(c=>c.getTrackId()),i=this.pendingLocalDataChannels.map(c=>"dc_".concat(c.id));Bt.reportApiInvoke(this.store.sessionId,{name:oo.REPUB_AFTER_PC_CONNECTED,options:r.concat(i),tag:Fr.TRACER}).onSuccess(),this.republish()}if(de("NEW_ICE_RESTART")&&e instanceof Kc&&!Ur()&&!this._forceTurn){if(gt(rB).call(rB,n)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const r=c=>{nI(e)&&(x.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(c)),wi(this,Kt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Kt.RequestRestartICE,c))},i=()=>{nI(e)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),x.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Kt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{u3(e,r,i)},800))}}else{if(n==="disconnected"&&e.iceConnectionState==="disconnected")return setTimeout(()=>{e.iceConnectionState==="disconnected"&&de("ICE_RESTART")&&wi(this,Kt.QueryClientConnectionState)==="CONNECTED"&&this.emit(Kt.RequestRestartICE)},800),void setTimeout(()=>{e.peerConnectionState==="disconnected"&&(x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(Kt.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);n==="failed"&&(x.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(Kt.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),Bt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Fr.TRACER}).onSuccess(),this.emit(Kt.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(u=>u._audioSSRC===n);var c;i&&(this.store.subscribe(i.uid,"audio",void 0,void 0,void 0,Date.now()),(c=i.audioTrack)===null||c===void 0||c.emit(Vf.FIRST_FRAME_DECODED),Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_AUDIO_DECODE,Nr.FIRST_AUDIO_DECODE,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(c=>c._audioSSRC===n);i&&Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_AUDIO_RECEIVED,Nr.FIRST_AUDIO_RECEIVED,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,r,i)=>{this.reportVideoFirstFrameDecoded(n,r,i)},e.onFirstVideoReceived=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(c=>c._videoSSRC===n);i&&Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_VIDEO_RECEIVED,Nr.FIRST_VIDEO_RECEIVED,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,r)=>{const i=n.candidateType==="relay",c=r.candidateType==="relay";r.candidateType!=="unknown"&&i===c||this.emit(Kt.ConnectionTypeChange,i),x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(ku(r))," -> ").concat(JSON.stringify(ku(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,r)=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(ku(r))," -> ").concat(JSON.stringify(ku(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},e.getLocalVideoStats=()=>{const n=this.statsCollector.getLocalVideoTrackStats(),r=this.statsCollector.getRTCStats();return zc(zc({},n),r)},e.onICECandidateError=n=>{this._iceError=n}}resetConnection(e){e instanceof Kc&&function(n){rp.delete(n.id),l3(n)}(e),e.close(),this.emit(Kt.PeerConnectionStateChange,"closed"),function(n){n.onConnectionStateChange=void 0,n.onICEConnectionStateChange=void 0,n.onICETransportStateChange=void 0,n.onDTLSTransportStateChange=void 0,n.onDTLSTransportError=void 0,n.onFirstAudioDecoded=void 0,n.onFirstAudioReceived=void 0,n.onFirstVideoDecoded=void 0,n.onFirstVideoReceived=void 0,n.onSelectedLocalCandidateChanged=void 0,n.onSelectedRemoteCandidateChanged=void 0,n.onFirstVideoDecodedTimeout=void 0,n.getLocalVideoStats=void 0}(e),this._isWaitPcToRePub=!1}filterTobeMutedTracks(e){const n=[];if(this.getAllTracks().indexOf(e)===-1)return n;const r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof Hr&&(r==null?void 0:r.track)instanceof ho)return r.track.isActive||n.push([at.LocalAudioTrack,r]),n;const i=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return e===u});if(i&&(n.push(i),i[0]===at.LocalVideoTrack)){const c=this.localTrackMap.get(at.LocalVideoLowTrack);c&&n.push([at.LocalVideoLowTrack,c])}return n}filterTobeUnmutedTracks(e){const n=[],r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof Hr&&(r==null?void 0:r.track)instanceof ho)return r.track.isActive&&n.push([at.LocalAudioTrack,r]),n;const i=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return e===u});if(i)if(i[0]===at.LocalVideoTrack){n.push(i);const c=this.localTrackMap.get(at.LocalVideoLowTrack);c&&n.push([at.LocalVideoLowTrack,c])}else n.push(i);return n}createMuteMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}createUnmuteMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}filterTobeUnSubscribedTracks(e,n){const r=[],i=this.remoteUserMap.get(e);if(!i)return r;if(n){const c=i.get(n);if(!c)return r;r.push([e,{kind:n,id:c}])}else Array.from(i.entries()).forEach(c=>{let[u,f]=c;r.push([e,{kind:u,id:f}])});return r}filterTobeUnSubscribedDataChannels(e,n){const r=[];return n.forEach(i=>{var c;(c=this.remoteDataChannelMap.get(e))!==null&&c!==void 0&&c.has(i.id)&&r.push(i)}),r}createUnsubscribeMessage(e){const n=[];return e.forEach(r=>{let[i,{kind:c,id:u}]=r;switch(c){case kt.VIDEO:return void(i._videoSSRC&&n.push({stream_type:kt.VIDEO,ssrcId:i._videoSSRC}));case kt.AUDIO:return void(i._audioSSRC&&n.push({stream_type:kt.AUDIO,ssrcId:i._audioSSRC}))}}),n}createUnsubscribeAllMessage(e){const n=new Map;return e.forEach(r=>{let[i,{kind:c}]=r;if(n.has(i)){let u=n.get(i);c===kt.VIDEO?u|=So.Video:u|=So.Audio,n.set(i,u)}else c===kt.VIDEO?n.set(i,So.Video):n.set(i,So.Audio)}),{users:Array.from(n.entries()).map(r=>{let[i,c]=r;return{stream_id:i.uid,stream_type:c}})}}withdrawRemoteTracks(e){e.forEach(n=>{let[r,{kind:i}]=n;const c=this.remoteUserMap.get(r);c&&(c.delete(i),Array.from(c.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const n=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalVideoLowTrack);n&&(await n.track.setBitrateLimit(e.uplink),await new bt((i,c)=>{this.handleUpdateVideoEncoder(n.track,i,c,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new bt((i,c)=>{this.handleUpdateVideoEncoder(r.track,i,c,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(e,n,r){return e.map((i,c)=>{var u;let{stream_type:f}=i;const m=(u=n.find(_=>{let{stream_type:y}=_;return f===y}))===null||u===void 0?void 0:u.attributes;if(m&&de("DISABLE_SCREEN_SHARE_REMB")){const _=r[c]._hints;(gt(_).call(_,hr.SCREEN_TRACK)||gt(_).call(_,hr.SCREEN_LOW_TRACK))&&(m.remb=!1,x.debug("disable remb for screen share, hints:",_))}return m})}async tryToUnmuteAudio(e){for(let r=0;r<e.length;r++)if(e[r]instanceof Hr){var n;const i=this.filterTobeUnmutedTracks(e[r]);if(i.length===0)continue;await((n=this.connection)===null||n===void 0?void 0:n.unmuteLocal(i.map(u=>{let[,{id:f}]=u;return f})));const c=this.createUnmuteMessage(i);return void await ur(this,Kt.RequestUnmuteLocal,c)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var n;return!((n=this.connection)===null||n===void 0||!n.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,n)=>this.emit(Kt.RequestUpload,e,n),this.statsUploader.requestUploadStats=e=>this.emit(Kt.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var e;return{connectState:((e=this.connection)===null||e===void 0?void 0:e.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Do(Yw(this.dtlsFailedCount,so)),this.emit(Kt.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),n=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),n.length>0&&await Bo(this,Kt.RequestUnpublishForReconnectPC,n),this.disconnectForReconnect(),this.emit(Kt.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(at.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Sr)}throwIfTrackTypeNotMatch(e){if(e.filter(n=>n instanceof Sr).length>1)throw new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(n=>n instanceof Hr).length>1&&(e.some(n=>n instanceof Hr&&n._bypassWebAudio)||!Bn().webAudioMediaStreamDest))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of e){if(n instanceof Sr&&this.pendingLocalTracks.some(r=>r instanceof Sr))throw new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof Hr&&this.pendingLocalTracks.some(r=>r instanceof Hr)&&(!Bn().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof Hr&&r._bypassWebAudio)))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,n){var r;const i=!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding,c=zc(zc({},{width:160,height:120,framerate:15,bitrate:50}),n);let u;u=i?e._mediaStreamTrack.clone():rI(e,c);const f=dr(8,"track-low-"),m=new Sr(u,zc(zc({},i&&{scaleResolutionDownBy:FR(c,e)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,f);return m.on(Bd.TRANSCEIVER_UPDATED,_=>{e._updateRtpTransceiver(_,xf.LOW_STREAM)}),m._hints.push(hr.LOW_STREAM),gt(r=e._hints).call(r,hr.SCREEN_TRACK)&&m._hints.push(hr.SCREEN_LOW_TRACK),e.on("sei-to-send",_=>{m.emit("sei-to-send",_)}),e.addListener(Pt.NEED_CLOSE,()=>{m.close()}),m}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof Kc){var c,u,f,m;const _=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:y,dtlsTransportState:T,peerConnectionState:A}=this.connection,{local:k,remote:P}=await this.connection.getSelectedCandidatePair();Bt.pcStats(this.store.sessionId,{startTime:_,eventElapse:e-_||0,iceconnectionsate:y,dtlsstate:T,connectionstate:A,intSucc:n?1:2,error:this._iceError||i||"",selectedLocalCandidateProtocol:(c=k==null?void 0:k.protocol)!==null&&c!==void 0?c:"",selectedLocalCandidateType:(u=k.candidateType)!==null&&u!==void 0?u:"",selectedLocalCandidateAddress:"".concat(k.address,":").concat(k.port),selectedRemoteCandidateProtocol:(f=P.protocol)!==null&&f!==void 0?f:"",selectedRemoteCandidateType:(m=P.candidateType)!==null&&m!==void 0?m:"",selectedRemoteCandidateAddress:"".concat(P.address,":").concat(P.port),restartCnt:r,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(e,n,r,i){var c;const u=Array.from(Ii(c=this.remoteUserMap).call(c)).find(f=>f._videoSSRC===e);if(u){i||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,m=f.subscribe.find(_=>_.userId===u.uid&&_.type==="video");Bt.firstRemoteVideoDecode(this.store.sessionId,bo.FIRST_VIDEO_DECODE,Nr.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:n,videoheight:r,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:i?1:0,firstFrame:(m==null?void 0:m.firstFrame)||0})}}async remoteMediaSsrcChanged(e,n,r){if(!this.connection)return!1;const i=this.remoteUserMap.get(e);if(!i)return!1;const c=i.get(n);if(!c)return!1;const u=await this.connection.getRemoteSSRC(c);return u!==void 0&&u!==r}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[n,{track:r}]=e;n===at.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,xf.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},Lt(Tn.prototype,"startP2PConnection",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"startP2PConnection"),Tn.prototype),Lt(Tn.prototype,"connect",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"connect"),Tn.prototype),Lt(Tn.prototype,"updateRemoteRTPCapabilities",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"updateRemoteRTPCapabilities"),Tn.prototype),Lt(Tn.prototype,"publishDataChannel",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"publishDataChannel"),Tn.prototype),Lt(Tn.prototype,"unpublish",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unpublish"),Tn.prototype),Lt(Tn.prototype,"unpublishDataChannel",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unpublishDataChannel"),Tn.prototype),Lt(Tn.prototype,"unpublishLowStream",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unpublishLowStream"),Tn.prototype),Lt(Tn.prototype,"subscribeDataChannel",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"subscribeDataChannel"),Tn.prototype),Lt(Tn.prototype,"subscribe",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"subscribe"),Tn.prototype),Lt(Tn.prototype,"massSubscribe",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"massSubscribe"),Tn.prototype),Lt(Tn.prototype,"unsubscribe",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unsubscribe"),Tn.prototype),Lt(Tn.prototype,"unsubscribeDataChannel",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unsubscribeDataChannel"),Tn.prototype),Lt(Tn.prototype,"massUnsubscribe",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"massUnsubscribe"),Tn.prototype),Lt(Tn.prototype,"muteRemote",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"muteRemote"),Tn.prototype),Lt(Tn.prototype,"unmuteRemote",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"unmuteRemote"),Tn.prototype),Lt(Tn.prototype,"hasRemoteMediaWithLock",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"hasRemoteMediaWithLock"),Tn.prototype),Lt(Tn.prototype,"disconnectForReconnect",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"disconnectForReconnect"),Tn.prototype),Lt(Tn.prototype,"updateBitrateLimit",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"updateBitrateLimit"),Tn.prototype),Lt(Tn.prototype,"remoteMediaSsrcChanged",[rs],Object.getOwnPropertyDescriptor(Tn.prototype,"remoteMediaSsrcChanged"),Tn.prototype),Tn);function rs(e,n,r){const i=e[n];if(typeof i!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,u=await c.lock("From P2PChannel.".concat(n));try{for(var f=arguments.length,m=new Array(f),_=0;_<f;_++)m[_]=arguments[_];return await i.apply(this,m)}finally{u()}},r}function f3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function p3(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?f3(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const $ce=Date.now(),Hce=20,sI=new Map,Wy=new Map;async function m3(e){const n=sI.get(e),r=Array.isArray(n)&&n[n.length-1],i=Wy.get(e);if(!r)return void(i.isSyncing=!1);const c={uid:r.uid,payload:r.payload};i.firstRecvTs===0&&(i.firstRecvTs=r.recvTs,i.firstSendTs=r.sendTs);const u=r.sendTs-i.firstSendTs,f=u-(Date.now()-i.firstRecvTs);f>0&&(i.firstRecvTs=Date.now()-u);let m=r.mediaDelay+f;m<=0?(n.pop(),v3(r.context,c),m=0):m=Math.min(m,Hce),setTimeout(()=>n.length&&m3(e),m)}function v3(e,n){e.safeEmit(Rn.STREAM_MESSAGE,n.uid,n.payload),e.onStreamMessage&&e.onStreamMessage(n)}function Wce(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return v3(r,{uid:e.uid,payload:e.payload});const i="".concat(r.id,"-").concat(e.uid),c=sI.get(i)||[],u=c.findIndex(y=>e.sendTs>=y.sendTs),f=p3(p3({},e),{},{context:r,mediaDelay:n,recvTs:Date.now()});u===-1?c.push(f):c.splice(u,0,f),sI.set(i,c);let m=!1;var _;Wy.has(i)?m=!((_=Wy.get(i))===null||_===void 0||!_.isSyncing):Wy.set(i,{isSyncing:m,firstRecvTs:0,firstSendTs:0}),m||m3(i)}const Kce=Mn().name;function g3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function _3(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?g3(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const op="websdk_ng_cache_parameter",Gce=de("MAX_PRELOAD_ASYNC_LENGTH"),zce=1e4,Qd=new Map,eh=[];let iI=null,aI=0,cI=0;const Ky=new Map,Yce=function(e,n){const r=[];let i=0;const c=async()=>{const u=r.shift();u&&await u(),r.length>0&&i<n?c():i--};return async function(){for(var u=arguments.length,f=new Array(u),m=0;m<u;m++)f[m]=arguments[m];return new bt(async(_,y)=>{r.push(async()=>{try{const T=await e(...f);_(T)}catch(T){y(T)}}),i<n&&(i++,c())})}}(E3,Gce),lI=Is.CancelToken.source();async function E3(e,n,r,i,c,u){try{if(!de("ENABLE_PRELOAD"))return;if(!Bn().supportWebCrypto)return void wu(()=>{x.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!r&&r!==null)throw new $e(oe.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&Po(r,"token",1,2047),Po(e,"appid",1,2047),by(n),i&&Sy(i);const f=Vd();x.debug("preload channel ".concat(n,", uid is ").concat(i));const m={appId:e,cname:n,token:r||e,uid:typeof i!="string"?i:null,sid:f,proxyServer:c};let _,y;typeof i=="string"?(m.stringUid=i,[y,_]=await bt.all([Nce(i,{sid:f,appId:e},lI.token),jB(_3(_3({},m),{},{token:r||e,uid:0}),lI.token)]),m.uid=y.uid,_.gatewayInfo.uid=m.uid,_.gatewayInfo.res.uid=m.uid):(u&&(m.stringUid=u),_=await jB(m,lI.token));const T={sid:f,appId:e,cname:n,token:r||e,uid:m.stringUid||i,intUid:m.uid||_.gatewayInfo.uid,stringUid:m.stringUid,ts:Date.now(),sua:y,ap:_};await async function(A){let k;try{A.uid&&b3({appId:A.appId,cname:A.cname,token:A.token,uid:A.uid,stringUid:A.stringUid});const P=w3(A),q=await async function(H,ne){try{const re=await window.crypto.subtle.importKey("raw",dU(ne),"AES-GCM",!1,["encrypt"]),ve=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},re,Ud(window.btoa(JSON.stringify(H))));return Ru(new Uint8Array(ve))}catch{return}}(A,A.token||A.appId);if(!q)return;k=C3(op);const j=k?JSON.parse(k):[];j.push({[P]:q}),j.length>de("AP_CACHE_NUM")&&j.shift(),Gy(op,JSON.stringify(j))}catch(P){x.warn("Error caching server parameters:",P.message),Gy(op,"")}}(T),aI++}catch(f){throw cI++,function(m){iI||(iI=window.setTimeout(()=>{let y="";Ky.forEach((T,A)=>{y+="".concat(A,": ").concat(T," ;")}),Bt.reportApiInvoke(null,{name:oo.PRELOAD,options:{success:aI,failed:cI,err:y}}).onError(m),aI=0,cI=0,Ky.clear(),iI=null},zce));const _=Ky.get(m.code)||0;Ky.set(m.code,_+1)}(f),f}}async function y3(e){try{if(de("AP_REQUEST_DETAIL")||de("ENABLE_ROLE_SELECT_EDGE"))return;const n=b3(e);if(!n||e.cloudProxyServer!=="disabled")return;const r=await async function(i,c){try{const u=await window.crypto.subtle.importKey("raw",dU(c),"AES-GCM",!1,["decrypt"]),f=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},u,Ud(i));return JSON.parse(window.atob(Ru(new Uint8Array(f))))}catch{return}}(n,e.token||e.appId);if(!r||!function(i,c){return i.cname===c.cname&&i.appId===c.appId&&i.token===c.token?c.stringUid?i.stringUid===c.stringUid:typeof c.uid=="number"?i.uid===c.uid:i.uid==c.uid:!1}(r,e))return;if(r&&Date.now()-r.ts<de("AP_CACHE_LIFETIME"))return r}catch(n){x.warn("Error get preloadInfo",n.message)}}function b3(e){let n;try{if(n=C3(op),!n)return;const r=JSON.parse(n),i=w3(e),c=function(f,m){for(let _=f.length-1;_>=0;_--)if(m(f[_]))return _;return-1}(r,f=>i in f);if(c===-1)return;const u=r.splice(c,1)[0];return Gy(op,JSON.stringify(r)),u[i]}catch(r){x.warn("Error delete preload info: ".concat(n),r.message),Gy(op,"")}}function uI(e){if(e){let n=Qd.get(e);n&&(window.clearTimeout(n),n=null,Qd.delete(e)),gt(eh).call(eh,e)||e.cloudProxyServer!=="disabled"||eh.push(e)}if(Qd.size<de("AP_CACHE_NUM")&&eh.length>0){const n=eh.shift();Qd.set(n,window.setTimeout(async()=>{const{appId:r,cname:i,token:c,stringUid:u,uid:f,proxyServer:m}=n;try{await Yce(r,i,c,f,m,u),Qd.has(n)&&uI(n)}catch(_){x.warn("update preload failed",_.message),S3(n)}},de("AP_UPDATE_INTERVAL")))}}function S3(e){const n=eh.indexOf(e);n!==-1&&eh.splice(n,1);let r=Qd.get(e);r&&(window.clearTimeout(r),r=null,Qd.delete(e),uI())}function T3(e,n){const r=e.sua,i=e.ap;n&&r&&Bt.reqUserAccount(e.sid,{lts:r.requestTime,elapse:r.elapse,success:!0,serverAddr:r.url,stringUid:n,uid:e.intUid,errorCode:null,extend:r.req}),Bt.reportResourceTiming(e.ap.url,e.sid),Bt.joinWebProxyAP(e.sid,{lts:i.requestTime,elapse:i.elapse,sucess:1,apServerAddr:i.url,turnServerAddrList:i.proxyInfo.addresses.map(c=>c.ip).join(","),eventType:"disabled",unilbsServerIds:[eo.CHOOSE_SERVER,eo.CLOUD_PROXY_FALLBACK].toString()}),Bt.joinChooseServer(e.sid,{lts:i.requestTime,elapse:i.elapse,succ:!0,csAddr:i.url,opid:i.opid,serverList:i.gatewayInfo.gatewayAddrs.map(c=>c.address),ec:null,cid:i.gatewayInfo.cid.toString(),uid:i.gatewayInfo.uid.toString(),csIp:i.gatewayInfo.csIp,unilbsServerIds:[eo.CHOOSE_SERVER].toString(),isHttp3:i.isHttp3})}function C3(e){return window.atob(window.localStorage.getItem(e)||"")}function Gy(e,n){window.localStorage.setItem(e,window.btoa(n))}function w3(e){let n="".concat(e.appId,"_").concat(e.cname);return typeof e.uid=="string"&&(n+="_s_".concat(e.uid)),typeof e.uid=="number"&&(n+="_".concat(e.uid)),e.token&&(n+="_".concat(e.token)),_U(n)}function qce(e){let n=function(){const r=Zce.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(r,i){let c=r.appId;c!==void 0&&(ro(i,10),xu(i,c));let u=r.cid;u!==void 0&&(ro(i,16),ro(i,u));let f=r.cname;f!==void 0&&(ro(i,26),xu(i,f));let m=r.deviceId;m!==void 0&&(ro(i,34),xu(i,m));let _=r.elapse;_!==void 0&&(ro(i,40),Uu(i,_));let y=r.fileSize;y!==void 0&&(ro(i,48),Uu(i,sp(y)));let T=r.height;T!==void 0&&(ro(i,56),Uu(i,sp(T)));let A=r.jpg;A!==void 0&&(ro(i,66),ro(i,A.length),I3(i,A));let k=r.networkType;k!==void 0&&(ro(i,72),Uu(i,sp(k)));let P=r.osType;P!==void 0&&(ro(i,80),Uu(i,sp(P)));let q=r.requestId;q!==void 0&&(ro(i,90),xu(i,q));let j=r.sdkVersion;j!==void 0&&(ro(i,98),xu(i,j));let H=r.sequence;H!==void 0&&(ro(i,104),Uu(i,sp(H)));let ne=r.sid;ne!==void 0&&(ro(i,114),xu(i,ne));let re=r.timestamp;re!==void 0&&(ro(i,120),Uu(i,re));let ve=r.uid;ve!==void 0&&(ro(i,128),ro(i,ve));let Oe=r.vid;Oe!==void 0&&(ro(i,136),ro(i,Oe));let ke=r.width;ke!==void 0&&(ro(i,144),Uu(i,sp(ke)));let we=r.service;we!==void 0&&(ro(i,152),ro(i,we));let Be=r.callbackData;Be!==void 0&&(ro(i,162),ro(i,Be.length),I3(i,Be));let lt=r.ticket;lt!==void 0&&(ro(i,170),xu(i,lt));let St=r.vendorConfigs;St!==void 0&&(ro(i,178),xu(i,St))}(e,n),function(r){let i=r.bytes,c=r.limit;return i.length===c?i:i.subarray(0,c)}(n)}function Xce(e){return function(r){let i={};e:for(;!Qce(r);){let c=Rv(r);switch(c>>>3){case 0:break e;case 1:i.code=Rv(r);break;case 2:i.msg=A3(r,Rv(r));break;case 3:i.requestId=A3(r,Rv(r));break;case 4:i.timestamp=ele(r,!1);break;default:Jce(r,7&c)}}return i}({bytes:n=e,offset:0,limit:n.length});var n}function Jce(e,n){switch(n){case 0:for(;128&Oa(e););break;case 2:dI(e,Rv(e));break;case 5:dI(e,4);break;case 1:dI(e,8);break;default:throw new Error("Unimplemented type: "+n)}}function sp(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let Zce=[];function dI(e,n){if(e.offset+n>e.limit)throw new Error("Skip past limit");e.offset+=n}function Qce(e){return e.offset>=e.limit}function zy(e,n){let r=e.bytes,i=e.offset,c=e.limit,u=i+n;if(u>r.length){let f=new Uint8Array(2*u);f.set(r),e.bytes=f}return e.offset=u,u>c&&(e.limit=u),i}function R3(e,n){let r=e.offset;if(r+n>e.limit)throw new Error("Read past limit");return e.offset+=n,r}function I3(e,n){let r=zy(e,n.length);e.bytes.set(n,r)}function A3(e,n){let r=R3(e,n),i=String.fromCharCode,c=e.bytes,u="",f="";for(let m=0;m<n;m++){let _,y,T,A,k=c[m+r];128&k?(224&k)==192?m+1>=n?f+=u:(_=c[m+r+1],(192&_)!=128?f+=u:(A=(31&k)<<6|63&_,A<128?f+=u:(f+=i(A),m++))):(240&k)==224?m+2>=n?f+=u:(_=c[m+r+1],y=c[m+r+2],(49344&(_|y<<8))!=32896?f+=u:(A=(15&k)<<12|(63&_)<<6|63&y,A<2048||A>=55296&&A<=57343?f+=u:(f+=i(A),m+=2))):(248&k)==240?m+3>=n?f+=u:(_=c[m+r+1],y=c[m+r+2],T=c[m+r+3],(12632256&(_|y<<8|T<<16))!=8421504?f+=u:(A=(7&k)<<18|(63&_)<<12|(63&y)<<6|63&T,A<65536||A>1114111?f+=u:(A-=65536,f+=i(55296+(A>>10),56320+(1023&A)),m+=3))):f+=u:f+=i(k)}return f}function xu(e,n){let r=n.length,i=0;for(let f=0;f<r;f++){let m=n.charCodeAt(f);m>=55296&&m<=56319&&f+1<r&&(m=(m<<10)+n.charCodeAt(++f)-56613888),i+=m<128?1:m<2048?2:m<65536?3:4}ro(e,i);let c=zy(e,i),u=e.bytes;for(let f=0;f<r;f++){let m=n.charCodeAt(f);m>=55296&&m<=56319&&f+1<r&&(m=(m<<10)+n.charCodeAt(++f)-56613888),m<128?u[c++]=m:(m<2048?u[c++]=m>>6&31|192:(m<65536?u[c++]=m>>12&15|224:(u[c++]=m>>18&7|240,u[c++]=m>>12&63|128),u[c++]=m>>6&63|128),u[c++]=63&m|128)}}function Oa(e){return e.bytes[R3(e,1)]}function O3(e,n){let r=zy(e,1);e.bytes[r]=n}function Rv(e){let n,r=0,i=0;do n=Oa(e),r<32&&(i|=(127&n)<<r),r+=7;while(128&n);return i}function ro(e,n){for(n>>>=0;n>=128;)O3(e,127&n|128),n>>>=7;O3(e,n)}function ele(e,n){let r,i=0,c=0,u=0;return r=Oa(e),i=127&r,128&r&&(r=Oa(e),i|=(127&r)<<7,128&r&&(r=Oa(e),i|=(127&r)<<14,128&r&&(r=Oa(e),i|=(127&r)<<21,128&r&&(r=Oa(e),c=127&r,128&r&&(r=Oa(e),c|=(127&r)<<7,128&r&&(r=Oa(e),c|=(127&r)<<14,128&r&&(r=Oa(e),c|=(127&r)<<21,128&r&&(r=Oa(e),u=127&r,128&r&&(r=Oa(e),u|=(127&r)<<7))))))))),{low:i|c<<28,high:c>>>4|u<<24,unsigned:n}}function Uu(e,n){let r=n.low>>>0,i=(n.low>>>28|n.high<<4)>>>0,c=n.high>>>24,u=c===0?i===0?r<16384?r<128?1:2:r<1<<21?3:4:i<16384?i<128?5:6:i<1<<21?7:8:c<128?9:10,f=zy(e,u),m=e.bytes;switch(u){case 10:m[f+9]=c>>>7&1;case 9:m[f+8]=u!==9?128|c:127&c;case 8:m[f+7]=u!==8?i>>>21|128:i>>>21&127;case 7:m[f+6]=u!==7?i>>>14|128:i>>>14&127;case 6:m[f+5]=u!==6?i>>>7|128:i>>>7&127;case 5:m[f+4]=u!==5?128|i:127&i;case 4:m[f+3]=u!==4?r>>>21|128:r>>>21&127;case 3:m[f+2]=u!==3?r>>>14|128:r>>>14&127;case 2:m[f+1]=u!==2?r>>>7|128:r>>>7&127;case 1:m[f]=u!==1?128|r:127&r}}const N3={},k3={},Yy=4294967296,tle=Yy*Yy,nle=tle/2;D3(0,!0);const P3=D3(0),rle=Iv(0,-2147483648,!1),ole=Iv(-1,2147483647,!1);function D3(e,n){let r,i,c;return n?(c=0<=(e>>>=0)&&e<256)&&(i=k3[e],i)?i:(r=Iv(e,0,!0),c&&(k3[e]=r),r):(c=-128<=(e|=0)&&e<128)&&(i=N3[e],i)?i:(r=Iv(e,e<0?-1:0,!1),c&&(N3[e]=r),r)}function Iv(e,n,r){return{low:0|e,high:0|n,unsigned:!!r}}function L3(e,n){if(isNaN(e))return P3;{if(e<=-9223372036854776e3)return rle;if(e+1>=nle)return ole}return e<0?P3:Iv(e%Yy|0,e/Yy|0,n)}function M3(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}class hI extends Dr{get connectionState(){return this._connectionState}set connectionState(n){if(this._connectionState===n)return;const r=this._connectionState;this._connectionState=n,this.emit(ic.CONNECTION_STATE_CHANGE,n,r)}get quality(){return this._quality}set quality(n){this._quality=n>1?1:n<.1?.1:n,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(n){var r;super(),Q(this,"name","AgoraRTCImageModeration"),Q(this,"_connectionState",Ji.CONNECTING),Q(this,"_sequence",0),Q(this,"_moderationStartTime",void 0),Q(this,"_workerConnection",void 0),Q(this,"_workerMessageLengthLimit",void 0),Q(this,"_qualityRatio",void 0),Q(this,"_connectInfo",void 0),Q(this,"_cancelTokenSource",Is.CancelToken.source()),Q(this,"_retryConfig",void 0),Q(this,"_moderationInterval",void 0),Q(this,"_moderationTimer",null),Q(this,"_moderationMode",1),Q(this,"_quality",1),Q(this,"_qualityTimer",null),Q(this,"_ticket",void 0),Q(this,"_moderationIntervalMinimum",void 0),Q(this,"_uploadFailedNum",0),Q(this,"_uploadNum",0),Q(this,"_uploadTimer",null),Q(this,"_extraInfo",void 0),Q(this,"_vendor",""),Q(this,"_encoder",new TextEncoder),Q(this,"_moderationId",void 0),Q(this,"inspectImage",()=>{if(this.connectionState!==Ji.CONNECTED)throw new Ue(oe.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Ji.CONNECTED?this.requestToInspectImage():x.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=dr(5,"image-moderation-"),this._workerMessageLengthLimit=de("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=de("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(r=n.interval)!==null&&r!==void 0?r:1e3,n.extraInfo&&(this._extraInfo=this._encoder.encode(n.extraInfo)),n.vendor&&(this._vendor=n.vendor),this._qualityRatio=de("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new vv("worker-"+this._moderationId,so),this.on(ic.STATE_CHANGE,(i,c)=>{x.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Yf[i]," ").concat(c||""))}),this.handleWorkerEvents()}async init(n,r){this.emit(ic.STATE_CHANGE,Yf.CONNECT_AP),this._connectInfo=n;const i=this._cancelTokenSource.token;return this._retryConfig=r,new bt((c,u)=>{this.on(ic.CONNECTION_STATE_CHANGE,(f,m)=>{f===Ji.CONNECTED&&c()}),this.requestAP(n,i,r).then(f=>{this.connectWorker(f)}).catch(f=>{u(f)})})}updateConfig(n){var r;this._moderationInterval=(r=n.interval)!==null&&r!==void 0?r:1e3,n.extraInfo&&(this._extraInfo=this._encoder.encode(n.extraInfo)),n.vendor&&(this._vendor=n.vendor),x.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(n))),this.connectionState===Ji.CONNECTED&&this.inspectImage()}async requestAP(n,r,i){const c=de("WEBCS_DOMAIN").map(_=>"https://".concat(_,"/api/v1")),u=await function(_,y,T,A){let{appId:k,areaCode:P,cname:q,sid:j,token:H,uid:ne}=y;ep++;const re="moderation_plugin",ve={service_name:re,json_body:JSON.stringify({appId:k,areaCode:P,cname:q,command:"allocateEdge",requestId:ep,seq:ep,sid:j,appToken:H,ts:Date.now(),uid:ne+""})};let Oe,ke,we=_[0];return nc(async()=>{Oe=Date.now();const Be=await ac(we,{data:ve,cancelToken:T,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ke=Date.now()-Oe,Be.code!==0){const At=new Ue(oe.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+Be.code,{retry:!0,responseTime:ke});throw x.error(At.toString()),At}const lt=JSON.parse(Be.json_body);if(lt.code!==200){const At=new Ue(oe.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(lt.code,", reason: ").concat(lt.reason),{code:lt.code,responseTime:ke});throw x.error(At.toString()),At}if(!lt.servers||!Array.isArray(lt.servers)||lt.servers.length===0){const At=new Ue(oe.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:lt.code,responseTime:ke});throw x.error(At.toString()),At}if(!lt.servers.some(At=>!!At.wss)){const At=new Ue(oe.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:lt.code,responseTime:ke});throw x.error(At.toString()),At}const St=de("IMAGE_MODERATION_WORKER_HOST");return{addressList:lt.servers.map(At=>{let{address:Nn,wss:kn}=At;if(Nn&&kn)return"wss://".concat(Nn.replace(/\./g,"-"),".").concat(St,":").concat(kn,"/moderation")}).filter(At=>!!At),workerToken:lt.workerToken,vid:lt.vid,ticket:lt.appTicket,responseTime:ke}},(Be,lt)=>(Bt.apworkerEvent(j,{success:!0,sc:200,serviceName:re,responseDetail:JSON.stringify(Be.addressList),firstSuccess:lt===0,responseTime:ke,serverIp:_[lt%_.length]}),!1),(Be,lt)=>(Bt.apworkerEvent(j,{success:!1,sc:Be.data&&Be.data.code||200,serviceName:re,responseTime:ke,serverIp:_[lt%_.length]}),!!(Be.code!==oe.OPERATION_ABORTED&&Be.code!==oe.UNEXPECTED_RESPONSE||Be.data&&Be.data.retry)&&(we=_[(lt+1)%_.length],!0)),A)}(c,n,r,i);this.emit(ic.STATE_CHANGE,Yf.AP_CONNECTED);const{addressList:f,ticket:m}=u;return this._ticket=m,f}async connectWorker(n){this.emit(ic.STATE_CHANGE,Yf.CONNECT_WORKER),await this._workerConnection.init(n,1e4)}handleWorkerEvents(){this._workerConnection.on(pn.CONNECTED,async()=>{this.emit(ic.STATE_CHANGE,Yf.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Ji.CONNECTED}),this._workerConnection.on(pn.CLOSED,()=>{this.connectionState=Ji.CLOSED}),this._workerConnection.on(pn.FAILED,()=>{this.connectionState=Ji.CLOSED}),this._workerConnection.on(pn.RECONNECTING,()=>{this.connectionState=this.connectionState===Ji.CONNECTED?Ji.RECONNECTING:Ji.CONNECTING}),this._workerConnection.on(pn.ON_MESSAGE,async n=>{if(n.data instanceof ArrayBuffer){const r=Xce(new Uint8Array(n.data));de("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&x.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(r)),this._uploadNum++,r.code===void 0||r.code===0||(this._uploadFailedNum++,x.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(r.code,", msg is ").concat(r.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{Bt.reportApiInvoke(this._connectInfo.sid||null,{name:oo.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,r.code],tag:Fr.TRACER}).onError(new Ue(oe.IMAGE_MODERATION_UPLOAD_FAILED,r.msg)),this._uploadTimer=null},de("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else x.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(pn.WILL_RECONNECT,(n,r,i)=>{n==="recover"&&i(n),i("tryNext")}),this._workerConnection.on(pn.REQUEST_NEW_URLS,(n,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(r)})}static intToLong(n){return{low:n|=0,high:n>>31,unsigned:n>=0}}async requestToInspectImage(){const n=wi(this,ic.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(n){if(!n.isPlaying)return void(de("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&x.debug("Only the track being played can be inspected"));this._sequence++;const i=await this.generateRequestData(n,r);this._workerConnection.sendMessage(i,!0,!0)}else de("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&x.debug("Only the track being published can be inspected")}async generateRequestData(n,r){let{appId:i,cname:c,cid:u,vid:f,sid:m,uid:_}=r;const y=Date.now(),T=await n.getCurrentFrameImage("image/jpeg",this.quality),A=await aV(T,i,c),k=this._sequence+"-"+u+"-"+_+"-"+y+"-"+dr(12,""),P={appId:i,cid:u,cname:c,deviceId:"",elapse:hI.intToLong(Number(y-this._moderationStartTime)),fileSize:T.buffer.byteLength,height:T.height,width:T.width,jpg:A,networkType:6,osType:7,requestId:k,sdkVersion:"4.23.2",sequence:this._sequence,sid:m,timestamp:L3(y),uid:_,vid:f,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete P.callbackData;const q=qce(P);if(q.byteLength<this._workerMessageLengthLimit){if(de("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const j=function(H){for(var ne=1;ne<arguments.length;ne++){var re=arguments[ne]!=null?arguments[ne]:{};ne%2?M3(Object(re),!0).forEach(function(ve){Q(H,ve,re[ve])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(re)):M3(Object(re)).forEach(function(ve){Object.defineProperty(H,ve,Object.getOwnPropertyDescriptor(re,ve))})}return H}({},P);delete j.jpg,x.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(j))}return q}{const j=this.quality*this._qualityRatio;return this.quality=j,await this.generateRequestData(n,{appId:i,cname:c,cid:u,vid:f,sid:m,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Is.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Ji.CLOSED,this.emit(ic.STATE_CHANGE,Yf.CLOSED)}}function x3(e){if(sr(e.interval,"interval",1e3,1/0),e&&e.extraInfo&&e.extraInfo.length>1024)throw new Ue(oe.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(e&&e.vendor&&e.vendor.length>1024)throw new Ue(oe.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const sle={name:"ImageModeration",create:function(e){let{config:n}=e;return x3(n),new hI(n)}};var U3,V3,F3,B3,j3,$3,H3,W3,K3,G3,z3,Y3,q3,X3,J3,Z3,Q3,e4,t4,n4,r4,o4,s4,i4,a4,c4,l4,u4,d4,h4,f4,p4,m4,v4,g4,_4,E4,y4,b4,S4,T4,Rt;function C4(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Na(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?C4(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C4(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}Ko.setLogger(x);let ile=(U3=Xt(),V3=Xt({argsMap:(e,n)=>{if(!Array.isArray(n)){if(!(n instanceof Bf))return[n];n=[n]}return n.map(r=>r?Object(r).toString():"null")}}),F3=Xt({argsMap:(e,n)=>(n||(n=[]),Array.isArray(n)||n.trackMediaType!==Ff.DATA?(Array.isArray(n)||(n=[n]),n.map(r=>r.getTrackId())):[n.getChannelId()])}),B3=Xt({argsMap:(e,n,r,i)=>[typeof n=="object"?n.uid:n,r,i]}),j3=Xt({argsMap:(e,n,r)=>[n,r]}),$3=Xt({argsMap:(e,n)=>n.map(r=>{let{user:i,mediaType:c}=r;return[i==null?void 0:i.uid,c]})}),H3=Xt({argsMap:(e,n,r,i)=>[typeof n=="object"?n.uid:n,r,i]}),W3=Xt({argsMap:(e,n)=>n.map(r=>{let{user:i,mediaType:c}=r;return{uid:i==null?void 0:i.uid,mediaType:c}})}),K3=Xt(),G3=Xt(),z3=Xt(),Y3=Xt(),q3=Xt(),X3=Xt(),J3=Xt(),Z3=Xt(),Q3=Xt(),e4=Xt(),t4=Xt(),n4=Xt(),r4=Xt(),o4=Xt(),s4=Xt(),i4=Xt({argsMap:(e,n)=>[n]}),a4=Xt(),c4=Xt(),l4=Xt(),u4=Xt(),d4=Xt(),h4=Xt(),f4=Xt(),p4=Xt(),m4=Xt({argsMap:(e,n)=>(Array.isArray(n)||(n=[n]),[JSON.stringify(n)])}),v4=Xt(),g4=Xt(),_4=Xt(),E4=Xt(),y4=Xt(),b4=Xt(),S4=Xt({reportResult:!0}),T4=Xt(),Rt=class extends Dr{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return((e=this._config)===null||e===void 0?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e,n){let r;if(super(),Q(this,"store",void 0),Q(this,"_uid",void 0),Q(this,"_channelName",void 0),Q(this,"_uintUid",void 0),Q(this,"_users",[]),Q(this,"_config",void 0),Q(this,"_clientId",void 0),Q(this,"_appId",void 0),Q(this,"_sessionId",null),Q(this,"_key",void 0),Q(this,"_rtmConfig",{}),Q(this,"_joinInfo",void 0),Q(this,"_gateway",void 0),Q(this,"_statsCollector",void 0),Q(this,"_configDistribute",void 0),Q(this,"_leaveMutex",void 0),Q(this,"_publishMutex",void 0),Q(this,"_renewTokenMutex",void 0),Q(this,"_subscribeMutex",void 0),Q(this,"_encryptionMode","none"),Q(this,"_encryptionSecret",null),Q(this,"_encryptionSalt",null),Q(this,"_encryptDataStream",!1),Q(this,"_encryptDataStreamKey",null),Q(this,"_encryptDataStreamIv",null),Q(this,"_proxyServer",void 0),Q(this,"_turnServer",{servers:[],mode:"auto"}),Q(this,"_cloudProxyServerMode","disabled"),Q(this,"_isDualStreamEnabled",!1),Q(this,"_defaultStreamFallbackType",void 0),Q(this,"_lowStreamParameter",void 0),Q(this,"_streamFallbackTypeCacheMap",new Map),Q(this,"_remoteStreamTypeCacheMap",new Map),Q(this,"_axiosCancelSource",Is.CancelToken.source()),Q(this,"_audioVolumeIndicationInterval",void 0),Q(this,"_networkQualityInterval",void 0),Q(this,"_userOfflineTimeout",void 0),Q(this,"_streamRemovedTimeout",void 0),Q(this,"_liveTranscodeStreamingClient",void 0),Q(this,"_liveRawStreamingClient",void 0),Q(this,"_channelMediaRelayClient",void 0),Q(this,"_networkQualitySensitivity","normal"),Q(this,"_p2pChannel",void 0),Q(this,"_useLocalAccessPoint",!1),Q(this,"_setLocalAPVersion",void 0),Q(this,"_joinAndNotLeaveYet",!1),Q(this,"_numberOfJoinCount",0),Q(this,"_remoteDefaultVideoStreamType",void 0),Q(this,"_inspect",void 0),Q(this,"_moderation",void 0),Q(this,"_license",void 0),Q(this,"_pendingPublishedUsers",[]),Q(this,"ntpAlignErrorCount",0),Q(this,"remoteInboundOffset",0),Q(this,"_peerConnectionState",void 0),Q(this,"_handleLocalTrackEnable",(c,u,f)=>{this.publish(c,!1).then(u).catch(f)}),Q(this,"_handleLocalTrackDisable",(c,u,f)=>{this.unpublish(c).then(u).catch(f)}),Q(this,"_handleUserOnline",c=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(c.uid,this.channelName))return void x.debug("[".concat(c.uid,"] will be ignored in local"));this.isStringUID&&typeof c.uid!="string"&&x.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const u=this._users.find(f=>f.uid===c.uid);if(u)u._trust_in_room_=!0,u._is_pre_created&&(u._is_pre_created=!1,this.safeEmit(Rn.USER_JOINED,u));else{const f=new Lu(c.uid,c.uint_id||c.uid);this._users.push(f),x.debug("[".concat(this._clientId,"] user online"),c.uid),this.safeEmit(Rn.USER_JOINED,f)}}),Q(this,"_handleUserOffline",c=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(c.uid,this.channelName))return;const u=this._users.find(f=>f.uid===c.uid);u&&(this._handleRemoveStream(c),this._handleRemoveDataChannels(c),u._audio_pre_subscribed||u._video_pre_subscribed?u._is_pre_created=!0:XE(this._users,u),this._remoteStreamTypeCacheMap.delete(u.uid),this._streamFallbackTypeCacheMap.delete(u.uid),x.debug("[".concat(this._clientId,"] user offline"),c.uid,"reason:",c.reason),this.safeEmit(Rn.USER_LEAVED,u,c.reason))}),Q(this,"_handleAddAudioOrVideoStream",(c,u,f,m,_,y,T)=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(u,this.channelName))return;const A=this._users.find(P=>P.uid===u);if(!A)return void x.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));x.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(c)),this.store.subscribe(A.uid,c,void 0,void 0,void 0,Date.now());const k=c==="audio"?A.hasAudio:A.hasVideo;A._uintid||(A._uintid=_||u),c==="audio"?A._trust_audio_stream_added_state_=!0:A._trust_video_stream_added_state_=!0,c==="audio"?(A._audio_added_=!0,f!==void 0&&(A._audioSSRC=f),m!==void 0&&(A._cname=m),y&&(A._audioOrtc=y)):(A._video_added_=!0,f!==void 0&&(A._videoSSRC=f),m!==void 0&&(A._cname=m),T!==void 0&&(A._rtxSsrcId=T),y&&(A._videoOrtc=y)),(c==="audio"?A.hasAudio:A.hasVideo)&&!k&&(x.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published ").concat(c)),this.safeEmit(Rn.USER_PUBLISHED,A,c)),c==="video"?Bt.onGatewayStream(this._sessionId,bo.ON_ADD_VIDEO_STREAM,Nr.ON_ADD_VIDEO_STREAM,{peer:_||u,ssrc:A._videoSSRC}):Bt.onGatewayStream(this._sessionId,bo.ON_ADD_AUDIO_STREAM,Nr.ON_ADD_AUDIO_STREAM,{peer:_||u,ssrc:A._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(A,c,f).then(P=>{if(P&&(x.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(A.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof wv))return this._p2pChannel.unsubscribe(A,c,!0).then(()=>this._subscribe(A,c,!0).catch(q=>{x.error("[".concat(this._clientId,"] resubscribe error"),q.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(A,c)&&(x.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(A.uid," after reconnect.")),this._subscribe(A,c,!0).catch(P=>{x.error("[".concat(this._clientId,"] resubscribe error"),P.toString())}))}),Q(this,"_handleRemoveStream",c=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(c.uid,this.channelName))return;const u=this._users.find(m=>m.uid===c.uid);if(!u)return void x.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));x.debug("[".concat(this._clientId,"] stream removed with uid ").concat(c.uid));let f=()=>{};u.hasAudio&&u.hasVideo?f=()=>{x.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(Rn.USER_UNPUBLISHED,u,"audio"),x.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(Rn.USER_UNPUBLISHED,u,"video")}:u.hasVideo?f=()=>{x.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished video track")),this.safeEmit(Rn.USER_UNPUBLISHED,u,"video")}:u.hasAudio&&(f=()=>{x.info("[".concat(this._clientId,"] remote user ").concat(u.uid," unpublished audio track")),this.safeEmit(Rn.USER_UNPUBLISHED,u,"audio")}),u._video_pre_subscribed||u._audio_pre_subscribed||(u._trust_audio_stream_added_state_=!0,u._trust_video_stream_added_state_=!0,u._audio_added_=!1,u._video_added_=!1,this._p2pChannel instanceof wv&&this._p2pChannel.unsubscribe(u).then(m=>{if(m)return this._gateway.unsubscribe(m,u.uid)}),u._audioSSRC=void 0,u._videoSSRC=void 0,u._audioOrtc=void 0,u._videoOrtc=void 0,u._rtxSsrcId=void 0),Bt.onGatewayStream(this._sessionId,bo.ON_REMOVE_STREAM,Nr.ON_REMOVE_STREAM,{peer:c.uint_id||c.uid}),f()}),Q(this,"_handleSetStreamLocalEnable",(c,u,f)=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(u,this.channelName))return;const m=this._users.find(T=>T.uid===u);if(!m)return void x.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));x.debug("[".concat(this._clientId,"] local ").concat(c," ").concat(f?"enabled":"disabled"," with uid ").concat(u));const _=c==="audio"?m.hasAudio:m.hasVideo;if(c==="audio"){m._trust_audio_enabled_state_=!0;const T=m._audio_enabled_;if(m._audio_enabled_=f,m._audio_enabled_===T)return;{const A=m._audio_enabled_?"enable-local-audio":"disable-local-audio";x.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(u,", msg: ").concat(A)),this.safeEmit(Rn.USER_INFO_UPDATED,u,A)}}else{m._trust_video_enabled_state_=!0;const T=m._video_enabled_;if(m._video_enabled_=f,m._video_enabled_===T)return;{const A=m._video_enabled_?"enable-local-video":"disable-local-video";x.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(A)),this.safeEmit(Rn.USER_INFO_UPDATED,u,A)}}const y=c==="audio"?m.hasAudio:m.hasVideo;return _!==y?!_&&y?(x.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(c)),void this.safeEmit(Rn.USER_PUBLISHED,m,c)):(c==="video"&&m._videoTrack&&m._videoTrack._destroy(),c==="audio"&&m._audioTrack,this._p2pChannel.muteRemote(m,c),x.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(c)),void this.safeEmit(Rn.USER_UNPUBLISHED,m,c)):void 0}),Q(this,"_handleMuteStream",(c,u,f)=>{if(de("BLOCK_LOCAL_CLIENT")&&Gd(c,this.channelName))return;x.debug("[".concat(this._clientId,"] receive mute message"),c,u,f);const m=this._users.find(T=>T.uid===c);if(!m)return void x.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(c));const _=u==="audio"?m.hasAudio:m.hasVideo;if(u==="audio"){m._trust_audio_mute_state_=!0;const T=m._audio_muted_;if(m._audio_muted_=f,m._audio_muted_===T)return;{const A=m._audio_muted_?"mute-audio":"unmute-audio";x.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(A)),this.safeEmit(Rn.USER_INFO_UPDATED,c,A)}}else{m._trust_video_mute_state_=!0;const T=m._video_muted_;if(m._video_muted_=f,m._video_muted_===T)return;{const A=m._video_muted_?"mute-video":"unmute-video";x.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(c,", msg: ").concat(A)),this.safeEmit(Rn.USER_INFO_UPDATED,c,A)}}const y=u==="audio"?m.hasAudio:m.hasVideo;if(_!==y){if(!_&&y)return(u==="audio"?m._audioSSRC:m._videoSSRC)?(x.info("[".concat(this._clientId,"] remote user ").concat(c," published ").concat(u)),void this.safeEmit(Rn.USER_PUBLISHED,m,u)):void x.warning("[".concat(this._clientId,"] remote user ").concat(c," receive ").concat(u," unmute message  before add stream message, ").concat(u," SSRC doesn't exist yet."));u==="video"&&m._videoTrack&&!m._video_pre_subscribed&&m._videoTrack._destroy(),u==="audio"&&m._audioTrack,this._p2pChannel.muteRemote(m,u),x.info("[".concat(this._clientId,"] remote user ").concat(c," unpublished ").concat(u)),this.safeEmit(Rn.USER_UNPUBLISHED,m,u)}}),Q(this,"_handleP2PLost",async c=>{x.debug("[".concat(this._clientId,"] receive p2p lost"),c),parseInt(c.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():x.warning("[".concat(this._clientId,"] P2PLost stream not found"),c)}),Q(this,"_handleTokenWillExpire",()=>{x.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(Rn.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),Q(this,"_handleBeforeUnload",c=>{c.type==="beforeunload"&&c.returnValue!==void 0&&c.returnValue!==""||(this.leave(),x.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),Q(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(Rn.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const c={downlinkNetworkQuality:0,uplinkNetworkQuality:0};c.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),c.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(Rn.NETWORK_QUALITY,c)}),Q(this,"_handleP2PAddAudioOrVideoStream",(c,u,f,m)=>{const _=this._users.find(T=>T.uid===u);if(!_)return void x.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));x.debug("[".concat(this._clientId,"] stream added with uid ").concat(u,", type ").concat(c)),this.store.subscribe(_.uid,c,void 0,void 0,void 0,Date.now());const y=c==="audio"?_.hasAudio:_.hasVideo;c==="audio"?_._trust_audio_stream_added_state_=!0:_._trust_video_stream_added_state_=!0,c==="audio"?(_._audio_added_=!0,f!==void 0&&(_._audioSSRC=f),m!==void 0&&(_._audioMid=m)):(_._video_added_=!0,f!==void 0&&(_._videoSSRC=f),m!==void 0&&(_._videoMid=m)),(c==="audio"?_.hasAudio:_.hasVideo)&&!y&&(x.info("[".concat(this._clientId,"] remote user ").concat(_.uid," published ").concat(c)),this.safeEmit(Rn.USER_PUBLISHED,_,c)),this._p2pChannel.hasPendingRemoteMedia(_,c)&&(x.debug("[".concat(this._clientId,"] resubscribe ").concat(c," for user ").concat(_.uid," after reconnect.")),this._subscribe(_,c,!0).catch(T=>{x.error("[".concat(this._clientId,"] resubscribe error"),T.toString())}))}),this._config=e,this._clientId=n||dr(5,"client-"),this.store=new class{constructor(c,u,f,m){un(this,"state",void 0),this.state={codec:c,audioCodec:u,mode:f,clientId:m,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:Fd.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(c){this.state=function(u,f){switch(f.type){case In.SET_SESSION_ID:return Nt(Nt({},u),{},{sessionId:f.sessionId});case In.SET_P2P_ID:return Nt(Nt({},u),{},{p2pId:f.p2pId});case In.SET_UID:return Nt(Nt({},u),{},{uid:f.uid});case In.SET_INT_UID:return Nt(Nt({},u),{},{intUid:f.intUid});case In.SET_PUB_ID:return Nt(Nt({},u),{},{pubId:f.pubId});case In.KEY_METRIC_CLIENT_CREATED:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{clientCreated:f.metric})});case In.KEY_METRIC_JOIN_START:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{joinStart:f.metric})});case In.AVOID_JOIN_START:return Nt(Nt({},u),{},{avoidJoinStart:f.avoidJoinStart});case In.KEY_METRIC_JOIN_END:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{joinEnd:f.metric})});case In.KEY_METRIC_REQUEST_AP_START:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{requestAPStart:f.metric})});case In.KEY_METRIC_REQUEST_AP_END:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{requestAPEnd:f.metric})});case In.KEY_METRIC_JOIN_GATEWAY_START:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{joinGatewayStart:f.metric})});case In.KEY_METRIC_JOIN_GATEWAY_END:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{joinGatewayEnd:f.metric})});case In.KEY_METRIC_PEER_CONNECTION_START:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{peerConnectionStart:f.metric})});case In.KEY_METRIC_PEER_CONNECTION_END:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{peerConnectionEnd:f.metric})});case In.KEY_METRIC_DESCRIPTION_START:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{descriptionStart:f.metric})});case In.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{signalChannelOpen:f.metric})});case In.KEY_METRIC_ICE_CONNECTION_END:return Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{iceConnectionEnd:f.metric})});case In.KEY_METRIC_PUBLISH:{const m=u.keyMetrics.publish,_=m.findIndex(y=>y.trackId===f.metric.trackId);return _!==-1?(m[_]=Nt(Nt({},m[_]),f.metric),Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{publish:[...m]})})):Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{publish:[...u.keyMetrics.publish,f.metric]})})}case In.KEY_METRIC_SUBSCRIBE:{const m=u.keyMetrics.subscribe,_=m.findIndex(y=>y.userId===f.metric.userId&&y.type===f.metric.type);return _!==-1?(m[_]=Nt(Nt({},m[_]),f.metric),Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{subscribe:[...m]})})):Nt(Nt({},u),{},{keyMetrics:Nt(Nt({},u.keyMetrics),{},{subscribe:[...u.keyMetrics.subscribe,f.metric]})})}case In.SET_CLOUD_PROXY_SERVER_MODE:return u.cloudProxyServerMode=f.mode,u;case In.RECORD_JOIN_CHANNEL_SERVICE:return typeof f.index!="number"?u.joinChannelServiceRecords=[...u.joinChannelServiceRecords,f.record]:(u.joinChannelServiceRecords[f.index]=Nt(Nt({},u.joinChannelServiceRecords[f.index]),f.record),u.joinChannelServiceRecords=[...u.joinChannelServiceRecords]),u;case In.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return u.joinChannelServiceRecords=[],u;case In.RESET_KEY_METRICS:return u.keyMetrics={publish:[],subscribe:[]},u;case In.SET_USE_P2P:return Nt(Nt({},u),{},{useP2P:f.val});case In.SET_TRANSPORT_TYPE:return Nt(Nt({},u),{},{p2pTransport:f.val});default:return u}}(this.state,c)}set sessionId(c){this.dispatch({type:In.SET_SESSION_ID,sessionId:c})}get sessionId(){return this.state.sessionId}set cid(c){this.state.cid=c}get cid(){return this.state.cid}set codec(c){this.state.codec=c}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(c){this.dispatch({type:In.SET_P2P_ID,p2pId:c})}get p2pId(){return this.state.p2pId}set dcId(c){this.dispatch({type:In.SET_DC_ID,dcId:c})}get dcId(){return this.state.dcId}set uid(c){this.dispatch({type:In.SET_UID,uid:c})}get uid(){return this.state.uid}set intUid(c){this.dispatch({type:In.SET_INT_UID,intUid:c})}get intUid(){return this.state.intUid}set pubId(c){this.dispatch({type:In.SET_PUB_ID,pubId:c})}get pubId(){return this.state.pubId}set cloudProxyServerMode(c){this.dispatch({type:In.SET_CLOUD_PROXY_SERVER_MODE,mode:c})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(c){this.dispatch({type:In.SET_USE_P2P,val:c})}get useP2P(){return this.state.useP2P}set p2pTransport(c){this.dispatch({type:In.SET_TRANSPORT_TYPE,val:c})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(c){this.state.hasStartJoinChannel=c}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(c){this.state.isABTestSuccess=c}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:In.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:In.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:In.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:In.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:In.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:In.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:In.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:In.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:In.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:In.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:In.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:In.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(c,u,f,m){this.dispatch({type:In.KEY_METRIC_PUBLISH,metric:Nt(Nt({trackId:c,type:u},f&&{publishStart:f}),m&&{publishEnd:m})})}subscribe(c,u,f,m,_,y,T){this.dispatch({type:In.KEY_METRIC_SUBSCRIBE,metric:Nt(Nt(Nt(Nt(Nt({userId:c,type:u},f&&{subscribeStart:f}),m&&{subscribeEnd:m}),_&&{firstFrame:_}),y&&{streamAdded:y}),T&&{firstDecoded:T})})}massSubscribe(c,u,f,m){c.forEach(_=>{this.dispatch({type:In.KEY_METRIC_SUBSCRIBE,metric:Nt(Nt(Nt({userId:_.userId,type:_.type},u&&{subscribeStart:u}),f&&{subscribeEnd:f}),m&&{firstFrame:m})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(c,u){c.service==="gateway"&&Array.isArray(c.urls)&&(c.urls=c.urls.map(f=>f.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof u!="number"?(this.dispatch({type:In.RECORD_JOIN_CHANNEL_SERVICE,record:Nt(Nt({},c),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(u<0||u>=this.state.joinChannelServiceRecords.length||this.dispatch({type:In.RECORD_JOIN_CHANNEL_SERVICE,record:c,index:u}),u)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:In.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:In.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(c){this.dispatch({type:In.AVOID_JOIN_START,avoidJoinStart:c})}}(e.codec,e.audioCodec,e.mode,this._clientId),this._leaveMutex=new Ko("client-leave",this._clientId),this._publishMutex=new Ko("client-publish",this._clientId),this._renewTokenMutex=new Ko("client-renewtoken",this._clientId),this._subscribeMutex=new Ko("client-subscribe",this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),x.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Yi," build: ").concat(oR,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{Kw(e.clientRoleOptions),r=Object.assign({},e.clientRoleOptions)}catch(c){x.warning("[".concat(this._clientId,"] ").concat(c.toString()))}var i;this._statsCollector=new Tv(this.store),this._statsCollector.onStatsException=(c,u,f)=>{x.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(c,", msg: ").concat(u,", uid: ").concat(f)),this.safeEmit(Rn.EXCEPTION,{code:c,msg:u,uid:f})},this._statsCollector.onUploadPublishDuration=(c,u,f,m)=>{const _=this._users.find(y=>y.uid===c);_&&Bt.peerPublishStatus(this._sessionId,{subscribeElapse:m,audioPublishDuration:u,videoPublishDuration:f,peer:_._uintid})},this.store.useP2P=e.mode==="p2p",this._gateway=new Cce(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||so,httpRetryConfig:e.httpRetryConfig||so,forceWaitGatewayResponse:e.forceWaitGatewayResponse===void 0||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:r}),this._configDistribute=new Lce(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(i={store:this.store,statsCollector:this._statsCollector},Ml("P2PChannel").create(i)),this._handleP2PEvents()):this._p2pChannel=new wv(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,n,r,i,c){let u=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],f=arguments.length>6&&arguments[6]!==void 0&&arguments[6];tr("JOIN_GATEWAY_USE_443PORT_ONLY",u),tr("JOIN_GATEWAY_USE_DUAL_DOMAIN",f);const m=this._gateway.signal.websocket;return m instanceof UR&&(m.use443PortOnly=u,m.tryDoubleDomain=f),async function(_,y,T){KE.get(_)||KE.set(_,[]),GE.get(_)||GE.set(_,y),Uc.get(_)||Uc.set(_,0);const A=KE.get(_),k=GE.get(_);if(!A||!k)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Uc.get(_)===k){const ne=ev();A.push(ne),await ne.promise}Uc.set(_,Uc.get(_)+1);for(var P=arguments.length,q=new Array(P>3?P-3:0),j=3;j<P;j++)q[j-3]=arguments[j];const H=await T(...q);return Uc.set(_,Uc.get(_)-1),Uc.get(_)===k-1&&A.length>0&&(A[0].resolve(),A.shift()),Uc.get(_)===0&&(KE.set(_,[]),GE.set(_,0),Uc.set(_,0)),H}("client.join",de("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,n,r,i,c)}async join(e,n,r,i,c){const u=++this._numberOfJoinCount;this.store.joinStart(),i&&(this.store.uid=i);const f=(QE||QE||(QE=(window.location.protocol.split(":")[0]||"").toUpperCase(),QE))==="HTTPS",m=bU()?window.isSecureContext:"Browser Not Support";(!bU()&&!f||!window.isSecureContext)&&x.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),x.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart))),Bt.setAppId(e);try{if(!r&&r!==null)throw new Ue(oe.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));r&&Po(r,"token",1,2047),Po(e,"appid",1,2047),by(n),i&&Sy(i),c&&Po(c,"optionalInfo",1,2047)}catch(j){throw Bt.reportApiInvoke(Vd(),{name:oo.JOIN,options:[e,n,r,i],states:{isHttps:f,isSecureContext:m},tag:Fr.TRACER}).onError(j),j}if(this._leaveMutex.isLocked&&(x.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),x.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const j=new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw Bt.reportApiInvoke(Vd(),{name:oo.JOIN,options:[e,n,r,i],states:{isHttps:f,isSecureContext:m},tag:Fr.TRACER}).onError(j),j}this._gateway.state="CONNECTING";const _=await y3({appId:e,cname:n,uid:i,stringUid:typeof i=="string"?i:void 0,token:r||e,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const y=(_==null?void 0:_.sid)||Vd();x.info("[".concat(this._clientId,"] start join channel ").concat(n,", join number: ").concat(u)),this._sessionId||(this._sessionId=y,this.store.sessionId=this._sessionId);const T=Bt.reportApiInvoke(y,{id:this._clientId,name:oo.JOIN,options:[e,n,r,i],states:{isHttps:f,isSecureContext:m},tag:Fr.TRACER}),A=Na(Na(Na({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:e,sid:this._sessionId,cname:n,uid:typeof i!="string"?i:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:c,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!_},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:de("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(A.setLocalAPVersion=this._setLocalAPVersion),typeof i=="string"&&(A.stringUid=i,this._uintUid?(A.uid=this._uintUid,this._uintUid=void 0):A.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(A.aesmode=this._encryptionMode,A.aespassword=await(async j=>{const H=function(Oe){const ke=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),we=new Uint8Array(new ArrayBuffer(ke.length));for(let Be=0;Be<ke.length;Be+=1)we[Be]=ke.charCodeAt(Be);return we}(),ne=await window.crypto.subtle.importKey("spki",H,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),re=Hw(j),ve=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},ne,re);return function(Oe){let ke="";for(let we=0;we<Oe.length;we+=1)ke+=String.fromCharCode(Oe[we]);return window.btoa(ke)}(new Uint8Array(ve))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(A.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const j=new TextEncoder,H=de("USE_PURE_ENCRYPTION_MASTER_KEY")?j.encode(A.appId+this._encryptionSecret+this._encryptionSecret):j.encode(A.appId+A.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(ne,re,ve){const Oe=await window.crypto.subtle.importKey("raw",re,"PBKDF2",!1,["deriveBits","deriveKey"]),ke=ne==="aes-128-gcm2"?128:256,we=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:kU,hash:"SHA-256",salt:ve},Oe,ke+eae);return new Uint8Array(we).subarray(ke/8)}(this._encryptionMode,H,Ud(this._encryptionSalt)),this._encryptDataStreamKey=await async function(ne,re,ve){const Oe=await window.crypto.subtle.importKey("raw",re,"PBKDF2",!1,["deriveBits","deriveKey"]),ke=ne==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:kU,hash:"SHA-256",salt:ve},Oe,{name:"AES-GCM",length:ke},!0,["encrypt","decrypt"])}(this._encryptionMode,H,Ud(this._encryptionSalt))}else m?x.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):x.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,x.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:n,appId:e,stringUid:A.stringUid});const k=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&k===this._sessionId&&Bt.joinChannelTimeout(this._sessionId,5)},5e3);try{var P;let j;const H=A.cloudProxyServer;if(gt(P=["proxy3","proxy4","proxy5"]).call(P,H)){const ke=de("PROXY_SERVER_TYPE3");Array.isArray(ke)?A.proxyServer=ke[0]:A.proxyServer=ke}if(Bt.setProxyServer(A.proxyServer),x.setProxyServer(A.proxyServer),this.store.requestAPStart(),_){if(x.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(A.stringUid?", ".concat(A.stringUid," => ").concat(_.intUid):""," ")),A.stringUid&&!A.uid&&(A.uid=_.intUid),j={gatewayInfo:_.ap.gatewayInfo},de("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&A.turnServer.mode==="auto")if(_.ap.proxyInfo.addresses.length===0)x.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const ke=(await hB(_.ap.proxyInfo,_.ap.gatewayInfo.uid)).map(we=>({turnServerURL:we.address,tcpport:we.tcpport||jo.tcpport,udpport:we.udpport||jo.udpport,username:we.username||jo.username,password:we.password||jo.password,forceturn:!1,security:!0}));A.turnServer={mode:"manual",servers:ke}}T3(_,A.stringUid)}else{if(A.stringUid&&!A.uid){let ke;[ke,j]=await bt.all([BB(A.stringUid,A,this._axiosCancelSource.token,this._config.httpRetryConfig||so,this.store),FB(A,this._axiosCancelSource.token,this._config.httpRetryConfig||so,!0,this.store)]),x.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(A.stringUid," => ").concat(ke)),A.uid=ke,j.gatewayInfo.uid=ke,j.gatewayInfo.res.uid=ke}else j=await FB(A,this._axiosCancelSource.token,this._config.httpRetryConfig||so,!0,this.store);if(!this._joinAndNotLeaveYet)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(A,this._axiosCancelSource.token),this._configDistribute.on(pv.UPDATE_BITRATE_LIMIT,ke=>{this._p2pChannel.updateBitrateLimit(ke)}),this._configDistribute.on(pv.UPDATE_CLIENT_ROLE_OPTIONS,ke=>{this._setClientRoleOptions(ke)})},0),this._key=r||e;const ne=j.gatewayInfo,re=A.uid?A.uid:ne.uid;this._joinInfo=Na(Na({},A),{},{cid:ne.cid,uid:re,vid:ne.vid,apResponse:ne.res,apGatewayAddress:ne.apGatewayAddress,uni_lbs_ip:ne.uni_lbs_ip,gatewayAddrs:ne.gatewayAddrs}),this.store.intUid=re,this.store.cid=ne.cid;const ve=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));T.onSuccess(ve),this._appId=e,this._channelName=A.cname,this._uid=ve,this.store.uid=ve,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Vo()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const Oe=A.stringUid?"string uid: ".concat(A.stringUid,",uid: ").concat(A.uid):"uid: ".concat(this._uid);return x.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(n,",").concat(Oe)),setTimeout(()=>{x.startUpload()},5e3),this.store.joinEnd(),q=this,gt(Kd).call(Kd,q)||Kd.push(q),this._cloudProxyServerMode==="disabled"&&Bn().supportWebCrypto&&de("ENABLE_PRELOAD")&&uI(this._joinInfo),ve}catch(j){const H=Array.isArray(j)?j[0]:j;throw H&&H.code===oe.OPERATION_ABORTED?x.warning("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),H):x.error("[".concat(this._clientId,"] join number: ").concat(u,", Joining channel failed, rollback"),H),H.code!==oe.OPERATION_ABORTED&&this._numberOfJoinCount===u&&(this._gateway.state="DISCONNECTED",this._reset()),T.onError(H),H}var q}_joinGateway(){if(!this._joinInfo||!this._key)throw new Ue(oe.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!de("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){x.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(Vo()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(n){const r=Kd.indexOf(n);r!==-1&&Kd.splice(r,1)}(this),this._statsCollector.stopUpdateStats();const e=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return x.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave(this.connectionState!=="CONNECTED",Yn.LEAVE),x.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(e)){if(!(e instanceof Bf))return this._publishDataChannel(e);e=[e]}if(e.length===0)throw new Ue(oe.INVALID_PARAMS,"param list is empty");const r=e;if(this._gateway.role==="audience")throw new Ue(oe.INVALID_OPERATION,"audience can not publish stream");for(const c of r){if(!(c instanceof Bf))throw new Ue(oe.INVALID_PARAMS,"parameter is not local track");if(!c._enabled&&n)throw new Ue(oe.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(c.getTrackId()))}x.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(r.map(c=>"".concat(c.getTrackId()," "))));const i=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),n&&r.forEach(c=>{const u=this._configDistribute.getBitrateLimit();c instanceof Sr&&u&&c.setBitrateLimit(u.uplink)});try{await this._publishHighStream(r),x.info("[".concat(this._clientId,"] Publish success, id ").concat(r.map(c=>"".concat(c.getTrackId()," "))))}catch(c){throw x.error("[".concat(this._clientId,"] publish error"),c.toString()),c}finally{i()}}async _publishDataChannel(e){sr(e.id,"id",0,65535,!0),Al(e.ordered,"ordered"),Po(e.metadata,"metadata",0,512),x.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const n=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(c=>c.id===e.id)!==-1)throw new Ue(oe.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new Ue(oe.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&de("FORCE_TURN")&&!de("TURN_ENABLE_TCP")&&!de("TURN_ENABLE_UDP"))throw new Ue(oe.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const r=function(c){return NB(c,!1)}(e),i=await this._p2pChannel.publishDataChannel([r]);if(i.length>0){if(typeof r._originDataChannelId!="number")throw x.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new Ue(oe.CREATE_DATACHANNEL_ERROR);try{await bt.all(i.map(c=>this._uid&&this._gateway.publishDataChannel(this._uid,c,!0))),await r._waitTillOpen()}catch(c){if(c.code!==oe.DISCONNECT_P2P)throw c}}return x.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(r.id)),r}catch(r){throw x.error("[".concat(this._clientId,"] publish datachannels error"),r.toString()),r}finally{n()}}async unpublish(e){if(!this._joinInfo||this._uid===void 0)throw new Ue(oe.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let n=[];if(e)if(Array.isArray(e))n=e;else{if(!(e instanceof Bf))return this._unpublishDataChannel([e]);n=[e]}else this.store.useP2P||await this._unpublishDataChannel(),n=this._p2pChannel.getAllTracks(!0);x.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(n.map(i=>"".concat(i.getTrackId()," "))," "));const r=await this._publishMutex.lock();try{if(this.store.useP2P){const i=await this._p2pChannel.unpublish(n);i&&await this._gateway.sendExtensionMessage(qr.UNPUBLISH,{unpubMsg:i},!0)}else{const i=await this._p2pChannel.unpublish(n);i&&await this._gateway.unpublish(i,this._uid),x.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(n.map(c=>"".concat(c.getTrackId()))))}}catch(i){throw x.error("[".concat(this._clientId,"] unpublish error"),i.toString()),i}finally{r&&r()}}async _unpublishDataChannel(e){e!==void 0&&e.length!==0||(e=this._p2pChannel.getAllDataChannels()),x.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map(r=>"".concat(r.id," "))," "));const n=await this._publishMutex.lock();try{const r=await this._p2pChannel.unpublishDataChannel(e);r&&await this._gateway.unpublishDataChannel(r),x.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map(i=>"".concat(i.id))))}catch(r){throw x.error("[".concat(this._clientId,"] unpublish dataChannel error"),r.toString()),r}finally{n&&n()}}async subscribe(e,n,r){if(!(e instanceof Lu)){const i=this.remoteUsers.find(c=>c.uid===e);if(!i)throw new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");e=i}return n==="datachannel"?this._subscribeDataChannel(e,r):this._subscribe(e,n)}async presubscribe(e,n){if(vo(n,"mediaType",["audio","video"]),this.store.useP2P)throw new Ue(oe.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const r=n===kt.AUDIO,i=n===kt.VIDEO,c=await this._subscribeMutex.lock();try{const{ssrcId:u,ortc:f,rtxSsrcId:m,cname:_,uint_id:y}=await this._gateway.presubscribe(e,n,!0);if(u==null)throw new Ue(oe.UNEXPECTED_RESPONSE,"no ssrc id");let T=this._users.find(k=>k.uid===e);T||(T=new Lu(e,y||e),T._is_pre_created=!0,this._users.push(T)),_&&(T._cname=_),T._uintid||(T._uintid=y||e),r&&(T._audioSSRC=u,T._audio_pre_subscribed=!0,f&&(T._audioOrtc=f)),i&&(T._videoSSRC=u,T._video_pre_subscribed=!0,f&&(T._videoOrtc=f),m!=null&&(T._rtxSsrcId=m)),x.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(u)),await this._p2pChannel.subscribe(T,n,u,m,f);const A=r?T._audioTrack:T._videoTrack;if(!A)throw new Ue(oe.UNEXPECTED_ERROR,"can not find remote track in user");return r&&(T._trust_audio_stream_added_state_=!0,T._audio_added_=!0),i&&(T._trust_video_stream_added_state_=!0,T._video_added_=!0),A}catch(u){throw x.error("[".concat(this._clientId,"] presub user ").concat(e," error"),u),u}finally{c()}}async _subscribeDataChannel(e,n){var r;if(sr(n,"channelId",0,65535,!0),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(m=>m===e))throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&e._dataChannels.length===0)throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new Ue(oe.INVALID_REMOTE_USER,"user is not published");const c=(r=e._dataChannels)===null||r===void 0?void 0:r.find(m=>m.id===n);if(!c)throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new Ue(oe.REMOTE_USER_IS_NOT_PUBLISHED);const u=await this._subscribeMutex.lock();x.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const m=await this._p2pChannel.subscribeDataChannel(e,[c]);if(m&&gt(m).call(m,c.id))try{var f;if(typeof c._originDataChannelId!="number")throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new Ue(oe.CREATE_DATACHANNEL_ERROR);const _={id:c.id,datachannelId:c._originDataChannelId,ordered:c.ordered,maxRetransmits:c.maxRetransmits,metadata:(f=c.metadata)!==null&&f!==void 0?f:""};await this._gateway.subscribeDataChannel(e.uid,_,!0),await c._waitTillOpen()}catch(_){if((_==null?void 0:_.code)!==oe.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[c]),_;await this._p2pChannel.unsubscribeDataChannel(e,[c]),this._p2pChannel.setPendingRemoteDataChannel(e,c.id)}return x.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),c}finally{u()}}async _p2pSubscribe(e,n,r){if(vo(n,"mediaType",["audio","video"]),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(u=>u===e)){const u=new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),u}if(!e.hasAudio&&!e.hasVideo){const u=new Ue(oe.INVALID_REMOTE_USER,"user is not published");throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),u}if(!r&&(n==="audio"&&!e.hasAudio||n==="video"&&!e.hasVideo)){const u=new Ue(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(n,", remote track is not published")),u}const c=await this._subscribeMutex.lock();x.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,n))await this._p2pChannel.unmuteRemote(e,n);else try{const f=n==="audio"?e._audioSSRC:e._videoSSRC,m=n==="audio"?e._audioMid:e._videoMid;this.store.subscribe(e.uid,n,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(e,n,f,m)}catch(f){throw f}x.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(f=>{x.warning("[".concat(this._clientId,"] auto set fallback failed"),f)});const u=n==="audio"?e._audioTrack:e._videoTrack;if(!u)throw new Ue(oe.UNEXPECTED_ERROR,"can not find remote track in user object");return u}catch(u){throw x.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),u),u}finally{c()}}async _subscribe(e,n,r){if(this.store.useP2P)return this._p2pSubscribe(e,n);if(vo(n,"mediaType",["audio","video"]),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(y=>y===e)){const y=new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),y}if(!e.hasAudio&&!e.hasVideo){const y=new Ue(oe.INVALID_REMOTE_USER,"user is not published");throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),y}if(!(r||(n!=="audio"||e.hasAudio&&e._audioSSRC!==void 0)&&(n!=="video"||e.hasVideo&&e._videoSSRC!==void 0))){const y=new Ue(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw x.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(n,", remote track is not published")),y}let c=n==="audio"?e._audioSSRC:e._videoSSRC,u=n==="audio"?e._audioOrtc:e._videoOrtc,f=n==="video"?e._rtxSsrcId:void 0,m={stream_type:n==="audio"?kt.AUDIO:kt.VIDEO,ssrcId:c};const _=await this._subscribeMutex.lock();x.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(n));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,n))await this._p2pChannel.unmuteRemote(e,n);else try{const T=n==="audio"?e._audioSSRC:e._videoSSRC;T!==void 0&&T!==c&&(c=T,u=n==="audio"?e._audioOrtc:e._videoOrtc,f=n==="video"?e._rtxSsrcId:void 0,m={stream_type:n==="audio"?kt.AUDIO:kt.VIDEO,ssrcId:c}),Yo.markSubscribeStart(this.store.clientId,c),this.store.subscribe(e.uid,n,Date.now()),await this._p2pChannel.subscribe(e,n,c,f,u);try{this._p2pChannel.isPreSubScribe(c)||await this._gateway.subscribe(e.uid,m,!0)}catch(A){if((A==null?void 0:A.code)!==oe.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,n),A;await this._p2pChannel.unsubscribe(e,n,!0),this._p2pChannel.setPendingRemoteMedia(e,n)}this.store.subscribe(e.uid,n,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,n)}catch(T){throw this._p2pChannel.reportSubscribeEvent(!1,T==null?void 0:T.code,e,n),T}x.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch(T=>{x.warning("[".concat(this._clientId,"] auto set fallback failed"),T)});const y=n==="audio"?e._audioTrack:e._videoTrack;if(!y)throw new Ue(oe.UNEXPECTED_ERROR,"can not find remote track in user object");return y}catch(y){throw x.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),y),y}finally{_()}}async massSubscribe(e){if(Ol(e,"subscribeList"),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const n=Date.now(),r=new Map,i=await this._subscribeMutex.lock();x.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map(m=>{let{user:_,mediaType:y}=m;return"user: ".concat(_==null?void 0:_.uid,", mediaType: ").concat(y)}).join("; ")));const c=(e=[...e]).map(m=>{let{user:_,mediaType:y}=m;return{user:_,mediaType:y}}),u=await this._p2pChannel.globalLock();try{var f;for(let _=e.length-1;_>=0;_--){const y=e[_],{user:T,mediaType:A}=y;if(vo(A,"mediaType",["audio","video"]),!T){const j=new Ue(oe.INVALID_PARAMS,"user property does not exist in subscribeList item");throw x.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),j}if(!this._users.find(j=>j===T)){const j=new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");x.error("[".concat(this._clientId,"] can not massSubscribe ").concat(T.uid,", this user is not in the channel")),c[_].error=j,e.splice(_,1);continue}if(A==="audio"&&(!T.hasAudio||T._audioSSRC===void 0)||A==="video"&&(!T.hasVideo||T._videoSSRC===void 0)){const j=new Ue(oe.REMOTE_USER_IS_NOT_PUBLISHED);x.error("[".concat(this._clientId,"] can not subscribe ").concat(T.uid," with mediaType ").concat(A,", remote user is not published")),c[_].error=j,e.splice(_,1);continue}const P=So.Video|So.LwoVideo,q=r.get(T);if(q){if(A==="video"?q&P:q&So.Audio){e.splice(_,1),x.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(T.uid,", mediaType:").concat(A," twice"));continue}r.set(T,q|(A==="video"?P:So.Audio))}else r.set(T,A==="video"?P:So.Audio)}for(let _=e.length-1;_>=0;_--){const y=e[_],{user:T,mediaType:A}=y,k=So.Video|So.LwoVideo;if(this._p2pChannel.hasRemoteMedia(T,A)){await this._p2pChannel.unmuteRemoteNoLock(T,A);const P=r.get(T);r.set(T,A==="video"?P^k:P^So.Audio),e.splice(_,1)}}this.store.massSubscribe(e.map(_=>({userId:_.user.uid,type:_.mediaType})),n);let m=qa(f=Array.from(r.entries())).call(f,(_,y)=>{let[T,A]=y;if(A===0)return _;const k={stream_id:T.uid,stream_type:A};return A&So.Audio&&(k.audio_ssrc=T._audioSSRC),A&So.Video&&(k.video_ssrc=T._videoSSRC),_.push(k),_},[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map(y=>{let{user:T,mediaType:A}=y;return{user:T,mediaType:A,ssrcId:A===kt.VIDEO?T._videoSSRC:T._audioSSRC,rtxSsrcId:A===kt.VIDEO?T._rtxSsrcId:void 0}}));const _=new Map;if(m=m.filter(y=>y.video_ssrc&&!this._p2pChannel.isPreSubScribe(y.video_ssrc)||y.audio_ssrc&&!this._p2pChannel.isPreSubScribe(y.audio_ssrc)||!y.video_ssrc&&!y.audio_ssrc),m.length>0){const y=await this._gateway.subscribeAll(m,!0);((y==null?void 0:y.users)||[]).forEach(T=>{let{stream_id:A,video_error_code:k,audio_error_code:P,error_code:q}=T;(k||P||q)&&_.set(A,{video_error_code:k,audio_error_code:P,error_code:q})})}if(Array.from(_.entries()).length>0){const y=[];Array.from(_.entries()).forEach(T=>{let[A,k]=T;const P=this.remoteUsers.find(q=>q.uid===A);if(P){let q;k.error_code||k.video_error_code&&k.audio_error_code?q=void 0:k.video_error_code?q=kt.VIDEO:k.audio_error_code&&(q=kt.AUDIO),y.push({user:P,mediaType:q})}}),y.length>0&&await this._p2pChannel.massUnsubscribeNoLock(y)}for(const y of c){const T=_.get(y.user.uid);if(T){const A=T.error_code||y.mediaType==="audio"&&T.audio_error_code||y.mediaType==="video"&&T.video_error_code;if(A){const k=mv(A);x.error("user:".concat(y.user.uid," mediaType:").concat(y.mediaType," has massSubscribe error ").concat(k.desc)),y.error=new Ue(oe.SUBSCRIBE_FAILED,"code ".concat(A,": ").concat(k.desc))}}y.error||(y.mediaType==="video"?y.track=y.user.videoTrack:y.track=y.user.audioTrack)}return this.store.massSubscribe(c.filter(y=>!y.error).map(y=>({userId:y.user.uid,type:y.mediaType})),void 0,Date.now()),c.forEach(y=>{var T;Bt.subscribe(this.store.sessionId,{succ:!!y.error,ec:((T=y.error)===null||T===void 0?void 0:T.code)||null,video:y.mediaType===kt.VIDEO,audio:y.mediaType===kt.AUDIO,peerid:y.user.uid,subscribeRequestid:y.mediaType===kt.VIDEO?y.user._videoSSRC:y.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-n),preSsrc:this._p2pChannel.isPreSubScribe(y.user._videoSSRC)},!0)}),x.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map(y=>{let{user:T,mediaType:A}=y;return"user: ".concat(T==null?void 0:T.uid,", mediaType: ").concat(A)}).join("; "))),c}catch(_){throw await this._p2pChannel.massUnsubscribeNoLock(e),_}}finally{u(),i()}}async unsubscribe(e,n,r){if(!(e instanceof Lu)){const u=this.remoteUsers.find(f=>f.uid===e);if(!u)throw new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");e=u}if(n||this.store.useP2P){if(n==="datachannel")return this._unsubscribeDataChannel(e,r)}else await this._unsubscribeDataChannel(e,r);if(n&&vo(n,"mediaType",["audio","video"]),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(u=>u===e)){const u=new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");throw x.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),u}x.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(n));const c=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(e,n);else{const u=await this._p2pChannel.unsubscribe(e,n);u&&await this._gateway.unsubscribe(u,e.uid),n&&n!=="audio"||(e._audio_pre_subscribed=!1),n&&n!=="video"||(e._video_pre_subscribed=!1),e._is_pre_created&&XE(this._users,e),x.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(n))}}catch(u){if(u.code===oe.DISCONNECT_P2P)return void x.warning("disconnecting p2p, abort unsubscribe request.");throw x.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),u.toString()),u}finally{c()}}async _unsubscribeDataChannel(e,n){if(n&&sr(n,"id",0,65535,!0),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(c=>c===e)){const c=new Ue(oe.INVALID_REMOTE_USER,"user is not in the channel");throw x.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),c}let i;if(typeof n=="number"){const c=e._dataChannels.find(u=>u.id===n);c&&(i=[c])}else i=e._dataChannels;if(i===void 0){const c=new Ue(oe.REMOTE_USER_IS_NOT_PUBLISHED);throw x.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(n,", remote datachannel is not published")),c}x.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(i.map(c=>c.id)));try{const c=await this._p2pChannel.unsubscribeDataChannel(e,i);c&&await this._gateway.unsubscribeDataChannel(c,e.uid),x.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(c))}catch(c){if(c.code===oe.DISCONNECT_P2P)return void x.warning("disconnecting p2p, abort unsubscribe request.");throw x.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),c.toString()),c}}async massUnsubscribe(e){if(Ol(e,"unsubscribeList"),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");x.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map(r=>{let{user:i,mediaType:c}=r;return"user: ".concat(i==null?void 0:i.uid,", mediaType: ").concat(c,";")}).join())),e=[...e];const n=new Map;for(let r=e.length-1;r>=0;r--){const{user:i,mediaType:c}=e[r];if(!i){const m=new Ue(oe.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw x.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),m}if(vo(c,"mediaType",["video","audio",void 0]),!this._users.find(m=>m===i)){x.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(i.uid,", user is not in the channel")),e.splice(r,1);continue}const f=So.Video|So.LwoVideo;if(n.has(i)){const m=n.get(i);let _;switch(c){case"video":_=m&f;break;case"audio":_=m&So.Audio;break;default:_=m&(So.Audio|f)}if(_){x.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(i.uid,",mediaType:").concat(c," twice.")),e.splice(r,1);continue}c?c==="audio"?n.set(i,m|So.Audio):c==="video"&&n.set(i,m|f):n.set(i,m|So.Audio|f)}else c?c==="audio"?n.set(i,So.Audio):c==="video"&&n.set(i,f):n.set(i,So.Audio|f)}try{const r=await this._p2pChannel.massUnsubscribe(e);r&&await this._gateway.massUnsubscribe(r),x.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map(i=>{let{user:c,mediaType:u}=i;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(u,";")}).join()))}catch(r){if(r.code===oe.DISCONNECT_P2P)return void x.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw x.error("[".concat(this._clientId,"] massUnsubscribe error"),r.toString()),r}}async setLowStreamParameter(e){(function(r){if(!r)throw new $e(oe.INVALID_PARAMS);Vr(r.width)||jw(r.width,"streamParameter.width"),Vr(r.height)||jw(r.height,"streamParameter.height"),Vr(r.framerate)||jw(r.framerate,"streamParameter.framerate"),Vr(r.bitrate)||sr(r.bitrate,"streamParameter.bitrate")})(e),(!e.width&&e.height||e.width&&!e.height)&&x.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),x.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const n=this._configDistribute.getLowStreamConfigDistribute();if(n&&n.bitrate&&e.bitrate&&n.bitrate<e.bitrate&&(e.bitrate=n.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,at.LocalVideoLowTrack)}async enableDualStream(){if(!Bn().supportDualStream)throw Bt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new Ue(oe.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new Ue(oe.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw Bt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,Bt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),x.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(at.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw Bt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,Bt.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),x.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,n){if(function(i){vo(i,"role",["audience","host"])}(e),n&&Kw(n),this.mode==="rtc"||this.mode==="p2p")throw x.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new Ue(oe.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(n&&n.level&&e==="host")throw new Ue(oe.INVALID_OPERATION,"host mode can not set audience latency level");if(e==="audience"&&this._p2pChannel.hasLocalMedia())throw new Ue(oe.INVALID_OPERATION,"can not set client role to audience when publishing stream");const r=this._config.role;this._joinInfo&&(this._joinInfo.role=e),e!==r&&de("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(e,n),this._config.role=e,this._gateway.reconnect("recover",Fo.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(e,n),this._config.role=e),x.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(n&&n.level))}async _setClientRoleOptions(e){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let n=!1;try{e&&Kw(e),await this._gateway.setClientRole(this._config.role,e),n=!0}catch{}finally{x.info("[".concat(this._clientId,"] set client role options ").concat(n?"succeed":"failed",", options is ").concat(e))}}getRemoteInboundOffset(){var e;const n=(e=this._p2pChannel.getStats())===null||e===void 0?void 0:e.audioSend[0];if(!n||!n.timestamp)return 0;const r=n.timestamp-Date.now();return Math.abs(r)>1e3+n.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?r:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,n){if(Po(e,"proxyServer"),!n){if(this.connectionState!=="DISCONNECTED")throw new Ue(oe.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ue(oe.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,Bt.setProxyServer(this._proxyServer),x.setProxyServer(this._proxyServer),x.info("[".concat(this._clientId,"] Set proxy server ").concat(n?"by initialize call":""," success."))}setTurnServer(e,n){if(Array.isArray(e)||(e=[e]),!n){if(this.connectionState!=="DISCONNECTED")throw new Ue(oe.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new Ue(oe.INVALID_OPERATION,"You have already set the proxy")}if(sv(e))return this._turnServer={servers:e,mode:"original-manual"},void x.info("[".concat(this._clientId,"] Set original turnserver ").concat(n?"by initialize call":""," success: ").concat(e.map(r=>r.urls).join(","),"."));e.forEach(r=>lU(r)),this._turnServer={servers:e,mode:"manual"},x.info("[".concat(this._clientId,"] Set turnserver ").concat(n?"by initialize call":""," success."))}setLicense(e){if(this.connectionState!=="DISCONNECTED")throw new Ue(oe.INVALID_OPERATION,"you should set license before join channel");if(Po(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new Ue(oe.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,x.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if(this.connectionState!=="DISCONNECTED")throw new Ue(oe.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new Ue(oe.INVALID_OPERATION,"You have already set the proxy");const n=[3,4,5];let r;switch(e===void 0&&(e=3),e){case 1:case 2:throw new Ue(oe.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:r="proxy3";break;case 4:r="proxy4";break;case 5:r="proxy5";break;default:throw new Ue(oe.INVALID_PARAMS,"proxy server mode must be ".concat(n.join("|")))}this._cloudProxyServerMode=r,this.store.cloudProxyServerMode=r,x.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new Ue(oe.INVALID_OPERATION,"Stop proxy server after leave channel");Bt.setProxyServer(),x.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",x.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new Ue(oe.INVALID_PARAMS,"accessPoints is required.");Ol(e.accessPoints.serverList,"accessPoints.serverList"),Po(e.accessPoints.domain,"accessPoints.domain");const n=(k,P)=>{sr(k,P,0,65535,!0)};let r=443;if(e.accessPoints.port&&(n(e.accessPoints.port,"accessPoints.port"),r=e.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ue(oe.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");de("CLOSE_AFB_FOR_LOCAL_AP")&&(tr("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),tr("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const i=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,c=e.accessPoints.domain,u=e.accessPoints.serverList.map(k=>i.test(k)?"".concat(k.replace(/\./g,"-"),".").concat(c):k),f=u.map(k=>"".concat(k,":").concat(r));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,tr("WEBCS_DOMAIN",f),tr("WEBCS_DOMAIN_BACKUP_LIST",f),tr("GATEWAY_DOMAINS",[c]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(Ol(e.report.hostname,"report.hostname"),tr("EVENT_REPORT_DOMAIN",e.report.hostname[0]),tr("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(tr("EVENT_REPORT_DOMAIN",u[0]),tr("EVENT_REPORT_BACKUP_DOMAIN",u[1]||u[0]));let m=6443;e.report&&e.report.port&&(n(e.report.port,"report.port"),m=e.report.port),tr("STATS_COLLECTOR_PORT",m),e.report?tr("ENABLE_EVENT_REPORT",!0):tr("ENABLE_EVENT_REPORT",!1);let _="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(Ol(e.log.hostname,"log.hostname"),_=e.log.hostname[0]):_=u[0];let y=6444;e.log&&e.log.port&&(n(e.log.port,"log.port"),y=e.log.port),tr("LOG_UPLOAD_SERVER","".concat(_,":").concat(y));let T=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(Ol(e.cds.hostname,"cds.hostname"),T=e.cds.hostname):T=u;let A=443;e.cds&&e.cds.port&&(n(e.cds.port,"cds.port"),A=e.cds.port),tr("CDS_AP",T.map(k=>"".concat(k,":").concat(A))),e.cds?tr("ENABLE_CONFIG_DISTRIBUTE",!0):tr("ENABLE_CONFIG_DISTRIBUTE",!1),x.info("set local access point v2 success")}setLocalAccessPoints(e,n){if(Ol(e,"serverList"),Po(n,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new Ue(oe.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map(i=>r.test(i)?"".concat(i.replace(/\./g,"-"),".").concat(n):i),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,tr("WEBCS_DOMAIN",e),tr("WEBCS_DOMAIN_BACKUP_LIST",e),tr("GATEWAY_DOMAINS",[n]),tr("EVENT_REPORT_DOMAIN",e[0]),tr("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),tr("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),x.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(vo(e,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(n){throw x.error("[".concat(this._clientId,"] set default remote video stream type error"),n.toString()),n}else x.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,n){vo(n,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(e,n),setTimeout(()=>{const r=this._users.find(i=>i.uid===e);r&&r.videoTrack&&r.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(r){throw x.error("[".concat(this._clientId,"] set remote video stream type error"),r.toString()),r}x.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(n)),this._remoteStreamTypeCacheMap.set(e,n)}async setStreamFallbackOption(e,n){vo(n,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(e,n)}catch(r){throw x.error("[".concat(this._clientId,"] set stream fallback option"),r.toString()),r}x.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(n)),this._streamFallbackTypeCacheMap.set(e,n)}setEncryptionConfig(e,n,r,i){(function(u){vo(u,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(e),Po(n,"secret");const c=["aes-128-gcm2","aes-256-gcm2"];if(gt(c).call(c,e)){if(!r||!(r instanceof Uint8Array&&r.length===32))throw new Ue(oe.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(r)throw new Ue(oe.INVALID_PARAMS,"current encrypt mode does not need salt");if(i){if(Al(i,"encryptDataStream"),!gt(c).call(c,e))throw new Ue(oe.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(n)||x.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=e,this._encryptionSecret=n,r&&(this._encryptionSalt=Ru(r))}async renewToken(e){if(Po(e,"token",1,2047),!this._key||!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"renewToken should not be called before user join");const n=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const r=await this._renewTokenMutex.lock();try{if(de("USE_NEW_TOKEN")){x.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const i=await Dce(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||so);x.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:i})}else x.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});x.debug("[".concat(this._clientId,"] renewToken success"))}catch(i){throw this._key=n,this._joinInfo.token=n,x.error("[".concat(this._clientId,"] renewToken failed"),i.toString()),i}finally{r()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?x.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(Rn.VOLUME_INDICATOR,e)},de("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),n=this._gateway.getInChannelInfo();return e.Duration=Math.round(n.duration/1e3),e}async startLiveStreaming(e,n){if(!n){if(this.codec!=="h264")throw new Ue(oe.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new Ue(oe.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new Ue(oe.LIVE_STREAMING_TASK_CONFLICT);const r=n?Pl.TRANSCODE:Pl.RAW;return this._createLiveStreamingClient(r).startLiveStreamingTask(e,r)}setLiveTranscoding(e){return this._createLiveStreamingClient(Pl.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const n=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(r=>r&&r.hasUrl(e));if(!n.length)throw new Ue(oe.INVALID_PARAMS,"can not find live streaming url to stop");await bt.all(n.map(r=>r&&r.stopLiveStreamingTask(e)))}async startChannelMediaRelay(e){zB(e),await this._createChannelMediaRelayClient().startChannelMediaRelay(e)}async updateChannelMediaRelay(e){zB(e),await this._createChannelMediaRelayClient().updateChannelMediaRelay(e)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(e){this._p2pChannel instanceof wv&&this._p2pChannel.addAudioMetadata(e)}async sendStreamMessage(e){var n;let r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"can not send data stream, not joined");if((typeof e=="string"||e instanceof Uint8Array)&&(e={payload:e}),typeof e.payload=="string"){const c=new TextEncoder;e.payload=c.encode(e.payload)}let i=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&gt(n=["aes-128-gcm2","aes-256-gcm2"]).call(n,this._encryptionMode)&&(i=!0,e.payload=await async function(c,u,f){var m;const _=qa(m=Array.from(f)).call(m,(j,H)=>j+H,0),y={serverTs:0,seq:tae++,length:f.length,checkSum:_},T=new Uint8Array(gU(_,2)),A=new ArrayBuffer(Df),k=new DataView(A);k.setUint32(0,y.serverTs),k.setUint16(4,y.seq),k.setUint16(6,y.length),k.setUint16(8,y.checkSum);const P=16-f.length%16;f=hU(f,new Uint8Array(P));const q=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:c,tagLength:NU,additionalData:T},u,f);return hU(new Uint8Array(A),new Uint8Array(q))}(this._encryptDataStreamIv,this._encryptDataStreamKey,e.payload)),new Blob([e.payload]).size>1024)throw new Ue(oe.INVALID_PARAMS,i?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(nn.DATA_STREAM,{payload:Ru(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-$ce},!r)}sendMetadata(e){if(!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new Ue(oe.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(nn.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Ru(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(uae),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"can not send custom report, not joined");await Bt.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,n){vo(n.spatialLayer,"spatialLayer",[0,1,2,3]),vo(n.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,n)}catch(r){throw x.error("[".concat(this._clientId,"] pick SVC layer failed"),r.toString()),r}}async setRTMConfig(e){const{apRTM:n=!1,rtmFlag:r}=e;if(Al(n,"apRTM"),sr(r,"rtmFlag",0),this._rtmConfig.apRTM=n,this._rtmConfig.rtmFlag=r,x.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=n,this._joinInfo.rtmFlag=r,this._gateway.setRTM2Flag(r)}_reset(){if(x.debug("[".concat(this._clientId,"] reset client")),function(e){const n=Gf.indexOf(e);n!==-1&&Gf.splice(n,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=Is.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&S3(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&Bt.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach(n=>n._close()),e._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new Ko("client-publish",this._clientId),this._subscribeMutex=new Ko("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(e,n){var r;const i=e||Vd();e?x.debug("[".concat(this._clientId,"] new Session ").concat(i)):x.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(i));const c=e?"":this._sessionId||"";this._sessionId=i,this.store.sessionId=i,Bt.addSid(i);const u={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(n==null?void 0:n.stringUid)||((r=this._joinInfo)===null||r===void 0?void 0:r.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:c,clientRole:this.role==="audience"?2:1};Bt.sessionInit(this._sessionId,Na({cname:n.channel,appid:n.appId},u)),this._joinInfo&&(this._joinInfo.sid=i),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=i)}async _publishHighStream(e){if(!this._joinInfo||this._uid===void 0)throw new Ue(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&de("FORCE_TURN")&&!de("TURN_ENABLE_TCP")&&!de("TURN_ENABLE_UDP"))throw new Ue(oe.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");x.debug("[".concat(this._clientId,"] publish high stream"));try{const r=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const i=(await r.next()).value;if(i){try{await this._gateway.sendExtensionMessage(qr.PUBLISH,i,!0)}catch(c){throw r.throw(c),c}await r.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const i=(await r.next()).value;if(i){var n;let c;try{c=await this._gateway.publish(this._uid,i,!0)}catch(u){if(u.code!==oe.DISCONNECT_P2P)throw r.throw(u),u}await r.next(((n=c)===null||n===void 0?void 0:n.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const c of e)c instanceof Sr&&c._encoderConfig&&this._gateway.setVideoProfile(c._encoderConfig).catch(u=>{x.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!c.muted&&c.enabled||await this._p2pChannel.muteLocalTrack(c)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,e),(r==null?void 0:r.code)===oe.WS_ABORT)return;throw r}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new Ue(oe.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new Ue(oe.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));x.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const r=await this._p2pChannel.publishLowStream(this._lowStreamParameter),i=(await r.next()).value;if(i){var n;let c;try{c=await this._gateway.publish(this._uid,i,!0)}catch(u){if(u.code!==oe.DISCONNECT_P2P)throw r.throw(u),u}r.next(((n=c)===null||n===void 0?void 0:n.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(r){if(this._p2pChannel.reportPublishEvent(!1,r==null?void 0:r.code,void 0,!0),(r==null?void 0:r.code)===oe.WS_ABORT)return;throw r}}_createLiveStreamingClient(e){const n=()=>{if(!this._joinInfo||!this._appId)return new Ue(oe.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const r=(i={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},Ml("LiveStreaming").create(i));var i;return r.onLiveStreamError=(c,u)=>{Bt.reportApiInvoke(this._sessionId,{name:oo.ON_LIVE_STREAM_ERROR,options:[c,u],tag:Fr.TRACER}).onSuccess(),this.safeEmit(Rn.LIVE_STREAMING_ERROR,c,u)},r.onLiveStreamWarning=(c,u)=>{Bt.reportApiInvoke(this._sessionId,{name:oo.ON_LIVE_STREAM_WARNING,options:[c,u],tag:Fr.TRACER}).onSuccess(),this.safeEmit(Rn.LIVE_STREAMING_WARNING,c,u)},r.on(MR.REQUEST_WORKER_MANAGER_LIST,(c,u,f)=>{if(!this._joinInfo)return f(new Ue(oe.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(m,_,y,T){const A=de("UAP_AP").slice(0,de("AJAX_REQUEST_CONCURRENT")).map(k=>_.proxyServer?"https://".concat(_.proxyServer,"/ap/?url=").concat(k+"/api/v1?action=uap"):"https://".concat(k,"/api/v1?action=uap"));return await Ice(A,m,_,y,T)})(c,this._joinInfo,this._axiosCancelSource.token,so).then(u).catch(f)}),r};return e===Pl.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||n(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||n(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new Ue(oe.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:n,sendResolutionHeight:r}=this.getLocalVideoStats(),i=(e={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:n,height:r}},Ml("ChannelMediaRelay").create(e));i.on("state",c=>{c===Hs.RELAY_STATE_FAILURE&&i&&i.dispose(),this.safeEmit(Rn.CHANNEL_MEDIA_RELAY_STATE,c)}),i.on("event",c=>{this.safeEmit(Rn.CHANNEL_MEDIA_RELAY_EVENT,c)}),this._channelMediaRelayClient=i,this._statsCollector.onStatsChanged=(c,u)=>{var f;c==="resolution"&&((f=this._channelMediaRelayClient)===null||f===void 0||f.setVideoProfile(u))}}var e;return this._channelMediaRelayClient}_handleUpdateDataChannel(e,n){const{added:r,deleted:i}=e,c=[];if(n){const u=[];this._users.forEach(f=>{f._dataChannels.forEach(m=>{r.every(_=>_.uid!==f._uintid||_.stream_id!==m.id)&&u.push({uid:f._uintid,stream_id:m.id,ordered:m.ordered,max_retrans_times:m.maxRetransmits,metadata:m.metadata})})}),u.length>0&&this._handleUpdateDataChannel({added:[],deleted:u})}Array.isArray(r)&&r.length>0&&r.forEach(u=>{const{uid:f,stream_id:m,ordered:_,max_retrans_times:y,metadata:T}=u,A=this._users.find(k=>k._uintid===f);if(!A)return void x.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(x.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(f)),gt(c).call(c,A)||c.push(A),A._uintid||(A._uintid=f),A._dataChannels.findIndex(k=>k.id===u.stream_id)===-1){const k={id:m,ordered:!!_,maxRetransmits:y,metadata:T},P=function(q){return NB(q,!0)}(k);A._dataChannels.push(P),x.info("[".concat(this._clientId,"] remote user ").concat(A.uid," published datachannel")),n||this.safeEmit(Rn.USER_PUBLISHED,A,"datachannel",k)}this._p2pChannel.hasPendingRemoteDataChannel(A,u.stream_id)&&(x.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(A.uid," after reconnect.")),this._subscribeDataChannel(A,u.stream_id).catch(k=>{x.error("[".concat(this._clientId,"] resubscribe datachannel error"),k.toString())}))}),n&&(this.safeEmit(Rn.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(i)&&i.length>0&&i.forEach(u=>{const{uid:f,stream_id:m}=u,_=this._users.find(T=>T._uintid===f);if(!_)return void x.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const y=_._dataChannels.find(T=>T.id===u.stream_id);y&&(x.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(f)),this._p2pChannel.unsubscribeDataChannel(_,[y]).then(T=>{if(_._dataChannels=_._dataChannels.filter(A=>A!==y),T)return this._gateway.unsubscribeDataChannel(T,_.uid)}),x.info("[".concat(this._clientId,"] remote user ").concat(f," unpublished datachannel ,id:").concat(y.id)),this.safeEmit(Rn.USER_UNPUBLISHED,_,"datachannel",y._config))})}_handleRemoveDataChannels(e){const n=this._users.find(r=>r.uid===e.uid);if(n){if(n._dataChannels!==void 0&&n._dataChannels.length>0){x.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const r=()=>{x.info("[".concat(this._clientId,"] remote user ").concat(n.uid," unpublished datachannel")),n._dataChannels.forEach(i=>{this.safeEmit(Rn.USER_UNPUBLISHED,n,"datachannel",i._config)})};this._p2pChannel.unsubscribeDataChannel(n,n._dataChannels).then(i=>{if(i)return this._gateway.unsubscribeDataChannel(i,n.uid)}),r()}}else x.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(Ro.UPDATE_GATEWAY_CONFIG,()=>{(function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(n){return void x.error("Error loading sdk config",n.message)}if(e)try{const n=JSON.parse(window.atob(e)),r=Date.now();Object.keys(n).forEach(i=>{const{value:c,type:u,expires:f}=n[i];f&&f<=r||u||AR()||!Object.prototype.hasOwnProperty.call(ny,i)||(rc[i]=c,br[i]=c,x.debug("Update gateway parameters from config distribute",i,c))})}catch(n){x.error("Error update config from local cache",n.message)}})()}),this._gateway.on(Ro.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(Ro.CONNECTION_STATE_CHANGE,(e,n,r)=>{var i;if(r===Yn.FALLBACK)return;const c=()=>{this.safeEmit(Rn.CONNECTION_STATE_CHANGE,e,n,r)};if(Bt.reportApiInvoke(this._sessionId||((i=this._gateway.joinInfo)===null||i===void 0?void 0:i.sid)||null,{name:oo.CONNECTION_STATE_CHANGE,options:[e,n,r],tag:Fr.TRACER}).onSuccess(JSON.stringify({cur:e,prev:n,reason:r})),x.info("[".concat(this._clientId,"] signal connection state change: ").concat(n," -> ").concat(e)),e==="DISCONNECTED")return this._reset(),void c();if(e==="RECONNECTING")this._users.forEach(f=>{f._trust_in_room_=!1,f._trust_audio_enabled_state_=!1,f._trust_video_enabled_state_=!1,f._trust_audio_mute_state_=!1,f._trust_video_mute_state_=!1,f._trust_audio_stream_added_state_=!1,f._trust_video_stream_added_state_=!1,f._is_pre_created||(f._audio_pre_subscribed||(f._audioSSRC=void 0,f._audioOrtc=void 0),f._video_pre_subscribed||(f._videoSSRC=void 0,f._videoOrtc=void 0,f._rtxSsrcId=void 0),f._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(e==="CONNECTED"){var u;this._streamFallbackTypeCacheMap.forEach((f,m)=>{this._gateway.setStreamFallbackOption(m,f).catch(_=>{x.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_)})}),this._remoteStreamTypeCacheMap.forEach((f,m)=>{this._gateway.setRemoteVideoStreamType(m,f).catch(_=>{x.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_)})}),this._remoteDefaultVideoStreamType!==void 0&&((u=this._joinInfo)===null||u===void 0?void 0:u.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{x.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(f=>{x.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(f))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(f=>!f._trust_in_room_).forEach(f=>{x.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(f.uid)),this._handleUserOffline({uid:f.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(f=>{f._trust_audio_mute_state_||(x.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,kt.AUDIO,!1)),f._trust_video_mute_state_||(x.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(f.uid)),this._handleMuteStream(f.uid,kt.VIDEO,!1)),f._trust_audio_enabled_state_||(x.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(f.uid)),this._handleSetStreamLocalEnable("audio",f.uid,!0)),f._trust_video_enabled_state_||(x.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(f.uid)),this._handleSetStreamLocalEnable("video",f.uid,!0)),f._trust_video_stream_added_state_||(x.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(f.uid)),this._handleResetAddStream(f,"video")),f._trust_audio_stream_added_state_||(x.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(f.uid)),this._handleResetAddStream(f,"audio")),f._video_added_||f._audio_added_||(x.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(f.uid)),this._handleRemoveStream({uid:f.uid,uint_id:f._uintid}))}))},1e3))}c()}),this._gateway.on(Ro.REQUEST_NEW_GATEWAY_LIST,async(e,n)=>{if(!this._joinInfo)return n(new Ue(oe.UNEXPECTED_ERROR,"can not recover, no join info"));try{let r;const i=await y3(Na(Na({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));i?(r=i.ap,T3(i),this._joinInfo.preload=!0):(r=await JR(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||so,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=r.gatewayInfo.res,this._joinInfo.gatewayAddrs=r.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=r.gatewayInfo.uni_lbs_ip);const c=[];r.gatewayInfo.gatewayAddrs.forEach(u=>{let{address:f}=u;const[m,_]=f.split(":");this._joinInfo&&this._joinInfo.proxyServer?c.push({proxy:this._joinInfo.proxyServer,host:m,port:_}):c.push({host:m,port:_})}),e(c)}catch(r){n(r)}}),this._gateway.on(Ro.NETWORK_QUALITY,e=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(Rn.NETWORK_QUALITY,e)}),this._gateway.on(Ro.STREAM_TYPE_CHANGE,(e,n)=>{this.safeEmit(Rn.STREAM_TYPE_CHANGED,e,n),Bt.reportApiInvoke(this._sessionId,{name:oo.STREAM_TYPE_CHANGE,options:[e,n],tag:Fr.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:n}))}),this._gateway.on(Ro.IS_P2P_DISCONNECTED,e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)}),this._gateway.on(Ro.REQUEST_P2P_CONNECTION_PARAMS,async(e,n,r)=>{try{let i=await this._p2pChannel.getEstablishParams();de("ENABLE_PREALLOC_PC")&&i||(i=await this._p2pChannel.startP2PConnection(e)),n(i)}catch(i){r(i)}}),this._gateway.on(Ro.JOIN_RESPONSE,(e,n)=>{if(this.store.useP2P)return;let r;e.attributes?r=e.attributes.userAttributes.preSubSsrcs:x.debug("no attributes in joinResponse");const i=_B(e.ortc,n,r);this._p2pChannel.connect(i)}),this._gateway.on(Ro.PRE_CONNECT_PC,async e=>{const{candidates:n,fingerprint:r}=e;if(this._joinInfo&&n.length>0&&!this._p2pChannel.isPlanB){var i;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:c,cid:u}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(u,"_").concat(c),icePwd:"".concat(u,"_").concat(c)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(i=de("FINGERPRINT"))!==null&&i!==void 0?i:r}]},candidates:n,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(An.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(An.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(An.ON_ADD_AUDIO_STREAM,e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc)),this._gateway.signal.on(An.ON_ADD_VIDEO_STREAM,e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId)),this._gateway.signal.on(An.ON_REMOTE_DATASTREAM_UPDATE,e=>{this._handleUpdateDataChannel(e)}),this._gateway.signal.on(An.ON_REMOTE_FULL_DATASTREAM_INFO,e=>{this._handleUpdateDataChannel({added:e.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(An.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(An.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(An.MUTE_AUDIO,e=>this._handleMuteStream(e.uid,kt.AUDIO,!0)),this._gateway.signal.on(An.UNMUTE_AUDIO,e=>this._handleMuteStream(e.uid,kt.AUDIO,!1)),this._gateway.signal.on(An.MUTE_VIDEO,e=>this._handleMuteStream(e.uid,kt.VIDEO,!0)),this._gateway.signal.on(An.UNMUTE_VIDEO,e=>this._handleMuteStream(e.uid,kt.VIDEO,!1)),this._gateway.signal.on(An.RECEIVE_METADATA,e=>{const n=Ud(e.metadata);this.safeEmit(Rn.RECEIVE_METADATA,e.uid,n)}),this._gateway.signal.on(An.ON_DATA_STREAM,async e=>{var n;if(!e)return;let r=Ud(e.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&gt(n=["aes-128-gcm2","aes-256-gcm2"]).call(n,this._encryptionMode)){if(e.payload.length<Df)throw new Ue(oe.UNEXPECTED_RESPONSE,"payload length ".concat(e.payload.length," is less than header length ").concat(Df));r=await async function(u,f,m){const _=m.subarray(0,Df),y=_.slice(8,Df),T=(y[0]<<8)+y[1],A=(_[6]<<8)+_[7],k=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u,tagLength:NU,additionalData:new Uint8Array(gU(T,2))},f,m.subarray(Df));return new Uint8Array(k).subarray(0,A)}(this._encryptDataStreamIv,this._encryptDataStreamKey,r)}let i=0;if(e.ordered||e.syncWithAudio){const c=this._p2pChannel.getStats(),u=this.remoteUsers.find(m=>m.uid===e.uid),f=c==null?void 0:c.audioRecv.find(m=>m.ssrc===(u==null?void 0:u._audioSSRC));i=f==null?void 0:f.jitterBufferMs}(i==null||Number.isNaN(i))&&(i=0),Wce(Na(Na({},e),{},{payload:r}),i,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(An.ON_CRYPT_ERROR,()=>{wu(()=>{x.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(Rn.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(An.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(An.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{x.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Yn.TOKEN_EXPIRE),this.safeEmit(Rn.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(An.ON_STREAM_FALLBACK_UPDATE,e=>{x.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(Rn.STREAM_FALLBACK,e.stream_id,e.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(An.ON_PUBLISH_STREAM,e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),x.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))}),this._gateway.signal.on(An.ENABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)}),this._gateway.signal.on(An.DISABLE_LOCAL_VIDEO,e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)}),this._gateway.signal.on(cn.REQUEST_TIMEOUT,(e,n)=>{if(this._joinInfo)switch(e){case nn.PUBLISH:{if(!n)return;const c=n.ortc;if(c){var r,i;const u=c.some(_=>{let{stream_type:y}=_;return y===Jn.Audio}),f=c.some(_=>{let{stream_type:y}=_;return y!==Jn.Audio}),m=c.some(_=>{let{stream_type:y}=_;return y===Jn.Screen||y===Jn.ScreenLow});n.state==="offer"&&Bt.publish(this._joinInfo.sid,{eventElapse:Yo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:oe.TIMEOUT,audio:u,video:f,p2pid:n.p2p_id,publishRequestid:this.store.pubId,screenshare:m,audioName:u?(r=c.find(_=>{let{stream_type:y}=_;return y===Jn.Audio}))===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId.toString():void 0,videoName:f?(i=c.find(_=>{let{stream_type:y}=_;return y!==Jn.Audio}))===null||i===void 0||(i=i.ssrcs[0])===null||i===void 0?void 0:i.ssrcId.toString():void 0})}break}case nn.SUBSCRIBE:n&&Bt.subscribe(this._joinInfo.sid,{succ:!1,ec:oe.TIMEOUT,audio:n.stream_type===kt.AUDIO,video:n.stream_type===kt.VIDEO,peerid:n.stream_id,subscribeRequestid:n.ssrcId,p2pid:this.store.p2pId,eventElapse:Yo.measureFromSubscribeStart(this.store.clientId,n.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(n.ssrcId)})}}),this._gateway.signal.on(An.ON_P2P_OK,e=>{this.uid,this._uid}),this._gateway.signal.on(An.ON_PUBLISHED_USER_LIST,e=>{if(e==null||!e.users)return;de("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter(i=>!Gd(i.string_id||i.stream_id,this.channelName)));const n=[],r=[];for(const i of e.users){let c=this._users.find(T=>T._uintid===i.stream_id);c?c._trust_in_room_=!0:(c=new Lu(i.string_id||i.stream_id,i.stream_id),this._users.push(c),this.getListeners(Rn.PUBLISHED_USER_LIST).length===0&&(x.debug("[".concat(this._clientId,"] user online"),i.stream_id),this.safeEmit(Rn.USER_JOINED,c)));const u=So.Audio&i.stream_type,f=(So.Video|So.LwoVideo)&i.stream_type,m=(65280&i.stream_type)!=0,_=u&&c.hasAudio,y=f&&c.hasVideo;f&&(c._trust_video_stream_added_state_=!0,c._video_added_=!0,c._videoSSRC=i.video_ssrc,c._rtxSsrcId=i.video_rtx),u&&(c._trust_audio_stream_added_state_=!0,c._audio_added_=!0,c._audioSSRC=i.audio_ssrc),u&&!_&&this.getListeners(Rn.PUBLISHED_USER_LIST).length===0&&(x.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published audio")),this.safeEmit(Rn.USER_PUBLISHED,c,"audio")),f&&!y&&this.getListeners(Rn.PUBLISHED_USER_LIST).length===0&&(x.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published video")),this.safeEmit(Rn.USER_PUBLISHED,c,"video")),(u&&!_||f&&!y||m)&&n.push(c),f&&this._p2pChannel.hasPendingRemoteMedia(c,"video")&&r.push({user:c,mediaType:"video"}),u&&this._p2pChannel.hasPendingRemoteMedia(c,"audio")&&r.push({user:c,mediaType:"audio"})}r.length>0&&(x.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(r.map(i=>"user: ".concat(i.user.uid,", mediaType: ").concat(i.mediaType)).join("; ")," ")),this.massSubscribe(r).catch(i=>{x.error("[".concat(this._clientId,"] mass resubscribe error"),i.toString())})),this.getListeners(Rn.PUBLISHED_USER_LIST).length>0?de("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=n:(x.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(n.map(i=>i.uid).join(", "))),this.safeEmit(Rn.PUBLISHED_USER_LIST,n)):x.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(n.map(i=>i.uid).join(", ")))}),this._gateway.signal.on(An.ON_RTP_CAPABILITY_CHANGE,e=>{const{video_codec:n}=e;this._p2pChannel instanceof wv&&this._p2pChannel.updateRemoteRTPCapabilities(n.map(r=>r.toLowerCase()).filter(r=>{var i;return gt(i=Object.keys(ry)).call(i,r)}))})}_handleP2PEvents(){this._gateway.signal.on(An.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(qr.PUBLISH,(e,n,r)=>{const{uid:i}=e;e.forEach(c=>{const{kind:u,ssrcs:f,mid:m,isMuted:_}=c;this._handleP2PAddAudioOrVideoStream(u,i,f[0].ssrcId,m);const y=this._users.find(T=>T.uid===i);return y&&this.store.useP2P?this._p2pChannel.mockSubscribe(y,u,f[0].ssrcId,m).then(()=>{n()}).catch(r):n(),this._handleMuteStream(i,u,!!_)})}),this._gateway.signal.on(qr.CALL,async(e,n,r)=>{if(this.store.useP2P)try{var i;n(await this._p2pChannel.startP2P({turnServer:(i=this._joinInfo)===null||i===void 0?void 0:i.turnServer},e))}catch(c){r(c)}}),this._gateway.signal.on(cn.P2P_CONNECTION,async e=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(e)}),this._gateway.signal.on(qr.UNPUBLISH,async(e,n,r)=>{if(this.store.useP2P){const{unpubMsg:i,uid:c}=e,u=this._users.find(f=>f.uid===c);if(!u)return x.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(c)),void n();try{i.forEach(async f=>{let{stream_type:m}=f;const _=m===Jn.Audio?kt.AUDIO:kt.VIDEO;await this._p2pChannel.unsubscribe(u,_),this._handleMuteStream(c,_,!0)}),n()}catch(f){r(f)}}}),this._gateway.signal.on(qr.CONTROL,async(e,n)=>{const{action:r}=e;switch(r){case Ou.MUTE_LOCAL_VIDEO:this._handleMuteStream(n,kt.VIDEO,!0);break;case Ou.MUTE_LOCAL_AUDIO:this._handleMuteStream(n,kt.AUDIO,!0);break;case Ou.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",n),this._handleMuteStream(n,kt.VIDEO,!1);break;case Ou.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",n),this._handleMuteStream(n,kt.AUDIO,!1)}}),this._gateway.signal.on(qr.RESTART_ICE,async(e,n,r)=>{if(this.store.useP2P)try{const{direction:i,iceParameter:c}=e;i!==Es.SEND_ONLY||c?n(await this._p2pChannel.restartICE(i,c)):(this._p2pChannel.handleDisconnect(i),n())}catch(i){r(i)}}),this._gateway.signal.on(qr.CANDIDATE,e=>{if(this.store.useP2P){const{candidate:n,direction:r}=e;this._p2pChannel.addRemoteCandidate(n,r)}}),this._p2pChannel.on(Kt.RequestP2PRestartICE,async(e,n,r)=>{try{const{direction:i}=e;n(await this._gateway.sendExtensionMessage(qr.RESTART_ICE,e,i===Es.SEND_ONLY))}catch(i){r(i)}}),this._p2pChannel.on(Kt.LocalCandidate,e=>{this._gateway.sendExtensionMessage(qr.CANDIDATE,JSON.stringify(e),!0)}),this._p2pChannel.on(Kt.RequestP2PMuteLocal,async(e,n,r)=>{try{await this._gateway.sendExtensionMessage(qr.CONTROL,e,!0),n()}catch(i){r(i)}}),this._p2pChannel.on(Kt.RequestP2PUnmuteRemote,async(e,n,r)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(i){i.code===oe.DISCONNECT_P2P?n():r(i)}else n()}),this._p2pChannel.on(Kt.RequestP2PMuteRemote,async(e,n,r)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(i){i.code===oe.DISCONNECT_P2P?n():r(i)}else n()}),this._p2pChannel.on(Kt.StateChange,(e,n)=>{n===qn.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Kt.PeerConnectionStateChange,e=>{const n=this._peerConnectionState;e!==n&&(this.safeEmit(Rn.PEERCONNECTION_STATE_CHANGE,e,n),this._peerConnectionState=e)}),this._p2pChannel.on(Kt.RequestMuteLocal,async(e,n,r)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(i){i.code===oe.DISCONNECT_P2P?n():r(i)}else n()}),this._p2pChannel.on(Kt.RequestUnmuteLocal,async(e,n,r)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),n()}catch(i){i.code===oe.DISCONNECT_P2P?n():r(i)}else n()}),this._p2pChannel.on(Kt.RequestRePublish,(e,n,r)=>{this.publish(e,!1).then(n).catch(r)}),this._p2pChannel.on(Kt.RequestRePublishDataChannel,(e,n,r)=>{bt.all(e.map(async i=>{const c=await this._p2pChannel.publishDataChannel([i]);try{c.forEach(u=>{this._uid&&this._gateway.publishDataChannel(this._uid,u,!0)})}catch(u){if(u.code!==oe.DISCONNECT_P2P)throw u}})).then(n).catch(r)}),this._p2pChannel.on(Kt.RequestReSubscribe,async(e,n,r)=>{try{for(const{user:i,kind:c}of e)c===kt.VIDEO?await this.subscribe(i,"video"):await this.subscribe(i,"audio");n()}catch(i){r(i)}}),this._p2pChannel.on(Kt.RequestUpload,(e,n)=>{this._gateway.upload(e,n)}),this._p2pChannel.on(Kt.RequestUploadStats,e=>{this._gateway.uploadWRTCStats(e)}),this._p2pChannel.on(Kt.MediaReconnectStart,e=>{this.safeEmit(Rn.MEDIA_RECONNECT_START,e)}),this._p2pChannel.on(Kt.MediaReconnectEnd,e=>{this.safeEmit(Rn.MEDIA_RECONNECT_END,e)}),this._p2pChannel.on(Kt.NeedSignalRTT,e=>{e(this._gateway.getSignalRTT())}),this._p2pChannel.on(Kt.RequestRestartICE,async e=>{if(this.store.useP2P)return;const n=await this._p2pChannel.restartICE(e),r=await n.next();if(r.done)return;const i=r.value;let c;try{c=await this._gateway.restartICE({iceParameters:i})}catch(f){return void n.throw(f)}const{iceParameters:u}=function(f){const m=f.iceParameters;return{iceParameters:{iceUfrag:m.iceUfrag,icePwd:m.icePwd}}}(c);await n.next({remoteIceParameters:u})}),this._p2pChannel.on(Kt.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Kt.RequestReconnectPC,async()=>{var e;const{iceParameters:n,dtlsParameters:r,rtpCapabilities:i}=await this._p2pChannel.startP2PConnection({turnServer:(e=this._joinInfo)===null||e===void 0?void 0:e.turnServer}),{gatewayEstablishParams:c,gatewayAddress:u}=await this._gateway.reconnectPC({iceParameters:n,dtlsParameters:r,rtpCapabilities:i}),f=_B(c,u);await this._p2pChannel.connect(f),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Kt.RequestUnpublishForReconnectPC,async(e,n,r)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(e,this._uid),n()):r()}),this._p2pChannel.on(Kt.P2PLost,()=>{this.safeEmit(Rn.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Kt.UpdateVideoEncoder,e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)}),this._p2pChannel.on(Kt.ConnectionTypeChange,e=>{this.safeEmit(Rn.IS_USING_CLOUD_PROXY,e)}),this._p2pChannel.on(Kt.RequestLowStreamParameter,e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Kt.QueryClientConnectionState,e=>{e(this.connectionState)}),this._p2pChannel.on(Kt.AudioMetadata,e=>{this.safeEmit(Rn.AUDIO_METADATA,e)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const r=(n={config:e},Ml("ContentInspect").create(n));this._inspect=r,this.handleVideoInspectEvents(r);const{appId:i,cname:c,sid:u,token:f,uid:m,cid:_,vid:y}=this._joinInfo;await r.init({appId:i,areaCode:"",cname:c,sid:u,token:f,uid:m,cid:_,vid:y?Number(y):0},so)}catch(r){throw Array.isArray(r)?r[0]:r}var n}handleVideoInspectEvents(e){e.on(Io.CONNECTION_STATE_CHANGE,(n,r)=>{if(this.safeEmit(Rn.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,n,r),r===Ra.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(Rn.CONTENT_INSPECT_ERROR,new Ue(oe.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}}),e.on(Io.INSPECT_RESULT,(n,r)=>{var i;if((r==null?void 0:r.code)===oe.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return x.debug("Stop inspect content because that has left channel"),this==null||(i=this._inspect)===null||i===void 0||i.close(),void(this._inspect=void 0);this.safeEmit(Rn.CONTENT_INSPECT_RESULT,n,r)}),e.on(Io.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,n){if(Al(e,"enabled"),e){if(!n)throw new Ue(oe.INVALID_PARAMS,"config is required");if(x3(n),!this._joinInfo)throw new Ue(oe.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(n);else{const i=(r={config:n},Ml("ImageModeration").create(r));this._moderation=i,this.handleImageModerationEvents(i);const{appId:c,cname:u,sid:f,token:m,uid:_,cid:y,vid:T}=this._joinInfo;await i.init({appId:c,areaCode:"",cname:u,sid:f,token:m,uid:_,cid:y,vid:T?Number(T):0},so)}}catch(i){throw Array.isArray(i)?i[0]:i}}else{var r;if(!this._moderation)throw new Ue(oe.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(i){throw Array.isArray(i)?i[0]:i}}}handleImageModerationEvents(e){e.on(ic.CONNECTION_STATE_CHANGE,(n,r)=>{if(this.safeEmit(Rn.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,n,r),n===Ji.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new Ue(oe.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}}),e.on(ic.CLIENT_LOCAL_VIDEO_TRACK,n=>{n(this.localTracks.filter(r=>r.trackMediaType==="video")[0])})}setP2PTransport(e){if(function(n){vo(n,"transport",["default","auto","relay","sd-rtn"])}(e),this.mode!=="p2p")throw new Ue(oe.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,x.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}getJoinChannelServiceRecords(){return x.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){Al(e,"enabled"),tr("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,n){switch(n){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}},Lt(Rt.prototype,"leave",[U3],Object.getOwnPropertyDescriptor(Rt.prototype,"leave"),Rt.prototype),Lt(Rt.prototype,"publish",[V3],Object.getOwnPropertyDescriptor(Rt.prototype,"publish"),Rt.prototype),Lt(Rt.prototype,"unpublish",[F3],Object.getOwnPropertyDescriptor(Rt.prototype,"unpublish"),Rt.prototype),Lt(Rt.prototype,"subscribe",[B3],Object.getOwnPropertyDescriptor(Rt.prototype,"subscribe"),Rt.prototype),Lt(Rt.prototype,"presubscribe",[j3],Object.getOwnPropertyDescriptor(Rt.prototype,"presubscribe"),Rt.prototype),Lt(Rt.prototype,"massSubscribe",[$3],Object.getOwnPropertyDescriptor(Rt.prototype,"massSubscribe"),Rt.prototype),Lt(Rt.prototype,"unsubscribe",[H3],Object.getOwnPropertyDescriptor(Rt.prototype,"unsubscribe"),Rt.prototype),Lt(Rt.prototype,"massUnsubscribe",[W3],Object.getOwnPropertyDescriptor(Rt.prototype,"massUnsubscribe"),Rt.prototype),Lt(Rt.prototype,"setLowStreamParameter",[K3],Object.getOwnPropertyDescriptor(Rt.prototype,"setLowStreamParameter"),Rt.prototype),Lt(Rt.prototype,"enableDualStream",[G3],Object.getOwnPropertyDescriptor(Rt.prototype,"enableDualStream"),Rt.prototype),Lt(Rt.prototype,"disableDualStream",[z3],Object.getOwnPropertyDescriptor(Rt.prototype,"disableDualStream"),Rt.prototype),Lt(Rt.prototype,"setClientRole",[Y3],Object.getOwnPropertyDescriptor(Rt.prototype,"setClientRole"),Rt.prototype),Lt(Rt.prototype,"_setClientRoleOptions",[q3],Object.getOwnPropertyDescriptor(Rt.prototype,"_setClientRoleOptions"),Rt.prototype),Lt(Rt.prototype,"setProxyServer",[X3],Object.getOwnPropertyDescriptor(Rt.prototype,"setProxyServer"),Rt.prototype),Lt(Rt.prototype,"setTurnServer",[J3],Object.getOwnPropertyDescriptor(Rt.prototype,"setTurnServer"),Rt.prototype),Lt(Rt.prototype,"setLicense",[Z3],Object.getOwnPropertyDescriptor(Rt.prototype,"setLicense"),Rt.prototype),Lt(Rt.prototype,"startProxyServer",[Q3],Object.getOwnPropertyDescriptor(Rt.prototype,"startProxyServer"),Rt.prototype),Lt(Rt.prototype,"stopProxyServer",[e4],Object.getOwnPropertyDescriptor(Rt.prototype,"stopProxyServer"),Rt.prototype),Lt(Rt.prototype,"setLocalAccessPointsV2",[t4],Object.getOwnPropertyDescriptor(Rt.prototype,"setLocalAccessPointsV2"),Rt.prototype),Lt(Rt.prototype,"setLocalAccessPoints",[n4],Object.getOwnPropertyDescriptor(Rt.prototype,"setLocalAccessPoints"),Rt.prototype),Lt(Rt.prototype,"setRemoteDefaultVideoStreamType",[r4],Object.getOwnPropertyDescriptor(Rt.prototype,"setRemoteDefaultVideoStreamType"),Rt.prototype),Lt(Rt.prototype,"setRemoteVideoStreamType",[o4],Object.getOwnPropertyDescriptor(Rt.prototype,"setRemoteVideoStreamType"),Rt.prototype),Lt(Rt.prototype,"setStreamFallbackOption",[s4],Object.getOwnPropertyDescriptor(Rt.prototype,"setStreamFallbackOption"),Rt.prototype),Lt(Rt.prototype,"setEncryptionConfig",[i4],Object.getOwnPropertyDescriptor(Rt.prototype,"setEncryptionConfig"),Rt.prototype),Lt(Rt.prototype,"renewToken",[a4],Object.getOwnPropertyDescriptor(Rt.prototype,"renewToken"),Rt.prototype),Lt(Rt.prototype,"enableAudioVolumeIndicator",[c4],Object.getOwnPropertyDescriptor(Rt.prototype,"enableAudioVolumeIndicator"),Rt.prototype),Lt(Rt.prototype,"startLiveStreaming",[l4],Object.getOwnPropertyDescriptor(Rt.prototype,"startLiveStreaming"),Rt.prototype),Lt(Rt.prototype,"setLiveTranscoding",[u4],Object.getOwnPropertyDescriptor(Rt.prototype,"setLiveTranscoding"),Rt.prototype),Lt(Rt.prototype,"stopLiveStreaming",[d4],Object.getOwnPropertyDescriptor(Rt.prototype,"stopLiveStreaming"),Rt.prototype),Lt(Rt.prototype,"startChannelMediaRelay",[h4],Object.getOwnPropertyDescriptor(Rt.prototype,"startChannelMediaRelay"),Rt.prototype),Lt(Rt.prototype,"updateChannelMediaRelay",[f4],Object.getOwnPropertyDescriptor(Rt.prototype,"updateChannelMediaRelay"),Rt.prototype),Lt(Rt.prototype,"stopChannelMediaRelay",[p4],Object.getOwnPropertyDescriptor(Rt.prototype,"stopChannelMediaRelay"),Rt.prototype),Lt(Rt.prototype,"sendCustomReportMessage",[m4],Object.getOwnPropertyDescriptor(Rt.prototype,"sendCustomReportMessage"),Rt.prototype),Lt(Rt.prototype,"pickSVCLayer",[v4],Object.getOwnPropertyDescriptor(Rt.prototype,"pickSVCLayer"),Rt.prototype),Lt(Rt.prototype,"setRTMConfig",[g4],Object.getOwnPropertyDescriptor(Rt.prototype,"setRTMConfig"),Rt.prototype),Lt(Rt.prototype,"enableContentInspect",[_4],Object.getOwnPropertyDescriptor(Rt.prototype,"enableContentInspect"),Rt.prototype),Lt(Rt.prototype,"disableContentInspect",[E4],Object.getOwnPropertyDescriptor(Rt.prototype,"disableContentInspect"),Rt.prototype),Lt(Rt.prototype,"setImageModeration",[y4],Object.getOwnPropertyDescriptor(Rt.prototype,"setImageModeration"),Rt.prototype),Lt(Rt.prototype,"setP2PTransport",[b4],Object.getOwnPropertyDescriptor(Rt.prototype,"setP2PTransport"),Rt.prototype),Lt(Rt.prototype,"getJoinChannelServiceRecords",[S4],Object.getOwnPropertyDescriptor(Rt.prototype,"getJoinChannelServiceRecords"),Rt.prototype),Lt(Rt.prototype,"setPublishAudioFilterEnabled",[T4],Object.getOwnPropertyDescriptor(Rt.prototype,"setPublishAudioFilterEnabled"),Rt.prototype),Rt);class Av{constructor(n,r){Q(this,"id",0),Q(this,"element",void 0),Q(this,"peerPair",void 0),Q(this,"context",void 0),Q(this,"audioPlayerElement",void 0),Q(this,"audioTrack",void 0),Av.count+=1,this.id=Av.count,this.element=n,this.context=r}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=n=>{const r=document.createElement("audio");r.srcObject=new MediaStream([n.track]),r.play(),this.audioPlayerElement=r}}async switchSdp(){if(!this.peerPair)return;const n=async(i,c)=>{const u=c==="offer"?await i.createOffer():await i.createAnswer();return await i.setLocalDescription(u),i.iceGatheringState==="complete"?i.localDescription:new bt(f=>{i.onicegatheringstatechange=()=>{i.iceGatheringState==="complete"&&f(i.localDescription)}})},r=async(i,c)=>await i.setRemoteDescription(c);try{const i=await n(this.peerPair[0],"offer");await r(this.peerPair[1],i);const c=await n(this.peerPair[1],"answer");await r(this.peerPair[0],c)}catch(i){throw new Ue(oe.LOCAL_AEC_ERROR,i.toString()).print()}}async getTracksFromMediaElement(n){if(this.audioTrack)return this.audioTrack;let r;try{n instanceof HTMLVideoElement&&(n.captureStream?n.captureStream():n.mozCaptureStream()),r=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(n).connect(r)}catch(c){throw new Ue(oe.LOCAL_AEC_ERROR,c.toString()).print()}if(!r)throw new Ue(oe.LOCAL_AEC_ERROR,"no dest node when local aec").print();const i=r.stream.getAudioTracks()[0];return this.audioTrack=i,i}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const n=this.element,r=await this.getTracksFromMediaElement(n);this.peerPair&&this.peerPair[0].addTrack(r),await this.switchSdp()}close(){x.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(n=>{n.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var w4,qy;Q(Av,"count",0);const ale=window.AudioContext||window.webkitAudioContext,cle=new(w4=Xt({report:Bt}),Lt((qy=class{constructor(){Q(this,"units",[]),Q(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return x.debug("the system does not need to process local aec"),-1;this.context||(this.context=new ale);let n=this.units.find(r=>r&&r.getElement()===e);return n||(n=new Av(e,this.context),this.units.push(n)),n.startEchoCancellation(),x.debug("start processing local audio echo cancellation, id is",n.id),n.id}_doesEnvironmentNeedAEC(){return Mn().name!==jn.SAFARI}}).prototype,"processExternalMediaAEC",[w4],Object.getOwnPropertyDescriptor(qy.prototype,"processExternalMediaAEC"),qy.prototype),qy);function R4(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function I4(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?R4(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}const fI=window||document;function A4(e){let n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!fI)return;const r=io._cspEventHandlerPointer;if(r&&n)return void console.error(r,n);const i=c=>{if(!(c&&c.blockedURI&&(io.onSecurityPolicyViolation||io.getListeners(Hc.SECURITY_POLICY_VIOLATION).length>0)))return;const u=c.blockedURI;de("CSP_DETECTED_HOSTNAME_LIST").some(f=>gt(u).call(u,f))&&(io.onSecurityPolicyViolation&&typeof io.onSecurityPolicyViolation=="function"&&io.onSecurityPolicyViolation(c),io.getListeners(Hc.SECURITY_POLICY_VIOLATION).length>0&&io.safeEmit(Hc.SECURITY_POLICY_VIOLATION,c))};r&&fI.removeEventListener("securitypolicyviolation",r),(n||e&&typeof e=="function"||io.getListeners(Hc.SECURITY_POLICY_VIOLATION).length>0)&&fI.addEventListener("securitypolicyviolation",i),io._cspEventHandlerPointer=i}var lle=C,ule=dx,O4=RegExp.prototype,dle=function(e){return e===O4||lle(O4,e)?ule(e):e.flags},os=l(dle);function ip(e){let n=e.length;for(;--n>=0;)e[n]=0}const pI=256,N4=286,Ov=30,Nv=15,mI=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Xy=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),hle=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),k4=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vl=new Array(576);ip(Vl);const kv=new Array(60);ip(kv);const Pv=new Array(512);ip(Pv);const Dv=new Array(256);ip(Dv);const vI=new Array(29);ip(vI);const Jy=new Array(Ov);function gI(e,n,r,i,c){this.static_tree=e,this.extra_bits=n,this.extra_base=r,this.elems=i,this.max_length=c,this.has_stree=e&&e.length}let P4,D4,L4;function _I(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}ip(Jy);const M4=e=>e<256?Pv[e]:Pv[256+(e>>>7)],Lv=(e,n)=>{e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255},Mi=(e,n,r)=>{e.bi_valid>16-r?(e.bi_buf|=n<<e.bi_valid&65535,Lv(e,e.bi_buf),e.bi_buf=n>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=r)},Yc=(e,n,r)=>{Mi(e,r[2*n],r[2*n+1])},x4=(e,n)=>{let r=0;do r|=1&e,e>>>=1,r<<=1;while(--n>0);return r>>>1},U4=(e,n,r)=>{const i=new Array(16);let c,u,f=0;for(c=1;c<=Nv;c++)f=f+r[c-1]<<1,i[c]=f;for(u=0;u<=n;u++){let m=e[2*u+1];m!==0&&(e[2*u]=x4(i[m]++,m))}},V4=e=>{let n;for(n=0;n<N4;n++)e.dyn_ltree[2*n]=0;for(n=0;n<Ov;n++)e.dyn_dtree[2*n]=0;for(n=0;n<19;n++)e.bl_tree[2*n]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},F4=e=>{e.bi_valid>8?Lv(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},B4=(e,n,r,i)=>{const c=2*n,u=2*r;return e[c]<e[u]||e[c]===e[u]&&i[n]<=i[r]},EI=(e,n,r)=>{const i=e.heap[r];let c=r<<1;for(;c<=e.heap_len&&(c<e.heap_len&&B4(n,e.heap[c+1],e.heap[c],e.depth)&&c++,!B4(n,i,e.heap[c],e.depth));)e.heap[r]=e.heap[c],r=c,c<<=1;e.heap[r]=i},j4=(e,n,r)=>{let i,c,u,f,m=0;if(e.sym_next!==0)do i=255&e.pending_buf[e.sym_buf+m++],i+=(255&e.pending_buf[e.sym_buf+m++])<<8,c=e.pending_buf[e.sym_buf+m++],i===0?Yc(e,c,n):(u=Dv[c],Yc(e,u+pI+1,n),f=mI[u],f!==0&&(c-=vI[u],Mi(e,c,f)),i--,u=M4(i),Yc(e,u,r),f=Xy[u],f!==0&&(i-=Jy[u],Mi(e,i,f)));while(m<e.sym_next);Yc(e,256,n)},yI=(e,n)=>{const r=n.dyn_tree,i=n.stat_desc.static_tree,c=n.stat_desc.has_stree,u=n.stat_desc.elems;let f,m,_,y=-1;for(e.heap_len=0,e.heap_max=573,f=0;f<u;f++)r[2*f]!==0?(e.heap[++e.heap_len]=y=f,e.depth[f]=0):r[2*f+1]=0;for(;e.heap_len<2;)_=e.heap[++e.heap_len]=y<2?++y:0,r[2*_]=1,e.depth[_]=0,e.opt_len--,c&&(e.static_len-=i[2*_+1]);for(n.max_code=y,f=e.heap_len>>1;f>=1;f--)EI(e,r,f);_=u;do f=e.heap[1],e.heap[1]=e.heap[e.heap_len--],EI(e,r,1),m=e.heap[1],e.heap[--e.heap_max]=f,e.heap[--e.heap_max]=m,r[2*_]=r[2*f]+r[2*m],e.depth[_]=(e.depth[f]>=e.depth[m]?e.depth[f]:e.depth[m])+1,r[2*f+1]=r[2*m+1]=_,e.heap[1]=_++,EI(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((T,A)=>{const k=A.dyn_tree,P=A.max_code,q=A.stat_desc.static_tree,j=A.stat_desc.has_stree,H=A.stat_desc.extra_bits,ne=A.stat_desc.extra_base,re=A.stat_desc.max_length;let ve,Oe,ke,we,Be,lt,St=0;for(we=0;we<=Nv;we++)T.bl_count[we]=0;for(k[2*T.heap[T.heap_max]+1]=0,ve=T.heap_max+1;ve<573;ve++)Oe=T.heap[ve],we=k[2*k[2*Oe+1]+1]+1,we>re&&(we=re,St++),k[2*Oe+1]=we,Oe>P||(T.bl_count[we]++,Be=0,Oe>=ne&&(Be=H[Oe-ne]),lt=k[2*Oe],T.opt_len+=lt*(we+Be),j&&(T.static_len+=lt*(q[2*Oe+1]+Be)));if(St!==0){do{for(we=re-1;T.bl_count[we]===0;)we--;T.bl_count[we]--,T.bl_count[we+1]+=2,T.bl_count[re]--,St-=2}while(St>0);for(we=re;we!==0;we--)for(Oe=T.bl_count[we];Oe!==0;)ke=T.heap[--ve],ke>P||(k[2*ke+1]!==we&&(T.opt_len+=(we-k[2*ke+1])*k[2*ke],k[2*ke+1]=we),Oe--)}})(e,n),U4(r,y,e.bl_count)},$4=(e,n,r)=>{let i,c,u=-1,f=n[1],m=0,_=7,y=4;for(f===0&&(_=138,y=3),n[2*(r+1)+1]=65535,i=0;i<=r;i++)c=f,f=n[2*(i+1)+1],++m<_&&c===f||(m<y?e.bl_tree[2*c]+=m:c!==0?(c!==u&&e.bl_tree[2*c]++,e.bl_tree[32]++):m<=10?e.bl_tree[34]++:e.bl_tree[36]++,m=0,u=c,f===0?(_=138,y=3):c===f?(_=6,y=3):(_=7,y=4))},H4=(e,n,r)=>{let i,c,u=-1,f=n[1],m=0,_=7,y=4;for(f===0&&(_=138,y=3),i=0;i<=r;i++)if(c=f,f=n[2*(i+1)+1],!(++m<_&&c===f)){if(m<y)do Yc(e,c,e.bl_tree);while(--m!=0);else c!==0?(c!==u&&(Yc(e,c,e.bl_tree),m--),Yc(e,16,e.bl_tree),Mi(e,m-3,2)):m<=10?(Yc(e,17,e.bl_tree),Mi(e,m-3,3)):(Yc(e,18,e.bl_tree),Mi(e,m-11,7));m=0,u=c,f===0?(_=138,y=3):c===f?(_=6,y=3):(_=7,y=4)}};let W4=!1;const K4=(e,n,r,i)=>{Mi(e,0+(i?1:0),3),F4(e),Lv(e,r),Lv(e,~r),r&&e.pending_buf.set(e.window.subarray(n,n+r),e.pending),e.pending+=r};var fle=e=>{W4||((()=>{let n,r,i,c,u;const f=new Array(16);for(i=0,c=0;c<28;c++)for(vI[c]=i,n=0;n<1<<mI[c];n++)Dv[i++]=c;for(Dv[i-1]=c,u=0,c=0;c<16;c++)for(Jy[c]=u,n=0;n<1<<Xy[c];n++)Pv[u++]=c;for(u>>=7;c<Ov;c++)for(Jy[c]=u<<7,n=0;n<1<<Xy[c]-7;n++)Pv[256+u++]=c;for(r=0;r<=Nv;r++)f[r]=0;for(n=0;n<=143;)Vl[2*n+1]=8,n++,f[8]++;for(;n<=255;)Vl[2*n+1]=9,n++,f[9]++;for(;n<=279;)Vl[2*n+1]=7,n++,f[7]++;for(;n<=287;)Vl[2*n+1]=8,n++,f[8]++;for(U4(Vl,287,f),n=0;n<Ov;n++)kv[2*n+1]=5,kv[2*n]=x4(n,5);P4=new gI(Vl,mI,257,N4,Nv),D4=new gI(kv,Xy,0,Ov,Nv),L4=new gI(new Array(0),hle,0,19,7)})(),W4=!0),e.l_desc=new _I(e.dyn_ltree,P4),e.d_desc=new _I(e.dyn_dtree,D4),e.bl_desc=new _I(e.bl_tree,L4),e.bi_buf=0,e.bi_valid=0,V4(e)},ple=(e,n,r,i)=>{let c,u,f=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=(m=>{let _,y=4093624447;for(_=0;_<=31;_++,y>>>=1)if(1&y&&m.dyn_ltree[2*_]!==0)return 0;if(m.dyn_ltree[18]!==0||m.dyn_ltree[20]!==0||m.dyn_ltree[26]!==0)return 1;for(_=32;_<pI;_++)if(m.dyn_ltree[2*_]!==0)return 1;return 0})(e)),yI(e,e.l_desc),yI(e,e.d_desc),f=(m=>{let _;for($4(m,m.dyn_ltree,m.l_desc.max_code),$4(m,m.dyn_dtree,m.d_desc.max_code),yI(m,m.bl_desc),_=18;_>=3&&m.bl_tree[2*k4[_]+1]===0;_--);return m.opt_len+=3*(_+1)+5+5+4,_})(e),c=e.opt_len+3+7>>>3,u=e.static_len+3+7>>>3,u<=c&&(c=u)):c=u=r+5,r+4<=c&&n!==-1?K4(e,n,r,i):e.strategy===4||u===c?(Mi(e,2+(i?1:0),3),j4(e,Vl,kv)):(Mi(e,4+(i?1:0),3),((m,_,y,T)=>{let A;for(Mi(m,_-257,5),Mi(m,y-1,5),Mi(m,T-4,4),A=0;A<T;A++)Mi(m,m.bl_tree[2*k4[A]+1],3);H4(m,m.dyn_ltree,_-1),H4(m,m.dyn_dtree,y-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,f+1),j4(e,e.dyn_ltree,e.dyn_dtree)),V4(e),i&&F4(e)},mle=(e,n,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=n,e.pending_buf[e.sym_buf+e.sym_next++]=n>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,n===0?e.dyn_ltree[2*r]++:(e.matches++,n--,e.dyn_ltree[2*(Dv[r]+pI+1)]++,e.dyn_dtree[2*M4(n)]++),e.sym_next===e.sym_end),vle=e=>{Mi(e,2,3),Yc(e,256,Vl),(n=>{n.bi_valid===16?(Lv(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(e)},gle={_tr_init:fle,_tr_stored_block:K4,_tr_flush_block:ple,_tr_tally:mle,_tr_align:vle},Mv=(e,n,r,i)=>{let c=65535&e|0,u=e>>>16&65535|0,f=0;for(;r!==0;){f=r>2e3?2e3:r,r-=f;do c=c+n[i++]|0,u=u+c|0;while(--f);c%=65521,u%=65521}return c|u<<16|0};const _le=new Uint32Array((()=>{let e,n=[];for(var r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;n[r]=e}return n})());var bs=(e,n,r,i)=>{const c=_le,u=i+r;e^=-1;for(let f=i;f<u;f++)e=e>>>8^c[255&(e^n[f])];return-1^e},th={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Zy={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ele,_tr_stored_block:bI,_tr_flush_block:yle,_tr_tally:Vu,_tr_align:ble}=gle,{Z_NO_FLUSH:Fu,Z_PARTIAL_FLUSH:Sle,Z_FULL_FLUSH:Tle,Z_FINISH:ka,Z_BLOCK:G4,Z_OK:Ps,Z_STREAM_END:z4,Z_STREAM_ERROR:qc,Z_DATA_ERROR:Cle,Z_BUF_ERROR:SI,Z_DEFAULT_COMPRESSION:wle,Z_FILTERED:Rle,Z_HUFFMAN_ONLY:Qy,Z_RLE:Ile,Z_FIXED:Ale,Z_DEFAULT_STRATEGY:Ole,Z_UNKNOWN:Nle,Z_DEFLATED:eb}=Zy,TI=286,kle=30,Ple=19,Dle=2*TI+1,Lle=15,nh=258,Xc=262,ap=42,rh=113,xv=666,oh=(e,n)=>(e.msg=th[n],n),Y4=e=>2*e-(e>4?9:0),Bu=e=>{let n=e.length;for(;--n>=0;)e[n]=0},Mle=e=>{let n,r,i,c=e.w_size;n=e.hash_size,i=n;do r=e.head[--i],e.head[i]=r>=c?r-c:0;while(--n);n=c,i=n;do r=e.prev[--i],e.prev[i]=r>=c?r-c:0;while(--n)};let ju=(e,n,r)=>(n<<e.hash_shift^r)&e.hash_mask;const Qi=e=>{const n=e.state;let r=n.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+r),e.next_out),e.next_out+=r,n.pending_out+=r,e.total_out+=r,e.avail_out-=r,n.pending-=r,n.pending===0&&(n.pending_out=0))},ea=(e,n)=>{yle(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,Qi(e.strm)},Gr=(e,n)=>{e.pending_buf[e.pending++]=n},Uv=(e,n)=>{e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n},CI=(e,n,r,i)=>{let c=e.avail_in;return c>i&&(c=i),c===0?0:(e.avail_in-=c,n.set(e.input.subarray(e.next_in,e.next_in+c),r),e.state.wrap===1?e.adler=Mv(e.adler,n,c,r):e.state.wrap===2&&(e.adler=bs(e.adler,n,c,r)),e.next_in+=c,e.total_in+=c,c)},q4=(e,n)=>{let r,i,c=e.max_chain_length,u=e.strstart,f=e.prev_length,m=e.nice_match;const _=e.strstart>e.w_size-Xc?e.strstart-(e.w_size-Xc):0,y=e.window,T=e.w_mask,A=e.prev,k=e.strstart+nh;let P=y[u+f-1],q=y[u+f];e.prev_length>=e.good_match&&(c>>=2),m>e.lookahead&&(m=e.lookahead);do if(r=n,y[r+f]===q&&y[r+f-1]===P&&y[r]===y[u]&&y[++r]===y[u+1]){u+=2,r++;do;while(y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&y[++u]===y[++r]&&u<k);if(i=nh-(k-u),u=k-nh,i>f){if(e.match_start=n,f=i,i>=m)break;P=y[u+f-1],q=y[u+f]}}while((n=A[n&T])>_&&--c!=0);return f<=e.lookahead?f:e.lookahead},cp=e=>{const n=e.w_size;let r,i,c;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-Xc)&&(e.window.set(e.window.subarray(n,n+n-i),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),Mle(e),i+=n),e.strm.avail_in===0)break;if(r=CI(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=ju(e,e.ins_h,e.window[c+1]);e.insert&&(e.ins_h=ju(e,e.ins_h,e.window[c+3-1]),e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Xc&&e.strm.avail_in!==0)},X4=(e,n)=>{let r,i,c,u=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,f=0,m=e.strm.avail_in;do{if(r=65535,c=e.bi_valid+42>>3,e.strm.avail_out<c||(c=e.strm.avail_out-c,i=e.strstart-e.block_start,r>i+e.strm.avail_in&&(r=i+e.strm.avail_in),r>c&&(r=c),r<u&&(r===0&&n!==ka||n===Fu||r!==i+e.strm.avail_in)))break;f=n===ka&&r===i+e.strm.avail_in?1:0,bI(e,0,0,f),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Qi(e.strm),i&&(i>r&&(i=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,r-=i),r&&(CI(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(f===0);return m-=e.strm.avail_in,m&&(m>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=m&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-m,e.strm.next_in),e.strstart),e.strstart+=m,e.insert+=m>e.w_size-e.insert?e.w_size-e.insert:m),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),f?4:n!==Fu&&n!==ka&&e.strm.avail_in===0&&e.strstart===e.block_start?2:(c=e.window_size-e.strstart,e.strm.avail_in>c&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,c+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),c>e.strm.avail_in&&(c=e.strm.avail_in),c&&(CI(e.strm,e.window,e.strstart,c),e.strstart+=c,e.insert+=c>e.w_size-e.insert?e.w_size-e.insert:c),e.high_water<e.strstart&&(e.high_water=e.strstart),c=e.bi_valid+42>>3,c=e.pending_buf_size-c>65535?65535:e.pending_buf_size-c,u=c>e.w_size?e.w_size:c,i=e.strstart-e.block_start,(i>=u||(i||n===ka)&&n!==Fu&&e.strm.avail_in===0&&i<=c)&&(r=i>c?c:i,f=n===ka&&e.strm.avail_in===0&&r===i?1:0,bI(e,e.block_start,r,f),e.block_start+=r,Qi(e.strm)),f?3:1)},wI=(e,n)=>{let r,i;for(;;){if(e.lookahead<Xc){if(cp(e),e.lookahead<Xc&&n===Fu)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=ju(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Xc&&(e.match_length=q4(e,r)),e.match_length>=3)if(i=Vu(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=ju(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ju(e,e.ins_h,e.window[e.strstart+1]);else i=Vu(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ea(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,n===ka?(ea(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(ea(e,!1),e.strm.avail_out===0)?1:2},lp=(e,n)=>{let r,i,c;for(;;){if(e.lookahead<Xc){if(cp(e),e.lookahead<Xc&&n===Fu)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=ju(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Xc&&(e.match_length=q4(e,r),e.match_length<=5&&(e.strategy===Rle||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){c=e.strstart+e.lookahead-3,i=Vu(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=c&&(e.ins_h=ju(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(ea(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(i=Vu(e,0,e.window[e.strstart-1]),i&&ea(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Vu(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,n===ka?(ea(e,!0),e.strm.avail_out===0?3:4):e.sym_next&&(ea(e,!1),e.strm.avail_out===0)?1:2};function Jc(e,n,r,i,c){this.good_length=e,this.max_lazy=n,this.nice_length=r,this.max_chain=i,this.func=c}const Vv=[new Jc(0,0,0,0,X4),new Jc(4,4,8,4,wI),new Jc(4,5,16,8,wI),new Jc(4,6,32,32,wI),new Jc(4,4,16,16,lp),new Jc(8,16,32,32,lp),new Jc(8,16,128,128,lp),new Jc(8,32,128,256,lp),new Jc(32,128,258,1024,lp),new Jc(32,258,258,4096,lp)];function xle(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=eb,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Dle),this.dyn_dtree=new Uint16Array(2*(2*kle+1)),this.bl_tree=new Uint16Array(2*(2*Ple+1)),Bu(this.dyn_ltree),Bu(this.dyn_dtree),Bu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Lle+1),this.heap=new Uint16Array(2*TI+1),Bu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*TI+1),Bu(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Fv=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.status!==ap&&n.status!==57&&n.status!==69&&n.status!==73&&n.status!==91&&n.status!==103&&n.status!==rh&&n.status!==xv?1:0},J4=e=>{if(Fv(e))return oh(e,qc);e.total_in=e.total_out=0,e.data_type=Nle;const n=e.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?57:n.wrap?ap:rh,e.adler=n.wrap===2?0:1,n.last_flush=-2,Ele(n),Ps},Z4=e=>{const n=J4(e);return n===Ps&&(r=>{r.window_size=2*r.w_size,Bu(r.head),r.max_lazy_match=Vv[r.level].max_lazy,r.good_match=Vv[r.level].good_length,r.nice_match=Vv[r.level].nice_length,r.max_chain_length=Vv[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0})(e.state),n},Q4=(e,n,r,i,c,u)=>{if(!e)return qc;let f=1;if(n===wle&&(n=6),i<0?(f=0,i=-i):i>15&&(f=2,i-=16),c<1||c>9||r!==eb||i<8||i>15||n<0||n>9||u<0||u>Ale||i===8&&f!==1)return oh(e,qc);i===8&&(i=9);const m=new xle;return e.state=m,m.strm=e,m.status=ap,m.wrap=f,m.gzhead=null,m.w_bits=i,m.w_size=1<<m.w_bits,m.w_mask=m.w_size-1,m.hash_bits=c+7,m.hash_size=1<<m.hash_bits,m.hash_mask=m.hash_size-1,m.hash_shift=~~((m.hash_bits+3-1)/3),m.window=new Uint8Array(2*m.w_size),m.head=new Uint16Array(m.hash_size),m.prev=new Uint16Array(m.w_size),m.lit_bufsize=1<<c+6,m.pending_buf_size=4*m.lit_bufsize,m.pending_buf=new Uint8Array(m.pending_buf_size),m.sym_buf=m.lit_bufsize,m.sym_end=3*(m.lit_bufsize-1),m.level=n,m.strategy=u,m.method=r,Z4(e)};var Ule=(e,n)=>{if(Fv(e)||n>G4||n<0)return e?oh(e,qc):qc;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===xv&&n!==ka)return oh(e,e.avail_out===0?SI:qc);const i=r.last_flush;if(r.last_flush=n,r.pending!==0){if(Qi(e),e.avail_out===0)return r.last_flush=-1,Ps}else if(e.avail_in===0&&Y4(n)<=Y4(i)&&n!==ka)return oh(e,SI);if(r.status===xv&&e.avail_in!==0)return oh(e,SI);if(r.status===ap&&r.wrap===0&&(r.status=rh),r.status===ap){let c=eb+(r.w_bits-8<<4)<<8,u=-1;if(u=r.strategy>=Qy||r.level<2?0:r.level<6?1:r.level===6?2:3,c|=u<<6,r.strstart!==0&&(c|=32),c+=31-c%31,Uv(r,c),r.strstart!==0&&(Uv(r,e.adler>>>16),Uv(r,65535&e.adler)),e.adler=1,r.status=rh,Qi(e),r.pending!==0)return r.last_flush=-1,Ps}if(r.status===57){if(e.adler=0,Gr(r,31),Gr(r,139),Gr(r,8),r.gzhead)Gr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Gr(r,255&r.gzhead.time),Gr(r,r.gzhead.time>>8&255),Gr(r,r.gzhead.time>>16&255),Gr(r,r.gzhead.time>>24&255),Gr(r,r.level===9?2:r.strategy>=Qy||r.level<2?4:0),Gr(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Gr(r,255&r.gzhead.extra.length),Gr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=bs(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Gr(r,0),Gr(r,0),Gr(r,0),Gr(r,0),Gr(r,0),Gr(r,r.level===9?2:r.strategy>=Qy||r.level<2?4:0),Gr(r,3),r.status=rh,Qi(e),r.pending!==0)return r.last_flush=-1,Ps}if(r.status===69){if(r.gzhead.extra){let c=r.pending,u=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+u>r.pending_buf_size;){let m=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+m),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>c&&(e.adler=bs(e.adler,r.pending_buf,r.pending-c,c)),r.gzindex+=m,Qi(e),r.pending!==0)return r.last_flush=-1,Ps;c=0,u-=m}let f=new Uint8Array(r.gzhead.extra);r.pending_buf.set(f.subarray(r.gzindex,r.gzindex+u),r.pending),r.pending+=u,r.gzhead.hcrc&&r.pending>c&&(e.adler=bs(e.adler,r.pending_buf,r.pending-c,c)),r.gzindex=0}r.status=73}if(r.status===73){if(r.gzhead.name){let c,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(e.adler=bs(e.adler,r.pending_buf,r.pending-u,u)),Qi(e),r.pending!==0)return r.last_flush=-1,Ps;u=0}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Gr(r,c)}while(c!==0);r.gzhead.hcrc&&r.pending>u&&(e.adler=bs(e.adler,r.pending_buf,r.pending-u,u)),r.gzindex=0}r.status=91}if(r.status===91){if(r.gzhead.comment){let c,u=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>u&&(e.adler=bs(e.adler,r.pending_buf,r.pending-u,u)),Qi(e),r.pending!==0)return r.last_flush=-1,Ps;u=0}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Gr(r,c)}while(c!==0);r.gzhead.hcrc&&r.pending>u&&(e.adler=bs(e.adler,r.pending_buf,r.pending-u,u))}r.status=103}if(r.status===103){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Qi(e),r.pending!==0))return r.last_flush=-1,Ps;Gr(r,255&e.adler),Gr(r,e.adler>>8&255),e.adler=0}if(r.status=rh,Qi(e),r.pending!==0)return r.last_flush=-1,Ps}if(e.avail_in!==0||r.lookahead!==0||n!==Fu&&r.status!==xv){let c=r.level===0?X4(r,n):r.strategy===Qy?((u,f)=>{let m;for(;;){if(u.lookahead===0&&(cp(u),u.lookahead===0)){if(f===Fu)return 1;break}if(u.match_length=0,m=Vu(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,m&&(ea(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,f===ka?(ea(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(ea(u,!1),u.strm.avail_out===0)?1:2})(r,n):r.strategy===Ile?((u,f)=>{let m,_,y,T;const A=u.window;for(;;){if(u.lookahead<=nh){if(cp(u),u.lookahead<=nh&&f===Fu)return 1;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=3&&u.strstart>0&&(y=u.strstart-1,_=A[y],_===A[++y]&&_===A[++y]&&_===A[++y])){T=u.strstart+nh;do;while(_===A[++y]&&_===A[++y]&&_===A[++y]&&_===A[++y]&&_===A[++y]&&_===A[++y]&&_===A[++y]&&_===A[++y]&&y<T);u.match_length=nh-(T-y),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=3?(m=Vu(u,1,u.match_length-3),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(m=Vu(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),m&&(ea(u,!1),u.strm.avail_out===0))return 1}return u.insert=0,f===ka?(ea(u,!0),u.strm.avail_out===0?3:4):u.sym_next&&(ea(u,!1),u.strm.avail_out===0)?1:2})(r,n):Vv[r.level].func(r,n);if(c!==3&&c!==4||(r.status=xv),c===1||c===3)return e.avail_out===0&&(r.last_flush=-1),Ps;if(c===2&&(n===Sle?ble(r):n!==G4&&(bI(r,0,0,!1),n===Tle&&(Bu(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Qi(e),e.avail_out===0))return r.last_flush=-1,Ps}return n!==ka?Ps:r.wrap<=0?z4:(r.wrap===2?(Gr(r,255&e.adler),Gr(r,e.adler>>8&255),Gr(r,e.adler>>16&255),Gr(r,e.adler>>24&255),Gr(r,255&e.total_in),Gr(r,e.total_in>>8&255),Gr(r,e.total_in>>16&255),Gr(r,e.total_in>>24&255)):(Uv(r,e.adler>>>16),Uv(r,65535&e.adler)),Qi(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Ps:z4)},Vle=(e,n)=>{let r=n.length;if(Fv(e))return qc;const i=e.state,c=i.wrap;if(c===2||c===1&&i.status!==ap||i.lookahead)return qc;if(c===1&&(e.adler=Mv(e.adler,n,r,0)),i.wrap=0,r>=i.w_size){c===0&&(Bu(i.head),i.strstart=0,i.block_start=0,i.insert=0);let _=new Uint8Array(i.w_size);_.set(n.subarray(r-i.w_size,r),0),n=_,r=i.w_size}const u=e.avail_in,f=e.next_in,m=e.input;for(e.avail_in=r,e.next_in=0,e.input=n,cp(i);i.lookahead>=3;){let _=i.strstart,y=i.lookahead-2;do i.ins_h=ju(i,i.ins_h,i.window[_+3-1]),i.prev[_&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=_,_++;while(--y);i.strstart=_,i.lookahead=2,cp(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=f,e.input=m,e.avail_in=u,i.wrap=c,Ps},Bv={deflateInit:(e,n)=>Q4(e,n,eb,15,8,Ole),deflateInit2:Q4,deflateReset:Z4,deflateResetKeep:J4,deflateSetHeader:(e,n)=>Fv(e)||e.state.wrap!==2?qc:(e.state.gzhead=n,Ps),deflate:Ule,deflateEnd:e=>{if(Fv(e))return qc;const n=e.state.status;return e.state=null,n===rh?oh(e,Cle):Ps},deflateSetDictionary:Vle,deflateInfo:"pako deflate (from Nodeca project)"};const Fle=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);var tb={assign:function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const r=n.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const i in r)Fle(r,i)&&(e[i]=r[i])}}return e},flattenChunks:e=>{let n=0;for(let i=0,c=e.length;i<c;i++)n+=e[i].length;const r=new Uint8Array(n);for(let i=0,c=0,u=e.length;i<u;i++){let f=e[i];r.set(f,c),c+=f.length}return r}};let ej=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ej=!1}const jv=new Uint8Array(256);for(let e=0;e<256;e++)jv[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;jv[254]=jv[254]=1;var $v={string2buf:e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let n,r,i,c,u,f=e.length,m=0;for(c=0;c<f;c++)r=e.charCodeAt(c),(64512&r)==55296&&c+1<f&&(i=e.charCodeAt(c+1),(64512&i)==56320&&(r=65536+(r-55296<<10)+(i-56320),c++)),m+=r<128?1:r<2048?2:r<65536?3:4;for(n=new Uint8Array(m),u=0,c=0;u<m;c++)r=e.charCodeAt(c),(64512&r)==55296&&c+1<f&&(i=e.charCodeAt(c+1),(64512&i)==56320&&(r=65536+(r-55296<<10)+(i-56320),c++)),r<128?n[u++]=r:r<2048?(n[u++]=192|r>>>6,n[u++]=128|63&r):r<65536?(n[u++]=224|r>>>12,n[u++]=128|r>>>6&63,n[u++]=128|63&r):(n[u++]=240|r>>>18,n[u++]=128|r>>>12&63,n[u++]=128|r>>>6&63,n[u++]=128|63&r);return n},buf2string:(e,n)=>{const r=n||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,n));let i,c;const u=new Array(2*r);for(c=0,i=0;i<r;){let f=e[i++];if(f<128){u[c++]=f;continue}let m=jv[f];if(m>4)u[c++]=65533,i+=m-1;else{for(f&=m===2?31:m===3?15:7;m>1&&i<r;)f=f<<6|63&e[i++],m--;m>1?u[c++]=65533:f<65536?u[c++]=f:(f-=65536,u[c++]=55296|f>>10&1023,u[c++]=56320|1023&f)}}return((f,m)=>{if(m<65534&&f.subarray&&ej)return String.fromCharCode.apply(null,f.length===m?f:f.subarray(0,m));let _="";for(let y=0;y<m;y++)_+=String.fromCharCode(f[y]);return _})(u,c)},utf8border:(e,n)=>{(n=n||e.length)>e.length&&(n=e.length);let r=n-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||r===0?n:r+jv[e[r]]>n?r:n}},tj=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const nj=Object.prototype.toString,{Z_NO_FLUSH:Ble,Z_SYNC_FLUSH:jle,Z_FULL_FLUSH:$le,Z_FINISH:Hle,Z_OK:nb,Z_STREAM_END:Wle,Z_DEFAULT_COMPRESSION:Kle,Z_DEFAULT_STRATEGY:Gle,Z_DEFLATED:zle}=Zy;function rb(e){this.options=tb.assign({level:Kle,method:zle,chunkSize:16384,windowBits:15,memLevel:8,strategy:Gle},e||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tj,this.strm.avail_out=0;let r=Bv.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(r!==nb)throw new Error(th[r]);if(n.header&&Bv.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i=typeof n.dictionary=="string"?$v.string2buf(n.dictionary):nj.call(n.dictionary)==="[object ArrayBuffer]"?new Uint8Array(n.dictionary):n.dictionary,r=Bv.deflateSetDictionary(this.strm,i),r!==nb)throw new Error(th[r]);this._dict_set=!0}}function Yle(e,n){const r=new rb(n);if(r.push(e,!0),r.err)throw r.msg||th[r.err];return r.result}rb.prototype.push=function(e,n){const r=this.strm,i=this.options.chunkSize;let c,u;if(this.ended)return!1;for(u=n===~~n?n:n===!0?Hle:Ble,typeof e=="string"?r.input=$v.string2buf(e):nj.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(r.avail_out===0&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(u===jle||u===$le)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(c=Bv.deflate(r,u),c===Wle)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),c=Bv.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===nb;if(r.avail_out!==0){if(u>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(r.avail_in===0)break}else this.onData(r.output)}return!0},rb.prototype.onData=function(e){this.chunks.push(e)},rb.prototype.onEnd=function(e){e===nb&&(this.result=tb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var qle={deflate:Yle};const ob=16209;var Xle=function(e,n){let r,i,c,u,f,m,_,y,T,A,k,P,q,j,H,ne,re,ve,Oe,ke,we,Be,lt,St;const At=e.state;r=e.next_in,lt=e.input,i=r+(e.avail_in-5),c=e.next_out,St=e.output,u=c-(n-e.avail_out),f=c+(e.avail_out-257),m=At.dmax,_=At.wsize,y=At.whave,T=At.wnext,A=At.window,k=At.hold,P=At.bits,q=At.lencode,j=At.distcode,H=(1<<At.lenbits)-1,ne=(1<<At.distbits)-1;e:do{P<15&&(k+=lt[r++]<<P,P+=8,k+=lt[r++]<<P,P+=8),re=q[k&H];t:for(;;){if(ve=re>>>24,k>>>=ve,P-=ve,ve=re>>>16&255,ve===0)St[c++]=65535&re;else{if(!(16&ve)){if(!(64&ve)){re=q[(65535&re)+(k&(1<<ve)-1)];continue t}if(32&ve){At.mode=16191;break e}e.msg="invalid literal/length code",At.mode=ob;break e}Oe=65535&re,ve&=15,ve&&(P<ve&&(k+=lt[r++]<<P,P+=8),Oe+=k&(1<<ve)-1,k>>>=ve,P-=ve),P<15&&(k+=lt[r++]<<P,P+=8,k+=lt[r++]<<P,P+=8),re=j[k&ne];n:for(;;){if(ve=re>>>24,k>>>=ve,P-=ve,ve=re>>>16&255,!(16&ve)){if(!(64&ve)){re=j[(65535&re)+(k&(1<<ve)-1)];continue n}e.msg="invalid distance code",At.mode=ob;break e}if(ke=65535&re,ve&=15,P<ve&&(k+=lt[r++]<<P,P+=8,P<ve&&(k+=lt[r++]<<P,P+=8)),ke+=k&(1<<ve)-1,ke>m){e.msg="invalid distance too far back",At.mode=ob;break e}if(k>>>=ve,P-=ve,ve=c-u,ke>ve){if(ve=ke-ve,ve>y&&At.sane){e.msg="invalid distance too far back",At.mode=ob;break e}if(we=0,Be=A,T===0){if(we+=_-ve,ve<Oe){Oe-=ve;do St[c++]=A[we++];while(--ve);we=c-ke,Be=St}}else if(T<ve){if(we+=_+T-ve,ve-=T,ve<Oe){Oe-=ve;do St[c++]=A[we++];while(--ve);if(we=0,T<Oe){ve=T,Oe-=ve;do St[c++]=A[we++];while(--ve);we=c-ke,Be=St}}}else if(we+=T-ve,ve<Oe){Oe-=ve;do St[c++]=A[we++];while(--ve);we=c-ke,Be=St}for(;Oe>2;)St[c++]=Be[we++],St[c++]=Be[we++],St[c++]=Be[we++],Oe-=3;Oe&&(St[c++]=Be[we++],Oe>1&&(St[c++]=Be[we++]))}else{we=c-ke;do St[c++]=St[we++],St[c++]=St[we++],St[c++]=St[we++],Oe-=3;while(Oe>2);Oe&&(St[c++]=St[we++],Oe>1&&(St[c++]=St[we++]))}break}}break}}while(r<i&&c<f);Oe=P>>3,r-=Oe,P-=Oe<<3,k&=(1<<P)-1,e.next_in=r,e.next_out=c,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=c<f?f-c+257:257-(c-f),At.hold=k,At.bits=P};const sb=15,Jle=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zle=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Qle=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),eue=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Hv=(e,n,r,i,c,u,f,m)=>{const _=m.bits;let y,T,A,k,P,q,j=0,H=0,ne=0,re=0,ve=0,Oe=0,ke=0,we=0,Be=0,lt=0,St=null;const At=new Uint16Array(16),Nn=new Uint16Array(16);let kn,fr,Xr,Wr=null;for(j=0;j<=sb;j++)At[j]=0;for(H=0;H<i;H++)At[n[r+H]]++;for(ve=_,re=sb;re>=1&&At[re]===0;re--);if(ve>re&&(ve=re),re===0)return c[u++]=20971520,c[u++]=20971520,m.bits=1,0;for(ne=1;ne<re&&At[ne]===0;ne++);for(ve<ne&&(ve=ne),we=1,j=1;j<=sb;j++)if(we<<=1,we-=At[j],we<0)return-1;if(we>0&&(e===0||re!==1))return-1;for(Nn[1]=0,j=1;j<sb;j++)Nn[j+1]=Nn[j]+At[j];for(H=0;H<i;H++)n[r+H]!==0&&(f[Nn[n[r+H]]++]=H);if(e===0?(St=Wr=f,q=20):e===1?(St=Jle,Wr=Zle,q=257):(St=Qle,Wr=eue,q=0),lt=0,H=0,j=ne,P=u,Oe=ve,ke=0,A=-1,Be=1<<ve,k=Be-1,e===1&&Be>852||e===2&&Be>592)return 1;for(;;){kn=j-ke,f[H]+1<q?(fr=0,Xr=f[H]):f[H]>=q?(fr=Wr[f[H]-q],Xr=St[f[H]-q]):(fr=96,Xr=0),y=1<<j-ke,T=1<<Oe,ne=T;do T-=y,c[P+(lt>>ke)+T]=kn<<24|fr<<16|Xr|0;while(T!==0);for(y=1<<j-1;lt&y;)y>>=1;if(y!==0?(lt&=y-1,lt+=y):lt=0,H++,--At[j]==0){if(j===re)break;j=n[r+f[H]]}if(j>ve&&(lt&k)!==A){for(ke===0&&(ke=ve),P+=ne,Oe=j-ke,we=1<<Oe;Oe+ke<re&&(we-=At[Oe+ke],!(we<=0));)Oe++,we<<=1;if(Be+=1<<Oe,e===1&&Be>852||e===2&&Be>592)return 1;A=lt&k,c[A]=ve<<24|Oe<<16|P-u|0}}return lt!==0&&(c[P+lt]=j-ke<<24|64<<16|0),m.bits=ve,0};const{Z_FINISH:rj,Z_BLOCK:tue,Z_TREES:ib,Z_OK:sh,Z_STREAM_END:nue,Z_NEED_DICT:rue,Z_STREAM_ERROR:Pa,Z_DATA_ERROR:oj,Z_MEM_ERROR:sj,Z_BUF_ERROR:oue,Z_DEFLATED:ij}=Zy,ab=16180,cb=16190,Fl=16191,RI=16192,II=16194,lb=16199,ub=16200,AI=16206,Ao=16209,aj=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function sue(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ih=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.mode<ab||n.mode>16211?1:0},cj=e=>{if(ih(e))return Pa;const n=e.state;return e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=ab,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,sh},lj=e=>{if(ih(e))return Pa;const n=e.state;return n.wsize=0,n.whave=0,n.wnext=0,cj(e)},uj=(e,n)=>{let r;if(ih(e))return Pa;const i=e.state;return n<0?(r=0,n=-n):(r=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?Pa:(i.window!==null&&i.wbits!==n&&(i.window=null),i.wrap=r,i.wbits=n,lj(e))},dj=(e,n)=>{if(!e)return Pa;const r=new sue;e.state=r,r.strm=e,r.window=null,r.mode=ab;const i=uj(e,n);return i!==sh&&(e.state=null),i};let OI,NI,hj=!0;const iue=e=>{if(hj){OI=new Int32Array(512),NI=new Int32Array(32);let n=0;for(;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Hv(1,e.lens,0,288,OI,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Hv(2,e.lens,0,32,NI,0,e.work,{bits:5}),hj=!1}e.lencode=OI,e.lenbits=9,e.distcode=NI,e.distbits=5},fj=(e,n,r,i)=>{let c;const u=e.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new Uint8Array(u.wsize)),i>=u.wsize?(u.window.set(n.subarray(r-u.wsize,r),0),u.wnext=0,u.whave=u.wsize):(c=u.wsize-u.wnext,c>i&&(c=i),u.window.set(n.subarray(r-i,r-i+c),u.wnext),(i-=c)?(u.window.set(n.subarray(r-i,r),0),u.wnext=i,u.whave=u.wsize):(u.wnext+=c,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=c))),0};var aue=(e,n)=>{let r,i,c,u,f,m,_,y,T,A,k,P,q,j,H,ne,re,ve,Oe,ke,we,Be,lt=0;const St=new Uint8Array(4);let At,Nn;const kn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ih(e)||!e.output||!e.input&&e.avail_in!==0)return Pa;r=e.state,r.mode===Fl&&(r.mode=RI),f=e.next_out,c=e.output,_=e.avail_out,u=e.next_in,i=e.input,m=e.avail_in,y=r.hold,T=r.bits,A=m,k=_,Be=sh;e:for(;;)switch(r.mode){case ab:if(r.wrap===0){r.mode=RI;break}for(;T<16;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(2&r.wrap&&y===35615){r.wbits===0&&(r.wbits=15),r.check=0,St[0]=255&y,St[1]=y>>>8&255,r.check=bs(r.check,St,2,0),y=0,T=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",r.mode=Ao;break}if((15&y)!==ij){e.msg="unknown compression method",r.mode=Ao;break}if(y>>>=4,T-=4,we=8+(15&y),r.wbits===0&&(r.wbits=we),we>15||we>r.wbits){e.msg="invalid window size",r.mode=Ao;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&y?16189:Fl,y=0,T=0;break;case 16181:for(;T<16;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(r.flags=y,(255&os(r))!==ij){e.msg="unknown compression method",r.mode=Ao;break}if(57344&os(r)){e.msg="unknown header flags set",r.mode=Ao;break}r.head&&(r.head.text=y>>8&1),512&os(r)&&4&r.wrap&&(St[0]=255&y,St[1]=y>>>8&255,r.check=bs(r.check,St,2,0)),y=0,T=0,r.mode=16182;case 16182:for(;T<32;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.head&&(r.head.time=y),512&os(r)&&4&r.wrap&&(St[0]=255&y,St[1]=y>>>8&255,St[2]=y>>>16&255,St[3]=y>>>24&255,r.check=bs(r.check,St,4,0)),y=0,T=0,r.mode=16183;case 16183:for(;T<16;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.head&&(r.head.xflags=255&y,r.head.os=y>>8),512&os(r)&&4&r.wrap&&(St[0]=255&y,St[1]=y>>>8&255,r.check=bs(r.check,St,2,0)),y=0,T=0,r.mode=16184;case 16184:if(1024&os(r)){for(;T<16;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.length=y,r.head&&(r.head.extra_len=y),512&os(r)&&4&r.wrap&&(St[0]=255&y,St[1]=y>>>8&255,r.check=bs(r.check,St,2,0)),y=0,T=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&os(r)&&(P=r.length,P>m&&(P=m),P&&(r.head&&(we=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(u,u+P),we)),512&os(r)&&4&r.wrap&&(r.check=bs(r.check,i,P,u)),m-=P,u+=P,r.length-=P),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&os(r)){if(m===0)break e;P=0;do we=i[u+P++],r.head&&we&&r.length<65536&&(r.head.name+=String.fromCharCode(we));while(we&&P<m);if(512&os(r)&&4&r.wrap&&(r.check=bs(r.check,i,P,u)),m-=P,u+=P,we)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&os(r)){if(m===0)break e;P=0;do we=i[u+P++],r.head&&we&&r.length<65536&&(r.head.comment+=String.fromCharCode(we));while(we&&P<m);if(512&os(r)&&4&r.wrap&&(r.check=bs(r.check,i,P,u)),m-=P,u+=P,we)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&os(r)){for(;T<16;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(4&r.wrap&&y!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Ao;break}y=0,T=0}r.head&&(r.head.hcrc=os(r)>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Fl;break;case 16189:for(;T<32;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}e.adler=r.check=aj(y),y=0,T=0,r.mode=cb;case cb:if(r.havedict===0)return e.next_out=f,e.avail_out=_,e.next_in=u,e.avail_in=m,r.hold=y,r.bits=T,rue;e.adler=r.check=1,r.mode=Fl;case Fl:if(n===tue||n===ib)break e;case RI:if(r.last){y>>>=7&T,T-=7&T,r.mode=AI;break}for(;T<3;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}switch(r.last=1&y,y>>>=1,T-=1,3&y){case 0:r.mode=16193;break;case 1:if(iue(r),r.mode=lb,n===ib){y>>>=2,T-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Ao}y>>>=2,T-=2;break;case 16193:for(y>>>=7&T,T-=7&T;T<32;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Ao;break}if(r.length=65535&y,y=0,T=0,r.mode=II,n===ib)break e;case II:r.mode=16195;case 16195:if(P=r.length,P){if(P>m&&(P=m),P>_&&(P=_),P===0)break e;c.set(i.subarray(u,u+P),f),m-=P,u+=P,_-=P,f+=P,r.length-=P;break}r.mode=Fl;break;case 16196:for(;T<14;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(r.nlen=257+(31&y),y>>>=5,T-=5,r.ndist=1+(31&y),y>>>=5,T-=5,r.ncode=4+(15&y),y>>>=4,T-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Ao;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;T<3;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.lens[kn[r.have++]]=7&y,y>>>=3,T-=3}for(;r.have<19;)r.lens[kn[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,At={bits:r.lenbits},Be=Hv(0,r.lens,0,19,r.lencode,0,r.work,At),r.lenbits=At.bits,Be){e.msg="invalid code lengths set",r.mode=Ao;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;lt=r.lencode[y&(1<<r.lenbits)-1],H=lt>>>24,ne=lt>>>16&255,re=65535&lt,!(H<=T);){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(re<16)y>>>=H,T-=H,r.lens[r.have++]=re;else{if(re===16){for(Nn=H+2;T<Nn;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(y>>>=H,T-=H,r.have===0){e.msg="invalid bit length repeat",r.mode=Ao;break}we=r.lens[r.have-1],P=3+(3&y),y>>>=2,T-=2}else if(re===17){for(Nn=H+3;T<Nn;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}y>>>=H,T-=H,we=0,P=3+(7&y),y>>>=3,T-=3}else{for(Nn=H+7;T<Nn;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}y>>>=H,T-=H,we=0,P=11+(127&y),y>>>=7,T-=7}if(r.have+P>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Ao;break}for(;P--;)r.lens[r.have++]=we}}if(r.mode===Ao)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Ao;break}if(r.lenbits=9,At={bits:r.lenbits},Be=Hv(1,r.lens,0,r.nlen,r.lencode,0,r.work,At),r.lenbits=At.bits,Be){e.msg="invalid literal/lengths set",r.mode=Ao;break}if(r.distbits=6,r.distcode=r.distdyn,At={bits:r.distbits},Be=Hv(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,At),r.distbits=At.bits,Be){e.msg="invalid distances set",r.mode=Ao;break}if(r.mode=lb,n===ib)break e;case lb:r.mode=ub;case ub:if(m>=6&&_>=258){e.next_out=f,e.avail_out=_,e.next_in=u,e.avail_in=m,r.hold=y,r.bits=T,Xle(e,k),f=e.next_out,c=e.output,_=e.avail_out,u=e.next_in,i=e.input,m=e.avail_in,y=r.hold,T=r.bits,r.mode===Fl&&(r.back=-1);break}for(r.back=0;lt=r.lencode[y&(1<<r.lenbits)-1],H=lt>>>24,ne=lt>>>16&255,re=65535&lt,!(H<=T);){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(ne&&!(240&ne)){for(ve=H,Oe=ne,ke=re;lt=r.lencode[ke+((y&(1<<ve+Oe)-1)>>ve)],H=lt>>>24,ne=lt>>>16&255,re=65535&lt,!(ve+H<=T);){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}y>>>=ve,T-=ve,r.back+=ve}if(y>>>=H,T-=H,r.back+=H,r.length=re,ne===0){r.mode=16205;break}if(32&ne){r.back=-1,r.mode=Fl;break}if(64&ne){e.msg="invalid literal/length code",r.mode=Ao;break}r.extra=15&ne,r.mode=16201;case 16201:if(r.extra){for(Nn=r.extra;T<Nn;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.length+=y&(1<<r.extra)-1,y>>>=r.extra,T-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;lt=r.distcode[y&(1<<r.distbits)-1],H=lt>>>24,ne=lt>>>16&255,re=65535&lt,!(H<=T);){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(!(240&ne)){for(ve=H,Oe=ne,ke=re;lt=r.distcode[ke+((y&(1<<ve+Oe)-1)>>ve)],H=lt>>>24,ne=lt>>>16&255,re=65535&lt,!(ve+H<=T);){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}y>>>=ve,T-=ve,r.back+=ve}if(y>>>=H,T-=H,r.back+=H,64&ne){e.msg="invalid distance code",r.mode=Ao;break}r.offset=re,r.extra=15&ne,r.mode=16203;case 16203:if(r.extra){for(Nn=r.extra;T<Nn;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}r.offset+=y&(1<<r.extra)-1,y>>>=r.extra,T-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Ao;break}r.mode=16204;case 16204:if(_===0)break e;if(P=k-_,r.offset>P){if(P=r.offset-P,P>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Ao;break}P>r.wnext?(P-=r.wnext,q=r.wsize-P):q=r.wnext-P,P>r.length&&(P=r.length),j=r.window}else j=c,q=f-r.offset,P=r.length;P>_&&(P=_),_-=P,r.length-=P;do c[f++]=j[q++];while(--P);r.length===0&&(r.mode=ub);break;case 16205:if(_===0)break e;c[f++]=r.length,_--,r.mode=ub;break;case AI:if(r.wrap){for(;T<32;){if(m===0)break e;m--,y|=i[u++]<<T,T+=8}if(k-=_,e.total_out+=k,r.total+=k,4&r.wrap&&k&&(e.adler=r.check=os(r)?bs(r.check,c,k,f-k):Mv(r.check,c,k,f-k)),k=_,4&r.wrap&&(os(r)?y:aj(y))!==r.check){e.msg="incorrect data check",r.mode=Ao;break}y=0,T=0}r.mode=16207;case 16207:if(r.wrap&&os(r)){for(;T<32;){if(m===0)break e;m--,y+=i[u++]<<T,T+=8}if(4&r.wrap&&y!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Ao;break}y=0,T=0}r.mode=16208;case 16208:Be=nue;break e;case Ao:Be=oj;break e;case 16210:return sj;default:return Pa}return e.next_out=f,e.avail_out=_,e.next_in=u,e.avail_in=m,r.hold=y,r.bits=T,(r.wsize||k!==e.avail_out&&r.mode<Ao&&(r.mode<AI||n!==rj))&&fj(e,e.output,e.next_out,k-e.avail_out),A-=e.avail_in,k-=e.avail_out,e.total_in+=A,e.total_out+=k,r.total+=k,4&r.wrap&&k&&(e.adler=r.check=os(r)?bs(r.check,c,k,e.next_out-k):Mv(r.check,c,k,e.next_out-k)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Fl?128:0)+(r.mode===lb||r.mode===II?256:0),(A===0&&k===0||n===rj)&&Be===sh&&(Be=oue),Be},Bl={inflateReset:lj,inflateReset2:uj,inflateResetKeep:cj,inflateInit:e=>dj(e,15),inflateInit2:dj,inflate:aue,inflateEnd:e=>{if(ih(e))return Pa;let n=e.state;return n.window&&(n.window=null),e.state=null,sh},inflateGetHeader:(e,n)=>{if(ih(e))return Pa;const r=e.state;return 2&r.wrap?(r.head=n,n.done=!1,sh):Pa},inflateSetDictionary:(e,n)=>{const r=n.length;let i,c,u;return ih(e)?Pa:(i=e.state,i.wrap!==0&&i.mode!==cb?Pa:i.mode===cb&&(c=1,c=Mv(c,n,r,0),c!==i.check)?oj:(u=fj(e,n,r,r),u?(i.mode=16210,sj):(i.havedict=1,sh)))},inflateInfo:"pako inflate (from Nodeca project)"},cue=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const pj=Object.prototype.toString,{Z_NO_FLUSH:lue,Z_FINISH:uue,Z_OK:Wv,Z_STREAM_END:kI,Z_NEED_DICT:PI,Z_STREAM_ERROR:due,Z_DATA_ERROR:mj,Z_MEM_ERROR:hue}=Zy;function db(e){this.options=tb.assign({chunkSize:65536,windowBits:15,to:""},e||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),!(n.windowBits>=0&&n.windowBits<16)||e&&e.windowBits||(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tj,this.strm.avail_out=0;let r=Bl.inflateInit2(this.strm,n.windowBits);if(r!==Wv)throw new Error(th[r]);if(this.header=new cue,Bl.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=$v.string2buf(n.dictionary):pj.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(r=Bl.inflateSetDictionary(this.strm,n.dictionary),r!==Wv)))throw new Error(th[r])}function fue(e,n){const r=new db(n);if(r.push(e),r.err)throw r.msg||th[r.err];return r.result}db.prototype.push=function(e,n){const r=this.strm,i=this.options.chunkSize,c=this.options.dictionary;let u,f,m;if(this.ended)return!1;for(f=n===~~n?n:n===!0?uue:lue,pj.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),u=Bl.inflate(r,f),u===PI&&c&&(u=Bl.inflateSetDictionary(r,c),u===Wv?u=Bl.inflate(r,f):u===mj&&(u=PI));r.avail_in>0&&u===kI&&r.state.wrap>0&&e[r.next_in]!==0;)Bl.inflateReset(r),u=Bl.inflate(r,f);switch(u){case due:case mj:case PI:case hue:return this.onEnd(u),this.ended=!0,!1}if(m=r.avail_out,r.next_out&&(r.avail_out===0||u===kI))if(this.options.to==="string"){let _=$v.utf8border(r.output,r.next_out),y=r.next_out-_,T=$v.buf2string(r.output,_);r.next_out=y,r.avail_out=i-y,y&&r.output.set(r.output.subarray(_,_+y),0),this.onData(T)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(u!==Wv||m!==0){if(u===kI)return u=Bl.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},db.prototype.onData=function(e){this.chunks.push(e)},db.prototype.onEnd=function(e){e===Wv&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=tb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var pue={inflate:fue};const{deflate:mue}=qle,{inflate:vue}=pue;var gue=mue,_ue=vue,vj=function(e){return e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE",e}(vj||{});class Eue{constructor(){Q(this,"_sequence",0),Q(this,"_startTime",Date.now()),Q(this,"isUseOneByte",!0)}get startTime(){const n=Date.now()-this._startTime;return n<Math.pow(2,16)?n:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(n){const r={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:n};if(n.byteLength>128){const m=new Uint8Array(4);m.set([1,0,0,0]);const _={id:0,length:4,data:m.buffer},y={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[_]};r.commonPacketHeader.extension=1,r.extension=y,r.payload=this.compress(n),r.commonPacketHeader.length=8+(r.extension.length+2)+r.payload.byteLength}else r.commonPacketHeader.length=8+r.payload.byteLength;de("SHOW_DATASTREAM2_LOG")&&x.debug("send data header: ".concat(JSON.stringify(r.commonPacketHeader)));const i=new ArrayBuffer(r.commonPacketHeader.length),c=new Uint8Array(i),u=new DataView(i);let f=0;if(u.setUint16(f,r.commonPacketHeader.extension<<15|r.commonPacketHeader.reserved<<14|r.commonPacketHeader.length,!0),f+=2,u.setUint32(f,r.commonPacketHeader.sequence,!0),f+=4,u.setUint16(f,r.commonStreamHeader,!0),f+=2,r.extension){const m=this.serializeExtension(r.extension);c.set(new Uint8Array(m),f),f+=m.byteLength}if(c.set(new Uint8Array(r.payload),f),f+=r.payload.byteLength,f!==r.commonPacketHeader.length)throw Error("serialize error!");return i}deserialize(n){if(n.byteLength<4)return new ArrayBuffer(0);const r=new DataView(n);let i=0;const c=r.getUint16(i,!0);i+=2;const u={length:16383&c,reserved:(16384&c)>>14,extension:(32768&c)>>15,sequence:r.getUint16(i+2,!0)<<16|r.getUint16(i,!0)};let f,m;if(i+=4,de("SHOW_DATASTREAM2_LOG")&&x.debug("receive data header: ".concat(JSON.stringify(u))),r.getUint16(i,!0),i+=2,u.extension){m=this.deserializeExtension(n.slice(i)),i+=2+m.length,f=n.slice(i);let _=!1;if(m.datas.length>0){const y=m.datas.find(T=>T.id===0);y&&(_=(1&new DataView(y.data).getUint32(0,!0))==1)}f=_?this.decompress(f):f}else f=n.slice(8);return f}serializeExtension(n){const{profile:r,length:i,datas:c}=n,u=new ArrayBuffer(i+2),f=new Uint8Array(u),m=new DataView(u);let _=0;if(m.setUint8(_++,r),m.setUint8(_++,i),c.forEach(y=>{r?(m.setUint8(_++,y.id),m.setUint8(_++,y.length),f.set(new Uint8Array(y.data),_),_+=y.data.byteLength):(m.setUint8(_++,y.id|y.length<<4),f.set(new Uint8Array(y.data),_),_+=y.data.byteLength)}),_!==i+2)throw Error("serialize extension error, is ".concat(_,"!==").concat(i+2));return u}deserializeExtension(n){const r=new DataView(n);let i=0;const c=r.getUint8(i);i++;const u=r.getUint8(i);i++;const f=c===vj.TWO_BYTE,m=[],_=new DataView(n,2);let y=0;for(;y<u;){let T=0,A=0,k=new ArrayBuffer(0);f?(T=_.getUint8(y),y++,A=_.getUint8(y),y++):(T=15&_.getUint8(y),A=_.getUint8(y)>>4,y++),A>0&&(k=_.buffer.slice(y+2,y+2+A),y+=k.byteLength),m.push({id:T,length:A,data:k})}if(y!==u)throw Error("parse error");return{profile:c,length:u,datas:m}}decompress(n){return _ue(new Uint8Array(n))}compress(n){return gue(new Uint8Array(n))}}const yue={name:"DataStream",create:(e,n)=>{const r=n?new Iae(e):new Aae(e);return r.useDataStream(new Eue),r}};class bue extends Dr{constructor(n,r,i){super(),Q(this,"ws",void 0),Q(this,"requestId",1),Q(this,"heartBeatTimer",void 0),Q(this,"joinInfo",void 0),Q(this,"clientId",void 0),Q(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),Q(this,"onClose",c=>{this.emit("close"),this.dispose()}),Q(this,"onMessage",c=>{const u=JSON.parse(c.data);if(!u||u.command!=="serverResponse"||!u.requestId)return u&&u.command==="serverStatus"&&u.serverStatus&&u.serverStatus.command?(this.emit("status",u.serverStatus),void this.emit(u.serverStatus.command,u.serverStatus)):void 0;this.emit("req_".concat(u.requestId),u)}),this.joinInfo=n,this.clientId=r,this.ws=new vv("cross-channel-".concat(this.clientId),i),this.ws.on(pn.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(pn.CONNECTED,this.onOpen),this.ws.on(pn.ON_MESSAGE,this.onMessage),this.ws.on(pn.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(n){const r=this.requestId++;return n.requestId=r,n.seq=r,this.ws.sendMessage(n),r}waitStatus(n){return new bt((r,i)=>{const c=window.setTimeout(()=>{i(new Ue(oe.TIMEOUT,"wait status timeout, status: ".concat(n)))},5e3);this.once(n,u=>{window.clearTimeout(c),u.state&&u.state!==0?i(new Ue(oe.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(n))):r(void 0)}),this.once("dispose",()=>{window.clearTimeout(c),i(new Ue(oe.WS_ABORT))})})}async request(n){if(this.ws.state==="closed")throw new Ue(oe.WS_DISCONNECT);const r=()=>new bt((f,m)=>{this.ws.once(pn.CLOSED,()=>m(new Ue(oe.WS_ABORT))),this.ws.once(pn.CONNECTED,f)});this.ws.state!=="connected"&&await r();const i=this.sendMessage(n),c=new bt((f,m)=>{const _=()=>{m(new Ue(oe.WS_ABORT))};this.ws.once(pn.RECONNECTING,_),this.ws.once(pn.CLOSED,_),this.once("req_".concat(i),f),Do(3e3).then(()=>{this.removeAllListeners("req_".concat(i)),this.ws.off(pn.RECONNECTING,_),this.ws.off(pn.CLOSED,_),m(new Ue(oe.TIMEOUT,"cross channel ws request timeout"))})}),u=await c;if(!u||u.code!==200)throw new Ue(oe.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(u)));return u}async connect(n){this.ws.removeAllListeners(pn.REQUEST_NEW_URLS),this.ws.on(pn.REQUEST_NEW_URLS,r=>{r(n)}),await this.ws.init(n)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(n){const r=this.requestId++;return n.requestId=r,this.ws.sendMessage(n),r}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class Sue extends Dr{set state(n){n!==this._state&&(n!==Hs.RELAY_STATE_FAILURE&&(this.errorCode=zf.RELAY_OK),this.emit("state",n,this.errorCode),this._state=n)}get state(){return this._state}constructor(n,r,i,c,u){super(),Q(this,"joinInfo",void 0),Q(this,"sid",void 0),Q(this,"clientId",void 0),Q(this,"cancelToken",Is.CancelToken.source()),Q(this,"workerToken",void 0),Q(this,"requestId",0),Q(this,"signal",void 0),Q(this,"prevChannelMediaConfig",void 0),Q(this,"httpRetryConfig",void 0),Q(this,"_resolution",void 0),Q(this,"_state",Hs.RELAY_STATE_IDLE),Q(this,"errorCode",zf.RELAY_OK),Q(this,"onStatus",f=>{x.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(f))),f&&f.command&&(f.command==="onAudioPacketReceived"&&this.emit("event",Dl.PACKET_RECEIVED_AUDIO_FROM_SRC),f.command==="onVideoPacketReceived"&&this.emit("event",Dl.PACKET_RECEIVED_VIDEO_FROM_SRC),f.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=zf.SRC_TOKEN_EXPIRED,this.state=Hs.RELAY_STATE_FAILURE),f.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=zf.DEST_TOKEN_EXPIRED,this.state=Hs.RELAY_STATE_FAILURE))}),Q(this,"onReconnect",async()=>{x.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Dl.NETWORK_DISCONNECTED),this.state=Hs.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(f=>{this.state!==Hs.RELAY_STATE_IDLE&&(x.error("auto restart channel media relay failed",f.toString()),this.errorCode=zf.SERVER_CONNECTION_LOST,this.state=Hs.RELAY_STATE_FAILURE)})}),this.joinInfo=n,this.clientId=r,this.sid=Vd(),this.signal=new bue(this.joinInfo,this.clientId,i),this.httpRetryConfig=c,this._resolution=u}async startChannelMediaRelay(n){if(this.state!==Hs.RELAY_STATE_IDLE)throw new Ue(oe.INVALID_OPERATION);this.state=Hs.RELAY_STATE_CONNECTING,await this.connect(),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(n)}catch(r){throw r.data&&r.data.serverResponse&&r.data.serverResponse.command==="SetSourceChannel"?new Ue(oe.CROSS_CHANNEL_FAILED_JOIN_SRC):r.data&&r.data.serverResponse&&r.serverResponse.command==="SetDestChannelStatus"?new Ue(oe.CROSS_CHANNEL_FAILED_JOIN_DEST):r.data&&r.data.serverResponse&&r.serverResponse.command==="StartPacketTransfer"?new Ue(oe.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):r}this.prevChannelMediaConfig=n}async updateChannelMediaRelay(n){if(this.state!==Hs.RELAY_STATE_RUNNING)throw new Ue(oe.INVALID_OPERATION);await this.sendUpdateMessage(n),this.prevChannelMediaConfig=n}async setVideoProfile(n){if(this._resolution=n,this.state!==Hs.RELAY_STATE_RUNNING)throw new Ue(oe.INVALID_OPERATION);const r=this.genMessage(ys.SetVideoProfile);await this.signal.request(r),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),x.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=Hs.RELAY_STATE_IDLE,this.dispose()}dispose(){x.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Is.CancelToken.source(),this.state=Hs.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const n=await Pce(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=n.workerToken,await this.signal.connect(n.addressList),this.emit("event",Dl.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(n){const r=this.genMessage(ys.StopPacketTransfer);await this.signal.request(r),await this.signal.waitStatus("Normal Quit"),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const i=this.genMessage(ys.SetSdkProfile,n);await this.signal.request(i),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const c=this.genMessage(ys.SetSourceChannel,n);await this.signal.request(c),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Dl.PACKET_JOINED_SRC_CHANNEL),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const u=this.genMessage(ys.SetSourceUserId,n);await this.signal.request(u),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const f=this.genMessage(ys.SetDestChannel,n);await this.signal.request(f),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Dl.PACKET_JOINED_DEST_CHANNEL),x.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const m=this.genMessage(ys.StartPacketTransfer,n);await this.signal.request(m),this.emit("event",Dl.PACKET_SENT_TO_DEST_CHANNEL),this.state=Hs.RELAY_STATE_RUNNING,x.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(n){const r=this.genMessage(ys.UpdateDestChannel,n);await this.signal.request(r),this.emit("event",Dl.PACKET_UPDATE_DEST_CHANNEL),x.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const n=this.genMessage(ys.StopPacketTransfer);await this.signal.request(n),x.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(n,r){const i=[],c=[],u=[];this.requestId+=1;const f={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Yi,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};f.sdkVersion==="4.23.2"&&(f.sdkVersion="0.0.1");let m=null,_=null;switch(n){case ys.SetSdkProfile:return f.clientRequest={command:"SetSdkProfile",type:"multi_channel"},f;case ys.SetSourceChannel:if(_=r&&r.getSrcChannelMediaInfo(),!_)throw new Ue(oe.UNEXPECTED_ERROR,"can not find source config");return f.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_.channelName,token:_.token||this.joinInfo.appId},f;case ys.SetSourceUserId:if(_=r&&r.getSrcChannelMediaInfo(),!_)throw new Ue(oe.UNEXPECTED_ERROR,"can not find source config");return f.clientRequest={command:"SetSourceUserId",uid:_.uid+""},f;case ys.SetDestChannel:if(m=r&&r.getDestChannelMediaInfo(),!m)throw new Ue(oe.UNEXPECTED_ERROR,"can not find dest config");return m.forEach(y=>{i.push(y.channelName),c.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),f.clientRequest={command:"SetDestChannel",channelName:i,uid:c,token:u},f;case ys.StartPacketTransfer:return f.clientRequest={command:"StartPacketTransfer"},f;case ys.Reconnect:return f.clientRequest={command:"Reconnect"},f;case ys.StopPacketTransfer:return f.clientRequest={command:"StopPacketTransfer"},f;case ys.UpdateDestChannel:if(m=r&&r.getDestChannelMediaInfo(),!m)throw new Ue(oe.UNEXPECTED_ERROR,"can not find dest config");return m.forEach(y=>{i.push(y.channelName),c.push(y.uid+""),u.push(y.token||this.joinInfo.appId)}),f.clientRequest={command:"UpdateDestChannel",channelName:i,uid:c,token:u},f;case ys.SetVideoProfile:f.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return f}}const Tue={name:"ChannelMediaRelay",create:function(e){return new Sue(e.joinInfo,e.clientId,e.websocketRetryConfig||so,e.httpRetryConfig||so,e.resolution)}};function gj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Kv(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?gj(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gj(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}class Cue extends Dr{constructor(n,r,i,c){super(),Q(this,"spec",void 0),Q(this,"token",void 0),Q(this,"websocket",void 0),Q(this,"pingpongTimer",void 0),Q(this,"reconnectMode","retry"),Q(this,"serviceMode",void 0),Q(this,"reqId",0),Q(this,"commandReqId",0),Q(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),Q(this,"handleWebSocketMessage",u=>{if(!u.data)return;const f=JSON.parse(u.data);f.requestId?this.emit("@".concat(f.requestId,"-").concat(f.sid),f):(Bt.workerEvent(this.spec.sid,{actionType:"status",serverCode:f.code,workerType:this.serviceMode===Pl.TRANSCODE?1:2}),this.emit(Au.PUBLISH_STREAM_STATUS,f))}),this.spec=r,this.token=n,this.serviceMode=c,this.websocket=new vv("live-streaming",i),this.websocket.on(pn.CONNECTED,this.handleWebSocketOpen),this.websocket.on(pn.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(pn.REQUEST_NEW_URLS,(u,f)=>{Bo(this,Au.REQUEST_NEW_ADDRESS).then(u).catch(f)}),this.websocket.on(pn.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(n){return this.websocket.init(n)}async request(n,r,i,c){this.reqId+=1,n==="request"&&(this.commandReqId+=1);const u=this.commandReqId,f=this.reqId;if(!f||!this.websocket)throw new Ue(oe.UNEXPECTED_ERROR);const m=Kv({command:n,sdkVersion:Yi==="4.23.2"?"0.0.1":Yi,seq:f,requestId:f,allocate:i,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},r);if(this.websocket.state==="closed")throw new Ue(oe.WS_DISCONNECT);const _=()=>new bt((k,P)=>{this.websocket.once(pn.CLOSED,()=>P(new Ue(oe.WS_ABORT))),this.websocket.once(pn.CONNECTED,k)});this.websocket.state!=="connected"&&await _(),m.clientRequest&&(m.clientRequest.workerToken=this.token);const y=new bt((k,P)=>{const q=()=>{P(new Ue(oe.WS_ABORT))};this.websocket.once(pn.RECONNECTING,q),this.websocket.once(pn.CLOSED,q),this.once("@".concat(f,"-").concat(this.spec.sid),j=>{k(j)})});c&&Bt.workerEvent(this.spec.sid,Kv(Kv({},c),{},{requestId:u,actionType:"request",payload:JSON.stringify(r.clientRequest),serverCode:0,code:0}));const T=Date.now();this.websocket.sendMessage(m);let A=null;try{A=await y}catch(k){if(this.websocket.state==="closed")throw k;return await _(),await this.request(n,r,i)}return c&&Bt.workerEvent(this.spec.sid,Kv(Kv({},c),{},{requestId:u,actionType:"response",payload:JSON.stringify(A.serverResponse),serverCode:A.code,success:A.code===200,responseTime:Date.now()-T})),A.code!==200&&this.handleResponseError(A),A}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const n=Yi==="4.23.2"?"0.0.1":Yi;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:n,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(n){switch(n.code){case fo.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void x.warning("live stream response already exists stream");case fo.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case fo.LIVE_STREAM_RESPONSE_BAD_STREAM:case fo.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Ue(oe.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:n.code}).throw();case fo.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(n.serverResponse.command==="UnpublishStream")return;throw new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case fo.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Ue(oe.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:n.code}).throw();case fo.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const r=new Ue(oe.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(Au.WARNING,r,n.serverResponse.url)}case fo.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const r=new Ue(oe.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(Au.WARNING,r,n.serverResponse.url)}case fo.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case fo.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Ue(oe.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:n.code}).throw();case fo.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const r=new Ue(oe.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(Au.WARNING,r,n.serverResponse.url)}case fo.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:n.code}).throw();case fo.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case fo.LIVE_STREAM_RESPONSE_WORKER_LOST:case fo.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(n.serverResponse.command==="UnpublishStream")return;throw new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case fo.ERROR_FAIL_SEND_MESSAGE:if(n.serverResponse.command==="UnpublishStream")return;if(n.serverResponse.command==="UpdateTranscoding"||n.serverResponse.command==="ControlStream")return new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:n.code}).throw();throw new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case fo.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Ue(oe.LIVE_STREAMING_CDN_ERROR,"",{code:n.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(ZE)},6e3)}}function _j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Ws(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?_j(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_j(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}class wue extends Dr{constructor(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:so,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:so;super(),Q(this,"onLiveStreamWarning",void 0),Q(this,"onLiveStreamError",void 0),Q(this,"spec",void 0),Q(this,"retryTimeout",1e4),Q(this,"connection",void 0),Q(this,"httpRetryConfig",void 0),Q(this,"wsRetryConfig",void 0),Q(this,"streamingTasks",new Map),Q(this,"isStartingStreamingTask",!1),Q(this,"taskMutex",new Ko("live-streaming")),Q(this,"cancelToken",Is.CancelToken.source()),Q(this,"transcodingConfig",void 0),Q(this,"uapResponse",void 0),Q(this,"lastTaskId",1),Q(this,"statusError",new Map),this.spec=n,this.httpRetryConfig=i,this.wsRetryConfig=r}async setTranscodingConfig(n){const r=Ws(Ws({},dce),n);r.videoCodecProfile!==66&&r.videoCodecProfile!==77&&r.videoCodecProfile!==100&&(x.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(r.videoCodecProfile," -> 100")),r.videoCodecProfile=100),r.transcodingUsers||(r.transcodingUsers=r.userConfigs),r.transcodingUsers&&(r.transcodingUsers=r.transcodingUsers.map(f=>Ws(Ws(Ws({},uce),f),{},{zOrder:f.zOrder?f.zOrder+1:1}))),function(f){Vr(f.width)||sr(f.width,"config.width",0,1e4),Vr(f.height)||sr(f.height,"config.height",0,1e4),Vr(f.videoBitrate)||sr(f.videoBitrate,"config.videoBitrate",1,1e6),Vr(f.videoFrameRate)||sr(f.videoFrameRate,"config.videoFrameRate"),Vr(f.lowLatency)||Al(f.lowLatency,"config.lowLatency"),Vr(f.audioSampleRate)||vo(f.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Vr(f.audioBitrate)||sr(f.audioBitrate,"config.audioBitrate",1,128),Vr(f.audioChannels)||vo(f.audioChannels,"config.audioChannels",[1,2,3,4,5]),Vr(f.videoGop)||sr(f.videoGop,"config.videoGop"),Vr(f.videoCodecProfile)||vo(f.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Vr(f.userCount)||sr(f.userCount,"config.userCount",0,17),Vr(f.backgroundColor)||sr(f.backgroundColor,"config.backgroundColor",0,16777215),Vr(f.userConfigExtraInfo)||Po(f.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),f.transcodingUsers&&!Vr(f.transcodingUsers)&&(Ol(f.transcodingUsers,"config.transcodingUsers"),f.transcodingUsers.forEach((m,_)=>{Sy(m.uid),Vr(m.x)||sr(m.x,"transcodingUser[".concat(_,"].x"),0,1e4),Vr(m.y)||sr(m.y,"transcodingUser[".concat(_,"].y"),0,1e4),Vr(m.width)||sr(m.width,"transcodingUser[".concat(_,"].width"),0,1e4),Vr(m.height)||sr(m.height,"transcodingUser[".concat(_,"].height"),0,1e4),Vr(m.zOrder)||sr(m.zOrder-1,"transcodingUser[".concat(_,"].zOrder"),0,100),Vr(m.alpha)||sr(m.alpha,"transcodingUser[".concat(_,"].alpha"),0,1,!1)})),Vr(f.watermark)||LR(f.watermark,"watermark"),Vr(f.backgroundImage)||LR(f.backgroundImage,"backgroundImage"),f.images&&!Vr(f.images)&&(Ol(f.images,"config.images"),f.images.forEach((m,_)=>{LR(m,"images[".concat(_,"]"))}))}(r);const i=[];r.images&&i.push(...r.images.map(f=>Ws(Ws(Ws({},DR),f),{},{zOrder:255}))),r.backgroundImage&&(i.push(Ws(Ws(Ws({},DR),r.backgroundImage),{},{zOrder:0})),delete r.backgroundImage),r.watermark&&(i.push(Ws(Ws(Ws({},DR),r.watermark),{},{zOrder:255})),delete r.watermark),r.images=i,r.transcodingUsers&&(r.userConfigs=r.transcodingUsers.map(f=>Ws({},f)),r.userCount=r.transcodingUsers.length,delete r.transcodingUsers);const c=(r.userConfigs||[]).map(f=>typeof f.uid=="number"?bt.resolve(f.uid):BB(f.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await bt.all(c)).forEach((f,m)=>{r.userConfigs&&r.userConfigs[m]&&(r.userConfigs[m].uid=f)}),this.transcodingConfig=r,this.connection)try{var u;const f=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(Ti(u=this.streamingTasks).call(u)).map(m=>m.taskId).join("#")});x.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(f.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(f){if(!f.data||!f.data.retry)throw f;f.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(m=>{x.warning("[".concat(this.spec.clientId,"] live streaming receive error"),f.toString(),"try to republish",m.url),this.startLiveStreamingTask(m.url,m.mode,f).then(()=>{x.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(m.url," success"))}).catch(_=>{x.error("[".concat(this.spec.clientId,"] live streaming republish failed"),m.url,_.toString()),this.onLiveStreamError&&this.onLiveStreamError(m.url,_)})})}}async startLiveStreamingTask(n,r,i){if(!this.transcodingConfig&&r===Pl.TRANSCODE)throw new Ue(oe.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const c={command:"PublishStream",ts:Date.now(),url:n,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};x.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(n,", mode: ").concat(r));const u=await this.taskMutex.lock();if(!this.connection&&i)return void u();if(this.streamingTasks.get(n)&&!i)return u(),new Ue(oe.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(r))}catch(m){throw u(),m}switch(r){case Pl.TRANSCODE:c.transcodingConfig=Ws({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(c.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const f=this.lastTaskId++;try{const m=new bt((y,T)=>{Do(this.retryTimeout).then(()=>{if(i)return T(i);const A=this.statusError.get(n);return A?(this.statusError.delete(n),T(A)):void 0})}),_=await bt.race([this.connection.request("request",{clientRequest:c},!0,{url:n,command:"PublishStream",workerType:r===Pl.TRANSCODE?1:2,requestByUser:!i,tid:f.toString()}),m]);this.isStartingStreamingTask=!1,x.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_.code)),this.streamingTasks.set(n,{clientRequest:c,mode:r,url:n,taskId:f}),u()}catch(m){if(u(),this.isStartingStreamingTask=!1,!m.data||!m.data.retry||i)throw m;return m.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(n,r,m)):await this.startLiveStreamingTask(n,r,m)}}stopLiveStreamingTask(n){return new bt((r,i)=>{const c=this.streamingTasks.get(n);if(!c||!this.connection)return new Ue(oe.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const u=c.mode;c.abortTask=()=>{x.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(n),r()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:c.url}},!1,{url:n,command:"UnPublishStream",workerType:u===Pl.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(f=>{x.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(f.code)),this.streamingTasks.delete(n),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),r()}).catch(i)})}resetAllTask(){var n;const r=Array.from(Ti(n=this.streamingTasks).call(n));this.terminate();for(const i of r)this.startLiveStreamingTask(i.url,i.mode).catch(c=>{this.onLiveStreamError&&this.onLiveStreamError(i.url,c)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Is.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(n){if(this.connection)throw new Ue(oe.UNEXPECTED_ERROR,"live streaming connection has already connected");const r=await Bo(this,MR.REQUEST_WORKER_MANAGER_LIST,n);return this.uapResponse=r,this.connection=new Cue(r.workerToken,this.spec,this.wsRetryConfig,n),this.connection.on(Au.WARNING,(i,c)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(c,i)),this.connection.on(Au.PUBLISH_STREAM_STATUS,i=>this.handlePublishStreamServer(i)),this.connection.on(Au.REQUEST_NEW_ADDRESS,(i,c)=>{if(!this.connection)return c(new Ue(oe.UNEXPECTED_ERROR,"can not get new live streaming address list"));Bo(this,MR.REQUEST_WORKER_MANAGER_LIST,n).then(u=>{this.uapResponse=u,i(u.addressList)}).catch(c)}),await this.connection.init(r.addressList),this.connection}handlePublishStreamServer(n){const r=n.serverStatus&&n.serverStatus.url||"empty_url",i=this.streamingTasks.get(r),c=n.reason;switch(n.code){case fo.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case fo.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const f=new Ue(oe.LIVE_STREAMING_CDN_ERROR,"",{code:n.code});if(i)return x.error(f.toString()),this.onLiveStreamError&&this.onLiveStreamError(r,f);if(!this.isStartingStreamingTask)return;this.statusError.set(r,f)}case fo.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const f=new Ue(oe.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,c);return this.onLiveStreamWarning&&this.onLiveStreamWarning(r,f)}case fo.LIVE_STREAM_RESPONSE_WORKER_LOST:case fo.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var u;if(!this.connection)return;this.connection.tryNextAddress();const f=Array.from(Ti(u=this.streamingTasks).call(u));for(const m of f)m.abortTask?m.abortTask():(x.warning("[".concat(this.spec.clientId,"] publish stream status code"),n.code,"try to republish",m.url),this.startLiveStreamingTask(m.url,m.mode,new Ue(oe.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:n.code})).then(()=>{x.debug("[".concat(this.spec.clientId,"] republish live stream success"),m.url)}).catch(_=>{x.error(_.toString()),this.onLiveStreamError&&this.onLiveStreamError(m.url,_)}));return}}}hasUrl(n){return this.streamingTasks.has(n)}}const Rue={name:"LiveStreaming",create:function(e){return new wue(e.joinInfo,e.websocketRetryConfig||so,e.httpRetryConfig||so)}};function Iue(e){let n=bj();return function(r,i){let c=r.appId;c!==void 0&&(Qn(i,10),Zc(i,c));let u=r.cid;u!==void 0&&(Qn(i,16),Qn(i,u));let f=r.cname;f!==void 0&&(Qn(i,26),Zc(i,f));let m=r.deviceId;m!==void 0&&(Qn(i,34),Zc(i,m));let _=r.elapse;_!==void 0&&(Qn(i,40),$u(i,_));let y=r.fileSize;y!==void 0&&(Qn(i,48),$u(i,up(y)));let T=r.height;T!==void 0&&(Qn(i,56),$u(i,up(T)));let A=r.jpg;A!==void 0&&(Qn(i,66),Qn(i,A.length),function(Ds,Ze){let ft=dp(Ds,Ze.length);Ds.bytes.set(Ze,ft)}(i,A));let k=r.networkType;k!==void 0&&(Qn(i,72),$u(i,up(k)));let P=r.osType;P!==void 0&&(Qn(i,80),$u(i,up(P)));let q=r.requestId;q!==void 0&&(Qn(i,90),Zc(i,q));let j=r.sdkVersion;j!==void 0&&(Qn(i,98),Zc(i,j));let H=r.sequence;H!==void 0&&(Qn(i,104),$u(i,up(H)));let ne=r.sid;ne!==void 0&&(Qn(i,114),Zc(i,ne));let re=r.timestamp;re!==void 0&&(Qn(i,120),$u(i,re));let ve=r.uid;ve!==void 0&&(Qn(i,128),Qn(i,ve));let Oe=r.vid;Oe!==void 0&&(Qn(i,136),Qn(i,Oe));let ke=r.width;ke!==void 0&&(Qn(i,144),$u(i,up(ke)));let we=r.service;we!==void 0&&(Qn(i,152),Qn(i,we));let Be=r.callbackData;Be!==void 0&&(Qn(i,162),Zc(i,Be));let lt=r.jpgEncryption;lt!==void 0&&(Qn(i,168),Qn(i,lt));let St=r.requestType;St!==void 0&&(Qn(i,176),Qn(i,St));let At=r.scorePorn;At!==void 0&&(Qn(i,185),UI(i,At));let Nn=r.scoreSexy;Nn!==void 0&&(Qn(i,193),UI(i,Nn));let kn=r.scoreNeutral;kn!==void 0&&(Qn(i,201),UI(i,kn));let fr=r.scene;fr!==void 0&&(Qn(i,208),Qn(i,fr));let Xr=r.ossFilePrefix;Xr!==void 0&&(Qn(i,218),Zc(i,Xr));let Wr=r.serviceVendor;if(Wr!==void 0)for(let Ds of Wr){Qn(i,226);let Ze=bj();Nue(Ds,Ze),Qn(i,Ze.limit),Lue(i,Ze),Due(Ze)}}(e,n),function(r){let i=r.bytes,c=r.limit;return i.length===c?i:i.subarray(0,c)}(n)}function Aue(e){return function(r){let i={};e:for(;!Sj(r);){let c=Qc(r);switch(c>>>3){case 0:break e;case 1:i.code=Qc(r);break;case 2:i.msg=Tj(r,Qc(r));break;case 3:{let u=kue(r);i.data=Oue(r),r.limit=u;break}default:Ej(r,7&c)}}return i}({bytes:n=e,offset:0,limit:n.length});var n}function Oue(e){let n={};e:for(;!Sj(e);){let r=Qc(e);switch(r>>>3){case 0:break e;case 1:n.requestId=Tj(e,Qc(e));break;case 2:n.requestType=Qc(e)>>>0;break;case 3:n.scorePorn=xI(e);break;case 4:n.scoreSexy=xI(e);break;case 5:n.scoreNeutral=xI(e);break;case 6:n.requestScene=Qc(e)>>>0;break;case 7:n.scene=Qc(e)>>>0;break;default:Ej(e,7&r)}}return n}function Nue(e,n){let r=e.service;r!==void 0&&(Qn(n,8),Qn(n,r));let i=e.vendor;i!==void 0&&(Qn(n,16),Qn(n,i));let c=e.token;c!==void 0&&(Qn(n,26),Zc(n,c));let u=e.callbackUrl;u!==void 0&&(Qn(n,34),Zc(n,u))}function kue(e){let n=Qc(e),r=e.limit;return e.limit=e.offset+n,r}function Ej(e,n){switch(n){case 0:for(;128&Cj(e););break;case 2:LI(e,Qc(e));break;case 5:LI(e,4);break;case 1:LI(e,8);break;default:throw new Error("Unimplemented type: "+n)}}let Pue=new Float32Array(1);new Uint8Array(Pue.buffer);let DI=new Float64Array(1),Ks=new Uint8Array(DI.buffer);function up(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let yj=[];function bj(){const e=yj.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function Due(e){yj.push(e)}function LI(e,n){if(e.offset+n>e.limit)throw new Error("Skip past limit");e.offset+=n}function Sj(e){return e.offset>=e.limit}function dp(e,n){let r=e.bytes,i=e.offset,c=e.limit,u=i+n;if(u>r.length){let f=new Uint8Array(2*u);f.set(r),e.bytes=f}return e.offset=u,u>c&&(e.limit=u),i}function MI(e,n){let r=e.offset;if(r+n>e.limit)throw new Error("Read past limit");return e.offset+=n,r}function Tj(e,n){let r=MI(e,n),i=String.fromCharCode,c=e.bytes,u="",f="";for(let m=0;m<n;m++){let _,y,T,A,k=c[m+r];128&k?(224&k)==192?m+1>=n?f+=u:(_=c[m+r+1],(192&_)!=128?f+=u:(A=(31&k)<<6|63&_,A<128?f+=u:(f+=i(A),m++))):(240&k)==224?m+2>=n?f+=u:(_=c[m+r+1],y=c[m+r+2],(49344&(_|y<<8))!=32896?f+=u:(A=(15&k)<<12|(63&_)<<6|63&y,A<2048||A>=55296&&A<=57343?f+=u:(f+=i(A),m+=2))):(248&k)==240?m+3>=n?f+=u:(_=c[m+r+1],y=c[m+r+2],T=c[m+r+3],(12632256&(_|y<<8|T<<16))!=8421504?f+=u:(A=(7&k)<<18|(63&_)<<12|(63&y)<<6|63&T,A<65536||A>1114111?f+=u:(A-=65536,f+=i(55296+(A>>10),56320+(1023&A)),m+=3))):f+=u:f+=i(k)}return f}function Zc(e,n){let r=n.length,i=0;for(let f=0;f<r;f++){let m=n.charCodeAt(f);m>=55296&&m<=56319&&f+1<r&&(m=(m<<10)+n.charCodeAt(++f)-56613888),i+=m<128?1:m<2048?2:m<65536?3:4}Qn(e,i);let c=dp(e,i),u=e.bytes;for(let f=0;f<r;f++){let m=n.charCodeAt(f);m>=55296&&m<=56319&&f+1<r&&(m=(m<<10)+n.charCodeAt(++f)-56613888),m<128?u[c++]=m:(m<2048?u[c++]=m>>6&31|192:(m<65536?u[c++]=m>>12&15|224:(u[c++]=m>>18&7|240,u[c++]=m>>12&63|128),u[c++]=m>>6&63|128),u[c++]=63&m|128)}}function Lue(e,n){let r=dp(e,n.limit),i=e.bytes,c=n.bytes;for(let u=0,f=n.limit;u<f;u++)i[u+r]=c[u]}function Cj(e){return e.bytes[MI(e,1)]}function wj(e,n){let r=dp(e,1);e.bytes[r]=n}function xI(e){let n=MI(e,8),r=e.bytes;return Ks[0]=r[n++],Ks[1]=r[n++],Ks[2]=r[n++],Ks[3]=r[n++],Ks[4]=r[n++],Ks[5]=r[n++],Ks[6]=r[n++],Ks[7]=r[n++],DI[0]}function UI(e,n){let r=dp(e,8),i=e.bytes;DI[0]=n,i[r++]=Ks[0],i[r++]=Ks[1],i[r++]=Ks[2],i[r++]=Ks[3],i[r++]=Ks[4],i[r++]=Ks[5],i[r++]=Ks[6],i[r++]=Ks[7]}function Qc(e){let n,r=0,i=0;do n=Cj(e),r<32&&(i|=(127&n)<<r),r+=7;while(128&n);return i}function Qn(e,n){for(n>>>=0;n>=128;)wj(e,127&n|128),n>>>=7;wj(e,n)}function $u(e,n){let r=n.low>>>0,i=(n.low>>>28|n.high<<4)>>>0,c=n.high>>>24,u=c===0?i===0?r<16384?r<128?1:2:r<1<<21?3:4:i<16384?i<128?5:6:i<1<<21?7:8:c<128?9:10,f=dp(e,u),m=e.bytes;switch(u){case 10:m[f+9]=c>>>7&1;case 9:m[f+8]=u!==9?128|c:127&c;case 8:m[f+7]=u!==8?i>>>21|128:i>>>21&127;case 7:m[f+6]=u!==7?i>>>14|128:i>>>14&127;case 6:m[f+5]=u!==6?i>>>7|128:i>>>7&127;case 5:m[f+4]=u!==5?128|i:127&i;case 4:m[f+3]=u!==4?r>>>21|128:r>>>21&127;case 3:m[f+2]=u!==3?r>>>14|128:r>>>14&127;case 2:m[f+1]=u!==2?r>>>7|128:r>>>7&127;case 1:m[f]=u!==1?128|r:127&r}}function Rj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}const Mue=new Map([["moderation",1],["supervise",2]]);class xue extends Dr{get connectionState(){return this._connectionState}set connectionState(n){if(this._connectionState===n)return;const r=this._connectionState;this._connectionState=n,this.emit(Io.CONNECTION_STATE_CHANGE,r,n)}get inspectType(){return this._inspectType}set inspectType(n){var r;this._inspectMode=qa(r=n.map(i=>Mue.get(i)||0)).call(r,(i,c)=>i+c),this._inspectType=n}get quality(){return this._quality}set quality(n){this._quality=n>1?1:n<.1?.1:n,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(n){super(),Q(this,"name","AgoraRTCVideoContentInspect"),Q(this,"_connectionState",Ra.CONNECTING),Q(this,"_innerConnectionState",void 0),Q(this,"sequence",0),Q(this,"inspectStartTime",void 0),Q(this,"workerManagerConnection",void 0),Q(this,"workerConnection",void 0),Q(this,"workerMessageLengthLimit",void 0),Q(this,"inspectIntervalMinimum",void 0),Q(this,"qualityRatio",void 0),Q(this,"_connectInfo",void 0),Q(this,"_cancelTokenSource",Is.CancelToken.source()),Q(this,"_retryConfig",void 0),Q(this,"wmSequence",0),Q(this,"inspectInterval",void 0),Q(this,"inspectTimer",null),Q(this,"ossFilePrefix",void 0),Q(this,"extraInfo",void 0),Q(this,"_inspectType",void 0),Q(this,"_inspectMode",void 0),Q(this,"_quality",1),Q(this,"qualityTimer",null),Q(this,"_inspectId",void 0),Q(this,"_needWorkUrlOnly",!1),Q(this,"inspectImage",()=>{if(this.connectionState!==Ra.CONNECTED)throw new Ue(oe.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===Ra.CONNECTED?this.requestToInspectImage():x.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=dr(5,"inspect-"),this.workerMessageLengthLimit=de("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=de("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=de("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=n.interval,this.ossFilePrefix=n.ossFilePrefix,this.extraInfo=n.extraInfo,this.inspectType=n.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new vv("worker-manager-"+this._inspectId,so),this.on(Io.STATE_CHANGE,(r,i)=>{this._innerConnectionState=r,x.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Ia[r]," ").concat(i||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new vv("worker-"+this._inspectId,so),this.handleWorkerEvents()}async init(n,r){this.emit(Io.STATE_CHANGE,Ia.CONNECT_AP),this._connectInfo=n;const i=this._cancelTokenSource.token;return this._retryConfig=r,new bt((c,u)=>{this.on(Io.CONNECTION_STATE_CHANGE,(f,m)=>{m===Ra.CONNECTED&&c()}),this.requestAP(n,i,r).then(f=>{this.connectWorkerManager(f)}).catch(f=>{u(f)})})}async requestAP(n,r,i){const c=de("WEBCS_DOMAIN").map(m=>"https://".concat(m,"/api/v1")),u=await function(m,_,y,T){let{appId:A,areaCode:k,cname:P,sid:q,token:j,uid:H}=_;ep++;const ne="image_moderation_api",re={service_name:ne,json_body:JSON.stringify({appId:A,areaCode:k,cname:P,command:"allocateEdge",requestId:ep,seq:ep,sid:q,token:j,ts:Date.now(),uid:H+""})};let ve,Oe,ke=m[0];return nc(async()=>{ve=Date.now();const we=await ac(ke,{data:re,cancelToken:y,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(Oe=Date.now()-ve,we.code!==0){const At=new Ue(oe.UNEXPECTED_RESPONSE,"image inspect ap error, code"+we.code,{retry:!0,responseTime:Oe});throw x.error(At.toString()),At}const Be=JSON.parse(we.json_body);if(Be.code!==200){const At=new Ue(oe.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(Be.code,", reason: ").concat(Be.reason),{code:Be.code,responseTime:Oe});throw x.error(At.toString()),At}if(!Be.servers||!Array.isArray(Be.servers)||Be.servers.length===0){const At=new Ue(oe.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:Be.code,responseTime:Oe});throw x.error(At.toString()),At}const lt=de("VIDEO_INSPECT_WORKER_MANAGER_HOST"),St=de("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:Be.servers.map(At=>{let{address:Nn,wss:kn}=At;if(Nn&&kn)return"wss://".concat(Nn.replace(/\./g,"-"),".").concat(lt,":").concat(St||kn)}).filter(At=>!!At),workerToken:Be.workerToken,vid:Be.vid,responseTime:Oe}},(we,Be)=>(Bt.apworkerEvent(q,{success:!0,sc:200,serviceName:ne,responseDetail:JSON.stringify(we.addressList),firstSuccess:Be===0,responseTime:Oe,serverIp:m[Be%m.length]}),!1),(we,Be)=>(Bt.apworkerEvent(q,{success:!1,sc:we.data&&we.data.code||200,serviceName:ne,responseTime:Oe,serverIp:m[Be%m.length]}),!!(we.code!==oe.OPERATION_ABORTED&&we.code!==oe.UNEXPECTED_RESPONSE||we.data&&we.data.retry)&&(ke=m[(Be+1)%m.length],!0)),T)}(c,n,r,i);this.emit(Io.STATE_CHANGE,Ia.AP_CONNECTED);const{addressList:f}=u;return this.wmSequence++,f}async connectWorkerManager(n){let r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=r,this.emit(Io.STATE_CHANGE,Ia.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(n,1e4)}async connectWorker(n){await this.workerConnection.init([n])}handleWorkerManagerEvents(){this.workerManagerConnection.on(pn.CONNECTED,async()=>{this.emit(Io.STATE_CHANGE,Ia.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(pn.CLOSED,()=>{this._innerConnectionState<Ia.GET_WORKER_MANAGER_RESPONSE&&x.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(pn.FAILED,()=>{this._innerConnectionState<Ia.GET_WORKER_MANAGER_RESPONSE&&x.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(pn.RECONNECTING,()=>{this._innerConnectionState<Ia.GET_WORKER_MANAGER_RESPONSE&&x.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(pn.ON_MESSAGE,async n=>{this.emit(Io.STATE_CHANGE,Ia.GET_WORKER_MANAGER_RESPONSE);const r=this.workerManagerConnection.url;this.workerManagerConnection.close();const i=JSON.parse(n.data);if(i.code!==200)throw x.error("[".concat(this._inspectId,"] Unexpected code ").concat(i.code," from worker manager")),new Ue(oe.UNEXPECTED_RESPONSE,"response code of worker is unexpected",i);if(!(i.serverResponse&&i.serverResponse.portWss&&r))throw x.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(i))),new Ue(oe.UNEXPECTED_RESPONSE,"response content of worker is unexpected",i);{const c=de("VIDEO_INSPECT_WORKER_PORT")||i.serverResponse.portWss,u=r.replace(/:\d+\/?$/,":".concat(c));this.emit(Io.STATE_CHANGE,Ia.CONNECT_WORKER,u),this._needWorkUrlOnly?this.emit(Io.REQUEST_NEW_WORKER_URL,u):await this.connectWorker(u)}}),this.workerManagerConnection.on(pn.WILL_RECONNECT,(n,r,i)=>{i(n)}),this.workerManagerConnection.on(pn.REQUEST_NEW_URLS,(n,r)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(n).catch(r)})}handleWorkerEvents(){this.workerConnection.on(pn.CONNECTED,async()=>{this.emit(Io.STATE_CHANGE,Ia.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Ra.CONNECTED}),this.workerConnection.on(pn.ON_MESSAGE,async n=>{if(n.data instanceof ArrayBuffer){const i=Aue(new Uint8Array(n.data));if(de("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&x.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(i)),i.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Io.INSPECT_RESULT,void 0,void 0);if(i.data&&i.data.scorePorn&&i.data.scoreSexy&&i.data.scoreNeutral){var r;const c={porn:i.data.scorePorn,sexy:i.data.scoreSexy,neutral:i.data.scoreNeutral},u=qa(r=Object.keys(c)).call(r,(m,_)=>c[m]>c[_]?m:_,"porn"),f=Object.keys(c).find(m=>m===u);this.emit(Io.INSPECT_RESULT,f)}else this.emit(Io.INSPECT_RESULT,void 0,new Ue(oe.UNEXPECTED_RESPONSE,i.code+"","There is an unexpected data on message"))}else this.emit(Io.INSPECT_RESULT,void 0,new Ue(oe.UNEXPECTED_RESPONSE,i.code+"",i.msg))}else x.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Io.INSPECT_RESULT,void 0,new Ue(oe.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(pn.CLOSED,()=>{this.connectionState=Ra.CLOSED}),this.workerConnection.on(pn.FAILED,()=>{this.connectionState=Ra.CLOSED}),this.workerConnection.on(pn.RECONNECTING,()=>{this.connectionState=this.connectionState===Ra.CONNECTED?Ra.RECONNECTING:Ra.CONNECTING}),this.workerConnection.on(pn.WILL_RECONNECT,(n,r,i)=>{n==="recover"&&i(n),i("tryNext")}),this.workerConnection.on(pn.REQUEST_NEW_URLS,(n,r)=>{this.workerManagerConnection.close(),this.once(Io.REQUEST_NEW_WORKER_URL,i=>{n([i])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(i=>{this.connectWorkerManager(i,!0)}).catch(i=>{r(i)})})}async requestToInspectImage(){this.sequence++;const n=wi(this,Io.CLIENT_LOCAL_VIDEO_TRACK),r={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(n){if(!n.isPlaying)return void this.emit(Io.INSPECT_RESULT,void 0,new Ue(oe.INVALID_OPERATION,"Only the track being played can be inspected"));const i=await this.generateRequestData(n,r);this.workerConnection.sendMessage(i,!0,!0)}else this.emit(Io.INSPECT_RESULT,void 0,new Ue(oe.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(n,r){let{appId:i,cname:c,cid:u,vid:f,sid:m,uid:_}=r;const y=Date.now(),T=await n.getCurrentFrameImage("image/jpeg",this.quality),A=await aV(T,i,c),k=this.sequence+"-"+u+"-"+_+"-"+y+"-"+dr(12,""),P={appId:i,cid:u,cname:c,deviceId:"",elapse:(q=Number(y-this.inspectStartTime),{low:q|=0,high:q>>31,unsigned:q>=0}),fileSize:A.byteLength,jpgEncryption:2,height:T.height,width:T.width,jpg:A,networkType:6,osType:7,requestId:k,sdkVersion:"4.23.2",sequence:this.sequence,sid:m,timestamp:L3(y),uid:_,vid:f,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var q;this.extraInfo===void 0&&delete P.callbackData,this.ossFilePrefix===void 0&&delete P.ossFilePrefix;const j=Iue(P);if(j.byteLength<this.workerMessageLengthLimit){if(de("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const H=function(ne){for(var re=1;re<arguments.length;re++){var ve=arguments[re]!=null?arguments[re]:{};re%2?Rj(Object(ve),!0).forEach(function(Oe){Q(ne,Oe,ve[Oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(ve)):Rj(Object(ve)).forEach(function(Oe){Object.defineProperty(ne,Oe,Object.getOwnPropertyDescriptor(ve,Oe))})}return ne}({},P);delete H.jpg,x.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(H))}return j}{const H=this.quality*this.qualityRatio;return this.quality=H,await this.generateRequestData(n,{appId:i,cname:c,cid:u,vid:f,sid:m,uid:_})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Is.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Ra.CLOSED,this.emit(Io.STATE_CHANGE,Ia.CLOSED)}}const Uue={name:"ContentInspect",create:function(e){let{config:n}=e;return function(r){if(!r)throw new Ue(oe.INVALID_PARAMS,"inspectConfig is necessary.");if(!r.inspectType||!Array.isArray(r.inspectType))throw new Ue(oe.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const i=[...new Set(r.inspectType)];i.forEach(c=>{var u;if(!gt(u=["supervise","moderation"]).call(u,c))throw new Ue(oe.INVALID_PARAMS,"".concat(c," is not a valid inspect type."))}),r.inspectType=i}if(r&&r.extraInfo&&r.extraInfo.length>1024)throw new Ue(oe.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(n),new xue(n)}};var Ij=l(Ot.Object.getOwnPropertySymbols),Vue=rr,Fue=Z0.indexOf,Bue=A_,VI=Y([].indexOf),Aj=!!VI&&1/VI([1],1,-0)<0;Vue({target:"Array",proto:!0,forced:Aj||!Bue("indexOf")},{indexOf:function(e){var n=arguments.length>1?arguments[1]:void 0;return Aj?VI(this,e,n)||0:Fue(this,e,n)}});var jue=ma("Array").indexOf,$ue=C,Hue=jue,FI=Array.prototype,Wue=function(e){var n=e.indexOf;return e===FI||$ue(FI,e)&&n===FI.indexOf?Hue:n},Oj=l(Wue);function Kue(e,n){if(e==null)return{};var r,i,c=function(f,m){if(f==null)return{};var _,y,T={},A=qF(f);for(y=0;y<A.length;y++)_=A[y],Oj(m).call(m,_)>=0||(T[_]=f[_]);return T}(e,n);if(Ij){var u=Ij(e);for(i=0;i<u.length;i++)r=u[i],Oj(n).call(n,r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}let Nj=class{get localCapabilities(){return Br(this._localCapabilities)}get rtpCapabilities(){return Br(this._rtpCapabilities)}get candidates(){return Br(this._candidates)}get iceParameters(){return Br(this._iceParameters)}get dtlsParameters(){return Br(this._dtlsParameters)}constructor(e){Q(this,"sessionDesc",void 0),Q(this,"_localCapabilities",void 0),Q(this,"_rtpCapabilities",void 0),Q(this,"_candidates",void 0),Q(this,"_iceParameters",void 0),Q(this,"_dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname","o/i14u9pJrxRKAsu"),Q(this,"firefoxSsrcMidMap",new Map),e=Br(e);const{remoteIceParameters:n,remoteDtlsParameters:r,candidates:i,remoteRTPCapabilities:c,localCapabilities:u,direction:f,setup:m,videoCodec:_,audioCodec:y}=e;let T;this.setup=m,T=f===Es.RECEIVE_ONLY?$s(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):$s(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=c,this._candidates=i,this._iceParameters=n,this._dtlsParameters=r,this._localCapabilities=u;const A=f===Es.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,k=f===Es.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,P=f===Es.RECEIVE_ONLY?c.send.videoCodecs:Ev(kt.VIDEO,A,k,_),q=f===Es.RECEIVE_ONLY?c.send.audioCodecs:Ev(kt.AUDIO,A,k,y);for(const j of T.mediaDescriptions)j.attributes.iceUfrag=n.iceUfrag,j.attributes.icePwd=n.icePwd,j.attributes.fingerprints=r.fingerprints,j.attributes.candidates=i,j.attributes.setup=this.setup,j.media.mediaType==="application"&&(j.attributes.sctpPort="5000"),j.media.mediaType==="video"&&(j.media.fmts=P.map(H=>H.payloadType.toString(10)),j.attributes.payloads=P,j.attributes.extmaps=A.videoExtensions),j.media.mediaType==="audio"&&(j.media.fmts=q.map(H=>H.payloadType.toString(10)),j.attributes.payloads=q,j.attributes.extmaps=A.audioExtensions,Qf(j));this.sessionDesc=T,this.currentMidIndex=T.mediaDescriptions.length-1}toString(){return Iu(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every(n=>this.hasMid(n)):this.sessionDesc.mediaDescriptions.some(n=>n.attributes.mid===e)}send(e,n,r,i,c){r=r.replace(/ /g,"-");const{ssrcs:u,ssrcGroups:f}=zd(n,this.cname,de("SYNC_GROUP")?r:void 0),m=this.findPreloadMediaDesc(u);if(m){if(Ur()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,m.attributes.mid),c&&(c.twcc||c.remb)){const _=this.sessionDesc.mediaDescriptions.indexOf(m);return this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(m,c),{mid:m.attributes.mid,needExchangeSDP:!0}}return{mid:m.attributes.mid,needExchangeSDP:!1}}{const _=this.findAvailableMediaIndex(e,u,i);let y;return _===-1?(y=this.createOrRecycleSendMedia(e,u,f,"sendonly",i,c),this.updateBundleMids()):(y=Br(this.sessionDesc.mediaDescriptions[_]),y.attributes.direction="sendonly",y.attributes.ssrcs=u,y.attributes.ssrcGroups=f,this.sessionDesc.mediaDescriptions[_]=this.mungSendMediaDesc(y,c)),Ur()&&this.firefoxSsrcMidMap.set(u[0].ssrcId,y.attributes.mid),{needExchangeSDP:!0,mid:y.attributes.mid}}}stopSending(e){const n=this.sessionDesc.mediaDescriptions.filter(r=>r.attributes.mid&&e.indexOf(r.attributes.mid)!==-1);if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");n.forEach(r=>{r.attributes.ssrcs=[]}),this.updateBundleMids()}receive(e,n,r){const i=[];return e.forEach(c=>{const u=c._mediaStreamTrack.kind,f=this.findAvailableRecvMediaIndex(u);let m,_=!1;f===-1?(_=!0,m=this.createOrRecycleRecvMedia(c,[],"recvonly",n,r),this.updateBundleMids()):(m=Br(this.sessionDesc.mediaDescriptions[f]),m.attributes.direction="recvonly"),i.push({mid:m.attributes.mid,needCreateTransceiver:_})}),i}stopReceiving(e){const n=this.sessionDesc.mediaDescriptions.filter(r=>e.indexOf(r.attributes.mid)!==-1);if(n.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");n.forEach(r=>{r.media.port="0",r.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:n,protocol:r,address:i,port:c,type:u,relatedAddress:f,relatedPort:m,priority:_}=new RTCIceCandidate(e),y={foundation:n??"",componentId:"1",transport:r??"",priority:_?_+"":"",connectionAddress:i??"",port:c?c+"":"",type:u?u+"":"",relAddr:f??"",relPort:m?m+"":"",extension:{}};this.candidates.some(T=>T.priority===y.priority&&T.connectionAddress===y.connectionAddress&&T.port===y.port)||(this._candidates.push(y),this.sessionDesc.mediaDescriptions.forEach(T=>{T.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,n,r,i,c){const u=e._mediaStreamTrack.kind,f=this.rtpCapabilities.recv,m=Ev(u,f,this.localCapabilities.send,u===kt.AUDIO?c:i),_=u===kt.VIDEO?f.videoExtensions:f.audioExtensions,y="".concat(++this.currentMidIndex);let T={media:{mediaType:u,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(k=>k.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(y)}};T=this.mungRecvMediaDsec(T,e);const A=this.findFirstClosedMedia(u);if(A){const k=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[k]=T}else this.sessionDesc.mediaDescriptions.push(T);return T}muteRemote(e){const n=this.sessionDesc.mediaDescriptions.filter(r=>gt(e).call(e,r.attributes.mid||""));if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(r=>{r.attributes.direction="inactive"})}unmuteRemote(e){const n=this.sessionDesc.mediaDescriptions.filter(r=>gt(e).call(e,r.attributes.mid||""));if(n.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");n.forEach(r=>{r.attributes.direction="recvonly"})}findAvailableMediaIndex(e,n,r){return this.sessionDesc.mediaDescriptions.findIndex(i=>{const c=i.media.mediaType===e&&i.media.port!=="0"&&(i.attributes.direction==="sendonly"||i.attributes.direction==="sendrecv")&&i.attributes.ssrcs.length===0;if(Ur()){if(c){const u=this.firefoxSsrcMidMap.get(n[0].ssrcId);return!(u||i.attributes.mid!=="0"&&i.attributes.mid!=="1")||!(!u||u!==i.attributes.mid)}return!1}return c&&i.attributes.mid===r})}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex(n=>{const r=n.media.mediaType===e&&n.media.port!=="0"&&(n.attributes.direction==="recvonly"||n.attributes.direction==="sendrecv");return n.attributes.mid!=="0"&&n.attributes.mid!=="1"&&r})}predictReceivingMids(e){const n=[];for(let r=0;r<e;r++)n.push((this.currentMidIndex+r+1).toString(10));return n}restartICE(e){e=Br(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach(n=>{n.attributes.iceUfrag=e.iceUfrag,n.attributes.icePwd=e.icePwd})}createOrRecycleSendMedia(e,n,r,i,c,u){const f=this.rtpCapabilities.send,m=e===kt.VIDEO?f.videoCodecs:f.audioCodecs,_=e===kt.VIDEO?f.videoExtensions:f.audioExtensions;Ur()&&(c="".concat(++this.currentMidIndex));let y={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:m.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:n,ssrcGroups:r,rtcpFeedbackWildcards:[],payloads:m,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:c}};y=this.mungSendMediaDesc(y,u);const T=this.findFirstClosedMedia(e);if(T){const A=this.sessionDesc.mediaDescriptions.indexOf(T);this.sessionDesc.mediaDescriptions[A]=y}else this.sessionDesc.mediaDescriptions.push(y);return y}mungRecvMediaDsec(e,n,r){const i=Br(e);return BR(i),Zf(i,n),jR(i,n),yB(i),Oy(i,r,this.localCapabilities.send),i}mungSendMediaDesc(e,n){const r=Br(e);return Oy(r,n,this.localCapabilities.recv),Qf(r),r}updateRecvMedia(e,n){const r=this.sessionDesc.mediaDescriptions.findIndex(i=>i.attributes.mid===e);if(r!==-1){const i=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],n);this.sessionDesc.mediaDescriptions[r]=i}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(e=>e.media.port!=="0").map(e=>e.attributes.mid)}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find(n=>{var r;return((r=n.attributes)===null||r===void 0||(r=r.ssrcs[0])===null||r===void 0?void 0:r.ssrcId)===e[0].ssrcId})}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find(n=>Ur()?n.media.port==="0"&&n.media.mediaType===e:n.media.port==="0")}};const Gue=["sdp"];var Er;function kj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Hu(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?kj(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kj(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}let Pj=(Er=class Cp extends tB{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var n,r;return(n=(r=this.peerConnection.getReceivers()[0])===null||r===void 0||(r=r.transport)===null||r===void 0?void 0:r.state)!==null&&n!==void 0?n:null}get localCodecs(){return[]}set isInRestartIce(n){this._isInRestartIce=n}get isInRestartIce(){return this._isInRestartIce}constructor(n,r,i){super(n,r),Q(this,"direction",void 0),Q(this,"name",void 0),Q(this,"store",void 0),Q(this,"spec",void 0),Q(this,"peerConnection",void 0),Q(this,"initialOffer",void 0),Q(this,"transport",void 0),Q(this,"statsFilter",void 0),Q(this,"localCandidateCount",0),Q(this,"_isInRestartIce",!1),Q(this,"mutex",void 0),Q(this,"onLocalCandidate",void 0),Q(this,"remoteSDP",void 0),Q(this,"pendingCandidates",[]),Q(this,"localCapabilities",void 0),Q(this,"isReady",!1),Q(this,"restartCnt",0),Q(this,"curTurnServerIndex",0),this.store=r,this.spec=n,this.mutex=new Ko("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(Cp.resolvePCConfiguration(n,r.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=i??Es.SEND_ONLY,this.name=this.direction===Es.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=eR(this.peerConnection,de("STATS_UPDATE_INTERVAL"),void 0,Ur()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(n){try{const r=await SB();if(this.localCapabilities=Ny(r),n){const{sdp:i}=n,c=Kue(n,Gue),u=function(){const T={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},A=_v(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),k={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},P={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},q={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(Aa(A,T,"videoExtensions",k,P,q),Aa(A,T,"videoCodecs",k,P,q),Aa(A,T,"audioExtensions",k,P,q),Aa(A,T,"audioCodecs",k,P,q),de("RAISE_H264_BASELINE_PRIORITY")){const j=q.videoCodecs.findIndex(H=>H.rtpMap&&H.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&H.fmtp&&H.fmtp.parameters["profile-level-id"]==="42001f");if(j!==-1){const H=q.videoCodecs.findIndex(ne=>ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(H<j){x.debug("raising H264 baseline profile priority");const ne=q.videoCodecs[j];q.videoCodecs.splice(j,1),q.videoCodecs.splice(H,0,ne)}H!==-1&&de("FILTER_SEND_H264_BASELINE")&&(k.videoCodecs=k.videoCodecs.filter(ne=>!(ne.rtpMap&&ne.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&ne.fmtp&&ne.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:k,recv:P,sendrecv:q}}({},{},i);this.remoteSDP=new Nj({remoteIceParameters:c.iceParameters,remoteDtlsParameters:c.dtlsParameters,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const f=await this.peerConnection.createAnswer();if(!f.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const m=Pu(f.sdp);await this.peerConnection.setLocalDescription(f);const _=await TB({},{},f.sdp);this.localCapabilities=Ny(_);const y=this.peerConnection.getTransceivers()[0];return y!=null&&y.receiver&&y.receiver.transport&&this.tryBindTransportEvents(y.receiver.transport),Hu(Hu({},m),{},{sdp:f.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const i=await this.peerConnection.createOffer();if(!i.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const c=Pu(i.sdp);return this.initialOffer=i,Hu(Hu({},c),{},{sdp:i.sdp})}}catch(r){throw new $e(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,r.toString())}}async connect(n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:r,iceParameters:i,dtlsParameters:c}=n,u=await TB({},{},r);this.remoteSDP=new Nj({remoteIceParameters:i,remoteDtlsParameters:c,candidates:[],remoteRTPCapabilities:u,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const f=this.peerConnection.getTransceivers()[0];f!=null&&f.sender&&f.sender.transport&&this.tryBindTransportEvents(f.sender.transport)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async addRemoteCandidate(n){try{n&&this.pendingCandidates.push(n),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(r=>{this.peerConnection.addIceCandidate(r)}),this.pendingCandidates=[])}catch(r){throw new $e(oe.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(r.toString()))}}send(n,r,i){var c=this;return zi(function*(){const u=yield Ln(c.mutex.lock("From P2PConnection.send"));try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const f=[],m=c.remoteSDP.receive(n,r,i);n.forEach((H,ne)=>{if(m[ne].needCreateTransceiver){const re=c.peerConnection.addTransceiver(H._mediaStreamTrack,{direction:"sendonly"});f.push(re),H._updateRtpTransceiver(re)}else{const re=c.peerConnection.getTransceivers().find(ve=>ve.mid===m[ne].mid);if(!re)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(m[ne].mid));f.push(re),H._updateRtpTransceiver(re)}}),Ur()&&de("SIMULCAST")===!0&&(yield Ln(c.applySimulcastForFirefox(f,n)));const _=m.map(H=>H.mid),y=yield Ln(c.peerConnection.createOffer()),T=c.mungSendOfferSDP(y.sdp,n,_),A=$s(T),k=_.map(H=>{const ne=A.mediaDescriptions.find(re=>re.attributes.mid===H);if(!ne)throw new Error("Cannot extract ssrc from mediaDescription.");return gB(ne,de("USE_PUB_RTX"))}),P=f.map((H,ne)=>{const re=_[ne];return{localSSRC:k[ne],id:re}});yield Ln(c.peerConnection.setLocalDescription({type:"offer",sdp:T}));try{yield P}catch(H){const ne=c.remoteSDP.toString();throw yield Ln(c.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield Ln(c.peerConnection.setRemoteDescription({type:"answer",sdp:ne})),yield Ln(c.stopSending(_,!0)),H}yield Ln(c.applySimulcastEncodings(f,n)),yield Ln(c.applySendEncodings(f,n));const q=c.remoteSDP.toString(),j=c.logSDPExchange(T,"offer","local","send");return j==null||j(q),yield Ln(c.setRemoteDescription({type:"answer",sdp:q})),f.map((H,ne)=>{const re=_[ne];return{localSSRC:k[ne],id:re}})}catch(f){throw f instanceof $e?f:new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(f.toString()))}finally{u()}})()}async stopSending(n,r){const i=r?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const c=this.peerConnection.getTransceivers().filter(_=>n.indexOf(_.mid)!==-1);if(c.length!==n.length)throw new Error("Transceivers' length (".concat(c.length,") doesn't match mids' length (").concat(n.length,") when trying to call P2PConnection.stopSending."));c.map(_=>{var y;_.direction="inactive",(y=_.stop)===null||y===void 0||y.call(_)});const u=await this.peerConnection.createOffer(),f=this.logSDPExchange(u.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(u),this.remoteSDP.stopReceiving(n);const m=this.remoteSDP.toString();f==null||f(m),await this.setRemoteDescription({type:"answer",sdp:m})}catch(c){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(c.toString()))}finally{i&&i()}}async receive(n,r,i,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:u,needExchangeSDP:f}=this.remoteSDP.send(n,r,i,c);if(f){const _=this.remoteSDP.toString(),y=this.logSDPExchange(_,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:_});const T=await this.peerConnection.createAnswer(),A=this.mungReceiveAnswerSDP(T.sdp,u,n);y==null||y(A||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:A}),x.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP."))}else x.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," no need to exchange SDP."));const m=this.peerConnection.getTransceivers().find(_=>_.mid===u);if(!m||m.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:m.receiver.track,mid:m.mid,transceiver:m}}catch(u){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async mockReceive(n,r,i,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{mid:u,needExchangeSDP:f}=this.remoteSDP.send(n,r,i,c);if(f){const m=this.remoteSDP.toString(),_=this.logSDPExchange(m,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:m});const y=await this.peerConnection.createAnswer(),T=this.mungReceiveAnswerSDP(y.sdp,u,n);_==null||_(T||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:T}),x.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," by exchanging SDP."))}else x.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(n," no need to exchange SDP."))}catch(u){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString(),i=this.logSDPExchange(r,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:r});const c=await this.peerConnection.createAnswer();i==null||i(c.sdp||""),await this.peerConnection.setLocalDescription(c)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async restartICE(n){try{if(this.store.p2pTransport===Fd.Auto&&(this.store.p2pTransport=Fd.SdRtn,Bn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Cp.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,Bn().supportPCSetConfiguration&&this.peerConnection.setConfiguration(Cp.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!n){this.restartCnt++,this.isReady=!1;const r=await this.peerConnection.createOffer({iceRestart:!0});if(!r.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:i}=Pu(r.sdp);return this.store.descriptionStart(),this.direction===Es.SEND_ONLY&&await this.peerConnection.setLocalDescription(r),i}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(n),this.store.descriptionStart(),this.direction===Es.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:i}=Pu(r.sdp);return await this.peerConnection.setLocalDescription(r),i}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}close(){var n;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(i.sdp,[r],[n]);this.remoteSDP.updateRecvMedia(n,r);const u=this.remoteSDP.toString(),f=this.logSDPExchange(c,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),f==null||f(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new $e(oe.EXCHANGE_SDP_FAILED,i.toString())}}async updateSendParameters(n,r){const i=this.peerConnection.getTransceivers().filter(c=>c.mid===n);i.length===1&&(this.isVP8Simulcast(r)?Ur()||await this.applySimulcastEncodings(i,[r]):await this.applySendEncodings(i,[r]))}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const i=this.peerConnection.getTransceivers().find(c=>c.mid===r);i&&await i.sender.replaceTrack(n._mediaStreamTrack)}async getSelectedCandidatePair(){const n=this.peerConnection.getReceivers();if(n.length>0&&n[0].transport&&n[0].transport.iceTransport&&n[0].transport.iceTransport.getSelectedCandidatePair&&n[0].transport.iceTransport.getSelectedCandidatePair()){const r=n[0].transport.iceTransport,{local:i,remote:c}=r.getSelectedCandidatePair();return{local:Hu(Hu({},Fc),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port}),remote:Hu(Hu({},Fc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n,r;gt(n=["connected","completed"]).call(n,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(r=this.onICEConnectionStateChange)===null||r===void 0||r.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=n=>{if(n.candidate){var r;n.candidate.candidate&&((r=this.onLocalCandidate)===null||r===void 0||r.call(this,n.candidate.toJSON())),this.localCandidateCount+=1}else x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c={iceServers:[]};var u;return n.iceServers?c.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(sv(n.turnServer.servers)?c.iceServers=n.turnServer.servers:(c.iceServers&&c.iceServers.push(...Cp.turnServerConfigToIceServers(n.turnServer.servers,r,i)),de("USE_TURN_SERVER_OF_GATEWAY")&&c.iceServers&&n.turnServer.serversFromGateway&&c.iceServers.push(...Cp.turnServerConfigToIceServers(n.turnServer.serversFromGateway,r,i)),gt(u=[Fd.Relay,Fd.SdRtn]).call(u,r)&&(c.iceTransportPolicy="relay"),de("FORCE_TURN_TCP")?c.iceTransportPolicy="relay":n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(f=>{f.forceturn&&(c.iceTransportPolicy="relay")}))),de("ENABLE_ENCODED_TRANSFORM")&&Bn().supportWebRTCEncodedTransform&&(c.encodedInsertableStreams=!0),x.debug("P2PConnection p2pTransport is ".concat(r)),c}static turnServerConfigToIceServers(n,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const c=[],u=n.filter(m=>m.tcpport);x.debug("P2PConnection turnServers is ".concat(u,", current index is ").concat(i));const f=u.length>i?u[i]:u[0];switch(r){case Fd.SdRtn:const m=n.filter(y=>{var T;return gt(T=y.username).call(T,"glb:")&&y.turnServerURL==y.turnServerURL}),_=m.length>i?m[i]:m[0];_&&(c.push({username:_.username,credential:_.password,credentialType:"password",urls:"turn:".concat(Nu(_.turnServerURL),":").concat(_.tcpport,"?transport=udp")}),c.push({username:_.username,credential:_.password,credentialType:"password",urls:"turns:".concat(Nu(_.turnServerURL),":").concat(_.tcpport,"?transport=tcp")}));break;case Fd.Relay:f&&(c.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.tcpport,"?transport=udp")}),c.push({username:f.username,credential:f.password,credentialType:"password",urls:"turns:".concat(Nu(f.turnServerURL),":").concat(f.tcpport,"?transport=tcp")}));break;default:f&&(c.push({username:f.username,credential:f.password,credentialType:"password",urls:"turn:".concat(f.turnServerURL,":").concat(f.tcpport,"?transport=udp")}),c.push({username:f.username,credential:f.password,credentialType:"password",urls:"turns:".concat(Nu(f.turnServerURL),":").concat(f.tcpport,"?transport=tcp")}),c.push({username:f.username,credential:f.password,credentialType:"password",urls:"stun:".concat(f.turnServerURL,":").concat(f.tcpport)}))}return c}tryBindTransportEvents(n){if(n){this.transport=n,n.onstatechange=()=>{var i;n!=null&&n.state&&((i=this.onDTLSTransportStateChange)===null||i===void 0||i.call(this,n.state))},n.onerror=i=>{var c;(c=this.onDTLSTransportError)===null||c===void 0||c.call(this,"error"in i?i.error:i)};const r=n.iceTransport;r&&(r.onstatechange=()=>{const i=n==null?void 0:n.iceTransport.state;var c;i&&((c=this.onICETransportStateChange)===null||c===void 0||c.call(this,i))},r.getSelectedCandidatePair&&(r.onselectedcandidatepairchange=()=>{if(r.getSelectedCandidatePair()){const{local:i,remote:c}=r.getSelectedCandidatePair();x.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:i.type,protocol:i.protocol}),", remote ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(n,r){var i;if(r||(r=this.peerConnection.getSenders().find(T=>T.track===n._mediaStreamTrack)),!r)return x.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(n))return x.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!Bn().supportSetRtpSenderParameters)return x.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const c={},u={};switch(n._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(n._encoderConfig){var f;const{bitrateMax:T,frameRate:A,scaleResolutionDownBy:k}=n._encoderConfig;T&&(u.maxBitrate=1e3*T),gt(f=n._hints).call(f,hr.LOW_STREAM)&&(A&&(u.maxFramerate=ii(A)),k&&k>=1&&(u.scaleResolutionDownBy=k))}if(de("DSCP_TYPE")&&Il()){var m;const T=de("DSCP_TYPE");gt(m=["very-low","low","medium","high"]).call(m,T)&&(u.networkPriority=T)}const _=r.getParameters(),y=(i=_.encodings)===null||i===void 0?void 0:i[0];Ur()&&!y&&(c.encodings=[u]),y&&Object.assign(y,u),Object.assign(_,c),x.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(_.encodings))),await r.setParameters(_)}async applySendEncodings(n,r){try{if(!Bn().supportSetRtpSenderParameters||n.length!==r.length)return;for(let i=0;i<n.length;i++){const c=n[i],u=r[i];u instanceof Sr&&!this.isVP8Simulcast(u)&&await this.updateRtpSenderEncodings(u,c.sender)}}catch{x.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r,i){const c=$s(n);return r.forEach((u,f)=>{const m=i[f],_=c.mediaDescriptions.find(y=>y.attributes.mid===m);_&&(Zf(_,u),bB(_,u,this.store.codec))}),Iu(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,i)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,i)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var i;(i=this.onSelectedLocalCandidateChanged)===null||i===void 0||i.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var i;(i=this.onSelectedRemoteCandidateChanged)===null||i===void 0||i.call(this,n,r)},this.statsFilter.onFirstVideoDecodedTimeout=n=>{var r;(r=this.onFirstVideoDecodedTimeout)===null||r===void 0||r.call(this,n)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(n,r){if(n.length===r.length)for(let _=0;_<n.length;_++){var i,c,u,f,m;const y=n[_],T=r[_];if(T instanceof Sr&&!gt(i=T._hints).call(i,hr.LOW_STREAM)&&(c=T._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=T._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(f=T._scalabilityMode)!==null&&f!==void 0&&f.numSpatialLayers&&((m=T._scalabilityMode)===null||m===void 0?void 0:m.numSpatialLayers)>1&&this.store.codec==="vp8"){const A={},k={high:1e3*(T._encoderConfig.bitrateMax-50),medium:5e4};A.encodings=[{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:k.high}];const P=y.sender.getParameters();await y.sender.setParameters(Object.assign(P,A))}}}async applySimulcastEncodings(n,r){if(!Ur()&&n.length===r.length)for(let i=0;i<n.length;i++){const c=r[i];if(c instanceof Sr&&this.isVP8Simulcast(c)){const u=n[i],f={},m={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};f.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:m.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:m.medium,scaleResolutionDownBy:4}];const _=u.sender.getParameters();await u.sender.setParameters(Object.assign(_,f))}}}isVP8Simulcast(n){var r,i,c,u,f;return!!(n instanceof Sr&&de("SIMULCAST")&&this.store.codec==="vp8"&&!gt(r=n._hints).call(r,hr.LOW_STREAM)&&(i=n._encoderConfig)!==null&&i!==void 0&&i.bitrateMax&&((c=n._encoderConfig)===null||c===void 0?void 0:c.bitrateMax)>200&&(u=n._scalabilityMode)!==null&&u!==void 0&&u.numSpatialLayers&&((f=n._scalabilityMode)===null||f===void 0?void 0:f.numSpatialLayers)>1)}logSDPExchange(n,r,i,c){if(de("SDP_LOGGING"))return x.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(r," SDP during P2PConnection.").concat(c,`
`),n),r==="offer"?u=>{this.logSDPExchange(u,"answer",i==="local"?"remote":"local",c)}:void 0}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(f=>f.mid&&n.indexOf(f.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(f=>{f.direction="inactive"});const i=await this.peerConnection.createOffer(),c=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(n);const u=this.remoteSDP.toString();c==null||c(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getTransceivers().filter(f=>f.mid&&n.indexOf(f.mid)!==-1);if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length.");r.map(async f=>{f.direction="sendonly"});const i=await this.peerConnection.createOffer(),c=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(n);const u=this.remoteSDP.toString();c==null||c(u),await this.setRemoteDescription({type:"answer",sdp:u})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}async getRemoteSSRC(n,r){var i,c;if(r=(i=r)!==null&&i!==void 0?i:(c=this.currentRemoteDescription)===null||c===void 0?void 0:c.sdp){var u;const f=(u=$s(r).mediaDescriptions.find(m=>m.attributes.mid===n))===null||u===void 0?void 0:u.attributes.ssrcs;return f==null?void 0:f[0].ssrcId}}async setRemoteDescription(n){var r;await this.peerConnection.setRemoteDescription(n),gt(r=["connected","completed"]).call(r,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(n,r,i){const c=$s(n),u=c.mediaDescriptions.find(f=>f.attributes.mid===r);return u&&i===kt.AUDIO&&u.media.mediaType==="audio"&&Qf(u),Iu(c)}},Lt(Er.prototype,"establish",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"establish"),Er.prototype),Lt(Er.prototype,"connect",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"connect"),Er.prototype),Lt(Er.prototype,"receive",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"receive"),Er.prototype),Lt(Er.prototype,"mockReceive",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"mockReceive"),Er.prototype),Lt(Er.prototype,"stopReceiving",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"stopReceiving"),Er.prototype),Lt(Er.prototype,"restartICE",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"restartICE"),Er.prototype),Lt(Er.prototype,"close",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"close"),Er.prototype),Lt(Er.prototype,"updateEncoderConfig",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"updateEncoderConfig"),Er.prototype),Lt(Er.prototype,"updateSendParameters",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"updateSendParameters"),Er.prototype),Lt(Er.prototype,"replaceTrack",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"replaceTrack"),Er.prototype),Lt(Er.prototype,"muteLocal",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"muteLocal"),Er.prototype),Lt(Er.prototype,"unmuteLocal",[Da],Object.getOwnPropertyDescriptor(Er.prototype,"unmuteLocal"),Er.prototype),Er);function Da(e,n,r){const i=e[n];if(typeof i!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,u=await c.lock("From P2PConnection.".concat(n));try{for(var f=arguments.length,m=new Array(f),_=0;_<f;_++)m[_]=arguments[_];return await i.apply(this,m)}finally{u()}},r}let lc=function(e){return e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY",e}({});var Dj,Lj,Mj,xj,Uj,Vj,Fj,Bj,jj,$j,Hj,Pr;function Wj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function hb(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Wj(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wj(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}let zue=(Dj=uc(lc.SEND_ONLY),Lj=uc(lc.SEND_ONLY),Mj=uc(),xj=uc(lc.RECEIVE_ONLY),Uj=uc(lc.RECEIVE_ONLY),Vj=uc(lc.RECEIVE_ONLY),Fj=uc(lc.RECEIVE_ONLY),Bj=uc(lc.RECEIVE_ONLY),jj=uc(lc.RECEIVE_ONLY),$j=uc(),Hj=uc(lc.RECEIVE_ONLY),Pr=class extends Dr{get state(){return this._state}set state(e){const n=this._state;this._state=e,this.emit(Kt.StateChange,n,this._state)}constructor(e,n){super(),Q(this,"isPlanB",!1),Q(this,"store",void 0),Q(this,"statsUploader",void 0),Q(this,"sendConnection",void 0),Q(this,"recvConnection",void 0),Q(this,"localTrackMap",new Map),Q(this,"remoteUserMap",new Map),Q(this,"localDataChannels",[]),Q(this,"pendingLocalTracks",[]),Q(this,"pendingRemoteTracks",[]),Q(this,"statsCollector",void 0),Q(this,"dtlsFailedCount",0),Q(this,"sendMutex",void 0),Q(this,"recvMutex",void 0),Q(this,"_state",qn.Disconnected),Q(this,"_restartStates",["disconnected","failed"]),Q(this,"reconnectInterval",void 0),Q(this,"uploadUnplinkStarted",!1),Q(this,"uploadDownlinkStarted",!1),Q(this,"uplinkStateUploadInterval",void 0),Q(this,"downlinkStatsUploadInterval",void 0),Q(this,"handleMuteLocalTrack",async(r,i,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==qn.Connected)return void c(new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const _=this.filterTobeMutedTracks(r);if(_.length===0)return void i();const y=_.find(P=>P[0]==="videoLowTrack");y&&y[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(_.map(P=>{let[,{id:q}]=P;return q}));let T=!1;var f,m;r.trackMediaType==="video"?T=!((f=this.localTrackMap.get(at.LocalAudioTrack))===null||f===void 0||!f.track._muted):T=((m=this.localTrackMap.get(at.LocalVideoTrack))===null||m===void 0?void 0:m.id)===void 0;const A=this.createMuteMessage(_);await ur(this,Kt.RequestMuteLocal,A);const k=r.trackMediaType==="video"?Ou.MUTE_LOCAL_VIDEO:Ou.MUTE_LOCAL_AUDIO;await ur(this,Kt.RequestP2PMuteLocal,{action:k,message:A,isMuteAll:T}),i()}catch(_){c(_)}finally{u()}}),Q(this,"handleUnmuteLocalTrack",async(r,i,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==qn.Connected)return void c(new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const f=this.filterTobeUnmutedTracks(r);if(f.length===0)return void i();await this.sendConnection.unmuteLocal(f.map(y=>{let[,{id:T}]=y;return T}));const m=this.createUnmuteMessage(f),_=r.trackMediaType==="video"?Ou.UNMUTE_LOCAL_VIDEO:Ou.UNMUTE_LOCAL_AUDIO;await ur(this,Kt.RequestP2PMuteLocal,{action:_,message:m}),i()}catch(f){c(f)}finally{u()}}),Q(this,"handleUpdateVideoEncoder",async(r,i,c,u)=>{let f;typeof u=="boolean"&&u||(f=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const _=this.localTrackMap.get(at.LocalVideoTrack);if(!this.sendConnection||!_||_.track!==r||this.state!==qn.Connected)return void i();const{id:y,track:T}=_;y&&(await this.sendConnection.updateSendParameters(y,T),await this.sendConnection.updateEncoderConfig(y,T),this.emit(Kt.UpdateVideoEncoder,T)),i()}catch(_){c(_)}finally{var m;(m=f)===null||m===void 0||m()}}),Q(this,"handleUpdateVideoSendParameters",async(r,i,c)=>{const u=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const f=this.localTrackMap.get(at.LocalVideoTrack);if(!this.sendConnection||!f||f.track!==r||this.state!==qn.Connected)return void i();const{id:m,track:_}=f;m&&await this.sendConnection.updateSendParameters(m,_),i()}catch(f){c(f)}finally{u()}}),Q(this,"handleReplaceTrack",async(r,i,c,u)=>{let f;x.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(r.getTrackId(),"]")),typeof u=="boolean"&&u||(f=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var m;const y=Array.from(this.localTrackMap.entries()).find(T=>{let[,{track:A}]=T;return r===A});if(!this.sendConnection||!y||y[1].id===void 0||this.state!==qn.Connected)return void i();if(await((m=this.sendConnection)===null||m===void 0?void 0:m.replaceTrack(r,y[1].id)),y[0]===at.LocalVideoTrack&&Bn().supportDualStreamEncoding){const T=this.localTrackMap.get(at.LocalVideoLowTrack);if(T){const A=r._mediaStreamTrack.clone();T.track._originMediaStreamTrack.stop(),T.track._mediaStreamTrack=A,T.track._originMediaStreamTrack=A,await new bt((k,P)=>{this.handleReplaceTrack(T.track,k,P,!0)})}}i()}catch(y){c(y)}finally{var _;(_=f)===null||_===void 0||_()}}),Q(this,"handleGetLocalVideoStats",r=>{r(this.statsCollector.getLocalVideoTrackStats())}),Q(this,"handleGetLocalAudioStats",r=>{r(this.statsCollector.getLocalAudioTrackStats())}),Q(this,"handleGetRemoteVideoStats",r=>this.statsCollector.getRemoteVideoTrackStats(r.uid)[r.uid]),Q(this,"handleGetRemoteAudioStats",r=>this.statsCollector.getRemoteAudioTrackStats(r.uid)[r.uid]),this.store=e,this.statsCollector=n,this.statsCollector.addP2PChannel(this),this.statsUploader=new c3(e),this.bindStatsUploaderEvents(),this.sendMutex=new Ko("P2PChannel2-send-mutex",e.clientId),this.recvMutex=new Ko("P2PChannel2-recv-mutex",e.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(r=>{r&&(r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))})},de("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,n){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,n){let r;try{if(n){this.recvConnection&&(x.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),r=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new Pj(e,this.store,Es.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const i=await this.recvConnection.establish(n);return{iceParameters:i.iceParameters,dtlsParameters:i.dtlsParameters,sdp:i.sdp}}{this.state=qn.New,this.sendConnection&&(x.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),r=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new Pj(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const i=await this.sendConnection.establish();return{iceParameters:i.iceParameters,dtlsParameters:i.dtlsParameters,sdp:i.sdp}}}finally{r&&r()}}async p2pConnect(e){if(!this.sendConnection)throw new $e(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=qn.Connected}async addRemoteCandidate(e,n){if(n===Es.RECEIVE_ONLY){if(!this.sendConnection)throw new $e(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new $e(oe.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,n,r){var i=this;return zi(function*(){const c=yield Ln(i.sendMutex.lock("From P2PChannel.publish"));try{if(!i.sendConnection||i.state!==qn.Connected){i.throwIfTrackTypeNotMatch(e);const y=e.filter(T=>i.pendingLocalTracks.indexOf(T)===-1);return void(i.pendingLocalTracks=i.pendingLocalTracks.concat(y))}i.store.pubId=i.store.pubId+1,Yo.markPublishStart(i.store.clientId,i.store.pubId);const u=i.filterTobePublishedTracks(e,n,r);if(u.length===0)return void(yield Ln(i.tryToUnmuteAudio(e)));u.forEach(y=>{let{track:T,type:A}=y;const k=Date.now();i.store.publish(T.getTrackId(),A===at.LocalAudioTrack?"audio":"video",k)}),i.bindLocalTrackEvents(u);const f=yield Ln(i.sendConnection.send(u.map(y=>{let{track:T}=y;return T}),i.store.codec,i.store.audioCodec)),m=(yield Ln(f.next())).value,_=i.createGatewayPublishMessage(u,m);try{yield _}catch(y){throw f.throw(y),(y==null?void 0:y.code)===oe.WS_ABORT&&u.forEach(T=>{let{track:A}=T;i.pendingLocalTracks.indexOf(A)===-1&&i.pendingLocalTracks.push(A)}),i.unbindLocalTrackEvents(u),y}yield Ln(f.next()),u.forEach(y=>{let{type:T}=y;i.statsCollector.addLocalStats(T)}),i.statsUploader.startUploadOutboundStats(),i.assignLocalTracks(u,m),u.forEach(y=>{let{track:T,type:A}=y;const k=Date.now();i.store.publish(T.getTrackId(),A===at.LocalAudioTrack?"audio":"video",void 0,k)}),i.startUploadUplinkState()}finally{c()}})()}async unpublish(e){if(!this.sendConnection||this.state!==qn.Connected)return void(e.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(c=>!gt(e).call(e,c)));const n=this.filterTobeUnpublishedTracks(e);if(n.length===0)return;const r=n.find(c=>c[0]==="videoLowTrack");r&&r[1].track.close();const i=this.createGatewayUnpublishMessage(n);if(await this.sendConnection.stopSending(n.map(c=>{let[,{id:u}]=c;return u})),this.withdrawLocalTracks(n),this.unbindLocalTrackEvents(n.map(c=>{let[u,{track:f}]=c;return{type:u,track:f}})),n.forEach(c=>{let[u]=c;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===qn.Connected)return r&&r[1].track.close(),i;e.forEach(c=>{const u=this.pendingLocalTracks.indexOf(c);u!==-1&&this.pendingLocalTracks.splice(u,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const n=[],r=[];Array.from(this.localTrackMap.entries()).forEach(i=>{let[c,{track:u,ssrcs:f}]=i;const m={stream_type:Vce(u,c),ssrcs:f};u._muted||!u._enabled?n.push(m):r.push(m)}),n.length>0&&n.forEach(i=>{ur(this,Kt.RequestMuteLocal,[i])}),r.length>0&&r.forEach(i=>{ur(this,Kt.RequestUnmuteLocal,[i])})};e(),this.uplinkStateUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return zi(function*(){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(x.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await Bo(this,Kt.RequestRePublish,this.pendingLocalTracks),this.emit(Kt.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,n,r,i){var c;if(!this.recvConnection)throw new $e(oe.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((c=this.remoteUserMap.get(e))!==null&&c!==void 0&&c.has(n))return;const{track:u,mid:f,transceiver:m}=await this.recvConnection.receive(n,[{ssrcId:r}],String(e.uid),i);n===kt.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(u):(e._audioTrack=new Wf(u,e.uid,e._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),m&&e._audioTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=r,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(u):(e._videoTrack=new Hf(u,e.uid,e._uintid,this.store),x.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),m&&e._videoTrack._updateRtpTransceiver(m),this.bindRemoteTrackEvents(e,e._videoTrack));const _=this.remoteUserMap.get(e);_?_.set(n,f):this.remoteUserMap.set(e,new Map([[n,f]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const y=this.pendingRemoteTracks.findIndex(T=>{let{user:A,kind:k}=T;return A.uid===e.uid&&n===k});y!==-1&&(this.pendingRemoteTracks.splice(y,1),this.emit(Kt.MediaReconnectEnd,e.uid))}async mockSubscribe(e,n,r,i){if(!this.recvConnection)throw new $e(oe.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(n,[{ssrcId:r}],String(e.uid),i)}async unsubscribe(e,n,r){const i=this.pendingRemoteTracks.filter(u=>{let{user:f,kind:m}=u;return n!==void 0?f.uid===e.uid&&n===m:f.uid===e.uid});if(i.forEach(u=>{const f=this.pendingRemoteTracks.indexOf(u);this.pendingRemoteTracks.splice(f,1)}),this.recvConnection||r||i.forEach(u=>{let{kind:f}=u;var m;if(f===kt.AUDIO)(m=e._audioTrack)===null||m===void 0||m._destroy(),e._audioTrack=void 0;else if(f===kt.VIDEO){var _;(_=e._videoTrack)===null||_===void 0||_._destroy(),e._videoTrack=void 0}}),!this.recvConnection)return;const c=this.filterTobeUnSubscribedTracks(e,n);c.length!==0&&(await this.recvConnection.stopReceiving(c.map(u=>{let[,{id:f}]=u;return f})),this.withdrawRemoteTracks(c),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),c.forEach(u=>{let[f,{kind:m}]=u;var _,y;if(m===kt.VIDEO&&f._videoSSRC&&((_=this.recvConnection)===null||_===void 0||_.setStatsRemoteVideoIsReady(f._videoSSRC,!1)),m===kt.VIDEO)this.unbindRemoteTrackEvents(f._videoTrack),r||((y=f._videoTrack)===null||y===void 0||y._destroy(),f._videoTrack=void 0);else if(m===kt.AUDIO){var T;this.unbindRemoteTrackEvents(f._audioTrack),!r&&((T=f._audioTrack)===null||T===void 0||T._destroy(),f._audioTrack=void 0)}}),c.forEach(u=>{let[,{kind:f}]=u;ur(this,Kt.RequestP2PMuteRemote,f)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach(n=>{let[,r]=n;[kt.VIDEO,kt.AUDIO].forEach(i=>{r.has(i)?ur(this,Kt.RequestP2PUnmuteRemote,i):ur(this,Kt.RequestP2PMuteRemote,i)})});e(),this.downlinkStatsUploadInterval=window.setInterval(()=>{e()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new $e(oe.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,n){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void x.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!r.get(n))return void x.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."));const i=n===kt.VIDEO?e._videoSSRC:e._audioSSRC;i!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(i,!1)}async unmuteRemote(e,n){return this.unmuteRemoteNoLock(e,n)}async unmuteRemoteNoLock(e,n){if(!this.recvConnection)return;const r=this.remoteUserMap.get(e);if(!r)return void x.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."));r.get(n)||x.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(n,"."))}getAllTracks(e){const n=this.localTrackMap.get(at.LocalAudioTrack);if((n==null?void 0:n.track)instanceof ho){const r=n.track;return Array.from(this.localTrackMap.entries()).filter(i=>{let[c]=i;return c!==at.LocalAudioTrack}).filter(i=>{let[c]=i;return!(e&&c===at.LocalVideoLowTrack)}).map(i=>{let[,{track:c}]=i;return c}).concat(r.trackList)}return Array.from(this.localTrackMap.entries()).filter(r=>{let[i]=r;return!(e&&i===at.LocalVideoLowTrack)}).map(r=>{let[,{track:i}]=r;return i})}reportPublishEvent(e,n,r,i,c){if(e){const f=this.localTrackMap.get(at.LocalAudioTrack),m=i?this.localTrackMap.get(at.LocalVideoLowTrack):this.localTrackMap.get(at.LocalVideoTrack);Bt.publish(this.store.sessionId,{eventElapse:Yo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:f==null?void 0:f.track.getTrackLabel(),videoName:m==null?void 0:m.track.getTrackLabel(),screenshare:(m==null?void 0:m.track._hints.indexOf(hr.SCREEN_TRACK))!==-1,audio:!!f,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}else{var u;r||(r=[]);const f=r.find(_=>_ instanceof Hr),m=i?(u=this.localTrackMap.get(at.LocalVideoTrack))===null||u===void 0?void 0:u.track:r.find(_=>_ instanceof Sr);Bt.publish(this.store.sessionId,{eventElapse:Yo.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:n,audioName:f==null?void 0:f.getTrackLabel(),videoName:m==null?void 0:m.getTrackLabel(),screenshare:(m==null?void 0:m._hints.indexOf(hr.SCREEN_TRACK))!==-1,audio:!!f,video:!!m,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:c})}}reportSubscribeEvent(e,n,r,i){const c=i===kt.VIDEO?r._videoSSRC:r._audioSSRC;c&&Bt.subscribe(this.store.sessionId,{succ:e,ec:n,video:i===kt.VIDEO,audio:i===kt.AUDIO,peerid:r.uid,subscribeRequestid:i===kt.VIDEO?r._videoSSRC:r._audioSSRC,p2pid:this.store.p2pId,eventElapse:Yo.measureFromSubscribeStart(this.store.clientId,c)})}reset(){x.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new Ko("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new Ko("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(at.LocalAudioTrack);if((e==null?void 0:e.track)instanceof ho){if(e.track.trackList.length>0){const n=e.track;e.track.trackList.forEach(r=>{n.removeAudioTrack(r)})}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=qn.Disconnected}getStats(e){var n,r;return e?(r=this.recvConnection)===null||r===void 0?void 0:r.getStats():(n=this.sendConnection)===null||n===void 0?void 0:n.getStats()}getRemoteVideoIsReady(e){var n;return((n=this.recvConnection)===null||n===void 0?void 0:n.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(at.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(at.LocalVideoTrack);if(e)return{width:e.track.videoWidth||0,height:e.track.videoHeight||0}}getEncoderConfig(e){const n=this.localTrackMap.get(e);return n&&n.track instanceof Sr||n&&n.track instanceof Hr?n.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,n){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!n||r.has(n))}async hasRemoteMediaWithLock(e,n){if(!e)return this.remoteUserMap.size>0;const r=this.remoteUserMap.get(e);return!!r&&(!n||r.has(n))}getRemoteMedia(e){var n;const r=Array.from(Ii(n=this.remoteUserMap).call(n)).find(i=>i.uid===e);return r?{audioTrack:r.audioTrack,audioSSRC:r._audioSSRC,videoTrack:r.videoTrack,videoSSRC:r._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map(r=>{let[i]=r;return{uid:i.uid,level:i.audioTrack?100*i.audioTrack._source.getAccurateVolumeLevel():0}});const n=this.localTrackMap.get(at.LocalAudioTrack);return n&&e.push({level:100*n.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=Hm(e).call(e,(r,i)=>r.level-i.level),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(x.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=qn.Reconnecting,de("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n]=e;var r;n._videoTrack&&n._videoTrack._player&&((r=n._videoTrack._player.getVideoElement())===null||r===void 0||r.pause(),n._videoTrack._player.isKeepLastFrame=!0,n._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(e=>{var n;let[r,{track:i}]=e;switch(r){case at.LocalVideoTrack:gt(n=i._hints).call(n,hr.LOW_STREAM)?i.close():this.pendingLocalTracks.push(i);break;case at.LocalAudioTrack:i instanceof ho?this.pendingLocalTracks=this.pendingLocalTracks.concat(i.trackList):this.pendingLocalTracks.push(i);case at.LocalVideoLowTrack:}}),this.emit(Kt.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,r]=e;Array.from(Ii(r).call(r)).forEach(i=>{this.setPendingRemoteMedia(n,i)}),this.emit(Kt.MediaReconnectStart,n.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),x.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,n){for(const r of this.pendingRemoteTracks){const{user:i,kind:c}=r;if((e instanceof Lu?e.uid:e)===i.uid&&n===c)return!0}return!1}setPendingRemoteMedia(e,n){this.hasPendingRemoteMedia(e,n)||this.pendingRemoteTracks.push({user:e,kind:n})}async restartICE(e,n){let r,i;if(e===Es.SEND_ONLY){if(!this.sendConnection)throw new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");r=await this.sendMutex.lock("From P2PChannel.restartICE"),i=this.sendConnection}else{if(!this.recvConnection)throw new $e(oe.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");r=await this.recvMutex.lock("From P2PChannel.restartICE"),i=this.recvConnection}try{if(n){const c=await i.restartICE(n);return i.isInRestartIce=!1,c}{const c=await i.restartICE();if(c){const u=await Bo(this,Kt.RequestP2PRestartICE,{direction:Es.RECEIVE_ONLY,iceParameter:c});await i.restartICE(u),i.isInRestartIce=!1}}}finally{r()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),n=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalAudioTrack),i=e.videoSend.find(P=>{var q;return P.ssrc===(n==null||(q=n.ssrcs)===null||q===void 0?void 0:q[0].ssrcId)}),c=e.audioSend.find(P=>{var q;return P.ssrc===(r==null||(q=r.ssrcs)===null||q===void 0?void 0:q[0].ssrcId)});if(!i||!c)return 1;const u=wi(this,Kt.NeedSignalRTT),f=i?i.rttMs:void 0,m=c?c.rttMs:void 0,_=f&&m?(f+m)/2:f||m,y=(_&&u?(_+u)/2:_||u)||0,T=100*e.sendPacketLossRate*.7/50+.3*y/1500,A=T<.17?1:T<.36?2:T<.59?3:T<.1?4:5,k=n==null?void 0:n.track;if(k&&k._encoderConfig&&k._hints.indexOf(hr.SCREEN_TRACK)===-1){const P=k._encoderConfig.bitrateMax,q=e.bitrate.actualEncoded;if(P&&q){const j=(1e3*P-q)/(1e3*P);return GF[j<.15?0:j<.3?1:j<.45?2:j<.6?3:4][A]}}return A}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let n=0;return Array.from(this.remoteUserMap.entries()).forEach(r=>{let[i]=r;const c=i._audioSSRC,u=i._videoSSRC,f=e.audioRecv.find(q=>q.ssrc===c),m=e.videoRecv.find(q=>q.ssrc===u);if(!f&&!m)return void(n+=1);const _=wi(this,Kt.NeedSignalRTT),y=e.rtt,T=(y&&_?(y+_)/2:y||_)||0,A=f?f.jitterMs:void 0,k=e.recvPacketLossRate;let P=.7*k*100/50+.3*T/1500;A&&(P=.6*k*100/50+.2*T/1500+.2*A/400),n+=P<.1?1:P<.17?2:P<.36?3:P<.59?4:5}),this.remoteUserMap.size>0?Math.round(n/this.remoteUserMap.size):n}async muteLocalTrack(e){return new bt((n,r)=>{this.handleMuteLocalTrack(e,n,r)})}filterTobePublishedTracks(e,n,r){const i=[],c=Bn(),u=this.getAllTracks();e=Nf(e=e.filter(_=>u.indexOf(_)===-1));let f=!1,m=!1;for(const _ of e){if(_ instanceof Sr&&(this.localTrackMap.has(at.LocalVideoTrack)||f?new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(i.push({track:_,type:at.LocalVideoTrack}),f=!0),n)){const y=this.getLowVideoTrack(_,r);i.push({track:y,type:at.LocalVideoLowTrack})}if(_ instanceof Hr){const y=this.localTrackMap.get(at.LocalAudioTrack);if(y){if(!(y.track instanceof ho))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");y.track.addAudioTrack(_),this.bindLocalAudioTrackEvents(_,!0)}else if(m){const T=i.find(A=>{let{type:k}=A;return k===at.LocalAudioTrack});if(!(T.track instanceof ho))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_._bypassWebAudio)throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");T.track.addAudioTrack(_)}else{if(!c.webAudioMediaStreamDest||_ instanceof ho||_._bypassWebAudio)i.push({track:_,type:at.LocalAudioTrack});else{const T=new ho;T.addAudioTrack(_),i.push({track:T,type:at.LocalAudioTrack})}m=!0}}}return i}filterTobeUnpublishedTracks(e){const n=[],r=this.getAllTracks();e=Nf(e=e.filter(i=>r.indexOf(i)!==-1));for(const i of e){if(i instanceof Hr){const c=this.localTrackMap.get(at.LocalAudioTrack);if(!c)continue;c.track instanceof ho?(c.track.removeAudioTrack(i),this.unbindLocalAudioTrackEvents(i),c.track.trackList.length===0&&(n.push([at.LocalAudioTrack,c]),c.track.close())):n.push([at.LocalAudioTrack,c])}if(i instanceof Sr){const c=this.localTrackMap.get(at.LocalVideoTrack);if(!c)continue;n.push([at.LocalVideoTrack,c]);const u=this.localTrackMap.get(at.LocalVideoLowTrack);u&&n.push([at.LocalVideoLowTrack,u])}}return n}bindLocalTrackEvents(e){e.forEach(n=>{let{track:r,type:i}=n;switch(i){case at.LocalVideoTrack:r.addListener(Pt.GET_STATS,this.handleGetLocalVideoStats),r.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Pt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.addListener(Pt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.addListener(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.bindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(e,n){e instanceof ho?e.trackList.forEach(r=>{r.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Pt.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.addListener(Pt.GET_STATS,this.handleGetLocalAudioStats),e.addListener(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),n||e.addListener(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map(n=>{let[r,{track:i}]=n;return{track:i,type:r}})),e.forEach(n=>{let{track:r,type:i}=n;switch(i){case at.LocalVideoTrack:r.off(Pt.GET_STATS,this.handleGetLocalVideoStats),r.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Pt.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),r.off(Pt.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),r.off(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case at.LocalAudioTrack:this.unbindLocalAudioTrackEvents(r);case at.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(e){e instanceof ho?e.trackList.forEach(n=>{n.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),n.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),n.off(Pt.GET_STATS,this.handleGetLocalAudioStats),n.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),n.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(e.off(Pt.GET_STATS,this.handleGetLocalAudioStats),e.off(Pt.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(Pt.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(Pt.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(Pt.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(Pt.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,n){n instanceof Hf&&n.addListener(Pt.GET_STATS,r=>{r(this.handleGetRemoteVideoStats(e))}),n instanceof Wf&&n.addListener(Pt.GET_STATS,r=>{r(this.handleGetRemoteAudioStats(e))})}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(Pt.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(e=>{let[n,r]=e;r.has(kt.AUDIO)&&this.unbindRemoteTrackEvents(n._audioTrack),r.has(kt.VIDEO)&&this.unbindRemoteTrackEvents(n._videoTrack)})}createGatewayPublishMessage(e,n){return e.map((r,i)=>{var c;let u,{track:f,type:m}=r;switch(m){case at.LocalAudioTrack:u=Jn.Audio;break;case at.LocalVideoTrack:u=gt(c=f._hints).call(c,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:u=Jn.Low}return{kind:m===at.LocalAudioTrack?kt.AUDIO:kt.VIDEO,stream_type:u,mid:n[i].id,ssrcs:n[i].localSSRC,isMuted:f.muted||!f.enabled}})}createGatewayUnpublishMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}assignLocalTracks(e,n){e.forEach((r,i)=>{let{track:c,type:u}=r;this.localTrackMap.set(u,{track:c,id:n[i].id,ssrcs:n[i].localSSRC})})}withdrawLocalTracks(e){e.forEach(n=>{let[r]=n;this.localTrackMap.delete(r)})}bindConnectionEvents(e){e.onConnectionStateChange=async n=>{var r;x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(n,")")),this.emit(Kt.PeerConnectionStateChange,n),n!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),n==="connected"&&(e.isInRestartIce=!1),gt(r=this._restartStates).call(r,n)&&!e.isInRestartIce&&(n==="disconnected"&&await Do(800),e.iceConnectionState!=="disconnected"&&e.iceConnectionState!=="failed"||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=n=>{n!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(n,")")),Bt.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:n,tag:Fr.TRACER}).onSuccess(),this.emit(Kt.IceConnectionStateChange,n)},e.onICETransportStateChange=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(n,")"))},e.onDTLSTransportStateChange=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(n,")"))},e.onDTLSTransportError=n=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(n,")"))},e.onFirstAudioDecoded=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(u=>u._audioSSRC===n);var c;i&&(this.store.subscribe(i.uid,"audio",void 0,void 0,void 0,Date.now()),(c=i.audioTrack)===null||c===void 0||c.emit(Vf.FIRST_FRAME_DECODED),Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_AUDIO_DECODE,Nr.FIRST_AUDIO_DECODE,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(c=>c._audioSSRC===n);i&&Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_AUDIO_RECEIVED,Nr.FIRST_AUDIO_RECEIVED,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(n,r,i)=>{this.reportVideoFirstFrameDecoded(n,r,i)},e.onFirstVideoReceived=n=>{var r;const i=Array.from(Ii(r=this.remoteUserMap).call(r)).find(c=>c._videoSSRC===n);i&&Bt.firstRemoteFrame(this.store.sessionId,bo.FIRST_VIDEO_RECEIVED,Nr.FIRST_VIDEO_RECEIVED,{peer:i._uintid,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,n),subscribeRequestid:n,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(n,r)=>{const i=n.candidateType==="relay",c=r.candidateType==="relay";r.candidateType!=="unknown"&&i===c||this.emit(Kt.ConnectionTypeChange,i),x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(ku(r))," -> ").concat(JSON.stringify(ku(n)),")"))},e.onSelectedRemoteCandidateChanged=(n,r)=>{x.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(ku(r))," -> ").concat(JSON.stringify(ku(n)),")"))},e.onFirstVideoDecodedTimeout=n=>{this.reportVideoFirstFrameDecoded(n,void 0,void 0,!0)},e.onLocalCandidate=n=>{this.emit(Kt.LocalCandidate,{candidate:n,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const n=e===Es.SEND_ONLY?this.sendConnection:this.recvConnection;n&&!n.isInRestartIce&&(n.isInRestartIce=!0,x.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(n.name,"] start use restartICE")),e===Es.SEND_ONLY?this.restartICE(e):Bo(this,Kt.RequestP2PRestartICE,{direction:Es.SEND_ONLY}))}filterTobeMutedTracks(e){const n=[];if(this.getAllTracks().indexOf(e)===-1)return n;const r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof Hr&&(r==null?void 0:r.track)instanceof ho)return r.track.isActive||n.push([at.LocalAudioTrack,r]),n;const i=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return e===u});if(i&&(n.push(i),i[0]===at.LocalVideoTrack)){const c=this.localTrackMap.get(at.LocalVideoLowTrack);c&&n.push([at.LocalVideoLowTrack,c])}return n}filterTobeUnmutedTracks(e){const n=[],r=this.localTrackMap.get(at.LocalAudioTrack);if(e instanceof Hr&&(r==null?void 0:r.track)instanceof ho)return r.track.isActive&&n.push([at.LocalAudioTrack,r]),n;const i=Array.from(this.localTrackMap.entries()).find(c=>{let[,{track:u}]=c;return e===u});if(i)if(i[0]===at.LocalVideoTrack){n.push(i);const c=this.localTrackMap.get(at.LocalVideoLowTrack);c&&n.push([at.LocalVideoLowTrack,c])}else n.push(i);return n}createMuteMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}createUnmuteMessage(e){return e.map(n=>{var r;let i,[c,{track:u,ssrcs:f,id:m}]=n;switch(c){case at.LocalAudioTrack:i=Jn.Audio;break;case at.LocalVideoTrack:i=gt(r=u._hints).call(r,hr.SCREEN_TRACK)?Jn.Screen:Jn.High;break;case at.LocalVideoLowTrack:i=Jn.Low}return{stream_type:i,ssrcs:f,mid:m}})}filterTobeUnSubscribedTracks(e,n){const r=[],i=this.remoteUserMap.get(e);if(!i)return r;if(n){const c=i.get(n);if(!c)return r;r.push([e,{kind:n,id:c}])}else Array.from(i.entries()).forEach(c=>{let[u,f]=c;r.push([e,{kind:u,id:f}])});return r}createUnsubscribeMessage(e){const n=[];return e.forEach(r=>{let[i,{kind:c,id:u}]=r;switch(c){case kt.VIDEO:return void(i._videoSSRC&&n.push({stream_type:kt.VIDEO,ssrcId:i._videoSSRC}));case kt.AUDIO:return void(i._audioSSRC&&n.push({stream_type:kt.AUDIO,ssrcId:i._audioSSRC}))}}),n}withdrawRemoteTracks(e){e.forEach(n=>{let[r,{kind:i}]=n;const c=this.remoteUserMap.get(r);c&&(c.delete(i),Array.from(c.entries()).length===0&&this.remoteUserMap.delete(r))})}async updateBitrateLimit(e){const n=this.localTrackMap.get(at.LocalVideoTrack),r=this.localTrackMap.get(at.LocalVideoLowTrack);n&&(await n.track.setBitrateLimit(e.uplink),await new bt((i,c)=>{this.handleUpdateVideoEncoder(n.track,i,c,!0)})),r&&e.low_stream_uplink&&(await r.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0}),await new bt((i,c)=>{this.handleUpdateVideoEncoder(r.track,i,c,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,n=this.recvConnection.peerConnectionState;return e!=="connected"&&n!=="connected"}return!0}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof Hr){const r=this.filterTobeUnmutedTracks(e[n]);if(r.length===0)continue;const i=this.createUnmuteMessage(r);return void await ur(this,Kt.RequestUnmuteLocal,i)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(e=>{let[,{ssrcs:n}]=e;return!!n}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var n;return!((n=this.recvConnection)===null||n===void 0||!n.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,n)=>this.emit(Kt.RequestUpload,e,n),this.statsUploader.requestUploadStats=e=>this.emit(Kt.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Do(Yw(this.dtlsFailedCount,so)),this.emit(Kt.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(at.LocalVideoTrack)||this.pendingLocalTracks.some(e=>e instanceof Sr)}throwIfTrackTypeNotMatch(e){if(e.filter(n=>n instanceof Sr).length>1)throw new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter(n=>n instanceof Hr).length>1&&(e.some(n=>n instanceof Hr&&n._bypassWebAudio)||!Bn().webAudioMediaStreamDest))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const n of e){if(n instanceof Sr&&this.pendingLocalTracks.some(r=>r instanceof Sr))throw new $e(oe.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(n instanceof Hr&&this.pendingLocalTracks.some(r=>r instanceof Hr)&&(!Bn().webAudioMediaStreamDest||n._bypassWebAudio||this.pendingLocalTracks.some(r=>r instanceof Hr&&r._bypassWebAudio)))throw new $e(oe.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,n){const r=!de("DISABLE_DUAL_STREAM_USE_ENCODING")&&Bn().supportDualStreamEncoding,i=hb(hb({},{width:160,height:120,framerate:15,bitrate:50}),n);let c;c=r?e._mediaStreamTrack.clone():rI(e,i);const u=dr(8,"track-low-"),f=new Sr(c,hb(hb({},r&&{scaleResolutionDownBy:FR(i,e)}),{},{frameRate:i.framerate,bitrateMax:i.bitrate,bitrateMin:i.bitrate}),void 0,void 0,u);return f.on(Bd.TRANSCEIVER_UPDATED,m=>{e._updateRtpTransceiver(m,xf.LOW_STREAM)}),f._hints.push(hr.LOW_STREAM),e.addListener(Pt.NEED_CLOSE,()=>{f.close()}),f}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,n,r,i){var c;const u=Array.from(Ii(c=this.remoteUserMap).call(c)).find(f=>f._videoSSRC===e);if(u){i||this.store.subscribe(u.uid,"video",void 0,void 0,void 0,void 0,Date.now());const f=this.store.keyMetrics,m=f.subscribe.find(_=>_.userId===u.uid&&_.type==="video");Bt.firstRemoteVideoDecode(this.store.sessionId,bo.FIRST_VIDEO_DECODE,Nr.FIRST_VIDEO_DECODE,{peer:u._uintid,videowidth:n,videoheight:r,subscribeElapse:Yo.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:f.requestAPEnd||0,apStart:f.requestAPStart||0,joinGwEnd:f.joinGatewayEnd||0,joinGwStart:f.joinGatewayStart||0,pcEnd:f.peerConnectionEnd||0,pcStart:f.peerConnectionStart||0,subscriberEnd:(m==null?void 0:m.subscribeEnd)||0,subscriberStart:(m==null?void 0:m.subscribeStart)||0,videoAddNotify:(m==null?void 0:m.streamAdded)||0,state:i?1:0})}}async remoteMediaSsrcChanged(e,n,r){if(!this.recvConnection)return!1;const i=this.remoteUserMap.get(e);if(!i)return!1;const c=i.get(n);if(!c)return!1;const u=await this.recvConnection.getRemoteSSRC(c);return u!==void 0&&u!==r}isPreSubScribe(e){return!1}async publishDataChannel(e){throw new $e(oe.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new $e(oe.NOT_SUPPORTED)}async subscribeDataChannel(e,n){throw new $e(oe.NOT_SUPPORTED)}async unsubscribeDataChannel(e,n){throw new $e(oe.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,n){throw new $e(oe.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,n){throw new $e(oe.NOT_SUPPORTED)}async preConnect(e){throw new $e(oe.NOT_SUPPORTED)}getEstablishParams(){throw new $e(oe.NOT_SUPPORTED)}async reSubscribe(e){throw new $e(oe.NOT_SUPPORTED)}async updateVideoStreamParameter(e,n){throw new $e(oe.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(e=>{let[n,{track:r}]=e;n===at.LocalVideoLowTrack?r._updateRtpTransceiver(void 0,xf.LOW_STREAM):r._updateRtpTransceiver(void 0)})}},Lt(Pr.prototype,"p2pConnect",[Dj],Object.getOwnPropertyDescriptor(Pr.prototype,"p2pConnect"),Pr.prototype),Lt(Pr.prototype,"unpublish",[Lj],Object.getOwnPropertyDescriptor(Pr.prototype,"unpublish"),Pr.prototype),Lt(Pr.prototype,"unpublishLowStream",[Mj],Object.getOwnPropertyDescriptor(Pr.prototype,"unpublishLowStream"),Pr.prototype),Lt(Pr.prototype,"subscribe",[xj],Object.getOwnPropertyDescriptor(Pr.prototype,"subscribe"),Pr.prototype),Lt(Pr.prototype,"mockSubscribe",[Uj],Object.getOwnPropertyDescriptor(Pr.prototype,"mockSubscribe"),Pr.prototype),Lt(Pr.prototype,"unsubscribe",[Vj],Object.getOwnPropertyDescriptor(Pr.prototype,"unsubscribe"),Pr.prototype),Lt(Pr.prototype,"muteRemote",[Fj],Object.getOwnPropertyDescriptor(Pr.prototype,"muteRemote"),Pr.prototype),Lt(Pr.prototype,"unmuteRemote",[Bj],Object.getOwnPropertyDescriptor(Pr.prototype,"unmuteRemote"),Pr.prototype),Lt(Pr.prototype,"hasRemoteMediaWithLock",[jj],Object.getOwnPropertyDescriptor(Pr.prototype,"hasRemoteMediaWithLock"),Pr.prototype),Lt(Pr.prototype,"disconnectForReconnect",[$j],Object.getOwnPropertyDescriptor(Pr.prototype,"disconnectForReconnect"),Pr.prototype),Lt(Pr.prototype,"remoteMediaSsrcChanged",[Hj],Object.getOwnPropertyDescriptor(Pr.prototype,"remoteMediaSsrcChanged"),Pr.prototype),Pr);function uc(e){return function(n,r,i){const c=n[r];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return i.value=async function(){for(var u=arguments.length,f=new Array(u),m=0;m<u;m++)f[m]=arguments[m];switch(e){case lc.SEND_ONLY:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,f)}finally{_()}}case lc.RECEIVE_ONLY:{const _=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,f)}finally{_()}}default:{const _=await this.sendMutex.lock("From P2PChannel2.".concat(r)),y=await this.recvMutex.lock("From P2PChannel2.".concat(r));try{return await c.apply(this,f)}finally{_(),y()}}}},i}}class ah extends Dr{constructor(n,r){super(),Q(this,"signal",void 0),Q(this,"token",void 0),Q(this,"tokenTimeout",void 0),Q(this,"tokenInterval",void 0),Q(this,"_sequence",0),Q(this,"userMap",new Map),Q(this,"encoder",new TextEncoder),this.signal=n,this.token=r;const i=()=>{this.signal.connectionState===vr.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(i,1e3):this.tokenInterval=window.setTimeout(i,3*de("P2P_TOKEN_INTERVAL"))};i()}async send(n,r,i,c,u){var f,m,_;if(this.userMap.size===0)return;const y=Array.from(Ti(f=this.userMap).call(f))[0].token;typeof r!="string"&&(r=JSON.stringify(r)),c=(m=c)!==null&&m!==void 0?m:dr(6,""),u=(_=u)!==null&&_!==void 0?_:this._sequence++;const T={_id:c,_type:n,_seq:u,_message:r,token:"".concat(this.token,"_").concat(y)};de("SHOW_P2P_LOG")&&x.debug("send message",T,"noNeedResponse : ".concat(i)),this.splitMessage(JSON.stringify(T)).forEach(k=>{this.signal.request(nn.DATA_STREAM,{payload:Ru(this.encoder.encode(k))})});const A=new bt((k,P)=>{const q=window.setTimeout(()=>{this.off("res-@".concat(c,"_ack"),j),this.off("res-@".concat(c),ne),this.off(qf.ABORT,H),x.debug("[external-signal] request timeout, type: ".concat(n,", requestId: ").concat(c)),this.userMap.size===0?P(new $e(oe.INVALID_REMOTE_USER)):P(new $e(oe.TIMEOUT))},de("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),j=()=>{q&&window.clearTimeout(q),this.off(qf.ABORT,H),i&&k()},H=()=>{q&&window.clearTimeout(q),this.off("res-@".concat(c,"_ack"),j),this.off("res-@".concat(c),ne),P(new $e(oe.EXTERNAL_SIGNAL_ABORT,"type: ".concat(n,", requestId: ").concat(c)))};this.once(qf.ABORT,H),this.once("res-@".concat(c,"_ack"),j);const ne=(ve,Oe)=>{re=!0,q&&window.clearTimeout(q),this.off("res-@".concat(c,"_ack"),j),this.off(qf.ABORT,H),ve==="success"?k(Oe):P(new $e(oe.P2P_MESSAGE_FAILED,"request ".concat(n," failed, requestId: ").concat(c)))};let re=!1;i||(this.once("res-@".concat(c),ne),Do(de("SIGNAL_REQUEST_TIMEOUT")).then(()=>{re||x.warning("external_signal request timeout, type: ".concat(n,", requestId: ").concat(c,", ").concat(T))}))});try{return await A}catch(k){if(k.code===oe.TIMEOUT)return await this.send(n,r,i,c,u);throw k}}onMessage(n){var r;const{_uid:i}=n;let c,u=this.userMap.get(i);if(u)c=u.splitMessageMap;else{if(this.userMap.size>0||!("_type"in n)||n._type!==qr.CHECK)return;const{token:y}=n;c=new Map,u={uid:i,isStart:!0,token:y,splitMessageMap:c,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(i,u),this.signal.emit(An.ON_USER_ONLINE,{uid:i}),this.handleUserOnline()}if("id"in n&&"total"in n){var f;const{id:y,total:T}=n,A=(f=c.get(y))!==null&&f!==void 0?f:[];if(A.push(n),c.has(y)||c.set(y,A),A.length!==T)return;{const k=Hm(A).call(A,(P,q)=>P.index-q.index).map(P=>P.payload).join("");c.delete(y),(n=JSON.parse(k))._uid=i}}const{_type:m,token:_}=n;if(gt(r=[qr.ACK,qr.CHECK]).call(r,m))return m===qr.CHECK&&this.handleCheckToken(u,_),void this.receiveMessage(n);_==="".concat(u.token,"_").concat(this.token)?this.handleReceivedMessage(n):x.debug('Receive unexpected message", '.concat(_,", cur_token: ").concat(u.token,"_").concat(this.token),n)}check(){const n={_id:dr(6,""),token:this.token,_type:qr.CHECK};de("SHOW_P2P_LOG")&&x.debug("send message",n),this.signal.request(nn.DATA_STREAM,{payload:Ru(this.encoder.encode(JSON.stringify(n)))})}ack(n){const r={_id:n,_type:qr.ACK,token:this.token};de("SHOW_P2P_LOG")&&x.debug("send message",r),this.signal.request(nn.DATA_STREAM,{payload:Ru(this.encoder.encode(JSON.stringify(r)))})}response(n,r,i){this.send(qr.RESPONSE,JSON.stringify({success:!i,message:r}),!0,n)}handleReceivedMessage(n){const r=()=>{this.userMap.forEach(y=>{const{receivedMessagesMap:T,nextExpectedSequenceNumber:A}=y;for(;T.has(A);){const k=T.get(A);T.delete(A),this.receiveMessage(k),y.nextExpectedSequenceNumber++}})};if(!n)return void r();const{_uid:i,_seq:c}=n,u=this.userMap.get(i),{receivedMessagesMap:f,isStart:m,nextExpectedSequenceNumber:_}=u;if(c<_)return this.ack(n._id),void x.debug("[external-signal] receive old message, seq: ".concat(c,", ").concat(n._message));f.set(c,n),m&&c===_&&(this.receiveMessage(n),f.delete(_),u.nextExpectedSequenceNumber++,r())}receiveMessage(n){const{_id:r,_type:i,_message:c,_uid:u}=n;if(de("SHOW_P2P_LOG")&&x.debug("receive message",n),r){let f;switch(n._type!==qr.ACK&&(c&&(f=JSON.parse(c)),this.ack(n._id)),n._type){case qr.CANDIDATE:case qr.CONTROL:this.signal.emit(i,f,u);break;case qr.PUBLISH:case qr.UNPUBLISH:case qr.RESTART_ICE:case qr.CALL:f.uid=u,Bo(this.signal,i,f).then(m=>{this.response(n._id,m)}).catch(()=>{this.response(n._id,void 0,!0)});break;case qr.ACK:this.getListeners("res-@".concat(r,"_ack")).length>0&&this.emit("res-@".concat(r,"_ack"));break;case qr.RESPONSE:{const{success:m,message:_}=f;this.emit("res-@".concat(r),m?"success":"failed",_);break}}}}splitMessage(n){if(n.length<ah.MAX_MESSAGE_SIZE)return[n];const r=[],{remoteToken:i}=JSON.parse(n),c=dr(6,"");let u=0,f=800;const m=Math.ceil(n.length/f);for(;n.length>0;){u++;const _={id:c,index:u,total:m,payload:n.slice(0,f),token:"".concat(this.token,"_").concat(i)};JSON.stringify(_).length>ah.MAX_MESSAGE_SIZE?f-=50:(r.push(_),n=n.slice(f))}return r.map(_=>JSON.stringify(_))}handleCheckToken(n,r){return n.token!==r?(x.debug("token changed, from ".concat(n.token," to ").concat(r)),this.reset(n.uid,r),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{x.debug("token timeout, ".concat(r)),this.reset(n.uid)},de("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const n=await Bo(this.signal,qr.CALL,void 0),r=await this.send(qr.CALL,n);this.signal.emit(cn.P2P_CONNECTION,r,!0)}async reset(n,r){const i=this.userMap.get(n);i&&(this.emit(qf.ABORT),this.signal.emit(An.ON_USER_OFFLINE,{uid:i.uid,reason:hce.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),r||(x.debug("change local token from ".concat(r," to ").concat(r)),this.token=dr(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(qf.ABORT)}}Q(ah,"MAX_SIZE",1),Q(ah,"MAX_MESSAGE_SIZE",1024);class Yue extends Dr{get connectionState(){return this._connectionState}set connectionState(n){n!==this._connectionState&&(this._connectionState=n,n===vr.CONNECTED?this.emit(cn.WS_CONNECTED):n===vr.RECONNECTING?this.emit(cn.WS_RECONNECTING,this._websocketReconnectReason):n===vr.CLOSED&&this.emit(cn.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(n,r){super(),Q(this,"_disconnectedReason",void 0),Q(this,"_websocketReconnectReason",void 0),Q(this,"_connectionState",vr.CLOSED),Q(this,"reconnectToken",void 0),Q(this,"p2pToken",void 0),Q(this,"websocket",void 0),Q(this,"openConnectionTime",void 0),Q(this,"clientId",void 0),Q(this,"lastMsgTime",Date.now()),Q(this,"uploadCache",[]),Q(this,"uploadCacheInterval",void 0),Q(this,"rttRolling",new yU(5)),Q(this,"pingpongTimer",void 0),Q(this,"pingpongTimeoutCount",0),Q(this,"joinResponse",void 0),Q(this,"multiIpOption",void 0),Q(this,"initError",void 0),Q(this,"spec",void 0),Q(this,"store",void 0),Q(this,"_external_signal",void 0),Q(this,"onWebsocketMessage",i=>{if(i.data instanceof ArrayBuffer)return void this.emit(cn.ON_BINARY_DATA,i.data);const c=JSON.parse(i.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(c,"_id")){const u="res-@".concat(c._id);this.emit(u,c._result,c._message)}else if(Object.prototype.hasOwnProperty.call(c,"_type")){switch(c._type){case An.ON_DATA_STREAM:return void this.handleDataStream(c._message);case An.MUTE_AUDIO:case An.MUTE_VIDEO:case An.ON_P2P_LOST:case An.ON_USER_ONLINE:return;case An.ON_USER_OFFLINE:const{uid:u}=c._message;return x.debug("[".concat(this.clientId,"] user-offline uid: ").concat(u)),void this._external_signal.reset(u)}if(this.emit(c._type,c._message),c._type===An.ON_NOTIFICATION&&this.handleNotification(c._message),c._type===An.ON_USER_BANNED)switch(c._message.error_code){case 14:this.close(Yn.UID_BANNED);break;case 15:this.close(Yn.IP_BANNED);break;case 16:this.close(Yn.CHANNEL_BANNED)}if(c._type===An.ON_USER_LICENSE_BANNED)switch(c._message.error_code){case Yt.ERR_LICENSE_MISSING:this.close(Yn.LICENSE_MISSING);break;case Yt.ERR_LICENSE_EXPIRED:this.close(Yn.LICENSE_EXPIRED);break;case Yt.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Yn.LICENSE_MINUTES_EXCEEDED);break;case Yt.ERR_LICENSE_PERIOD_INVALID:this.close(Yn.LICENSE_PERIOD_INVALID);break;case Yt.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Yn.LICENSE_MULTIPLE_SDK_SERVICE);break;case Yt.ERR_LICENSE_ILLEGAL:this.close(Yn.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=n.clientId,this.spec=n,this.store=r,this.websocket=new UR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,de("JOIN_GATEWAY_USE_DUAL_DOMAIN"),de("JOIN_GATEWAY_USE_443PORT_ONLY"),r),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===vr.CONNECTED&&this.reconnect("retry",Fo.OFFLINE)}),this.p2pToken=dr(6,""),this._external_signal=new ah(this,this.p2pToken)}async request(n,r,i,c){const u=dr(6,""),f={_id:u,_type:n,_message:r},m=this.websocket.connectionID,_=()=>new bt((q,j)=>{if(this.connectionState===vr.CONNECTED)return q();const H=()=>{this.off(cn.WS_CLOSED,ne),q()},ne=()=>{this.off(cn.WS_CONNECTED,H),j(new $e(oe.WS_ABORT))};this.once(cn.WS_CONNECTED,H),this.once(cn.WS_CLOSED,ne)});if(this.connectionState!==vr.CONNECTING&&this.connectionState!==vr.RECONNECTING||n===nn.JOIN||n===nn.REJOIN||await _(),this.websocket.sendMessage(f,!0),c)return;const y=new bt((q,j)=>{let H=!1;const ne=(ve,Oe)=>{H=!0,q({isSuccess:ve==="success",message:Oe||{}}),this.off(cn.WS_CLOSED,re),this.off(cn.WS_RECONNECTING,re),this.emit(cn.REQUEST_SUCCESS,n,r)};this.once("res-@".concat(u),ne);const re=()=>{j(new $e(oe.WS_ABORT,"type: ".concat(n))),this.off(cn.WS_CLOSED,re),this.off(cn.WS_RECONNECTING,re),this.off("res-@".concat(u),ne)};this.once(cn.WS_CLOSED,re),this.once(cn.WS_RECONNECTING,re),Do(de("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==m||H||(x.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(n)),this.emit(cn.REQUEST_TIMEOUT,n,r))})});let T=null;try{T=await y}catch(q){if(this.connectionState===vr.CLOSED||n===nn.LEAVE)throw new $e(oe.WS_ABORT);return!this.spec.forceWaitGatewayResponse||i?q.throw():n===nn.JOIN||n===nn.REJOIN?null:(await _(),await this.request(n,r))}if(T.isSuccess)return T.message;const A=Number(T.message.error_code||T.message.code),k=mv(A),P=new $e(oe.UNEXPECTED_RESPONSE,"".concat(k.desc,": ").concat(T.message.error_str),{code:A,data:T.message,desc:k.desc});return k.action==="success"?T.message:(x.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(n,", error_code: ").concat(A,", message: ").concat(k.desc,", action: ").concat(k.action)),A===Yt.ERR_TOO_MANY_BROADCASTERS?((n===nn.JOIN||n===nn.REJOIN)&&(this.initError=P,this.close()),P.throw()):k.action==="failed"?P.throw():k.action==="quit"?(this.initError=P,this.close(),P.throw()):(A===Yt.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=T.message.option,x.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Fo.MULTI_IP)):this.reconnect(k.action,Fo.SERVER_ERROR),n===nn.JOIN||n===nn.REJOIN?null:await this.request(n,r)))}waitMessage(n,r){return new bt(i=>{const c=u=>{(!r||r(u))&&(this.off(n,c),i(u))};this.on(n,c)})}uploadWRTCStats(n){if(!this.store.sessionId)return void x.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const r={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:n};this.upload(fv.WRTC_STATS,r)}upload(n,r){const i={_type:n,_message:r};try{this.websocket.sendMessage(i)}catch{const u=de("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>u&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==vr.CONNECTED)return;const f=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(f._type,f._message)},de("UPLOAD_CACHE_INTERVAL")||2e3))}}send(n,r){const i={_type:n,_message:r};this.websocket.sendMessage(i)}async sendExtensionMessage(n,r,i){return await this._external_signal.send(n,r,i)}init(n){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new bt((r,i)=>{this.once(cn.WS_CONNECTED,()=>r(this.joinResponse)),this.once(cn.WS_CLOSED,()=>i(this.initError||new $e(oe.WS_ABORT))),this.connectionState=vr.CONNECTING,this.websocket.init(n).catch(i)})}close(n){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=n||Yn.LEAVE,this.connectionState=vr.CLOSED,x.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=dr(6,""),this._external_signal.clear(),this._external_signal=new ah(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(cn.ABORT_P2P_EXECUTION);const n=await Bo(this,cn.REQUEST_JOIN_INFO),r=await this.request(nn.JOIN,n);if(!r)return this.emit(cn.REPORT_JOIN_GATEWAY,oe.TIMEOUT,this.url||""),!1;this.joinResponse=r,this.emit(cn.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=vr.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(n,r){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(n,r)}handleDataStream(n){try{var r;const i=Ud(n.payload),c=new TextDecoder().decode(i),u=JSON.parse(c);"total"in u&&"id"in u||gt(r=Object.values(qr)).call(r,u._type)?(u._uid=n.uid,this._external_signal.onMessage(u)):this.emit(An.ON_DATA_STREAM,n)}catch{this.emit(An.ON_DATA_STREAM,n)}}handleNotification(n){x.debug("[".concat(this.clientId,"] receive notification: "),n);const r=mv(n.code);if(r.action!=="success"){if(r.action!=="failed")return r.action==="quit"?(r.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Yn.UID_BANNED),void this.close()):void this.reconnect(r.action,Fo.SERVER_ERROR);x.error("[".concat(this.clientId,"] ignore error: "),r.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const n=de("PING_PONG_TIME_OUT"),r=Date.now();this.pingpongTimeoutCount>=n&&(x.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(r-this.lastMsgTime,"ms")),r-this.lastMsgTime>de("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",Fo.TIMEOUT):this.request(nn.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const i=Date.now()-r;this.rttRolling.add(i),de("REPORT_STATS")&&this.send(nn.PING_BACK,{pingpongElapse:i})}).catch(i=>{})}handleWebsocketEvents(){this.websocket.on(pn.RECONNECT_CREATE_CONNECTION,n=>{this.emit(cn.WS_RECONNECT_CREATE_CONNECTION,n)}),this.websocket.on(pn.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(pn.CLOSED,()=>{this.connectionState=vr.CLOSED}),this.websocket.on(pn.FAILED,()=>{this._disconnectedReason=Yn.NETWORK_ERROR,this.connectionState=vr.CLOSED}),this.websocket.on(pn.RECONNECTING,n=>{this._websocketReconnectReason=n,this.joinResponse=void 0,this.connectionState===vr.CONNECTED?this.connectionState=vr.RECONNECTING:this.connectionState=vr.CONNECTING}),this.websocket.on(pn.WILL_RECONNECT,(n,r,i)=>{n!=="retry"?(x.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(n)),this.reconnectToken=void 0):x.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),i(n)}),this.websocket.on(pn.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(n=>{if(this.emit(cn.REPORT_JOIN_GATEWAY,n,this.url||""),n instanceof $e&&n.code===oe.UNEXPECTED_RESPONSE&&n.data.code===Yt.ERR_NO_AUTHORIZED)return x.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",Fo.SERVER_ERROR);x.error("[".concat(this.clientId,"] join gateway request failed"),n.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",Fo.SERVER_ERROR):(this.initError=n,this.close())})}),this.websocket.on(pn.REQUEST_NEW_URLS,(n,r)=>{Bo(this,cn.REQUEST_RECOVER,this.multiIpOption).then(n).catch(r)}),this.websocket.on(pn.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(An.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const que={name:"P2PChannel",create:function(e){let{store:n,statsCollector:r}=e;return new zue(n,r)},createSubmodule:function(e){let{store:n,spec:r}=e;return new Yue(r,n)}};function Kj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function Gj(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Kj(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kj(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}class Xue{constructor(n){Q(this,"sessionDesc",void 0),Q(this,"localCapabilities",void 0),Q(this,"rtpCapabilities",void 0),Q(this,"candidates",void 0),Q(this,"_originCandidates",void 0),Q(this,"iceParameters",void 0),Q(this,"dtlsParameters",void 0),Q(this,"setup",void 0),Q(this,"currentMidIndex",void 0),Q(this,"cname",void 0),n=Br(n);const{iceParameters:r,dtlsParameters:i,candidates:c,rtpCapabilities:u,setup:f,localCapabilities:m,sdkCodec:_,cname:y}=n,T=$s(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=u,this.candidates=c,this._originCandidates=Br(c),this.iceParameters=r,this.dtlsParameters=i,this.setup=f,this.localCapabilities=m,this.cname=y;for(let A=0;A<T.mediaDescriptions.length;A++){const k=T.mediaDescriptions[A];if(k.attributes.iceUfrag=r.iceUfrag,k.attributes.icePwd=r.icePwd,k.attributes.fingerprints=i.fingerprints,k.attributes.candidates=c,k.attributes.setup=f,k.media.mediaType==="video"){k.media.fmts=u.videoCodecs.map(q=>q.payloadType.toString(10));let P=u.videoCodecs.filter(q=>{var j,H;return(j=q.rtpMap)===null||j===void 0?void 0:gt(H=j.encodingName.toLowerCase()).call(H,_)});P.length===0&&(P=u.videoCodecs),k.attributes.payloads=P,k.attributes.extmaps=u.videoExtensions}k.media.mediaType==="audio"&&(k.media.fmts=u.audioCodecs.map(P=>P.payloadType.toString(10)),k.attributes.payloads=u.audioCodecs,k.attributes.extmaps=u.audioExtensions),T.mediaDescriptions[A]=this.mungMediaDesc(k)}this.sessionDesc=T,this.currentMidIndex=T.mediaDescriptions.length-1}toString(){return Iu(this.sessionDesc)}send(n,r,i){const{ssrcs:c,ssrcGroups:u}=zd(r,this.cname),f=this.sessionDesc.mediaDescriptions.find(y=>n===kt.VIDEO?y.media.mediaType==="video":y.media.mediaType==="audio"),m=c[0].attributes.label,_=c[0].attributes.mslabel;return f.attributes.ssrcs=f.attributes.ssrcs.concat(c),f.attributes.ssrcGroups=f.attributes.ssrcGroups.concat(u),{id:m,mslabel:_}}batchSend(n){return n.map(r=>{let{kind:i,ssrcMsg:c}=r;return this.send(i,c,void 0)})}stopSending(n){this.sessionDesc.mediaDescriptions.forEach(r=>{const i=[],c=[],u=[];r.attributes.ssrcs.forEach(f=>{gt(n).call(n,f.attributes.label||"")?u.push(f):i.push(f)}),r.attributes.ssrcGroups.forEach(f=>{var m;gt(m=u.map(_=>_.ssrcId)).call(m,f.ssrcIds[0])||c.push(f)}),r.attributes.ssrcs=i,r.attributes.ssrcGroups=c})}mute(n){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.mute."));r.attributes.direction="inactive"}unmute(n){const r=this.sessionDesc.mediaDescriptions.find(i=>i.attributes.mid===n);if(!r)throw new Error("mediaDescription not found with ".concat(n," in remote SDP when calling RemoteSDP.unmute."));r.attributes.direction="sendonly"}receive(n,r,i){n.forEach((c,u)=>{const f=c._mediaStreamTrack,m=this.sessionDesc.mediaDescriptions.findIndex(y=>y.attributes.mid===f.kind),_=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[m],c);this.sessionDesc.mediaDescriptions[m]=_})}stopReceiving(n){}updateCandidates(n){const r=this._originCandidates.filter(c=>c.transport==="udp"),i=[];if(r.forEach(c=>{i.push(Gj(Gj({},c),{},{foundation:"tcpcandidate",priority:Number(c.priority)-1+"",transport:"tcp",port:Number(c.port)+90+""}))}),r.length!==0){switch(n){case zo.TCP_RELAY:this.candidates=i;break;case zo.UDP_TCP_RELAY:case zo.RELAY:this.candidates=[...r,...i];break;default:this.candidates=r}for(const c of this.sessionDesc.mediaDescriptions)c.attributes.candidates=this.candidates}}restartICE(n){n=Br(n),this.iceParameters=n,this.sessionDesc.mediaDescriptions.forEach(r=>{r.attributes.iceUfrag=n.iceUfrag,r.attributes.icePwd=n.icePwd})}predictReceivingMids(n){const r=[];for(let i=0;i<n;i++)r.push((this.currentMidIndex+i+1).toString(10));return r}mungRecvMediaDsec(n,r){const i=Br(n);return Zf(i,r),jR(i,r),i}updateRecvMedia(n,r){const i=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===n);if(i!==-1){const c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],r);this.sessionDesc.mediaDescriptions[i]=c}}bumpMid(n){this.currentMidIndex+=n}updateTrackLabel(n,r,i){const c=this.sessionDesc.mediaDescriptions.find(f=>n===kt.VIDEO?f.attributes.mid==="video":f.attributes.mid==="audio");if(c){const f=c.attributes.ssrcs.find(m=>m.attributes.label===r);var u;f&&(f.attributes.label=i,(u=f.attributes.msid)===null||u===void 0||u.replace(r,i))}}mungMediaDesc(n){const r=Br(n);return BR(r),function(i){const c=i.attributes.extmaps.find(u=>Ay(u.extensionName));c&&i.attributes.extmaps.splice(i.attributes.extmaps.indexOf(c),1),i.attributes.payloads.forEach(u=>{const f=u.rtcpFeedbacks.findIndex(m=>m.type==="transport-cc");f!==-1&&u.rtcpFeedbacks.splice(f,1)})}(r),r}getSSRC(n){for(const r of this.sessionDesc.mediaDescriptions)for(const i of r.attributes.ssrcs)if(i.attributes.label===n)return[i]}}var cr;function zj(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,i)}return r}function fb(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?zj(Object(r),!0).forEach(function(i){Q(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zj(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}let Jue=(cr=class ig extends nB{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(n=>n.rtpMap&&n.rtpMap.encodingName.toLowerCase()||"").filter(n=>{var r;return gt(r=Object.keys(ry)).call(r,n)}))]}constructor(n,r){super(n,r),Q(this,"store",void 0),Q(this,"peerConnection",void 0),Q(this,"remoteSDP",void 0),Q(this,"initialOffer",void 0),Q(this,"statsFilter",void 0),Q(this,"useRTX",!1),Q(this,"localCapabilities",void 0),Q(this,"localCandidateCount",0),Q(this,"allCandidatesReceived",!1),Q(this,"establishPromise",void 0),Q(this,"mutex",void 0),this.store=r,this.mutex=new Ko("P2PConnection-mutex",r.clientId),this.peerConnection=new RTCPeerConnection(ig.resolvePCConfiguration(n),{optional:[{googDscp:!0}]}),this.statsFilter=eR(this.peerConnection,de("STATS_UPDATE_INTERVAL"),void 0,Ur()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const n=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!n.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const r=Pu(n.sdp),i=_v(n.sdp,{filterRTX:!this.useRTX,filterVideoFec:de("FILTER_VIDEO_FEC"),filterAudioFec:de("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=i,this.initialOffer=n,fb(fb({},r),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:i},offerSDP:n.sdp})}catch(n){throw new $e(oe.GET_LOCAL_CONNECTION_PARAMS_FAILED,n.toString())}}async updateRemoteConnect(){}async connect(n){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new Xue(fb(fb({},n),{},{rtpCapabilities:n.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(r.toString()))}}async updateRemoteRTPCapabilities(n,r){throw new $e(oe.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(n){}send(n,r){var i=this;return zi(function*(){const c=yield Ln(i.mutex.lock());try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const u=n.map(k=>i.peerConnection.addTrack(k._mediaStreamTrack)),f=yield Ln(i.peerConnection.createOffer()),m=$s(f.sdp),_=n.map(k=>{const P=k._mediaStreamTrack,q=m.mediaDescriptions.find(j=>j.attributes.mid===P.kind);if(!q)throw new Error("Cannot extract ssrc from mediaDescription.");return function(j,H,ne){const re=j.attributes.ssrcs.filter(Oe=>Oe.attributes.label===H),ve=j.attributes.ssrcGroups;if(re.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(ve&&re.length>1){const Oe=ve.find(ke=>ke.ssrcIds.indexOf(re[0].ssrcId)!==-1);return Oe?[{ssrcId:Oe.ssrcIds[0],rtx:ne?Oe.ssrcIds[1]:void 0}]:[{ssrcId:re[0].ssrcId}]}return[{ssrcId:re[0].ssrcId}]}(q,P.id,i.useRTX)});let y;try{y=yield _}catch(k){throw u.forEach(P=>{Vo()&&P.replaceTrack(null),i.peerConnection.removeTrack(P)}),k}const T=i.mungSendOfferSDP(f.sdp,n);i.remoteSDP.receive(n,r,y);const A=i.remoteSDP.toString();return yield Ln(i.peerConnection.setLocalDescription({type:"offer",sdp:T})),yield Ln(i.applySendEncodings(u,n)),yield Ln(i.peerConnection.setRemoteDescription({type:"answer",sdp:A})),n.map((k,P)=>{const q=k._mediaStreamTrack.id;return{localSSRC:_[P],id:q}})}catch(u){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(u.toString()))}finally{c()}})()}async stopSending(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const r=this.peerConnection.getSenders().filter(u=>{var f;return n.indexOf(((f=u.track)===null||f===void 0?void 0:f.id)||"")!==-1});if(r.length!==n.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");r.map(u=>{Vo()&&u.replaceTrack(null),this.peerConnection.removeTrack(u)});const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(n);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(r.toString()))}}async receive(n,r,i,c){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(n," before remoteSDP created."));const{id:u,mslabel:f}=this.remoteSDP.send(n,r,c),m=new bt((T,A)=>{const k=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(u)))},1e4),P=q=>{const j=Mn();if((j.name==="Safari"&&Number(j.version)===11||vs())&&q.track.id!==u&&q.streams[0].id===f){var H;const ne=q.streams[0].getTracks()[0];return(H=this.remoteSDP)===null||H===void 0||H.updateTrackLabel(n,u,q.track.id),this.peerConnection.removeEventListener("track",P),clearTimeout(k),void T(ne)}if(q.track.id===u)return this.peerConnection.removeEventListener("track",P),clearTimeout(k),void T(q.track)};this.peerConnection.addEventListener("track",P)}),_=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_});const y=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(y),{track:await m,id:u}}catch(u){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(u.toString()))}}async stopReceiving(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r});const i=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(i)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(r.toString()))}}async muteRemote(n){}async unmuteRemote(n){}async muteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(i=>{var c;return n.indexOf(((c=i.track)===null||c===void 0?void 0:c.id)||"")!==-1});if(r.length!==n.length)throw new Error("sender' length doesn't match mids' length.");r.map(i=>{if(Vo()&&i.track)i.track.enabled=!1;else{const c=i.getParameters();c.encodings.forEach(u=>u.active=!1),i.setParameters(c)}})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(r.toString()))}}async unmuteLocal(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const r=this.peerConnection.getSenders().filter(u=>{var f;return n.indexOf(((f=u.track)===null||f===void 0?void 0:f.id)||"")!==-1});if(r.length!==n.length)throw new Error("Senders' length doesn't match mids' length.");r.map(async u=>{if(Vo()&&u.track)u.track.enabled=!0;else{const f=u.getParameters();f.encodings.forEach(m=>m.active=!0),await u.setParameters(f)}});const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i);const c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:c})}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(r.toString()))}}restartICE(n){var r=this;return zi(function*(){const i=yield Ln(r.mutex.lock("From P2PConnection.restartICE"));try{if(!r.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const c=Bn().supportPCSetConfiguration;if(n===zo.RELAY&&!c)return;if(c){const y=r.peerConnection.getConfiguration(),T=n===zo.RELAY?"relay":"all";y.iceTransportPolicy!==T&&(x.debug("[".concat(r.store.clientId,"] restartICE change iceTransportPolicy from [").concat(y.iceTransportPolicy,"] to [").concat(T,"]")),y.iceTransportPolicy=T,r.peerConnection.setConfiguration(y))}n!==zo.RELAY&&r.remoteSDP.updateCandidates(n);const u=yield Ln(r.peerConnection.createOffer({iceRestart:!0}));if(!u.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const f=Pu(u.sdp),{remoteIceParameters:m}=yield f.iceParameters;r.remoteSDP.restartICE(m);const _=r.remoteSDP.toString();yield Ln(r.peerConnection.setLocalDescription(u)),yield Ln(r.peerConnection.setRemoteDescription({type:"answer",sdp:_}))}catch(c){x.warning("[".concat(r.store.clientId,"] restart ICE failed, abort operation"),c)}finally{i()}})()}close(){var n;this.peerConnection.close(),(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(n){return this.statsFilter.getVideoIsReady(n)}async updateEncoderConfig(n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),c=this.mungSendOfferSDP(i.sdp,[r]);this.remoteSDP.updateRecvMedia(r._mediaStreamTrack.kind,r);const u=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:c}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(i){throw new $e(oe.EXCHANGE_SDP_FAILED,i.toString())}}async updateSendParameters(n,r){const i=this.peerConnection.getSenders().filter(c=>{var u;return((u=c.track)===null||u===void 0?void 0:u.id)===n});i.length===1&&await this.applySendEncodings(i,[r])}setStatsRemoteVideoIsReady(n,r){this.statsFilter.setVideoIsReady2(n,r)}async replaceTrack(n,r){const i=this.peerConnection.getSenders().find(c=>{var u;return((u=c.track)===null||u===void 0?void 0:u.id)===r});i&&await i.replaceTrack(n._mediaStreamTrack)}createDataChannels(n,r){throw new $e(oe.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(n){throw new $e(oe.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var n;(n=this.onICEConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=n=>{n.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,x.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},de("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(n){const r={iceServers:[],sdpSemantics:"plan-b"};return n.iceServers?r.iceServers=n.iceServers:n.turnServer&&n.turnServer.mode!=="off"&&(sv(n.turnServer.servers)?r.iceServers=n.turnServer.servers:(r.iceServers&&r.iceServers.push(...ig.turnServerConfigToIceServers(n.turnServer.servers)),de("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&n.turnServer.serversFromGateway&&r.iceServers.push(...ig.turnServerConfigToIceServers(n.turnServer.serversFromGateway)),n.turnServer.servers.concat(n.turnServer.serversFromGateway||[]).forEach(i=>{i.forceturn&&(r.iceTransportPolicy="relay")}))),r}static turnServerConfigToIceServers(n){const r=[];return n.forEach(i=>{i.security?i.tcpport&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turns:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}):(i.udpport&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.udpport,"?transport=udp")}),i.tcpport&&r.push({username:i.username,credential:i.password,credentialType:"password",urls:"turn:".concat(i.turnServerURL,":").concat(i.tcpport,"?transport=tcp")}))}),r}async updateRtpSenderEncodings(n,r){var i;if(r||(r=this.peerConnection.getSenders().find(y=>{var T;return((T=y.track)===null||T===void 0?void 0:T.id)===n._mediaStreamTrack.id})),!r)return x.warn("[".concat(n.getTrackId(),"] no rtpSender found}"));if(!Bn().supportSetRtpSenderParameters)return x.warn("Browser not support set rtp-sender parameters");const c={},u={};if(n instanceof Sr)switch(n._optimizationMode){case"motion":c.degradationPreference="maintain-framerate";break;case"detail":c.degradationPreference="maintain-resolution";break;default:c.degradationPreference="balanced"}if(de("DSCP_TYPE")&&Il()){var f;const y=de("DSCP_TYPE");gt(f=["very-low","low","medium","high"]).call(f,y)&&(u.networkPriority=y)}const m=r.getParameters(),_=(i=m.encodings)===null||i===void 0?void 0:i[0];_&&Object.assign(_,u),Object.assign(m,c),x.debug("[".concat(n.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(m.encodings))),await r.setParameters(m)}async applySendEncodings(n,r){try{if(!Bn().supportSetRtpSenderParameters||n.length!==r.length)return;for(let i=0;i<n.length;i++){const c=n[i],u=r[i];c&&u&&await this.updateRtpSenderEncodings(u,c)}}catch{x.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(n,r){const i=$s(n);return r.forEach((c,u)=>{const f=c._mediaStreamTrack,m=i.mediaDescriptions.find(_=>_.attributes.mid===f.kind);m&&Zf(m,c)}),Iu(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=n=>{var r;(r=this.onFirstAudioReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoReceived=n=>{var r;(r=this.onFirstVideoReceived)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstAudioDecoded=n=>{var r;(r=this.onFirstAudioDecoded)===null||r===void 0||r.call(this,n)},this.statsFilter.onFirstVideoDecoded=(n,r,i)=>{var c;(c=this.onFirstVideoDecoded)===null||c===void 0||c.call(this,n,r,i)},this.statsFilter.onSelectedLocalCandidateChanged=(n,r)=>{var i;(i=this.onSelectedLocalCandidateChanged)===null||i===void 0||i.call(this,n,r)},this.statsFilter.onSelectedRemoteCandidateChanged=(n,r)=>{var i;(i=this.onSelectedRemoteCandidateChanged)===null||i===void 0||i.call(this,n,r)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const r=this.remoteSDP.batchSend(n).map((u,f)=>{let{id:m,mslabel:_}=u;const{kind:y}=n[f];return new bt((T,A)=>{const k=setTimeout(()=>{A(new Error("Cannot receive track, id: ".concat(m)))},1e4),P=q=>{const j=Mn();if(j.name==="Safari"&&Number(j.version)===11&&q.track.id!==m&&q.streams[0].id===_){var H;const ne=q.streams[0].getTracks()[0];return(H=this.remoteSDP)===null||H===void 0||H.updateTrackLabel(y,m,q.track.id),this.peerConnection.removeEventListener("track",P),clearTimeout(k),void T({track:ne,id:m})}if(q.track.id===m)return this.peerConnection.removeEventListener("track",P),clearTimeout(k),void T({track:q.track,id:m})};this.peerConnection.addEventListener("track",P)})}),i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const c=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(c),await bt.all(r)}catch(r){throw new $e(oe.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(r.toString()))}}async getRemoteSSRC(n){if(!this.remoteSDP)return;const r=this.remoteSDP.getSSRC(n);return r==null?void 0:r[0].ssrcId}setConfiguration(n){if(Bn().supportPCSetConfiguration){const r=ig.resolvePCConfiguration(n);this.peerConnection.setConfiguration(r)}}},Lt(cr.prototype,"connect",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"connect"),cr.prototype),Lt(cr.prototype,"stopSending",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"stopSending"),cr.prototype),Lt(cr.prototype,"receive",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"receive"),cr.prototype),Lt(cr.prototype,"stopReceiving",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"stopReceiving"),cr.prototype),Lt(cr.prototype,"muteRemote",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"muteRemote"),cr.prototype),Lt(cr.prototype,"unmuteRemote",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"unmuteRemote"),cr.prototype),Lt(cr.prototype,"muteLocal",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"muteLocal"),cr.prototype),Lt(cr.prototype,"unmuteLocal",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"unmuteLocal"),cr.prototype),Lt(cr.prototype,"close",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"close"),cr.prototype),Lt(cr.prototype,"updateEncoderConfig",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"updateEncoderConfig"),cr.prototype),Lt(cr.prototype,"updateSendParameters",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"updateSendParameters"),cr.prototype),Lt(cr.prototype,"replaceTrack",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"replaceTrack"),cr.prototype),Lt(cr.prototype,"getRemoteSSRC",[ta],Object.getOwnPropertyDescriptor(cr.prototype,"getRemoteSSRC"),cr.prototype),cr);function ta(e,n,r){const i=e[n];if(typeof i!="function")throw new Error("Cannot use mutex on object property.");return r.value=async function(){const c=this.mutex,u=await c.lock("Locking from P2PConnection.".concat(n));try{for(var f=arguments.length,m=new Array(f),_=0;_<f;_++)m[_]=arguments[_];return await i.apply(this,m)}finally{u()}},r}const Zue={name:"PlanBConnection",create:function(e){let{store:n,spec:r}=e;return new Jue(r,n)}},Que={interceptLocalAudioFrame:async function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Bn().supportWebRTCEncodedTransform)return void x.warning("browser not support audio encoded transform");if(hy.has(e)||!e.track)return;const r={track:e.track};if(Rl()){if(!e.createEncodedStreams)return void x.warning("browser not support createEncodedStreams() API");let c=null;try{c=e.createEncodedStreams()}catch(f){return void x.error("create audio-encoded-streams error",f&&f.message)}const u=new TransformStream({transform(f,m){r.controller||(r.controller=m),e.track&&e.track.id!==r.track.id&&(x.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i));const _=n.metadata&&n.metadata();_?function(y,T){const{chunk:A,controller:k}=T,P=de("ENABLE_AUDIO_PTS_METADATA")?kl.AUDIO_64_BIT_PTS:kl.METADATA;A.data=function(q,j,H){const ne=H.byteLength,re=ne+CR+BF,ve=SR+TR+re,Oe=new ArrayBuffer(q.byteLength+ve),ke=new DataView(Oe);ke.setUint8(0,FF),ke.setUint16(1,re),ke.setUint8(3,j),ke.setUint16(4,ne);for(let Be=0;Be<ne;Be++)ke.setUint8(6+Be,H[Be]);const we=new Uint8Array(ke.buffer);return we.set(new Uint8Array(q),ve),we.buffer}(A.data,P,y),k.enqueue(A)}(_,{chunk:f,controller:m}):m.enqueue(f)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Vo()){if(typeof RTCRtpScriptTransform>"u")return void x.warning("browser not support RTCRtpScriptTransform");const c=dy(),u=new MessageChannel;await new bt(m=>c.onmessage=_=>{_.data==="registered"&&m(void 0)});const f=new RTCRtpScriptTransform(c,{name:"audio-metadata-tx",port:u.port2},[u.port2]);e.transform=f,await new bt(m=>c.onmessage=_=>{_.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var _;if(m.data.transformed&&e.track&&((_=e.track)===null||_===void 0?void 0:_.id)!==r.track.id)x.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i);else if(m.data.getMetadata){const y=n.metadata&&n.metadata();y&&u.port1.postMessage({metadata:y})}},r.worker=c}function i(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",i)}const c=hy.get(e);if(c){hy.delete(e);try{var u,f;(u=c.controller)===null||u===void 0||u.terminate(),(f=c.worker)===null||f===void 0||f.terminate()}catch(m){x.warning(m&&m.message)}}}hy.set(e,r),e.track.addEventListener("ended",i)},interceptRemoteAudioFrame:async function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Bn().supportWebRTCEncodedTransform)return void x.warning("browser not support audio encoded transform");if(_y.has(e))return;const r={track:e.track,onMetadata:n.onMetadata};if(Rl()){if(!e.createEncodedStreams)return void x.warning("browser not support createEncodedStreams() API");xw(jn.CHROME,87,116)||(n.enableTopn=!1);let c=null;try{c=e.createEncodedStreams()}catch(f){return void x.error("create audio-encoded-streams error",f&&f.message)}const u=new TransformStream({transform(f,m){r.controller||(r.controller=m),e.track&&e.track.id!==r.track.id&&(x.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i)),n.enableTopn?function(_,y,T){var A;const k=jF(new DataView(y.data));if(!k)return T.enqueue(y);const P=_.track.id;Dae.set(P,_.track);const q=(A=k.tlv.find(Oe=>Oe.tag===kl.AUDIO_LEVEL))===null||A===void 0?void 0:A.value;let j=0;typeof q=="number"&&(j=127-q);const H=Math.round(Math.pow(10,j/60)-1),{selected:ne,speaker:re}=function(Oe,ke){let we=Kf.get(Oe);if(we||(we=function(Be){const lt=new HF;return Kf.set(Be,lt),oc||(oc=new kae(de("TOPN_SILENCE_THRESHOLD")||500),oc.on("ActiveSpeakerChanged",St=>{St!=null&&(my=St)})),oc.addSpeakers([lt]),lt}(Oe)),Kf.size<=WF)return{selected:!0,speaker:we};if(!oc)throw new Error("no active speaker detector");return oc.levelChanged(we.id,ke),Wd=oc.loudest.map(Be=>Be.id),my&&!gt(Wd).call(Wd,my)&&Wd.length>=WF&&Wd.pop(),{selected:gt(Wd).call(Wd,we.id)||we.id===my,speaker:we}}(_,H),ve=function(Oe,ke,we){const Be=sc.get(Oe)||new Pae(Oe,ke);return Be.score=we,sc.set(Oe,Be),function(lt){if(vy.set(lt,!0),!gy)return void(gy=Date.now());const St=Date.now();St-gy>1e3&&(vy.get(lt)?vy.set(lt,!1):(KF(lt),vy.delete(lt)),gy=St)}(Oe),Be}(P,_.track,re.energyScore);ve.addSample(ne),ve.active&&(y.data=k.frame.buffer,T.enqueue(y))}(e,f,m):n.enableMetadata?function(_,y,T){const A=jF(new DataView(_.data));if(!A)return y.enqueue(_);const k=A.tlv.find(P=>P.tag===kl.METADATA||P.tag===kl.AUDIO_64_BIT_PTS);k&&T&&k.value instanceof Uint8Array&&T(k.value),_.data=A.frame.buffer,y.enqueue(_)}(f,m,n.onMetadata):m.enqueue(f)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Vo()){if(typeof RTCRtpScriptTransform>"u")return void x.warning("browser not support RTCRtpScriptTransform");const c=dy(),u=new MessageChannel;await new bt(m=>c.onmessage=_=>{_.data==="registered"&&m(void 0)});const f=new RTCRtpScriptTransform(c,{name:"audio-metadata-rx",port:u.port2},[u.port2]);e.transform=f,await new bt(m=>c.onmessage=_=>{_.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var _;m.data.transformed&&e.track&&((_=e.track)===null||_===void 0?void 0:_.id)!==r.track.id?(x.debug("audio track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i)):m.data.metadata&&r.onMetadata&&r.onMetadata(m.data.metadata)},r.worker=c}function i(){e.track.removeEventListener("ended",i),function(c){const u=_y.get(c);if(u){(function(_){const y=Kf.get(_);y&&(Kf.delete(_),oc&&(oc.removeSpeakers([y]),Kf.size===0&&(oc.destroy(),oc=null)))})(c),KF(c.track.id),_y.delete(c);try{var f,m;(f=u.controller)===null||f===void 0||f.terminate(),(m=u.worker)===null||m===void 0||m.terminate()}catch(_){x.warning(_&&_.message)}}}(e)}_y.set(e,r),e.track.addEventListener("ended",i)},interceptLocalVideoFrame:async function(e,n){if(!Bn().supportWebRTCEncodedTransform)return void x.warning("browser not support video encoded transform");if(Ey.has(e)||!e.track)return;const r={track:e.track};if(Rl()){if(!e.createEncodedStreams)return void x.warning("browser not support createEncodedStreams() API");let c=null;try{c=e.createEncodedStreams()}catch(m){return void x.error("create video-encoded-streams error",m&&m.message)}const u=[];n.on("sei-to-send",m=>{u.push(m)});const f=new TransformStream({transform(m,_){r.controller||(r.controller=_),e.track&&e.track.id!==r.track.id&&(x.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i));const y=u.shift();y&&(m.data=function(T,A){const k=function(re){const ve=re.length;let Oe=[],ke=0;for(;ke<ve;)ke+2<ve&&re[ke]===0&&re[ke+1]===0&&(re[ke+2]===0||re[ke+2]===1||re[ke+2]===2||re[ke+2]===3)?(Oe.push(re[ke],re[ke+1],3,re[ke+2]),ke+=3):(Oe.push(re[ke]),ke++);return new Uint8Array(Oe)}(A),P=k.length,q=Math.floor(P/255),j=P%255,H=new Uint8Array(6+q+1+P+T.byteLength);H[0]=0,H[1]=0,H[2]=0,H[3]=1,H[4]=6,H[5]=101;let ne=0;for(;ne<q;)H[6+ne]=255,ne++;return H[6+ne]=j,ne++,H.set(k,6+ne),H.set(new Uint8Array(T),6+ne+P),H.buffer}(m.data,y)),_.enqueue(m)}});c.readable.pipeThrough(f).pipeTo(c.writable)}else{if(!Vo())return;{if(typeof RTCRtpScriptTransform>"u")return void x.warning("browser not support RTCRtpScriptTransform");const c=dy(),u=new MessageChannel;await new bt(m=>c.onmessage=_=>{_.data==="registered"&&m(void 0)});const f=new RTCRtpScriptTransform(c,{name:"sei-tx",port:u.port2},[u.port2]);e.transform=f,await new bt(m=>c.onmessage=_=>{_.data==="started"&&m(void 0)}),n.on("sei-to-send",m=>{u.port1.postMessage({sei:m})}),u.port1.onmessage=m=>{var _;m.data.transformed&&e.track&&((_=e.track)===null||_===void 0?void 0:_.id)!==r.track.id&&(x.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i))},r.worker=c}}function i(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",i)}const c=Ey.get(e);if(c){Ey.delete(e);try{var u,f;(u=c.controller)===null||u===void 0||u.terminate(),(f=c.worker)===null||f===void 0||f.terminate()}catch(m){x.warning(m&&m.message)}}}Ey.set(e,r),e.track.addEventListener("ended",i)},interceptRemoteVideoFrame:async function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Bn().supportWebRTCEncodedTransform)return void x.warning("browser not support video encoded transform");if(!e.track)return;if(hv.has(e)){const c=hv.get(e);return void(c&&(c.onSei=n.onSei))}const r={track:e.track,onSei:n.onSei};if(Rl()){if(!e.createEncodedStreams)return void x.warning("browser not support createEncodedStreams() API");let c=null;try{c=e.createEncodedStreams()}catch(f){return void x.error("create video-encoded-streams error",f&&f.message)}const u=new TransformStream({transform(f,m){r.controller||(r.controller=m),e.track&&e.track.id!==r.track.id&&(x.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i));const _=function(y){const T=new DataView(y.data);let A=0;for(;A+4<y.data.byteLength;){if(T.getUint8(A+0)===0&&T.getUint8(A+1)===0&&T.getUint8(A+2)===0&&T.getUint8(A+3)===1&&T.getUint8(A+4)===6){let k=A+6,P=0,q=0;for(;(q=T.getUint8(k++))===255;)P+=255;P+=q;const j=Lae(y.data,k,P);return new Uint8Array(j)}A++}return null}(f);_&&r.onSei&&r.onSei(_),m.enqueue(f)}});c.readable.pipeThrough(u).pipeTo(c.writable)}else if(Vo()){if(typeof RTCRtpScriptTransform>"u")return void x.warning("browser not support RTCRtpScriptTransform");const c=dy(),u=new MessageChannel;await new bt(m=>c.onmessage=_=>{_.data==="registered"&&m(void 0)});const f=new RTCRtpScriptTransform(c,{name:"sei-rx",port:u.port2},[u.port2]);e.transform=f,await new bt(m=>c.onmessage=_=>{_.data==="started"&&m(void 0)}),u.port1.onmessage=m=>{var _;m.data.transformed&&e.track&&((_=e.track)===null||_===void 0?void 0:_.id)!==r.track.id?(x.debug("video track changed: ".concat(r.track.id," => ").concat(e.track.id)),r.track.removeEventListener("ended",i),r.track=e.track,r.track.addEventListener("ended",i)):m.data.sei&&r.onSei&&r.onSei(m.data.sei)},r.worker=c}function i(){if(e.track){if(this.id!==e.track.id)return;e.track.removeEventListener("ended",i)}(function(c){const u=hv.get(c);if(u){hv.delete(c);try{var f,m;(f=u.controller)===null||f===void 0||f.terminate(),(m=u.worker)===null||m===void 0||m.terminate()}catch(_){x.warning(_&&_.message)}}})(e)}hv.set(e,r),e.track.addEventListener("ended",i)}},ede={name:"InterceptFrame",create:()=>Que};tR(),tr("PROCESS_ID","process-".concat(dr(8,""),"-").concat(dr(4,""),"-").concat(dr(4,""),"-").concat(dr(4,""),"-").concat(dr(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(n){return void x.error("Error loading sdk config",n.message)}if(e)try{const n=JSON.parse(window.atob(e)),r=Date.now();x.debug("Loading global parameters from cache",n),Object.keys(n).forEach(i=>{if(Object.prototype.hasOwnProperty.call(br,i)){const{value:c,expires:u}=n[i];if(u&&u<=r)return;rc[i]=c,br[i]=c}})}catch(n){x.error("Error loading mutableParamsCache: ".concat(e),n.message)}}(),Array.isArray(rc.AREAS)&&rc.AREAS.length>0&&GR(rc.AREAS,!0);const Yj=(e,n,r)=>{x.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(n))),tr(e,n,r)};Du(Tue,!1),Du(Rue,!1),Du(sle,!1),Du(Uue,!1),Du(yue,!1),Du(que,!1),Du(Zue,!1),Du(ede,!1);const io=function(e){const n=new Dr,r=e,i={getListeners:n.getListeners.bind(n),on:(c,u)=>(function(f,m){f===Hc.SECURITY_POLICY_VIOLATION&&A4(m,!0)}(c,u),n.on.bind(n)(c,u)),addListener:n.addListener.bind(n),once:n.once.bind(n),off:n.off.bind(n),removeAllListeners:n.removeAllListeners.bind(n),emit:n.emit.bind(n),safeEmit:n.safeEmit.bind(n)};return I4(I4({},r),i)}({__TRACK_LIST__:Mf,VERSION:Yi,BUILD:oR,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:Yj,getParameter:de,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let n=new RTCPeerConnection;const r=await async function(i){let c;return Bn().supportUnifiedPlan?(i.addTransceiver("video",{direction:"recvonly"}),i.addTransceiver("audio",{direction:"recvonly"}),c=(await i.createOffer()).sdp):c=(await i.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,c}(n);if(!r)return e;n.close(),n=null,e=function(i){const c={video:[],audio:[]};return i.match(/ VP8/i)&&c.video.push("VP8"),i.match(/ VP9/i)&&c.video.push("VP9"),i.match(/ AV1/i)&&c.video.push("AV1"),i.match(/ H264/i)&&c.video.push("H264"),i.match(/ H265/i)&&c.video.push("H265"),i.match(/ opus/i)&&c.audio.push("OPUS"),i.match(/ PCMU/i)&&c.audio.push("PCMU"),i.match(/ PCMA/i)&&c.audio.push("PCMA"),i.match(/ G722/i)&&c.audio.push("G722"),c}(r)}catch(n){throw new Ue(oe.CREATE_OFFER_FAILED,n.toString&&n.toString()).print()}return e},checkSystemRequirements:function(){const e=Bt.reportApiInvoke(null,{name:oo.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Fr.TRACER});let n=!1;try{const u=window.RTCPeerConnection,f=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,m=window.WebSocket;n=!!(u&&f&&m),n&&Bw()&&qx(75)&&new u().close()}catch(u){return x.error("check system requirement failed: ",u),!1}let r=!1;const i=Mn();i.name===jn.CHROME&&Number(i.version)>=58&&(tc.engine.name!=="WebKit"||function(){const u=Mn();if(YE()){if(u.os===yo.MAC_OS)return!0;if(u.os===yo.IOS){const f=tc.os.version&&tc.os.version.split(".");if(f&&Number(f[0])===14&&f[1]&&Number(f[1])>=3||f&&Number(f[0])>14)return!0}}return!1}())&&(r=!0),(i.name===jn.FIREFOX&&Number(i.version)>=56||i.name===jn.OPERA&&Number(i.version)>=45||i.name===jn.SAFARI&&Number(i.version)>=11||i.name==="WebKit"&&(vs()||Sa())&&i.osVersion&&Number(i.osVersion.split(".")[0])>=11||tU()||Mn().name===jn.QQ)&&(r=!0),x.debug("checkSystemRequirements, api:",n,"browser",r);const c=n&&r;return e.onSuccess(c),c},getDevices:function(e){return Pi.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return Pi.getRecordingDevices(e)},getCameras:function(e){return Pi.getCamerasDevices(e)},getElectronScreenSources:qU,getPlaybackDevices:function(e){return Pi.getSpeakers(e)},createClient:function(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const r=dr(5,"client-"),i=Bt.reportApiInvoke(null,{id:r,name:oo.CREATE_CLIENT,options:[n],tag:Fr.TRACER});try{(function(c){vo(c.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),vo(c.mode,"config.mode",["rtc","live","p2p"]),c.audioCodec!==void 0&&vo(c.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),c.proxyServer!==void 0&&Po(c.proxyServer,"config.proxyServer",1,1e4),c.turnServer!==void 0&&lU(c.turnServer),c.httpRetryConfig!==void 0&&cU(c.httpRetryConfig),c.websocketRetryConfig!==void 0&&cU(c.websocketRetryConfig)})(n)}catch(c){throw i.onError(c),c}return(Jx(16,0)||Zx(16,0,!0))&&(n.codec==="vp9"&&(n.codec="vp8",x.debug("browser not support vp9, force use vp8")),tr("UNSUPPORTED_VIDEO_CODEC",["vp9"])),n.audioCodec===void 0&&(n.audioCodec="opus"),i.onSuccess(),new ile(Na(Na({forceWaitGatewayResponse:!0},n),{},{role:gt(e=["rtc","p2p"]).call(e,n.mode)?"host":n.role||"audience"}),r)},createCameraVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=de("CAMERA_CAPTURE_CONFIG"),r=dr(8,"track-cam-"),i=Bt.reportApiInvoke(null,{id:r,tag:Fr.TRACER,name:oo.CREATE_CAM_VIDEO_TRACK,options:[kr({},e),n]});n&&(e.encoderConfig=n);const c=ly(e);let u=null;x.info("start create camera video track with config",JSON.stringify(e),"trackId",r);try{u=(await ki({video:c},r)).getVideoTracks()[0]||null}catch(m){throw i.onError(m),m}if(!u){const m=new $e(oe.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(m),m.throw(x)}e.optimizationMode&&bR(r,u,e,Bc(e.encoderConfig));const f=new yR(u,e,c,e.scalabiltyMode?sy(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r);return i.onSuccess(f.getTrackId()),x.info("create camera video success, trackId:",r),f},createCustomVideoTrack:function(e){const n=dr(8,"track-cus-"),r=Bt.reportApiInvoke(null,{id:n,tag:Fr.TRACER,name:oo.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),i=new Sr(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?sy(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n,[hr.CUSTOM_TRACK]);return r.onSuccess(i.getTrackId()),x.info("create custom video track success with config",e,"trackId",i.getTrackId()),i},createScreenVideoTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const r=typeof n=="object"?function(k){return sV(k)}(n):void 0;r&&(n="auto");const i=dr(8,"track-scr-v-"),c=Bt.reportApiInvoke(null,{id:i,tag:Fr.TRACER,name:oo.CREATE_SCREEN_VIDEO_TRACK,options:[kr({},e),n]});e.encoderConfig?typeof e.encoderConfig=="string"||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const u=function(k){const P={};k.screenSourceType&&(P.mediaSource=k.screenSourceType),k.extensionId&&Rl()&&(P.extensionId=k.extensionId);const{displaySurface:q,selfBrowserSurface:j,surfaceSwitching:H,systemAudio:ne,preferCurrentTab:re}=k;(tv(107)||Uw(107)||Vw(93))&&(q&&(vo(q,"displaySurface",["browser","window","monitor"]),P.displaySurface=q),j?(vo(j,"selfBrowserSurface",["exclude","include"]),P.selfBrowserSurface=j):P.selfBrowserSurface="include",H&&(vo(H,"surfaceSwitching",["exclude","include"]),P.surfaceSwitching=H)),(tv(105)||Uw(105)||Vw(91))&&ne&&(vo(ne,"systemAudio",["exclude","include"]),P.systemAudio=ne),(tv(94)||Uw(94)||Vw(80))&&re&&(P.preferCurrentTab=!0),k.electronScreenSourceId&&(P.sourceId=k.electronScreenSourceId);const ve=k.encoderConfig?lR(k.encoderConfig):null;return P.mandatory={chromeMediaSource:"desktop",maxWidth:ve?ve.width:void 0,maxHeight:ve?ve.height:void 0},ve&&(ve.frameRate&&(typeof ve.frameRate=="number"?(P.mandatory.maxFrameRate=ve.frameRate,P.mandatory.minFrameRate=ve.frameRate):(P.mandatory.maxFrameRate=ve.frameRate.max||ve.frameRate.ideal||ve.frameRate.exact||void 0,P.mandatory.minFrameRate=ve.frameRate.min||ve.frameRate.ideal||ve.frameRate.exact||void 0),P.frameRate=ve.frameRate),ve.width&&(P.width=ve.width),ve.height&&(P.height=ve.height)),P}(e);let f=null,m=null;const _=Bn();if(!_.supportShareAudio&&n==="enable"){const k=new $e(oe.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return c.onError(k),k.throw(x)}x.info("start create screen video track with config",e,"withAudio",n,"trackId",i);const y=_.supportShareAudio&&n!=="disable";try{const k=await ki({screen:u,screenAudio:y?r||!0:void 0},i);f=k.getVideoTracks()[0]||null,m=k.getAudioTracks()[0]||null}catch(k){throw c.onError(k),k}if(!f){const k=new $e(oe.UNEXPECTED_ERROR,"can not find track in media stream");return c.onError(k),k.throw(x)}if(!m&&n==="enable"){f&&f.stop();const k=new $e(oe.SHARE_AUDIO_NOT_ALLOWED);return c.onError(k),k.throw(x)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(bR(i,f,e,e.encoderConfig&&lR(e.encoderConfig)||void 0),e.encoderConfig&&typeof e.encoderConfig!="string"&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const T=new Sr(f,e.encoderConfig?lR(e.encoderConfig):{},e.scalabiltyMode?sy(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i,[hr.SCREEN_TRACK]);if(!m)return c.onSuccess(T.getTrackId()),x.info("create screen video track success","video:",T.getTrackId()),T;const A=new Hr(m,void 0,dr(8,"track-scr-a-"),!1);return c.onSuccess([T.getTrackId(),A.getTrackId()]),x.info("create screen video track success","video:",T.getTrackId(),"audio:",A.getTrackId()),[T,A]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=de("CAMERA_CAPTURE_CONFIG"),i=dr(8,"track-mic-"),c=dr(8,"track-cam-"),u=Bt.reportApiInvoke(null,{id:"".concat(i,"-").concat(c),tag:Fr.TRACER,name:oo.CREATE_MIC_AND_CAM_TRACKS,options:[e,n,r]});r&&(n.encoderConfig=r);const f=ly(n),m=iV(e);let _=null,y=null;x.info("start create camera video track(".concat(c,") and microphone audio track(").concat(i,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(n)));try{const k=await ki({audio:m,video:f},"".concat(i,"-").concat(c));_=k.getAudioTracks()[0],y=k.getVideoTracks()[0]}catch(k){throw u.onError(k),k}if(!_||!y){const k=new $e(oe.UNEXPECTED_ERROR,"can not find tracks in media stream");return u.onError(k),k.throw(x)}n.optimizationMode&&bR(c,y,n,Bc(n.encoderConfig));const T=new uy(_,e,m,i),A=new yR(y,n,f,n.scalabiltyMode?sy(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,c);return u.onSuccess([T.getTrackId(),A.getTrackId()]),x.info("create camera video track(".concat(c,") and microphone audio track(").concat(i,") success")),[T,A]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=dr(8,"track-mic-"),r=Bt.reportApiInvoke(null,{id:n,tag:Fr.TRACER,name:oo.CREATE_MIC_AUDIO_TRACK,options:[e]}),i=iV(e);let c=null;x.info("start create microphone audio track with config",JSON.stringify(e),"trackId",n);try{c=(await ki({audio:i},n)).getAudioTracks()[0]||null}catch(f){throw r.onError(f),f}if(!c){const f=new $e(oe.UNEXPECTED_ERROR,"can not find track in media stream");return r.onError(f),f.throw(x)}const u=new uy(c,e,i,n);return r.onSuccess(u.getTrackId()),x.info("create microphone audio track success, trackId:",n),u},createCustomAudioTrack:function(e){const n=dr(8,"track-cus-"),r=Bt.reportApiInvoke(null,{id:n,tag:Fr.TRACER,name:oo.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),i=new Hr(e.mediaStreamTrack,e.encoderConfig?iy(e.encoderConfig):{},n,!1);return x.info("create custom audio track success with config",e,"trackId",i.getTrackId()),r.onSuccess(i.getTrackId()),i},createBufferSourceAudioTrack:async function(e){var n;const{cacheOnlineFile:r,encoderConfig:i}=e;let{source:c}=e;const u={source:c instanceof AudioBuffer?"AudioBuffer":c instanceof File?(n=File.name)!==null&&n!==void 0?n:"File":c,cacheOnlineFile:r,encoderConfig:i},f=dr(8,"track-buf-"),m=Bt.reportApiInvoke(null,{id:f,tag:Fr.TRACER,name:oo.CREATE_BUFFER_AUDIO_TRACK,options:[u]});if(de("DISABLE_WEBAUDIO"))throw new $e(oe.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");x.info("start create buffer source audio track with config",JSON.stringify(u),"trackId",f);const _=c;if(!(c instanceof AudioBuffer))try{c=await async function(A,k){let P=null;if(typeof A=="string"){const j=GV.get(A);if(j)return x.debug("use cached audio resource: ",A),j;try{P=(await nc(()=>Is.get(A,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(H){throw new $e(oe.FETCH_AUDIO_FILE_FAILED,H.toString())}}else P=await new bt((H,ne)=>{const re=new FileReader;re.onload=ve=>{ve.target?H(ve.target.result):ne(new $e(oe.READ_LOCAL_AUDIO_FILE_ERROR))},re.onerror=()=>{ne(new $e(oe.READ_LOCAL_AUDIO_FILE_ERROR))},re.readAsArrayBuffer(A)});const q=await function(j){const H=jf();return new bt((ne,re)=>{H.decodeAudioData(j,ve=>{ne(ve)},ve=>{re(new $e(oe.DECODE_AUDIO_FILE_FAILED,ve.toString()))})})}(P);return typeof A=="string"&&k&&GV.set(A,q),q}(c,r)}catch(A){return m.onError(A),A.throw(x)}const y=new Rae(c),T=new wae(_,y,i?iy(i):{},f);return x.info("create buffer source audio track success, trackId:",f),m.onSuccess(T.getTrackId()),T},setAppType:function(e){if(x.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw x.debug("Invalid appType"),new Ue(oe.INVALID_PARAMS,"invalid app type",e);tr("APP_TYPE",Math.floor(e))},setLogLevel:function(e){x.setLogLevel(e)},enableLogUpload:function(){de("USE_NEW_LOG")?tr("UPLOAD_LOG",!0):x.enableLogUpload()},disableLogUpload:function(){de("USE_NEW_LOG")?tr("UPLOAD_LOG",!1):x.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new GB},checkAudioTrackIsActive:async function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Bt.reportApiInvoke(null,{tag:Fr.TRACER,name:oo.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[n]});if(!(e instanceof Hr||e instanceof Wf)){const _=new Ue(oe.INVALID_TRACK,"the parameter is not a audio track");return r.onError(_),_.throw()}n&&n<1e3&&(n=1e3);const i=e instanceof Hr?e.getTrackLabel():"remote_track",c=e.getVolumeLevel();let u=c,f=c;const m=Date.now();return new bt(_=>{const y=setInterval(()=>{const T=e.getVolumeLevel();u=T>u?T:u,f=T<f?T:f;const A=u-f>1e-4,k=Date.now()-m;if(A||k>n){clearInterval(y);const P=A,q={duration:k,deviceLabel:i,maxVolumeLevel:u,result:P};x.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(q))),r.onSuccess(q),_(P)}},200)})},checkVideoTrackIsActive:async function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const r=Bt.reportApiInvoke(null,{tag:Fr.TRACER,name:oo.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[n]});if(!(e instanceof Sr||e instanceof Hf)){const A=new Ue(oe.INVALID_TRACK,"the parameter is not a video track");return r.onError(A),A.throw()}n&&n<1e3&&(n=1e3);const i=e instanceof Sr?e.getTrackLabel():"remote_track",c=e.getMediaStreamTrack(!0),u=document.createElement("video");u.style.width="1px",u.style.height="1px",u.setAttribute("muted",""),u.muted=!0,u.setAttribute("playsinline",""),u.controls=!1,(Vo()||YE())&&(u.style.opacity="0.01",u.style.position="fixed",u.style.left="0",u.style.top="0",document.body.appendChild(u)),u.srcObject=new MediaStream([c]),u.play();const f=document.createElement("canvas");f.width=160,f.height=120;let m=0,_=0;try{const A=Date.now();m=await function(k,P,q,j){let H,ne=0,re=null;return new bt((ve,Oe)=>{function ke(){ne>j&&H&&(H(),ve(ne));const we=q.getContext("2d");if(!we){const St=new Ue(oe.UNEXPECTED_ERROR,"can not get canvas 2d context.");return x.error(St.toString()),void Oe(St)}we.drawImage(k,0,0,160,120);const Be=we.getImageData(0,0,q.width,q.height),lt=Math.floor(Be.data.length/3);if(re){for(let St=0;St<lt;St+=3)if(Be.data[St]!==re[St])return ne+=1,void(re=Be.data);re=Be.data}else re=Be.data}setTimeout(()=>{H&&(H(),ve(ne))},P),H=pR(()=>{ke()},30)})}(u,n,f,4),_=Date.now()-A}catch(A){throw r.onError(A),A}Kce===jn.SAFARI&&(u.pause(),u.remove()),u.srcObject=null;const y=m>4,T={duration:_,changedPicNum:m,deviceLabel:i,result:y};return x.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(T))),r.onSuccess(T),y},setArea:GR,audioElementPlayCenter:As,resumeAudioContext:function(){As.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){cle.processExternalMediaAEC(e)},registerExtensions:function(e){const n=de("PLUGIN_INFO")||[];e.forEach(r=>{"name"in r&&!gt(n).call(n,r.name)&&n.push(r.name);const i=r;i.__registered__=!0,i.logger.hookLog=x.extLog,i.reporter.hookApiInvoke=Bt.extApiInvoke,i.parameters&&Object.keys(i.parameters).forEach(c=>{i.parameters[c]=de(c)})}),Yj("PLUGIN_INFO",n)},ChannelMediaRelayError:zf,ChannelMediaRelayEvent:Dl,ChannelMediaRelayState:Hs,RemoteStreamFallbackType:_ae,RemoteStreamType:gae,ConnectionDisconnectedReason:Yn,AudienceLatencyLevelType:Yie,AREAS:$n,preload:async function(e,n,r,i){return E3(e,n,r,i)}});return Object.defineProperties(io,{onAudioAutoplayFailed:{get:()=>Di.onAudioAutoplayFailed,set:e=>{Di.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>Di.onAutoplayFailed,set:e=>{Di.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>io._onSecurityPolicyViolation,set(e){io._onSecurityPolicyViolation=e,A4(e)}},__CLIENT_LIST__:{get:()=>de("SHOW_GLOBAL_CLIENT_LIST")?Kd:[]}}),Pi.on(jd.CAMERA_DEVICE_CHANGED,e=>{x.info("camera device changed",JSON.stringify(e)),io.onCameraChanged&&io.onCameraChanged(e),io.safeEmit(Hc.CAMERA_CHANGED,e)}),Pi.on(jd.RECORDING_DEVICE_CHANGED,e=>{x.info("microphone device changed",JSON.stringify(e)),io.onMicrophoneChanged&&io.onMicrophoneChanged(e),io.safeEmit(Hc.MICROPHONE_CHANGED,e)}),Pi.on(jd.PLAYOUT_DEVICE_CHANGED,e=>{x.debug("playout device changed",JSON.stringify(e)),io.onPlaybackDeviceChanged&&io.onPlaybackDeviceChanged(e),io.safeEmit(Hc.PLAYBACK_DEVICE_CHANGED,e)}),As.onAutoplayFailed=()=>{x.info("detect audio element autoplay failed"),Di.onAudioAutoplayFailed&&Di.onAudioAutoplayFailed()},nr.on("autoplay-failed",()=>{x.info("detect webaudio autoplay failed"),Di.onAudioAutoplayFailed&&Di.onAudioAutoplayFailed(),io.safeEmit(Hc.AUTOPLAY_FAILED)}),nr.on(Mo.STATE_CHANGE,(e,n)=>{x.info("audio context state changed: ".concat(n," => ").concat(e)),io.onAudioContextStateChanged&&io.onAudioContextStateChanged(e,n),io.safeEmit(Hc.AUDIO_CONTEXT_STATE_CHANGED,e,n)}),Qr.on(Of.NETWORK_STATE_CHANGE,(e,n)=>{x.info("[network-indicator] network state changed, ".concat(n," => ").concat(e))}),window&&(window.__ARTC__=io),io})})(Fq);var w4e=Fq.exports;const R4e=_l(w4e);class I4e{constructor(){this.client=null,this.remoteAudioTrack=null,this.remoteVideoTrack=null,this.localAudioTrack=null,this.localVideoTrack=null,this.status="disconnected",this.messageHandlers=new Map,this.appId=null}async init(o){var s,a;try{return this.appId=o,this.client=R4e.createClient({mode:"live",codec:"vp8"}),this.status="connecting",(s=this.messageHandlers.get("status"))==null||s("RTC..."),!0}catch(l){return console.error("RTC init error:",l),this.status="error",(a=this.messageHandlers.get("error"))==null||a(l),!1}}async joinChannel(o,s,a){var l,d,h;try{if(!this.client)throw new Error("RTC client not initialized");if(!this.appId)throw new Error("RTC appId not set");if(!s)throw new Error("Channel name is required");if(!a)throw new Error("Token is required");console.log(":",{appId:this.appId,channel:s,token:a}),(l=this.messageHandlers.get("status"))==null||l(`: ${s}`);const v=await this.client.join(this.appId,s,a,parseInt(o),null);return console.log("ID:",v),(d=this.messageHandlers.get("status"))==null||d(`ID: ${v}`),this.client.on("user-published",async(g,E)=>{var b,S,C,w,I,R;console.log(":",{uid:g.uid,mediaType:E}),(b=this.messageHandlers.get("status"))==null||b(`${E}...`);try{await this.client.subscribe(g,E),console.log(":",E),E==="audio"?(this.remoteAudioTrack=g.audioTrack,(S=this.messageHandlers.get("audio"))==null||S(g.audioTrack),(C=this.messageHandlers.get("status"))==null||C("")):E==="video"&&(this.remoteVideoTrack=g.videoTrack,(w=this.messageHandlers.get("video"))==null||w(g.videoTrack),(I=this.messageHandlers.get("status"))==null||I(""))}catch(N){console.error(":",N),(R=this.messageHandlers.get("error"))==null||R({message:`${E}: ${N.message}`})}}),this.client.on("user-unpublished",(g,E)=>{var b;console.log(":",{uid:g.uid,mediaType:E}),(b=this.messageHandlers.get("status"))==null||b(`${E}`),E==="audio"?this.remoteAudioTrack&&(this.remoteAudioTrack.stop(),this.remoteAudioTrack=null):E==="video"&&this.remoteVideoTrack&&(this.remoteVideoTrack.stop(),this.remoteVideoTrack=null)}),this.client.on("user-left",g=>{var E,b;console.log(":",g.uid),(E=this.messageHandlers.get("status"))==null||E(` ${g.uid} `),(b=this.messageHandlers.get("user-left"))==null||b(g)}),this.client.on("connection-state-change",(g,E,b)=>{var S;console.log(":",{from:E,to:g,reason:b}),(S=this.messageHandlers.get("status"))==null||S(`: ${E} -> ${g} (${b})`)}),this.status="connected",!0}catch(v){return console.error("Join channel error:",v),this.status="error",(h=this.messageHandlers.get("error"))==null||h(v),!1}}async leaveChannel(){var o,s,a;try{return this.client?((o=this.messageHandlers.get("status"))==null||o("..."),this.remoteAudioTrack&&this.remoteAudioTrack.stop(),this.remoteVideoTrack&&this.remoteVideoTrack.stop(),this.localAudioTrack&&this.localAudioTrack.stop(),this.localVideoTrack&&this.localVideoTrack.stop(),await this.client.leave(),this.status="disconnected",(s=this.messageHandlers.get("status"))==null||s(""),!0):!1}catch(l){return console.error("Leave channel error:",l),this.status="error",(a=this.messageHandlers.get("error"))==null||a(l),!1}}on(o,s){this.messageHandlers.set(o,s)}off(o){this.messageHandlers.delete(o)}getStatus(){return this.status}getRemoteVideoTrack(){return this.remoteVideoTrack}getRemoteAudioTrack(){return this.remoteAudioTrack}}const $q=(t,o)=>{const s=t.__vccOpts||t;for(const[a,l]of o)s[a]=l;return s},A4e={name:"ScreenMirror",setup(){const t=ee(!1),o=ee(!1),s=ee(""),a=ee(""),l=ee("disconnected"),d=ee(""),h=ee("disconnected"),v=ee(""),g=ee(""),E=ee(""),b=ee(""),S=ee(""),C=new C4e,w=new I4e,I=ee([]),R=ee(null),N=ee(null),O=ee(!1),V=ee(!1),L=ee(0),D=ee(0),M=(J,pe)=>{const be=new Date().toLocaleTimeString();I.value.push({time:be,type:J,content:typeof pe=="object"?JSON.stringify(pe,null,2):pe}),Vt(()=>{F()})},F=()=>{if(R.value){const J=R.value.scrollHeight;R.value.scrollTop=J}},W=()=>{I.value=[]},z=async()=>{try{t.value=!0;const J=await S4e();if(J.status!==200)throw new Error("");M("info","");const pe=await T4e(J.data.api_token);if(pe.status!==200)throw new Error("");if(M("info",""),s.value=pe.data.code,a.value=pe.data.auth,g.value=pe.data.hash||"",E.value=pe.data.name||"",o.value=!0,!await w.init("2cff29d965f24278aca9a3602d73b63e "))throw new Error("RTC");C.setRTCService(w),C.connect(a.value,s.value)}catch(J){console.error("Start mirror error:",J),XO.error(J.message||"")}finally{t.value=!1}},G=()=>{const J=C.getStatus();l.value=J,d.value={disconnected:"",connecting:"",connected:"",error:""}[J]},Y=()=>{const J=w.getStatus();h.value=J,v.value={disconnected:"",connecting:"",connected:"",error:""}[J]},te=J=>{M("message",J),J.type==="channel"&&(b.value=J.data.channel,S.value=J.data.token)},Z=J=>{try{const pe=JSON.parse(J);M("message",pe)}catch{M("raw",J)}},fe=J=>{M("heartbeat",J)},Ee=J=>{if(N.value){N.value.innerHTML="",J.on("first-frame-decoded",()=>{M("info","")}),J.on("video-size-changed",(be,Ae)=>{console.log(" - Width:",be,"Height:",Ae),L.value=be,D.value=Ae,M("info",`: ${be}x${Ae}`)});const pe={mirror:!1,fit:"contain"};J.play(N.value,pe),O.value=!0,M("info","")}},ae=J=>{J.play(),V.value=!0,M("info","")},X=J=>{M("info",` ${J.uid} `),O.value=!1,V.value=!1},ie=J=>{M("rtc-status",J)},se=J=>{M("error",`RTC: ${J.message}`),XO.error("")};return dn(()=>{C.on("message",te),C.on("raw",Z),C.on("heartbeat",fe),w.on("video",Ee),w.on("audio",ae),w.on("user-left",X),w.on("error",se),w.on("status",ie);const J=setInterval(G,1e3),pe=setInterval(Y,1e3);z(),iu(()=>{clearInterval(J),clearInterval(pe),C.off("message"),C.off("raw"),C.off("heartbeat"),w.off("video"),w.off("audio"),w.off("user-left"),w.off("error"),w.off("status"),C.disconnect(),w.leaveChannel()})}),{loading:t,isMirroring:o,mirrorCode:s,authToken:a,wsStatus:l,wsStatusText:d,rtcStatus:h,rtcStatusText:v,deviceId:g,deviceName:E,channelName:b,channelToken:S,messages:I,previewContent:R,remoteVideo:N,clearMessages:W,hasRemoteVideo:O,hasRemoteAudio:V,videoWidth:L,videoHeight:D}}},O4e={class:"screen-mirror"},N4e={class:"mirror-container"},k4e={class:"mirror-content"},P4e={class:"mirror-info"},D4e={class:"info-section"},L4e={class:"info-item"},M4e={class:"value"},x4e={class:"info-item"},U4e={class:"value"},V4e={class:"info-section"},F4e={class:"info-item"},B4e={class:"value"},j4e={class:"info-item"},$4e={class:"value token-value"},H4e={class:"info-section"},W4e={class:"info-item"},K4e={class:"info-item"},G4e={class:"info-section"},z4e={class:"info-item"},Y4e={class:"value"},q4e={class:"info-item"},X4e={class:"value"},J4e={class:"mirror-main"},Z4e={class:"video-container"},Q4e={class:"no-video"},eje={ref:"remoteVideo",class:"remote-video"},tje={class:"mirror-preview"},nje={class:"preview-header"},rje={class:"preview-content",ref:"previewContent"},oje={class:"message-time"},sje={class:"message-content"};function ije(t,o,s,a,l,d){const h=_n("el-button");return $(),le("div",O4e,[ue("div",N4e,[o[15]||(o[15]=ue("div",{class:"mirror-header"},[ue("h2",null,"")],-1)),ue("div",k4e,[ue("div",P4e,[ue("div",D4e,[o[2]||(o[2]=ue("h3",null,"",-1)),ue("div",L4e,[o[0]||(o[0]=ue("span",{class:"label"},"",-1)),ue("span",M4e,ot(a.mirrorCode),1)]),ue("div",x4e,[o[1]||(o[1]=ue("span",{class:"label"},"",-1)),ue("span",U4e,ot(a.authToken),1)])]),ue("div",V4e,[o[5]||(o[5]=ue("h3",null,"",-1)),ue("div",F4e,[o[3]||(o[3]=ue("span",{class:"label"},"",-1)),ue("span",B4e,ot(a.channelName||""),1)]),ue("div",j4e,[o[4]||(o[4]=ue("span",{class:"label"},"",-1)),ue("span",$4e,ot(a.channelToken||""),1)])]),ue("div",H4e,[o[8]||(o[8]=ue("h3",null,"",-1)),ue("div",W4e,[o[6]||(o[6]=ue("span",{class:"label"},"WebSocket",-1)),ue("span",{class:K(["value",a.wsStatus])},ot(a.wsStatusText),3)]),ue("div",K4e,[o[7]||(o[7]=ue("span",{class:"label"},"RTC",-1)),ue("span",{class:K(["value",a.rtcStatus])},ot(a.rtcStatusText),3)])]),ue("div",G4e,[o[11]||(o[11]=ue("h3",null,"",-1)),ue("div",z4e,[o[9]||(o[9]=ue("span",{class:"label"},"ID",-1)),ue("span",Y4e,ot(a.deviceId),1)]),ue("div",q4e,[o[10]||(o[10]=ue("span",{class:"label"},"",-1)),ue("span",X4e,ot(a.deviceName),1)])])]),ue("div",J4e,[ue("div",Z4e,[ln(ue("div",Q4e,o[12]||(o[12]=[ue("span",null,"...",-1)]),512),[[Wn,!a.hasRemoteVideo]]),ue("div",eje,null,512)]),ue("div",tje,[ue("div",nje,[o[14]||(o[14]=ue("h3",null,"",-1)),ge(h,{type:"text",onClick:a.clearMessages},{default:Ce(()=>o[13]||(o[13]=[bn("")])),_:1},8,["onClick"])]),ue("div",rje,[($(!0),le(Ut,null,Cn(a.messages,(v,g)=>($(),le("div",{key:g,class:"message-item"},[ue("span",oje,ot(v.time),1),ue("span",{class:K(["message-type",v.type])},ot(v.type),3),ue("span",sje,ot(v.content),1)]))),128))],512)])])])])])}const aje=$q(A4e,[["render",ije],["__scopeId","data-v-5116e996"]]),cje={name:"App",components:{ScreenMirror:aje}},lje={id:"app"};function uje(t,o,s,a,l,d){const h=_n("ScreenMirror");return $(),le("div",lje,[ge(h)])}const dje=$q(cje,[["render",uje]]),Hq=lW(dje);Hq.use(HBe);Hq.mount("#app")});export default hje();
